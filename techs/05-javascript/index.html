<!DOCTYPE html>
<html lang="zh" noscript>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
<meta property="og:site_name" content="Peter&#39;s Blog" />
<meta name="color-scheme" content="light dark">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">



<link rel="icon" type="image/x-icon" href="/favicon.ico">

<title>05 JavaScript - Peter&#39;s Blog</title>
    <meta name="og:title" content="05 JavaScript - Peter&#39;s Blog" /><meta name="description" content=" …" />
    <meta property="og:description" content=" …" />
    <link rel="canonical" href="/techs/05-javascript/" />
    <meta property="og:url" content="/techs/05-javascript/" /><link rel="alternate" type="application/rss+xml" href="https://PeterFuApps.github.io/index.xml">
    
    <meta property="og:locale" content="zh" /><meta name="generator" content="Hugo 0.146.6">
<style>
  @layer {
    body {
      background: white;
    }
  }
  @media (prefers-color-scheme: dark) {
    @layer {
      body {
        background: black;
      }
    }
  }
</style>







  
  
  
  
    
      
      
      
      

      
      
      
      
      
      
      <link rel="stylesheet" href="/css/tailwind_a16942ad.7b022486e448ebe9100a9476c8d0d7dc2b4ce62c0504d052a327b8a98019247a.css" integrity="sha256-ewIkhuRI6&#43;kQCpR2yNDX3CtM5iwFBNBSoye4qYAZJHo=" crossorigin="anonymous">
      
    
    
  

  
  
  
  
    
      
      
      
      

      
      
      
      
      
      
      <link rel="stylesheet" href="/css/main_434dc2f7.08359d2deb381a15bd26bd1b957cf4328dde8f0426f9470ca946b0d6fe53835a.css" integrity="sha256-CDWdLes4GhW9Jr0blXz0Mo3ejwQm&#43;UcMqUaw1v5Tg1o=" crossorigin="anonymous">
      
    
    
  
<script>
  window.BUILD_HASH = "c7e0eb4a058e18c7b65474546a085dd4"
</script>
































  
    <script src="/js/const.min.a4b940d5f9c396615d28bb05ce96d691327e654eaa866dc9d3ce9ee25cd79751.js" integrity="sha256-pLlA1fnDlmFdKLsFzpbWkTJ&#43;ZU6qhm3J086e4lzXl1E="></script>
  

  
    <script src="/js/i18n.min.ffea6affd01dead5d03d0743c01b5f221b784a2ddfe3edcddd312a2e6590e222.js" integrity="sha256-/&#43;pq/9Ad6tXQPQdDwBtfIht4Si3f4&#43;3N3TEqLmWQ4iI="></script>
  

  
    <script src="/js/util.min.accd3b83a1f2b6c5abb7ad0fe010cd9843aa8c48242d66a94d1dd20d59bc6ad7.js" integrity="sha256-rM07g6HytsWrt60P4BDNmEOqjEgkLWapTR3SDVm8atc="></script>
  








  
    <script src="/js/observer.26f48f94fc94361e5354a27d8223608d797b0a96740f956196ee5482c2284f8d.js" integrity="sha256-JvSPlPyUNh5TVKJ9giNgjXl7CpZ0D5Vhlu5UgsIoT40=" defer></script>
  

  
    <script src="/js/main.02049b5d9722deb350f2b796e24d10ab09f6524a209136fe1cf1d51b17109557.js" integrity="sha256-AgSbXZci3rNQ8reW4k0Qqwn2UkogkTb&#43;HPHVGxcQlVc=" defer></script>
  

  
    <script src="/js/gradient.4e555cb9653273f0a6ada217869c908541c13c0f9c5731590e5497b6cd5eaa89.js" integrity="sha256-TlVcuWUyc/CmraIXhpyQhUHBPA&#43;cVzFZDlSXts1eqok=" defer></script>
  

  
    <script src="/js/theme.365eaab4220e89c235ba91d94d2b507bc83d0b77627c3e63f248434f820894cd.js" integrity="sha256-Nl6qtCIOicI1upHZTStQe8g9C3difD5j8khDT4IIlM0=" defer></script>
  

  
    <script src="/js/scroll.eccb40648d97450f30cdbea14704dee453464e3a0d2ea1c99e3966a46f95abd2.js" integrity="sha256-7MtAZI2XRQ8wzb6hRwTe5FNGTjoNLqHJnjlmpG&#43;Vq9I=" defer></script>
  

  
    <script src="/js/shine.74e94faf6ee3eabd87417b177333a80c3d3a9feca2363260c6f1e8d2c24c6704.js" integrity="sha256-dOlPr27j6r2HQXsXczOoDD06n&#43;yiNjJgxvHo0sJMZwQ=" defer></script>
  









  
    <script src="/js/img.0cd11c8a348322294dd228e0ae5cf4381285da5a7cd15e87aa74b1a9c0ca8063.js" integrity="sha256-DNEcijSDIilN0ijgrlz0OBKF2lp80V6HqnSxqcDKgGM=" async></script>
  




  <script src="/js/tex-svg.js" async></script>


</head>

<body class="h-screen flex flex-col overflow-hidden">
  
  <div class="flex-1 overflow-hidden">
    <div class="h-full w-full overflow-y-auto relative" id="scroll-container">
      
<input type="checkbox" id="theme-menu-toggle" class="hidden">


<nav class="ui-page-nav ui-panel-base ui-navbar sticky top-0 z-40 overflow-x-clip">
    <div class="ui-grid">
        <div class="col-span-full flex flex-col sm:gap-4 sm:flex-row items-center justify-between">
            <div class="flex items-center sm:w-full max-sm:mt-4 w-auto">
                <h1 class="flex items-center">
                    <a href="/" class="flex items-center w-full">
                        
                        
                            <span class="site-title">Peter&#39;s Blog</span>
                        
                    </a>
                </h1>
                
                
                <div class="ml-2">
                    <div class="ui-tooltip bottom rounded-full" data-tooltip="主题切换">
                        <label for="theme-menu-toggle" class="flex ui-button-concealed ui-interactive ui-menu-item p-1 ui-interactive cursor-pointer">
                            <i class="dark-hidden inline-block icon js-sun"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" />
</svg>
</i>
                            <i class="dark-inline-block hidden icon js-moon"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
    <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z" />
</svg>
</i>
                        </label>
                    </div>
                </div>
            </div>

            <ul class="nav-menu flex gap-2 p-0 w-full md:w-auto justify-center sm:justify-end" id="nav-content">
                
                
                    <li>
                        
                        

                        <div class="ui-tooltip bottom rounded-full"  data-tooltip="首页 Home">
                            <a href="/" 
                                draggable="false"
                                
                                    class="ui-button-concealed ui-interactive ui-menu-item"
                                
                                
                                >
                                
                                    <i class="icon"><svg width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M10 18V15C10 13.8954 10.8954 13 12 13V13C13.1046 13 14 13.8954 14 15V18" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M2 8L11.7317 3.13416C11.9006 3.04971 12.0994 3.0497 12.2683 3.13416L22 8" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M20 11V19C20 20.1046 19.1046 21 18 21H6C4.89543 21 4 20.1046 4 19V11" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</i>
                                
                            </a>
                            
                            
                        </div>
                    </li>
                
                    <li>
                        
                        
                            
                        

                        <div class="ui-tooltip bottom rounded-full"  data-tooltip="技术 Tech">
                            <a href="/techs/" 
                                draggable="false"
                                
                                    class="ui-button ui-menu-item ui-interactive"
                                
                                
                                aria-current="true">
                                
                                    <i class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pc-case-icon lucide-pc-case"><rect width="14" height="20" x="5" y="2" rx="2"/><path d="M15 14h.01"/><path d="M9 6h6"/><path d="M9 10h6"/></svg></i>
                                
                            </a>
                            
                            
                        </div>
                    </li>
                
                    <li>
                        
                        

                        <div class="ui-tooltip bottom rounded-full"  data-tooltip="文章 Docs">
                            <a href="/docs/" 
                                draggable="false"
                                
                                    class="ui-button-concealed ui-interactive ui-menu-item"
                                
                                
                                >
                                
                                    <i class="icon"><svg width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M2.90602 17.505L5.33709 3.71766C5.5289 2.62987 6.56621 1.90354 7.654 2.09534L19.4717 4.17912C20.5595 4.37093 21.2858 5.40824 21.094 6.49603L18.6629 20.2833C18.4711 21.3711 17.4338 22.0975 16.346 21.9057L4.52834 19.8219C3.44055 19.6301 2.71421 18.5928 2.90602 17.505Z" stroke="currentColor"/>
<path d="M8.92902 6.38184L16.8075 7.77102" stroke="currentColor" stroke-linecap="round"/>
<path d="M8.23444 10.3213L16.1129 11.7105" stroke="currentColor" stroke-linecap="round"/>
<path d="M7.53986 14.2607L12.4639 15.129" stroke="currentColor" stroke-linecap="round"/>
</svg>
</i>
                                
                            </a>
                            
                            
                        </div>
                    </li>
                
                    <li>
                        
                        

                        <div class="ui-tooltip bottom rounded-full" >
                            <a href="/archives/" 
                                draggable="false"
                                
                                    class="ui-button-concealed ui-interactive ui-menu-item"
                                
                                
                                >
                                
                                    <i class="icon"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
    <path stroke-linecap="round" stroke-linejoin="round" d="m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z" />
</svg>
</i>
                                
                            </a>
                            
                            
                                 
                            <div class="ui-tooltip-menu">
                                
                                    
                                    
                                
                                <a class="ui-tooltip-menu-item" href="/archives/" 
                                draggable="false">
                                    
                                    <i class="icon size-4"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
    <path stroke-linecap="round" stroke-linejoin="round" d="m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z" />
</svg>
</i>
                                    
                                    归档 Archive
                                </a>
                                
                                    
                                    
                                
                                <a class="ui-tooltip-menu-item" href="/categories/" 
                                draggable="false">
                                    
                                    <i class="icon size-4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-folder-icon lucide-folder"><path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/></svg></i>
                                    
                                    分类 Categories
                                </a>
                                
                                    
                                    
                                
                                <a class="ui-tooltip-menu-item" href="/series/" 
                                draggable="false">
                                    
                                    <i class="icon size-4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bookmark-icon lucide-bookmark"><path d="m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"/></svg></i>
                                    
                                    系列 Series
                                </a>
                                
                                    
                                    
                                
                                <a class="ui-tooltip-menu-item" href="/tags/" 
                                draggable="false">
                                    
                                    <i class="icon size-4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-tag-icon lucide-tag"><path d="M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z"/><circle cx="7.5" cy="7.5" r=".5" fill="currentColor"/></svg></i>
                                    
                                    标签 Tags
                                </a>
                                
                            </div>
                            
                        </div>
                    </li>
                
                    <li>
                        
                        

                        <div class="ui-tooltip bottom rounded-full"  data-tooltip="关于 About">
                            <a href="/about/about/" 
                                draggable="false"
                                
                                    class="ui-button-concealed ui-interactive ui-menu-item"
                                
                                
                                >
                                
                                    <i class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-heart-icon lucide-file-heart"><path d="M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v2"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M10.29 10.7a2.43 2.43 0 0 0-2.66-.52c-.29.12-.56.3-.78.53l-.35.34-.35-.34a2.43 2.43 0 0 0-2.65-.53c-.3.12-.56.3-.79.53-.95.94-1 2.53.2 3.74L6.5 18l3.6-3.55c1.2-1.21 1.14-2.8.19-3.74Z"/></svg></i>
                                
                            </a>
                            
                            
                        </div>
                    </li>
                
                    <li>
                        
                        

                        <div class="ui-tooltip bottom rounded-full"  data-tooltip="搜索 Search">
                            <a href="/search/" 
                                draggable="false"
                                
                                    class="ui-button-concealed ui-interactive ui-menu-item"
                                
                                
                                >
                                
                                    <i class="icon"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M21 21L15.8033 15.8033M15.8033 15.8033C17.1605 14.4461 18 12.5711 18 10.5C18 6.35786 14.6421 3 10.5 3C6.35786 3 3 6.35786 3 10.5C3 14.6421 6.35786 18 10.5 18C12.5711 18 14.4461 17.1605 15.8033 15.8033Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</i>
                                
                            </a>
                            
                            
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>
</nav>


<div class="fixed inset-0 z-[9999] 
            opacity-0 invisible
            transition-all duration-200 ease-in-out
            flex items-center justify-center pointer-events-none"
     id="theme-menu">
    
    
    <div class="ui-card ui-panel-material p-4 w-full max-w-xs relative pointer-events-auto">
        
        
        <div class="flex justify-between items-center mb-4">
            <div class="flex items-center gap-0.5">
                <h3 class="text-sm font-semibold">主题设置</h3>
                <div class="ui-tooltip rounded-full" data-tooltip="自动主题切换">
                    <button class="ui-button-concealed ui-interactive rounded-full p-1 selected" id="auto-theme-toggle" >
                        <i class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun-moon-icon lucide-sun-moon"><path d="M12 8a2.83 2.83 0 0 0 4 4 4 4 0 1 1-4-4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.9 4.9 1.4 1.4"/><path d="m17.7 17.7 1.4 1.4"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.3 17.7-1.4 1.4"/><path d="m19.1 4.9-1.4 1.4"/></svg>
</i>
                    </button>
                </div>
                <div class="ui-tooltip rounded-full" data-tooltip="随机主题色">
                    <div class="ui-button-concealed ui-interactive rounded-full p-1" id="random-color-theme">
                        <i class="icon p-[2.2px]"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shuffle-icon lucide-shuffle"><path d="m18 14 4 4-4 4"/><path d="m18 2 4 4-4 4"/><path d="M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22"/><path d="M2 6h1.972a4 4 0 0 1 3.6 2.2"/><path d="M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45"/></svg></i>
                    </div>
                </div>
            </div>
            <label for="theme-menu-toggle" class="ui-button-concealed ui-interactive rounded-full p-1">
                <div class="size-6"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" >
  <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
</svg>
</div>
            </label>
        </div>

       <div class="flex gap-2 mb-4"><div class="ui-tooltip flex-1" data-tooltip="浅色模式 Light" >
                <button class="data-theme-btn ui-button-concealed ui-interactive p-2 flex flex-col items-center gap-1 w-full" data-theme-mode="light">
                    <span class="size-4 inline-block"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" />
</svg>
</span>
                    <span class="text-xs">Light</span>
                </button>
            </div><div class="ui-tooltip flex-1" data-tooltip="深色模式 Dark" >
                <button class="data-theme-btn ui-button-concealed ui-interactive p-2 flex flex-col items-center gap-1 w-full" data-theme-mode="dark">
                    <span class="size-4 inline-block"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
    <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z" />
</svg>
</span>
                    <span class="text-xs">Dark</span>
                </button>
            </div></div>

        
        <div class="grid grid-cols-3 gap-2" id="color-theme-grid">
            
        </div>
    </div>
</div>
      <div class="pt-4 flex flex-col justify-between ui-main-content">
        <div class="ui-grid">
          <aside class="ui-grid-left">
            <div class="ui-content">
    

</div>
          </aside>

          <main class="ui-grid-main"><article class="">

    <div class="ui-card mb-4">
        



<figure class="relative min-h-20">
  <div title="" class="block w-full ui-no-image">
    
  </div>
</figure>

        <header class="ui-header p-4">
            <h1 class="text-2xl">05 JavaScript</h1>
        </header>
    
        <div class="ui-body p-4">










<div class="content-isolation-wrapper markdown">
    <h1 id="javascript">JavaScript</h1>
<h2 id="导论">导论</h2>
<p>是一种可以在浏览器中运行的脚本语言</p>
<ol>
<li>浏览器端的动作</li>
<li>用户交互</li>
<li>数据处理</li>
</ol>
<p>和 Java 区别：</p>
<ol>
<li>Java 需要 <strong>编译</strong></li>
<li>JavaScript 是 <strong>解释性</strong> 语言</li>
<li>JavaScript 源代码放在 HTML 里</li>
</ol>
<p>JavaScript 由 EcmaScript (JavaScript语法)、DOM (页面文档对象模型)、BOM (浏览器对象模型) 组成。</p>
<p>1997 年，欧洲计算机制造商协会 <em>ECMA</em> 设置了 JavaScript 的标准，命名为 ECMAScript。</p>
<ul>
<li>
<p>JavaScript 实现了 EcmaScript</p>
</li>
<li>
<p>EcmaScript 规范了 JavaScript</p>
</li>
</ul>
<h3 id="区别">区别</h3>
<p>前端语言：处理 <strong>界面</strong> （HTML、CSS、JavaScript、……）</p>
<p>后端语言：处理 <strong>数据</strong> （Java、PHP、Python、Go、……）</p>
<p><kbd><sup>浏览器/APP</sup>前端</kbd>	⇆ HTTP 协议 ⇆ <kbd><sup>服务器</sup>后端</kbd></p>
<p>传统的 JS 是一门前端语言，只能运行在浏览器端，不能在服务器端处理数据。</p>
<p>在 2009 年，诞生了 <kbd>Node.js</kbd> ，这是一个 JavaScript 的服务端运行平台。</p>
<p>Node.js 出现后，JavaScript 开始支持后端。</p>
<h3 id="引入">引入</h3>
<ol>
<li>行内式 JS 直接写到元素的内部
<ul>
<li>可以将单行或少量 JS 代码写在 HTML 标签的事件属性中（以 on 开头的属性），如：onclick</li>
<li>注意单双引号的使用：在HTML中我们推荐使用 <strong>双引号</strong> ，JS中我们推荐使用 <strong>单引号</strong></li>
<li>可读性差，在 HTML 中编写大量代码时，不方便阅读</li>
<li>引号易错，引号多层嵌套匹配时，非常容易弄混</li>
<li>特殊情况下使用</li>
</ul>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;button&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34; &#34;</span> <span class="na">onAction</span><span class="o">=</span><span class="s">&#34; &#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;button&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;这是一个按钮&#34;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;alert(&#39;Hello World!&#39;);&#34;</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<ol start="2">
<li>内嵌式 定义在 <kbd>head</kbd> 中
<ul>
<li>可以将多行 JS 代码写入 <kbd>script</kbd> 标签中</li>
<li>内嵌 JS 是学习时常用的方式</li>
</ul>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;zh&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Title<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span> <span class="na">onload</span><span class="o">=</span><span class="s">&#34;alert(&#39;hi&#39;)&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!--onload属性载入--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s2">&#34;&lt;h1&gt;hello World!&lt;/h1&gt;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;hello world!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="c1">//.是一个运算符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// e.g.:
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cm">/* 1. 事件处理器 */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">onMouseOver</span><span class="o">=</span><span class="s2">&#34;alert(&#39;hi&#39;);&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="c1">//-&gt; body事件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="o">-</span> <span class="nx">onLoad</span>
</span></span><span class="line"><span class="cl">     <span class="o">-</span> <span class="nx">onUnload</span>
</span></span><span class="line"><span class="cl">     <span class="o">-</span> <span class="nx">etc</span><span class="p">...</span>
</span></span><span class="line"><span class="cl">     
</span></span><span class="line"><span class="cl"><span class="cm">/* 2. 简单对话框 */</span>
</span></span><span class="line"><span class="cl"> <span class="c1">//-&gt; 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="o">-</span> <span class="nx">alert</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">     <span class="o">-</span> <span class="nx">confirm</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">     <span class="o">-</span> <span class="nx">prompt</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 3. 定时器 */</span>
</span></span><span class="line"><span class="cl"> <span class="c1">//-&gt; 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="o">-</span> <span class="nx">setInterval</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		   <span class="o">&gt;&gt;</span> <span class="kd">let</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		      <span class="kd">let</span> <span class="nx">update</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">count</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="nx">count</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nb">document</span><span class="p">.</span><span class="nx">title</span><span class="o">=</span><span class="nx">count</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="nx">setInterval</span><span class="p">(</span><span class="nx">update</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">     <span class="o">-</span> <span class="nx">setTimeOut</span><span class="p">()</span></span></span></code></pre></div>
</div>
<ol start="3">
<li>外部引入 <kbd>script</kbd> 双标签</li>
</ol>
<ul>
<li>利于把 HTML 结构化，方便文件的复用</li>
<li>双标签，有 <code>src</code> 属性后标签中间不能写代码</li>
</ul>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;my.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- Obsolete syntax - Before HTML5 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<h3 id="io">I/O</h3>
<p>类似 Java， JavaScript 提供了一些常用的输入输出语句。</p>
<table>
  <thead>
      <tr>
          <th>方法</th>
          <th>说明</th>
          <th>归属</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>alert(msg)</td>
          <td>浏览器弹出警示框</td>
          <td>浏览器</td>
      </tr>
      <tr>
          <td>console.log(msg)</td>
          <td>浏览器控制台打印输出信息</td>
          <td>浏览器</td>
      </tr>
      <tr>
          <td>prompt(info)</td>
          <td>浏览器弹出输入框,用户可以输入</td>
          <td>浏览器</td>
      </tr>
  </tbody>
</table>
<h3 id="杂项">杂项</h3>
<ol>
<li>解释型语言和编译型语言</li>
</ol>
<p>计算机不能直接理解任何除机器语言以外的语言，所以必须要把程序员所写的程序语言翻译成机器语言才能执行程序。</p>
<p>程序语言翻译成机器语言的工具，被称为 <strong>翻译器</strong> 。</p>
<ul>
<li>翻译器翻译的方式有两种：<strong>编译</strong>、<strong>解释</strong>。</li>
<li>两种方式之间的区别在于翻译的时间点不同：
<ul>
<li><strong>编译器</strong> 是在代码执行之前进行编译，生成 <strong>中间代码</strong> 文件</li>
<li><strong>解释器</strong> 是在运行时进行及时解释，并 <strong>立即执行</strong> （当编译器以解释方式运行的时候，也称之为解释器）</li>
</ul>
</li>
</ul>
<ol start="2">
<li>标识(zhi)符、关键字、保留字</li>
</ol>
<p>标识符：为变量、属性、函数、参数取的名字，不能是 <strong>保留字</strong> 。</p>
<p>关键字： break, case, catch, continue, default, delete, do, else, finally, for, function, if, in, instanceof, new, return, switch, this, throw, try, typeof, var, void, while, with &hellip; etc.</p>
<p>保留字：类似于预留的”关键字“，即使现在还不是关键字，但未来可能会成为关键字，并且不能使用它们当 <strong>变量名</strong> 或 <strong>方法名</strong> 。</p>
<ul>
<li>包括: boolean, byte, char, class, const, debugger, double, enum, export, extends. fimal, float, goto, implements, import, int, interface, long, mative, package. private, protected, public, short, static, super, synchronized, throws, transient, volatile &hellip; etc.</li>
</ul>
<h2 id="变量">变量</h2>
<p>JavaScript 中的变量为 <strong>弱类型</strong> 。使用 [<em>TypeScript</em>](06 TypeScript.md) 可以强制定义变量类型，使其成为一门 <strong>强类型</strong> 语言。</p>
<p>定义变量：<kbd>var</kbd>；定义常量：<kbd>const</kbd></p>
<p>ES6 引入新类型：<kbd>let</kbd></p>
<ul>
<li>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">hello</span><span class="p">;</span>	<span class="c1">//variable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">hello</span> <span class="o">=</span> <span class="s2">&#34;hello&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">hello</span><span class="p">);</span></span></span></code></pre></div>
</div>
</li>
</ul>
<p>可以作为变量名字：</p>
<ol>
<li>英文字母：AaBbCc&hellip;</li>
<li>数字：123&hellip;</li>
<li>下划线：_</li>
<li>美元符号：&amp;</li>
</ol>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<ol>
<li>
<p>第一个字符不能是数字，且变量名中不能有空格；建议使用 <strong>小驼峰法</strong> 对变量进行命名</p>
</li>
<li>
<p>一个变量被 <strong>重新赋值</strong> 后，它原有的值就会被覆盖，以最后一次的值为准</p>
</li>
<li>
<p>同时声明多个变量时，只需写一个 <kbd>var</kbd> ，多个变量名之间由英文逗号隔开</p>
</li>
<li>
<p>不用 <code>var</code> 定义，而直接将值赋予它，会自动变成全局变量，产生作用域问题。
- 对于静态强类型检查的语言，使用前必须先声明。可以添加 <code>&quot;use strict&quot;;</code> 强制使用前检查</p>
</li>
<li>
<p>变量命名方法：
1. 驼峰命名法：<code>mathTestScore</code> （推荐）
2. C 风格变量命名法：<code>math_test_score</code></p>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">age</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">adderss</span> <span class="o">=</span> <span class="s2">&#34;loc&#34;</span> <span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">money</span> <span class="o">=</span> <span class="s2">&#34;300&#34;</span><span class="p">;</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<table>
  <thead>
      <tr>
          <th>代码</th>
          <th>说明</th>
          <th>结果</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>var age; console.log (age);</code></td>
          <td>只声明不赋值</td>
          <td>undefined</td>
      </tr>
      <tr>
          <td><code>console.log(age)</code></td>
          <td>不声明不赋值 直接使用</td>
          <td>报错</td>
      </tr>
      <tr>
          <td><code>age = 10; console.log (age);</code></td>
          <td>不声明只赋值</td>
          <td>10</td>
      </tr>
  </tbody>
</table>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 通过 emmit 语法，可直接输入 <code>log</code> 来实现快速打出 <code>console.log();</code> 的效果</p>
        </blockquote>
        
    </figure>

<h3 id="type"><em>Type</em></h3>
<p>变量没有类型（弱类型/动态语言），但值有类型，运行时被自动确定。</p>
<ol>
<li>
<p><strong>值类型</strong>：数值 <em>Number</em>、布尔值 <em>Boolean</em>、字符串 <em>String</em></p>
</li>
<li>
<p><strong>引用类型</strong>：对象 <em>Object</em>、数组 <em>Array</em>、函数 <em>Function</em> 、空类型 <em>Null</em>、未定义 <em>Undefined</em>、符号 <em>Symbol</em></p>
<ul>
<li>这些都属于 <strong>对象</strong></li>
</ul>
</li>
<li>
<p>[<em>ES6</em>](06 EcmaScript.md/#symbol-es6)  引入了一种新的原始数据类型：<em>Symbol</em>，表示独一无二的值</p>
<ul>
<li>类似 <em>C</em> 语言的 <strong>指针</strong><sup><em>pointer</em></sup></li>
</ul>
</li>
</ol>
<p>在运行过程中，解析引擎会根据 <strong>右值</strong><sup><em>r-value</em></sup> 自动判断数据类型：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>		           <span class="c1">//x为数字
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="s2">&#34;Bill&#34;</span><span class="p">;</span>          <span class="c1">//x为字符串
</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<ol>
<li>在 JavaScript 中，字符串类型也属于 <strong>值类型</strong> 。这一点和大部分语言都不同</li>
<li><sup>:star:</sup> 调用各种 <strong>基础类型</strong> 方法的时候， JavaScript 实际上是产生了相应的临时 <strong>包裹类</strong> ，并在方法执行完毕后自动销毁</li>
</ol>
        </blockquote>
        
    </figure>

<h4 id="number"><em>Number</em></h4>
<p>此数据类型代表所有的数字。</p>
<p><kbd>🔗 <em>Href</em></kbd> <a href="/techs/05-javascript/#math-es5">数学类</a></p>
<p>数值存在极限范围：</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <ol>
<li>+Infinity，代表 $$+\infin $$ ，大于任何数值</li>
<li>−Infinity，代表 $$-\infin $$  ，小于任何数值</li>
<li>NaN，Not a Number ，代表一个非数值</li>
<li>极小常量 [<em>Number.EPSILON</em>](06 EcmaScript.md/#number-epsilon)</li>
</ol>
        </blockquote>
        
    </figure>

<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">(</span><span class="nb">Number</span><span class="p">.</span><span class="nx">MAX_VALUE</span><span class="p">);</span>      <span class="c1">//1.7976931348623157e+308
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">(</span><span class="nb">Number</span><span class="p">.</span><span class="nx">MIN_VALUE</span><span class="p">);</span>      <span class="c1">//5e-324
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">(</span><span class="nb">Number</span><span class="p">.</span><span class="nx">MAX_VALUE</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>  <span class="c1">//Infinity
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">(</span><span class="o">-</span><span class="nb">Number</span><span class="p">.</span><span class="nx">MAX_VALUE</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span> <span class="c1">//-Infinity
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">(</span><span class="kc">NaN</span><span class="p">);</span>                   <span class="c1">//NaN
</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<ol>
<li>
<p>0 </p>
$$\div$$<p> 0 = NaN</p>
</li>
<li>
<p>NaN 不自等</p>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"> <span class="o">-&gt;</span> <span class="kc">NaN</span> <span class="o">==</span> <span class="kc">NaN</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="kc">false</span></span></span></code></pre></div>
</div>
<ol start="3">
<li>NaN 是一个特殊的 <strong>值</strong> ，而非 <strong>类型</strong> ，<code>isNaN()</code> 用来判断是否为非数值，返回布尔类型：</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"> <span class="o">-&gt;</span> <span class="p">(</span><span class="nb">isNaN</span><span class="p">(</span><span class="s1">&#39;String&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">   <span class="o">&gt;&gt;</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"> <span class="o">-&gt;</span> <span class="p">(</span><span class="nb">isNaN</span><span class="p">(</span><span class="mi">12</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">   <span class="o">&gt;&gt;</span> <span class="kc">false</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h5 id="进制">进制</h5>
<p>八进制前加0、十六进制前加0x：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="cm">/* 八进制数字序列范围：0～7 */</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">num1</span> <span class="o">=</span> <span class="mi">07</span><span class="p">;</span>           <span class="c1">// 对应十进制的7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">num2</span> <span class="o">=</span> <span class="mi">019</span><span class="p">;</span>          <span class="c1">// 对应十进制的19
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">num3</span> <span class="o">=</span> <span class="mi">08</span><span class="p">;</span>           <span class="c1">// 对应十进制的8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cm">/* 2. 十六进制数字数列范围 0～9 以及 A～F */</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">num0x</span> <span class="o">=</span> <span class="mh">0xA</span><span class="p">;</span></span></span></code></pre></div>
</div>
<h5 id="浮点">浮点</h5>
<p>ECMAScript 根据 IEEE754 的标准存放浮点数据，这会使一些个别的小数运算产生 “丢失精度” 问题。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="mf">0.2</span><span class="o">+</span><span class="mf">0.1</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="mf">0.30000000000000004</span></span></span></code></pre></div>
</div>
<p>可调用数字的 <code>toFixed()</code> 方法保留指定的小数位数，返回 <code>string</code>  类型。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="s1">&#39;0.30&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="p">(</span><span class="mf">0.9945</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="s1">&#39;0.995&#39;</span>                <span class="c1">//结果四舍五入
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">-&gt;</span> <span class="nb">Number</span><span class="p">((</span><span class="mf">0.1</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="mf">0.3</span></span></span></code></pre></div>
</div>
<p>最后要注意浮点数的相等比较：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">===</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="kc">false</span>	                <span class="c1">//计算机无法精确表示小数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.0000001</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="kc">true</span>                   <span class="c1">//表示方法
</span></span></span></code></pre></div>
</div>
<h5 id="方法">方法</h5>
<h6 id="tofixed"><em>ToFixed</em><sup id="number-prototype-toFixed"> </sup></h6>
<p><em>toFixed</em> 截取时四舍五入，并返回 <em>string</em> 类型。</p>
<table>
  <thead>
      <tr>
          <th>代码</th>
          <th style="text-align: left">说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>numObj.toFixed(digits)</code></td>
          <td style="text-align: left">保留指定的位数</td>
      </tr>
  </tbody>
</table>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="p">(</span><span class="mf">12345.6789</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="s1">&#39;12346&#39;</span>  <span class="c1">// 取整
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">-&gt;</span> <span class="p">(</span><span class="mf">12345.6789</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="s1">&#39;12345.68&#39;</span>  <span class="c1">// 保留两位
</span></span></span></code></pre></div>
</div>
<h4 id="string"><em>String</em><sup id="string-es5"> </sup></h4>
<p>可以是引号中的任意文本，其语法为 双引号<sup><code>&quot;&quot;</code></sup> 单引号<sup><code>''</code></sup> ， ES6 新增了模版字符串 (``) ，支持 <strong>互相嵌套</strong> 。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:link: <em>Href</em></kbd> [<em>ES6</em>](06 EcmaScript.md/#string-es6) 字符串对象的新增方法</p>
        </blockquote>
        
    </figure>

<ol>
<li>
<p>通过字符串的 <code>length</code> 属性可以获取整个字符串的长度。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="s1">&#39;Hello World&#39;</span><span class="p">.</span><span class="nx">length</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="mi">11</span></span></span></code></pre></div>
</div>
</li>
<li>
<p>多个字符串之间可使用 + 进行拼接</p>
</li>
</ol>
<ul>
<li>字符串 + 任何类型 = 新字符串</li>
<li>+ ：数值相加、字符相连</li>
</ul>
<ol start="3">
<li>
<p>可以通过下标直接访问数组成员</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Hello world&#39;</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">//H
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="kr">const</span> <span class="nx">index</span> <span class="k">in</span> <span class="s1">&#39;Hello world&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 0 1 2 3 4 5 6 7 8 9 10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kr">const</span> <span class="nx">item</span> <span class="k">of</span> <span class="s1">&#39;Hello world&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// H e l l o   w o r l d
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;Hello world&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">str</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;E&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span> <span class="c1">// Hello world
</span></span></span><span class="line"><span class="cl"><span class="c1">// 无法通过下标修改字符
</span></span></span><span class="line"><span class="cl"><span class="c1">// 是因为js引擎在运行过程中临时生成包裹类new String()
</span></span></span></code></pre></div>
</div>
</li>
<li>
<p>通过转义符显示特殊字符：</p>
</li>
</ol>
<table>
  <thead>
      <tr>
          <th>转义符</th>
          <th>解释说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>\n</td>
          <td>换行符 newline</td>
      </tr>
      <tr>
          <td>\\</td>
          <td>斜杠</td>
      </tr>
      <tr>
          <td>\'</td>
          <td>单引号</td>
      </tr>
      <tr>
          <td>\&quot;</td>
          <td>双引号</td>
      </tr>
      <tr>
          <td>\t</td>
          <td>tab 锁进</td>
      </tr>
      <tr>
          <td>\b</td>
          <td>空格 blank</td>
      </tr>
  </tbody>
</table>
<p>Prototype：</p>
<table>
  <thead>
      <tr>
          <th>方法</th>
          <th>功能</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>charAt()</code></td>
          <td>得到指定位置字符</td>
      </tr>
      <tr>
          <td><code>substring()</code></td>
          <td>提取子串</td>
      </tr>
      <tr>
          <td><code>substr()</code></td>
          <td>提取子串</td>
      </tr>
      <tr>
          <td><code>slice()</code></td>
          <td>提取子串</td>
      </tr>
      <tr>
          <td><code>toUpperCase()</code></td>
          <td>将字符串变为大写</td>
      </tr>
      <tr>
          <td><code>toLowerCase()</code></td>
          <td>将字符串变为小写</td>
      </tr>
      <tr>
          <td><code>indexOf()</code></td>
          <td>检索字符串</td>
      </tr>
  </tbody>
</table>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd>  <code>indexOf()</code> 方法返回调用它的 <code>String</code> 对象中第一次出现的指定值的索引，从 <code>fromIndex</code> 处进行搜索。如果未找到该值，则返回 -1。</p>
<p>可用于检测 User Agent 中浏览器类型。</p>
        </blockquote>
        
    </figure>

<h4 id="boolean"><em>Boolean</em></h4>
<p><kbd>true</kbd> / <kbd>false</kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">(</span><span class="kc">true</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>                <span class="c1">//2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">(</span><span class="kc">false</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>               <span class="c1">//1
</span></span></span></code></pre></div>
</div>
<h4 id="null"><em>Null</em></h4>
<p>空。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">space</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="kc">null</span>  <span class="o">+</span> <span class="s1">&#39;pink&#39;</span><span class="p">);</span>        <span class="c1">//任何类型 + String = 直接拼接
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">(</span><span class="nx">space</span>  <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>            <span class="c1">//1
</span></span></span></code></pre></div>
</div>
<p>狭义上，null 可以理解为 “空对象”，这样可以合理的解释为什么 null 的类型为 object。</p>
<p>但是准确的来说，null 不是一个 “对象”，它是一个独立的 “基本数据类型”。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="k">typeof</span> <span class="kc">null</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="s1">&#39;object&#39;</span></span></span></code></pre></div>
</div>
<h4 id="undefined"><em>Undefined</em></h4>
<p>变量声明之后未被赋值。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">variable</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nx">variable</span>  <span class="o">+</span> <span class="s1">&#39;pink&#39;</span><span class="p">);</span>    <span class="c1">//任何类型 + String = 直接拼接
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">(</span><span class="nx">variable</span>  <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>         <span class="c1">//NaN
</span></span></span></code></pre></div>
</div>
<h3 id="typeof"><em>Typeof</em><sup id="variable-typeof-es5"> </sup></h3>
<p>typeof 是一个 <strong>运算符</strong> ，而不是内置函数，所以不用加 <code>()</code>，如果加了也不会报错，但是并不推荐。</p>
<p>获取检测变量的 <strong>数据类型</strong> 。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">num</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">typeof</span> <span class="nx">num</span><span class="p">);</span>            <span class="c1">//number
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;pink&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">typeof</span> <span class="nx">str</span><span class="p">);</span>            <span class="c1">//string
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">flag</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">typeof</span> <span class="nx">vari</span><span class="p">)</span>            <span class="c1">//boolean
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">vari</span> <span class="o">=</span> <span class="kc">undefined</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">typeof</span> <span class="nx">vari</span><span class="p">);</span>           <span class="c1">//undefined
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">timer</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>        <span class="cm">/* null is typeof object */</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">typeof</span> <span class="nx">timer</span><span class="p">)</span>           <span class="c1">//object
</span></span></span></code></pre></div>
</div>
<h3 id="字面量">字面量</h3>
<p>字面量是源代码中一个固定值的表示方法。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// 1. 数值字面量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 2. 字符串字面量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="s1">&#39;Hello World&#39;</span><span class="p">,</span> <span class="s1">&#39;front-end&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 3. 布尔字面量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kc">true</span><span class="p">,</span> <span class="kc">false</span><span class="p">;</span></span></span></code></pre></div>
</div>
<h3 id="对比">对比<sup id="compare-es5"> </sup></h3>
<p>所有的变量分为两类： <strong>基本类型值</strong> 和 <strong>引用类型值</strong> 。
</p>
$$
\mathrm{{\small JavaScript}}\ 的数据类型\begin{cases}
基本数据类型
\begin{cases}
 数值类型 & \mathrm{Number} \\
 字符串类型 & \mathrm{String}\\
 布尔类型 & \mathrm{Boolean}\\
 空类型 & \mathrm{Null}\\
 未定义 & \mathrm{Undefined}\\
 符号 & \mathrm{Symbol} & {\small ES\ 6}\\
 大整数 & \mathrm{BigInt} & {\small ES\ Stage 3}\\
\end{cases}
\\
引用数据类型
\begin{cases}
 对象 & \mathrm{Object}\begin{cases}
  对象 & \mathrm{Object} \\
  数组 & \mathrm{Array} \\
  数学 & \mathrm{Math} \\
  时间 & \mathrm{Date} \\
  正则 & \mathrm{RegExp} \\
\end{cases}\\
 函数 & \mathrm{Function}
\end{cases}
\end{cases}
$$<p>
</p>
$$LaTeX$$<p> 永远的神！</p>
<table>
  <thead>
      <tr>
          <th></th>
          <th>基本类型</th>
          <th>引用类型</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>赋值：<code>var a = b</code></td>
          <td>产生新的副本</td>
          <td>复制原指针</td>
      </tr>
      <tr>
          <td>比较：<code>==</code></td>
          <td>比较值是否相等</td>
          <td>比较内存地址</td>
      </tr>
      <tr>
          <td>全等：<code>===</code></td>
          <td>先要求类型相等</td>
          <td>比较内存地址</td>
      </tr>
  </tbody>
</table>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> <em>String</em> 类型也属于基本类型。</p>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:link: <em>Href</em></kbd> [<em>ES6</em>](06 EcmaScript.md/#object-is-es6) 中的 <code>Object.is()</code> 也可以用来比较两个数是否相等</p>
<p><kbd>:link: <em>Href</em></kbd> [<em>ES6</em>](06 EcmaScript.md/#symbol-es6)  新增了 <em>symbol</em> 基本数据类型</p>
        </blockquote>
        
    </figure>

<h3 id="转换">转换</h3>
<p>使用 <strong>表单</strong> 、<em>prompt()</em> 获取的数据默认是字符串类型的，此时不能直接进行数字加减（发生字符串拼接），而需要对变量类型进行转换，也即把一种数据类型转换为另一种数据类型。</p>
<p><strong>e.g.:</strong> <em>prompt()</em> 获取的“数字”仍然是字符类型的。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">age</span> <span class="o">=</span> <span class="nx">prompt</span><span class="p">(</span><span class="s2">&#34;请输入你的年龄&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">age</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">age</span><span class="p">)</span>  <span class="c1">//string
</span></span></span></code></pre></div>
</div>
<h4 id="to-string">To String</h4>
<table>
  <thead>
      <tr>
          <th>代码</th>
          <th>说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>obj.toString()</code></td>
          <td>转成字符串</td>
      </tr>
      <tr>
          <td><code>String(obj)</code> 强制转换</td>
          <td>转成字符串</td>
      </tr>
      <tr>
          <td>$$+$$</td>
          <td>拼接</td>
      </tr>
  </tbody>
</table>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 可以加上空字符<code>''</code>直接转为字符串。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="k">typeof</span> <span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="nx">string</span>
</span></span><span class="line"><span class="cl"><span class="c1">//这种方法也被称为隐式转换
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h4 id="to-number">To Number</h4>
<table>
  <thead>
      <tr>
          <th>方式</th>
          <th>说明</th>
          <th>案例</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>parselnt(str)</code></td>
          <td>将 String 类型转成 <strong>整数</strong> 数值型</td>
          <td><code>parselnt('78')'</code></td>
      </tr>
      <tr>
          <td><code>parseFloat(str) </code></td>
          <td>将 String 类型转成 <strong>浮点数数值型</strong></td>
          <td><code>parseFloat('78.21');</code></td>
      </tr>
      <tr>
          <td><code>Number(str)</code></td>
          <td>将 String 类型转换为 <strong>数值型</strong></td>
          <td><code> Number('12');</code></td>
      </tr>
      <tr>
          <td>$$+\ -\ \times\ \div$$</td>
          <td>利用 <strong>算术运算</strong> 隐式转换为数值型</td>
          <td><code> '12' - 0;</code></td>
      </tr>
  </tbody>
</table>
<h5 id="parseint"><code>parseInt()</code></h5>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">parseInt</span><span class="p">(</span><span class="s1">&#39;120px&#39;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="mi">120</span>                     <span class="c1">//第一个为数字即可开始转换
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">-&gt;</span> <span class="nb">parseInt</span><span class="p">(</span><span class="s1">&#39;rem120px&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="kc">NaN</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">parseInt</span><span class="p">(</span><span class="s1">&#39;3.99&#39;</span><span class="p">);</span>		     <span class="c1">//不存在四舍五入
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="o">&gt;&gt;</span> <span class="mi">3</span></span></span></code></pre></div>
</div>
<h5 id="parsefloat"><code>parseFloat()</code></h5>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="s1">&#39;3.14&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="mf">3.14</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="s1">&#39;120px&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="mi">120</span>          <span class="c1">//自动截去第一个非数字字符之后的所有字符
</span></span></span></code></pre></div>
</div>
<h5 id="number-1"><code>Number()</code></h5>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Number</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="mi">12</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Number</span><span class="p">(</span><span class="s1">&#39;123年&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="kc">NaN</span> 
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Number</span><span class="p">(</span><span class="s1">&#39;2e3&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="mi">2000</span></span></span></code></pre></div>
</div>
<h5 id="隐式转换">隐式转换</h5>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="k">typeof</span> <span class="p">(</span><span class="s1">&#39;12&#39;</span> <span class="o">-</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="nx">number</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="s1">&#39;123&#39;</span> <span class="o">-</span> <span class="s1">&#39;120&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="mi">3</span>                   <span class="c1">//发生了隐式转换
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cm">/* 但不建议这样使用 */</span></span></span></code></pre></div>
</div>
<h4 id="to-boolean">To Boolean</h4>
<table>
  <thead>
      <tr>
          <th>方式</th>
          <th>说明</th>
          <th>案例</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>Boolean()</code></td>
          <td>其它类型转为布尔值</td>
          <td><code>Boolean('true');</code></td>
      </tr>
  </tbody>
</table>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 代表 空、否定的词都会被转换为 <code>false</code> ，其余全部变为 <code>true</code>（包括 String）</p>
<ul>
<li><code>''</code>、0、NaN、null、undefined</li>
</ul>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Boolean</span><span class="p">(</span><span class="mi">123</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Boolean</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Boolean</span><span class="p">(</span><span class="kc">NaN</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Boolean</span><span class="p">(</span><span class="kc">Infinity</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Boolean</span><span class="p">(</span><span class="o">-</span><span class="kc">Infinity</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="kc">true</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h3 id="运算符">运算符</h3>
<p>运算符(operator)也被称为 <strong>操作符</strong> ，是用于实现赋值、比较和执行算数运算等功能的符号。</p>
<h4 id="算数">算数</h4>
<p>用于执行两个变量或值之间的算数运算，包括 </p>
$$+\ - \ \times\ \div\ \%$$<p> 。</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">运算符</th>
          <th>符号</th>
          <th style="text-align: left">描述</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">$+$</td>
          <td><code>+</code></td>
          <td style="text-align: left">$a+b$</td>
      </tr>
      <tr>
          <td style="text-align: left">$-$</td>
          <td><code>-</code></td>
          <td style="text-align: left">$a-b$</td>
      </tr>
      <tr>
          <td style="text-align: left">$\times$</td>
          <td><code>*</code></td>
          <td style="text-align: left">$a\times b$</td>
      </tr>
      <tr>
          <td style="text-align: left">$\div$</td>
          <td><code>/</code></td>
          <td style="text-align: left">$a\div b$</td>
      </tr>
      <tr>
          <td style="text-align: left">$\wedge$</td>
          <td><code>**</code></td>
          <td style="text-align: left">$a^{b}$</td>
      </tr>
  </tbody>
</table>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 指数运算符</p>
<p>ES2016 新增了一个指数运算符（<code>**</code>）。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="mi">2</span> <span class="o">**</span> <span class="mi">2</span> <span class="c1">// 4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">2</span> <span class="o">**</span> <span class="mi">3</span> <span class="c1">// 8
</span></span></span></code></pre></div>
</div>
<p>这个运算符的一个特点是 <strong>右结合</strong> ，而不是常见的左结合。多个指数运算符连用时，是从最右边开始计算的。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// 相当于 2 ** (3 ** 2)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">2</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">**</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 512
</span></span></span></code></pre></div>
</div>
<p>上面代码中，首先计算的是第二个指数运算符，而不是第一个。</p>
<p>指数运算符可以与等号结合，形成一个新的赋值运算符（<code>**=</code>）。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">a</span> <span class="o">**=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 等同于 a = a * a;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">b</span> <span class="o">**=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 等同于 b = b * b * b;
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<p><kbd>:memo: <em>Note</em></kbd></p>
<p><em>JS</em> 在某个数据类型前使用 <code>+</code> ，可以调用其自带的 <em>valueOf</em> 方法，若方法不存在或是返回非原始值 ，则调用 <em>toString</em> 方法。</p>
<p>因此 <code>+new Date()</code> 会调用 <code>Date.prototype.valueOf()</code> ，以下返回效果等同：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">===</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">valueOf</span><span class="p">()</span>   <span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// 返回效果等同
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">+</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">valueOf</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nb">Date</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1</span></span></span></code></pre></div>
</div>
<h4 id="递增和递减">递增和递减</h4>
<p>同 C。</p>
<h4 id="比较">比较</h4>
<table>
  <thead>
      <tr>
          <th>运算符名称</th>
          <th>说明</th>
          <th>案例</th>
          <th>结果</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>&lt;</td>
          <td>小于</td>
          <td><code>1&lt;2</code></td>
          <td>true</td>
      </tr>
      <tr>
          <td>&gt;</td>
          <td>大于</td>
          <td><code>1&gt;2</code></td>
          <td>false</td>
      </tr>
      <tr>
          <td>&gt;=</td>
          <td>大于等于</td>
          <td><code>2&gt;=2</code></td>
          <td>true</td>
      </tr>
      <tr>
          <td>&lt;=</td>
          <td>小于等于</td>
          <td><code>3 &lt;= 2</code></td>
          <td>false</td>
      </tr>
      <tr>
          <td>==</td>
          <td>判等号（会转换）</td>
          <td><code>37 == 37</code></td>
          <td>true</td>
      </tr>
      <tr>
          <td>=</td>
          <td>不等号</td>
          <td><code>37!= 37</code></td>
          <td>false</td>
      </tr>
      <tr>
          <td>=== / !==</td>
          <td>值&amp;数据 全等</td>
          <td><code>37 === '37'</code></td>
          <td>false</td>
      </tr>
  </tbody>
</table>
<h4 id="逻辑">逻辑</h4>
<table>
  <thead>
      <tr>
          <th>逻辑运算符</th>
          <th>说明</th>
          <th>案例</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>&amp;&amp;</td>
          <td>逻辑与（$$\and$$）</td>
          <td><code>true &amp;&amp; false</code></td>
      </tr>
      <tr>
          <td>||</td>
          <td>逻辑或（$$\or$$）</td>
          <td>`true</td>
      </tr>
      <tr>
          <td>!</td>
          <td>逻辑非（$$\lnot$$）</td>
          <td><code>!true</code></td>
      </tr>
  </tbody>
</table>
<h4 id="位运算符">位运算符</h4>
<table>
  <thead>
      <tr>
          <th style="text-align: left">运算符</th>
          <th style="text-align: left">名称</th>
          <th style="text-align: left">描述</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">&amp;</td>
          <td style="text-align: left">AND</td>
          <td style="text-align: left">$a\ \&\ b$</td>
      </tr>
      <tr>
          <td style="text-align: left">|</td>
          <td style="text-align: left">OR</td>
          <td style="text-align: left">$a\</td>
      </tr>
      <tr>
          <td style="text-align: left">^</td>
          <td style="text-align: left">XOR</td>
          <td style="text-align: left">$a\oplus b$</td>
      </tr>
      <tr>
          <td style="text-align: left">~</td>
          <td style="text-align: left">NOT</td>
          <td style="text-align: left">$\bar{a}$</td>
      </tr>
      <tr>
          <td style="text-align: left">&laquo;</td>
          <td style="text-align: left">零填充左位移</td>
          <td style="text-align: left">$a\ll b$</td>
      </tr>
      <tr>
          <td style="text-align: left">&raquo;</td>
          <td style="text-align: left">有符号右位移</td>
          <td style="text-align: left">$a\gg b$</td>
      </tr>
      <tr>
          <td style="text-align: left">&raquo;&gt;</td>
          <td style="text-align: left">零填充右位移</td>
          <td style="text-align: left">$a\ggg b$</td>
      </tr>
  </tbody>
</table>
<h4 id="赋值">赋值</h4>
<table>
  <thead>
      <tr>
          <th>赋值运算符</th>
          <th>说明</th>
          <th>案例</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>+=</td>
          <td>直接赋值</td>
          <td><code>var usrName = '我是值';</code></td>
      </tr>
      <tr>
          <td>=</td>
          <td>加、减一个数后再赋值</td>
          <td><code>var age = 10; age+=5; </code> -&gt; <code> 15</code></td>
      </tr>
      <tr>
          <td>*=、/=、%=</td>
          <td>乘、除、取模后再赋值</td>
          <td><code>var age = 2; age*=5;</code> -&gt; <code>10</code></td>
      </tr>
  </tbody>
</table>
<p>赋值运算也产生值，可以连续使用赋值运算符。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">a</span> <span class="o">=</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">c</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span></span></span></code></pre></div>
</div>
<h4 id="优先级">优先级</h4>
<ol>
<li>一元运算符里面的逻辑非优先级很高</li>
<li>逻辑 $$\and$$ 比 逻辑 $$\or$$ 优先级高</li>
<li>建议使用 <code>()</code> 规定优先级</li>
</ol>
<table>
  <thead>
      <tr>
          <th>优先级</th>
          <th>运算符</th>
          <th>顺序</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>小括号</td>
          <td>()</td>
      </tr>
      <tr>
          <td>2</td>
          <td>一元运算符</td>
          <td>++ −− !</td>
      </tr>
      <tr>
          <td>3</td>
          <td>算数运算符</td>
          <td>先 × ÷ ≡ 后 + −</td>
      </tr>
      <tr>
          <td>4</td>
          <td>关系运算符</td>
          <td>&gt; ≥ &lt; ≤</td>
      </tr>
      <tr>
          <td>5</td>
          <td>相等运算符</td>
          <td>== != === !==</td>
      </tr>
      <tr>
          <td>6</td>
          <td>逻辑运算符</td>
          <td>先 &amp;&amp; 后 ||</td>
      </tr>
      <tr>
          <td>7</td>
          <td>赋值运算符</td>
          <td>=</td>
      </tr>
      <tr>
          <td>8</td>
          <td>逗号运算符</td>
          <td>,</td>
      </tr>
  </tbody>
</table>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="p">(</span><span class="mi">3</span><span class="o">&gt;</span><span class="mi">5</span><span class="o">&amp;&amp;</span><span class="mi">2</span><span class="o">&lt;</span><span class="mi">7</span><span class="o">&amp;&amp;</span><span class="mi">3</span><span class="o">==</span><span class="mi">4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="p">(</span><span class="mi">3</span><span class="o">&lt;=</span><span class="mi">4</span><span class="o">||</span><span class="mi">3</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">|</span><span class="mi">3</span><span class="o">!=</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="p">(</span><span class="mi">2</span><span class="o">==</span><span class="s2">&#34;2&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="p">(</span><span class="mi">2</span><span class="o">===</span><span class="s2">&#34;2&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="kc">false</span></span></span></code></pre></div>
</div>
<h2 id="控制">控制</h2>
<h3 id="顺序">顺序</h3>
<p>顺序结构是程序中最简单、最基本的流程控制，它没有特定的语法结构，程序会按照代码的先后顺序，依次执行。程序中大多数的代码都是这样执行的。</p>
<h3 id="分支">分支</h3>
<p>由上到下执行代码的过程中，根据不同的条件执行不同的路径代码（执行代码多选一的过程），从而得到不同的结果。</p>
<h4 id="if-else">If-else</h4>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">condition</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nx">statement1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nx">statement2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> JS中没有连比，<code>3 &lt;= a &lt;= 15</code> 的写法是错误的，应该为：<code>a &gt;= 3 &amp;&amp; a &lt;= 15</code>。</p>
        </blockquote>
        
    </figure>

<h4 id="三元运算符">三元运算符</h4>
<p>Conditional operator</p>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">condition</span> <span class="o">?</span> <span class="nx">exprIfTrue</span> <span class="o">:</span> <span class="nx">exprIfFalse</span><span class="p">;</span></span></span></code></pre></div></div>
</div>
<h4 id="switch">Switch</h4>
<p>多分支语句。必须要 <strong>值</strong> 和 <strong>数据</strong> 类型一致才可以，即 <strong>全等</strong> <code>===</code>； <code>default</code> 不是必须的，但不用 <code>break</code> 就不会跳出 switch 。</p>
<p>与 if 对比：</p>
<ol>
<li>一般情况下，两个语句可以互换</li>
<li>switch..case 语句通常处理 case 为比较确定值的情况，而 if..else.. 语句更加灵活，常用于范围判断</li>
<li>分支少 if ，分支多 switch</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">switch</span> <span class="p">(</span><span class="nx">expression</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">case</span> <span class="nx">value1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//Statements executed when the
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//result of expression matches value1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">[</span><span class="k">break</span><span class="p">;]</span>
</span></span><span class="line"><span class="cl">  <span class="k">case</span> <span class="nx">value2</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="nx">statement2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="k">break</span><span class="p">;]</span>
</span></span><span class="line"><span class="cl">  <span class="p">...</span>
</span></span><span class="line"><span class="cl">  <span class="k">case</span> <span class="nx">valueN</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="nx">statementN</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="k">break</span><span class="p">;]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="nx">statement</span> <span class="k">default</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="k">break</span><span class="p">;]]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 id="短路">短路</h3>
<p>当有多个表达式、左边的表达式可以直接确定结果时，就不再计算右边的表达式的值，称为 <strong>短路运算</strong>。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<ol>
<li><code>&amp;&amp;</code> 时，找到为 false 的分项就停止处理，并返回该分项的值，否则就执行完，并返回最后的分项的值。</li>
<li><code>||</code>找到为 true 的分项就停止处理，并返回该分项的值，否则执行完，并返回最后的分项的值；</li>
</ol>
        </blockquote>
        
    </figure>

<h4 id="逻辑-1">逻辑 $$\and$$</h4>
<p>语法：<code>表达式1 &amp;&amp; 表达式2</code></p>
<p>遇 <strong>假</strong> 返 <strong>假</strong>，无假返回末尾表达式。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="p">(</span><span class="mi">123</span> <span class="o">&amp;&amp;</span> <span class="mi">456</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="mi">456</span>              <span class="c1">//表达式1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">-&gt;</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="mi">456</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="mi">0</span>                <span class="c1">//表达式2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">-&gt;</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="mi">456</span> <span class="o">*</span> <span class="mi">56789</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 如果有空的或否定的为假 其余为真
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// 0 &#39;&#39; null undefined NaN
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="o">&gt;&gt;</span> <span class="mi">0</span>     
</span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:warning: <em>Caution</em></kbd> AND <code>&amp;</code> 按位与</p>
<p>The bitwise AND operator <code>&amp;</code> returns a <code>1</code> in each bit position for which the <strong>corresponding bits</strong> of both operands are <code>1</code>s.</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// 00000000000000000000000000000101
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// 00000000000000000000000000000011
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span> <span class="o">&amp;</span> <span class="nx">b</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">   <span class="c1">// 00000000000000000000000000000001
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="o">&gt;&gt;</span> <span class="mi">1</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h4 id="逻辑-2">逻辑 $$\or$$</h4>
<p>遇 <strong>真</strong> 返 <strong>真</strong> ，无真返回末尾表达式。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">||</span><span class="kc">false</span><span class="o">||</span><span class="kc">NaN</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="k">typeof</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">||</span><span class="kc">false</span><span class="o">||</span><span class="kc">NaN</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="nx">number</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="p">(</span><span class="mi">123</span> <span class="o">||</span> <span class="mi">456</span><span class="p">);</span>             <span class="c1">// 123
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">-&gt;</span> <span class="p">(</span><span class="mi">0</span> <span class="o">||</span> <span class="mi">456</span><span class="p">);</span>               <span class="c1">// 456
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">-&gt;</span> <span class="p">(</span><span class="mi">123</span> <span class="o">||</span> <span class="mi">456</span> <span class="o">||</span> <span class="mi">789</span><span class="p">);</span>      <span class="c1">//123
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:warning: <em>Caution</em></kbd> Bitwise OR  <code>|</code> 按位或</p>
<p>The bitwise OR operator <code>|</code> returns a <code>1</code> in each bit position for which the <strong>corresponding bits</strong> of either or both operands are <code>1</code>s.</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// 00000000000000000000000000000101
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// 00000000000000000000000000000011
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span> <span class="o">|</span> <span class="nx">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// 00000000000000000000000000000111
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="o">&gt;&gt;</span> <span class="mi">7</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h3 id="循环">循环</h3>
<h4 id="for"><em>For</em><sup id="for-es5"> </sup></h4>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">([</span><span class="nx">initialization</span><span class="p">];</span> <span class="p">[</span><span class="nx">condition</span><span class="p">];</span> <span class="p">[</span><span class="kr">final</span><span class="o">-</span><span class="nx">expression</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">   <span class="nx">statement</span><span class="p">;</span></span></span></code></pre></div>
</div>
<h5 id="for-in"><em>For-in</em><sup id="for-in"> </sup></h5>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:link: <em>Href</em></kbd> <em>Object</em> [<em>for-in</em>]( 06 EcmaScript.md#object-for-in)</p>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:link: <em>Href</em></kbd> [<em>for-of</em> 与 <em>for-in</em> 区别](06 EcmaScript.md#for-of-for-in-es6)</p>
        </blockquote>
        
    </figure>

<p>遍历键名 <kbd>object</kbd> 。它可以把一个对象的所有属性依次循环出来。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">object</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 只遍历可枚举属性
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// 会自动把键名转为string类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">statement</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>要过滤掉对象 <strong>继承</strong> 的属性，增加 <code>hasOwnProperty()</code> 判断：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">object</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">hasOwnProperty</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">statement</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>由于数组也是对象，而它的每个元素的索引被视为对象的属性，因此，<code>for ... in</code> 循环可以直接循环出数组的索引：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kr">const</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span> 	        <span class="c1">// &#39;0&#39;, &#39;1&#39;, &#39;2&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> 	      <span class="c1">// &#39;A&#39;, &#39;B&#39;, &#39;C&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([</span><span class="k">typeof</span> <span class="nx">i</span><span class="p">,</span> <span class="k">typeof</span> <span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]]);</span>
</span></span><span class="line"><span class="cl">                            <span class="c1">//[ &#39;string&#39;, &#39;string&#39; ]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 对数组的循环得到的索引类型是 string 而不是 number 。</p>
        </blockquote>
        
    </figure>

<h5 id="for-of"><em>For-of</em><sup id="for-of"> </sup></h5>
<p>遍历键值<sup><em>array</em></sup> ，在 可迭代对象<sup><em>iterable</em></sup> 上创建一个迭代循环。</p>
<p><kbd>:link: <em>Href</em></kbd></p>
<ol>
<li>[<em>Object</em>](06 EcmaScript.md/#object-traversal) 的遍历器</li>
<li>[<em>iterator</em>](06 EcmaScript.md/#iterator-es6) 遍历接口</li>
</ol>
<p><kbd>:memo: <em>Note</em></kbd>  <em>Object</em> 类型默认是 <strong>不可遍历</strong> 的，可通过 <em>Object</em> 迭代器<sup><em>iterator</em></sup> 进行包裹从而实现遍历。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nx">variable</span> <span class="k">of</span> <span class="nx">iterable</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">statement</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h4 id="while"><em>While</em></h4>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">while</span> <span class="p">(</span><span class="nx">condition</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nx">statement</span><span class="p">;</span></span></span></code></pre></div>
</div>
<h5 id="do-while"><em>Do-while</em></h5>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">do</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nx">statement</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="nx">condition</span><span class="p">);</span></span></span></code></pre></div>
</div>
<h4 id="控制-1">控制</h4>
<ol>
<li><kbd>break</kbd>：跳出循环</li>
<li><kbd>continue</kbd>：跳过并进入下一轮</li>
</ol>
<h4 id="比较-1">比较</h4>
<ul>
<li>三种循环 <kbd>for</kbd><em>,</em> <kbd>while</kbd><em>,</em> <kbd>do-while</kbd> 的功能是等价的</li>
<li>如果需要循环至少执行一次，<em>do</em> 通常是更好的选择</li>
<li>当循环的次数是固定的，或者很容易计算得到的时候，选择 <em>for</em> 循环</li>
</ul>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<p><em>e.g.:</em> 求最大公约数</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">* 问题｜找到两个非负整数u和v的最大公约数gcd
</span></span></span><span class="line"><span class="cl"><span class="cm">* 方法｜辗转相除法
</span></span></span><span class="line"><span class="cl"><span class="cm">* 第一步：如果v等于0，gcd就是u，算法结束
</span></span></span><span class="line"><span class="cl"><span class="cm">* 第二步：计算temp = u%v，u="v，v=temp，然后回到第一步"
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">u</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">v</span> <span class="o">=</span> <span class="mi">21</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">temp</span> <span class="o">=</span> <span class="nx">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="p">(</span><span class="nx">v</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">temp</span> <span class="o">=</span> <span class="nx">u</span> <span class="o">%</span> <span class="nx">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">u</span> <span class="o">=</span> <span class="nx">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">v</span> <span class="o">=</span> <span class="nx">temp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">alert</span><span class="p">(</span><span class="nx">u</span> <span class="o">+</span> <span class="s2">&#34;和&#34;</span> <span class="o">+</span> <span class="nx">v</span> <span class="o">+</span> <span class="s2">&#34;的最大公约数是&#34;</span> <span class="o">+</span> <span class="nx">u</span><span class="p">);</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h4 id="调试">调试</h4>
<p><strong>断点调试</strong> 是指自己在程序的某一行设置一个断点。</p>
<p>调试时，程序运行到这一行就会停住，然后你可以一步一步往下调试，调试过程中可以看各个变量当前的值，出错的话，调试到出错的代码行即显示错误，停下。</p>
<p>使用：</p>
<p>浏览器中按 F12 → Sources → 找到需要调试的文件 → 在程序的某一行设置断点。</p>
<h2 id="数组">数组<sup id="array-es5"> </sup></h2>
<p>The Array object, enables storing a collection of multiple items under a single variable name, and has members for performing common array operations</p>
<p>[<em>ES6</em>](06 EcmaScript.md/#array-es6) 又在原有的基础上，增加了扩展。</p>
<ul>
<li>
<p>允许动态增长</p>
</li>
<li>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">A</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">B</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">size</span><span class="p">);</span> <span class="c1">//typeof B[0] -&gt; undefined
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kd">let</span> <span class="nx">C</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">d1</span><span class="p">,</span> <span class="nx">d2</span><span class="p">,</span> <span class="p">...,</span> <span class="nx">dn</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">D</span> <span class="o">=</span> <span class="p">[</span><span class="nx">d1</span><span class="p">,</span> <span class="nx">d2</span><span class="p">,</span> <span class="p">...,</span> <span class="nx">dn</span><span class="p">];</span></span></span></code></pre></div>
</div>
</li>
</ul>
<h3 id="访问">访问</h3>
<p>使用 <kbd>[]</kbd> 运算符访问数组中的一个单元，下标从 <code>0</code> 开始。</p>
<p><code>a[x] = n</code> 创建了并赋值数组中的单元 <code>x</code> 为  <code>n</code> 。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="cm">/* 下标越界不会报错 */</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="kc">undefined</span></span></span></code></pre></div>
</div>
<h3 id="属性">属性</h3>
<p><code>length</code> 返回成员数目（对 string 也有效），修改该属性可以直接修改数组长度。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="cm">/* 可以通过下标对数组直接赋值，若不存在则自动创建 */</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">]</span><span class="o">=</span><span class="s2">&#34;new&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span> <span class="p">]</span></span></span></code></pre></div>
</div>
<h3 id="方法-1">方法</h3>
<p>数组的 <code>prototype</code> 自带了一些方法：</p>
<h4 id="类型检查">类型检查</h4>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">([]);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="kc">true</span></span></span></code></pre></div>
</div>
<h4 id="数组的遍历">数组的遍历</h4>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="err">，</span><span class="mi">2</span><span class="err">，</span><span class="mi">3</span><span class="err">，</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kr">const</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span> 	        <span class="c1">// &#39;0&#39;, &#39;1&#39;, &#39;2&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> 	      <span class="c1">// &#39;A&#39;, &#39;B&#39;, &#39;C&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([</span><span class="k">typeof</span> <span class="nx">i</span><span class="p">,</span> <span class="k">typeof</span> <span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]]);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//[ &#39;string&#39;, &#39;string&#39; ]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span></span></span></code></pre></div>
</div>
<h4 id="foreach"><code>forEach</code><sup id="array-forEach-es5"> </sup></h4>
<h5 id="语法">语法</h5>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">array</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">callback</span><span class="p">(</span><span class="nx">currentvalue</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">arr</span><span class="p">),</span> <span class="nx">thisValue</span><span class="p">);</span></span></span></code></pre></div></div>
</div>
<p>其中
<em>callback</em> 为数组中每个元素执行的函数，该函数可接受 <em>1-3</em> 个参数：</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><em>currentvalue</em> 表示数组的当前元素项，必须</p>
<p><em>index</em> 表示的当前元素下标，可选</p>
<p><em>arr</em> 表示当前元素所属的数组，可选</p>
        </blockquote>
        
    </figure>

<p><em>thisValue</em> 表示执行回调函数 <code>callback()</code> 时的 <em>this</em> 指向。可选参数。当不写时，则默认是指向 <em>window</em> 全局</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`数组第</span><span class="si">${</span><span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="sb">个元素是</span><span class="si">${</span><span class="nx">item</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span> <span class="c1">// forEach的返回值为undefined
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<p><em>forEach()</em> 没有 <strong>返回值</strong> 。</p>
        </blockquote>
        
    </figure>

<h5 id="和-for-区别">和 <a href="/techs/05-javascript/#for-es5"><em>for</em></a> 区别</h5>
<p><code>forEach()</code> 方法无法提前结束，也就是 <em>break &amp; continue</em> 会失效。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 但 <em>return</em> 仍然能提前终止单轮循环。</p>
        </blockquote>
        
    </figure>

<p>例如，我们想要找到某个满足条件的元素时就结束循环。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example 1</em></kbd></p>
<p>在 <code>for</code> 语句中我们可以这样写</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;找到了3，并结束循环&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p><code>for</code> 语句执行了 <em>2</em> 次，在第二次找到了数组中的 <em>3</em> ，并结束了循环。</p>
        </blockquote>
        
    </figure>

<p>那 <code>forEach()</code> 会怎么样呢？</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example 2</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nx">arr</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">item</span> <span class="o">===</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;找到了3，但未结束遍历&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span></span></span></code></pre></div>
</div>
<p>本想着在找到 <em>3</em> 之后用 <em>return</em> 结束遍历，结果仍然输出了 <em>3</em> 后面的元素。</p>
        </blockquote>
        
    </figure>

<p>终止或者跳出 <code>forEach()</code> 循环，除非 <strong>抛出异常</strong> ，所以想执行一个数组是否满足某种条件然后返回某值，可以用一般的 <code>for</code> 循环实现，或者用 <em>Array.every()</em> 或者 <em>Array.some()</em> 。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <ol>
<li><em>Array.every()</em> 用于检测数组所有元素是否全部都符合指定条件</li>
<li><em>Array.some()</em> 用于检测数组中的元素是否有任意一个满足指定条件</li>
</ol>
        </blockquote>
        
    </figure>

<p><code>forEach()</code> 会跳过 <strong>空值</strong> 。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example 3</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">arr2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arr1</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="nx">arr1</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr1</span><span class="p">);</span> <span class="c1">// [ 2, 2, 2, 2, 2 ]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">arr2</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="c1">// item = 2; //修改不了原数组
</span></span></span><span class="line"><span class="cl"><span class="c1">// forEach 通过index修改原数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">arr2</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr2</span><span class="p">);</span> <span class="c1">// [ 2, 2, &lt;1 empty item&gt;, 2, 2 ]
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<p>我们可以发现，<em>for</em> 循环对于数组中的空值进行了修改，而 <em>forEach()</em> 方法跳过了空值。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:warning: <em>Caution</em></kbd></p>
<p><code>forEach()</code> 方法修改数组元素不能使用 <em>item</em> 直接修改。</p>
<p><em>item</em> 相当于从 <em>arr2</em> 中复制过来的值，并不是真正指向原数组 <em>arr2</em> 里面的元素。</p>
        </blockquote>
        
    </figure>

<p>所以我们想要 <strong>修改原数组</strong> 的每个元素必须通过拿到它的 <strong>索引值</strong> <em>index</em> 去进行修改： <code>arr2[index] = 2;</code></p>
<p><code>forEach()</code> 的循环次数由数组 <strong>初始长度</strong> 决定。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example 3</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">arr2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arr1</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="nx">arr1</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">arr1</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="nx">arr1</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;数组循环了&#34;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;次&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">arr2</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="nx">arr2</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">===</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">arr2</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="nx">arr2</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;数组循环了&#34;</span> <span class="o">+</span> <span class="nx">index</span> <span class="o">+</span> <span class="s2">&#34;次&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr2</span><span class="p">);</span></span></span></code></pre></div>
</div>
<p>我们可以发现 <code>for</code> 循环时，向数组中添加数据，循环次数也增加了。而 <code>forEach()</code> 方法却只循环数组 <em>arr2</em> 的初始长度。</p>
        </blockquote>
        
    </figure>

<p>综上，<code>forEach</code> 适用于只是进行 集合 或 <strong>数组</strong> 遍历，<code>for</code> 则在较复杂的循环中效率更高。</p>
<h4 id="map"><code>map()</code><sup id="array-map-es5"> </sup></h4>
<h5 id="语法-1">语法</h5>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">array</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">callback</span><span class="p">(</span><span class="nx">currentValue</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">arr</span><span class="p">),</span> <span class="nx">thisValue</span><span class="p">)</span></span></span></code></pre></div></div>
</div>
<p>其中
<em>callback</em> 为数组中每个元素执行的函数，该函数可接受1-3个参数：</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><em>currentvalue</em> 表示数组的当前元素项，必须</p>
<p><em>index</em> 参数表示的当前元素下标，可选</p>
<p><em>arr</em> 参数表示当前元素所属的数组，可选</p>
        </blockquote>
        
    </figure>

<p><em>thisValue</em> 表示执行回调函数 <em>callback()</em> 时的 <em>this</em> 指向。可选参数。如果省略，或是传入 <code>null</code> <code>undefined</code> ，则默认返回全局对象 - <em>window</em> / <em>global</em> 。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<p><em>Array.map()</em> 不会空元素进行检测，也不会改变原数组。</p>
        </blockquote>
        
    </figure>

<h5 id="和-foreach-区别">和 <em>forEach</em> 区别</h5>
<p>我们先来看看他们的相同点：</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example 1</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">thisValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">fun</span><span class="p">(){}};</span>
</span></span><span class="line"><span class="cl"><span class="nx">arr</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="c1">//item表示数组中的每一项，index标识当前项的下标，arr表示当前数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span> <span class="c1">// a b c d
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span> <span class="c1">// 0 1 2 3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span> <span class="c1">// [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;] * 4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// { fun: [Function: fun] }
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">},</span> <span class="nx">thisValue</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 这里的thisValue参数，表示函数中的this指向，可写可不写
</span></span></span><span class="line"><span class="cl"><span class="c1">// 如果不写，则this指向全局对象：global/window
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">arr</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span><span class="nx">index</span><span class="p">,</span><span class="nx">arr</span><span class="p">){</span>
</span></span><span class="line"><span class="cl"><span class="c1">//参数含义同forEach
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span><span class="nx">thisValue</span><span class="p">);</span></span></span></code></pre></div>
</div>
<p>运行之后，可以看出两者参数没有任何的区别，除此之外两者之间还有一个共同的特性，就是不能停止里面的遍历，除非程序报错。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p>若在这里使用 [箭头函数](04 JavaScript.md#arrow-function-es6)，会导致 <em>thisValue</em> 失效。</p>
        </blockquote>
        
    </figure>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example 2</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nx">arr</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">===</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span> <span class="c1">// 0 1 3 4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span> <span class="c1">// [ 1, 3, &lt;1 empty item&gt;, 13, 2, 14, 5 ]
</span></span></span></code></pre></div>
</div>
<p><code>map()</code> 方法同样也不能循环的同时增加数组元素试图改变循环次数。</p>
        </blockquote>
        
    </figure>

<p>那他们的区别在哪呢？</p>
<ol>
<li>
<h5 id="返回值">返回值</h5>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="nx">item</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="nx">item</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span> <span class="c1">// [ 3, 5, 7, 15, 4 ]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">res2</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="nx">item</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="nx">item</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Void function return value is used
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res2</span><span class="p">);</span> <span class="c1">//undefined
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<p><code>map()</code> 会返回一个 <strong>新数组</strong> ，数组中的元素为原始数组元素调用函数处理后的值。
<code>forEach()</code> 返回值则永远是 <code>undefined </code>。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<p><code>Array.map()</code> 可以通过传入 <em>index</em> 修改原数组。</p>
        </blockquote>
        
    </figure>

</li>
<li>
<h5 id="执行速度">执行速度</h5>
<p><em>forEach()</em> 执行的速度相比 <em>map()</em> 慢了 <em>70%</em> 。</p>
</li>
</ol>
<h4 id="filter"><code>filter()</code><sup id="array-filter-es5"> </sup></h4>
<p>把数组的某些元素过滤掉，然后返回剩下的元素。</p>
<p>和 <code>map()</code> 类似，<code>filter()</code> 也接收一个函数。和 <code>map()</code> 不同的是，<code>filter()</code> 把传入的函数依次作用于每个元素，返回值为 <em>true</em> 则保留该元素。</p>
<ol>
<li>
<p>回调函数</p>
<p><code>filter()</code> 接收的回调函数，其实可以有多个参数。通常我们仅使用第一个参数，表示 <em>Array</em> 的某个元素。回调函数还可以接收另外两个参数，表示元素的位置和数组本身：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">r</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span> <span class="c1">// &#39;A&#39; &#39;B&#39; &#39;C&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span> <span class="c1">// 0 1 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span> <span class="c1">// [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="nx">r</span><span class="p">;</span> <span class="c1">// []
</span></span></span></code></pre></div>
</div>
</li>
<li>
<p>利用 <code>filter()</code> ，可以巧妙地去除 <em>Array</em> 的重复元素</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="s1">&#39;strawberry&#39;</span><span class="p">,</span> <span class="s1">&#39;banana&#39;</span><span class="p">,</span> <span class="s1">&#39;pear&#39;</span><span class="p">,</span> <span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;strawberry&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">r</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">self</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">self</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="o">===</span> <span class="nx">index</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// indexOf()方法返回第一个元素出现的位置
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">r</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// [ &#39;apple&#39;, &#39;strawberry&#39;, &#39;banana&#39;, &#39;pear&#39;, &#39;orange&#39; ]
</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:link: <em>Href</em></kbd> <a href="/techs/05-javascript/#array-index-of-es6"><em>Array.prototype.indexOf()</em></a></p>
        </blockquote>
        
    </figure>

</li>
<li>
<p>请尝试用 <code>filter()</code> 筛选出素数：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">get_primes</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="k">return</span> <span class="p">(</span><span class="nx">arr</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">ele</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">   <span class="k">if</span><span class="p">(</span><span class="nx">ele</span> <span class="o">===</span> <span class="mi">1</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">ele</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">ele</span><span class="o">%</span><span class="nx">i</span> <span class="o">===</span><span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>   <span class="c1">//return true;放在这里就是&#34;只要不被2整除就都返回 true 了,根本不用再往下查了&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="p">}</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="kc">true</span><span class="p">;</span><span class="c1">//放在这里就是表示:从2开始一直到被他小的数都要被它除一遍,都不行才返回 true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}))</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 测试:
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span>
</span></span><span class="line"><span class="cl">    <span class="nx">x</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">r</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">;</span> <span class="nx">x</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">r</span> <span class="o">=</span> <span class="nx">get_primes</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span> <span class="o">===</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">97</span><span class="p">].</span><span class="nx">toString</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;测试通过!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;测试失败: &#39;</span> <span class="o">+</span> <span class="nx">r</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
</li>
</ol>
<h4 id="valueof"><code>valueOf()</code></h4>
<p>方法返回指定对象的 原始值<sup><em>primitive value</em></sup>。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span><span class="p">[</span><span class="s2">&#34;A&#34;</span><span class="p">,</span><span class="s2">&#34;B&#34;</span><span class="p">,</span><span class="s2">&#34;C&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="nx">a</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="nb">Array</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&#34;B&#34;</span><span class="p">,</span> <span class="s2">&#34;C&#34;</span><span class="p">]</span></span></span></code></pre></div>
</div>
<h4 id="indexof"><code>indexOf()</code><sup id="array-index-of-es5"> </sup></h4>
<p><code>indexOf</code> 无法找到 <em>NaN</em> 。</p>
<p><kbd>📝 <em>Note</em></kbd> ES2016 新增的 <code>includes</code> 方法是 <code>indexOf</code> 的替代。</p>
<h4 id="push"><code>push()</code></h4>
<p>在数组 <strong>末尾</strong> 推入新项，多项则使用逗号隔开，返回新数组的长度。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span></span></span></code></pre></div>
</div>
<h4 id="pop"><code>pop()</code></h4>
<p>删除数组中的最后项目，不接受参数，返回新数组的长度。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="nx">arr</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span></span></span></code></pre></div>
</div>
<h4 id="unshift"><code>unshift()</code></h4>
<p>在数组 <strong>头部</strong> 插入新项目，返回新数组的长度。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="nx">arr</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="nx">arr</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;</span>  <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span></span></span></code></pre></div>
</div>
<h4 id="shift"><code>shift()</code></h4>
<p>删除并 <strong>返回</strong> 数组 <strong>开头</strong> 项目。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="nx">arr</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span></span></span></code></pre></div>
</div>
<h4 id="splice"><code>splice()</code><sup id="array-splice"> </sup></h4>
<p>替换数组中的指定项，（从下标 <em>start</em><sup>下标从0开始</sup> 开始，先删除 <em>deleteCount</em> ，再插入 <em>item</em> 数组 ）并返回删除的项目。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> The <code>splice()</code> method changes the contents of an array by removing or replacing existing elements and/or adding new elements in place.</p>
        </blockquote>
        
    </figure>

<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// SyntaX
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">splice</span><span class="p">(</span><span class="nx">start</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">splice</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">deleteCount</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">splice</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">deleteCount</span><span class="p">,</span> <span class="nx">item1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">splice</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">deleteCount</span><span class="p">,</span> <span class="nx">item1</span><span class="p">,</span> <span class="nx">item2</span><span class="p">,</span> <span class="p">...,</span><span class="nx">itemN</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">splice</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">deleteCount</span><span class="p">,</span> <span class="p">...</span><span class="nx">itemArray</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Usage
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,...[</span><span class="s1">&#39;arr&#39;</span><span class="p">,</span><span class="s1">&#39;ay&#39;</span><span class="p">,</span><span class="s1">&#39;List&#39;</span><span class="p">]));</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="c1">//返回删除的项目
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;arr&#39;</span><span class="p">,</span> <span class="s1">&#39;ay&#39;</span><span class="p">,</span> <span class="s1">&#39;List&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span></span></span></code></pre></div>
</div>
<h4 id="slice"><code>slice()</code><sup id="array-slice-es5"> </sup></h4>
<p>截取并 <strong>导出</strong> （从下标 <em>start</em><sup>$x\in N+$</sup> 开始到 <em>end</em> ）数组中的指定项，不影响原数组。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note 1</em></kbd> end为负值表示截止范围从 <strong>末尾</strong> 开始</p>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note 2</em></kbd> The <code>slice()</code> method returns a <strong>shallow copy</strong> of a portion of an array into a new array object selected from start to end (end not included) where start and end represent the index of items in that array. The original array will not be modified.</p>
        </blockquote>
        
    </figure>

<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">//SyntaX
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">slice</span><span class="p">();</span>    <span class="c1">//可创建单层数组深拷贝。见后面的拷贝一节。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">slice</span><span class="p">(</span><span class="nx">start</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">slice</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">end</span><span class="p">);</span></span></span></code></pre></div>
</div>
<h4 id="join"><code>join()</code></h4>
<h4 id="split"><code>split()</code></h4>
<p><code>join()</code> 数组 → 字符串，参数表示分割链接字符，为空时则默认以逗号 <code>,</code> 分割，等同于调用 <code>toString()</code> 方法。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">].</span><span class="nx">toString</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="s1">&#39;0,1,2,3&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">].</span><span class="nx">join</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="s1">&#39;0,1,2,3&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">].</span><span class="nx">toString</span><span class="p">()</span><span class="o">===</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">].</span><span class="nx">join</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="kc">true</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<p><code>split()</code>  字符串 → 数组，参数表示分割字符串的方法。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="kd">let</span> <span class="nx">arrToString</span> <span class="o">=</span>  <span class="nx">arr</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">   <span class="kd">let</span> <span class="nx">arrJoinString</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">join</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">   <span class="kd">let</span> <span class="nx">subArr</span> <span class="o">=</span> <span class="nx">arrJoinString</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([</span><span class="nx">arrToString</span><span class="p">,</span><span class="nx">arrJoinString</span><span class="p">,</span><span class="nx">subArr</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="s1">&#39;0,1,2,3&#39;</span><span class="p">,</span> <span class="s1">&#39;0,1,2,3&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]]</span></span></span></code></pre></div>
</div>
<h4 id="reverse"><code>reverse()</code></h4>
<p>将数组中的全部项顺序 <strong>颠倒</strong> 。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="nx">arr</span><span class="p">.</span><span class="nx">reverse</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_facing_up: <em>Example</em></kbd> 字符串逆序</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="s1">&#39;ABCDEFG&#39;</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">reverse</span><span class="p">().</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="s2">&#34;GFEDCBA&#34;</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h4 id="sort"><code>sort()</code><sup id="array-sort"> </sup></h4>
<p>对数组进行排序。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// SyntaX
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cm">/* Functionless */</span>
</span></span><span class="line"><span class="cl"><span class="c1">//-&gt; 不提供参数时，元素按照转换为的字符串的各个字符的Unicode位点进行排序
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">sort</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* Arrow function */</span>
</span></span><span class="line"><span class="cl"><span class="nx">sort</span><span class="p">((</span><span class="nx">firstEl</span><span class="p">,</span> <span class="nx">secondEl</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* Compare function */</span>
</span></span><span class="line"><span class="cl"><span class="nx">sort</span><span class="p">(</span><span class="nx">compareFn</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* Inline compare function */</span>
</span></span><span class="line"><span class="cl"><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span> <span class="nx">compareFn</span><span class="p">(</span><span class="nx">firstEl</span><span class="p">,</span> <span class="nx">secondEl</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">})</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note 1</em></kbd> JavaScript 中函数本身可以作为 <strong>值</strong> 进行传递。</p>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note 2</em></kbd> 传入函数时，如果需要将它们交换位置，则返回正整数；否则就返回负数。</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left"><code>compareFunction(a, b)</code> return value</th>
          <th style="text-align: left">sort order</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>&gt; 0</code></td>
          <td style="text-align: left">sort <code>b</code> before <code>a</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><code>&lt; 0</code></td>
          <td style="text-align: left">sort <code>a</code> before <code>b</code><sup>default</sup></td>
      </tr>
      <tr>
          <td style="text-align: left"><code>=== 0</code></td>
          <td style="text-align: left">keep original order of <code>a</code> and <code>b</code></td>
      </tr>
  </tbody>
</table>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// 从小到大排序
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nx">arr</span><span class="p">.</span><span class="nx">sort</span><span class="p">((</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">x</span> <span class="o">-</span> <span class="nx">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>	<span class="c1">// [0,1,2,3]
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:link: <em>Href</em></kbd> 关于如何保持 <em>ES6</em> [<em>sort()</em>](06 EcmaScript.md/#sort-stable) 的排序稳定性</p>
        </blockquote>
        
    </figure>

<h4 id="contcat"><code>contcat()</code><sup id="array-concat"> </sup></h4>
<p>拼接数组。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kr">const</span> <span class="nx">array1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="kr">const</span> <span class="nx">array2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="kr">const</span> <span class="nx">array3</span> <span class="o">=</span> <span class="nx">array1</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">array2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">array3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="nb">Array</span> <span class="p">[</span><span class="s2">&#34;a&#34;</span><span class="p">,</span> <span class="s2">&#34;b&#34;</span><span class="p">,</span> <span class="s2">&#34;c&#34;</span><span class="p">,</span> <span class="s2">&#34;d&#34;</span><span class="p">,</span> <span class="s2">&#34;e&#34;</span><span class="p">,</span> <span class="s2">&#34;f&#34;</span><span class="p">]</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note 1</em></kbd> returns a <strong>shallow copy</strong> of a portion of an array&gt;</p>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note 2</em></kbd> 和 <code>slice()</code> 一样可以用来创建单层数组深拷贝</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kr">const</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="kr">const</span> <span class="nx">layerCopyArr</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">concat</span><span class="p">([]);</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([</span><span class="nx">arr</span><span class="p">,</span> <span class="nx">layerCopyArr</span><span class="p">,</span> <span class="nx">arr</span> <span class="o">===</span> <span class="nx">layerCopyArr</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="p">],</span> <span class="kc">false</span><span class="p">]</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h4 id="reduce"><code>reduce()</code><sup id="array-prototype-reduce-es5"> </sup></h4>
<p><code>Array.prototype.reduce()</code></p>
<p><strong><code>reduce()</code></strong> 方法对数组中的每个元素按序执行一个由您提供的 <strong>reducer</strong> 函数，每一次运行 <strong>reducer</strong> 会将先前元素的计算结果作为参数传入，最后将其结果汇总为单个返回值。</p>
<p>previousValue, currentValue</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="nb">Array</span><span class="p">&lt;</span><span class="nt">any</span><span class="p">&gt;.</span><span class="nx">reduce</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="nx">callbackfn</span><span class="o">:</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="nx">previousValue</span>: <span class="kt">any</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">currentValue</span>: <span class="kt">any</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">currentIndex</span>: <span class="kt">number</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">array</span>: <span class="kt">any</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">=&gt;</span> <span class="kt">any</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="nx">initialValue</span>: <span class="kt">any</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="o">:</span> <span class="kt">any</span></span></span></code></pre></div>
</div>
<p>第一次执行回调函数时，不存在“上一次的计算结果”。如果需要回调函数从数组索引为 0 的元素开始执行，则需要传递初始值。否则，数组索引为 0 的元素将被作为初始值 <em>initialValue</em>，迭代器将从第二个元素开始执行（索引为 1 而不是 0）。</p>
<h4 id="将二维数组转为一维数组">将二维数组转为一维数组</h4>
<div class="ui-codeblock">
    
    <pre tabindex="0"><code>const testArr = [[1,2], [3,4], [5,6]]
testArr.reduce((acc, cur) =&gt; {
  return acc.concat(cur)
}, [])
// [1,2,3,4,5,6]</code></pre>
</div>
<h4 id="计算数组中每个元素出现的个数">计算数组中每个元素出现的个数</h4>
<div class="ui-codeblock">
    
    <pre tabindex="0"><code>const testArr = [1, 3, 4, 1, 3, 2, 9, 8, 5, 3, 2, 0, 12, 10]
testArr.reduce((acc, cur) =&gt; {
  if (!(cur in acc)) {
    acc[cur] = 1
  } else {
    acc[cur] += 1
  }
  return acc
}, {})

// {0: 1, 1: 2, 2: 2, 3: 3, 4: 1, 5: 1, 8: 1, 9: 1, 10: 1, 12: 1}
复制代码</code></pre>
</div>
<p>这里注意，我初始化的值变成了 <code>{}</code> ,这个需求需要键值对的形式，利用 <code>cur in acc</code> 判断累计器 <code>acc</code> 中是否含有 <code>cur</code> 属性，如果没有默认赋值 1，如果已经存在 <code>+= 1</code> 累加一次。 在实际的开发业务中，这个方法非常常用，变种也很多。比如给你一个账单列表（项与项之间的消费类型有相同情况），让你统计账单列表中各个消费类型的支出情况，如 <code>购物</code> 、 <code>学习</code> 、 <code>转账</code> 等消费类型的支出情况。这就用到了上述方法，去通过归类。</p>
<h4 id="按属性给数组分类">按属性给数组分类</h4>
<p>什么叫按照属性给数组分类，其实就是给定一个依据，把符合条件的归并到一起。再拿账单举例，就是按各个消费类型归为一类。</p>
<div class="ui-codeblock">
    
    <pre tabindex="0"><code>const bills = [
  { type: &#39;shop&#39;, momey: 223 },
  { type: &#39;study&#39;, momey: 341 },
  { type: &#39;shop&#39;, momey: 821 },
  { type: &#39;transfer&#39;, momey: 821 },
  { type: &#39;study&#39;, momey: 821 }
];
bills.reduce((acc, cur) =&gt; {
  // 如果不存在这个键，则设置它赋值 [] 空数组
  if (!acc[cur.type]) {
    acc[cur.type] = [];
  }
  acc[cur.type].push(cur)
  return acc
}, {})
复制代码</code></pre>
</div>
<p><img src="/data:image/webp;base64,UklGRrwxAABXRUJQVlA4ILAxAACQuwCdASoMAgoBPpFCnEqlo6YhplNaqMASCWdu/Hh4puczCpTrcmP8UK9&#43;AC6A9Bno6/xXqAeej0o&#43;YDzX/Q3/gOlt/6ns2f2D/UewB&#43;2/rWeq5/fsls8dfzvsu/sn5Xf4T0r/F/m/8T/c/239Uz/W7/PmX7N/xP8b6m/xr64/nv69/i/N60/r34l/IX&#43;k9QX8h/mH&#43;u/un&#43;K30zXP8D/tP8j7AXq/9F/2H&#43;T/Hj2/veP9L/b/Uv8p/sn&#43;c/vv44/YB/Gf6P/sft7&#43;Mf9h4G/23/T/9v/Y/AD/LP6z/x/8H/qf24&#43;ln&#43;g/7f&#43;n/0/7ke1b9D/xH/c/0H&#43;t/br7CP5v/av&#43;x/ff8776/83wI/dj/&#43;7p&#43;0n/6KE/gUJWHNoOlhb34XoJ/8hAjk9HDyxjw9ItCWfnn0SwFB8qXot5Rx0azibEBNV95wO2yT4D6mcC0QyktBXNjCv3hJv7oBXjLz2A3zYcRjsSiWQ2ANVC/rFE7M/9mA6nZmBriJgEy0QtUJqreGAYlGYLzqd4Fk230Z&#43;nJU4EO8B41cAiv5QMcn&#43;lZ8xVzy1Zwj0DIMLyCXQtqBP/X/1&#43;ja/hbNyQGePUnS4WDFQreRDRyPegOanqGTpMFKwCxdXft2xTUg6MhVDYFyM8mmTI55vCpdsl2&#43;r&#43;Cccqkk1wlYstBYWPSIs9MnLyp7/AxC7ihRvOyPdKNEVv2isgT78s&#43;dd1KoY0/8E07vMnhszFfnwb9VPz8zLb0b4M3XgUXHuXe2O2xIGSacZ0c6vfMP94ipq3xb4t8W&#43;LfFvdDRy9aWTmKLeRFartIJK7q7vv2No5JPy&#43;3eIgLWtyEzug8BUAAFgfsU7&#43;yX4Ih7TkyY9MDB4x4S4UF00pYnB5g8weYPMHmBmAds1MY1pRpP/DdcHKyW/HWFkVi/APD5tcFDXE0eWdZTZRk2VTOvs&#43;5NYslkXhxWmTl78W&#43;LfFuMHPWj461PXyxVbvKjKr5rltffi64wlrFFR6eePNX09VerIpYJROPB5g8weYPMHmBLBRJ3oA7M3Sfl&#43;lZH2hBjSvTzuRjUQspWpak5Pr15LGeNs8CZNpjB1Or/CpRB8r5z11HDaUTjweYPMHmDzB2oxXt8Is2W5ANOJpmLOSLUQMJHEki3ctjT3Uj&#43;V5U4NgFob9hElOejFuqqWDZCFS9x8t7J7z6CxIH5X/WobWskCPj&#43;O9MnL34t8W&#43;Le6GWVp15IelrVd&#43;r3txYZiOUqINWrXlMYsTjlxslh&#43;e41L&#43;zZTr6bkiLt4FTLqZzH&#43;WD1ZKed&#43;qEkvZm7r9BLXomPNjZZLr/pikvHRgZazzB5g8weYPMHYNLhP5EDQlkoz83YXYtyCqTasZ4hHDMayIa4mjy6e/eBJrYpfdX4ij0DEPUNJCnieDzB5g8weYPMC33VeDHZ&#43;t9Q3TK6qeGq6uhj0OD04GdCu87a/636Lr9FrNXm2SQpy9&#43;LfFvi3xb4t7w5cF/Ct51pD5EkQKvvtpLKnVDFoRMUKkZ9DzcrCEu2Af5hZhSSZoLMNt0jptFE2iNfJrW9&#43;LfFvi3xb4t8W9zwG3N5kMK8ojnD5PBHy4AK4SNp5DhWj1pS1RrFlk1o/fhOxhpOtlvBUyjxFesHsGiWsqjSMk8EGHAYTcDQv2yauFTKPpk5e/Fvi3xbkvrSyQFNceZ0AEVRl1Kn1Bj&#43;8GFgrsVK6Fw&#43;Mo5VAMv2SFDdkIFwTvrJzIGVpk5e/FuMHIjm1884bzT1AwZ1BA5MqJqgiM8WQL3l4WD5p2OSR82TUEB6Qi/DaUTjpsaJLCOpWWpaqBjt/YbunZ8TzOlPEU3HoOTBx7Gb0ntFIq&#43;LfPjDfw6xKma6xPOXSUFxCRaX7s&#43;3qGnOsBGVLfFvi3xXQnfk9RkvmTXxAYaZOMQZeo9Y6vSj6qHMP2y6Ea1f6Ae7Tp66J&#43;yWCP5QWNuJTTir4MD8c1IOg8&#43;hQ&#43;mC38KizEvLvdSHdreTWzQ2qxlrsACfrKhcyYCecG/EDLOKIyd9/BgQzkSIbAAA/uCiyelZ2nC62mWFWLl0XT/aFwNzvzfkWjIsj5JnaAIlAcLL9H9Lpy17T51AAYTKYlaBE6&#43;Q/oC8DRRbzlNM8l8YxWoAUoVRGyJ4JPx0dxPUnuYef&#43;OATSFv99gVkfcYN8oyK3U2HJSKF0/ydaIs9gm1QfCjWrND1Y7FPz&#43;pRqEaxBnwxTtI6X3fEcx&#43;wbnrT5Zg2kMovZhHjmU3IYqek2XREQZS9ruFBUNPx6rQkCSOy&#43;ZxMGu6WtuH2wz7SjPROBUvz4UttrcRAFJvTqlSqKPVR2aJScsE6qSQSGylEmnx2/HUj2O6NwBodsvHIctzFF6zAHIyIDcoTFqkBfDmX9gOSWAa/JzMFhRTSJO9sR5zXJd2ScE4cumI/hRhufa7s11HtTnVbrvbrga3fIJaY9Qe7MR9wh2nv2EAzdkbzjc12vz16mXM0Oo/EtJOyt6DT4Zh3vWcymTA54pXOcwi5i9hE4Eg44IAWejBPa0TPhsrjv8vfTix6Mv/8VVC3Y5dlY6pfGJWSnBxi&#43;NMQuluDmkSu56Z&#43;qadVu8bQoIWfaAyzM8VTn3qFoy0xIsyRv6RgYcXn4E8TUHqCFZ9FgOlRbNDGa3EldTV5ykBGhfaCDN5Jk3H6gXL0Hcizb&#43;kaJGvUcc0aPZMTyIzOD5Gq&#43;&#43;s6wKYUK7xN2PnPkNzSNL3jnOJPhFXnuShBzguU6Bf0pMczRboNEEiUWzKghrHBYTAIii38MTgWlWfs3hbtFp3HQ5uiFeLJ/fm/shcvON0JzPoO/8eXII1q/hyEn0vMQRLaNBM0z/W1SwNN0WrIhcFAQ9bDe7MmpRFbhvMc&#43;1wx1Cvt8yEoGdyj4IAHGZlIbwi8YevjAshab/SVEB/QWU/s8yXhVaDm8I1FktUFSlHkTLs1nzbiYADF&#43;AcRcJNIV0FqHOgSW7sftJNMSPfW&#43;V2FC0E6Ml7OKRD1aYzl0tTiigZoK87LXAsz4r6X3Ht/Kw5rA&#43;YLocvwFfNWrT6yEjW2JBo8IRQENZ4nukjwN6uYdXF4l4q7SIbs8KXutJWzv8RhvfD4dz/29MhpJlJPgDiqYDssDHN8OpaYubNDu84HxSIuoY8xzhDdSZHW9w9ypRz0gJ96eyuO/l6LRsxQQl66gaYluVShHYwKlsr&#43;gO5vHAcgs36HjWhda953AvGFtExutTqdh7ETk4Gt7IvsjUxF2gXPsZgj0iQndzbwAd4LN59d&#43;8chPFXk0CUyHVX7BuFLWWtPwjMxcRCDQONs86/Sc8EIB6e09Fb5T3ESf0DMqZfrnXctZ9Um7w0VMHS5QesqEPlEbUbcrILN1j0ct9lKhfEGaB44A/voL9Uyi7e9EqjMfIVXiFAenYV67y71VB66HxLsJbPxye/MmuSFmKqySdAQPWlROu26goyjwJr13lmB5BALijHQdj/a0ineW4np4aYerjVFCwm9cGsl1LNNrvsYf/LHVSFZoucInojBZgrzMxfGnDt52N8yVJOayS2WtsVjkSybHlTGvt8Rbbne85TQ/sd6c0ocaaEp&#43;t3GFURPUm7dogVAPAJOvch7na9QB9EEpkSPMILBcimPFZ1i2zxMQTy9WcBrvSiaZJ0teWE1lfukedndIctoER1GkbmLEDGcFNn2ywBNGPx/dN25g96vjRI0wDll4HgLU1eDJrcKxDDPfA10VYDNoSqCzr32tw4d8ehgW4AMdKxEFccmkUBN81FC22H/aenuxPpQbFn6YN/n5n0T6tKRqC7HqGH2i4&#43;e6ffzYqZ3GNDQeQw6m5TSZqKK2VXoGoiOVLWQfP9h6SRNQpCypXRiXzRK4SEM5hfBshjS1q/&#43;T6I/TYbrJfddHVoUcsQ0xLKpMXoo3rjFGMpqdE8DyU9wnAHYaeWOHcW3xyMZKMO4CgpkpliZcQ9iHSZH35NTtPbYbRRsfFqqWdPA&#43;k9uL6tir8iK4r84xrlYFneAGm66XQDaT1Pqfd3AWgKC8FFFwjoaL/8Pcp56EYF25vztOF1tMsKsXLoun&#43;zaxFQOhLneuAo5QR1E9nh2tBzWggjwiM8kNctx1XkN/K&#43;rMK1ONf7cQAZeDhMZjtFonCwchYFdx56dj1&#43;gau4FK2c2zsrI/5sKF&#43;MElO2uYazVL4vhdZ8filbZWvhqdVOgLkIIrnnReGJiaUEVtAhnGF/NkD4LYmrQAb7uzXeW5UwJYu1SfQ3Lt2lS1EL8HnwLcxDPAkpArp6HhpF&#43;js1hlbsn0OJDojZChny/58hJKZskk61lZPmfZSEmfSgPP/HeoMO7V0wzDRDupr/egycApyyurrP2QuAq03pLVlzzgdw7fvSM0Hyat3wqrSFzdo4jeKeqZmsjT/6qAJ&#43;9fEEwzBRaO9e8/V7zQX3gfACdkb10/hXbgkP9b3J1oNqsZsypLk4oIbZPQudTXWqug0tLn2AbLJiaBtzV94hzrd0CIuWHfc1duXL4Hb6RJ5pYj0mYTgcQsPMwSB4Y4PwgU6VREca6sOp3Ger7K2a6e022CLiazfMAWALMi5bWd&#43;J7MP/9MlKAcTceXh0ovucFmUgHOEMO0MdfTquYRtdab4Zo9o8Io0f&#43;Y8qCVcRi6QJItbUTBxydMfs6Ug72ys7qC&#43;Ug1w/xxz3izaqPy5znKbKXAFqibRtrUbVBXNYx/M/ubBFHD3/Fe7d/PM5X8AAcVoJIJf1M9zF5PUDsZ9EB4iBpw0zCVqlN1UlJD5rsqViTfXoBpwMJVq0jYbewkDtntIE9zVMxq&#43;FYQEb8AAuWjg3WWYp7W4K6BeDuZgHfhgE4KatnbfzadDjs1AmED/9EDtGJieKX9eqIyUlLdj&#43;WXjEYloNyy46uOOsm5bRpzWZwGnDfZRxzkyHAU68fGWJlFfSkZPG8T7SKwVGzX16&#43;RDx2tHsmxjAP&#43;/ZuxFcoJELPNfAcQFdWnlRhPTCFD9rSSBHfpp3oIxrVNCSRYflthOuJyOU813f0KB8RyeS6G2sbBggR2AGGoqPTGn3TLJhZk4TyRnyqz53l3J&#43;w989FQ4ILOA/8BR31RNlRnYz/Q2iKxPXIBBLhClkizu0UhHgkH9n5CifzQfKhB4x73OUImECN1pBkOts4OAliTzZhK81vQdJRIyOXjZeYHdZbpeQcmpHoFSqGEReqfd7LmQIAOfEKsoWIATalRzOBs7odsX/db4muePDKTwkiYZBtv0FbFWhE3LKBxwAHfOYSI3Wg1yzYfIns2Q59/LIGV0UrcM9mkFk6A/d/16kYl6ABBrv6Up/i575ewkW0veZrnC4IMpAOq/PjKN&#43;8lkrbLMW42VDWv2ut&#43;n91sAl5kUYy367LFxapPDrgIYSjEczaY7zUfL5LEHuuRX0bBWjk6D5GvOLi4SCDR3a8Zp0fp0TrRNMNtW9LPmsVZE4De0uLOIGB/Oq3D7HdFxbNhdg10mAiffmIb6jvCHuzJ5U7hHRiocAE/0vvs6lSBKt9FRjqSHf6ZbQGBNczsHl5TLOdMkqINzQu2aGdRcGLt8vFPE1vH/cseao155a0wI6vO0E9EhduksryerfxwuP78iC&#43;Impf1BkJ8e4dPMYOe1CHobxLCxbJP6/sw7gMH1uDo1guBik1wL8mxo6LVYwOQP3NqcA2aiZCtlQtTz&#43;IFiAMPsi8ZNZQvpd8p&#43;FXlk6FguERMqVxnb9SwyjHriaIB5kPKcWs&#43;HZQc9IZgDEExkgtfzKzSuH5OYeq6NGFNy8uYhs3xgwQXO7FAjCJD5bT9JfUbC8fP5vs6vFZL1VM7v&#43;W4mcldkcuWZ4zRmTYBwWw/5fhAQZbjkVHIDlM9iNurNdVOOXh6vjlzdIhdsSJLE596kgdjlQlo4x9iB9AjMJfzIb6qXSP&#43;egeMXr8Cqxw6&#43;DVpH44xo1BkDIfRQ5mqlgLkKgs&#43;JGmtpKxdh2GjPtiuk5CwrpsNcpBSJ2VK5wt8eMayWwwjak8nPos5vTFZSrQDVqg384HevldV&#43;apJENkRF7p3B9DYtyt3m7ZcNtisthQ16UHCQBj8epYXik1X96rjKYq58RtLQXHXcRWg&#43;w7mMqRZ922P&#43;BKgUsGC3tq96sgXrjh1JFDWtYVTUirxEXWkWiSrn6hDMxG6IMpAH0pSiJx&#43;pxxKgMWJ6eTn5MmGVytJtuHeTbsgRtEL3xzS4WBNQrNlc8XCQArx9qxbphbkjiKpVOqvlgwoPb4sCawyyk6Wl1S23ZkjjmRwprNkCTmB3AphXSN41ZX3ZHxZPFr2X7sGDh5MsXXydb2YWxi0fgUVBJDyuArjKDb5C/3JjvQTZEmKQkApVQXPRhd1/jAtcQgiCWtsY51CxOurKygPVEs1vkBe3p4T6aTq7UR7Mm0NCdi5YV2a4JMCilzo0s6uHaFrIffKvVGq4SBx8vPPIB1LhCVcgwae/kHIZdGr7DmfkycMeu28jg5k0YCsmEHd9wsYdRiJZY6wCvE7WfVka9hEDcFxWmCRwZOwjUu2RtdJVyb3rbxxrM2/fAWEBfI0XDZpz/oSJhWs138ZZcfw0Rd7X32kJ1hVpwCA64gE6vbuKw3h43bAL9IIUTj0bC7E62gHX1m9dtAkcf7faT5iG&#43;o7wh8J65MRT8JRrZt7AAivfMMNWSEoWOax6EvnMneg7Rt0iDMDNindKeIaI&#43;m6YrLGH&#43;r1LM/wbZbdVjf39kqZLIWYDJJU2593SDlvBN818d54lNVxqqcXdyycokrqeXM7SAd5OwAarnnmNAjwS2WRTfPD8H8ePMlvisRe3UyXzvCKBnbVgDFOcBYtYRBWeiXutH6HXw0A7KnaEgxf&#43;14jkZRVnPNHsc5dTkNs51Wh9trAADZ3elhfG8eHYZaUGEqdvHsCwG55ApxwRzFjS4BNbQbDm3mNxeWO5vZpCnLf27RloSSrZlJSmtSEZaFFOF&#43;eNCByF2NMDLXpc/v03HuP5M3CpNq3QT4YTNUqhTpT9vRub2q/PACgGdK4508HahZ3fZnaOTSCMqqxPrdC6ooR2OEtdQBTvWVGHZvUhV6VjcuxGtJMOD8vtiakQivta1mPc/PsmdxjS4pzSrSt2n1WvAAA70Wxyy4uKgD7m88j&#43;jToQEDVWsS4Q82SScw4wohTdwATUunuMLgzp4rKqRZX2t2t0N3e1m8XyZi9MHXZwBwC6TdDoG0r8PtD7dpHHCFPmPpoGq3HzItLVJqAZ81Ro2/expI2XH&#43;r0mlxFVlsbXMpsX4WjwnyM7MoucCPp5UoPCZ/U5Q1j78800A6jgVTIyhBq5k4qdQ7qKZ3lfwZJgIOg8oDLF2fyhd/Q5eMXbT/GbaJ0ebLjsZxC8VqMRxTqpJjziQQZyUG6FZvY8MvAXO0l7dOOce2WmpRHUSHgZYDrYS6/9iY0gNj7YR1EH5nzf8AUC0kBmdNwpjeHfJIVH7NQnivvvdVdg6rp67s6EFN/RzCR8QJk/PdH11NbWNOiIV6AOpdxecxfHS0mDK3SMAgz&#43;ODpHUG0J1/noQAAGfLyt/lDW0&#43;2pS3ycBhLF7ISJDR8M0fGVN7xraW&#43;yvaW0ssg69OE/yP1hk/3jzG/tHI0TSyltB1Wo6h7197Nkk4MouUCwBw/HkzPBjK0&#43;dUgf3q3VRQeUYq1/c8kjw4hev3sPv4oGwDA3dxb1sxC09e3e/mjcJ4NT9Pl0gC7JXIeovzQHYUVnh2/MsTZN0Uh3gq/1/FBg6IYqSjtEXDFemBctTFDIvOfUrQVfGXIf0&#43;6mgep9qp5&#43;MpJAJCyEdCITjpS/CTNqMhI2dreqUEnrt47/Mx8n2Txg8okhKqJIiDmRJVE907SgYBUH1lRuVPiHW7LM6lCWGcs63d8mZmYTazutPKuQa1IYOFCJbks9S57Jy/LRrxt/Uav8szqDi8Qs4GZnZ8NQsgY9RSUDrkvBLrvOFB2UXVAgucXyPg3YkDA7SIm7kuXIlfWJTMynavPKQmS3Rgwsm&#43;/2Mc1bjp56ykTYZT8M6itr&#43;tNM5DMZN3O4q/4v6a5njJdZxHWdNP9GQOFLBdFY40PmjF/N7RKxI1L8ebFVahHI3opHxa9UbJt4yyMJQafJ596Eetpm3qTYuANFukETr8Z2eKwepgwoBfA5suhJjRCTGqr835FLqXsRcw8z0EteDc9ybPD9DuRZgCGbrjhEMs&#43;5vKaiyY&#43;/hnLpz/ZAaJIUBy7DuntEp&#43;GIqCghesJkY&#43;3zgg/Y9Yu1fcHfWBB8YsscKAPfCVRcK8BNjguRPQ&#43;sTlBJgXBUfOGaBbK7RDI/NMROcoKuIXuX1fapwOEwr/DNhqQz&#43;WZCEzdtXcVVlCJF4tQwGLuRzRBRez61es3uQVIh/RjHdzaLsgSyTQYaYFDDOlzLkOxTMCTJ2j/70/lT96oFClalMPZtANn7lxHM8KwcsU7xIQKjouVa6NT80Al6HxYW7L2mm0n8n7LNbeqI4Y1OyPEcA8mE30eqBGIAwPjUpS3SUNnTvWaW3HVQSNyw4TgimdjVKk9WNbbnPSLdoBjK3uNSpk&#43;Qz/XMPH1ycye45rK1WmysFr0Evnzjtjx&#43;5PPjRbtJ/1Q/5RBstpJDvkS7O/&#43;XBpq119MGKrgi6qZ/IZlrtsYFylU3U/AhyVXRKuJ5iaWynwxKtsb0lLQFKKvzcKg0H3l89GC77jdaxMWRJwqLnSyxmEiaCCB9eb/RmeHGgg4KmYa3c8PrAVWfke4uKuF&#43;tWtccP3XLynFOcNVf3VnMo0vnAWjitcCkx5rqyEKMX1lCHXyeNJjv17iqTTg4CI2/jdvpeOFzRDLd1rplBktXAAF83ub7ilC3ZMWMVjOKhXOxaqIOO/DuU0sKCs&#43;w83QUCrqRmnx0yNwGhgXmnASzw18ckDSXbdERwZh6DFzIpItfsfzR4trr/UoMA4q1JMGSkdR/MHrJWXiy4W80e2G5uKOQl/Rtu7vTwpT9A/79m7EVygkQs818OfANCBtgKwVTG7y/W1/OUUvpCEvhyCvRy5q1H1zuVXq6iU1FarHy4Re1BapneDUH3ZGqkGO8p&#43;/846XtdNaRIokos5De2mGPdhqfBVL3LPZcLbFOj5ArbyzzOYE1hXvvIHqOx6/XjS1tSbUXqoUWV2KoA51nodtjZQXHd6XejtOq9v9tqmWWyOQ50fec9seNlvIEgAQzKwhM0vl7oBemRzegVdlB0TCteOJ80ITZ985pMyJTkFtk0kosdHt1c0hfmenMMzET5DfS6FLHATGqJk3bPaJgATtdD662L6K7&#43;UVUGG/gLlOG0a3qC3TphBFLf7z48B3NI4ZrT5cHok6n&#43;ejkZDV&#43;/wX1htnUbdnvq1ysCxfjMYJ&#43;I6TY&#43;GoKhEbuXVBiAWE7VbfYz&#43;2sePSgKEGZc2bszjZKODoW5cC5Fy7JDptZHBrVjL1/ar5hZAasCHwgSQH25Jgy3qad6NyGk1qasUTg7s0C/NdCu5JeaZPW5cAMT7IPsHDeXKZFt/EulKmW1nZB5xPcHR7KMysNV71rh8cwGXBddPVzedbng8CTXylRaGAkk1OxKO1J6Hf4reCNBu2VOUBX2&#43;3MRKcGe2pu4gRi1fvndqHvEekD5PDGwYK3NrLgPpMM3vgKBdfHXspbQdVfuDaIy4CNQFcRQ89l0cDAgeNdiHboRX&#43;jBs66D8yRx2kLBMqMGU1puYpxu8XjsnVZmgj5zmqxZw8jyAMizEITS/8Ni0&#43;WUNSndQZ6Qk4E9K/W/AVoUxkUesLCtuy2f3wYuRYowf8qk7wVcTkaAvJs0vRB&#43;CldgvT9YsKvyWb&#43;sw0cln0sRoiVNz3RlodvJ9Dvw0HDMRqzdHWN8GXJSAMeyOixg7rjBLURlSC86fsVvWV2OB0zc8Ml4&#43;ouNZLm9cLWXj6v1oxQ6Z/GJkP/7GzOydV5gwtlsyqA3HLejdSsImkPCuYMP3r5hLtfakrJUmAIw&#43;iG2wmM6FPMr7kAAQA1Huo0EZ7i2fKpHrU0QEECYbMJljEYxAzxHlEH/wqJxpfiqFk4Aev3tMUWHCO7sJssGdRfMG5GgExhXkAvey6zclCU4WobO/ChhV3r7AOfPJUiM1&#43;RudTNsYtJvQyPqDOsutvCMU2vgK4Yq7/oCeV1zF6Sx3/X1EVmGynEVCgdrHMwbQvlZU2sGhI5&#43;p00/Mq8EFme&#43;rFVsB9Q/&#43;kSgQ7jwCkuiNmTk8GcH97f4lC0ZRfxNlIKCpxFeA80CErKb9X30uY1d2Bn7CcghNSdgEMgx8LxUGely7wrhpUiFuUb4cd43AFbKO3fvMabJsvd8kEm1roCcKJbKQveV8f4dxQf5ybPpf7ioWqP9kxTnJMlsYtH4FFQSQ8rgKrA2&#43;Qv9y6&#43;aWr&#43;DMe5VZyffa/bBe6sBWs822wXvihD5dwyI6Aw1G0U3zuKj/Twn1HX3Nudc2XjxO3ChOPj&#43;RVgvDgasCMh4my&#43;62pmkUVKIloQFxiCMbqGbrg4z7taeQ91i8x4izeubnt87TiSW4ibYCZVAHaV/i14ZEZAQhfyLqfn5n3MdeWxNMFYkqtRa2&#43;fGZkRDzJkUyRH7u6X3hsMCBhokCfq4pHgv5CRxNr&#43;FINYIWz9pIRcszL7o1PtfqKsp6XUMBlIvVh28RRiGeLjGlZVY0t67esHnatbfu43femk&#43;NYZsnI5f6m5WEhAuRB&#43;7j3WKq/zH3wr0J9tptKxObtLO45E1SAjMlg8rxJBKqVFoYCSTU7Eo7Unod/it4I0G7ZU5QFfb7cxEpwZ7am7iBGLV&#43;&#43;d21uPEcaBeBFfNCL2OuOqEzX401dLBN15BoC8enpF1fu5yyfokPrt/qZunMhKe1WPCYs8Rum1B5RepjpEKyS7On3ilvUs4qeMuXPjSaciQq&#43;0IhAHF47J1WZoI&#43;c5rwdwhWAFJ8F1oXksbyzeOnqPn2l/T16CWrNFpFLffplzpQxNP8R06S7NahGXlUdwE4iGpaCUndOIOAOQqLxlcqZUherjLlC5kYxGYVgE7y8lshomalz5oH36vlZan&#43;p8txNUrERNBO63k26sHYUhFbQOCQx1/m2sr7rOs1usNgWd1C9K59W8nag9jn4BBG7sB5KFLt7OYJDchKPnZiKsLV4kHZEpTPh3guP0FHD9mzdQFHnVG6ZVffz5bX&#43;jYZPxroe&#43;HoSytl/Od/2pjKDzmOYrJ2OUsd&#43;7kf9OHgBW6I&#43;u16&#43;pccjcaeGTEr&#43;LU8Y8IxNJo0OCNvmX7Gb3mCzq0SsQwLt61ZRGfAAj02mQpVcIIIYBeeIP2XdkgFx9wLcc1pYVrbluRLmjUVP/V&#43;umZ08cd4R920yIvji3FIT0n9/1oqOmmRfgjPjrbimgXOJ2GmRsyi5wI/YYLmxySheczDRPJ2a19iDgVTIyhBq5k4qdQ7qKZ3lfwZJgHe1UIgkBWBPynu3UuW8oOyA4&#43;/l&#43;anxz7R0b4o2bSgvAm1Q7KlfYOxOxVKe&#43;GYYRDilUcbY91Ysurexdgl1lzwep7IL2y/sNoBuKGO5y&#43;ZE&#43;InqIgGrObEUOl8H54vBp9H2aALwnCBGdRCu25FTpzKWDBCawVplc67YhqpDDZFi/rOhze&#43;G0idHNvDehGEW8GLf6xkAApnz3vKLphbbpcgA4YiQ1J705mA6w8OljJHBTALzeW1J1faogG8PTpnwScmfnJ9BPeD5AuCQlrG3JWjPi8m&#43;pAMtZ0KfWpivEjzVMuC4VITUIiCCwciJo5ITbB61FBNKYF5H4dyipefW/6j2hKZi9C737Rh/I0OKwRGmYMStVJIMdpMMBSkh85b47m6&#43;j2aYpotQZGHLg&#43;JhmhCko/33/UwHzD&#43;QhNvyESj9mUwMhy0MTLGSQZMHUEGebaLypKGQotzf/IBcSAtv6VlCRxEUm3yUx2J7&#43;Hf3qwLSwR1Fx4M5k4fKZ6PdeMv&#43;qv2RV&#43;4Uv1cgcqkFNoEOv7En6zoRA7CED27ClAOmDOa&#43;vPob08Qot8GWOWCT1qvLNj3vfXF74Lgh3b3tfnbJarS0Gz8DKIFoWESvkpInHMDS0hFFrcFpecQnyQRv3FxRqVeZEvxu8YQuXv480YuhK6KXa9gbpEnWKbi0tfVDM1Qe9iJTEQugkZtxLENYxRCEmYybudxWsX3BmnSPntQ9FMJZf6MgcJ/aK9zggICMLpfV7pRe3EICnk/Ef/0g1q&#43;Z20oiQ9uTFxG2bbGMcKco632AAt3pWdpwutplhVi5dF0/2huZ5jHK1yaIzWdexxyHqlZMFPQMaf0WlDE&#43;gO3&#43;kC46oEDoWkSyBnEtSJBvTSvXGgmQDvLre087s4OqpKUU/9Jr1NRKd0b3Au1Y8O7SIvRGnsrKDtCtfCDdFqLDrZMaWaB9ANScCN5IsJX1MVvxn6xTRWMPPH5IZfiwouYNLcWbtsbvxBsZZqMwGMIrhSkdfx7r&#43;1eGlaMq7tk3&#43;nZgeIR9NTT9fPAOI&#43;vAGgT/AR6t8t4PlwO9d6Db8OhQnV/MKuYvwBftnDh1qA4uJKx&#43;0uOq&#43;8ds&#43;imo2sU/dotxX95zpKX6XKFew8&#43;eLWGD&#43;HWc4kf/wSX34ospeWUfMKKzrgvUmqvDdmBOYLbfKnI8zB3D2551jjRhgSPyMl7EXiYvjEv9nP52&#43;8CvT829HJ&#43;PKHLLnsV4GhRbjvFsdDLjfxoroaHn/o9eftX7bvgghYq3y4/PSAF5BBCYz/ys/rCrg/wbs0w4pL9LWJgrcG03s9VMmtE&#43;PQVLCQ01WR3Y43a90CGl&#43;NMvjPvun8odKToZD8AobzoOuhr2&#43;25ryAgnguE7Y6v8l7WZo2MJksxSOIqhmcBWW6tQ0Tg&#43;8sd&#43;wSF549AW6ouVPCatjFHHkp&#43;sqDQi&#43;UaOwGxk7aLNSewj8M&#43;6OFcxzQanvgIFF7Ge7o10cx8EdEpnlWHB2PjNJ9YC4GDTlJR8&#43;2zEf&#43;3j2XZCpoOGXaPI9RmcuhOdaQVjYUlAj/Vm5jKD7USImCeKUhoPw8QyU6rBAAC2/vz8BidEiE51zbmVgzbLpDxTy5xum5Q1Pbfk&#43;xg&#43;lrvJONqt1Z4oXnZ9xqt26Kzlds7giLH2bsvP59&#43;J7yoP29SCbluKLwnikdR/MHrJWXiy4W80e2G5uKO0FGTpNi4NgKeZdXzIGu9WxywYk39IuwuO67akYWA9zTc/OvrLgY61MzrSuQ&#43;RHFrYFEdPZoHyU1FarHy4Re7CSPme8MpfRO4LzB7YBSnlOijRGd8792b8S3&#43;qgqF3F5Vf0iHBoCPGYGBW6ipcCHis6HBMbDIhKwpAzBri0bB5T5eyuRQuBw1u/4kpeohqwofPNpzTtrg8r2OhRYRxo7CJnz0J3S/WzTCOb6kR1nKzyy6Gh3fPI8CLsVp0vN5cp2dDdw4nJxBBKAI2gVbxlpkqabokuvLIkRJ7OouWivLuFZibL8h&#43;cGrOFUqxOJeqrNIea/a12aK6RWPVthwxULZ7JzRJZNKVT2tkUX0UWqv1v8ZbMpl7I0RjjzDianG9WlVDU3hZnWFU0K02Hv2DnZl&#43;ZaDefAxgZ3f7xrznFerdXRqC8NscEctVX&#43;Kz/Vpl7OidV4L3jauzrQEWi1DjHkTNpap3t0u66&#43;UiSEzG8XP&#43;7P4gn1rh0fFtcAmq1R/5y&#43;lEbzVKa0ZaCAdp4WF1iQuzhZPfjPDSAmxZ/3/buGdqIj231ikNT8etHYjEWxTjo1Ry7Kvne462ZoiTv7Qh1HvG0/HEPfIvvyHbBV7dPLNArWlSJWh6PlMNjI5nAR2iOW7HG0KnJAXpofuhHwEu2yptZr&#43;S0tZaoWCf9tTh64m0aLqH0cgg6Aw/isZEo3NGhMVQhlgkTHt16iyEh6ntLzsqRWldsc8PSG&#43;pGgp6kymGkoGTaHha6smVatMMXHpy6cY4jcROGXfPSjM1kqYHUIEqVyyFimWBoIXR7knByVPpLEsJhcCdD4Fzh2X9odvJW13KPVmhHIxfTNd1UjjOSKIEEE9kLPj1Q2sEkVvgvkrd6NgOifWFcYKLYIiVlzysenisbN/RgNHHsykQifxjYoOqzWPPGCeSntkqk7T101oj3An/tKWMaIDRjphwlmNcj6RW2TEZnD50OyZm489&#43;WxRBmRqhNndrFE0d&#43;E1H5wW1bJxffIBg0I6oHwMbjGMk9ZWU/EvGTfeAVzyVPMoeDOHcptCzWKoP0&#43;zAyXoyXN7QpNi1jCPVvzP4JAapRmvEtAlgh18l7wgNjsA0sP2FbrH5mmWqkJiUCqUhVUsc0VTKo3HBG3zL9jN9XYt9sAbjX0Yuq2KDxhb5CMuE4QU/ldtpt7QNdzqTap1SWIS3RmQ5ZsiPqUp4r1Q0x&#43;C9NiadIZ0anDb&#43;n7pIylAIraW2oyAbtZD0nXcf3SP8Js6p&#43;KE9LfFLe8nxT&#43;7k90OW6FAVKawy3NeBA2XzXo&#43;vM1yYyFLgpPRF3qD50FkkGACitvje8iWAq1qqz1W5Nl/cSD4RuU3QY1pluqMu0n5&#43;C1Sae96pVuQrBXkqD0RybLR8QVhf1gD8mQKr1OZfB08noza9lG6lgvVRFeLzxmWmLijRv6/FD7OsDPicQMtuGZEH9OVm519Yry0D/Gthh1oMZcVkw5NWoHbTDowIsvmY/efQ6ZLzFbOld6gQAS9nrrzANJXDua&#43;HUsK51wG/w08o8WApB3BWrWlvsr2ltLLIOvThP8j8TufTDiIJXAHdttuklGHExLrgy6W8gB23Sod6eM9WceKjo7xGvgZ0cp5I2V6BTOy0DTziu3UizwJTMXoXe/aMP5GhxWCI0zBiVqpJBjtKvAVpOYWAanafryFMfsd48pRZgi219K4Pu56YHBbtQOwNx5t0pQUDyYFy1MUMi859StBV8Zh9KHMIsNm&#43;af3umS9zLskQ/6MtSU3QsU7rLezUAfOWoi4Bliw1hWRa5oLc44yApFrZ4jnmowmSchpwsaeNSthoePZxuvjbgEFY4HqGB7Iq&#43;B/AMZI&#43;699ZteHxzgNbO1Q8TADjN&#43;QP8ry8FvCKpWL0uuAQNYNUOE1zTBW&#43;xo6NgMVDxhN30wrIALOF7u1NhT7sJynSf&#43;DR0wCqgBmZTFrV3Lse2NbyoVAt&#43;BaxreF&#43;lCa6hIjkx33pwWlY&#43;JOtGLUjpQwamKF5aFbu2CsdYhSq2v&#43;z4AoXR8MoUUBq0mmRcmxjmngkdCLZkpbCioBQuzkgixiAmX2nLK&#43;MYBsZhNIQJ9Q8KeTqZrLfyBgUWWcfoF2M39Si2hP9OOrMVds87eXCFxzYevgWgODAdSbHQNlhLEKAU4XH4oBZzH/fdO1naW9O6YvsOsxJzhy/1Ef5sLuZKwJlbBPGqbJLrbAqu87UG1H86a&#43;NwaagA/CCAV5QXqf7LRGqTjhSR3APx4f691ATx02rxnCcBkSq4XcUV6AOIsvmEXr5CMga82He9xVFddTE&#43;mHSKL9d8NyLm8eaPd&#43;nz0CC83z7AayEtO7&#43;rJ4DXh6PmNZp5iiw3q2Y8UB4mDYjRNNw1DZis4aE0R7WeD7f5T3N&#43;DvrmwO7y&#43;ksGwJBA6EBRqt3SuNkIuiEz1bTNS/UnH9tVX3I8GH&#43;DEZqZzgLLlqLhqvb4pPWZ3ZYzboXEsDF2CSZk5qOjUDcoGDH59q8dDyH/oFDylFmCLbZRUTpyl0ErWUK0PFsjTFjbgk8hD9/SA1FrfBTMwmeLfkHeY02RUO2opM7TkopVtql7tGDReBmoIiuhTSvQvNtkT9biGxTYeMK1MGWURRT9dxlthU1da/2iaWN6DFxYOZjlb4M0gV5BdfdrAyMVPsDClh/s4y9UqUvSUoLSSIKBdi20WHs8bWyS8hxNk2NyCsTRMnryNS4dzxFTnjsXKVkSpoDZXfVGCjYC9C7aUF1rqGWWYDuCMpOn9um8gcOTrGVSdD03eo7yPGTobl0i2FJpmH6y8z&#43;rLPigtzjYakKQnVJKpQtE3Frjnm/kjPeSuua7IMzIEO3HK05q8sGCZlzIe/neJR7kqjGJg&#43;jbVBi6JFCabtKTTsziAA5LFW1jSk7kLTfP6fzDxL4D/ZE/ML/krMLVzigCMDQ8APmbSwkAucjaaFD05&#43;P0wcmS/N3IsipW5yWWGqW8UryUICr44AP/alGAPApdCFEq2v9OuB81me/6OwSeNUOa3EyYUA9Gow9qDNOzriow&#43;tXIXp40D2Wy&#43;tAofsYoXgkkvh2F32yDA5rjyvdK2buYP6bKMfhDAUsrDyXSqnTEQ&#43;ZR0UwGHdkYvBE2rNxagqZOui5yqYi4EFSHskSYnwfVBzqfNazpusoiSvVh/XyrjXQncQ&#43;aw3DSTS/mzKyKXKcmfLT/uS3YvqyeRyK&#43;C&#43;qz1Pz9&#43;lQulIC8HGgamZ2NI4fHU1pdHX5Uv/29LPWrGuGgtc2hkWak6xlsVXI4sXscztGH7nbLVuA2M8Dban9f2yBjC9NK1GbmYb0SBpvfPP3eJLgoDIcnHhTWe26hDKjs&#43;mG6fO3nZwXVZqa7WT&#43;A/ha6vPBSfYvgtypnKYCoU2FJL7nQKRg8XHzIG1KVRoq80BX8iy3/STUNAUlwqLswaEBovpw9av1PU1rcZn7OGj02k52rrpdUn3zBT0uX7PAKSJn3TQhi5KLj2ir3jB/7yadDG81Euea3rxmBBnZAs8ex3vgBsri60St8DfA2Nkc&#43;eysmi4rJ5wQ1KAA0XuhVu2SL&#43;GsuIpkUCUjVISdUWqvbk8zx60IKrp/qwmvfbQaUbqU/RqZte2oZWXHm06kPgs01fD3deO5&#43;3w4juDsvp9h7JmbFVaSFramzUIIz5LGzdFZowS2WE3/9gNKKR4YtlsNKUIAVeO3L6b8VUkMle/cfvWOc1ne3hbj6yBOBScS0xek3F2dO4VMCwgLRcQawfc8wFQqJoF/r4CtZkhDy7kaUwoihB67ffnLTMuKiffv36CM5l8ZKcKnljMp4IWlBwsUljYYLtZub8hgtexSqxWg12&#43;69zPL3fe9jISatjcBHD8JwtVXM/IdhmwlI2vvx/PFDhkyqFC&#43;Th8nIzyb42kSNcnAYeq0mlpccdA&#43;IKwCFSqjAOH7tHwQwiOR8usSNzmqK5UNshdoUgWQ7li1hnLVRWD0jK3vROBFlTIGrCTAAAAAAA=" alt="image.png"  /></p>
<h4 id="数组去重">数组去重</h4>
<p>这个就不解释了，直接上代码。</p>
<div class="ui-codeblock">
    
    <pre tabindex="0"><code>const testArr = [1,2,2,3,4,4,5,5,5,6,7]
testArr.reduce((acc, cur) =&gt; {
  if (!(acc.includes(cur))) {
    acc.push(cur)
  }
  return acc
}, [])
// [1, 2, 3, 4, 5, 6, 7]
复制代码</code></pre>
</div>
<p>上述代码逻辑，就是逐一对比，通过 <code>includes</code> 方法检查累计器里是否已经有当前项。</p>
<h4 id="求最大值或最小值">求最大值或最小值</h4>
<p>一个对象数组内，我想拿到某一项里某个属性最大或者最小的那一项。</p>
<div class="ui-codeblock">
    
    <pre tabindex="0"><code>const testArr = [
  { age: 20 },
  { age: 21 },
  { age: 22 }
]
testArr.reduce((acc, cur) =&gt; {
  if (!acc) {
    acc = cur
    return acc
  }
  if (acc.age &lt; cur.age) {
    acc = cur
    return acc
  }
  return acc
}, 0)
// {age: 22}
复制代码</code></pre>
</div>
<p>第一次没有对比直接 <code>acc</code> 赋值 <code>cur</code> ，后面进入对比判断，如果 <code>acc</code> 的 <code>age</code> 属性小于 <code>cur</code> 的 <code>age</code> 属性，重制 <code>acc</code> 。相等的话默认返回 <code>acc</code> 。</p>
<p>它的能力远不止于此，它就像神奇宝贝里的“百变怪”，想要变成什么就变成什么。</p>
<h4 id="reduce---map">reduce -&gt; map</h4>
<p><code>map</code> 方法接收一个回调函数，函数内接收三个参数，当前项、索引、原数组，返回一个新的数组，并且数组长度不变。 知道了这些特征之后，我们用 <code>reduce</code> 重塑 <code>map</code> 。</p>
<div class="ui-codeblock">
    
    <pre tabindex="0"><code>const testArr = [1, 2, 3, 4]
Array.prototype.reduceMap = function(callback) {
  return this.reduce((acc, cur, index, array) =&gt; {
    const item = callback(cur, index, array)
    acc.push(item)
    return acc
  }, [])
}
testArr.reduceMap((item, index) =&gt; {
  return item + index
})
// [1, 3, 5, 7]
复制代码</code></pre>
</div>
<p>在 <code>Array</code> 的原型链上添加 <code>reduceMap</code> 方法，接收一个回调函数 <code>callback</code> 作为参数（就是 <code>map</code> 传入的回调函数），内部通过 <code>this</code> 拿到当前需要操作的数组，这里 <code>reduce</code> 方法的第二个参数初始值很关键，需要设置成一个 <code>[]</code> ，这样便于后面把操作完的单项塞入 <code>acc</code> 。我们需要给 <code>callback</code> 方法传入三个值，当前项、索引、原数组，也就是原生 <code>map</code> 回调函数能拿到的值。返回 <code>item</code> 塞进 <code>acc</code>，并且返回 <code>acc</code> ，作为下一个循环的 <code>acc</code>（贪吃蛇原理）。最终 <code>this.reduce</code> 返回了新的数组，并且长度不变。</p>
<h4 id="reduce---foreach">reduce -&gt; forEach</h4>
<p><code>forEach</code> 接收一个回调函数作为参数，函数内接收四个参数当前项、索引、原函数、当执行回调函数 <code>callback</code> 时，用作 <code>this</code> 的值，并且不返回值。</p>
<div class="ui-codeblock">
    
    <pre tabindex="0"><code>const testArr = [1, 2, 3, 4]
Array.prototype.reduceForEach = function(callback) {
  this.reduce((acc, cur, index, array) =&gt; {
    callback(cur, index, array)
  }, [])
}

testArr.reduceForEach((item, index, array) =&gt; {
  console.log(item, index)
})
// 1234
// 0123
复制代码</code></pre>
</div>
<p>只要看得懂 <code>reduce</code> -&gt; <code>map</code> ，转 <code>forEach</code> 只是改改结构的问题。</p>
<h4 id="reduce---filter">reduce -&gt; filter</h4>
<p><code>filter</code> 同样接收一个回调函数，回调函数返回 <code>true</code> 则返回当前项，反之则不返回。回调函数接收的参数同 <code>forEach</code> 。</p>
<div class="ui-codeblock">
    
    <pre tabindex="0"><code>const testArr = [1, 2, 3, 4]
Array.prototype.reduceFilter = function (callback) {
   return this.reduce((acc, cur, index, array) =&gt; {
    if (callback(cur, index, array)) {
      acc.push(cur)
    }
    return acc
  }, [])
}
testArr.reduceFilter(item =&gt; item % 2 == 0) // 过滤出偶数项。
// [2, 4]
复制代码</code></pre>
</div>
<p><code>filter</code> 方法中 <code>callback</code> 返回的是 <code>Boolean</code> 类型，所以通过 <code>if</code> 判断是否要塞入累计器 <code>acc</code> ，并且返回 <code>acc</code> 给下一次对比。最终返回整个过滤后的数组。</p>
<h4 id="reduce---find">reduce -&gt; find</h4>
<p><code>find</code> 方法中 <code>callback</code> 同样也是返回 <code>Boolean</code> 类型，返回你要找的第一个符合要求的项。</p>
<div class="ui-codeblock">
    
    <pre tabindex="0"><code>const testArr = [1, 2, 3, 4]
const testObj = [{ a: 1 }, { a: 2 }, { a: 3 }, { a: 4 }]
Array.prototype.reduceFind = function (callback) {
  return this.reduce((acc, cur, index, array) =&gt; {
    if (callback(cur, index, array)) {
      if (acc instanceof Array &amp;&amp; acc.length == 0) {
      acc = cur
      }
    }
    // 循环到最后若 acc 还是数组，且长度为 0，代表没有找到想要的项，则 acc = undefined
    if ((index == array.length - 1) &amp;&amp; acc instanceof Array &amp;&amp; acc.length == 0) {
      acc = undefined
    }
    return acc
  }, [])
}
testArr.reduceFind(item =&gt; item % 2 == 0) // 2
testObj.reduceFind(item =&gt; item.a % 2 == 0) // {a: 2}
testObj.reduceFind(item =&gt; item.a % 9 == 0) // undefined

复制代码</code></pre>
</div>
<p>你不知道操作的数组是对象数组还是普通数组，所以这里只能直接覆盖 <code>acc</code> 的值，找到第一个符合判断标准的值就不再进行赋值操作。</p>
<h2 id="递归">递归</h2>
<p>函数的内部语句可以调用这个函数自身，从而发起对函数的一次 <strong>迭代</strong><sup>iterator</sup>。在新的迭代中，又会执行调用函数自身的语句，从而又产生一次迭代。当函数执行到某一次时，不再进行新的迭代，函数被一层一层返回，函数被递归。</p>
<p>递归是一种较为高级的编程思想，它把一个大型复杂的问题层层转化为一个与原问题相似的规模较小的问题来求解。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 递归技巧：</p>
<ol>
<li>分析问题，抽象出具体的数学模型</li>
<li>分析数学模型是否有 <strong>规律性</strong></li>
<li>找到基本的 <strong>规律</strong> $$n!=n*(n-1)!$$</li>
<li>将 <strong>规律</strong> 转换为代码（e.g.: <code>return n * factorial(n - 1);</code>）</li>
<li>找到 <strong>出口</strong> 也就是 <strong>临界情况</strong> $$1!\ =\ 1$$</li>
<li>将 <strong>出口</strong> 转化为代码（e.g.: <code>if (n === 1) { return 1; }</code>）</li>
<li>组合代码形成 <strong>递归算法</strong></li>
</ol>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>📃 <em>Example</em></kbd> 求阶乘</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">factorial</span> <span class="o">=</span> <span class="nx">n</span> <span class="p">=&gt;</span> <span class="nb">Number</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">||</span> <span class="nx">n</span> <span class="o">*</span> <span class="nx">factorial</span><span class="p">(</span><span class="nx">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">factorial</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>      <span class="c1">// 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">factorial</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>      <span class="c1">// 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">factorial</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span>      <span class="c1">// 6
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">factorial</span><span class="p">(</span><span class="mi">4</span><span class="p">));</span>      <span class="c1">// 24
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">factorial</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span>      <span class="c1">// 120
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h3 id="拷贝">拷贝<sup id="object-copy"> </sup></h3>
<h4 id="浅拷贝">浅拷贝</h4>
<p>A <strong>shallow copy</strong> of an object is a copy whose properties <strong>share the same references</strong> (point to the same underlying values) as those of the source object from which the copy was made.</p>
<p>在使用 JavaScript 对数组进行操作的时候，我们经常需要将数组进行备份。</p>
<p>如下代码，如果只是简单才用赋值的方法，那么我们只要更改其中的任何一个，然后其他的也会跟着改变，这就导致了问题的发生。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;red&#34;</span><span class="p">,</span><span class="s2">&#34;yellow&#34;</span><span class="p">,</span><span class="s2">&#34;black&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="kd">let</span> <span class="nx">arr2</span> <span class="o">=</span> <span class="nx">arr1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="nx">arr2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;green&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;数组的原始值：&#34;</span> <span class="o">+</span> <span class="nx">arr1</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;数组的新值：&#34;</span> <span class="o">+</span> <span class="nx">arr2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="nx">数组的原始值</span><span class="err">：</span><span class="nx">red</span><span class="p">,</span><span class="nx">green</span><span class="p">,</span><span class="nx">black</span>
</span></span><span class="line"><span class="cl">    <span class="nx">数组的新值</span><span class="err">：</span><span class="nx">red</span><span class="p">,</span><span class="nx">green</span><span class="p">,</span><span class="nx">black</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//浅拷贝仅复制指针
</span></span></span></code></pre></div>
</div>
<p>像上面的这种直接赋值的方式就是数组的浅拷贝，浅拷贝改变其中一个数组，另外一个数组也会跟着改变。很多时候，这不是我们想要的。</p>
<h4 id="深拷贝">深拷贝</h4>
<p>A <strong>deep copy</strong> of an object is a copy whose properties <strong>do not share</strong> the same references (point to the same underlying values) as those of the source object from which the copy was made.</p>
<ol>
<li>slice()</li>
</ol>
<p>对于 Array 对象的 slice 函数，返回一个数组的一段。（仍为数组）具体见上一节。</p>
<p>测试例子：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;1&#34;</span><span class="p">,</span><span class="s2">&#34;2&#34;</span><span class="p">,</span><span class="s2">&#34;3&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="kd">let</span> <span class="nx">arr2</span> <span class="o">=</span> <span class="nx">arr1</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="c1">//返回
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="nx">arr2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;9&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;数组的原始值：&#34;</span> <span class="o">+</span> <span class="nx">arr1</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;数组的新值：&#34;</span> <span class="o">+</span> <span class="nx">arr2</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="nx">数组的原始值</span><span class="err">：</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">    <span class="nx">数组的新值</span><span class="err">：</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span></span></span></code></pre></div>
</div>
<p>如测试结果显示，通过JS的slice方法，改变拷贝出来的数组的某项值后，对原来数组没有任何影响。</p>
<ol start="2">
<li><code>concat()</code></li>
</ol>
<p>concat() 方法用于连接两个或多个数组。该方法不会改变现有的数组，而仅仅会返回被连接数组的一个副本。</p>
<p>语法：</p>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">arrayObject</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">array1</span><span class="p">,</span> <span class="nx">array2</span><span class="p">,</span> <span class="p">...,</span> <span class="nx">arrayX</span><span class="p">);</span></span></span></code></pre></div></div>
</div>
<p>说明：返回一个新的数组。该数组是通过把所有 arrayX 参数添加到 arrayObject 中生成的。如果要进行 concat() 操作的参数是数组，那么添加的是数组中的元素，而不是数组。</p>
<p>测试例子:</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;1&#34;</span><span class="p">,</span><span class="s2">&#34;2&#34;</span><span class="p">,</span><span class="s2">&#34;3&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="kd">let</span> <span class="nx">arr2</span> <span class="o">=</span> <span class="nx">arr1</span><span class="p">.</span><span class="nx">concat</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">   <span class="nx">arr2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;9&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;数组的原始值：&#34;</span> <span class="o">+</span> <span class="nx">arr1</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;数组的新值：&#34;</span> <span class="o">+</span> <span class="nx">arr2</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="nx">数组的原始值</span><span class="err">：</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">    <span class="nx">数组的新值</span><span class="err">：</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span></span></span></code></pre></div>
</div>
<h5 id="局限性">局限性</h5>
<p>e.g.1: <code>concat()</code></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">arr1</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]];</span><span class="c1">//原数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="kd">let</span> <span class="nx">arr2</span> <span class="o">=</span> <span class="p">[].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">arr1</span><span class="p">);</span><span class="c1">//拷贝数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="nx">arr1</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">   <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span></span></span></code></pre></div>
</div>
<p>e.g.2: <code>slice()</code></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">a1</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&#34;1&#34;</span><span class="p">,</span> <span class="s2">&#34;2&#34;</span><span class="p">,</span> <span class="s2">&#34;3&#34;</span><span class="p">],</span> <span class="s2">&#34;2&#34;</span><span class="p">,</span> <span class="s2">&#34;3&#34;</span><span class="p">],</span> <span class="nx">a2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="nx">a2</span> <span class="o">=</span> <span class="nx">a1</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="nx">a1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">//改变a1第一个元素中的第一个元素
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span>  <span class="c1">//影响到了a2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">   <span class="kd">let</span> <span class="nx">b1</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&#34;1&#34;</span><span class="p">,</span> <span class="s2">&#34;2&#34;</span><span class="p">,</span> <span class="s2">&#34;3&#34;</span><span class="p">],</span> <span class="s2">&#34;2&#34;</span><span class="p">,</span> <span class="s2">&#34;3&#34;</span><span class="p">],</span> <span class="nx">b2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="nx">b2</span> <span class="o">=</span> <span class="nx">b1</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="nx">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">//改变a1第一个元素中的第一个元素
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">b2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span>  <span class="c1">//影响到了a2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="o">&gt;&gt;</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span></span></span></code></pre></div>
</div>
<p>从上面两个例子可以看出，由于数组 <strong>内部</strong> 属性值为 <strong>引用对象</strong>（<strong>指针</strong>），因此使用 slice 和 concat 对对象数组的拷贝，整个拷贝还是浅拷贝，拷贝之后数组各个值的指针还是指向相同的存储地址。</p>
<p>因此，slice 和 concat 这两个方法，仅适用于对不包含 <strong>引用对象</strong> 的 <strong>一维数组</strong> 的深拷贝。</p>
<p>无法实现 <strong>内部对象</strong> 的深拷贝。</p>
<h4 id="xjson-深拷贝">:x:JSON 深拷贝<sup id="object-copy-json"> </sup></h4>
<p>JSON.parse()、JSON.stringify()</p>
<h4 id="递归深拷贝">递归深拷贝</h4>
<p>为了保证实现包括 <strong>引用对象</strong> 的完全的深拷贝，需要使用 <strong>递归</strong> 算法。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">obj1</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">a</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">b</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">c</span><span class="o">:</span> <span class="p">[</span><span class="mi">33</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">m</span><span class="o">:</span> <span class="mi">55</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">n</span><span class="o">:</span> <span class="mi">66</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">p</span><span class="o">:</span> <span class="p">[</span><span class="mi">77</span><span class="p">,</span> <span class="mi">88</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}],</span>
</span></span><span class="line"><span class="cl">  <span class="nx">f</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 深克隆
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">deepClone</span><span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 要判断 o 是对象还是数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">o</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//-&gt; typeof []
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// &gt;&gt; &#39;object&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">result</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">o</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">deepClone</span><span class="p">(</span><span class="nx">o</span><span class="p">[</span><span class="nx">i</span><span class="p">]));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">o</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">result</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kr">const</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// for-in 遍历键名
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 数组也是特殊的对象，但纯对象还有键名
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nx">result</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">deepClone</span><span class="p">(</span><span class="nx">o</span><span class="p">[</span><span class="nx">k</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 基本类型值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// NOTE: 虽然函数属于对象，但typeof结果为&#39;function&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">result</span> <span class="o">=</span> <span class="nx">o</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">obj2</span> <span class="o">=</span> <span class="nx">deepClone</span><span class="p">(</span><span class="nx">obj1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj1</span><span class="p">.</span><span class="nx">c</span> <span class="o">===</span> <span class="nx">obj2</span><span class="p">.</span><span class="nx">c</span><span class="p">);</span>      <span class="c1">// false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">obj1</span><span class="p">.</span><span class="nx">c</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">99</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj2</span><span class="p">);</span>                  <span class="c1">// obj2 不变，因为没有“藕断丝连”的现象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">obj1</span><span class="p">.</span><span class="nx">c</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">p</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">999</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj2</span><span class="p">);</span>                  <span class="c1">// 不变
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">obj1</span><span class="p">.</span><span class="nx">f</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([</span><span class="nx">obj1</span><span class="p">.</span><span class="nx">f</span><span class="p">(),</span><span class="nx">obj2</span><span class="p">.</span><span class="nx">f</span><span class="p">()])</span>    <span class="c1">// 不变
</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 数组和对象区别：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">o</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([</span><span class="nx">o</span><span class="p">,</span> <span class="k">typeof</span><span class="p">[</span><span class="nx">o</span><span class="p">]])}</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">o</span> <span class="k">in</span> <span class="p">{</span><span class="mi">0</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">:</span><span class="mi">3</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">     <span class="p">{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([</span><span class="nx">o</span><span class="p">,</span> <span class="k">typeof</span><span class="p">[</span><span class="nx">o</span><span class="p">]])}</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">({</span><span class="mi">0</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">:</span><span class="mi">3</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="kc">false</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h3 id="二维数组">二维数组</h3>
<p>二维数组：以数组作为数组元素的数组，即 “数组的数组”。</p>
<p>二维数组可以看做是 “矩阵”。</p>
$$\mathbf{A}=\begin{bmatrix}11&33&55\\22&33&44\\36&49&52\end{bmatrix}$$<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">matrix</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">55</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">44</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="mi">36</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">52</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 二维数组长度
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">matrix</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>		<span class="c1">// 4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">matrix</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">length</span><span class="p">);</span>	<span class="c1">// 3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// 遍历二维数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">matrix</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">matrix</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">matrix</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//使用for-in
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">row</span> <span class="k">in</span> <span class="nx">matrix</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">col</span> <span class="k">in</span> <span class="nx">matrix</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">matrix</span><span class="p">[</span><span class="nx">row</span><span class="p">][</span><span class="nx">col</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 id="例题">例题</h3>
<ol>
<li>
<h4 id="数组去重-1">数组去重</h4>
</li>
</ol>
<p>题目：去掉数组中的重复项。</p>
<p>思路：准备一个空结果数组，遍历原数组，如果遍历到的项不在结果数组中，则推入结果数组。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kr">const</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="kr">const</span> <span class="nx">resultArr</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">resultArr</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="c1">//include判断是否包含
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>       <span class="nx">resultArr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">     <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">resultArr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="p">]</span></span></span></code></pre></div>
</div>
<ol start="2">
<li>
<h4 id="随机样本">随机样本</h4>
</li>
</ol>
<p>题目：请随机从原数组删除若干项。</p>
<p>思路：准备一个空结果数组，遍历原数组，随机选择一项，推入结果数组，并且将这项在原数组中删除。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kr">const</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="kr">const</span> <span class="nx">resultArr</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">   <span class="kr">const</span> <span class="nx">deleteCount</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">deleteCount</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="kr">const</span> <span class="nx">n</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">     <span class="nx">resultArr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">n</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">     <span class="nx">arr</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">resultArr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span> <span class="p">]</span></span></span></code></pre></div>
</div>
<ol start="3">
<li>
<h4 id="冒泡排序">冒泡排序</h4>
</li>
</ol>
<p>冒泡排序是一个著名的排序算法，也是最基础的交换排序。</p>
<p>冒泡排序的核心思想：一趟一趟地进行多次项的 <strong>两两比较</strong> ，每次都会将最大的元素排好位置，如同水中的气泡上浮一样。时间复杂度为 </p>
$$O(n^2)$$<p> 。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kr">const</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="kd">let</span> <span class="nx">temp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">j</span> <span class="o">=</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">j</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nx">temp</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">         <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">         <span class="nx">arr</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">temp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">       <span class="p">}</span>
</span></span><span class="line"><span class="cl">     <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//使用sort()函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">-&gt;</span> <span class="kr">const</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="nx">arr</span><span class="p">.</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="nx">a</span> <span class="o">-</span> <span class="nx">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">});</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span></span></span></code></pre></div>
</div>
<h2 id="对象">对象<sup id="object-es5"> </sup></h2>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:link: <em>Href</em></kbd> [<em>ES6</em>](06 EcmaScript.md/#object-es6) 对对象又进行了一些拓展</p>
        </blockquote>
        
    </figure>

<p>对象 <em>Object</em> 是 JavaScript 的一种 <strong>复合数据类型</strong> ，它可以把多个数据集中在一个变量中，并且给其中的每个数据起 <strong>名字</strong> 。</p>
<p>或者说，对象是一个 **属性集合 **，每个属性有自己的 <strong>名字</strong> <em>key</em> 和 <strong>值</strong> <em>value</em> 。JavaScript 并不像其他 OOP 语言那样有 <strong>类</strong> 的概念，不是先设计 <strong>类</strong> 再制造 <strong>对象</strong>。</p>
<ul>
<li>严格来说，JS 是一门 <strong>具有对象</strong> 的语言，而不一定能被称为 <strong>面向对象</strong> 的语言</li>
<li>大括号 <code>{}</code> 表示对象，使用 <strong>键值对</strong> <code>key: value</code> 表示成员，最后的属性后面不加逗号。</li>
</ul>
<h3 id="创建">创建</h3>
<ol>
<li><code>new Object()</code></li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">o</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Object</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">o</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Object</span><span class="p">(</span><span class="kc">undefined</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">o</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Object</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">//Using Object given undefined and null types
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* equivalent to o = new Boolean(true) */</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">o</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Object</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* equivalent to o = new Boolean(false) */</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">o</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Object</span><span class="p">(</span><span class="nb">Boolean</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="c1">//Using Object to create Boolean objects
</span></span></span></code></pre></div>
</div>
<ol start="2">
<li>
<p><code>Object.create()</code></p>
<ul>
<li>creates a <strong>new object</strong>, using an <strong>existing object</strong> as the <em>prototype</em> of the newly created object</li>
</ul>
<p><em>Object.create(proto[, propertiesObject])</em></p>
<ul>
<li><code>proto</code>必填参数，是新对象的原型对象，如上面代码里新对象<code>me</code>的<code>__proto__</code>指向<code>person</code>。注意，如果这个参数是<code>null</code>，那新对象就彻彻底底是个空对象，没有继承<code>Object.prototype</code>上的任何属性和方法，如<code>hasOwnProperty()、toString()</code>等。</li>
<li><code>propertiesObject</code>是可选参数，指定要添加到新对象上的可枚举的属性（即其自定义的属性和方法，可用<code>hasOwnProperty()</code>获取的，而不是原型对象上的）的描述符及相应的属性名称。</li>
</ul>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">isHuman</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">printIntroduction</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`My name is </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">. Am I human? </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">isHuman</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">me</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">me</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;Matthew&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* &#34;name&#34; is a property set on &#34;me&#34;, but not on &#34;person&#34; */</span>
</span></span><span class="line"><span class="cl"><span class="nx">me</span><span class="p">.</span><span class="nx">isHuman</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* inherited properties can be overwritten */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">me</span><span class="p">.</span><span class="nx">printIntroduction</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="s2">&#34;My name is Matthew. Am I human? true&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">person</span><span class="p">.</span><span class="nx">printIntroduction</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="s2">&#34;My name is undefined. Am I human? false&#34;</span></span></span></code></pre></div>
</div>
<p>note:可以使用 <em>Object.create(null)</em> 来创建一个没有原型的对象</p>
<ol start="3">
<li>Using initializer notation <code>{}</code></li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">object1</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">a</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="mi">42</span><span class="p">,</span> <span class="nx">c</span><span class="o">:</span> <span class="p">{}</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">object1</span><span class="p">.</span><span class="nx">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="s2">&#34;foo&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">a</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">c</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">object2</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">a</span><span class="o">:</span> <span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="o">:</span> <span class="nx">c</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">object2</span><span class="p">.</span><span class="nx">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="mi">42</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">object3</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">object3</span><span class="p">.</span><span class="nx">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="s2">&#34;foo&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">key</span><span class="o">:</span> <span class="nx">value</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;key-name&#39;</span><span class="o">:</span> <span class="nx">value</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 属性名中有短横，不符合JS标识符命名规范时，属性名必须用引号包裹。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span></span></span></code></pre></div>
</div>
<h3 id="删除">删除</h3>
<p>There isn&rsquo;t any method in an Object itself to delete its own properties (such as Map.prototype.delete()). To do so, one must use the delete operator.</p>
<p><code>delete</code><sup id="delete-es5"> </sup></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">president</span> <span class="o">=</span> <span class="p">{</span><span class="nx">firstname</span><span class="o">:</span> <span class="s1">&#39;Joe&#39;</span><span class="p">,</span><span class="nx">lastname</span><span class="o">:</span> <span class="s1">&#39;Biden&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">president</span><span class="p">.</span><span class="nx">firstname</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="s2">&#34;Joe&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">delete</span> <span class="nx">president</span><span class="p">.</span><span class="nx">firstname</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">president</span><span class="p">.</span><span class="nx">firstname</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="kc">undefined</span></span></span></code></pre></div>
</div>
<ol>
<li>
<p>对象属性删除</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">Fun</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">foo</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Fun</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nx">obj</span><span class="p">.</span><span class="nx">foo</span><span class="p">,</span> <span class="c1">// bar
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">delete</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">foo</span><span class="p">,</span> <span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">obj</span><span class="p">.</span><span class="nx">foo</span> <span class="c1">//undefined
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">);</span></span></span></code></pre></div>
</div>
</li>
<li>
<p>变量删除</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">foo</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">delete</span> <span class="nx">foo</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">);</span> <span class="c1">// &#39;bar&#39;
</span></span></span></code></pre></div>
</div>
<p><kbd>:memo: <em>Note</em></kbd>  <em>delete</em> 操作符不能直接删除变量。</p>
</li>
<li>
<p>删除不了原型链中的变量</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">Obj</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">Obj</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">foo</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Obj</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nx">obj</span><span class="p">.</span><span class="nx">foo</span><span class="p">,</span> <span class="c1">// bar
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">delete</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">foo</span><span class="p">,</span> <span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">obj</span><span class="p">.</span><span class="nx">foo</span><span class="p">,</span> <span class="c1">// bar
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">delete</span> <span class="nx">Obj</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">foo</span><span class="p">,</span> <span class="c1">// false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">obj</span><span class="p">.</span><span class="nx">foo</span> <span class="c1">//undefined
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">);</span></span></span></code></pre></div>
</div>
<p><kbd>:link: <em>Href</em></kbd> <a href="/techs/05-javascript/#object-prototype-es5"><em>Object.prototype</em></a></p>
</li>
</ol>
<h3 id="方法-2">方法</h3>
<p>如果某个属性值是函数，则它也被称为对象的 <strong>方法</strong> 。</p>
<p>方法既可以通过 <code>.</code> 调用，也可以通过 <code>[]</code> 调用。</p>
<h4 id="defineproperty"><code>defineProperty()</code><sup id="object-defineProperty-es5"> </sup></h4>
<h4 id="defineproperties"><code>defineProperties()</code><sup id="object-defineProperties-es5"> </sup></h4>
<p>?和prototype有什么区别？</p>
<p>将在Es6中逐渐被reflect代替</p>
<h3 id="遍历">遍历</h3>
<p><kbd>:link: <em>Href</em></kbd> [<em>ES6</em>](06 EcmaScript.md/##iterator-es6) <em>iterator</em></p>
<p><kbd>for-in</kbd><sup id="object-for-in"> </sup></p>
<p><kbd>:link: <em>Href</em></kbd>  <a href="/techs/05-javascript/#for-in"><em>for-in</em></a></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">x</span> <span class="k">in</span> <span class="nx">o</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="nx">o</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>	<span class="cm">/* 可以给对象提供运行时刻才知道的值 */</span>
</span></span><span class="line"><span class="cl">  <span class="nx">statement</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p><kbd>:link: <em>Href</em></kbd> <a href="/techs/05-javascript/#object-copy"><em>Object</em></a> 的深拷贝和浅拷贝</p>
<h3 id="构造函数">构造函数<sup id="construct-es5"> </sup></h3>
<p>类似于其它 OOP 语言中的 <em>class</em></p>
<ol>
<li>
<p>不直接 <strong>制造对象</strong></p>
</li>
<li>
<p>通过 <strong>this</strong> 来定义成员</p>
<ul>
<li>this 指向的是由这个函数所创建的空白对象</li>
</ul>
</li>
<li>
<p>没有 <strong>return</strong></p>
</li>
</ol>
<p><em>new</em> 命令的作用，就是执行构造函数，返回一个实例对象</p>
<p>构造函数必须有 <em>new</em> 关键字</p>
<ol>
<li><em>new</em> 就是 <strong>创造对象</strong> 的过程</li>
<li><em>new</em> 也叫做 <strong>实例化对象</strong> 的过程</li>
<li><em>new</em> 创造出来的对象叫做 <strong>构造函数</strong> 的 <strong>实例对象</strong></li>
</ol>
<p>构造函数和 OOP 中的 <em>class</em></p>
<ul>
<li>Java、<em>C++</em> 等是 <strong>“面向对象”</strong> 语言</li>
<li>JavaScript 是 <strong>“基于对象”</strong> 语言</li>
<li>面向对象 $$\neq$$ 基于对象</li>
<li>JavaScript 中的构造函数可以类比于 OOP 语言中的 <em>class</em> ，写法的确类似，但和真正的 OOP 语言还是有本质不同。</li>
</ul>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 一个函数是不是构造函数，要看它是否用 <em>new</em> 调用，而至于名称首字母大写，完全是开发者的习惯约定。</p>
        </blockquote>
        
    </figure>

<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">Rect</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="nx">h</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">h</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">area</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">width</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">  // :memo: NOTE: 使用箭头函数的时候this并没有受到影响
</span></span></span><span class="line"><span class="cl"><span class="cm">  // this默认指向父级即构造函数本身，因此不受影响
</span></span></span><span class="line"><span class="cl"><span class="cm">  this.area = () =&gt; this.width * this.height;
</span></span></span><span class="line"><span class="cl"><span class="cm">  */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Usage
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">r</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Rect</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">area</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 不使用
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">Rect</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">Rect</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">Rect</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* 此时this指向window对象，所以这三条语句会依次覆盖 */</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* 严格模式下，由于this指向undefined，因此会报错 */</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* TypeError: Cannot set properties of undefined (setting &#39;width&#39;) */</span></span></span></code></pre></div>
</div>
<p>测试 <strong>匿名函数</strong> <em>this</em> 指向和 <strong>普通函数</strong> 区别：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">Rect</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">h</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">h</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="p">.</span><span class="nx">area</span> <span class="o">=</span> <span class="nx">_</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">width</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="p">.</span><span class="nx">deep</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fnAnonymous</span><span class="o">:</span> <span class="nx">_</span> <span class="p">=&gt;</span> <span class="p">[</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">width</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">height</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fnThis</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="p">[</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">width</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">height</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">area</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Rect</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span>
</span></span><span class="line"><span class="cl"><span class="p">([</span><span class="nx">area</span><span class="p">.</span><span class="nx">deep</span><span class="p">.</span><span class="nx">fnAnonymous</span><span class="p">(),</span> <span class="nx">area</span><span class="p">.</span><span class="nx">deep</span><span class="p">.</span><span class="nx">fnThis</span><span class="p">()]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">[</span><span class="nb">Array</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span><span class="o">:</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="o">:</span> <span class="nx">Rect</span> <span class="p">{...}</span>
</span></span><span class="line"><span class="cl">           <span class="c1">//箭头匿名函数指向定义时所处的对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>           <span class="c1">//若父级this指针不存在，则一直向上继续寻找
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>           <span class="c1">//而function Rect存在this指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>           <span class="c1">//故指向Rect
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>           <span class="c1">//类似于“子绝父相”，绝对定位会一直向上溯源
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>           <span class="c1">//直到找到具有定位的盒子
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="mi">1</span><span class="o">:</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">        <span class="nx">length</span><span class="o">:</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="p">[[</span><span class="nx">Prototype</span><span class="p">]]</span><span class="o">:</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="mi">1</span><span class="o">:</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="o">:</span> <span class="p">{</span><span class="nx">fnAnonymous</span><span class="o">:</span> <span class="nx">ƒ</span><span class="p">,</span> <span class="nx">fnThis</span><span class="o">:</span> <span class="nx">ƒ</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//普通函数指向调用者，也就是指向了deep
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="mi">1</span><span class="o">:</span> <span class="kc">NaN</span>
</span></span><span class="line"><span class="cl">        <span class="nx">length</span><span class="o">:</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="p">[[</span><span class="nx">Prototype</span><span class="p">]]</span><span class="o">:</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="nx">length</span><span class="o">:</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">     <span class="p">[[</span><span class="nx">Prototype</span><span class="p">]]</span><span class="o">:</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:link: <em>Href</em></kbd> <a href="/techs/05-javascript/#for-of"><em>for-of</em></a></p>
        </blockquote>
        
    </figure>

<h4 id="new">New</h4>
<p><code>new 函数()</code></p>
<p>使用 <code>new</code> 操作符调用函数会进行 “四步走”：</p>
<ol>
<li>函数体内会自动创建出一个 <strong>空白对象</strong></li>
<li>函数体内 <em>this</em> 指针会指向这个对象</li>
<li>函数体内的语句会执行</li>
<li>返回 <em>this</em> 指针</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">fun</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="kd">let</span> <span class="nx">foo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">fun</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="nx">fun</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fun</span> <span class="p">{}</span></span></span></code></pre></div>
</div>
<h3 id="原型对象">原型对象</h3>
<h4 id="prototype"><em>Prototype</em><sup id="object-prototype-es5"> </sup></h4>
<p>对象的 <em>prototype</em> 属性指定了它的原型对象。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:link: <em>Href</em></kbd> [<em>ES6</em>](06 EcmaScript.md/#proto-es6)  <em>prototype</em> 原型对象扩展</p>
        </blockquote>
        
    </figure>

<p>可以用 <code>.</code> 运算符直接读它的原型对象的属性，当写这个属性时才在它自己内部产生 <strong>实际的属性</strong>，否则将共享 <strong>同一个</strong> 元素。可以减少内存的浪费。</p>
<div class="ui-htmlblock-container"><div> <div style="display: table;"> <div style="display: inline-table;vertical-align: middle;padding: 0 .5em;background-image: linear-gradient(234deg, #edf8ff 0%, #21d4fd 90%);border-radius: .3em"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;函数&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </div> <div style="display: inline-table;text-align: center;vertical-align: middle;padding: 0 .5em;"> <div>prototype</div> <div>------&gt;</div> <br> <div>&lt;------</div> <div>constructor</div> </div> <div style="display: inline-table;vertical-align: middle;padding: 0 .5em;border-radius: .3em;background-image: linear-gradient(30deg, #abecd6 0%, #fbed96 100%);"> 函数.prototype </div> </div> </div></div>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">function</span> <span class="nx">Sum</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Sum</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">{</span><span class="nx">constructor</span><span class="o">:</span> <span class="nx">ƒ</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nx">constructor</span><span class="o">:</span> <span class="nx">ƒ</span> <span class="nx">Sum</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">[[</span><span class="nx">Prototype</span><span class="p">]]</span><span class="o">:</span> <span class="nb">Object</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">Sum</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="nx">object</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Sum</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="nx">ƒ</span> <span class="nx">Sum</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">Sum</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="kd">function</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Sum</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">===</span> <span class="nx">Sum</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="kc">true</span></span></span></code></pre></div>
</div>
<p>对于普通函数来说的 <em>prototype</em> 属性没有任何用处，而构造函数的 <em>prototype</em> 属性是它的 <em>construct</em> 的原型。</p>
<div class="ui-codeblock">
    
    <pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">graph LR
_constructor[People构造函数]--prototype--&gt;_prototype[People.prototype]
_person[Nicholas]--Object.getPrototypeOf--&gt;_prototype[People.prototype]
_constructor--new--&gt;_person</code></pre>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:warning:<em>Warning</em></kbd> Changing the <code>[[Prototype]]</code> of an object is, by the nature of how modern JavaScript engines optimize property accesses, <strong>a very slow operation</strong>, in <strong>every</strong> browser and JavaScript engine. The effects on the performance of altering inheritance are subtle and far-flung, and are not limited to the time spent in <code>obj.__proto__ = ...</code> statements, but may extend to <strong>any</strong> code that has access to <strong>any</strong> object whose <code>[[Prototype]]</code> has been altered. If you care about performance you should avoid setting the <code>[[Prototype]]</code> of an object. Instead, create a new object with the desired <code>[[Prototype]]</code> using <code>Object.create()</code>.</p>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:warning:<em>Warning</em></kbd> While <code>Object.prototype.__proto__</code> is supported today in most browsers, its existence and exact behavior has only been standardized in the ECMAScript 2015 specification as a legacy feature to ensure compatibility for web browsers. For better support, use <code>Object.getPrototypeOf()</code> instead.</p>
        </blockquote>
        
    </figure>

<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">Person</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">&#34;Nicholas&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="mi">29</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">job</span> <span class="o">=</span> <span class="s2">&#34;Software Engineer&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">sayName</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">person1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">person1</span><span class="p">.</span><span class="nx">sayName</span><span class="p">();</span> <span class="c1">//&#34;Nicholas&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">person2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">person2</span><span class="p">.</span><span class="nx">sayName</span><span class="p">();</span> <span class="c1">//&#34;Nicholas&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nb">document</span><span class="p">.</span><span class="nx">writeln</span><span class="p">(</span><span class="sb">`</span><span class="si">${</span><span class="nx">person1</span><span class="p">.</span><span class="nx">sayName</span><span class="p">()</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nb">document</span><span class="p">.</span><span class="nx">writeln</span><span class="p">(</span><span class="sb">`</span><span class="si">${</span><span class="nx">person2</span><span class="p">.</span><span class="nx">sayName</span><span class="p">()</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span></span></span></code></pre></div>
</div>
<div class="ui-codeblock">
    
    <pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">graph LR
_constructor[Person构造函数]--
prototype--&gt;_prototype[Person.prototype]

_person1[Nicholas&lt;br&gt;]--
Object.getPrototypeOf--&gt;_prototype[People.prototype&lt;br&gt;&lt;div style="&#39;text-align:left&#39;&gt;&lt;kbd&gt;name&lt;/kbd&gt;:" &#39;Nicholas&#39;&lt;br&gt;&lt;kbd&gt;age&lt;/kbd&gt;: 29&lt;br&gt;&lt;kbd&gt;job&lt;/kbd&gt;: &#39;Software Engineer&#39;&lt;br&gt;&lt;kbd&gt;sayName&lt;/kbd&gt;: function&lt;/div&gt; ]
_person2[Greg&lt;br&gt;&lt;div style="&#39;text-align:left&#39;&gt;&lt;kbd&gt;name&lt;/kbd&gt;:" &#39;Greg&#39;&lt;/div&gt;]--
Object.getPrototypeOf--&gt;_prototype

_constructor--new--&gt;_person1
_constructor--new--&gt;_person2</code></pre>
</div>
<ul>
<li>
<p>Person1</p>
<ul>
<li><kbd>__proto__</kbd>: Person Prototpe</li>
<li><kbd>name</kbd>: &ldquo;Greg&rdquo;</li>
</ul>
</li>
<li>
<p>Person2</p>
<ul>
<li><kbd>__proto__</kbd>: Person Prototpe</li>
</ul>
</li>
<li>
<p>Person Prototpe</p>
<ul>
<li>
<p><kbd>constructor</kbd>: :black_small_square:</p>
</li>
<li>
<p><kbd>name</kbd>: &ldquo;Nicholas&rdquo;</p>
</li>
<li>
<p><kbd>age</kbd>: &ldquo;29&rdquo;</p>
</li>
<li>
<p><kbd>job</kbd>: &ldquo;Software Engineer&rdquo;</p>
</li>
<li>
<p><kbd>sayName</kbd>: <strong>(</strong> function <strong>)</strong></p>
</li>
</ul>
</li>
</ul>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nx">constructor</span><span class="o">:</span> <span class="nx">Person</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;Nicholas&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nx">age</span><span class="o">:</span> <span class="mi">29</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nx">job</span><span class="o">:</span> <span class="s2">&#34;Software Engineer&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nx">friends</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;Shelby&#34;</span><span class="p">,</span> <span class="s2">&#34;Court&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">   <span class="nx">sayName</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">person1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">person2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">person1</span><span class="p">.</span><span class="nx">friends</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&#34;Van&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nb">document</span><span class="p">.</span><span class="nx">writeln</span><span class="p">(</span><span class="nx">person1</span><span class="p">.</span><span class="nx">friends</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nb">document</span><span class="p">.</span><span class="nx">writeln</span><span class="p">(</span><span class="nx">person2</span><span class="p">.</span><span class="nx">friends</span><span class="p">);</span></span></span></code></pre></div>
</div>
<p>若不希望部分成员在元素之间共享：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">Person</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">age</span><span class="p">,</span> <span class="nx">job</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">   <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="nx">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="k">this</span><span class="p">.</span><span class="nx">job</span> <span class="o">=</span> <span class="nx">job</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="k">this</span><span class="p">.</span><span class="nx">friends</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;Shelby&#34;</span><span class="p">,</span> <span class="s2">&#34;Court&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nx">constructor</span><span class="o">:</span> <span class="nx">Person</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nx">sayName</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">person1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">(</span><span class="s2">&#34;Nicolas&#34;</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="s2">&#34;Software Engineer&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">person2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">(</span><span class="s2">&#34;Vans&#34;</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="s2">&#34;Manager&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">person1</span><span class="p">.</span><span class="nx">friends</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&#34;Van&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nb">document</span><span class="p">.</span><span class="nx">writeln</span><span class="p">(</span><span class="nx">person1</span><span class="p">.</span><span class="nx">sayName</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="nb">document</span><span class="p">.</span><span class="nx">writeln</span><span class="p">(</span><span class="nx">person2</span><span class="p">.</span><span class="nx">friends</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">person2</span><span class="p">);</span></span></span></code></pre></div>
</div>
<p>使用 <em>ES6</em> - <em>ECMAScript 2015</em> 新特性 <kbd>class</kbd>：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nx">constructor</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">age</span><span class="p">,</span> <span class="nx">job</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="nx">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">job</span> <span class="o">=</span> <span class="nx">job</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">friends</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;Shelby&#34;</span><span class="p">,</span> <span class="s2">&#34;Court&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="nx">sayName</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="nx">sayJob</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">job</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h4 id="create"><em>Create</em><sup id="object-create-es5"> </sup></h4>
<p>The Object.create() method creates a new object, using an <strong>existing object</strong> as the <em>prototype</em> of the newly created object.</p>
<p>可以代替 new 的作用，以原对象为 <em>prototype</em> 创建新的对象。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// Syntax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">proto</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">proto</span><span class="p">,</span> <span class="nx">propertiesObject</span><span class="p">)</span></span></span></code></pre></div>
</div>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">isHuman</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">printIntroduction</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`My name is </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">. Am I human? </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">isHuman</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">me</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">me</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;Matthew&#39;</span><span class="p">;</span> <span class="c1">// &#34;name&#34; is a property set on &#34;me&#34;, but not on &#34;person&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">me</span><span class="p">.</span><span class="nx">isHuman</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="c1">// inherited properties can be overwritten
</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">({},</span> <span class="p">{</span><span class="nx">p</span><span class="o">:</span> <span class="p">{</span><span class="nx">value</span><span class="o">:</span> <span class="mi">42</span><span class="p">}});</span>
</span></span><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">values</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="c1">// []
</span></span></span></code></pre></div>
</div>
<p>上面代码中，<code>Object.create</code> 方法的第二个参数添加的对象属性（属性<code>p</code>），如果不显式声明，默认是不可遍历的，因为<code>p</code>的属性描述对象的 <code>enumerable</code> 默认是 <code>false ，</code>Object.values<code>不会返回这个属性。只要把 </code>enumerable<code> 改成</code>true<code>，</code>Object.values<code>就会返回属性</code>p`的值。</p>
        </blockquote>
        
    </figure>

<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">({},</span> <span class="p">{</span><span class="nx">p</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">value</span><span class="o">:</span> <span class="mi">42</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">values</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="c1">// [42]
</span></span></span></code></pre></div>
</div>
<h4 id="in"><em>In</em><sup id="object-in-operator-es5"> </sup></h4>
<p>The <strong><code>in</code> operator</strong> returns <code>true</code> if the specified property is in the specified object or its <strong>prototype chain</strong>.</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// Syntax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">prop</span> <span class="k">in</span> <span class="nx">object</span><span class="p">;</span></span></span></code></pre></div>
</div>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">car</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">make</span><span class="o">:</span> <span class="s1">&#39;Honda&#39;</span><span class="p">,</span> <span class="nx">model</span><span class="o">:</span> <span class="s1">&#39;Accord&#39;</span><span class="p">,</span> <span class="nx">year</span><span class="o">:</span> <span class="mi">1998</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;make&#39;</span> <span class="k">in</span> <span class="nx">car</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// expected output: true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">delete</span> <span class="nx">car</span><span class="p">.</span><span class="nx">make</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="s1">&#39;make&#39;</span> <span class="k">in</span> <span class="nx">car</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">car</span><span class="p">.</span><span class="nx">make</span> <span class="o">=</span> <span class="s1">&#39;Suzuki&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">car</span><span class="p">.</span><span class="nx">make</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// expected output: &#34;Suzuki&#34;
</span></span></span></code></pre></div>
</div>
<h4 id="终点">终点</h4>
<ol>
<li>对象</li>
</ol>
<p>在 JavaScript 中， <em>Object</em> 可以看作是所有对象的构造函数。所以，<code>People.prototype</code> 这个对象可以看作是 <em>Object</em> 通过 <em>new</em> 运算符创造出来的</p>
<ol start="2">
<li>数组</li>
</ol>
<p>任何数组实际上都是可以看做是 <em>Array</em> 这个构造函数 new 出来的。而 Array 对象继续向上溯源的原型是 Object 。</p>
<p>Object Prototype</p>
<ul>
<li><kbd>constructor</kbd>: :black_small_square:</li>
<li><kbd>hasOwnproperty()</kbd>: <strong>(</strong> function ƒ <strong>)</strong></li>
<li><kbd>toString()</kbd>: <strong>(</strong> function ƒ <strong>)</strong></li>
<li>&hellip;&hellip;</li>
</ul>
<p>Array Prototype</p>
<ul>
<li><kbd>constructor</kbd>: :black_small_square:</li>
<li><kbd>hasOwnproperty()</kbd>: <strong>(</strong> function ƒ <strong>)</strong></li>
<li><kbd>toString()</kbd>: <strong>(</strong> function ƒ <strong>)</strong></li>
<li>&hellip;&hellip;</li>
</ul>
<p><code>[...]</code></p>
<ul>
<li><kbd>0</kbd>: <strong>&quot; Value &ldquo;</strong></li>
<li>&hellip;&hellip;</li>
<li><kbd>length</kbd>: <code>[].length</code></li>
<li><kbd>[[Prototype]]</kbd>: Array (0)</li>
</ul>
<p>对象通过 <strong>继承链</strong> 实现继承。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// 关键语句，实现继承
</span></span></span><span class="line"><span class="cl"><span class="c1">// 创建新对象时会自动从原来的原型链继承
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">Student</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">People</span><span class="p">();</span></span></span></code></pre></div>
</div>
<h4 id="get">get</h4>
<h4 id="set">set</h4>
<h3 id="包装类">包装类</h3>
<p>很多编程语言都有 <strong>包装类</strong> 的设计，包装类的目的就是为了让基本类型值可以从它们的构造函数的 <em>prototype</em> 上获得方法。</p>
<p>而 <code>Number()</code> 、<code>String()</code> 、<code>Boolean()</code> 分别是数字、字符串、布尔值的 <strong>包装类</strong> 、实例都是 object 类型，它们的 <em>PrimitiveValue</em> 属性存储它们的本身值。</p>
<p>包装类的目的就是为了让基本类型值可以从它们的构造函数的 <em>prototype</em> 上获得方法。（<code>.</code> 运算符）</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// 基本类型通过包装类使用相应的方法（同Java）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span> <span class="nb">Number</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">b</span> <span class="o">=</span> <span class="nb">String</span><span class="p">(</span><span class="s1">&#39;String&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">c</span> <span class="o">=</span> <span class="nb">Boolean</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([</span><span class="k">typeof</span> <span class="nx">a</span><span class="p">,</span><span class="nx">a</span><span class="p">]);</span>  <span class="c1">// [ &#39;number&#39;, 42 ]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([</span><span class="k">typeof</span> <span class="nx">b</span><span class="p">,</span><span class="nx">b</span><span class="p">]);</span>  <span class="c1">// [ &#39;string&#39;, &#39;String&#39; ]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([</span><span class="k">typeof</span> <span class="nx">c</span><span class="p">,</span><span class="nx">c</span><span class="p">]);</span>  <span class="c1">// [ &#39;boolean&#39;, true ]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">d</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="o">===</span> <span class="nb">Number</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">e</span> <span class="o">=</span> <span class="s1">&#39;Str&#39;</span><span class="p">;</span>              <span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">===</span> <span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">f</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>              <span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="o">===</span> <span class="nb">Boolean</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                            <span class="c1">// true
</span></span></span></code></pre></div>
</div>
<p><kbd>:memo: <em>Note</em></kbd> <code>Array()</code> 不是数组的包装类，因为数组 <strong>不是基本类型</strong> ，array 类型属于 object 。</p>
<h3 id="数学类">数学类<sup id="math-es5"> </sup></h3>
<p><code>Math</code> is a built-in <strong>object</strong> that has properties and methods for mathematical constants and functions. It&rsquo;s not a function object.</p>
<p><code>Math</code> works with the <code>Number</code> type. It doesn&rsquo;t work with <code>BigInt</code>.</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:link: <em>Href</em></kbd> [<em>ES6</em>](06 EcmaScript.md/#number-es6) 新增的 <em>Math</em> 方法</p>
        </blockquote>
        
    </figure>

<h4 id="幂次">幂次</h4>
<p>JS 中没有提供幂运算、开根号的运算符。需要使用 Math 对象的相关方法进行计算。</p>
<table>
  <thead>
      <tr>
          <th>代码</th>
          <th style="text-align: left">说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>Math.pow(a, b)</code></td>
          <td style="text-align: left">$$a^b$$</td>
      </tr>
      <tr>
          <td><code>Math.sqrt(a)</code></td>
          <td style="text-align: left">$$\sqrt{a}$$</td>
      </tr>
  </tbody>
</table>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="mi">9</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="mi">81</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="mi">9</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">81</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="kc">NaN</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="mf">1.7320508075688772</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">&gt;&gt;</span> <span class="mf">1.7320508075688772</span></span></span></code></pre></div>
</div>
<h4 id="取整">取整</h4>
<table>
  <thead>
      <tr>
          <th>代码</th>
          <th style="text-align: left">说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>Math.ceil(x)</code></td>
          <td style="text-align: left">$\lceil x \rceil$</td>
      </tr>
      <tr>
          <td><code>Math.floor(x)</code></td>
          <td style="text-align: left">$\lfloor x \rfloor$</td>
      </tr>
  </tbody>
</table>
<h4 id="保留位数">保留位数</h4>
<p><kbd>🔗 <em>Href</em></kbd> <em><a href="number-prototype-toFixed">Number.prototype.toFixed()</a></em></p>
<h4 id="四舍五入">四舍五入</h4>
<table>
  <thead>
      <tr>
          <th>代码</th>
          <th style="text-align: left">说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>Math.ceil(x)</code></td>
          <td style="text-align: left">四舍五入</td>
      </tr>
  </tbody>
</table>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="mf">3.98</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span> <span class="mf">3.7554</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">a</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="mf">3.76</span></span></span></code></pre></div>
</div>
<h4 id="极值">极值</h4>
<table>
  <thead>
      <tr>
          <th>代码</th>
          <th style="text-align: left">说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>Math.max()</code></td>
          <td style="text-align: left">$$\max \limits_{\left[paramList \right]}f(x)$$</td>
      </tr>
      <tr>
          <td><code>Math.min()</code></td>
          <td style="text-align: left">$$\min \limits_{\left[paramList \right]}f(x)$$</td>
      </tr>
  </tbody>
</table>
<h4 id="随机数">随机数</h4>
<table>
  <thead>
      <tr>
          <th>代码</th>
          <th style="text-align: left">说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>Math.random()</code></td>
          <td style="text-align: left">$${\small random} \ x\in\left [ 0,1 \right )$$</td>
      </tr>
      <tr>
          <td><code>parseInt(Math.random() * (b - a + 1)) + a</code></td>
          <td style="text-align: left">$${\small random} \ x\in\left [ a,b \right )$$</td>
      </tr>
  </tbody>
</table>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// 可以用Math.random()*n|0取整，语法上更加简洁
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">F</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">T</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">65553600</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">F</span><span class="o">++</span> <span class="o">:</span> <span class="nx">T</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">F</span><span class="p">,</span> <span class="nx">T</span><span class="p">,</span> <span class="nx">F</span> <span class="o">/</span> <span class="nx">T</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 接近1:19
</span></span></span></code></pre></div>
</div>
<h3 id="日期类">日期类</h3>
<p><code>new Date()</code> 即可得到当前时间的日期对象，它是 object 类型值。</p>
<p>Creates a JavaScript <strong><code>Date</code></strong> instance that represents a single moment in time in a platform-independent format.<code>Date</code> objects contain a <code>Number</code> that represents milliseconds since 1 January 1970 UTC.</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// Syntax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">new</span> <span class="nb">Date</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">dateString</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">dateObject</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">monthIndex</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">monthIndex</span><span class="p">,</span> <span class="nx">day</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">monthIndex</span><span class="p">,</span> <span class="nx">day</span><span class="p">,</span> <span class="nx">hours</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">monthIndex</span><span class="p">,</span> <span class="nx">day</span><span class="p">,</span> <span class="nx">hours</span><span class="p">,</span> <span class="nx">minutes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">monthIndex</span><span class="p">,</span> <span class="nx">day</span><span class="p">,</span> <span class="nx">hours</span><span class="p">,</span> <span class="nx">minutes</span><span class="p">,</span> <span class="nx">seconds</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">monthIndex</span><span class="p">,</span> <span class="nx">day</span><span class="p">,</span> <span class="nx">hours</span><span class="p">,</span> <span class="nx">minutes</span><span class="p">,</span> <span class="nx">seconds</span><span class="p">,</span> <span class="nx">milliseconds</span><span class="p">)</span></span></span></code></pre></div>
</div>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// Demo
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">date1</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;December 17, 1995 03:24:00&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">date2</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;1995-12-17T03:24:00&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">date1</span> <span class="o">===</span> <span class="nx">date2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">date1</span> <span class="o">-</span> <span class="nx">date2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([</span><span class="nx">date1</span><span class="p">,</span><span class="nx">date2</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Sun</span> <span class="nx">Dec</span> <span class="mi">17</span> <span class="mi">1995</span> <span class="mi">03</span><span class="o">:</span><span class="mi">24</span><span class="o">:</span><span class="mi">00</span> <span class="nx">GMT</span><span class="o">+</span><span class="mi">0800</span> <span class="p">(</span><span class="nx">China</span> <span class="nx">Standard</span> <span class="nx">Time</span><span class="p">)</span></span></span></code></pre></div>
</div>
<h4 id="常见方法">常见方法</h4>
<table>
  <thead>
      <tr>
          <th>方法</th>
          <th>功能</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>getDate()</code></td>
          <td>得到日期 $$D\in[1,31]$$</td>
      </tr>
      <tr>
          <td><code>getDay()</code></td>
          <td>得到星期 $$W\in[0,6]$$</td>
      </tr>
      <tr>
          <td><code>getMonth()</code></td>
          <td>得到月份 $$M\in[0,11]$$</td>
      </tr>
      <tr>
          <td><code>getFullYear()</code></td>
          <td>得到年份</td>
      </tr>
      <tr>
          <td><code>getHours()</code></td>
          <td>得到小时数 $$H\in[0,23]$$</td>
      </tr>
      <tr>
          <td><code>getMinutes()</code></td>
          <td>得到分钟数 $$M\in[0,59]$$</td>
      </tr>
      <tr>
          <td><code>getSeconds()</code></td>
          <td>得到秒数 $$S\in[0,59]$$</td>
      </tr>
  </tbody>
</table>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">//Usage
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">-&gt;</span> <span class="p">(</span><span class="nx">_</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([</span><span class="k">typeof</span> <span class="nx">_</span><span class="p">.</span><span class="nx">getDate</span><span class="p">(),</span> <span class="nx">_</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()]))(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span> <span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="mi">30</span> <span class="p">]</span></span></span></code></pre></div>
</div>
<h3 id="时间戳">时间戳</h3>
<p>时间戳表示 1970 年 1 月 1 日 零点整距离某时刻的毫秒数（UNIX 时间）</p>
<p>The <strong><code>DOMHighResTimeStamp</code></strong> type is a <code>double</code> and is used to store a time value in milliseconds.</p>
<p>This type can be used to describe a discrete point in time or a time interval (the difference in time between two discrete points in time).</p>
<p>The time, given in milliseconds, should be accurate to 5 µs (microseconds)</p>
<ul>
<li>通过 <code>getTime()</code> 方法或者 <code>Date.parse()</code> 函数可以将日期对象变为时间戳</li>
<li>通过 <code>new Date(时间戳)</code> 的写法，可以将 <strong>时间戳</strong> 变为 <strong>日期对象</strong></li>
</ul>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// 日期对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">d</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 显示时间戳的两种方式
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">timestamp1</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">getTime</span><span class="p">();</span>   <span class="c1">// 精确到毫秒
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">timestamp2</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">d</span><span class="p">);</span> <span class="c1">// 精确到秒，也是毫秒数，只不过最后三位一定是 000
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">timestamp1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">timestamp2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="mi">1648690017974</span>
</span></span><span class="line"><span class="cl">    <span class="mi">1648690017000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 将时间戳变为日期对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">-&gt;</span> <span class="kr">const</span> <span class="nx">dd</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="mi">1644661417000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">dd</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="nx">Sat</span> <span class="nx">Feb</span> <span class="mi">12</span> <span class="mi">2022</span> <span class="mi">18</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mi">37</span> <span class="nx">GMT</span><span class="o">+</span><span class="mi">0800</span> <span class="p">(</span><span class="nx">China</span> <span class="nx">Standard</span> <span class="nx">Time</span><span class="p">)</span></span></span></code></pre></div>
</div>
<h3 id="new-1"><em>new</em></h3>
<p>new 都做了什么？</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// 类：所有属性和方法模板的集合
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">Person</span><span class="p">(</span><span class="nx">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">sex</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="nx">age</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="p">.</span><span class="nx">sex</span> <span class="o">=</span> <span class="nx">sex</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 所有实例对象共享方法 - 节省内存
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">say</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 生产对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">person</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;男&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">person</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Person {name: &#39;foo&#39;, age: 18, sex: &#39;男&#39;}
</span></span></span></code></pre></div>
</div>
<ol>
<li>new 会创建一个空白对象</li>
<li>调用 Person 执行 <code>new Person</code> ，此时替换 person 函数里 this 的指向为一个新的空白对象</li>
</ol>
<h3 id="案例">案例</h3>
<ol>
<li>
<h4 id="红绿灯-">红绿灯 🚥</h4>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="c">&lt;!-- 未完成 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">:</span><span class="nd">root</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">font-size</span><span class="p">:</span> <span class="mi">625</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">@</span><span class="k">media</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">min-width</span><span class="o">:</span> <span class="nt">128px</span><span class="o">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">traffic_light</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">height</span><span class="p">:</span> <span class="mi">2</span><span class="kt">em</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">width</span><span class="p">:</span> <span class="mf">.75</span><span class="kt">em</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nc">traffic_light</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">background-image</span><span class="p">:</span> <span class="nb">linear-gradient</span><span class="p">(</span><span class="mi">87</span><span class="kt">deg</span><span class="p">,</span> <span class="mh">#434343</span> <span class="mi">0</span><span class="kt">%</span><span class="p">,</span> <span class="kc">black</span> <span class="mi">90</span><span class="kt">%</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">border-radius</span><span class="p">:</span> <span class="mf">.1</span><span class="kt">em</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">display</span><span class="p">:</span> <span class="kc">flex</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">flex-direction</span><span class="p">:</span> <span class="kc">column</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">align-items</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">justify-content</span><span class="p">:</span> <span class="kc">space-around</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nc">red</span><span class="o">,</span> <span class="p">.</span><span class="nc">yellow</span><span class="o">,</span> <span class="p">.</span><span class="nc">green</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">background-color</span><span class="p">:</span> <span class="kc">red</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">background-image</span><span class="p">:</span> <span class="nb">linear-gradient</span><span class="p">(</span><span class="mi">60</span><span class="kt">deg</span><span class="p">,</span> <span class="nb">rgba</span><span class="p">(</span><span class="mi">134</span><span class="p">,</span> <span class="mi">143</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">)</span> <span class="mi">0</span><span class="kt">%</span><span class="p">,</span> <span class="mh">#596164</span> <span class="mi">100</span><span class="kt">%</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">border-radius</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">height</span><span class="p">:</span> <span class="mf">.45</span><span class="kt">em</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">width</span><span class="p">:</span> <span class="mf">.45</span><span class="kt">em</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">box-shadow</span><span class="p">:</span> <span class="mf">.01</span><span class="kt">em</span> <span class="mf">.01</span><span class="kt">em</span> <span class="mf">.15</span><span class="kt">em</span> <span class="mi">0</span> <span class="mh">#363636</span> <span class="kc">inset</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nc">red</span><span class="p">::</span><span class="nd">before</span><span class="o">,</span> <span class="p">.</span><span class="nc">yellow</span><span class="p">::</span><span class="nd">before</span><span class="o">,</span> <span class="p">.</span><span class="nc">green</span><span class="p">::</span><span class="nd">before</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">content</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">display</span><span class="p">:</span> <span class="kc">block</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">border-radius</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">height</span><span class="p">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">width</span><span class="p">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">transition</span><span class="p">:</span> <span class="kc">all</span> <span class="mi">1</span><span class="kt">s</span> <span class="nb">cubic-bezier</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.03</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nc">red</span><span class="p">.</span><span class="nc">off</span><span class="p">::</span><span class="nd">before</span><span class="o">,</span> <span class="p">.</span><span class="nc">yellow</span><span class="p">.</span><span class="nc">off</span><span class="p">::</span><span class="nd">before</span><span class="o">,</span> <span class="p">.</span><span class="nc">green</span><span class="p">.</span><span class="nc">off</span><span class="p">::</span><span class="nd">before</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">opacity</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nc">red</span><span class="p">::</span><span class="nd">before</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">background-image</span><span class="p">:</span> <span class="nb">linear-gradient</span><span class="p">(</span><span class="mi">60</span><span class="kt">deg</span><span class="p">,</span> <span class="mh">#ff0844</span> <span class="mi">0</span><span class="kt">%</span><span class="p">,</span> <span class="mh">#ffb199</span> <span class="mi">100</span><span class="kt">%</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">box-shadow</span><span class="p">:</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mf">.05</span><span class="kt">em</span> <span class="mi">0</span> <span class="kc">red</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nc">yellow</span><span class="p">::</span><span class="nd">before</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">background-image</span><span class="p">:</span> <span class="nb">linear-gradient</span><span class="p">(</span><span class="mi">60</span><span class="kt">deg</span><span class="p">,</span> <span class="mh">#ff962a</span> <span class="mi">0</span><span class="kt">%</span><span class="p">,</span> <span class="mh">#fff029</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">box-shadow</span><span class="p">:</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mf">.05</span><span class="kt">em</span> <span class="mi">0</span> <span class="kc">yellow</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nc">green</span><span class="p">::</span><span class="nd">before</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">background-image</span><span class="p">:</span> <span class="nb">linear-gradient</span><span class="p">(</span><span class="mi">60</span><span class="kt">deg</span><span class="p">,</span> <span class="mh">#12992c</span> <span class="mi">0</span><span class="kt">%</span><span class="p">,</span> <span class="mh">#5ce0d3</span> <span class="mi">100</span><span class="kt">%</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">box-shadow</span><span class="p">:</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mf">.05</span><span class="kt">em</span> <span class="mi">0</span> <span class="kc">green</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nc">off</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;traffic_light&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;yellow off&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;green&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;use strict&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">control</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// .children
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">function</span> <span class="nx">TrafficLight</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">dom</span><span class="o">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s2">&#34;traffic_light&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="nx">status</span><span class="o">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">      <span class="nx">bindEvent</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<ol start="2">
<li>
<h4 id="小球-">小球 ⚪️</h4>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="c">&lt;!-- 未完成 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width="device-width," initial-scale="1.0&#34;</span"> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Document<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">body</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">background-color</span><span class="p">:</span> <span class="kc">black</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">ball</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">border-radius</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 小球类
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">function</span> <span class="nx">Ball</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 属性x、y表示的是圆心的坐标
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 半径属性
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">this</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 透明度
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">this</span><span class="p">.</span><span class="nx">opacity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 小球背景颜色，从颜色数组中随机选择一个颜色
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">this</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">colorArr</span><span class="p">[</span><span class="nb">parseInt</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">colorArr</span><span class="p">.</span><span class="nx">length</span><span class="p">)];</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 这个小球的x增量和y的增量，使用do while语句，可以防止dX和dY都是零
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">do</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="p">.</span><span class="nx">dX</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="p">.</span><span class="nx">dY</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dX</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">dY</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 初始化
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">this</span><span class="p">.</span><span class="nx">init</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 把自己推入数组，注意，这里的this不是类本身，而是实例
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">ballArr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 初始化方法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">Ball</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 创建自己的dom
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">this</span><span class="p">.</span><span class="nx">dom</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">dom</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">&#39;ball&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">dom</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">r</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">dom</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">r</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">dom</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">r</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">dom</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">r</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">dom</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">color</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 上树
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dom</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 更新
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">Ball</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 位置改变
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dX</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">-="</span"> <span class="k">this</span><span class="p">.</span><span class="nx">dY</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 半径改变
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">this</span><span class="p">.</span><span class="nx">r</span> <span class="o">+=</span> <span class="mf">0.2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 透明度改变
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">this</span><span class="p">.</span><span class="nx">opacity</span> <span class="o">-="</span"> <span class="mf">0.01</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">dom</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">r</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">dom</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">r</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">dom</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">r</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">dom</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">r</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">dom</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">opacity</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 当透明度小于0的时候，就需要从数组中删除自己，DOM元素也要删掉自己
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">opacity</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 从数组中删除自己
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ballArr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="nx">ballArr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="k">this</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">ballArr</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 还要删除自己的dom
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dom</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 把所有的小球实例都放到一个数组中
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">var</span> <span class="nx">ballArr</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 初始颜色数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">var</span> <span class="nx">colorArr</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#66CCCC&#39;</span><span class="p">,</span> <span class="s1">&#39;#CCFF66&#39;</span><span class="p">,</span> <span class="s1">&#39;#FF99CC&#39;</span><span class="p">,</span> <span class="s1">&#39;#FF6666&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;#CC3399&#39;</span><span class="p">,</span> <span class="s1">&#39;#FF6600&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 定时器，负责更新所有的小球实例
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 遍历数组，调用调用的update方法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ballArr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">ballArr</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">update</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span> <span class="mi">20</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 鼠标指针的监听
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nb">document</span><span class="p">.</span><span class="nx">onmousemove</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 得到鼠标指针的位置
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">clientX</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">clientY</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">new</span> <span class="nx">Ball</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<ol start="3">
<li>
<h4 id="倒计时">倒计时</h4>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>2022高考倒计时<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">h2</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;info&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">info</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// target date，5表示六月
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">const</span> <span class="nx">targetDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 定时器
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">const</span> <span class="nx">refreshTime</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 把diff换算为天、小时、分钟、秒
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 返回精确到秒的毫秒值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">let</span> <span class="nx">date</span> <span class="o">=</span> <span class="p">(</span><span class="nx">targetDate</span> <span class="o">-</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">millSecondsPerDay</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">info</span><span class="p">.</span><span class="nx">innerText</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">        <span class="sb">`还有</span><span class="si">${</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">date</span> <span class="o">/</span> <span class="nx">millSecondsPerDay</span><span class="p">)</span><span class="si">}</span><span class="sb">天___HUGO_PROTECTED_BLOCK_inline_780___</span><span class="si">${</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">date</span> <span class="o">%</span> <span class="nx">millSecondsPerDay</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1000</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">))</span><span class="si">}</span><span class="sb">小时`</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">        <span class="sb">`</span><span class="si">${</span><span class="nb">parseInt</span><span class="p">((</span><span class="nx">date</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1000</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1000</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)))</span><span class="si">}</span><span class="sb">分钟___HUGO_PROTECTED_BLOCK_inline_780___</span><span class="si">${</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">date</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1000</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1000</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span><span class="si">}</span><span class="sb">秒`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nx">setInterval</span><span class="p">(</span><span class="nx">refreshTime</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nx">refreshTime</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<h2 id="函数">函数</h2>
<p>函数就是 <strong>语句的封装</strong> ，可以让这些代码方便地被复用。函数具有 “一次定义，多次调用” 的优点。</p>
<p>使用函数，可以简化代码，让代码更具有可读性。</p>
<h3 id="算法">算法</h3>
<p>$y=f(x),f:X\to Y$</p>
<p>In mathematics and computer science, an algorithm is a <strong>finite sequence of well-defined instructions</strong>, typically used to solve a class of specific problems or to perform a computation.</p>
<ol>
<li>输入</li>
<li>输出</li>
<li>有穷性</li>
<li>确定性</li>
<li>可行性</li>
</ol>
<h3 id="传参">传参</h3>
<p>参数是函数内的一些待定值，在调用函数时，必须传入这些参数的具体值。</p>
<p>函数的参数可多可少，函数可以没有参数，也可以有多个参数，多个参数之间需要用逗号隔开。若形参的数目大于传入实参的数目，多余的内容将会被 <code>undefined</code> 填充。</p>
<p><code>undefined</code> 和数字进行运算的结果都是 <code>NaN</code> 。<code>typeof NaN = 'number'</code></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// 形参
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">add</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nx">sum</span> <span class="o">=</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;a + b = &#39;</span> <span class="o">+</span> <span class="nx">sum</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 实参
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">add</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> <strong>形式参数</strong> 和 <strong>实际参数</strong> 是彼此独立的，除了传递值之外，互不干扰。传入数组的时候相当于 C/C++ 传入的指针，函数内可以直接修改数组内容。</p>
        </blockquote>
        
    </figure>

<h4 id="arguments">Arguments<sup id="arguments-es5"> </sup></h4>
<p>在 <em><strong>ES5</strong></em> 中，用 <code>apply()</code> 方法可以很方便地将一个数组传递给函数。当传入函数的数组长度不确定的时候，使用 <code>arguments</code> 。</p>
<p>函数内 <code>arguments</code> 表示它接收到的实参列表，它是一个 <strong>类数组对象</strong> 。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:link: <em>Href</em></kbd> [<em>ES6</em>](06 EcmaScript.md/#rest-es6) 中， <em>arguments</em> 可被 <em>rest parameters</em> 所替代</p>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 类数组对象：所有属性均为从 <code>0</code> 开始的自然数序列，并且有 <code>length</code> 属性，和数组类似可以用方括号书写下标访问对象的某个属性值，但是<strong>不能调用</strong> 数组的方法。</p>
        </blockquote>
        
    </figure>

<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">fun</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span>		  <span class="c1">// [11 22 33 44]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>	<span class="c1">// 11
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>	<span class="c1">// 22
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">9</span><span class="p">]);</span>	<span class="c1">// undefined
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">fun</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">44</span><span class="p">);</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:bookmark_tabs: <em>Example</em></kbd> JS 本身没有函数的重载，但是可以借助 <code>arguments</code> 模拟。以下例子是一个典型的 <strong>函数重载</strong> ，参数个数不同形成 重载。</p>
<p><kbd>:warning: <em>Caution</em></kbd> Lorem ipsum dolor sit amet.</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">fun</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">fun</span><span class="p">();</span>     <span class="c1">// 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">fun</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>    <span class="c1">// 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">fun</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="c1">// 2
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h4 id="parameters">Parameters</h4>
<p>The <strong>rest parameter</strong> syntax allows a function to accept an indefinite number of arguments as an array, providing a way to represent variadic functions in JavaScript.</p>
<p><code>parameter</code> 的操作符为 <code>...</code> ，后边不再跟参数。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// Syntax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="p">...</span><span class="nx">theArgs</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// theArgs: [restParameters]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:warning: <em>Caution</em></kbd> <code> parameter</code> 不能和 <code>arguments</code> 一起使用，会报错。</p>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> <code>arguments</code> 和 <strong>剩余参数</strong> 的区别：</p>
<ol>
<li><code>arguments</code> 是一个 <strong>伪数组</strong><sup>Array-like</sup></li>
<li><strong>剩余参数</strong> 是一个 <strong>真正数组</strong><sup>Array</sup>，具有 <code>Array.prototype</code> 上的所有方法</li>
<li><code>arguments</code> 上有 <code>callee</code> 对象，<code>callee</code>上有 <code>caller</code></li>
</ol>
        </blockquote>
        
    </figure>

<p>另外，在传入参数时，扩展操作符 <code>...</code> 也可以用来扩展数组 <code>[]</code> 为参数列表，和其它参数混合使用：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">fun</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span><span class="p">(</span><span class="kr">const</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">arguments</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">foo</span><span class="p">(...</span><span class="nx">rest</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">rest</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nx">fun</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">...</span><span class="nx">params</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="p">...[</span><span class="mi">25</span><span class="p">]);</span><span class="c1">// 5 10 15 20 25
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">foo</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">...</span><span class="nx">params</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="p">...[</span><span class="mi">25</span><span class="p">]);</span><span class="c1">// [5, 10, 15, 20, 25]
</span></span></span></code></pre></div>
</div>
<h3 id="分类">分类</h3>
<h4 id="普通函数">普通函数</h4>
<p>JS 不支持 <strong>函数重载</strong>：</p>
<p>定义相同<strong>函数名</strong>、不同<strong>参数</strong>的函数，后面的函数会 <strong>覆盖</strong> 前面的函数。调用时，只会调用后面的函数。</p>
<p>默认返回 <code>undefined</code></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">fun</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Statements...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></div>
</div>
<ul>
<li><code>function</code>：表示定义函数</li>
<li><code>fun</code>：函数名（必须符合 JS 标识符命名规则）</li>
<li><code>()</code>：圆括号中是形参列表，即使没有形参，也必须书写圆括号</li>
<li><code>{}</code>：花括号内为函数语句块</li>
</ul>
<h4 id="匿名函数">匿名函数</h4>
<h5 id="变量-1">变量</h5>
<p>可以把函数赋值给变量、事件</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">bar</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Statements;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></div>
</div>
<ul>
<li><code>function(){}</code>：匿名函数</li>
<li><code>()</code>：圆括号中是形参列表，即使没有形参，也必须书写圆括号</li>
<li><code>{}</code>：花括号内为函数语句块</li>
<li><code>fun</code>：函数变量</li>
</ul>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd>  分号的使用：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">fun</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="c1">// 函数语句块
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span> <span class="c1">// 末尾不需要加 ;
</span></span></span></code></pre></div>
</div>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">fun</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="c1">// 函数语句块
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>	<span class="c1">// 末尾最好加上 ;
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h4 id="箭头函数">箭头函数<sup id="arrow-function-es6"> </sup></h4>
<p>ES6 标准新增了一种新的函数：Arrow Function（箭头函数）。箭头函数相当于<strong>匿名函数</strong>，并且简化了<strong>函数定义</strong> 。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><strong>Warning:</strong></p>
<ol>
<li>Arrow functions don&rsquo;t have their own bindings to <code>this</code> or <code>super</code>, and should not be used as <code>methods</code>.</li>
<li>Arrow functions aren&rsquo;t suitable for <code>call</code>, <code>apply</code> and <code>bind</code> methods, which generally rely on establishing a scope.</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">//一个参数，可简化括号&amp;表达式
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">x</span> <span class="p">=&gt;</span> <span class="nx">x</span> <span class="o">*</span> <span class="nx">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">_</span> <span class="p">=&gt;</span> <span class="mi">42</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 两个参数:
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">x</span> <span class="o">*</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span> <span class="o">*</span> <span class="nx">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 无参数:
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">()</span> <span class="p">=&gt;</span> <span class="mf">3.14</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 可变参数:
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="p">...</span><span class="nx">rest</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">sum</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">rest</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">sum</span> <span class="o">+=</span> <span class="nx">rest</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">sum</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<ul>
<li>包含多条语句时不能省略 <code>{ ... }</code> 和<code>return</code></li>
</ul>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> When (and why) you should use ES6 arrow functions:</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// ES5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">timesTwo</span><span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="p">{</span>  <span class="k">return</span> <span class="nx">params</span> <span class="o">*</span> <span class="mi">2</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">timesTwo</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>  <span class="c1">// 8
</span></span></span><span class="line"><span class="cl"><span class="c1">// ES6
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">timesTwo</span> <span class="o">=</span> <span class="nx">params</span> <span class="p">=&gt;</span> <span class="nx">params</span> <span class="o">*</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="nx">timesTwo</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>  <span class="c1">// 8
</span></span></span></code></pre></div>
</div>
<p>One thing you will quickly notice is the variety of syntaxes available in arrow functions.</p>
        </blockquote>
        
    </figure>

<h5 id="varations">Varations</h5>
<ol>
<li>No parameters</li>
</ol>
<p>If there are no parameters, you can place an empty parentheses before <code>=&gt;</code>.</p>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">()</span> <span class="p">=&gt;</span> <span class="mi">42</span></span></span></code></pre></div></div>
</div>
<p>In fact, you don’t even need the parentheses! ☆</p>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">_</span> <span class="p">=&gt;</span> <span class="mi">42</span></span></span></code></pre></div></div>
</div>
<ol start="2">
<li>Single parameter</li>
</ol>
<p>With these functions, parentheses are optional:</p>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">x</span> <span class="p">=&gt;</span> <span class="mi">42</span>  <span class="o">||</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="mi">42</span></span></span></code></pre></div></div>
</div>
<ol start="3">
<li>Multiple parameters</li>
</ol>
<p>Parentheses are required for these functions:</p>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="mi">42</span></span></span></code></pre></div></div>
</div>
<ol start="4">
<li>Statements (as opposed to expressions) ☆</li>
</ol>
<p>In its most basic form, a <strong>function expression</strong> produces a <strong>value</strong>, while a <strong>function statement</strong> performs an <strong>action</strong>.</p>
<p>With the arrow function, it is important to remember that statements need to have curly braces. Once the <strong>curly braces</strong> are <strong>present</strong>, you always need to write <code>return</code> as well.</p>
<p>Here is an example of the arrow function used with an if statement:</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">feedTheCat</span> <span class="o">=</span> <span class="p">(</span><span class="nx">cat</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">cat</span> <span class="o">===</span> <span class="s1">&#39;hungry&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;Feed the cat&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;Do not feed the cat&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<ol start="5">
<li>Block body</li>
</ol>
<p>If your function is in a block, you must also use the <strong>explicit</strong> <code>return</code> statement:</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">addValues</span> <span class="o">=</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<ol start="6">
<li>Object literals ☆</li>
</ol>
<p>If you are returning an <strong>object literal</strong>, it needs to be wrapped in parentheses. This forces the interpreter to evaluate what is inside the parentheses, and the object literal is returned.</p>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">x</span> <span class="p">=&gt;({</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">x</span> <span class="p">})</span></span></span></code></pre></div></div>
</div>
<h5 id="anonymous">Anonymous</h5>
<p>It is important to note that arrow functions are <strong>anonymous</strong>, which means that they are <strong>not named</strong>.</p>
<p>This anonymity creates some issues:</p>
<ol>
<li>Harder to debug</li>
</ol>
<p>When you get an error, you will not be able to trace the name of the function or the exact line number where it occurred.</p>
<ol start="2">
<li>No self-referencing</li>
</ol>
<p>If your function needs to have a self-reference at any point (e.g. recursion, event handler that needs to unbind), it will not work.</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><strong>N:</strong> new 构造函数最外层不能使用箭头函数，但内部成员函数实测无影响。</p>
        </blockquote>
        
    </figure>

<ol start="3">
<li>Main benefit: No binding of <code>this</code></li>
</ol>
<p>In classic function expressions, the <code>this</code> keyword is <strong>bound</strong> to different values based on the <strong>context</strong> in which it is called.</p>
<p>With arrow functions however, <code>this</code> is <strong>lexically bound</strong>(词汇绑定). It means that it uses<code>this</code> from the <strong>code that contains</strong> the arrow function.</p>
<p>For example, look at the <code>setTimeout</code> function below:</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// ES5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">id</span><span class="o">:</span> <span class="mi">42</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">counter</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">counter</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
</div>
<p>In the ES5 example, <code>.bind(this)</code> is required to help pass the <code>this</code> context into the function. Otherwise, by default <code>this</code> would be undefined.</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// ES6
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">id</span><span class="o">:</span> <span class="mi">42</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">counter</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">counter</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
</div>
<p>ES6 arrow functions can’t be bound to a <code>this</code> keyword, so it will lexically go up a scope, and use the value of <code>this</code> in the scope in which it was defined.</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 仍然和创建它的语句绑定。</p>
        </blockquote>
        
    </figure>

<h5 id="不适用场景">不适用场景</h5>
<ol>
<li>
<h5 id="作为构造函数">作为构造函数</h5>
<p>因为箭头函数没有 this，而构造函数的核心就是 this。</p>
</li>
<li>
<h5 id="对象方法">对象方法</h5>
</li>
</ol>
<p>When you call <code>cat.jumps</code>, the number of lives does not decrease. It is because <code>this</code> is <strong>not bound to anything</strong>, and will <strong>inherit</strong> the value of <code>this</code> from its <strong>parent scope</strong>.</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">cat</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">lives</span><span class="o">:</span> <span class="mi">9</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">jumps</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">lives</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<ol start="3">
<li>需要使用 <code>arguments</code> 的时候</li>
</ol>
<p>箭头函数没有 <code>arguments</code> ，但可以使用 ES6 的 <strong>剩余参数</strong><sup><code>...theArgs</code></sup> 代替。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 剩余参数<sup><code>...theArgs</code></sup> 和 <code>arguments</code> 一起使用同样会报错。</p>
        </blockquote>
        
    </figure>

<ol start="4">
<li>绑定 DOM</li>
</ol>
<p>类似</p>
<h5 id="usable">Usable</h5>
<p>Arrow functions shine best with anything that requires <code>this</code> to be bound to the <strong>context</strong>, and <strong>not the function</strong> itself.</p>
<p>Despite the fact that they are anonymous, I also like using them with methods such as <code>map</code> and <code>reduce</code>, because I think it makes my code more readable. To me, the pros outweigh the cons.</p>
<h4 id="闭包函数">闭包函数</h4>
<p>闭包是 <strong>函数本身</strong> 和该函数声明时所处的 <strong>环境状态</strong> 的组合。</p>
<p>函数能够 <strong>保存</strong> 其定义时所处的环境，即使函数不在其定义的环境中被 <strong>调用</strong> ，也能访问定义时所处环境的变量。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<ol>
<li>
<p>函数 A 内部声明了函数 B</p>
</li>
<li>
<p>函数 B 引用了函数 B 之外的变量</p>
</li>
<li>
<p>函数 A 的返回值为函数 B 的 <strong>引用</strong></p>
</li>
</ol>
<p>→ 函数 B 就是 <strong>闭包函数</strong> 。</p>
        </blockquote>
        
    </figure>

<p>在 JS 中， <strong>每次</strong> 创建函数时都会创建闭包。</p>
<p>但是，闭包特性往往需要将函数 <strong>换一个地方</strong> 执行，才能被直观的体现出来。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">funA</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// The outer function defines a variable called &#34;name&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kd">let</span> <span class="nx">funB</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="nx">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// The inner function has access to the &#34;name&#34; variable of the outer function
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">funB</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Return the inner function, thereby exposing it to outer scopes
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">myPet</span> <span class="o">=</span> <span class="nx">funA</span><span class="p">(</span><span class="s1">&#39;Vivie&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">myPet</span><span class="p">();</span> <span class="c1">// Returns &#34;Vivie&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">myPet</span> <span class="o">=</span> <span class="nx">funA</span><span class="p">(</span><span class="s1">&#39;Vivie&#39;</span><span class="p">)();</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myPet</span><span class="p">);</span> <span class="c1">// Returns &#34;Vivie&#34;
</span></span></span></code></pre></div>
</div>
<p>保证函数 funA 内里的变量安全，因为外部不能直接访问 funB 的变量。</p>
<p>闭包的功能：<kbd>记忆性</kbd>、<kbd>模拟私有变量</kbd> 。</p>
<h5 id="记忆性">记忆性</h5>
<p>当闭包产生时，函数所处环境的状态会 <strong>始终保持</strong> 在内存中， <strong>不会</strong> 在外层函数调用后 <strong>自动清除</strong> 。这就是闭包的记忆性。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd> 创建体温检测函数 checkTemp(n)，可以检查体温 n 是否正常，函数会返回布尔值。</p>
<p>但是，不同的小区有不同的体温检测标准，比如 A 小区体温合格线是 37.1℃，而 B 小区体温合格线是 37.3℃，应该怎么编程呢？</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">createCheckTemp</span><span class="p">(</span><span class="nx">standardTemp</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// standardTemp作为闭包私有变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// 不会在函数调用后自动清除
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// 内层函数用于操作私有变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// 虽然私有变量通常通过IIFE传入
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// 但外层IIFE(()=&gt;{})()并不是唯一的形式
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kd">function</span> <span class="nx">checkTemp</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">&lt;=</span> <span class="nx">standardTemp</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;你的体温正常&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;你的体温偏高&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">checkTemp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 创建一个 checkTemp 函数，它以 37.1 度为标准线
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">checkTemp_A</span> <span class="o">=</span> <span class="nx">createCheckTemp</span><span class="p">(</span><span class="mf">37.1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 再创建一个 checkTemp 函数， 它以 37.3 度为标准线
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">checkTemp_B</span> <span class="o">=</span> <span class="nx">createCheckTemp</span><span class="p">(</span><span class="mf">37.3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">checkTemp_A</span><span class="p">(</span><span class="mf">37.2</span><span class="p">);</span>	<span class="c1">// &#34;你的体温偏高&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">checkTemp_A</span><span class="p">(</span><span class="mf">37.0</span><span class="p">);</span>	<span class="c1">// &#34;你的体温正常&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">checkTemp_B</span><span class="p">(</span><span class="mf">37.2</span><span class="p">);</span>	<span class="c1">// &#34;你的体温正常&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">checkTemp_B</span><span class="p">(</span><span class="mf">37.6</span><span class="p">);</span>	<span class="c1">// &#34;你的体温偏高&#34;
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h5 id="封装">封装</h5>
<p>即：让变量变得安全，从外部只能访问指定的属性。</p>
<p>在 Java、C++ 等语言中，有私有属性的概念，但是 JS 中只能用闭包来模拟。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd> 题目：请定义一个变量 a，要求是能保证这个 a 只能被进行指定操作（如：加1、乘2），而不能进行其他操作，应该怎么编程呢？</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// 封装一个函数，这个函数的功能就是私有化变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">fun</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 定义一个内部成员变量i
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// 类似C++/Java里的私有 private 成员
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 返回一个对象 -&gt; C++/Java public 操作函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">getA</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">add</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">i</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">pow</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">i</span> <span class="o">*=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nx">fun</span><span class="p">();</span> <span class="c1">// 返回的是封装后函数列表
</span></span></span><span class="line"><span class="cl"><span class="c1">// 如果想在 fun 函数外面使用变量 a，唯一的方法就是调用 getA() 方法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">getA</span><span class="p">());</span> <span class="c1">// 0
</span></span></span><span class="line"><span class="cl"><span class="c1">// 想让变量 a 进行加 1 操作
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">add</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">getA</span><span class="p">());</span> <span class="c1">// 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">pow</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">getA</span><span class="p">());</span> <span class="c1">// 2
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:warning: <em>Caution</em></kbd> 不能滥用闭包！否则会造成网页的性能问题，严重时可能导致 <strong>内存泄漏</strong> 。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p>所谓 <strong>内存泄漏</strong> 就是指程序中已经动态分配的内存由于某种原因未释放或无法释放。</p>
        </blockquote>
        
    </figure>

<p>目前，Chrome 等比较先进的浏览器很少发生内存泄漏。</p>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 闭包的一道面试题</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">addCount</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">count</span> <span class="o">=</span> <span class="nx">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">count</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">fun1</span> <span class="o">=</span> <span class="nx">addCount</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">fun2</span> <span class="o">=</span> <span class="nx">addCount</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">fun1</span><span class="p">();</span>	<span class="c1">// 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">fun2</span><span class="p">();</span>	<span class="c1">// 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">fun2</span><span class="p">();</span>	<span class="c1">// 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">fun1</span><span class="p">();</span>	<span class="c1">// 2
</span></span></span><span class="line"><span class="cl"><span class="c1">// 即：会产生各自的独立闭包
</span></span></span><span class="line"><span class="cl"><span class="c1">// 参考前面的体温计
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h4 id="iife">IIFE</h4>
<p><strong>IIFE</strong> (立即执行函数表达式) - <strong>I</strong>mmediately <strong>I</strong>nvoked <strong>F</strong>unction <strong>E</strong>xpression</p>
<p>即在函数声明时，在后面紧跟参数；解析此函数时，里面代码立即执行。</p>
<p><code>this</code> 指向 window<code> 对象 / undefined</code><sup>[严格模式]</sup></p>
<ol>
<li>
<h5 id="iife-1">IIFE</h5>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* ... */</span>
</span></span><span class="line"><span class="cl"><span class="p">})();</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 1. 前面括号作用：将函数变为表达式，+-!~等运算符也能做到
</span></span></span><span class="line"><span class="cl"><span class="c1">// 2. 后面括号作用：运行函数，并传入参数
</span></span></span></code></pre></div>
</div>
<ol start="2">
<li>
<h5 id="arrow-function-iife">Arrow function IIFE</h5>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* ... */</span>
</span></span><span class="line"><span class="cl"><span class="p">})();</span></span></span></code></pre></div>
</div>
<ol start="3">
<li>
<h5 id="async-iife">Async IIFE</h5>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">(</span><span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* ... */</span>
</span></span><span class="line"><span class="cl"><span class="p">})();</span></span></span></code></pre></div>
</div>
<ol start="4">
<li>函数不能直接加上圆括号被调用</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{}()</span> <span class="c1">// Error!
</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 立即执行函数和闭包</p>
<p>使用全局变量可能会造成一些不必要的麻烦，因此我们要使用局部变量。</p>
<p>在 Java 语言中我们可以用 <code>{}</code> 将代码包裹起来，使它们成为局部变量，但是这在 ES5 中不行，因为 <code>var</code> 有变量提升。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 上面代码等同于
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">a</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>ES6 里面引入了 <code>let</code> 的概念，于是有了 <strong>块级作用域</strong>
解决了这个问题，IIFE 似乎就变得不那么必要了。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">a</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Uncaught ReferenceError: a is not defined
</span></span></span></code></pre></div>
</div>
<p>但是了解 IIFE 可以让我们初学者更好得理解函数表达式、变量提升等的概念，以及了解前端语言的发展进程，知道前人一步步将原本不那么美好的 JavaScript 变得规范化的过程，学习他们的智慧。</p>
<p>ES5 里面，没有块级作用域，只有 <strong>函数</strong><sup>↓函数作用域</sup> 可提供局部变量环境。</p>
<p>于是我们声明一个 <code>function fun</code>，然后执行 <code>fun.call()</code> 传参。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">fun</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}.</span><span class="nx">call</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="c1">// SyntaxError: Unexpected token &#39;.&#39;
</span></span></span></code></pre></div>
</div>
<p>但是这个时候 <code>fun()</code> 也是 <strong>全局函数</strong>
所以我们不能给这个函数名字，因此需要使用 <strong>匿名函数</strong> 。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}.</span><span class="nx">call</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="c1">// SyntaxError: Function statements require a function name
</span></span></span></code></pre></div>
</div>
<p>这是由于解析器认为这是一个 <strong>函数声明</strong> 。</p>
<p>解决方法：让 <strong>函数声明</strong> 变为 <strong>函数表达式</strong>
如给函数取反，则解析器会自动运算括号中的内容。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">!</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}.</span><span class="nx">call</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 我们不在乎这个匿名函数的返回值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* 等同于 */</span>
</span></span><span class="line"><span class="cl"><span class="c1">// !单目运算符优先级仅次于()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">!</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}.</span><span class="nx">call</span><span class="p">());</span></span></span></code></pre></div>
</div>
<p>类似的还有：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">+</span><span class="kd">function</span><span class="p">(){}.</span><span class="nx">call</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span><span class="kd">function</span><span class="p">(){}.</span><span class="nx">call</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="o">~</span><span class="kd">function</span><span class="p">(){}.</span><span class="nx">call</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">void</span> <span class="kd">function</span><span class="p">(){}()</span>
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="kd">function</span><span class="p">(){}()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// function(){}() === function(){}.call()
</span></span></span><span class="line"><span class="cl"><span class="c1">//用 .call() 更清楚，即()内为给前面函数提供的参数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="o">+</span><span class="kd">function</span><span class="p">(){}.</span><span class="nx">call</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span><span class="kd">function</span><span class="p">(){}();</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="p">(){}();</span>  <span class="c1">// SyntaxError: Function statements require a function name
</span></span></span></code></pre></div>
</div>
<p>如果不想改变函数返回值，也可以用圆括号包裹。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span><span class="p">(){}).</span><span class="nx">call</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span><span class="p">(){}.</span><span class="nx">call</span><span class="p">());</span></span></span></code></pre></div>
</div>
<p>但是如果括号前一行有语句，而语句末尾又没有加上分号 <code>;</code> 时，就会解析错误。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">a</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}).</span><span class="nx">call</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 等价于
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">a</span><span class="p">(</span><span class="cm">/*...*/</span><span class="p">).</span><span class="nx">call</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 这不是我们想要的
</span></span></span><span class="line"><span class="cl"><span class="c1">// 同理
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">a</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}.</span><span class="nx">call</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 等价于
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">a</span><span class="p">(</span><span class="cm">/*...*/</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ReferenceError: a is not defined
</span></span></span></code></pre></div>
</div>
<p>所以不推荐。</p>
<p>当然最推荐的还是在函数前使用取反 <code>!</code> ，这就好像是个警示：我要开始用 IIFE 了。</p>
<p>IIFE 达到了局部变量的效果，外面访问不到立即执行函数里面的变量（避免变量污染）。</p>
<p>但有时候我们需要访问 IIFE 里面的内容，怎么办？
最简单的方法是直接用全局变量 <code>window</code> 。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">!</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">n</span><span class="o">:</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}.</span><span class="nx">call</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 另一个立即执行函数通过 window.a 访问
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">!</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">a</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}.</span><span class="nx">call</span><span class="p">()</span> <span class="c1">// {n: 1}
</span></span></span></code></pre></div>
</div>
<p>于是引入了闭包，用于在 IIFE 隐藏 <code>i</code> 。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">!</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">n</span><span class="o">:</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nb">window</span><span class="p">.</span><span class="nx">fun</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 声明一个匿名函数保存于 window.nAdd1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">i</span><span class="p">.</span><span class="nx">n</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// return 新的 i.n
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="nx">i</span><span class="p">.</span><span class="nx">n</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}.</span><span class="nx">call</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 匿名函数可以操作函数外面的变量 i ，这就是闭包
</span></span></span><span class="line"><span class="cl"><span class="c1">// 另一个立即执行函数通过 window.foo 访问
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">!</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">fun</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}.</span><span class="nx">call</span><span class="p">();</span> <span class="c1">// 2
</span></span></span></code></pre></div>
</div>
<ol>
<li>
<p><strong>IIFE</strong> 使得 <code>i</code> 成为 <strong>局部变量</strong><sup>↓函数级变量</sup> 而无法被外部访问</p>
</li>
<li>
<p><strong>闭包</strong><sup>&ldquo;函数内函数&rdquo;</sup> 使得匿名函数可以操作 <code>i</code> ，而 <code>window.fun</code> 保存了匿名函数的地址，任何地方都可以使用，但不能操作内部变量，达到 <strong>变量隔离</strong> 的效果。</p>
</li>
</ol>
<p>而另一个 IIFE 中将 <code>window.fun</code> 的地址赋给 <code>var foo</code>。</p>
<h4 id="闭包">闭包</h4>
<p>将上面代码整合在一起，就是 <strong>闭包</strong> 的常见形式。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">closure</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">function</span> <span class="nx">fun</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 函数内函数，用于操作并隔离外层函数变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 也即：闭包
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 在函数作用域内变量和外层变量相互隔离
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 使用不同namespace（C++概念）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">i</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">fun</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="nx">closure</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">);</span> <span class="c1">// 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// 上面代码其实就是
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cm">/* 1. */</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">          <span class="k">return</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">i</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">i</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}()</span>
</span></span><span class="line"><span class="cl">    <span class="p">)()</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span> <span class="c1">// 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 2. */</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">i</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}.</span><span class="nx">call</span><span class="p">())</span> <span class="c1">// IIFE
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">.</span><span class="nx">call</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span> <span class="c1">// 2
</span></span></span></code></pre></div>
</div>
<p>现在我们明白了为什么闭包一般在 IIFE 里出现</p>
<p>IIFE 提供局部变量的环境，才有闭包的用武之地
<strong>return 的作用</strong></p>
<p>上面代码中的 <code>return</code> 和 window 的作用一样，是为了让外部能够访问 <strong>函数作用域内部</strong> 的函数。</p>
        </blockquote>
        
    </figure>

<h5 id="赋值-1">赋值</h5>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">age</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">sex</span> <span class="o">=</span> <span class="s1">&#39;男&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">title</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">age</span> <span class="o">&lt;</span> <span class="mi">18</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;小朋友&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">sex</span> <span class="o">==</span> <span class="s1">&#39;男&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s1">&#39;先生&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s1">&#39;女士&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})();</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h5 id="局部化">局部化</h5>
<p>ES5 不支持块级作用域的一种语法糖。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<p>解释：因为 <code>arr</code> 数组中的每个元素都是<code> function(){console.log()}</code> 这个函数，由于 <code>var i</code> 为全局变量，所以所有闭包内存都只有一个 <code>i</code> 。  <code>i</code> 最终值 5，未使用闭包时都输出 5 。</p>
<p>另外，直接使用 <code>let</code> 即可解决该问题。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 使用var时，没有作用域隔离，每次访问都是同一个变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// Mutable variable is accessible from closure
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// fori中变量改成let即可解决这个问题
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 0 1 2 3 4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">arr</span><span class="p">[</span><span class="nx">j</span><span class="p">]();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 5 5 5 5 5
</span></span></span></code></pre></div>
</div>
<p>若要在 ES5 的框架下解决问题，可创建闭包保存上下文：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">$i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 传入闭包的实参i在闭包内函数重新保存为形参$i
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 闭包作用：保存运行时上下文、隔离变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">$i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">})(</span><span class="nx">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 0 1 2 3 4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 0 1 2 3 4
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h3 id="返回">返回</h3>
<p>函数体内可以使用 <code>return</code> 关键字表示 <strong>函数的返回值</strong>。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">fun</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>  <span class="c1">// 函数的返回值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">foo</span> <span class="o">=</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>  <span class="c1">// 使用ES6箭头匿名函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">ret1</span> <span class="o">=</span> <span class="nx">fun</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>  <span class="c1">// 函数的返回值可以被变量接收
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">ret2</span> <span class="o">=</span> <span class="nx">foo</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span></span></span></code></pre></div>
</div>
<p>调用一个有返回值的函数，可以被当做一个普通值，从而可以出现在任何可以书写值的地方。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">sum</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">sum</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="nx">sum</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span></span></span></code></pre></div>
</div>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">sum</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">sum</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nx">sum</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">));</span>  <span class="c1">// 函数嵌套
</span></span></span></code></pre></div>
</div>
<p>遇见 <code>return</code> 即退出函数。</p>
<p>结合 if 语句的时候，往往不需要写 else 分支了。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// 判断一个数字是否为偶数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">checkEven</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">===</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">checkEven</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span> <span class="c1">// true
</span></span></span></code></pre></div>
</div>
<h3 id="this"><em>This</em><sup id="this-es5"> </sup><sup id="theargs-array"> </sup></h3>
<p>函数中可以使用 <em>this</em> 关键字，它表示函数的上下文。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:link: <em>Href</em></kbd> [<em>ES6</em>](06 EcmaScript.md/#super-es6) 对 <em>this</em> 又进行了扩充</p>
        </blockquote>
        
    </figure>

<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">fn</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// :memo: NOTE: () =&gt; console.log(this.x + this.y)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// 箭头匿名函数在这里会失效
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// 因为箭头函数的this自动指向上下文
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">fn</span><span class="p">();</span>  <span class="c1">// &gt;&gt; 3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">fn</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">fn</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">fn</span><span class="p">();</span>      <span class="c1">// &gt;&gt; NaN (x &amp; y is not defined)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">obj2</span> <span class="o">=</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">4</span><span class="p">,</span> <span class="nx">fn</span><span class="o">:</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">fn</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj2</span><span class="p">.</span><span class="nx">fn</span><span class="p">();</span> <span class="c1">// &gt;&gt; 7 (x="3" &amp; y="4)"
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj2</span><span class="p">.</span><span class="nx">fn</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">           <span class="c1">// &gt;&gt; ƒ () { console.log(this.x + this.y)}
</span></span></span></code></pre></div>
</div>
<p><kbd>:memo: <em>Note</em></kbd> 函数的 <strong>this</strong> 指针指向调用它的 <strong>对象</strong> 。事件处理函数的上下文是绑定事件的 DOM 元素。若对象不存在，则自动指向 window；严格模式下，指向 undefined 。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">fun</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">   <span class="nx">fun</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="nx">Window</span> <span class="p">{</span><span class="mi">0</span><span class="o">:</span> <span class="nx">Window</span><span class="p">,</span> <span class="nb">window</span><span class="o">:</span> <span class="nx">Wind</span><span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="kd">let</span> <span class="nx">fun</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">   <span class="nx">fun</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="kc">undefined</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="kd">let</span> <span class="nx">arrFun</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">     <span class="p">[</span><span class="s1">&#39;arr&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">}];</span>
</span></span><span class="line"><span class="cl">   <span class="nx">arrFun</span><span class="p">[</span><span class="mi">1</span><span class="p">]();</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="s1">&#39;arr&#39;</span><span class="p">,</span> <span class="nx">ƒ</span><span class="p">]</span></span></span></code></pre></div>
</div>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="cm">/* 1. IIFE */</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">})();</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="nx">Window</span> <span class="p">{</span><span class="mi">0</span><span class="o">:</span> <span class="nx">Window</span><span class="p">,</span> <span class="nb">window</span><span class="o">:</span> <span class="nx">Wind</span><span class="p">...</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="cm">/* 2. IIFE &amp; strict */</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">})();</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="kc">undefined</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="cm">/* 3. Array */</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">})();</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="nx">Window</span> <span class="p">{</span><span class="mi">0</span><span class="o">:</span> <span class="nx">Window</span><span class="p">,</span> <span class="nb">window</span><span class="o">:</span> <span class="nx">Wind</span><span class="p">...</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="cm">/* 4. Array &amp; strict */</span>
</span></span><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">})();</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="nx">Window</span> <span class="p">{</span><span class="mi">0</span><span class="o">:</span> <span class="nx">Window</span><span class="p">,</span> <span class="nb">window</span><span class="o">:</span> <span class="nx">Wind</span><span class="p">...</span></span></span></code></pre></div>
</div>
<p><strong>e.g.:</strong> 点击哪个盒子，哪个盒子在 2000 毫秒后就变红，要求使用同一个事件处理函数实现。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nc">container</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">height</span><span class="p">:</span> <span class="mi">10</span><span class="kt">vh</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">width</span><span class="p">:</span> <span class="mi">50</span><span class="kt">vh</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span> <span class="kc">auto</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">display</span><span class="p">:</span> <span class="kc">flex</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">justify-content</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nc">box</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">flex</span><span class="p">:</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">border</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">dashed</span> <span class="kc">darkslateblue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">margin</span><span class="p">:</span> <span class="mf">.5</span><span class="kt">em</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">transition</span><span class="p">:</span> <span class="kc">all</span> <span class="mf">.5</span><span class="kt">s</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;container&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;box&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;box&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;box&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;use strict&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">function</span> <span class="nx">setColor</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 备份当前调用对象&#34;this&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 命名为self/that/_this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kr">const</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 定时器调用对象为window
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 使用self控制原盒子
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">clicked</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nx">self</span><span class="p">.</span><span class="nx">clicked</span> <span class="o">=</span> <span class="o">!</span><span class="nx">self</span><span class="p">.</span><span class="nx">clicked</span><span class="p">;</span> <span class="c1">// JS中似乎没有取反的单目运算符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nx">self</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundImage</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">clicked</span> <span class="o">?</span> <span class="s2">&#34;linear-gradient(37deg, #f78ca0 0%, #f9748f 19%, #fd868c 60%, #fe9a8b 100%)&#34;</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span> <span class="mi">200</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">    //:memo: NOTE: 使用箭头匿名函数的时候，由于this不能动态绑定而是自动绑定到调用语句，因此this将自动指向window对象
</span></span></span><span class="line"><span class="cl"><span class="cm">    setTimeout(() =&gt; {
</span></span></span><span class="line"><span class="cl"><span class="cm">      this.clicked = !this.clicked;
</span></span></span><span class="line"><span class="cl"><span class="cm">      this.style.backgroundImage = this.clicked ? &#34;linear-gradient(37deg, #f78ca0 0%, #f9748f 19%, #fd868c 60%, #fe9a8b 100%)&#34; : null;
</span></span></span><span class="line"><span class="cl"><span class="cm">    }, 200);
</span></span></span><span class="line"><span class="cl"><span class="cm">    */</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">boxes</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s2">&#34;box&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">boxes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">boxes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">boxes</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">onclick</span> <span class="o">=</span> <span class="nx">setColor</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">boxes</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">clicked</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<h4 id="重绑定">重绑定</h4>
<p>可以在不变更对象的情况下，将 this 绑定到其它对象。</p>
<ol>
<li><code>call()</code>
<ul>
<li>The <strong><code>call()</code></strong> method calls a function with a given <code>this</code> value and arguments provided individually.</li>
</ul>
</li>
<li><code>apply()</code>
<ul>
<li>The <strong><code>apply()</code></strong> method calls a function with a given <code>this</code> value, and <code>arguments</code> provided as an array (or an array-like object).</li>
</ul>
</li>
<li><code>bind() </code>
<ul>
<li>The <code>bind()</code> method creates a <strong>new function</strong> that, when called, has its this keyword set to the provided value, with a given sequence of arguments preceding any provided when the new function is called.</li>
</ul>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="cm">/* 1. call()方法*/</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">thisArg</span><span class="p">,</span> <span class="nx">arg1</span><span class="p">,</span> <span class="p">...,</span> <span class="nx">argN</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 调用形式等同于原函数的 function(arg1, ..., argN)
</span></span></span><span class="line"><span class="cl"><span class="c1">// thisArg指向新this指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* 2. apply()方法*/</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">thisArg</span><span class="p">,</span> <span class="nx">argsArray</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 区别是参数列表变成了一个数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* 3. bind()方法*/</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">thisArg</span><span class="p">,</span> <span class="nx">arg1</span><span class="p">,</span> <span class="p">...,</span> <span class="nx">argN</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 和call()|apply()区别是返回的是一个新函数
</span></span></span></code></pre></div>
</div>
<p><strong>它们各自的定义：</strong></p>
<p><code>call()</code>：调用一个对象的一个方法，用另一个对象替换当前对象。</p>
<ul>
<li><strong>e.g.:</strong> <code>B.call(A, args1,args2);</code>即A对象调用B对象的方法</li>
</ul>
<p><code>apply()</code> ：调用一个对象的一个方法，用另一个对象替换当前对象。</p>
<ul>
<li><strong>e.g.:</strong> <code>B.apply(A, arguments);</code>即A对象应用B对象的方法</li>
</ul>
<p><code>bind()</code>：返回能调用一个对象的一个方法、用另一个对象替换当前对象的函数。若传入的参数不足，可在调用时添加。</p>
<ul>
<li>
<p><strong>e.g.:</strong></p>
</li>
<li>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl">  <span class="o">-&gt;</span> <span class="kd">function</span> <span class="nx">fun</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">z</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">z</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     <span class="p">}</span>
</span></span><span class="line"><span class="cl">     <span class="kr">const</span> <span class="nx">foo</span> <span class="o">=</span> <span class="nx">fun</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">fun</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">       <span class="c1">// function.prototype.bind()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">       <span class="c1">// 不足的参数，可在运行时传入
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="kr">const</span> <span class="nx">foo2</span> <span class="o">=</span> <span class="nx">fun</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">       <span class="c1">//thisArg接受空参数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="o">&gt;&gt;</span> <span class="mi">60</span></span></span></code></pre></div>
</div>
</li>
</ul>
<p><strong>它们的共同之处：</strong></p>
<p>都“可以用来代替另一个对象调用一个方法，将一个函数的 this 指针从初始的上下文改变为由 thisObj 指定的新对象”。</p>
<p><strong>它们的不同之处：</strong></p>
<p><code>apply()</code>：最多只能有两个参数——新this对象和一个数组 argArray 。如果给该方法传递多个参数，则把参数都写进这个数组里面，当然，即使只有一个参数，也要写进数组里。如果 argArray 不是一个有效的数组或 arguments 对象，那么将导致一个 TypeError 。如果没有提供 argArray 和 thisObj 任何一个参数，那么 Global 对象将被用作 thisObj ，并且无法被传递任何参数。</p>
<p><code>call()</code>：它可以接受多个参数，第一个参数与 apply 一样，后面则是一串参数列表。这个方法主要用在 js 对象各方法相互调用的时候，使当前 this 实例指针保持一致，或者在特殊情况下需要改变 this 指针。如果没有提供 thisObj 参数，那么 Global 对象被用作 thisObj 。</p>
<p>实际上， apply 和 call 的功能是一样的，只是传入的参数列表形式不同。</p>
<p><code>bind()</code>：创建一个新函数，当这个新函数被调用时，它的 this 值传递给 <code>bind()</code> 的第一个参数，而参数是 <code>bind()</code> 的其他参数和其原本的参数。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">obj</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">a</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">b</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">c</span> <span class="o">+</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">callObj</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">a</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">c</span><span class="o">:</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">ret1</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">callObj</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// call 必须要用逗号罗列参数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">ret2</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">callObj</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// apply 必须要把参数写到数组中
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">ret1</span> <span class="o">===</span> <span class="nx">ret2</span><span class="p">)</span> <span class="c1">//true
</span></span></span></code></pre></div>
</div>
<h4 id="默认规则">默认规则</h4>
<table>
  <thead>
      <tr>
          <th>规则</th>
          <th>this</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>对象.函数()</code></td>
          <td>对象</td>
      </tr>
      <tr>
          <td><code>函数()</code></td>
          <td>window/undefied<sup>[strict mode]</sup></td>
      </tr>
      <tr>
          <td><code>箭头函数()=&gt;{}</code></td>
          <td>Not Suitable</td>
      </tr>
      <tr>
          <td><code>数组[下标]()</code></td>
          <td>数组</td>
      </tr>
      <tr>
          <td><code>IIFE</code> (<code>(function(){})()</code>)</td>
          <td>window/undefied<sup>[strict mode]</sup></td>
      </tr>
      <tr>
          <td><code>定时器</code></td>
          <td>window</td>
      </tr>
      <tr>
          <td><code>DOM 事件处理函数</code></td>
          <td>绑定 DOM 的元素</td>
      </tr>
      <tr>
          <td><code>call</code> <code>apply</code> <code>bind</code></td>
          <td>任意指定</td>
      </tr>
  </tbody>
</table>
<p>函数的 this 只有函数在被执行的时候才会知道。且执行时谁调用的函数，函数的 this 就指向谁，否则就是 window 对象 / undefined<sup>[严格模式]</sup>。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<ol>
<li>箭头函数的 this 指向箭头函数定义时所处的对象，而不是箭头函数使用时所在的对象，默认使用外层作用域中的 this 指向的值，此外不能设置它们的 this 的值</li>
<li>由于箭头函数没有独立的 this，call() 和 apply() 方法只能传递参数进去，而设置的 this 参数会被忽略</li>
<li>在非严格模式下，this 其实是先被定义为 undefined，然后被自动转为了 window</li>
</ol>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// 普通函数this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">fun</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">fun</span><span class="p">();</span> <span class="c1">// window/global
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">fun</span><span class="p">.</span><span class="nx">call</span><span class="p">({</span><span class="nx">foo</span><span class="o">:</span> <span class="s2">&#34;bar&#34;</span><span class="p">});</span> <span class="c1">// {foo: &#39;bar&#39;}
</span></span></span></code></pre></div>
</div>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// 箭头函数this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">fun</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">fun</span><span class="p">();</span> <span class="c1">// {}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">fun</span><span class="p">.</span><span class="nx">call</span><span class="p">({</span><span class="nx">foo</span><span class="o">:</span> <span class="s2">&#34;bar&#34;</span><span class="p">});</span> <span class="c1">// {} 无法被改变
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h3 id="eval"><em>eval</em></h3>
<h3 id="new-function"><em>new Function</em></h3>
<h3 id="偏函数">偏函数</h3>
<p>偏函数用法是指创建一个调用另外一个部分&mdash;&mdash;参数或变量已经预置的函数&mdash;&mdash;的函数的用法。这句话相对较为拗口，下面我们以实例来说明：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">toString</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">isString</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;[object String]&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">isFunction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;[object Function]&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
</div>
<p>在JavaScript中进行类型判断时，我们通常会进行类似上述代码的方法定义。这段代码固然不复杂，只有两个函数的定义，但是里面存在的问题是我们需要重复去定义一些相似的函数，如果有更多的<code>isXXX()</code>，就会出现更多的冗余代码。为了解决重复定义的问题，我们引入一个新函数，这个新函数可以如工厂一样批量创建一些类似的函数。在下面的代码中，我们通过<code>isType()</code>函数预先指定<code>type</code>的值，然后返回一个新的函数：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">isType</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;[object &#39;</span> <span class="o">+</span> <span class="nx">type</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">isString</span> <span class="o">=</span> <span class="nx">isType</span><span class="p">(</span><span class="s1">&#39;String&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">isFunction</span> <span class="o">=</span> <span class="nx">isType</span><span class="p">(</span><span class="s1">&#39;Function&#39;</span><span class="p">);</span></span></span></code></pre></div>
</div>
<p>可以看出，引入<code>isType()</code>函数后，创建<code>isString()</code>、<code>isFunction()</code>函数就变得简单多了。这种通过指定部分参数来产生一个新的定制函数的形式就是偏函数。</p>
<p>偏函数应用在异步编程中也十分常见，著名类库Underscore提供的<code>after()</code>方法即是偏函数应用，其定义如下：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">_</span><span class="p">.</span><span class="nx">after</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">times</span><span class="p">,</span> <span class="nx">func</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">times</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="nx">func</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">--</span><span class="nx">times</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
</div>
<p>这个函数可以根据传入的<code>times</code>参数和具体方法，生成一个需要调用多次才真正执行实际函数的函数。</p>
<h3 id="currying">Currying</h3>
<p>柯里化（Currying），是把接受多个参数的函数变换成接受一个单一参数（最初函数的第一个参数）的函数，并且返回接受余下的参数而且返回结果的新函数的技术。</p>
<p>看这个解释有一点抽象，我们就拿被做了无数次示例的 add 函数，来做一个简单的实现。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="line"><span class="cl"><span class="c1">// 普通的add函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">add</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Currying后
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">curryingAdd</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>           <span class="c1">// 3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">curryingAdd</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="mi">2</span><span class="p">)</span>   <span class="o">/</span><span class="err">/ 3</span></span></span></code></pre></div>
</div>
<p>实际上就是把add函数的x，y两个参数变成了先用一个函数接收x然后返回一个函数去处理y参数。现在思路应该就比较清晰了，就是只传递给函数一部分参数来调用它，让它返回一个函数去处理剩下的参数。</p>
<p>但是问题来了费这么大劲封装一层，到底有什么用处呢？没有好处想让我们程序员多干事情是不可能滴，这辈子都不可能.</p>
<p>来列一列Currying有哪些好处呢？</p>
<ol>
<li>
<h5 id="参数复用">参数复用</h5>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="line"><span class="cl"><span class="c1">// 正常正则验证字符串 reg.test(txt)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// 函数封装后
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">check</span><span class="p">(</span><span class="nx">reg</span><span class="p">,</span> <span class="nx">txt</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">reg</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">txt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">check</span><span class="p">(</span><span class="sr">/\d+/g</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>       <span class="c1">//false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">check</span><span class="p">(</span><span class="sr">/[a-z]+/g</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>    <span class="c1">//true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// Currying后
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">curryingCheck</span><span class="p">(</span><span class="nx">reg</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">txt</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">reg</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">txt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">hasNumber</span> <span class="o">=</span> <span class="nx">curryingCheck</span><span class="p">(</span><span class="sr">/\d+/g</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">hasLetter</span> <span class="o">=</span> <span class="nx">curryingCheck</span><span class="p">(</span><span class="sr">/[a-z]+/g</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">hasNumber</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">)</span>      <span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">hasNumber</span><span class="p">(</span><span class="s1">&#39;testtest&#39;</span><span class="p">)</span>   <span class="c1">// false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">hasLetter</span><span class="p">(</span><span class="s1">&#39;21212&#39;</span><span class="p">)</span>      <span class="o">/</span><span class="err">/ false</span></span></span></code></pre></div>
</div>
<p>上面的示例是一个正则的校验，正常来说直接调用check函数就可以了，但是如果我有很多地方都要校验是否有数字，其实就是需要将第一个参数reg进行复用，这样别的地方就能够直接调用hasNumber，hasLetter等函数，让参数能够复用，调用起来也更方便。</p>
<ol start="2">
<li>
<h5 id="提前确认">提前确认</h5>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">on</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">handler</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">element</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span> <span class="o">&amp;&amp;</span> <span class="nx">handler</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">element</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">handler</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">element</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span> <span class="o">&amp;&amp;</span> <span class="nx">handler</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">element</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s1">&#39;on&#39;</span> <span class="o">+</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">handler</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">on</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">handler</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">element</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span> <span class="o">&amp;&amp;</span> <span class="nx">handler</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">element</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">handler</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">handler</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">element</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span> <span class="o">&amp;&amp;</span> <span class="nx">handler</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">element</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s1">&#39;on&#39;</span> <span class="o">+</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">handler</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//换一种写法可能比较好理解一点，上面就是把isSupport这个参数给先确定下来了
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">on</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">isSupport</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">handler</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">isSupport</span> <span class="o">=</span> <span class="nx">isSupport</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">isSupport</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">element</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">handler</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">element</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s1">&#39;on&#39;</span> <span class="o">+</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">handler</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>我们在做项目的过程中，封装一些dom操作可以说再常见不过，上面第一种写法也是比较常见，但是我们看看第二种写法，它相对一第一种写法就是自执行然后返回一个新的函数，这样其实就是提前确定了会走哪一个方法，避免每次都进行判断。</p>
<ol start="3">
<li>
<h5 id="延迟运行">延迟运行</h5>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="line"><span class="cl"><span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">bind</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>像我们js中经常使用的bind，实现的机制就是Currying.</p>
<p>说了这几点好处之后，发现还有个问题，难道每次使用Currying都要对底层函数去做修改，</p>
<p>有没有什么通用的封装方法？</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="line"><span class="cl"><span class="c1">// 初步封装
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">currying</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// args 获取第一个方法内的全部参数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 将后面方法里的全部参数和args进行合并
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">newArgs</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 把合并后的参数通过apply作为fn的参数并执行
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">newArgs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>这边首先是初步封装,通过闭包把初步参数给保存下来，然后通过获取剩下的arguments进行拼接，最后执行需要currying的函数。</p>
<p>但是好像还有些什么缺陷，这样返回的话其实只能多扩展一个参数，currying(a)(b)(c)这样的话，貌似就不支持了（不支持多参数调用），一般这种情况都会想到使用递归再进行封装一层。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="line"><span class="cl"><span class="c1">// 支持多参数传递
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">progressCurrying</span><span class="p">(</span><span class="nx">fn</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">args</span> <span class="o">||</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">_args</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">push</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">args</span><span class="p">,</span> <span class="nx">_args</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 如果参数个数小于最初的fn.length，则递归调用，继续收集参数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="nx">_args</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">progressCurrying</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">_this</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">_args</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 参数收集完毕，则执行fn
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">_args</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>这边其实是在初步的基础上，加上了递归的调用，只要参数个数小于最初的fn.length，就会继续执行递归。</p>
<p>好处说完了，通用方法也有了，让我们来关注下curry的性能</p>
<p>curry的一些性能问题你只要知道下面四点就差不多了：</p>
<ul>
<li>存取arguments对象通常要比存取命名参数要慢一点</li>
<li>一些老版本的浏览器在arguments.length的实现上是相当慢的</li>
<li>使用fn.apply( … ) 和 fn.call( … )通常比直接调用fn( … ) 稍微慢点</li>
<li>创建大量嵌套作用域和闭包函数会带来花销，无论是在内存还是速度上</li>
</ul>
<p>其实在大部分应用中，主要的性能瓶颈是在操作DOM节点上，这js的性能损耗基本是可以忽略不计的，所以curry是可以直接放心的使用。</p>
<p>最后再扩展一道经典面试题</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="line"><span class="cl"><span class="c1">// 实现一个add方法，使计算结果能够满足如下预期：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="mi">2</span><span class="p">)(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="mi">2</span><span class="p">)(</span><span class="mi">3</span><span class="p">)(</span><span class="mi">4</span><span class="p">)(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">add</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 第一次执行时，定义一个数组专门用来存储所有的参数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">var</span> <span class="nx">_args</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 在内部声明一个函数，利用闭包的特性保存_args并收集所有的参数值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">var</span> <span class="nx">_adder</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">_args</span><span class="p">.</span><span class="nx">push</span><span class="p">(...</span><span class="nx">arguments</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">_adder</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 利用toString隐式转换的特性，当最后执行时隐式转换，并计算最终的值返回
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">_adder</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">_args</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">_adder</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="mi">2</span><span class="p">)(</span><span class="mi">3</span><span class="p">)</span>                <span class="c1">// 6
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)(</span><span class="mi">4</span><span class="p">)</span>             <span class="c1">// 10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="mi">2</span><span class="p">)(</span><span class="mi">3</span><span class="p">)(</span><span class="mi">4</span><span class="p">)(</span><span class="mi">5</span><span class="p">)</span>          <span class="c1">// 15
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>                <span class="o">/</span><span class="err">/ 9</span></span></span></code></pre></div>
</div>
<h2 id="正则">正则<sup id="regexp-es5"> </sup></h2>
<p>正则表达式 <code>RegExp</code><sup>Object</sup> 描述了字符串的 <strong>构成模式</strong>，经常被用于检查字符串是否符合预定的格式要求。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 可用于验证手机号、验证邮箱、验证身份证等</p>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:link: <em>Href</em></kbd> [<em>ES6</em>](06 EcmaScript.md/#regexp-es6) 正则的扩展</p>
        </blockquote>
        
    </figure>

<p>表达式使用 <code>test()</code> 方法检查字符串是否符合正则表达式的规则。</p>
<h3 id="创建-1">创建</h3>
<ol>
<li>使用 <code>/内容/</code> 的语法形式，可以快速创建正则表达式。</li>
<li>也可以使用 <code>new RegExp('内容')</code><sup>传入String</sup> 的形式，创建正则表达式。</li>
<li>使用 <code>typeof</code> 运算符检查正则表达式的类型，结果是 <code>object</code></li>
</ol>
<h3 id="元字符">元字符</h3>
<p><strong>元字符</strong> 是指一位指定类型的字符。</p>
<table>
  <thead>
      <tr>
          <th>元字符</th>
          <th>功能</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>\d</code></td>
          <td>匹配一个数字</td>
      </tr>
      <tr>
          <td><code>\D</code></td>
          <td>匹配一个非数字字符</td>
      </tr>
      <tr>
          <td><code>\w</code></td>
          <td>匹配一个单字字符（字母、数字或者下划线）</td>
      </tr>
      <tr>
          <td><code>\W</code></td>
          <td>匹配一个非单字字符</td>
      </tr>
      <tr>
          <td><code>\s</code></td>
          <td>匹配一个空白字符，包括空格，制表符和换行符</td>
      </tr>
      <tr>
          <td><code>.</code></td>
          <td>任意字符</td>
      </tr>
      <tr>
          <td><code>^</code></td>
          <td>匹配开头</td>
      </tr>
      <tr>
          <td><code>$</code></td>
          <td>匹配结尾</td>
      </tr>
  </tbody>
</table>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 如果使用 <code>new RegExp()</code> 写法，需要对反斜杆转义<sup><code>\\</code></sup> 。</p>
<p><strong>e.g.:</strong> <code>/^\d$/</code> 和 <code>new RegExp('^\\d$')</code> 是相同的意思。</p>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<ol>
<li>
<p>某快递公司运单号形式是这样的：<code>123-4567-890</code>，请使用正则表达式检查某字符串是否符合此格式。</p>
</li>
<li>
<p>某产品的验证密钥是这样的：<code>□□□-□□□□-□□□</code>，其中 <code>□</code> 表示字母数字或者下划线，请使用正则表达式检查某字符串是否符合此格式。</p>
</li>
</ol>
        </blockquote>
        
    </figure>

<p>在特殊字符之前的反斜杠 <code>\</code> 表示下一个字符不是特殊字符，应该按照字面理解。</p>
<ol>
<li><code>/^.$/</code>：检查字符串是不是任意字符</li>
<li><code>/^\.$/</code>：检查字符串是不是一个点</li>
<li><code>/^\\$/</code>：检查字符串是不是一个反斜杠</li>
</ol>
<p>不管一个符号有没有特殊意义，都可以在其之前加上一个 <code>\</code> 以确保它表达的是这个符号本身。</p>
<h3 id="集合">集合</h3>
<p>使用方括号，比如 <code>[xyz]</code>，可以创建一个 <strong>字符集合</strong> ，表示匹配方括号中的任意字符。</p>
<p>可以使用短横 <code>-</code> 来指定一个字符范围，<code>^</code> 表示否定。</p>
<table>
  <thead>
      <tr>
          <th>元字符</th>
          <th>等价的方括号表示法</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>\d</code></td>
          <td><code>[0-9]</code></td>
      </tr>
      <tr>
          <td><code>\D</code></td>
          <td><code>[^0-9]</code></td>
      </tr>
      <tr>
          <td><code>\w</code></td>
          <td><code>[A-Za-z0-9_]</code></td>
      </tr>
      <tr>
          <td><code>\W</code></td>
          <td><code>[^A-Za-z0-9_]</code></td>
      </tr>
  </tbody>
</table>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd> 比如某学校的学号规定：第1位是一个字母，b表示本科生，y表示研究生，后面是7位数字，用正则表达式表示为：</p>
<p><code>/^[by]\d{7}$/</code></p>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:warning: <em>Caution</em></kbd> 在英文中，大写字母的序号比小写字母更小。因此正确表达英文字母的方式是 <code>[A-z]</code> 。</p>
<p>否则范围报错：<code>Invalid regular expression: /[a-Z]/: Range out of order in character class</code></p>
        </blockquote>
        
    </figure>

<h3 id="量词">量词</h3>
<table>
  <thead>
      <tr>
          <th>量词</th>
          <th>意义</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>*</code></td>
          <td>匹配前一个表达式 0 次或多次。等价于 <code>{0, }</code></td>
      </tr>
      <tr>
          <td><code>+</code></td>
          <td>匹配前面一个表达式 1 次或者多次。等价于 <code>{1, }</code></td>
      </tr>
      <tr>
          <td><code>?</code></td>
          <td>匹配前面一个表达式 0 次或者 1 次。等价于 <code>{0, 1}</code></td>
      </tr>
      <tr>
          <td><code>{n}</code></td>
          <td>n 是一个正整数，匹配了前面一个字符刚好出现了 n 次</td>
      </tr>
      <tr>
          <td><code>{n, }</code></td>
          <td>n 是一个正整数，匹配前一个字符至少出现了 n 次</td>
      </tr>
      <tr>
          <td><code>{n, m}</code></td>
          <td>n 和 m 都是整数。匹配前面的字符至少 n 次，最多 m 次</td>
      </tr>
  </tbody>
</table>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em> 1</kbd> 请验证字符串是否符合手机号码的规则：11 位数字，并且肯定以 1 开头。</p>
<p><code>/^1\d{10}/</code></p>
<p><kbd>:page_with_curl: <em>Example</em> 2</kbd> 请验证某字符串是否是这样的：以字母开头，中间是任意位数字（最少1位）构成，并以字母结尾。</p>
<p><code>/^[A-z]\d{1,}[A-z]$/</code></p>
<p><kbd>:page_with_curl: <em>Example</em> 3</kbd> 请验证某字符串是否符合网址规则：以 <code>www.</code> 开头，中间是任意位的字符（字母数字下划线），最后以 <code>.com</code> 结尾，也可以以 <code>.com.cn</code> 结尾</p>
<p><code>/^www\..*(?:\.com\.cn|\.com)$/</code></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nb">RegExp</span> <span class="o">=</span> <span class="sr">/^www\..*(?:\.com\.cn|\.com)$/</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">RegExp</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;www.baidu.com&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nb">RegExp</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;www.apple.com.cn&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// true
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h3 id="修饰符">修饰符</h3>
<p>修饰符也叫作 <strong>标志</strong><sup>flags</sup>，用于使用正则表达式实现高级搜索。</p>
<table>
  <thead>
      <tr>
          <th>修饰符</th>
          <th>意义</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>i</code></td>
          <td>不区分大小写搜索</td>
      </tr>
      <tr>
          <td><code>g</code></td>
          <td>全局搜索</td>
      </tr>
  </tbody>
</table>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">R</span> <span class="o">=</span> <span class="sr">/m/gi</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 修饰符位置在正则表达式后面，可多个连写
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">R</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s2">&#34;m&#34;</span><span class="p">,</span> <span class="s2">&#34;gi&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//new RegExp()的形式传入时，以字符串的形式写入第二个参数
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<ol>
<li>
<p>用正则表达式进行表单验证是正则表达式最重要的实际应用</p>
</li>
<li>
<p>实际上，很多正则表达式不需要我们自己写，可以通过搜索引擎查找、拿来即用</p>
</li>
<li>
<p>RegEx-Vis 这个网站可以可视化编辑 RegExp</p>
</li>
</ol>
        </blockquote>
        
    </figure>

<h3 id="匹配">匹配</h3>
<h4 id="test"><code>test()</code></h4>
<p>正则表达式的 <code>test()</code> 方法用来测试某字符串是否匹配此正则表达式，它返回 <code>true</code> 或 <code>false</code>。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="sr">/^[a-z]{3}[a-ln-z]$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;abcd&#39;</span><span class="p">)</span>	<span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1">//[a-ln-z]表示从a到l和从n到z均可
</span></span></span></code></pre></div>
</div>
<h4 id="exec"><code>exec()</code></h4>
<p>方法功能是：在一个指定字符串中执行一个搜索匹配查找，返回一个结果数组或 null。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;abc123def456ghi789&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">regexp</span> <span class="o">=</span> <span class="sr">/\d+/</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">result1</span> <span class="o">=</span> <span class="nx">regexp</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// [ &#39;123&#39;, index: 3, input: &#39;abc123def456ghi789&#39;, groups: undefined ]
</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<p>添加了 <code>g</code> 修饰符的正则表达式可以自动保存遍历状态，这意味着可以对单个字符串进行 <strong>逐条多次</strong> 的遍历。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">str</span> <span class="o">=</span> <span class="s2">&#34;abc123def456ghi789&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">reg</span> <span class="o">=</span> <span class="sr">/\d+/g</span><span class="p">;</span> <span class="c1">// 有g修饰符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="p">(</span><span class="nx">res</span> <span class="o">=</span> <span class="nx">reg</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">str</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* [ &#39;123&#39;, index: 3, input: &#39;abc123def456ghi789&#39;, groups: undefined ]
</span></span></span><span class="line"><span class="cl"><span class="cm">   * [ &#39;456&#39;, index: 9, ... ]
</span></span></span><span class="line"><span class="cl"><span class="cm">   * [ &#39;789&#39;, index: 15, ... ]
</span></span></span><span class="line"><span class="cl"><span class="cm">   */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// null
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h3 id="字符串">字符串</h3>
<p>字符串有哪些方法可以使用正则表达式？</p>
<table>
  <thead>
      <tr>
          <th>方法</th>
          <th>简介</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>search()</code></td>
          <td>在字符串中根据正则表达式进行查找匹配，返回首次匹配到的位置索引，测试不到则返回 -1</td>
      </tr>
      <tr>
          <td><code>match()</code></td>
          <td>在字符串中根据正则表达式进行查找匹配，返回一个数组，找不到则返回 null</td>
      </tr>
      <tr>
          <td><code>replace()</code></td>
          <td>使用替换字符串替换掉匹配到的字符串，可以使用正则表达式</td>
      </tr>
      <tr>
          <td><code>split()</code></td>
          <td>分隔字符串为数组，可以使用正则表达式</td>
      </tr>
  </tbody>
</table>
<h2 id="异步">异步</h2>
<h3 id="函数节流">函数节流</h3>
<p>一个函数执行一次后，只有大于设定的执行周期后才允许执行第二次。</p>
<p>函数节流的意义：在许多 JS + CSS3 实现的动画中，如果没有函数节流，那么当一个动画还没有执行完时，如果用户再次要求执行动画，则动画会直接中断还未执行完的动画，然后执行新的动画。</p>
<p>我们要通过函数节流来避免这种情况，比如：轮播图中就要避免用户高频地点击轮播图切换按钮时轮播图飞快切换的问题，而应该做到无论用户点击多块，轮播图的切换速度始终是平稳的。</p>
<p>函数节流非常容易实现，只需借助 <code>setTimeout</code> 延时器。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd> 函数节流模版</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// JS 属于单线程语句，因此只需要一个标志即可
</span></span></span><span class="line"><span class="cl"><span class="c1">// 声明节流锁
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">locked</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nb">window</span><span class="p">.</span><span class="nx">throttling</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">throttleFun</span><span class="p">(</span><span class="nx">fun</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 如果锁是关闭状态，则不执行
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="nx">locked</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 关锁
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">locked</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">fun</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">throttling</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 先清除之前的定时器
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nb">window</span><span class="p">.</span><span class="nx">throttling</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 指定毫秒数后将锁打开
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">locked</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span> <span class="mi">2000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// timeout即为定时器时间
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">$</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">fun</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//函数核心语句
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">$</span><span class="o">++</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">throttleFun</span><span class="p">(</span><span class="nx">fun</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">throttleFun</span><span class="p">(</span><span class="nx">fun</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">throttleFun</span><span class="p">(</span><span class="nx">fun</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">throttleFun</span><span class="p">(</span><span class="nx">fun</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">throttleFun</span><span class="p">(</span><span class="nx">fun</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 2s内只能执行一次，其它都被节流
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h2 id="动画">动画</h2>
<p>13.7 初步认识异步语句</p>
<p><code>setInterval()</code> 和 <code>setTimeout()</code> 是两个异步语句。</p>
<p>异步（asynchronous）：不会阻塞 CPU 继续执行其他语句，当异步完成时，会执行 “回调函数”（callback）。</p>
<p><img src="/mark-img/e3423b0d66af49b5a113b2fce2c1dc62.png" alt=""  /></p>
<p>通过 JS 的异步、定时器可以实现相应的动画。</p>
<p>13.8 使用定时器实现动画</p>
<p>动画是网页上非常常见的业务需求。</p>
<p>使用定时器实现动画就是利用 “视觉暂留” 原理。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width="device-width," initial-scale="1.0&#34;</span"><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Document<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="nn">box</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">top</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">left</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">width</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">height</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">background-color</span><span class="p">:</span> <span class="kc">orange</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">button</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;btn&#34;</span><span class="p">&gt;</span>开始运动<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;box&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 得到元素
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">btn</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;btn&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">box</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;box&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 全局变量盒子的left值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">left</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 按钮监听
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">btn</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kd">var</span> <span class="nx">timer</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 改变全局变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="nx">left</span> <span class="o">+=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="nx">left</span> <span class="o">&gt;=</span> <span class="mi">1000</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">timer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 设置left属性
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="nx">box</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="nx">left</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span> <span class="mi">20</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<p><img src="/mark-img/9cdd8fb6242143858bd1a9df1899ce6f.gif" alt=""  /></p>
<p>使用定时器实现动画较为不便：</p>
<ol>
<li>不方便根据动画总时间计算步长</li>
<li>运动方向要设置正负</li>
<li>多种运动进行叠加较为困难</li>
</ol>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p>所以实际开发中是利用：</p>
<p>JQuery 等 JS 库（目前利用得越来越少）</p>
<p>JS + CSS3 的模式制作动画</p>
        </blockquote>
        
    </figure>

<p>十四、JS和CSS3结合实现动画</p>
<p>14.1 JS和CSS3结合实现动画</p>
<ul>
<li>我们知道，CSS3 的 <code>transition</code> 过渡属性可以实现动画。</li>
<li>JS 可以利用 CSS3 的 transition 属性轻松实现元素动画。</li>
<li>JS 和 CSS3 结合实现动画规避了定时器制作动画的缺点。</li>
</ul>
<p>14.2 函数节流</p>
<p>函数节流：一个函数执行一次后，只有大于设定的执行周期后才允许执行第二次。</p>
<p>函数节流的意义：在许多 JS + CSS3 实现的动画中，如果没有函数节流，那么当一个动画还没有执行完时，如果用户再次要求执行动画，则动画会直接中断还未执行完的动画，然后执行新的动画。我们要通过函数节流来避免这种情况，比如：轮播图中就要避免用户高频地点击轮播图切换按钮时轮播图飞快切换的问题，而应该做到无论用户点击多块，轮播图的切换速度始终是平稳的。</p>
<p>函数节流非常容易实现，只需借助 <code>setTimeout</code> 延时器。</p>
<p>【函数节流模板】</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// 声明节流锁
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">lock</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">需要节流的函数</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 如果锁是关闭状态，则不执行
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">lock</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 函数核心语句
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// ……
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 函数核心语句
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    
</span></span><span class="line"><span class="cl">    <span class="c1">// 关锁
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">lock</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 指定毫秒数后将锁打开
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">lock</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span> <span class="mi">2000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>【案例】</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width="device-width," initial-scale="1.0&#34;</span"><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Document<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="nn">box</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">width</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">height</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">background-color</span><span class="p">:</span> <span class="kc">orange</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">top</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">left</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">button</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;btn&#34;</span><span class="p">&gt;</span>按我运动<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;box&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 得到元素
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">btn</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;btn&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">box</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;box&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 标识量，指示当前盒子在左边还是右边
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">pos</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// 1左边，2右边
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 函数节流锁
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">lock</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 事件监听
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">btn</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 首先检查锁是否是关闭
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">lock</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 把过渡加上
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">box</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">transition</span> <span class="o">=</span> <span class="s1">&#39;all 2s linear 0s&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">pos</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 瞬间移动，但是由于有过渡，所以是动画
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="nx">box</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="s1">&#39;1100px&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nx">pos</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">pos</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 瞬间移动，但是由于有过渡，所以是动画
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="nx">box</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="s1">&#39;100px&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nx">pos</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 关锁
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">lock</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 指定时间后，将锁打开
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">lock</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span> <span class="mi">2000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<p><img src="/mark-img/cd2d762739b64d9b9aeca7bb69a1874b.gif" alt=""  /></p>
<p>十五、常见动画制作</p>
<p>15.1 动画效果开发1-无缝连续滚动特效</p>
<p><img src="/mark-img/ec75f87bc4aa4922aecb45262157b4b7.gif" alt=""  /></p>
<p>原理:</p>
<p><img src="/mark-img/e97c8629d8a748aba71398b87638d4a3.gif" alt=""  /></p>
<p>代码：</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p>此动画利用定时器反而比 JS + CSS3 更方便。</p>
        </blockquote>
        
    </figure>

<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width="device-width," initial-scale="1.0&#34;</span"><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Document<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">*</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">padding</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">box</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">width</span><span class="p">:</span> <span class="mi">1000</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">height</span><span class="p">:</span> <span class="mi">130</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">border</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">solid</span> <span class="mh">#000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">margin</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span> <span class="kc">auto</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">overflow</span><span class="p">:</span> <span class="kc">hidden</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">box</span> <span class="nt">ul</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">list-style</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="c">/* 设置大一点，这样li才能浮动 */</span>
</span></span><span class="line"><span class="cl">            <span class="k">width</span><span class="p">:</span> <span class="mi">5000</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">position</span><span class="p">:</span> <span class="kc">relative</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">box</span> <span class="nt">ul</span> <span class="nt">li</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">float</span><span class="p">:</span> <span class="kc">left</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">margin-right</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;box&#34;</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;box&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;list&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;images/number/0.png&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;images/number/1.png&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;images/number/2.png&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;images/number/3.png&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;images/number/4.png&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;images/number/5.png&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">box</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;box&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">list</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 复制多一遍所有的li
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">list</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">+=</span> <span class="nx">list</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 全局变量，表示当前list的left值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">left</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 定时器，全局变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">timer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nx">move</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 动画封装成函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">function</span> <span class="nx">move</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 设表先关，防止动画积累
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">timer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nx">timer</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">left</span> <span class="o">-="</span"> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 验收
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span><span class="nx">left</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1260</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">left</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="nx">list</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="nx">left</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span> <span class="mi">20</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 鼠标进入停止定时器
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">box</span><span class="p">.</span><span class="nx">onmouseenter</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">timer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 鼠标离开继续定时器
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">box</span><span class="p">.</span><span class="nx">onmouseleave</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">move</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<p>15.2 动画效果开发2-跑马灯轮播图特效</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p>跑马灯轮播图，又叫：滑动轮播图。此种轮播图需要将图片排成一行，并在最后一张图片后克隆一份第一张图片（当到达最后一张时，实现瞬间轮回效果）。</p>
        </blockquote>
        
    </figure>

<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width="device-width," initial-scale="1.0&#34;</span"><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Document<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">*</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">padding</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">carousel</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">width</span><span class="p">:</span> <span class="mi">650</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">height</span><span class="p">:</span> <span class="mi">360</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">border</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">solid</span> <span class="mh">#000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">margin</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span> <span class="kc">auto</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">position</span><span class="p">:</span> <span class="kc">relative</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">overflow</span><span class="p">:</span> <span class="kc">hidden</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">carousel</span> <span class="nt">ul</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">list-style</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">width</span><span class="p">:</span> <span class="mi">6000</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">position</span><span class="p">:</span> <span class="kc">relative</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">left</span><span class="p">:</span> <span class="mi">0</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">transition</span><span class="p">:</span> <span class="kc">left</span> <span class="mf">.5</span><span class="kt">s</span> <span class="kc">ease</span> <span class="mi">0</span><span class="kt">s</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">carousel</span> <span class="nt">ul</span> <span class="nt">li</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">float</span><span class="p">:</span> <span class="kc">left</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">carousel</span> <span class="p">.</span><span class="nc">leftbtn</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">left</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">top</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">margin-top</span><span class="p">:</span> <span class="mi">-25</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">width</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">height</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">background-color</span><span class="p">:</span> <span class="nb">rgb</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">226</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">border-radius</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">carousel</span> <span class="p">.</span><span class="nc">rightbtn</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">right</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">top</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">margin-top</span><span class="p">:</span> <span class="mi">-25</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">width</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">height</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">background-color</span><span class="p">:</span> <span class="nb">rgb</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">226</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">border-radius</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;carousel&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;list&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;images/beijing/0.jpg&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;images/beijing/1.jpg&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;images/beijing/2.jpg&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;images/beijing/3.jpg&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;images/beijing/4.jpg&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;;&#34;</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;leftbtn&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;leftbtn&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;;&#34;</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;rightbtn&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;rightbtn&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 得到按钮和ul，ul整体进行运动
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">leftbtn</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;leftbtn&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">rightbtn</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;rightbtn&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">list</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 克隆第一张图片
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">cloneli</span> <span class="o">=</span> <span class="nx">list</span><span class="p">.</span><span class="nx">firstElementChild</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span> <span class="c1">// 记得要写true，不然就只会克隆li而不会克隆img
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">list</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">cloneli</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 当前ul显示到第几张了，从0开始数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 节流锁
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">lock</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 右边按钮监听
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">rightbtn</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 判断锁的状态
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">lock</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nx">lock</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 给list加过渡，为什么要加？？css中不是已经加了么？？这是因为最后一张图片会把过渡去掉
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">list</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">transition</span> <span class="o">=</span> <span class="s1">&#39;left .5s ease 0s&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">idx</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">idx</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 设置一个延时器，延时器的功能就是将ul瞬间拉回0的位置，延时器的目的就是让过渡动画结束之后
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">// 取消掉过渡，因为要的是瞬间移动，不是“咕噜”回去
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="nx">list</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">transition</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">list</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span> <span class="mi">500</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="nx">list</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="o">-</span><span class="nx">idx</span> <span class="o">*</span> <span class="mi">650</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 函数节流
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">lock</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span> <span class="mi">500</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 左边按钮监听
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">leftbtn</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">lock</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nx">lock</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 判断是不是第0张，如果是，就要瞬间用假的替换真的
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="p">(</span><span class="nx">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 取消掉过渡，因为要的是瞬间移动，不是“咕噜”过去
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="nx">list</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">transition</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 直接瞬间移动到最后的假图片上
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="nx">list</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span> <span class="o">*</span> <span class="mi">650</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 设置一个延时器，这个延时器的延时时间可以是0毫秒，虽然是0毫秒，但是可以让我们过渡先是瞬间取消，然后再加上
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">// 加过渡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="nx">list</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">transition</span> <span class="o">=</span> <span class="s1">&#39;left .5s ease 0s&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">// idx改为真正的最后一张
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="nx">idx</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">list</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="o">-</span><span class="nx">idx</span> <span class="o">*</span> <span class="mi">650</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">idx</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nx">list</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="o">-</span><span class="nx">idx</span> <span class="o">*</span> <span class="mi">650</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 函数节流
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">lock</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span> <span class="mi">500</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<p><img src="/mark-img/73872995bfae4c37bae88638ca30aea9.gif" alt=""  /></p>
<p>原理：</p>
<p><img src="/mark-img/410afbfa99594640bf979eff8a62dd9b.gif" alt=""  /></p>
<p><img src="/mark-img/7bd01d838eae44a3ac0e07f2e4b2e013.gif" alt=""  /></p>
<p>15.3 动画效果开发3-呼吸灯轮播图特效</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p>呼吸灯轮播图，又叫：淡入淡出轮播图。此种轮播图需要将图片叠到一起。</p>
        </blockquote>
        
    </figure>

<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width="device-width," initial-scale="1.0&#34;</span"><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Document<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">*</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">padding</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">carousel</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">width</span><span class="p">:</span> <span class="mi">650</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">height</span><span class="p">:</span> <span class="mi">360</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">border</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">solid</span> <span class="mh">#000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">margin</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span> <span class="kc">auto</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">position</span><span class="p">:</span> <span class="kc">relative</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">carousel</span> <span class="nt">ul</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">list-style</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">carousel</span> <span class="nt">ul</span> <span class="nt">li</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">top</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">left</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="c">/* 透明度都是0 */</span>
</span></span><span class="line"><span class="cl">            <span class="k">opacity</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">transition</span><span class="p">:</span> <span class="k">opacity</span> <span class="mi">1</span><span class="kt">s</span> <span class="kc">ease</span> <span class="mi">0</span><span class="kt">s</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">/* 只有第一张透明度是1 */</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">carousel</span> <span class="nt">ul</span> <span class="nt">li</span><span class="p">:</span><span class="nd">first-child</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">opacity</span><span class="p">:</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">carousel</span> <span class="p">.</span><span class="nc">leftbtn</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">left</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">top</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">margin-top</span><span class="p">:</span> <span class="mi">-25</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">width</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">height</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">background-color</span><span class="p">:</span> <span class="nb">rgb</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">226</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">border-radius</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">carousel</span> <span class="p">.</span><span class="nc">rightbtn</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">right</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">top</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">margin-top</span><span class="p">:</span> <span class="mi">-25</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">width</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">height</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">background-color</span><span class="p">:</span> <span class="nb">rgb</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">226</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">border-radius</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;carousel&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;list&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;images/beijing/0.jpg&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;images/beijing/1.jpg&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;images/beijing/2.jpg&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;images/beijing/3.jpg&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;images/beijing/4.jpg&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;;&#34;</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;leftbtn&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;leftbtn&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;;&#34;</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;rightbtn&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;rightbtn&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 得到按钮和ul，ul整体进行运动
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">leftbtn</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;leftbtn&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">rightbtn</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;rightbtn&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">list</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">lis</span> <span class="o">=</span> <span class="nx">list</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 当前是第几张图显示
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 节流
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">lock</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 右按钮
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">rightbtn</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 判断节流
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">lock</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nx">lock</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 还没有改idx，此时的idx这个图片就是老图，老图淡出
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">lis</span><span class="p">[</span><span class="nx">idx</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">idx</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">idx</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="nx">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 改了idx，此时的idx这个图片就是新图，新图淡入
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">lis</span><span class="p">[</span><span class="nx">idx</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 动画结束之后，开锁
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">lock</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 左按钮
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">leftbtn</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 判断节流
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">lock</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nx">lock</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 还没有改idx，此时的idx这个图片就是老图，老图淡出
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">lis</span><span class="p">[</span><span class="nx">idx</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">idx</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">idx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">idx</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 改了idx，此时的idx这个图片就是新图，新图淡入
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">lis</span><span class="p">[</span><span class="nx">idx</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 动画结束之后，开锁
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">lock</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<p><img src="/mark-img/6ce3942a0d204578b8025195c37f48aa.gif" alt=""  /></p>
<h2 id="声明">声明</h2>
<h3 id="作用域">作用域</h3>
<h4 id="函数作用域">函数作用域</h4>
<p>ES5 中规定，JS 是 <strong>函数级作用域</strong> 编程语言，变量只在其所定义时所在的 function 内部有意义。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> JS 中 if、switch、for、while……等 <code>()</code> 及 <code>{}</code> 中的变量都不属于 <strong>局部变量</strong> ，而是 <strong>外层函数局部变量</strong>，如果没有外层函数，那么就是全局变量。</p>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em> 1</kbd> <code>{}</code> 大括号</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span><span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 3
</span></span></span><span class="line"><span class="cl"><span class="c1">// ES5中不存在真正的块级作用域，内部数据直接泄漏
</span></span></span></code></pre></div>
</div>
<p><kbd>:page_with_curl: <em>Example</em> 2</kbd> <code>for</code> 循环泄漏</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nx">a</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">       <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]();</span> <span class="c1">//预期结果是0，实际结果是10
</span></span></span></code></pre></div>
</div>
<p>出现上述现象的主要原因是使用 <code>var</code> 定义的变量 <code>i</code> 是一个 <strong>全局变量</strong> ，导致真正在调用的时候虽然循环了 10 次，可是最终十次都是只修改了全局变量 <code>i</code> ，并没有区分出私有作用域。</p>
        </blockquote>
        
    </figure>

<p>若想要在 ES5 的框架下解决作用域的问题，则可以引入 <strong>闭包</strong><sup>Closure</sup> ，通过 <strong>函数作用域</strong> 创造伪 <strong>块级作用域</strong> ：</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em> 1</kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="nx">a</span><span class="p">.</span><span class="nx">push</span><span class="p">((</span><span class="kd">function</span><span class="p">(</span><span class="nx">$i</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="kd">function</span> <span class="nx">k</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 创建函数闭包
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// $i是该匿名函数的入参，等同下面的i
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 每运行一次$i就保存于闭包函数作用域中一次
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 因此闭包也容易产生内存泄漏
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">$i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span>  <span class="nx">k</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 函数A内部声明了函数B
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 函数B引用了函数B之外的变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 函数A的返回值为函数B的引用
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 那么函数B就是闭包函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">})(</span><span class="nx">i</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]();</span> <span class="c1">//结果为0
</span></span></span></code></pre></div>
</div>
<p><kbd>:warning: <em>Caution</em></kbd> 如果ES5 <code>var</code> 闭包不通过 <strong>参数传递</strong> 的方式创建 <strong>私有作用域</strong>，那也可以通过 <strong>内部定义变量</strong> 的方式来代替。</p>
<p>若是 <strong>直接引用外部变量</strong> 创建，则只是复制了指向外部变量的 <strong>指针</strong> ，而不能起到隔离变量的作用。</p>
<p><kbd>:page_with_curl: <em>Example</em> 2</kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">a</span><span class="p">.</span><span class="nx">push</span><span class="p">((</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">function</span> <span class="nx">k</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 闭包中若不是通过传参赋值（复制&amp;保存）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 而是直接引用外部变量，则变量并不会在闭包中保存
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span> <span class="c1">// 0 1 2 3 4 5 6 7 8 9
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="nx">k</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">})());</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]();</span> <span class="c1">// 10
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<p>ES5 中的块级作用域有效的只有 <code>try...catch</code>，所以有时候有些框架为了区分 <strong>块级私有作用域</strong> 就是用它来解决的，例如 Google 的 Traceur 项目。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">try</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">throw</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span> <span class="c1">// 3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span> <span class="c1">// ReferenceError: e is not defined
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<p>ES5 虽然不存在真正意义上的块级作用域，但是存在 <strong>函数作用域</strong> 。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em> 1</kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">fun</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">fun</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 1
</span></span></span></code></pre></div>
</div>
<p><kbd>:memo: <em>Note</em></kbd> 以上生成函数作用域的写法存在两个问题。</p>
<ol>
<li>申明了全局的 <strong>具名函数</strong> <code>fun()</code> ，污染了全局作用域</li>
<li>如果要实现这个私有作用域，必须要函数调用才行</li>
</ol>
<p>为了解决这个问题，引入了 <strong>立即执行函数</strong><sup>IIFE</sup> 。它可以 <strong>无伤</strong> 地创建一个 <strong>块级私有作用域</strong> 替代 ES5 的 <strong>伪块级作用域</strong> ，还有虽然它般用和闭包结合使用，但注意和闭包的区分。</p>
<p><kbd>:page_with_curl: <em>Example</em> 2</kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span> <span class="p">(){</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">})();</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 1
</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<p>立即执行函数表达式另一个常用技巧：</p>
<p>倒置立即执行函数代码的运行顺序，将需要运行的函数放在第二位 <code>()(fun(){//})</code>，在立即执行函数执行之后当作参数传递进去。这种模式在 <strong>UMD</strong><sup><strong>U</strong>niversal <strong>M</strong>odule <strong>D</strong>efinition</sup> 项目中被广泛使用。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span> <span class="nx">IIFE</span><span class="p">(</span><span class="nx">def</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">def</span><span class="p">(</span><span class="nb">window</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">})(</span><span class="kd">function</span> <span class="nx">def</span><span class="p">(</span><span class="nx">global</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">global</span><span class="p">.</span><span class="nx">a</span><span class="p">);</span> <span class="c1">//2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">});</span></span></span></code></pre></div>
</div>
<p><kbd>:memo: <em>Note</em></kbd> 例子中将代码 <strong>主体</strong> 放在了 立即执行函数<sup>IIFE</sup> 的 <strong>参数</strong> 部分，当做参数传递给执行函数，执行函数的内部又立即调用了这个函数，并将全局的 <code>window</code> 对象当做 <strong>实参</strong> 传递给 <strong>参数主体函数</strong>，并将 <strong>参数内函数</strong> 的 <strong>形参</strong> 定义为 <code>global</code> 来调动全局 <code>a</code> 变量，达到不会与参数主体函数的作用域冲突的效果。</p>
        </blockquote>
        
    </figure>

<h4 id="块作用域">块作用域</h4>
<p>ES5 中作用域有：全局作用域、函数作用域，没有块作用域的概念。</p>
<p>ES6 <code>let</code> 新增了块级作用域。
<strong>块作用域</strong> 由 <code>{}</code> 包括，if 语句和 for 语句里面的 <code>{}</code> 也属于块作用域。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 外层代码块
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kd">let</span> <span class="nx">n</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 内层代码块
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">let</span> <span class="nx">n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span> <span class="c1">// 5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></div>
</div>
<p>ES6 允许块级作用域的任意嵌套,内层作用域可以定义外层作用域的同名变量。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nx">insane</span> <span class="o">=</span> <span class="s1">&#39;Hello World&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">insane</span><span class="p">);</span> <span class="c1">// 报错;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></div>
</div>
<p>块级作用域的出现，实际上使得获得广泛应用的匿名立即执行函数表达式（匿名 IIFE）不再必要了。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// 匿名IIFE写法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="p">...;</span>
</span></span><span class="line"><span class="cl">  <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 块级作用域写法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="p">...;</span>
</span></span><span class="line"><span class="cl">  <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>函数能不能在块级作用域之中声明？这是一个相当令人混淆的问题。</p>
<p>ES5 规定，函数只能在顶层作用域和函数作用域之中声明，不能在块级作用域声明。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// 情况一
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">function</span> <span class="nx">f</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 情况二
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">function</span> <span class="nx">f</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></div>
</div>
<p>上面两种函数声明，根据 ES5 的规定都是非法的。</p>
<p>但是，浏览器没有遵守这个规定，为了兼容以前的旧代码，还是支持在块级作用域之中声明函数，因此上面两种情况实际都能运行，不会报错。</p>
<p>ES6 引入了块级作用域，明确允许在块级作用域之中声明函数。ES6 规定，块级作用域之中，函数声明语句的行为类似于 <code>let</code>，在块级作用域之外不可引用。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">f</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;I am outside!&#39;</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 重复声明一次函数f
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">function</span> <span class="nx">f</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;I am inside!&#39;</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="nx">f</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}());</span></span></span></code></pre></div>
</div>
<p>上面代码在 ES5 中运行，会得到“I am inside!”，因为在 <code>if</code> 内声明的函数<code>f</code>会被提升到 <strong>函数头部</strong> ，实际运行的代码如下。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// ES5 环境
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">f</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;I am outside!&#39;</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 发生了函数提升
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kd">function</span> <span class="nx">f</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;I am inside!&#39;</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 空
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="nx">f</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}());</span></span></span></code></pre></div>
</div>
<p>ES6 就完全不一样了，理论上会得到“I am outside!”。因为块级作用域内声明的函数类似于 <code>let</code>，对作用域之外没有影响。但是，如果你真的在 ES6 浏览器中运行一下上面的代码，是会报错的，这是为什么呢？</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// 浏览器的 ES6 环境
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">f</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;I am outside!&#39;</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 在内部块作用域中重复声明一次函数f
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">function</span> <span class="nx">f</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;I am inside!&#39;</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">f</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}());</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Uncaught TypeError: f is not a function
</span></span></span></code></pre></div>
</div>
<p>上面的代码在 ES6 浏览器中，都会报错。</p>
<p>原来，如果改变了块级作用域内声明的函数的处理规则，显然会对老代码产生很大影响。为了减轻因此产生的不兼容问题，ES6 规定，浏览器的实现可以不遵守上面的规定，有自己的行为方式。</p>
<ul>
<li>允许在块级作用域内声明函数。</li>
<li>函数声明类似于 <code>var</code>，即会提升到全局作用域或函数作用域的头部。</li>
<li>同时，函数声明还会提升到所在的块级作用域的头部。</li>
</ul>
<p>注意，上面三条规则只对 ES6 的浏览器实现有效，其他环境的实现不用遵守，还是将块级作用域的函数声明当作 <code>let</code> 处理。</p>
<p>根据这三条规则，浏览器的 ES6 环境中，块级作用域内声明的函数，行为类似于 <code>var</code> 声明的变量。上面的例子实际运行的代码如下。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// 浏览器的 ES6 环境
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">f</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;I am outside!&#39;</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">function</span> <span class="nx">f</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;I am inside!&#39;</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">f</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}());</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Uncaught TypeError: f is not a function
</span></span></span></code></pre></div>
</div>
<p>考虑到环境导致的行为差异太大，应该 <strong>避免</strong> 在块级作用域内声明函数。如果确实需要，也应该写成 <strong>函数表达式</strong> ，而不是函数声明语句。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">fun</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{};</span> <span class="c1">// Anonymous function
</span></span></span><span class="line"><span class="cl"><span class="c1">// 完全遵从let变量的行为，否则在某些浏览器中会被解析为var
</span></span></span></code></pre></div>
</div>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// 块级作用域内部的函数声明语句，建议不要使用
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span> <span class="s1">&#39;secret&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kd">function</span> <span class="nx">f</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 块级作用域内部，优先使用函数表达式
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span> <span class="s1">&#39;secret&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>另外，还有一个需要注意的地方。ES6 的块级作用域必须有 <strong>大括号</strong> ，如果没有大括号，JavaScript 引擎就认为不存在块级作用域。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="cm">/* 第一种写法，报错 */</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="kd">let</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// SyntaxError: Lexical declaration cannot appear in a single-statement context
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* 第二种写法，不报错 */</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 单独的块级作用域
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kd">let</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>上面代码中，第一种写法没有大括号，所以不存在块级作用域，而 <code>let</code> 只能出现在当前作用域的 <strong>顶层</strong> ，所以报错。第二种写法有大括号，所以块级作用域成立。</p>
<p>函数声明也是如此，严格模式下，函数只能声明在当前作用域的顶层。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="cm">/* 1. 使用大括号包裹为块作用域  */</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="c1">// 不报错
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">function</span> <span class="nx">f</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 2. 未创建块作用域，报错 */</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="kd">function</span> <span class="nx">f</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// SyntaxError: In strict mode code, functions can only be declared at top level or inside a block.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 3. 解决方案：将匿名函数传导给let变量 */</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 4. 不创建块作用域，仍然报错 */</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// SyntaxError: Lexical declaration cannot appear in a single-statement context
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span></span></span></code></pre></div>
</div>
<h4 id="x-静态常数">:x: 静态常数</h4>
<p>const 命令</p>
<h3 id="基本用法">基本用法</h3>
<p><code>const</code>声明一个只读的常量。一旦声明，常量的值就不能改变。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">PI</span> <span class="o">=</span> <span class="mf">3.1415</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">PI</span> <span class="c1">// 3.1415
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">PI</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// TypeError: Assignment to constant variable.
</span></span></span></code></pre></div>
</div>
<p>上面代码表明改变常量的值会报错。</p>
<p><code>const</code>声明的变量不得改变值，这意味着，<code>const</code>一旦声明变量，就必须立即初始化，不能留到以后赋值。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">foo</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// SyntaxError: Missing initializer in const declaration
</span></span></span></code></pre></div>
</div>
<p>上面代码表示，对于<code>const</code>来说，只声明不赋值，就会报错。</p>
<p><code>const</code>的作用域与<code>let</code>命令相同：只在声明所在的块级作用域内有效。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">MAX</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">MAX</span> <span class="c1">// Uncaught ReferenceError: MAX is not defined
</span></span></span></code></pre></div>
</div>
<p><code>const</code>命令声明的常量也是不提升，同样存在暂时性死区，只能在声明的位置后面使用。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">MAX</span><span class="p">);</span> <span class="c1">// ReferenceError
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">const</span> <span class="nx">MAX</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>上面代码在常量<code>MAX</code>声明之前就调用，结果报错。</p>
<p><code>const</code>声明的常量，也与<code>let</code>一样不可重复声明。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">message</span> <span class="o">=</span> <span class="s2">&#34;Hello!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">age</span> <span class="o">=</span> <span class="mi">25</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 以下两行都会报错
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">message</span> <span class="o">=</span> <span class="s2">&#34;Goodbye!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">age</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span></span></span></code></pre></div>
</div>
<h3 id="本质">本质</h3>
<p><code>const</code>实际上保证的，并不是变量的值不得改动，而是变量指向的那个内存地址所保存的数据不得改动。对于简单类型的数据（数值、字符串、布尔值），值就保存在变量指向的那个内存地址，因此等同于常量。但对于复合类型的数据（主要是对象和数组），变量指向的内存地址，保存的只是一个指向实际数据的指针，<code>const</code>只能保证这个指针是固定的（即总是指向另一个固定的地址），至于它指向的数据结构是不是可变的，就完全不能控制了。因此，将一个对象声明为常量必须非常小心。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">foo</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 为 foo 添加一个属性，可以成功
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">foo</span><span class="p">.</span><span class="nx">prop</span> <span class="o">=</span> <span class="mi">123</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">foo</span><span class="p">.</span><span class="nx">prop</span> <span class="c1">// 123
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// 将 foo 指向另一个对象，就会报错
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">foo</span> <span class="o">=</span> <span class="p">{};</span> <span class="c1">// TypeError: &#34;foo&#34; is read-only
</span></span></span></code></pre></div>
</div>
<p>上面代码中，常量<code>foo</code>储存的是一个地址，这个地址指向一个对象。不可变的只是这个地址，即不能把<code>foo</code>指向另一个地址，但对象本身是可变的，所以依然可以为其添加新属性。</p>
<p>下面是另一个例子。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl"><span class="nx">a</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">);</span> <span class="c1">// 可执行
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    <span class="c1">// 可执行
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">a</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Dave&#39;</span><span class="p">];</span>    <span class="c1">// 报错
</span></span></span></code></pre></div>
</div>
<p>上面代码中，常量<code>a</code>是一个数组，这个数组本身是可写的，但是如果将另一个数组赋值给<code>a</code>，就会报错。</p>
<p>如果真的想将对象冻结，应该使用<code>Object.freeze</code>方法。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">foo</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">freeze</span><span class="p">({});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 常规模式时，下面一行不起作用；
</span></span></span><span class="line"><span class="cl"><span class="c1">// 严格模式时，该行会报错
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">foo</span><span class="p">.</span><span class="nx">prop</span> <span class="o">=</span> <span class="mi">123</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p>上面代码中，常量<code>foo</code>指向一个冻结的对象，所以添加新属性不起作用，严格模式时还会报错。</p>
<p>除了将对象本身冻结，对象的属性也应该冻结。下面是一个将对象彻底冻结的函数。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">constantize</span> <span class="o">=</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Object</span><span class="p">.</span><span class="nx">freeze</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span> <span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="k">typeof</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">constantize</span><span class="p">(</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
</div>
<h3 id="先使用后声明">先使用后声明</h3>
<h4 id="变量-2">变量</h4>
<p>非 <strong>严格模式</strong> 下，可以提前使用一个稍后才声明的变量，而不会引发异常：在执行所有代码前，JS 有 <strong>预解析</strong> 阶段，会预读所有变量的定义。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="cm">/* :memo: NOTE: 变量声明提升的只是定义而非值 */</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* 先使用变量 */</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>	<span class="c1">// undefined
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* 后定义变量 */</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>	<span class="c1">// 10
</span></span></span></code></pre></div>
</div>
<p>实际的情况相当于：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="cm">/* 预解析阶段把所有变量提前 */</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// undefined
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 10
</span></span></span></code></pre></div>
</div>
<p>使用 <code>let</code> 后报错：必须先声明后使用。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">-&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>	<span class="c1">// 报错
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;</span> <span class="nx">ReferenceError</span><span class="o">:</span> <span class="nx">Cannot</span> <span class="nx">access</span> <span class="s1">&#39;a&#39;</span> <span class="nx">before</span> 
</span></span><span class="line"><span class="cl"><span class="nx">initialization</span> <span class="c1">//Node.js
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="o">&gt;&gt;</span> <span class="nx">Uncaught</span> <span class="nx">ReferenceError</span><span class="o">:</span> <span class="nx">a</span> <span class="nx">is</span> <span class="nx">not</span> <span class="nx">defined</span> <span class="c1">//Chrome
</span></span></span></code></pre></div>
</div>
<h4 id="函数-1">函数</h4>
<h5 id="声明-1">声明</h5>
<p>和 <strong>变量声明</strong> 提升类似，<strong>函数声明</strong> 也可以被提升。所有过程在预解析阶段进行。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">fun</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 在预解析阶段会被提升
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">fun</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;函数被执行&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>效果相当于：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">fun</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;函数被执行&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">fun</span><span class="p">();</span></span></span></code></pre></div>
</div>
<p><strong>函数表达式</strong> 不能被提升。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">fun</span><span class="p">();</span>	<span class="c1">// 报错！
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">fun</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;函数不能被执行&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 函数表达式不能被提升的本质原因是函数表达式定义的其实是个 <strong>变量</strong> ，只不过是把函数赋给这个变量，而变量的提升只提升 <strong>定义</strong> ，不提升 <strong>赋值</strong> 。</p>
        </blockquote>
        
    </figure>

<h5 id="优先级-1">优先级</h5>
<p>函数的提升优先级大于变量。因此若在定义前面使用同名的函数，将会运行函数而不是赋值给变量的匿名函数。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">fun</span><span class="p">();</span> <span class="c1">// B
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">fun</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">fun</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">fun</span><span class="p">();</span> <span class="c1">// A
</span></span></span></code></pre></div>
</div>
<p>效果相当于：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">fun</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">fun</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">fun</span><span class="p">();</span> <span class="c1">// B
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">fun</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">fun</span><span class="p">();</span> <span class="c1">// A
</span></span></span></code></pre></div>
</div>
<h2 id="dom">DOM</h2>
<p><strong>DOM</strong> - <strong>D</strong>ocument <strong>O</strong>bject <strong>M</strong>odel 文档对象模型，是 W3C 组织推荐的处理可扩展标记语言的 <strong>标准编程接口</strong> 。通过 DOM 提供的接口可以对页面上的各种元素进行操作。</p>
<ul>
<li><kbd>&lt;ele name="&quot;name&quot;&gt;&lt;/ele&gt;</kbd"></li>
<li><strong>Obsolete attribute</strong>. Use the <strong>id</strong> attribute instead.</li>
</ul>
<p><kbd>window.document</kbd> 表示浏览器窗口中的 HTML 页面。</p>
<ul>
<li><code>document.write()</code> 将内容写入页面</li>
<li>页面中的元素就是 <kbd>document</kbd> 里的成员</li>
</ul>
<p>整个 HTML 文档就对应一个 <kbd>document</kbd> 对象，可以操作 HTML 文档里所有的标记和文本。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nx">x</span> <span class="k">in</span> <span class="nb">document</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* the same as window.document */</span>
</span></span><span class="line"><span class="cl">  <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">x</span> <span class="o">+</span> <span class="s2">&#34;&lt;br/&gt;&#34;</span><span class="p">);</span></span></span></code></pre></div>
</div>
<h3 id="节点树">节点树</h3>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Sample Page<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      Hello World!
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<p><kbd><strong>Document</strong></kbd></p>
<ul>
<li><kbd>Element</kbd>: &ldquo;html&rdquo;
<ul>
<li><kbd>Element</kbd>: &ldquo;head&rdquo;
<ul>
<li><kbd>Element</kbd>: &ldquo;title&rdquo;
<ul>
<li><kbd>Text</kbd>: &ldquo;Sample Page&rdquo;</li>
</ul>
</li>
</ul>
</li>
<li><kbd>Element</kbd>: &ldquo;body&rdquo;
<ul>
<li><kbd>Element</kbd>: &ldquo;p&rdquo;
<ul>
<li><kbd>Text</kbd>: &ldquo;Hello World!&rdquo;</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="ui-codeblock">
    
    <pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">graph LR
d[&#34;document&#34;]----&gt;D[&#34;!DOCTYPE&#34;]
d----&gt;h[&#34;&amp;lt;html&amp;gt;&#34;]

h----&gt;he[&#34;&amp;lt;head&amp;gt;&#34;]
he----&gt;t[&#34;&amp;lt;title&amp;gt;&#34;]
t----&gt;T1((Text))
he----&gt;m[&#34;&amp;lt;meta&amp;gt;&#34;]
m----&gt;c(charset)

h----&gt;b[&#34;&amp;lt;body&amp;gt;&#34;]
b----&gt;H0[&#34;&amp;lt;h1&amp;gt;&#34;]
H0----&gt;T2((Text))
b----&gt;div0[&#34;&amp;lt;div&amp;gt;&#34;]
div0----&gt;H1[&#34;&amp;lt;h2&amp;gt;&#34;]
H1----&gt;T3((Text))
div0----&gt;img[&#34;&amp;lt;img&amp;gt;&#34;]
img--&gt;src(src)
div0--&gt;div1[&#34;&amp;lt;div&amp;gt;&#34;]
div1----&gt;T4((Text))
div1----&gt;cls(&#34;class&#34;)</code></pre>
</div>
<h4 id="nodetype">NodeType</h4>
<p>节点的 nodeType 属性可以显示这个节点具体的类型。</p>
<p><code>document.nodeType;	  // 9</code></p>
<table>
  <thead>
      <tr>
          <th>值</th>
          <th>NodeType</th>
          <th>e..g.:</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>Node.ELEMENT_NODE</td>
          <td>Element</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Node.ATTRIBUTE_NODE</td>
          <td>Attribute</td>
      </tr>
      <tr>
          <td>3</td>
          <td>Node.TEXT_NODE</td>
          <td>Text inside an Element or Attr</td>
      </tr>
      <tr>
          <td>4</td>
          <td>Node.CDATA_SECTION_NODE(4)</td>
          <td><code>&lt;!CDATA[[ … ]]&gt;</code></td>
      </tr>
      <tr>
          <td>5</td>
          <td><del>Node.ENTITY_REFERENCE_NODE</del></td>
          <td></td>
      </tr>
      <tr>
          <td>6</td>
          <td><del>Node.ENTITY_NODE</del></td>
          <td></td>
      </tr>
      <tr>
          <td>7</td>
          <td>Node.PROCESSING_INSTRUCTION_NODE</td>
          <td><code>&lt;?xml-stylesheet … ?&gt;</code></td>
      </tr>
      <tr>
          <td>8</td>
          <td>Node.COMMENT_NODE</td>
          <td><code>&lt;!-- … --&gt;</code></td>
      </tr>
      <tr>
          <td>9</td>
          <td>Node.DOCUMENT_NODE</td>
          <td>Document</td>
      </tr>
      <tr>
          <td>10</td>
          <td>Node.DOCUMENT_TYPE_NODE</td>
          <td><code>&lt;!DOCTYPE html&gt;</code></td>
      </tr>
      <tr>
          <td>11</td>
          <td>Node.DOCUMENT_FRAGMENT_NODE</td>
          <td>DocumentFragment</td>
      </tr>
      <tr>
          <td>12</td>
          <td><del>Node.NOTATION_NODE</del></td>
          <td></td>
      </tr>
  </tbody>
</table>
<h3 id="document">Document</h3>
<p>访问元素节点主要依靠 document 对象。</p>
<p>document 对象是 DOM 中最重要的东西，几乎所有 DOM 的功能都封装在了 document 对象中。</p>
<p>document 对象也表示整个 HTML 文档，它是 DOM 节点树的根。</p>
<p>document 对象的 nodeType 属性值是 9。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">typeof</span> <span class="nb">document</span><span class="p">;</span>	<span class="c1">// object
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nb">document</span><span class="p">.</span><span class="nx">nodeType</span><span class="p">;</span>	<span class="c1">// 9
</span></span></span></code></pre></div>
</div>
<h4 id="访问节点">访问节点</h4>
<p>注意：以下方法的参数都是字符串值 <code>''</code>。</p>
<table>
  <thead>
      <tr>
          <th>方法</th>
          <th>功能</th>
          <th>兼容性</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>document.getElementById()</code></td>
          <td>通过 id 得到<strong>元素</strong></td>
          <td>IE 6</td>
      </tr>
      <tr>
          <td><code>document.getElementsByTagName()</code></td>
          <td>通过标签名得到<strong>元素数组</strong></td>
          <td>IE 6</td>
      </tr>
      <tr>
          <td><code>document.getElementsByClassName()</code></td>
          <td>通过类名得到<strong>元素数组</strong></td>
          <td>IE 9</td>
      </tr>
      <tr>
          <td><code>document.querySelector()</code></td>
          <td>通过选择器得到<sup>第一个</sup><strong>元素</strong></td>
          <td>IE 8 部分兼容、IE 9 完全兼容</td>
      </tr>
      <tr>
          <td><code>document.querySelectorAll()</code></td>
          <td>通过选择器得到<strong>元素数组</strong></td>
          <td>IE 8 部分兼容、IE 9 完全兼容</td>
      </tr>
  </tbody>
</table>
<p>返回数组的方法中，即使返回元素只有一个，也将得到只有一个元素的数组。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<ol>
<li>
<p><code>querySelector()</code> 方法只能得到页面上一个元素，如果有多个元素符合条件，则只能得到 <strong>第一个</strong> 元素</p>
</li>
<li>
<p><code>querySelector()</code> 方法从 IE8 开始兼容，但从 IE9 开始支持 CSS3 的选择器，如：<code>nth-child()</code>、<code>:[src^='dog']</code> 等 CSS3 选择器形式都支持良好</p>
</li>
<li>
<p>不能选择 <strong>伪类</strong></p>
</li>
</ol>
        </blockquote>
        
    </figure>

<h4 id="延迟运行-1">延迟运行</h4>
<p>在测试 DOM 代码时，通常 JS 代码要写到 HTML 节点的后面，否则 JS 无法找到相应的 HTML 节点。</p>
<p>当然，可以使用 <code>window.onload = function(){}</code> 事件，使页面 <strong>加载完毕</strong> 后，再执行指定的代码。</p>
<p>一般 script 标签会被放在头部或尾部。头部就是 <code>&lt;head&gt;&lt;/head&gt;</code> 里面，尾部一般指 <code>&lt;body&gt;&lt;/body&gt;</code> 里，但也有放在 <code>&lt;/body&gt;</code> 闭合标签之后的（最好不要这样）。</p>
<h4 id="节点关系">节点关系</h4>
<div class="ui-codeblock">
    
    <pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">graph LR
f[&#34;父节点&#34;]--firstChild--&gt;c1[&#34;子节点&#34;]
c2[&#34;子节点&#34;]--parentNode--&gt;f
f--lastChild--&gt;c3[&#34;子节点&#34;]

c1--nextSibling--&gt;c2
c2--nextSibling--&gt;c3
c3--previousSibling--&gt;c2
c2--previousSibling--&gt;c1</code></pre>
</div>
<table>
  <thead>
      <tr>
          <th>关系</th>
          <th>考虑所有结点</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>子节点</td>
          <td><code>childNodes</code></td>
      </tr>
      <tr>
          <td>父节点</td>
          <td><code>parentNode</code></td>
      </tr>
      <tr>
          <td>第一个子节点</td>
          <td><code>firstChild</code></td>
      </tr>
      <tr>
          <td>最后一个子节点</td>
          <td><code>lastChild</code></td>
      </tr>
      <tr>
          <td>前一个兄弟节点</td>
          <td><code>previousSibling</code></td>
      </tr>
      <tr>
          <td>后一个兄弟节点</td>
          <td><code>nextSibling</code></td>
      </tr>
  </tbody>
</table>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 文本节点也属于节点</p>
<p>在标准的 W3C 规范中，空白文本节点也应该算作节点，但是在 IE8 及以前的浏览器中会有一定的兼容问题，它们不把空白文本节点当作节点。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p>从 IE9 开始支持一些 <strong>只考虑元素节点</strong> 的属性。</p>
<p>如果考虑兼容性，可以通过后面的函数封装来实现。</p>
        </blockquote>
        
    </figure>

<table>
  <thead>
      <tr>
          <th>关系</th>
          <th>考虑所有结点</th>
          <th>只考虑元素节点</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>子节点</td>
          <td><code>childNodes</code></td>
          <td><code>children</code></td>
      </tr>
      <tr>
          <td>父节点</td>
          <td><code>parentNode</code></td>
          <td>同</td>
      </tr>
      <tr>
          <td>第一个子节点</td>
          <td><code>firstChild</code></td>
          <td><code>firstElementChild</code></td>
      </tr>
      <tr>
          <td>最后一个子节点</td>
          <td><code>lastChild</code></td>
          <td><code>lastElementChild</code></td>
      </tr>
      <tr>
          <td>前一个兄弟节点</td>
          <td><code>previousSibling</code></td>
          <td><code>previousElementSibling</code></td>
      </tr>
      <tr>
          <td>后一个兄弟节点</td>
          <td><code>nextSibling</code></td>
          <td><code>nextElementSibling</code></td>
      </tr>
  </tbody>
</table>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<p>封装一个函数，这个函数可以返回元素的所有子元素节点（兼容到 IE6），类似 children 的功能：</p>
<ol>
<li>
<h5 id="getchildren---children"><code>getChildren()</code> - children</h5>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">function getChildren(node) {
</span></span><span class="line"><span class="cl">  // 结果数组
</span></span><span class="line"><span class="cl">  var children = [];
</span></span><span class="line"><span class="cl">  // 遍历 node 这个节点的所有子节点，判断每一个子节点的 nodeType 属性是不是 1
</span></span><span class="line"><span class="cl">  // 如果是 1，就推入结果数组
</span></span><span class="line"><span class="cl">  for (var i = 0; i <span class="p">&lt;</span> <span class="nt">node.childNodes.length</span><span class="err">;</span> <span class="na">i</span><span class="err">++)</span> <span class="err">{</span>
</span></span><span class="line"><span class="cl">    <span class="err">//.</span><span class="na">childNodes为DOM封装方法</span>
</span></span><span class="line"><span class="cl">    <span class="na">if</span> <span class="err">(</span><span class="na">node</span><span class="err">.</span><span class="na">childNodes</span><span class="err">[</span><span class="na">i</span><span class="err">].</span><span class="na">nodeType </span><span class="o">=</span><span class="s">==</span> <span class="na">1</span><span class="err">)</span> <span class="err">{</span>
</span></span><span class="line"><span class="cl">      <span class="na">children</span><span class="err">.</span><span class="na">push</span><span class="err">(</span><span class="na">node</span><span class="err">.</span><span class="na">childNodes</span><span class="err">[</span><span class="na">i</span><span class="err">]);</span>
</span></span><span class="line"><span class="cl">    <span class="err">}</span>
</span></span><span class="line"><span class="cl">  <span class="err">}</span>
</span></span><span class="line"><span class="cl">  <span class="na">return</span> <span class="na">children</span><span class="err">;</span>
</span></span><span class="line"><span class="cl"><span class="err">}</span></span></span></code></pre></div>
</div>
<ol start="2">
<li>
<h5 id="getelementprevsibling---previouselementsibling"><code>getElementPrevSibling()</code> - previousElementSibling</h5>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">getElementPrevSibling</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 使用 while 语句
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">while</span> <span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">previousSibling</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">previousSibling</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 结束循环，找到了
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="k">return</span> <span class="nx">o</span><span class="p">.</span><span class="nx">previousSibling</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 让 o 成为它的前一个节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">o</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">previousSibling</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<ol start="3">
<li><code>getAllElementSibling()</code></li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">getAllElementSibling</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 前面的元素兄弟节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kd">var</span> <span class="nx">prevArr</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 后面的元素兄弟节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kd">var</span> <span class="nx">nextArr</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 遍历 node 的前面的节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">while</span> <span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">previousSibling</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">previousSibling</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">prevArr</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">previousSibling</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">o</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">previousSibling</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">o</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// 遍历 node 的后面的节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">while</span> <span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">nextSibling</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">nextArr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">o</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// 将两个数组进行合并，然后返回
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">return</span> <span class="nx">prevArr</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">nextArr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h4 id="nodelist"><em>NodeList</em><sup id="nodelist-es5"> </sup></h4>
<h3 id="节点">节点</h3>
<h4 id="内容">内容</h4>
<p>改变元素节点中的内容可以使用两个相关属性。</p>
<ol>
<li>
<p><code>innerHTML</code> 属性能以 HTML 语法设置节点中的内容。</p>
</li>
<li>
<p><code>innerText</code> 属性只能以纯文本的形式设置节点中的内容。</p>
</li>
</ol>
<h4 id="样式">样式</h4>
<p>改变元素节点的 CSS 样式需要使用这样的语句：</p>
<ol>
<li><code>oBox.style.backgroundColor = 'red';</code></li>
<li><code>oBox.style.backgroundImage = 'url(images/1.jpg)';</code></li>
<li><code>oBox.style.fontSize = '32px';</code></li>
</ol>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<ol>
<li>属性名为小驼峰拼法</li>
<li>属性值要设置成完整形式，包括单位</li>
<li>修改的样式属于行内式，优先级最高</li>
</ol>
        </blockquote>
        
    </figure>

<h4 id="attr">Attr</h4>
<p>标准 W3C 属性，如 <code>src</code>、<code>href</code>、<code>title</code>、<code>alt</code> 等等，只需要直接打点进行更改即可。</p>
<p><code>oImg.src = 'images/2.jpg';</code></p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 对于不符合 W3C 标准的属性，要使用 <code>setAttribute()</code> 和 <code>getAttribute()</code> 来设置、读取。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">oBox</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;data-n&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">oBox</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;data-n&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">alert</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h4 id="创建-2">创建</h4>
<p><code>document.createElement()</code> 方法用于创建一个指定 tag name 的 HTML 元素。</p>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">孤儿节点</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span></span></span></code></pre></div></div>
</div>
<p>新创建出的节点是 <strong>孤儿节点</strong>，这意味着它并没有被挂载到 DOM 树上，我们无法看见它。</p>
<p>必须继续使用 <code>appendChild()</code> 或 <code>insertBefore()</code> 方法将孤儿节点插入到 DOM 树上。</p>
<ol>
<li>任何已经在 DOM 树上的节点，都可以调用 <code>appendChild()</code> 方法，它可以将孤儿节点挂载到它的 <strong>内部</strong> ，成为它的 <strong>最后</strong> 一个子节点。</li>
</ol>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">父节点</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">孤儿节点</span><span class="p">);</span></span></span></code></pre></div></div>
</div>
<ol start="2">
<li>任何已经在 DOM 树上的节点，都可以调用 <code>insertBefore()</code> 方法，它可以将孤儿节点挂载到它的 <strong>内部</strong> ，成为它的 <strong>标杆子节点之前</strong> 的节点。</li>
</ol>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">父节点</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">孤儿节点</span><span class="p">,</span> <span class="nx">标杆节点</span><span class="p">);</span></span></span></code></pre></div></div>
</div>
<h4 id="移动">移动</h4>
<p>如果将已经挂载到 DOM 树上的节点成为 <code>appendChild()</code> 或者 <code>insertBefore()</code> 的参数，这个节点将会被自动 <strong>移动</strong> 。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 移动也许只需要修改一次链表末尾的指针。</p>
        </blockquote>
        
    </figure>

<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">新父节点</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">已经有父亲的节点</span><span class="p">);</span></span></span></code></pre></div></div>
</div>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">新父节点</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">已经有父亲的节点</span><span class="p">,</span> <span class="nx">标杆子节点</span><span class="p">);</span></span></span></code></pre></div></div>
</div>
<p>这意味着一个节点不能同时位于 DOM 树的两个位置。</p>
<h4 id="删除-1">删除</h4>
<p><code>removeChild()</code> 方法从 DOM 中删除一个子节点。</p>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">父节点</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">要删除子节点</span><span class="p">);</span></span></span></code></pre></div></div>
</div>
<p>节点 <strong>不能</strong> 主动删除自己，必须由父节点删除它。</p>
<h4 id="克隆">克隆</h4>
<p><code>cloneNode()</code> 方法可以克隆节点，克隆出的节点是 “孤儿节点”。</p>
<p>必须继续使用 <code>appendChild()</code> 或 <code>insertBefore()</code> 方法将孤儿节点插入到 DOM 树上。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">孤儿节点</span> <span class="o">=</span> <span class="nx">老节点</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">孤儿节点</span> <span class="o">=</span> <span class="nx">老节点</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">新父节点</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">孤儿节点</span><span class="p">);</span></span></span></code></pre></div>
</div>
<p>参数是一个布尔值，表示是否采用 <strong>深度克隆</strong> ：如果为 <code>true</code>，则该节点的所有后代节点也会被克隆，如果为 <code>false</code>，则只克隆该节点本身。</p>
<h3 id="事件">事件</h3>
<h4 id="监听">监听</h4>
<p><strong>监听</strong> 顾名思义，就是当某个事件发生了，从而执行程序员预先编写好的一些程序。</p>
<p>设置事件监听的方法主要有 <code>on_Event_</code> 和 <code>addEventListener()</code> 两种，</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<p>原始的事件处理方法：直接通过事件绑定函数，不推荐使用。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="c">&lt;!-- HTML --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;add();&#34;</span><span class="p">&gt;</span>点击<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="cm">/* JS */</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">add</span><span class="p">()</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">&#34;相加&#34;</span><span class="p">);</span> <span class="p">}</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>


    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd> 最简单的给元素设置事件监听的方法就是设置它们的<code>on_Event_</code>  属性：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">oBox</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 点击盒子时，将执行这里的语句
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></div>
</div>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">fun</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">oBox</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="nx">fun</span><span class="p">;</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h5 id="鼠标事件">鼠标事件</h5>
<table>
  <thead>
      <tr>
          <th>事件名</th>
          <th>事件描述</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>onclick</code></td>
          <td>当鼠标单击某个对象</td>
      </tr>
      <tr>
          <td><code>ondblclick</code></td>
          <td>当鼠标双击某个对象</td>
      </tr>
      <tr>
          <td><code>onmousedown</code></td>
          <td>当某个鼠标按键在某个对象上被按下</td>
      </tr>
      <tr>
          <td><code>onmouseup</code></td>
          <td>当某个鼠标按键在某个对象上被松开</td>
      </tr>
      <tr>
          <td><code>onmousemove</code></td>
          <td>当某个鼠标按键在某个对象上被移动</td>
      </tr>
      <tr>
          <td><code>onmouseenter</code><sup>不冒泡</sup></td>
          <td>当鼠标进入某个对象（ <code>onmouseover</code><sup>冒泡</sup>）</td>
      </tr>
      <tr>
          <td><code>onmouseleave</code><sup>不冒泡</sup></td>
          <td>当鼠标离开某个对象（ <code>onmouseout</code><sup>冒泡</sup>）</td>
      </tr>
  </tbody>
</table>
<h5 id="键盘事件">键盘事件</h5>
<table>
  <thead>
      <tr>
          <th>事件名</th>
          <th>事件描述</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><del><code>onkeypress</code></del></td>
          <td><del>当某个键盘的键被按下（系统按钮如箭头键和功能键无法得到识别）</del></td>
      </tr>
      <tr>
          <td><code>onkeydown</code></td>
          <td>当某个键盘的键被按下（系统按钮可以识别，并且会先于 <code>onkeypress</code> 发生）</td>
      </tr>
      <tr>
          <td><code>onkeyup</code></td>
          <td>当某个键盘的键被松开</td>
      </tr>
  </tbody>
</table>
<h5 id="表单事件">表单事件</h5>
<table>
  <thead>
      <tr>
          <th>事件名</th>
          <th>事件描述</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>onchange</code></td>
          <td>当用户改变完成域的内容</td>
      </tr>
      <tr>
          <td><code>onfocus</code></td>
          <td>当某元素获得焦点（比如 tab 键或鼠标点击）</td>
      </tr>
      <tr>
          <td><code>onblur</code></td>
          <td>当某元素失去焦点</td>
      </tr>
      <tr>
          <td><code>onsubmit</code></td>
          <td>当表单被提交</td>
      </tr>
      <tr>
          <td><code>onreset</code></td>
          <td>当表单被重置</td>
      </tr>
  </tbody>
</table>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 表单对象可以通过 <code>.</code> 访问 name 属性，得到内部元素。</p>
        </blockquote>
        
    </figure>

<h5 id="页面事件">页面事件</h5>
<table>
  <thead>
      <tr>
          <th>事件名</th>
          <th>事件描述</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>onload</code></td>
          <td>当页面或图像被完成加载</td>
      </tr>
      <tr>
          <td><code>onunload</code></td>
          <td>当用户退出页面</td>
      </tr>
  </tbody>
</table>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 页面属于 BOM 文档对象模型。</p>
        </blockquote>
        
    </figure>

<h4 id="捕获">捕获</h4>
<div class="ui-htmlblock-container"><div> <div style="display: flex;border-collapse: collapse;margin: 0 auto;justify-content: space-evenly;"> <div style="/* margin: 0 auto; */border: 1px dashed darkslateblue;display: flex;align-items: center;justify-content: center;padding: .5em;"> <div style="height: 10vh;width: 10vh;margin: auto;position:relative; "> <div style="height: 100%;width: 100%;background-image: linear-gradient(37deg, #13293d 0%, #00777d 100%);position: absolute;left: 50%; top: 50%; transform: translate(-50%,-50%);"></div><div style="height: 80%;width: 80%;background-image: linear-gradient(37deg, #2c6291 0%, #018b92 100%);position: absolute;left: 50%; top: 50%; transform: translate(-50%,-50%);"></div><div style="height: 60%;width: 60%;background-image: linear-gradient(37deg, #3d85c4 0%, #00b5be 100%);position: absolute;left: 50%; top: 50%; transform: translate(-50%,-50%);"></div><div style="height: 40%;width: 40%;background-image: linear-gradient(37deg, #4facfe 0%, #00f2fe 100%);position: absolute;left: 50%;top: 50%;transform: translate(-50%,-50%);"></div> </div> </div><div style="/* margin: 0 auto; */border: 1px dashed darkslateblue;padding: .5em"> <div></div> <div style="width: 100%;height: 100%;"> <div style="height: 10vh;width: 10vh;transform-style:preserve-3d;margin: 0 auto;perspective: 250px;transform: rotateY(53deg) scale(0.8);position:relative;"> <div style="height: 100%;width: 100%;background-image: linear-gradient(37deg, #4facfe 0%, #00f2fe 100%);box-sizing: border-box;transform: translate3D(0,0%,90px);display: flex;align-items: center;justify-content: center;position: absolute;"><span>向<br>内</span></div><div style="height: 100%;width: 100%;background-image: linear-gradient(37deg, #3d85c4 0%, #00b5be 100%);box-sizing: border-box;transform: translate3D(0,0%,30px);display: flex;align-items: center;justify-content: center;position: absolute;"><span>方<br>向</span></div><div style="height: 100%;width: 100%;background-image: linear-gradient(37deg, #2c6291 0%, #018b92 100%);color: lightgray;box-sizing: border-box;transform: translate3D(0,0%,-30px);display: flex;align-items: center;justify-content: center;position: absolute;"><span>导<br>外</span></div><div style="height: 100%;width: 100%;background-image: linear-gradient(37deg, #13293d 0%, #00777d 100%);color: white;box-sizing: border-box;transform: translate3D(0,0%,-90px);display: flex;align-items: center;justify-content: center;position: absolute;"><span>传<br>由</span></div> </div> </div> </div> </div> </div></div>
<p>在嵌套的盒子模型中，事件的传播分成两个阶段：</p>
<ol>
<li>捕获阶段<sup><em>Capturing Phase</em></sup>：外 → 内</li>
<li>冒泡阶段<sup><em>Bubbling Phase</em></sup>：内 → 外</li>
</ol>
<p>而 <code>on_Event_</code> 只能监听冒泡阶段。</p>
<p>因此引入 <code>addEventListerner()</code> 。</p>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">oBox</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){},</span> <span class="kc">true</span><span class="p">);</span></span></span></code></pre></div></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<ol>
<li><code>DOM0</code> 级事件监听：只能监听冒泡阶段</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">oBox</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// Statements...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span></span></span></code></pre></div>
</div>
<ol start="2">
<li><code>DOM2</code> 级事件监听：可监听 捕获阶段<sup>由外向内-<em>true</em></sup> 和 冒泡阶段<sup>由内而外-<em>false</em></sup></li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">oBox</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 捕获事件前面不加on
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// Statements...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// true监听捕获阶段，false监听冒泡阶段
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">);</span></span></span></code></pre></div>
</div>
<p>执行顺序：捕获阶段
→ <code>onclick()</code>
→ 冒泡阶段（新版 <em>Chrome</em>）</p>
<p>如果给元素设置相同的两个或多个同名事件，则 <code>DOM0</code> 级写法后面写的会覆盖先写的；而 <code>DOM2</code> 级会按顺序执行。</p>
        </blockquote>
        
    </figure>

<h4 id="对象-1">对象</h4>
<p><strong>事件处理函数</strong> 提供一个 <strong>形式参数</strong> ，它是一个对象，封装了本次事件的细节。</p>
<p>这个参数通常用单词 <code>event</code> 或字母 <code>e</code> 来表示，接受的值由浏览器或操作系统传递。对象属性通过点操作符 <code>.</code> 访问。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">oBox</span><span class="p">.</span><span class="nx">onmousemove</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 对象 e 就是这次事件的事件对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></div>
</div>
<ol>
<li>
<h5 id="鼠标位置">鼠标位置</h5>
</li>
</ol>
<table>
  <thead>
      <tr>
          <th>属性</th>
          <th>属性描述</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>clientX</code></td>
          <td>鼠标指针相对于 <strong>浏览器</strong> 的水平坐标</td>
      </tr>
      <tr>
          <td><code>clientY</code></td>
          <td>鼠标指针相对于 <strong>浏览器</strong> 的垂直坐标</td>
      </tr>
      <tr>
          <td><code>pageX</code></td>
          <td>鼠标指针相对于 <strong>整张网页</strong> 的水平坐标</td>
      </tr>
      <tr>
          <td><code>pageY</code></td>
          <td>鼠标指针相对于 <strong>整张网页</strong> 的垂直坐标</td>
      </tr>
      <tr>
          <td><code>offsetX</code></td>
          <td>鼠标指针相对于 <strong>事件源元素</strong> 的水平坐标</td>
      </tr>
      <tr>
          <td><code>offsetY</code></td>
          <td>鼠标指针相对于 <strong>事件源元素</strong> 的垂直坐标</td>
      </tr>
  </tbody>
</table>
<ol start="2">
<li>
<h5 id="获取键码">获取键码</h5>
</li>
</ol>
<p>用户按下键盘上的键时发生的事件属于 <code>KeyboardEvent</code> 对象。</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">属性/方法</th>
          <th style="text-align: left">描述</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>altKey</code></td>
          <td style="text-align: left">返回触发键事件时是否按下 <code>ALT</code> 键</td>
      </tr>
      <tr>
          <td style="text-align: left"><del><code>charCode</code></del></td>
          <td style="text-align: left"><del>返回触发事件的键的 Unicode 字符代码</del></td>
      </tr>
      <tr>
          <td style="text-align: left"><code>code</code><sup>:star:</sup></td>
          <td style="text-align: left">返回触发事件的键的 <strong>代码</strong></td>
      </tr>
      <tr>
          <td style="text-align: left"><code>ctrlKey</code></td>
          <td style="text-align: left">返回触发键事件时是否按下“CTRL”键</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>getModifierState()</code></td>
          <td style="text-align: left">如果激活了指定的键，则返回true</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>isComposing</code></td>
          <td style="text-align: left">返回事件的状态是否正在撰写</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>key</code><sup>:star:</sup></td>
          <td style="text-align: left">返回事件表示的键的 <strong>键值</strong></td>
      </tr>
      <tr>
          <td style="text-align: left"><del><code>keyCode</code></del></td>
          <td style="text-align: left"><del>返回触发onkeypress事件的键的Unicode字符代码，或触发onkeydown或onkeyup事件的键的Unicode键代码</del></td>
      </tr>
      <tr>
          <td style="text-align: left"><code>location</code></td>
          <td style="text-align: left">返回键盘或设备上键的位置</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>metaKey</code></td>
          <td style="text-align: left">返回触发键事件时是否按下“meta”键</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>repeat</code></td>
          <td style="text-align: left">返回是否重复按下某个键</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>shiftKey</code></td>
          <td style="text-align: left">返回触发键事件时是否按下“SHIFT”键</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>which</code></td>
          <td style="text-align: left">返回触发 <em>onkeypress</em> 事件的键的 <em>Unicode</em> 字符代码，或触发 <em>onkeydown</em> 或 <em>onkeyup</em> 事件的键的 <em>Unicode</em> 键代码</td>
      </tr>
  </tbody>
</table>
<h4 id="阻止">阻止</h4>
<ol>
<li>
<h5 id="epreventdefault"><code>e.preventDefault()</code></h5>
</li>
</ol>
<p>用来阻止事件产生的 <strong>默认动作</strong> 。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em> 1</kbd></p>
<p>制作一个文本框，只能让用户在其中输入小写字母和数字，其他字符输入没有效果。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">只能输入小写字母和数字：
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;field&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">oField</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;field&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">oField</span><span class="p">.</span><span class="nx">onkeydown</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="c1">// 根据用户输入的字符的字符码（e.charCode)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="c1">// 范围为数字 0~9，写字母 a~z
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">key</span> <span class="o">&gt;=</span> <span class="s1">&#39;a&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">e</span><span class="p">.</span><span class="nx">key</span> <span class="o">&lt;=</span> <span class="s1">&#39;z&#39;</span> <span class="o">||</span> <span class="nx">e</span><span class="p">.</span><span class="nx">key</span> <span class="o">&gt;=</span> <span class="s1">&#39;0&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">e</span><span class="p">.</span><span class="nx">key</span> <span class="o">&lt;=</span> <span class="s1">&#39;9&#39;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">code</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// 阻止浏览器的默认行为 &lt;- 向input输入
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<p><kbd>:page_with_curl: <em>Example</em> 2</kbd></p>
<p>制作鼠标滚轮事件：当鼠标在盒子中向下滚动时，数字加 1；反之，数字减 1。</p>
<p>鼠标滚轮事件是 <code>onmousewheel</code>，它的事件对象 e 提供 <code>deltaY</code> 属性表示鼠标滚动方向，向下滚动是返回正值，向上滚动时返回负值。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;box&#34;</span><span class="p">&gt;&lt;</span><span class="nt">h1</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;info&#34;</span><span class="p">&gt;</span>0<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">#</span><span class="nn">box</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">width</span><span class="p">:</span> <span class="mi">200</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">height</span><span class="p">:</span> <span class="mi">200</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">border</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">dashed</span> <span class="kc">darkslateblue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">display</span><span class="p">:</span> <span class="kc">flex</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">justify-content</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">align-items</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">oBox</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;box&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">oInfo</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">info</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">oBox</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;mousewheel&#39;</span><span class="p">,</span> <span class="nx">e</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nx">e</span><span class="p">.</span><span class="nx">deltaY</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">info</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">e</span><span class="p">.</span><span class="nx">deltaY</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">info</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">oInfo</span><span class="p">.</span><span class="nx">innerText</span> <span class="o">=</span> <span class="nx">info</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<ol start="2">
<li>
<h5 id="estoppropagation"><code>e.stopPropagation()</code></h5>
</li>
</ol>
<p>不管是冒泡还是捕获，事件可以在各层级的节点中传递。有时我们希望事件在特定节点执行完后不再传递，就可以使用 <code>event.stopProgation()</code>来阻止事件 <strong>冒泡</strong> 。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd> 制作一个弹出层：点击按钮显示弹出层，点击网页任意地方，弹出层关闭。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nc">modal</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">width</span><span class="p">:</span> <span class="mi">400</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">height</span><span class="p">:</span> <span class="mi">140</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">background-color</span><span class="p">:</span> <span class="mh">#333</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">top</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">left</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">margin-top</span><span class="p">:</span> <span class="mi">-70</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">margin-left</span><span class="p">:</span> <span class="mi">-200</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">display</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">button</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;btn&#34;</span><span class="p">&gt;</span>按我弹出弹出层<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;modal&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;modal&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">oBtn</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;btn&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">oModal</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;modal&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// 点击按钮的时候，弹出层显示
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">oBtn</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 阻止事件继续传播到document身上
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nx">oModal</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;block&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// 点击页面任何部分的时候，弹出层关闭
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nb">document</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">oModal</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// 点击弹出层内部的时候，不能关闭弹出层的，所以应该阻止事件继续传播
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">oModal</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 阻止事件继续冒泡传播到document身上
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<ol start="3">
<li>
<h5 id="return-false"><code>return false</code></h5>
</li>
</ol>
<p>包含特有退出执行<code>return false </code> 之后的所有触发事件和动作都不会被执行。有时候<code>return false</code> 可以替代<code>event.stopPropagation()</code>和<code>event.preventDefult()</code>来阻止默认行为发生和冒泡。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;http://www.baidu.com&#34;</span><span class="p">&gt;</span>点击<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">).</span><span class="nx">onclick</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">       <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;警告&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<p>结果只是出现了警告的弹窗，并没有跳转到百度页面。</p>
<p>如果将 <code>retuen false</code> 提前到 <code>alert('警告')</code> 的前面，结果就是什么都不显示，原因是 return false 会中止事件与默认行文。</p>
        </blockquote>
        
    </figure>

<h4 id="委托">委托</h4>
<ol>
<li>
<h5 id="批量添加">批量添加</h5>
</li>
</ol>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<p>页面上有一个无序列表 <code>&lt;ul&gt;</code>，它内部共有 20 个 <code>&lt;li&gt;</code> 元素，请批量给它们添加事件监听，实现效果：点击哪个 <code>&lt;li&gt;</code> 元素，哪个 <code>&lt;li&gt;</code> 元素就变红。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">ul</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;list&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">oList</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">lis</span> <span class="o">=</span> <span class="nx">oList</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// 书写循环语句，批量给元素添加监听
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">lis</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">lis</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 在这个函数中，this表示点击的这个元素，this涉及函数上下文的相关知识，我们在“面向对象”课程中介绍
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<p>上面的例题中，每一个事件监听注册都会消耗一定的系统内存，而批量添加事件会导致监听数量太多，内存消耗会非常大。</p>
<p>实际上，每个 <code>&lt;li&gt;</code> 的事件处理函数都是不同的函数，这些函数本身也会占用内存。因此引入了 <strong>动态绑定</strong> 。</p>
<ol start="2">
<li>
<h5 id="动态绑定">动态绑定</h5>
</li>
</ol>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<p>页面上有一个无序列表 <code>&lt;ul&gt;</code>，它内部没有 <code>&lt;li&gt;</code> 元素，请制作一个按钮，点击这个按钮就能增加一个 <code>&lt;li&gt;</code> 元素。并且要求每个增加的 <code>&lt;li&gt;</code> 元素也要有点击事件监听，实现效果：点击哪个 <code>&lt;li&gt;</code> 元素，哪个 <code>&lt;li&gt;</code> 元素就变红。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">button</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;btn&#34;</span><span class="p">&gt;</span>按我添加新的li列表项<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">ul</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;list&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">oBtn</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;btn&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">oList</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">lis</span> <span class="o">=</span> <span class="nx">oList</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 创建的时候还没有任何内容： HTMLCollection []
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// 但之后调用lis的时候发现会动态更新
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">lis</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nx">oBtn</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">oLi</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">oLi</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">&#39;我是列表项&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">oList</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">oLi</span><span class="p">);</span>    <span class="c1">// 上树
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">oLi</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<p>新增元素必须分别添加事件监听，而不能自动获取事件监听。大量事件监听、大量事件处理函数都会产生大量的内存消耗。为了减少监听的消耗，可以利用事件冒泡的机制，将后代元素事件委托给祖先元素。</p>
<ol start="3">
<li>
<h5 id="事件委托">事件委托</h5>
</li>
</ol>
<p>利用事件冒泡机制，将后代元素事件委托给祖先元素。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">ul</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;list&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- 监听onclick事件 --&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">list</span><span class="p">&gt;</span>list item<span class="p">&lt;/</span><span class="nt">list</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">list</span><span class="p">&gt;</span>list item<span class="p">&lt;/</span><span class="nt">list</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">list</span><span class="p">&gt;</span>list item<span class="p">&lt;/</span><span class="nt">list</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- 不管点击任何一个&lt;li&gt;元素，事件都会 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<p>事件委托通常需要结合使用 <code>e.target</code> 属性。</p>
<table>
  <thead>
      <tr>
          <th>属性</th>
          <th>属性描述</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>target</code></td>
          <td>触发此事件的最早元素，即 “事件源元素”</td>
      </tr>
      <tr>
          <td><code>currentTarget</code></td>
          <td>事件处理程序附加到的元素</td>
      </tr>
  </tbody>
</table>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">button</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;btn&#34;</span><span class="p">&gt;</span>按我创建一个新列表项<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">ul</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;list&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>列表项<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">oList</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">oBtn</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;btn&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">oList</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// e.target表示用户真正点击的那个元素
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span> <span class="o">!==</span> <span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 点击的不是父元素（处理程序所附加元素）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span> <span class="o">===</span> <span class="s1">&#39;transparent&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="s1">&#39;inherit&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="s1">&#39;transparent&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">oBtn</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">oLi</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">oLi</span><span class="p">.</span><span class="nx">innerText</span> <span class="o">=</span> <span class="s1">&#39;我是新来的&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">oList</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">oLi</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note 1</em></kbd> 当有大量类似元素需要批量添加事件监听时，使用事件委托可以减少内存开销。</p>
<p>当有动态元素节点上树时，使用事件委托可以让新上树的元素具有事件监听。</p>
<p><kbd>:memo: <em>Note 2</em></kbd></p>
<p>Q: <code>onmouseenter</code> 和 <code>onmouseover</code> 都表示 “鼠标进入”，它们有什么区别呢？</p>
<p>A: <code>onmouseenter</code> 不冒泡，<code>onmouseover</code> 冒泡。</p>
<p>使用事件委托时要注意：不能委托不冒泡的事件给祖先元素。</p>
        </blockquote>
        
    </figure>

<h3 id="时间">时间</h3>
<h4 id="定时器">定时器</h4>
<ol>
<li>
<h5 id="创建-3">创建</h5>
</li>
</ol>
<p><code>setInterval()</code> 函数可以重复调用一个函数，在每次调用之间有 <strong>固定的时间间隔</strong> 。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">setInterval</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 这个函数将以固定间隔自动被调用
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">},</span> <span class="mi">2000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 第二个参数是间隔时间。以毫秒为单位
</span></span></span></code></pre></div>
</div>
<p>函数可以接受第 3 个参数，它们将按顺序传入函数。第一个参数除了 <strong>匿名函数</strong> 外，还接受具名函数。</p>
<ol start="2">
<li>
<h5 id="清除">清除</h5>
</li>
</ol>
<p><code>clearInterval()</code> 函数可以清除一个定时器。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// 设置定时器，并且timer变量接受这个定时器
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">timer</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{},</span> <span class="mi">2000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">oBth</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 点击按钮时，清除定时器
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">oBtn</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">timer</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 清除定时器的时候，要传入定时器变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></div>
</div>
<p>为了防止定时器叠加，应该在设置定时器之前先清除定时器。</p>
<h4 id="延时器">延时器</h4>
<ol>
<li>
<h5 id="创建-4">创建</h5>
</li>
</ol>
<p><code>setTimeout()</code> 函数可以设置一个延时器，当指定时间到了之后，会执行函数一次，不再重复执行。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//这个函数会在2秒后执行一次
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">},</span> <span class="mi">2000</span><span class="p">);</span></span></span></code></pre></div>
</div>
<ol start="2">
<li>
<h5 id="清除-1">清除</h5>
</li>
</ol>
<p><code>clearTimeout()</code> 函数可以清除延时器，和 <code>clearInterval()</code> 非常类似。同样需要传入延时器变量。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<p>这两个时间函数都是 <strong>异步</strong><sup>asynchronous</sup> 语句。</p>
<p>不会阻塞 CPU 继续执行其它语句，当异步完成后，会执行 <strong>回调函数</strong><sup>Callback</sup> 。</p>
        </blockquote>
        
    </figure>

<h2 id="bom">BOM</h2>
<p><strong>B</strong>rowser <strong>O</strong>bject <strong>M</strong>odel 文档对象模型，是指浏览器对象模型，提供了独立于内容的、可以与浏览器窗口进行互动的对象结构。通过  BOM 可以操作浏览器对象窗口，比如弹出框、控制浏览器跳转、滚动条特效、获取分辨率等。</p>
<h3 id="window">Window</h3>
<p>The Window interface represents a <strong>window</strong> containing a <strong>DOM document</strong>; the document property points to the <strong>DOM document</strong> loaded in that window.</p>
<p>window 对象是当前 JS 脚本运行所处的窗口，而这个窗口中包含 DOM 结构，<code>window.document</code> 属性就是 <code>document</code> 对象，也即一个DOM实例。</p>
<p>在有标签功能的浏览器中，每个标签都拥有自己的 <code>window</code> 对象；也就是说，同一个窗口的标签页之间不会共享一个 <code>window</code> 对象。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 浏览器的全局对象是 <code>window</code>，所有全局变量实际上是 <code>window</code> 的成员，可以免 <code>window</code> 访问。</p>
<p>BOM 的核心对象是 <code>window</code> ，它表示浏览器的一个实例。<code>window</code> 对象有双重角色，它既是通过 JavaScript 访问浏览器窗口的一个 <strong>接口</strong> ，又是 ECMAScript 规定的 <code>Global</code> <strong>对象</strong> 。这意味着在网页中定义的任何一个对象、变量和函数，都以 <code>window</code> 作为其 <code>Global</code> 对象，因此有权访问 <code>parseInt()</code> 等方法。</p>
<p>如果页面中包含 <strong>框架</strong> ，则每个框架都拥有自己的 <code>window</code> 对象，并且保存在 <code>frames</code> 集合中。在 <code>frames</code> 集合中，可以通过数值索引<sup>从0开始，从左至右，从上到下</sup> 或者框架的 <strong>名称</strong> 来访问相应的 <code>window</code> 对象。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">answer</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* let不能显示 */</span>
</span></span><span class="line"><span class="cl"><span class="nx">alert</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">answer</span><span class="p">);</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<p>全局变量会成为 <code>window</code> 对象的属性，多个 JS 文件之间共享 <strong>全局作用域</strong> 。如 <code>setInterval()</code>、<code>alert()</code> 等内置函数，普遍是 <code>window</code> 的方法。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 似乎在 Node.js 中并不能使用 <code>window.setInterval()</code></p>
        </blockquote>
        
    </figure>

<h3 id="窗口">窗口</h3>
<p>DOM Level 0。不属于任何 W3C 技术规范或推荐。</p>
<table>
  <thead>
      <tr>
          <th>属性</th>
          <th>意义</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>innerHeight</code></td>
          <td>内容区域高度，包含水平滚动条</td>
      </tr>
      <tr>
          <td><code>innerWidth</code></td>
          <td>内容区域的宽度，包含垂直滚动条</td>
      </tr>
      <tr>
          <td><code>outerHeight</code></td>
          <td>整个窗口高度</td>
      </tr>
      <tr>
          <td><code>outerWidth</code></td>
          <td>整个窗口宽度</td>
      </tr>
  </tbody>
</table>
<p>获得不包含滚动条的窗口宽度，要用：</p>
<p><code>document.documentElement.clientWidth</code></p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd> 浏览器的外宽指的是 <strong>浏览器窗口边框</strong> 的宽度。</p>
<ol>
<li>当浏览器窗口全屏时：<code>浏览器的外宽</code> == <code>浏览器内宽</code><sup>包含滚动条</sup></li>
<li>当浏览器窗口不全屏时：<code>浏览器的外宽</code> &gt; <code>浏览器内宽</code><sup>包含滚动条</sup></li>
</ol>
        </blockquote>
        
    </figure>

<h4 id="resize">Resize</h4>
<p>在窗口大小改变之后，就会触发 <code>resize</code> 事件，可以使用 <code>window.onresize</code> 或者 <code>window.addEventListener('resize')</code> 来绑定事件处理函数。</p>
<h4 id="scrool">Scrool</h4>
<p><code>window.scrollY</code> 属性表示在垂直方向已滚动的像素值。</p>
<p><code>document.documentElement.scrollTop</code> 属性也表示窗口卷动高度。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// 可以利用此种方式获得窗口卷动的高度
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">scrollTop</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">scrollY</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">;</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<ol>
<li><code>document.documentElement.scrollTop</code> 是可以手动给定值的，以达到跳动到任何指定滚动高度处</li>
<li><code>window.scrollY</code>  <strong>是只读</strong> 的，不可以手动给值</li>
</ol>
        </blockquote>
        
    </figure>

<p>在窗口被卷动之后，就会触发 scroll 事件，可以使用：</p>
<p><code>window.onscroll</code> 或者 <code>window.addEventListener('scroll')</code> 来绑定事件处理函数。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:page_with_curl: <em>Example</em> 1</kbd> 返回顶部按钮制作</p>
<p>返回顶部的原理：改变 <code>document.documentElement.scrollTop</code> 属性，通过定时器逐步改变此值，则将用动画形式返回顶部。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width="device-width," initial-scale="1.0&#34;</span"><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Document<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">body</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">height</span><span class="p">:</span> <span class="mi">5000</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">background-image</span><span class="p">:</span> <span class="nb">linear-gradient</span><span class="p">(</span><span class="kc">to</span> <span class="kc">bottom</span><span class="p">,</span> <span class="nb">rgb</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">149</span><span class="p">),</span> <span class="nb">rgb</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="nb">rgb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">76</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">backtotop</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">width</span><span class="p">:</span> <span class="mi">60</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">height</span><span class="p">:</span> <span class="mi">60</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">background-color</span><span class="p">:</span> <span class="nb">rgba</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mf">.6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">position</span><span class="p">:</span> <span class="kc">fixed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">bottom</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">right</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="c">/* 小手状 */</span>
</span></span><span class="line"><span class="cl">            <span class="k">cursor</span><span class="p">:</span> <span class="kc">pointer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;backtotop&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;backtotopBtn&#34;</span><span class="p">&gt;</span>返回顶部<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">backtotopBtn</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;backtotopBtn&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">timer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">backtotopBtn</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 设表先关
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">timer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 设置定时器
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">timer</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 不断让scrollTop减少
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">-="</span"> <span class="mi">200</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 定时器肯定要停
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">timer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span> <span class="mi">20</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<p><kbd>:page_with_curl: <em>Example</em> 2</kbd> 楼层导航小效果</p>
<p>DOM 元素都有 <code>offsetTop</code> 属性，表示此元素到定位祖先元素的垂直距离。</p>
<p>定位祖先元素：在祖先中，离自己最近的且拥有定位属性的元素。</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p>即：offsetTop 属性可以得到该元素与离自己最近且拥有定位的祖先元素顶部的距离值。</p>
<p>假如，没有祖先有定位，那么直接得到该元素距离页面顶部的距离值。</p>
        </blockquote>
        
    </figure>

<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width="device-width," initial-scale="1.0&#34;</span"><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Document<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">*</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">padding</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">content-part</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">width</span><span class="p">:</span> <span class="mi">1000</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="kt">px</span> <span class="kc">auto</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">margin-bottom</span><span class="p">:</span> <span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">background-color</span><span class="p">:</span> <span class="mh">#ccc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">font-size</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">floornav</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">position</span><span class="p">:</span> <span class="kc">fixed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">right</span><span class="p">:</span> <span class="mi">40</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">top</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">margin-top</span><span class="p">:</span> <span class="mi">-100</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">width</span><span class="p">:</span> <span class="mi">120</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">height</span><span class="p">:</span> <span class="mi">200</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">background-color</span><span class="p">:</span> <span class="kc">orange</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">floornav</span> <span class="nt">ul</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">list-style</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">floornav</span> <span class="nt">ul</span> <span class="nt">li</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">width</span><span class="p">:</span> <span class="mi">120</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">height</span><span class="p">:</span> <span class="mi">40</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">line-height</span><span class="p">:</span> <span class="mi">40</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">text-align</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">font-size</span><span class="p">:</span> <span class="mi">26</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="c">/* 小手指针 */</span>
</span></span><span class="line"><span class="cl">            <span class="k">cursor</span><span class="p">:</span> <span class="kc">pointer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nc">floornav</span> <span class="nt">ul</span> <span class="nt">li</span><span class="p">.</span><span class="nc">current</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">background</span><span class="p">:</span> <span class="kc">purple</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">color</span><span class="p">:</span> <span class="kc">white</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">nav</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;floornav&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;list&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span> <span class="na">data-n</span><span class="o">=</span><span class="s">&#34;科技&#34;</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;current&#34;</span><span class="p">&gt;</span>科技<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span> <span class="na">data-n</span><span class="o">=</span><span class="s">&#34;体育&#34;</span><span class="p">&gt;</span>体育<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span> <span class="na">data-n</span><span class="o">=</span><span class="s">&#34;新闻&#34;</span><span class="p">&gt;</span>新闻<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span> <span class="na">data-n</span><span class="o">=</span><span class="s">&#34;娱乐&#34;</span><span class="p">&gt;</span>娱乐<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">li</span> <span class="na">data-n</span><span class="o">=</span><span class="s">&#34;视频&#34;</span><span class="p">&gt;</span>视频<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">nav</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">section</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;content-part&#34;</span> <span class="na">style</span><span class="o">=</span><span class="s">&#34;height:674px;&#34;</span> <span class="na">data-n</span><span class="o">=</span><span class="s">&#34;科技&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        科技栏目
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">section</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">section</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;content-part&#34;</span> <span class="na">style</span><span class="o">=</span><span class="s">&#34;height:567px;&#34;</span> <span class="na">data-n</span><span class="o">=</span><span class="s">&#34;体育&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        体育栏目
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">section</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">section</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;content-part&#34;</span> <span class="na">style</span><span class="o">=</span><span class="s">&#34;height:739px;&#34;</span> <span class="na">data-n</span><span class="o">=</span><span class="s">&#34;新闻&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        新闻栏目
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">section</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">section</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;content-part&#34;</span> <span class="na">style</span><span class="o">=</span><span class="s">&#34;height:574px;&#34;</span> <span class="na">data-n</span><span class="o">=</span><span class="s">&#34;娱乐&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        娱乐栏目
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">section</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">section</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;content-part&#34;</span> <span class="na">style</span><span class="o">=</span><span class="s">&#34;height:1294px;&#34;</span> <span class="na">data-n</span><span class="o">=</span><span class="s">&#34;视频&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        视频栏目
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">section</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 使用事件委托给li添加监听
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">list</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">contentParts</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;.content-part&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">lis</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;#list li&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nx">list</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;li&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// getAttribute表示得到标签身上的某个属性值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;data-n&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="c1">// 可以用属性选择器(就是方括号选择器)来寻找带有相同data-n的content-part
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="kd">var</span> <span class="nx">contentPart</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;.content-part[data-n="&#39;</span"> <span class="o">+</span> <span class="nx">n</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="c1">// 让页面的卷动自动成为这个盒子的offsetTop值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">contentPart</span><span class="p">.</span><span class="nx">offsetTop</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 在页面加载好之后，将所有的content-part盒子的offsetTop值推入数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">offsetTopArr</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 遍历所有的contentPart，将它们的净位置推入数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">contentParts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">offsetTopArr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">contentParts</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">offsetTop</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 为了最后一项可以方便比较，我们可以推入一个无穷大
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">offsetTopArr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="kc">Infinity</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">offsetTopArr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 当前所在楼层
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">nowfloor</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 窗口的卷动
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nb">window</span><span class="p">.</span><span class="nx">onscroll</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 得到当前的窗口卷动值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="kd">var</span> <span class="nx">scrollTop</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 遍历offsetTopArr数组，看看当前的scrollTop值在哪两个楼层之间
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">offsetTopArr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="nx">scrollTop</span> <span class="o">&gt;=</span> <span class="nx">offsetTopArr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">scrollTop</span> <span class="o">&lt;</span> <span class="nx">offsetTopArr</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 退出循环的时候，i是几，就表示当前楼层是几
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">// 如果当前所在楼层，不是i，表示环楼了
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="p">(</span><span class="nx">nowfloor</span> <span class="o">!=</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 让全局变量改变为这个楼层号
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="nx">nowfloor</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="c1">// 设置下标为i的项有cur
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">lis</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">(</span><span class="nx">j</span> <span class="o">==</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">lis</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">&#39;current&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">lis</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></div>
</div>
<p>Navigator</p>
        </blockquote>
        
    </figure>

<p><code>window.navigator</code> 属性可以检索 <code>navigator</code> 对象，它内部含有用户此次活动的浏览器的相关属性和标识。</p>
<table>
  <thead>
      <tr>
          <th>属性</th>
          <th>意义</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>appName</code></td>
          <td>浏览器官方名称</td>
      </tr>
      <tr>
          <td><code>appVersion</code></td>
          <td>浏览器版本</td>
      </tr>
      <tr>
          <td><code>userAgent</code></td>
          <td>浏览器用户代理（含有内核信息和封装壳信息）</td>
      </tr>
      <tr>
          <td><code>platform</code></td>
          <td>用户操作系统</td>
      </tr>
  </tbody>
</table>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p><kbd>:memo: <em>Note</em></kbd></p>
<p>识别用户浏览器品牌通常使用 <code>navigator.userAgent</code> 属性。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">sUsrAg</span> <span class="o">=</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">sUsrAg</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&#34;Firefox&#34;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">sUsrAg</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&#34;Opera&#34;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">sUsrAg</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&#34;Edge&#34;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">sUsrAg</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&#34;Chrome&#34;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">sUsrAg</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&#34;Safari&#34;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
        </blockquote>
        
    </figure>

<h3 id="浏览">浏览</h3>
<h4 id="history">History</h4>
<p><code>window.history</code> 对象提供了操作浏览器会话历史的接口。</p>
<p>常用操作就是模拟浏览器 <strong>回退</strong> 按钮。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">history</span><span class="p">.</span><span class="nx">back</span><span class="p">();</span>	<span class="c1">// 等同于点击浏览器的回退按钮
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">history</span><span class="p">.</span><span class="nx">go</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>	<span class="c1">// 等同于 history.back();
</span></span></span></code></pre></div>
</div>
<h4 id="location">Location</h4>
<p><code>window.location</code> 标识当前所在网址，可以通过给这个属性赋值命令浏览器进行页面跳转。</p>
<p>可以调用 <code>location</code> 的 <code>reload</code> 方法以重新加载当前页面，参数 true 表示强制从服务器加载。</p>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">reload</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span></span></span></code></pre></div></div>
</div>
<p><code>window.location.search</code> 属性即为当前浏览器的 GET 请求查询参数。</p>
<p>比如网址：https://www.imooc.com/?a="1&amp;b=2</p">
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">);</span>	<span class="c1">// &#34;?a="1&amp;b=2&#34;"
</span></span></span></code></pre></div>
</div>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <p>关于 GET 及 POST 的详细内容在 Ajax 中介绍。</p>
        </blockquote>
        
    </figure>

<h2 id="trick"><em>Trick</em></h2>
<h3 id="获取全局对象">获取全局对象</h3>
<h3 id="消除魔术字符串06-ecmascriptmdmagic-string">[消除魔术字符串](06 EcmaScript.md/#magic-string)</h3>
<h3 id="链式写法">链式写法<sup id="trick-chain"> </sup></h3>
<p>为 <em>Array.prototype.push()</em> 添加链式写法</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">Push</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">().</span><span class="nx">Push</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">).</span><span class="nx">Push</span><span class="p">(</span><span class="s1">&#39;green&#39;</span><span class="p">).</span><span class="nx">Push</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">key</span> <span class="k">of</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">keys</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 0 1 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">values</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// red green blue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">entry</span> <span class="k">of</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">entries</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">entry</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// [0, &#39;red&#39;] [1, &#39;green&#39;] [2, &#39;blue&#39;]
</span></span></span></code></pre></div>
</div>
<h3 id="异步处理法06-ecmascriptmdtrick-asynchronous-processing-es6">[异步处理法](06 EcmaScript.md#trick-asynchronous-processing-es6)<sup id="trick-asynchronous-processing"> </sup></h3>
<h3 id="包装类型">包装类型<sup id="trick-primitive-wrapper-types"> </sup></h3>

  </div></div>

        <footer class="ui-footer flex flex-wrap gap-2 justify-between p-4"><time datetime='03/20' class="text-muted flex items-center">

    <i class="icon"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
    <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5" />
</svg>
</i>

    <span class="ms-1">2023-03-20</span>

</time>

</footer>
    </div>

    <div class="grid grid-cols-2 gap-4 text-sm h-14"><a href="/techs/04-css/"
                class="ui-button ui-interactive flex items-center justify-start p-4" draggable="false">
                <i class="icon mr-1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
  <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5" />
</svg>
</i>
                <span>04 CSS</span>
            </a><a 
                href="/techs/06-ecmascript/"
                class="ui-button ui-interactive flex items-center justify-end p-4" draggable="false">
                <span>06 EcmaScript</span>
                <i class="icon mr-1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
  <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" />
</svg>
</i>
            </a></div>

</article>
</main>

          <aside class="ui-grid-right">
            <div class="ui-content" id="main-container-right">
    <div class="ui-card" id="toc-container">
            <header class="ui-card-header flex items-center justify-start gap-2 p-4">
                <i class="icon"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12" />
</svg>
</i>
                目录
            </header>
            <div class="ui-body text-muted text-sm p-4">
                <nav class="toc" id="toc-nav"><a href="#javascript" 
                           data-toc-link
                           data-level="1"
                           class="toc-link block py-1 text-base">










<div class="markdown">
    JavaScript
  </div></a><a href="#%e5%af%bc%e8%ae%ba" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    导论
  </div></a><a href="#%e5%8c%ba%e5%88%ab" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    区别
  </div></a><a href="#%e5%bc%95%e5%85%a5" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    引入
  </div></a><a href="#io" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    I/O
  </div></a><a href="#%e6%9d%82%e9%a1%b9" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    杂项
  </div></a><a href="#%e5%8f%98%e9%87%8f" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    变量
  </div></a><a href="#type" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Type</em>
  </div></a><a href="#typeof" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Typeof</em><sup id="variable-typeof-es5"> </sup>
  </div></a><a href="#%e5%ad%97%e9%9d%a2%e9%87%8f" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    字面量
  </div></a><a href="#%e5%af%b9%e6%af%94" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    对比<sup id="compare-es5"> </sup>
  </div></a><a href="#%e8%bd%ac%e6%8d%a2" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    转换
  </div></a><a href="#%e8%bf%90%e7%ae%97%e7%ac%a6" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    运算符
  </div></a><a href="#%e6%8e%a7%e5%88%b6" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    控制
  </div></a><a href="#%e9%a1%ba%e5%ba%8f" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    顺序
  </div></a><a href="#%e5%88%86%e6%94%af" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    分支
  </div></a><a href="#%e7%9f%ad%e8%b7%af" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    短路
  </div></a><a href="#%e5%be%aa%e7%8e%af" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    循环
  </div></a><a href="#%e6%95%b0%e7%bb%84" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    数组<sup id="array-es5"> </sup>
  </div></a><a href="#%e8%ae%bf%e9%97%ae" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    访问
  </div></a><a href="#%e5%b1%9e%e6%80%a7" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    属性
  </div></a><a href="#%e6%96%b9%e6%b3%95-1" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    方法
  </div></a><a href="#%e9%80%92%e5%bd%92" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    递归
  </div></a><a href="#%e6%8b%b7%e8%b4%9d" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    拷贝<sup id="object-copy"> </sup>
  </div></a><a href="#%e4%ba%8c%e7%bb%b4%e6%95%b0%e7%bb%84" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    二维数组
  </div></a><a href="#%e4%be%8b%e9%a2%98" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    例题
  </div></a><a href="#%e5%af%b9%e8%b1%a1" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    对象<sup id="object-es5"> </sup>
  </div></a><a href="#%e5%88%9b%e5%bb%ba" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    创建
  </div></a><a href="#%e5%88%a0%e9%99%a4" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    删除
  </div></a><a href="#%e6%96%b9%e6%b3%95-2" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    方法
  </div></a><a href="#%e9%81%8d%e5%8e%86" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    遍历
  </div></a><a href="#%e6%9e%84%e9%80%a0%e5%87%bd%e6%95%b0" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    构造函数<sup id="construct-es5"> </sup>
  </div></a><a href="#%e5%8e%9f%e5%9e%8b%e5%af%b9%e8%b1%a1" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    原型对象
  </div></a><a href="#%e5%8c%85%e8%a3%85%e7%b1%bb" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    包装类
  </div></a><a href="#%e6%95%b0%e5%ad%a6%e7%b1%bb" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    数学类<sup id="math-es5"> </sup>
  </div></a><a href="#%e6%97%a5%e6%9c%9f%e7%b1%bb" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    日期类
  </div></a><a href="#%e6%97%b6%e9%97%b4%e6%88%b3" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    时间戳
  </div></a><a href="#new-1" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>new</em>
  </div></a><a href="#%e6%a1%88%e4%be%8b" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    案例
  </div></a><a href="#%e5%87%bd%e6%95%b0" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    函数
  </div></a><a href="#%e7%ae%97%e6%b3%95" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    算法
  </div></a><a href="#%e4%bc%a0%e5%8f%82" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    传参
  </div></a><a href="#%e5%88%86%e7%b1%bb" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    分类
  </div></a><a href="#%e8%bf%94%e5%9b%9e" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    返回
  </div></a><a href="#this" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>This</em><sup id="this-es5"> </sup><sup id="theargs-array"> </sup>
  </div></a><a href="#eval" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>eval</em>
  </div></a><a href="#new-function" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>new Function</em>
  </div></a><a href="#%e5%81%8f%e5%87%bd%e6%95%b0" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    偏函数
  </div></a><a href="#currying" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    Currying
  </div></a><a href="#%e6%ad%a3%e5%88%99" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    正则<sup id="regexp-es5"> </sup>
  </div></a><a href="#%e5%88%9b%e5%bb%ba-1" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    创建
  </div></a><a href="#%e5%85%83%e5%ad%97%e7%ac%a6" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    元字符
  </div></a><a href="#%e9%9b%86%e5%90%88" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    集合
  </div></a><a href="#%e9%87%8f%e8%af%8d" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    量词
  </div></a><a href="#%e4%bf%ae%e9%a5%b0%e7%ac%a6" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    修饰符
  </div></a><a href="#%e5%8c%b9%e9%85%8d" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    匹配
  </div></a><a href="#%e5%ad%97%e7%ac%a6%e4%b8%b2" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    字符串
  </div></a><a href="#%e5%bc%82%e6%ad%a5" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    异步
  </div></a><a href="#%e5%87%bd%e6%95%b0%e8%8a%82%e6%b5%81" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    函数节流
  </div></a><a href="#%e5%8a%a8%e7%94%bb" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    动画
  </div></a><a href="#%e5%a3%b0%e6%98%8e" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    声明
  </div></a><a href="#%e4%bd%9c%e7%94%a8%e5%9f%9f" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    作用域
  </div></a><a href="#%e5%9f%ba%e6%9c%ac%e7%94%a8%e6%b3%95" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    基本用法
  </div></a><a href="#%e6%9c%ac%e8%b4%a8" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    本质
  </div></a><a href="#%e5%85%88%e4%bd%bf%e7%94%a8%e5%90%8e%e5%a3%b0%e6%98%8e" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    先使用后声明
  </div></a><a href="#dom" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    DOM
  </div></a><a href="#%e8%8a%82%e7%82%b9%e6%a0%91" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    节点树
  </div></a><a href="#document" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    Document
  </div></a><a href="#%e8%8a%82%e7%82%b9" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    节点
  </div></a><a href="#%e4%ba%8b%e4%bb%b6" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    事件
  </div></a><a href="#%e6%97%b6%e9%97%b4" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    时间
  </div></a><a href="#bom" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    BOM
  </div></a><a href="#window" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    Window
  </div></a><a href="#%e7%aa%97%e5%8f%a3" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    窗口
  </div></a><a href="#%e6%b5%8f%e8%a7%88" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    浏览
  </div></a><a href="#trick" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    <em>Trick</em>
  </div></a><a href="#%e8%8e%b7%e5%8f%96%e5%85%a8%e5%b1%80%e5%af%b9%e8%b1%a1" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    获取全局对象
  </div></a><a href="#%e6%b6%88%e9%99%a4%e9%ad%94%e6%9c%af%e5%ad%97%e7%ac%a6%e4%b8%b206-ecmascriptmdmagic-string" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    [消除魔术字符串](06 EcmaScript.md/#magic-string)
  </div></a><a href="#%e9%93%be%e5%bc%8f%e5%86%99%e6%b3%95" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    链式写法<sup id="trick-chain"> </sup>
  </div></a><a href="#%e5%bc%82%e6%ad%a5%e5%a4%84%e7%90%86%e6%b3%9506-ecmascriptmdtrick-asynchronous-processing-es6" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    [异步处理法](06 EcmaScript.md#trick-asynchronous-processing-es6)<sup id="trick-asynchronous-processing"> </sup>
  </div></a><a href="#%e5%8c%85%e8%a3%85%e7%b1%bb%e5%9e%8b" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    包装类型<sup id="trick-primitive-wrapper-types"> </sup>
  </div></a></nav>
            </div>
        </div>

        
          
            <script src="/js/toc.8604a31f519eceda306690e4c19046496d448aae30653aea919df268e9100af7.js" integrity="sha256-hgSjH1GeztowZpDkwZBGSW1Eiq4wZTrqkZ3yaOkQCvc=" defer></script>
          
        
</div>
          </aside>
        </div>

        <footer>
          <div class="ui-grid">
            <aside class="ui-grid-left">
              <div class="ui-content"></div>
            </aside>

            <main class="ui-grid-main"></main>

            <aside class="ui-grid-right">
              <div class="ui-content"></div>
            </aside>
          </div>

          <div class="ui-page-footer ui-footer mt-8 ui-base col-span-full">
            <div class="py-6 flex flex-col gap-1 items-center justify-center">
              <p>
                &copy;&nbsp;Peter&#39;s Blog
              </p>
              <p class="text-xs text-muted">
                <text id="copyright"></text> All rights reserved.
              </p>
            </div>
          </div>
        </footer>
      </div>
    </div>
  </div>

  <button id="scroll-to-top" class="ui-button ui-interactive fixed bottom-4 right-8 z-50 p-4 invisible"
    aria-label="回到顶部"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
  <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 15.75 7.5-7.5 7.5 7.5" />
</svg>
</button>
</body>

</html>