<!DOCTYPE html>
<html lang="zh" noscript>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
<meta property="og:site_name" content="Peter&#39;s Blog" />
<meta name="color-scheme" content="light dark">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">



<link rel="icon" type="image/x-icon" href="/favicon.ico">

<title>07 TypeScript - Peter&#39;s Blog</title>
    <meta name="og:title" content="07 TypeScript - Peter&#39;s Blog" /><meta name="description" content=" …" />
    <meta property="og:description" content=" …" />
    <link rel="canonical" href="/techs/07-typescript/" />
    <meta property="og:url" content="/techs/07-typescript/" /><link rel="alternate" type="application/rss+xml" href="https://PeterFuApps.github.io/index.xml">
    
    <meta property="og:locale" content="zh" /><meta name="generator" content="Hugo 0.146.6">
<style>
  @layer {
    body {
      background: white;
    }
  }
  @media (prefers-color-scheme: dark) {
    @layer {
      body {
        background: black;
      }
    }
  }
</style>







  
  
  
  
    
      
      
      
      

      
      
      
      
      
      
      <link rel="stylesheet" href="/css/tailwind_a16942ad.7b022486e448ebe9100a9476c8d0d7dc2b4ce62c0504d052a327b8a98019247a.css" integrity="sha256-ewIkhuRI6&#43;kQCpR2yNDX3CtM5iwFBNBSoye4qYAZJHo=" crossorigin="anonymous">
      
    
    
  

  
  
  
  
    
      
      
      
      

      
      
      
      
      
      
      <link rel="stylesheet" href="/css/main_434dc2f7.08359d2deb381a15bd26bd1b957cf4328dde8f0426f9470ca946b0d6fe53835a.css" integrity="sha256-CDWdLes4GhW9Jr0blXz0Mo3ejwQm&#43;UcMqUaw1v5Tg1o=" crossorigin="anonymous">
      
    
    
  
<script>
  window.BUILD_HASH = "c7e0eb4a058e18c7b65474546a085dd4"
</script>
































  
    <script src="/js/const.min.a4b940d5f9c396615d28bb05ce96d691327e654eaa866dc9d3ce9ee25cd79751.js" integrity="sha256-pLlA1fnDlmFdKLsFzpbWkTJ&#43;ZU6qhm3J086e4lzXl1E="></script>
  

  
    <script src="/js/i18n.min.ffea6affd01dead5d03d0743c01b5f221b784a2ddfe3edcddd312a2e6590e222.js" integrity="sha256-/&#43;pq/9Ad6tXQPQdDwBtfIht4Si3f4&#43;3N3TEqLmWQ4iI="></script>
  

  
    <script src="/js/util.min.accd3b83a1f2b6c5abb7ad0fe010cd9843aa8c48242d66a94d1dd20d59bc6ad7.js" integrity="sha256-rM07g6HytsWrt60P4BDNmEOqjEgkLWapTR3SDVm8atc="></script>
  








  
    <script src="/js/observer.26f48f94fc94361e5354a27d8223608d797b0a96740f956196ee5482c2284f8d.js" integrity="sha256-JvSPlPyUNh5TVKJ9giNgjXl7CpZ0D5Vhlu5UgsIoT40=" defer></script>
  

  
    <script src="/js/main.02049b5d9722deb350f2b796e24d10ab09f6524a209136fe1cf1d51b17109557.js" integrity="sha256-AgSbXZci3rNQ8reW4k0Qqwn2UkogkTb&#43;HPHVGxcQlVc=" defer></script>
  

  
    <script src="/js/gradient.4e555cb9653273f0a6ada217869c908541c13c0f9c5731590e5497b6cd5eaa89.js" integrity="sha256-TlVcuWUyc/CmraIXhpyQhUHBPA&#43;cVzFZDlSXts1eqok=" defer></script>
  

  
    <script src="/js/theme.365eaab4220e89c235ba91d94d2b507bc83d0b77627c3e63f248434f820894cd.js" integrity="sha256-Nl6qtCIOicI1upHZTStQe8g9C3difD5j8khDT4IIlM0=" defer></script>
  

  
    <script src="/js/scroll.eccb40648d97450f30cdbea14704dee453464e3a0d2ea1c99e3966a46f95abd2.js" integrity="sha256-7MtAZI2XRQ8wzb6hRwTe5FNGTjoNLqHJnjlmpG&#43;Vq9I=" defer></script>
  

  
    <script src="/js/shine.74e94faf6ee3eabd87417b177333a80c3d3a9feca2363260c6f1e8d2c24c6704.js" integrity="sha256-dOlPr27j6r2HQXsXczOoDD06n&#43;yiNjJgxvHo0sJMZwQ=" defer></script>
  









  
    <script src="/js/img.0cd11c8a348322294dd228e0ae5cf4381285da5a7cd15e87aa74b1a9c0ca8063.js" integrity="sha256-DNEcijSDIilN0ijgrlz0OBKF2lp80V6HqnSxqcDKgGM=" async></script>
  




  <script src="/js/tex-svg.js" async></script>


</head>

<body class="h-screen flex flex-col overflow-hidden">
  
  <div class="flex-1 overflow-hidden">
    <div class="h-full w-full overflow-y-auto relative" id="scroll-container">
      
<input type="checkbox" id="theme-menu-toggle" class="hidden">


<nav class="ui-page-nav ui-panel-base ui-navbar sticky top-0 z-40 overflow-x-clip">
    <div class="ui-grid">
        <div class="col-span-full flex flex-col sm:gap-4 sm:flex-row items-center justify-between">
            <div class="flex items-center sm:w-full max-sm:mt-4 w-auto">
                <h1 class="flex items-center">
                    <a href="/" class="flex items-center w-full">
                        
                        
                            <span class="site-title">Peter&#39;s Blog</span>
                        
                    </a>
                </h1>
                
                
                <div class="ml-2">
                    <div class="ui-tooltip bottom rounded-full" data-tooltip="主题切换">
                        <label for="theme-menu-toggle" class="flex ui-button-concealed ui-interactive ui-menu-item p-1 ui-interactive cursor-pointer">
                            <i class="dark-hidden inline-block icon js-sun"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" />
</svg>
</i>
                            <i class="dark-inline-block hidden icon js-moon"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
    <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z" />
</svg>
</i>
                        </label>
                    </div>
                </div>
            </div>

            <ul class="nav-menu flex gap-2 p-0 w-full md:w-auto justify-center sm:justify-end" id="nav-content">
                
                
                    <li>
                        
                        

                        <div class="ui-tooltip bottom rounded-full"  data-tooltip="首页 Home">
                            <a href="/" 
                                draggable="false"
                                
                                    class="ui-button-concealed ui-interactive ui-menu-item"
                                
                                
                                >
                                
                                    <i class="icon"><svg width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M10 18V15C10 13.8954 10.8954 13 12 13V13C13.1046 13 14 13.8954 14 15V18" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M2 8L11.7317 3.13416C11.9006 3.04971 12.0994 3.0497 12.2683 3.13416L22 8" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M20 11V19C20 20.1046 19.1046 21 18 21H6C4.89543 21 4 20.1046 4 19V11" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</i>
                                
                            </a>
                            
                            
                        </div>
                    </li>
                
                    <li>
                        
                        
                            
                        

                        <div class="ui-tooltip bottom rounded-full"  data-tooltip="技术 Tech">
                            <a href="/techs/" 
                                draggable="false"
                                
                                    class="ui-button ui-menu-item ui-interactive"
                                
                                
                                aria-current="true">
                                
                                    <i class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pc-case-icon lucide-pc-case"><rect width="14" height="20" x="5" y="2" rx="2"/><path d="M15 14h.01"/><path d="M9 6h6"/><path d="M9 10h6"/></svg></i>
                                
                            </a>
                            
                            
                        </div>
                    </li>
                
                    <li>
                        
                        

                        <div class="ui-tooltip bottom rounded-full"  data-tooltip="文章 Docs">
                            <a href="/docs/" 
                                draggable="false"
                                
                                    class="ui-button-concealed ui-interactive ui-menu-item"
                                
                                
                                >
                                
                                    <i class="icon"><svg width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M2.90602 17.505L5.33709 3.71766C5.5289 2.62987 6.56621 1.90354 7.654 2.09534L19.4717 4.17912C20.5595 4.37093 21.2858 5.40824 21.094 6.49603L18.6629 20.2833C18.4711 21.3711 17.4338 22.0975 16.346 21.9057L4.52834 19.8219C3.44055 19.6301 2.71421 18.5928 2.90602 17.505Z" stroke="currentColor"/>
<path d="M8.92902 6.38184L16.8075 7.77102" stroke="currentColor" stroke-linecap="round"/>
<path d="M8.23444 10.3213L16.1129 11.7105" stroke="currentColor" stroke-linecap="round"/>
<path d="M7.53986 14.2607L12.4639 15.129" stroke="currentColor" stroke-linecap="round"/>
</svg>
</i>
                                
                            </a>
                            
                            
                        </div>
                    </li>
                
                    <li>
                        
                        

                        <div class="ui-tooltip bottom rounded-full" >
                            <a href="/archives/" 
                                draggable="false"
                                
                                    class="ui-button-concealed ui-interactive ui-menu-item"
                                
                                
                                >
                                
                                    <i class="icon"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
    <path stroke-linecap="round" stroke-linejoin="round" d="m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z" />
</svg>
</i>
                                
                            </a>
                            
                            
                                 
                            <div class="ui-tooltip-menu">
                                
                                    
                                    
                                
                                <a class="ui-tooltip-menu-item" href="/archives/" 
                                draggable="false">
                                    
                                    <i class="icon size-4"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
    <path stroke-linecap="round" stroke-linejoin="round" d="m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z" />
</svg>
</i>
                                    
                                    归档 Archive
                                </a>
                                
                                    
                                    
                                
                                <a class="ui-tooltip-menu-item" href="/categories/" 
                                draggable="false">
                                    
                                    <i class="icon size-4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-folder-icon lucide-folder"><path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/></svg></i>
                                    
                                    分类 Categories
                                </a>
                                
                                    
                                    
                                
                                <a class="ui-tooltip-menu-item" href="/series/" 
                                draggable="false">
                                    
                                    <i class="icon size-4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bookmark-icon lucide-bookmark"><path d="m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"/></svg></i>
                                    
                                    系列 Series
                                </a>
                                
                                    
                                    
                                
                                <a class="ui-tooltip-menu-item" href="/tags/" 
                                draggable="false">
                                    
                                    <i class="icon size-4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-tag-icon lucide-tag"><path d="M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z"/><circle cx="7.5" cy="7.5" r=".5" fill="currentColor"/></svg></i>
                                    
                                    标签 Tags
                                </a>
                                
                            </div>
                            
                        </div>
                    </li>
                
                    <li>
                        
                        

                        <div class="ui-tooltip bottom rounded-full"  data-tooltip="关于 About">
                            <a href="/about/about/" 
                                draggable="false"
                                
                                    class="ui-button-concealed ui-interactive ui-menu-item"
                                
                                
                                >
                                
                                    <i class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-heart-icon lucide-file-heart"><path d="M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v2"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M10.29 10.7a2.43 2.43 0 0 0-2.66-.52c-.29.12-.56.3-.78.53l-.35.34-.35-.34a2.43 2.43 0 0 0-2.65-.53c-.3.12-.56.3-.79.53-.95.94-1 2.53.2 3.74L6.5 18l3.6-3.55c1.2-1.21 1.14-2.8.19-3.74Z"/></svg></i>
                                
                            </a>
                            
                            
                        </div>
                    </li>
                
                    <li>
                        
                        

                        <div class="ui-tooltip bottom rounded-full"  data-tooltip="搜索 Search">
                            <a href="/search/" 
                                draggable="false"
                                
                                    class="ui-button-concealed ui-interactive ui-menu-item"
                                
                                
                                >
                                
                                    <i class="icon"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M21 21L15.8033 15.8033M15.8033 15.8033C17.1605 14.4461 18 12.5711 18 10.5C18 6.35786 14.6421 3 10.5 3C6.35786 3 3 6.35786 3 10.5C3 14.6421 6.35786 18 10.5 18C12.5711 18 14.4461 17.1605 15.8033 15.8033Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</i>
                                
                            </a>
                            
                            
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>
</nav>


<div class="fixed inset-0 z-[9999] 
            opacity-0 invisible
            transition-all duration-200 ease-in-out
            flex items-center justify-center pointer-events-none"
     id="theme-menu">
    
    
    <div class="ui-card ui-panel-material p-4 w-full max-w-xs relative pointer-events-auto">
        
        
        <div class="flex justify-between items-center mb-4">
            <div class="flex items-center gap-0.5">
                <h3 class="text-sm font-semibold">主题设置</h3>
                <div class="ui-tooltip rounded-full" data-tooltip="自动主题切换">
                    <button class="ui-button-concealed ui-interactive rounded-full p-1 selected" id="auto-theme-toggle" >
                        <i class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun-moon-icon lucide-sun-moon"><path d="M12 8a2.83 2.83 0 0 0 4 4 4 4 0 1 1-4-4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.9 4.9 1.4 1.4"/><path d="m17.7 17.7 1.4 1.4"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.3 17.7-1.4 1.4"/><path d="m19.1 4.9-1.4 1.4"/></svg>
</i>
                    </button>
                </div>
                <div class="ui-tooltip rounded-full" data-tooltip="随机主题色">
                    <div class="ui-button-concealed ui-interactive rounded-full p-1" id="random-color-theme">
                        <i class="icon p-[2.2px]"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shuffle-icon lucide-shuffle"><path d="m18 14 4 4-4 4"/><path d="m18 2 4 4-4 4"/><path d="M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22"/><path d="M2 6h1.972a4 4 0 0 1 3.6 2.2"/><path d="M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45"/></svg></i>
                    </div>
                </div>
            </div>
            <label for="theme-menu-toggle" class="ui-button-concealed ui-interactive rounded-full p-1">
                <div class="size-6"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" >
  <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
</svg>
</div>
            </label>
        </div>

       <div class="flex gap-2 mb-4"><div class="ui-tooltip flex-1" data-tooltip="浅色模式 Light" >
                <button class="data-theme-btn ui-button-concealed ui-interactive p-2 flex flex-col items-center gap-1 w-full" data-theme-mode="light">
                    <span class="size-4 inline-block"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" />
</svg>
</span>
                    <span class="text-xs">Light</span>
                </button>
            </div><div class="ui-tooltip flex-1" data-tooltip="深色模式 Dark" >
                <button class="data-theme-btn ui-button-concealed ui-interactive p-2 flex flex-col items-center gap-1 w-full" data-theme-mode="dark">
                    <span class="size-4 inline-block"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
    <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z" />
</svg>
</span>
                    <span class="text-xs">Dark</span>
                </button>
            </div></div>

        
        <div class="grid grid-cols-3 gap-2" id="color-theme-grid">
            
        </div>
    </div>
</div>
      <div class="pt-4 flex flex-col justify-between ui-main-content">
        <div class="ui-grid">
          <aside class="ui-grid-left">
            <div class="ui-content">
    

</div>
          </aside>

          <main class="ui-grid-main"><article class="">

    <div class="ui-card mb-4">
        



<figure class="relative min-h-20">
  <div title="" class="block w-full ui-no-image">
    
  </div>
</figure>

        <header class="ui-header p-4">
            <h1 class="text-2xl">07 TypeScript</h1>
        </header>
    
        <div class="ui-body p-4">










<div class="content-isolation-wrapper markdown">
    <h1 id="typescript">Typescript</h1>
<p><em><strong>T</strong>ype</em><em>S</em>*cript* - <em><strong>TS</strong></em> ，是一种由微软开发的自由和开源的编程语言。</p>
<div class="ui-codeblock">
    
    <pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">flowchart LR

%%--level 1
0(&#34;Typescript&#34;)
1[&#34;TS是什么&#34;]
2[&#34;TS的基本数据类型&#34;]
3[&#34;Class&#34;]
4[&#34;断言与类型守卫&#34;]
5[&#34;范型&#34;]
6[&#34;&lt;ruby&gt;联合类型&lt;rt&gt;Union Type&lt;/rt&gt;&lt;/ruby&gt;&#34;]
7[&#34;别名与接口&#34;]
8[&#34;常用技巧&#34;]
%%--level 0 relation
1---0;2---0;3---0;4---0;
0---5;0---6;0---7;0---8

subgraph &amp;nbsp
%%--level 1
1.1[&#34;TS和JS的关系&#34;]
1.2[&#34;安装TS&#34;]
1.3[&#34;编译&#34;]
%%--level 1 relation
1.1---1;1.2---1;1.3---1

%%--level 2
2.1[&#34;基本类型&#34;]
2.2[&#34;引用类型&#34;]
2.3[&#34;特殊类型&#34;]
2.4[&#34;其它类型&#34;]
%%--level 2 relation
2.1---2;2.2---2;2.3---2;2.4---2;

%%--level 3
3.1[&#34;基本方法&#34;]
3.2[&#34;私有字段&#34;]
3.3[&#34;只读属性&#34;]
3.4[&#34;继承&#34;]
3.5[&#34;修饰符&#34;]
3.6[&#34;abstract&#34;]
3.7[&#34;重写与重载&#34;]
%%--level 3 relation
3.1---3;3.2---3;3.3---3;3.4---3;3.5---3;3.6---3;3.7---3;

%%--level 4
4.1[&#34;TS断言&#34;]
4.2[&#34;类型守卫&#34;]
%%--level 4 relation
4.1---4;4.2---4;
end

subgraph &amp;nbsp&amp;nbsp
%%--level 5
5.1[&#34;语法&#34;]
5.2[&#34;多类型传参&#34;]
5.3[&#34;接口&#34;]
5.4[&#34;类&#34;]
5.5[&#34;类别名&#34;]
5.6[&#34;默认参数&#34;]
5.7[&#34;常用字母&#34;]
%%--level 5 relation
5---5.1;5---5.2;5---5.3;5---5.4;5---5.5;5---5.6;5---5.7

%%--level 6
6.1[&#34;可辨识联合&#34;]
%%--level 6 relation
6---6.1

%%--level 7
7.1[&#34;类型别名&#34;]
7.2[&#34;接口&#34;]
7.3[&#34;type和interface区别&#34;]
%%--level 7 relation
7---7.1;7---7.2;7---7.3

%%--level 8
8.1[&#34;extends&#34;]
8.2[&#34;tepeof&#34;]
8.3[&#34;keyof&#34;]
8.4[&#34;索引访问操作符&#34;]
8.5[&#34;in&#34;]
8.6[&#34;infer&#34;]
8.7[&#34;...&#34;]
%%--level 8 relation
8---8.1;8---8.2;8---8.3;8---8.4;8---8.5;8---8.6;8---8.7
end

classDef transparent fill:none,stroke:none
class &amp;nbsp,&amp;nbsp&amp;nbsp transparent</code></pre>
</div>
<p><em>TypeScript</em> 是 <em>JavaScript</em> 的 <strong>超集</strong> ，简单的说就是在 <em>JavaScript</em> 的基础上加入了 <strong>类型系统</strong><sup><em>type system</em></sup>，让每个参数都有明确的意义，从而带来了更加 <strong>智能</strong> 的提示。</p>
<p><em>TypeScript</em> 属于<strong>强类型</strong>语言，所以对于项目而言，会使代码更加规范，从而解决了大型项目代码的复杂性。</p>
<p><em>TypeScript</em> 可以分为两部份：</p>
<ol>
<li><em>EcmaScript</em> 的高阶语法糖</li>
</ol>
<p>主要包括不同版本的 <em>JS</em> 相互兼容、<em>Class</em> 的 <em>implements</em> 实现接口继承、 <em>abstract</em> 实现抽象类、以及目前还停留在 <em>stage2</em> 的 <em>@decorator</em><sup>编译时需添加 <code>--experimentalDecorators</code> 参数</sup></p>
<p>——这部分通过 <em>Babel</em> 也可实现相同效果</p>
<ol start="2">
<li>另一部分是强类型的类型系统，主要包括了 <em>Type</em>^类型^, <em>Assertion</em>^断言^, <em>Guards</em>^类型守卫^, <em>Interfaces</em>^接口^, <em>Generics</em>^泛型^。另外还有一些交叉知识</li>
</ol>
<p>第一部分将会被自动转换，比如 <em>ES2022</em> 中的 <em>#</em> 编译为低版本时由 <em>WeakMap(this, privateKeys)</em> 实现；而第二部分不会被编译为 <em>JavaScript</em> ，在输入代码时进行动态类型检查。搞懂这两部分关系，学习就轻松多了。</p>
<p>对于一般的面向对象语言，继承有两种：接口继承<sup><em>interface inheritance</em></sup> 和 实现继承<sup><em>implement inheritance</em></sup> ，<em>ES</em> 只实现了后者，而 <em>TS</em> 通过 <em>interface</em> 关键字解决了这个问题 。另外 <em>TS</em> 又从 <em>C++, Haskell</em> 借鉴了一部分的语法。<em>TS</em> 弥补了大量不足，使得 <em>JS</em> 成为了一门强大的语言。</p>
<p>浏览器不能直接识别 <em>TypeScript</em> ，所以在编译的时候，<em>TypeScript</em> 文件会先编译为 <em>JavaScript</em> 文件。</p>
<div class="ui-codeblock">
    
    <pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">graph LR
T--&gt;|编译|J1
J1--&gt;|打包|J2
J2--&gt;|部署|C

T(&#34;TypeScript&lt;tt&gt;&lt;div style="&#39;border:1px" dashed;padding:1em;margin:.5em&#39;&gt;a.ts&lt;br&gt;b.ts&lt;br&gt;c.ts&lt;/div&gt;&lt;/tt&gt;&#34;)
J1(&#34;JavaScript&lt;tt&gt;&lt;div style="&#39;border:1px" dashed;padding:1em;margin:.5em&#39;&gt;a.js&lt;br&gt;b.js&lt;br&gt;c.js&lt;/div&gt;&lt;/tt&gt;&#34;)
J2(&#34;JavaScript&lt;tt&gt;&lt;div style="&#39;border:1px" dashed;padding:1em;margin:.5em&#39;&gt;&lt;br&gt;main.js&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/tt&gt;&#34;)
C(&#34;Chrome&lt;tt&gt;&lt;div style="&#39;border:1px" dashed;padding:1em;margin:.5em&#39;&gt;&lt;br&gt;main.js&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/tt&gt;&#34;)</code></pre>
</div>
<h2 id="usage使用"><em>Usage</em>^使用^</h2>
<ol>
<li>安装</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ npm install -g typescript 
</span></span><span class="line"><span class="cl"> //或
</span></span><span class="line"><span class="cl">$ yarn global add typescript</span></span></code></pre></div>
</div>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="c1">// package.json
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="s2">&#34;devDependencies&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;typescript&#34;</span><span class="p">:</span> <span class="s2">&#34;^4.7.4&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;jslint&#34;</span><span class="p">:</span> <span class="s2">&#34;^0.12.1&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>然后运行 <code>(npm install) &amp;&amp; (npx tsc --init)</code> 进行初始化。现在不需要单独安装 <code>tsc</code> 了。</p>
<ol start="2">
<li>查看版本</li>
</ol>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ tsc -v</span></span></code></pre></div></div>
</div>
<ol start="3">
<li>编译</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ tsc test.ts
</span></span><span class="line"><span class="cl"><span class="c1"># test.ts =&gt; test.js</span></span></span></code></pre></div>
</div>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="c1">// package.json
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="s2">&#34;scripts&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;start&#34;</span><span class="p">:</span> <span class="s2">&#34;tsc &amp;&amp; (node out/entry.js)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;init&#34;</span><span class="p">:</span> <span class="s2">&#34;clear &amp;&amp; (npm install) &amp;&amp; (npx tsc --init) &amp;&amp; (npm init @eslint/config)&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="err">,</span></span></span></code></pre></div>
</div>
<ol start="4">
<li>参数</li>
</ol>
<p>使用 <code>-t</code> 指定编译后的 <em>ES</em> 版本，使用 <code>-lib</code> 指定库</p>
<p><kbd>:memo: <em>Note</em></kbd> <code>-lib</code> 参数接受一个数组 <em>list</em> 。</p>
<p>可以在 Webstrom中指定单个 Typescript 文件的编译，参数设置如下：</p>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ -t ES2020 --lib: <span class="o">[</span><span class="s2">&#34;ES2020&#34;</span>, <span class="s2">&#34;DOM&#34;</span><span class="o">]</span> --alwaysStrict test.ts</span></span></code></pre></div></div>
</div>
<ol start="5">
<li>在线编译</li>
</ol>
<p>方便起见，可以使用线上的编辑器：<a href="https://www.typescriptlang.org/play"><em>TypeScript Playground</em></a> 。</p>
<p>并且还可以看看生成对应的 <em>TS</em> 转化 <em>ES5</em> ，<em>ES6</em> 之后的代码。</p>
<h2 id="type类型"><em>Type</em>^类型^</h2>
<p><em>TypeScript</em> 的数据类型简单可以分为以下几类：</p>
<ol>
<li>基本类型</li>
</ol>
<p><em>string</em>, <em>number</em>, <em>boolean</em>, <em>symbol</em>, <em>bigint</em>, <em>null</em>, <em>undefined</em></p>
<ol start="2">
<li>引用类型</li>
</ol>
<p><em>array</em>,  <em>Tuple</em><sup>元组</sup>,  <em>object</em><sup>包含<em>Object</em>和*{}*</sup>, <em>function</em></p>
<ol start="3">
<li>特殊类型</li>
</ol>
<p><em>any</em>, <em>unknow</em>, <em>void</em>, <em>nerver</em>, <em>enum</em></p>
<ol start="4">
<li>别名与接口</li>
</ol>
<p><em>type</em>, <em>interface</em></p>
<ol start="5">
<li>其他类型</li>
</ol>
<p><em>类型推理</em>, <em>字面量类型</em>, <em>交叉类型</em></p>
<p>TypeSc<em>r</em>ipt 只会在编译阶段对类型进行静态检查，如果发现有错误，编译时就会报错。而在运行时，编译生成的 <em>JS</em> 与普通的 <em>JavaScript</em> 文件一样，并不会进行类型检查。</p>
<h3 id="basic基本类型"><em>Basic</em>^基本类型^</h3>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">//字符串
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">str</span>: <span class="kt">string</span> <span class="o">=</span> <span class="s2">&#34;Domes&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 数字
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">num</span>: <span class="kt">number</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//布尔
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="kt">bool</span><span class="o">:</span> <span class="kr">boolean</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//symbol
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">sym</span>: <span class="kt">symbol</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// TS2585: &#39;Symbol&#39; only refers to a type, but is being used as a value here. Do you need to change your target library? Try changing the &#39;lib&#39; compiler option to es2015 or later.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//bigint
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">big</span>: <span class="kt">bigint</span> <span class="o">=</span> <span class="mi">10</span><span class="nx">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// TS2737: BigInt literals are not available when targeting lower than ES2020
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">//null
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">nu</span>: <span class="kt">null</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//undefined
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">un</span>: <span class="kt">undefined</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p><kbd>:memo: <em>Note</em></kbd></p>
<ol>
<li>
<p><em>null</em> 和 <em>undefined</em> 两个类型一旦赋值上，就不能在赋值给任何其他类型</p>
</li>
<li>
<p><em>symbol</em> 是独一无二的，假设再定义一个 <code>sym1</code> ，那么</p>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">sym</span> <span class="o">=</span> <span class="nx">Symbol</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">sym1</span> <span class="o">=</span> <span class="nx">Symbol</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">sym</span> <span class="o">===</span> <span class="nx">sym1</span><span class="p">;</span> <span class="c1">//false
</span></span></span></code></pre></div>
</div>
<h3 id="reference引用类型"><em>Reference</em>^引用类型^</h3>
<h4 id="array数组"><em>Array</em>^数组^</h4>
<p>两种使用方式：</p>
<ol>
<li>
<p>T + <code>[]</code></p>
</li>
<li>
<p><code>Array&lt;T&gt;</code>：泛型*^genertic^* 语法</p>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">arr1</span>: <span class="kt">number</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">arr2</span>: <span class="kt">Array</span><span class="p">&lt;</span><span class="nt">number</span><span class="p">&gt;</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">arr3</span>: <span class="kt">Array</span><span class="p">&lt;</span><span class="nt">number</span><span class="p">&gt;</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1">// TS2322: Type &#39;string&#39; is not assignable to type &#39;number&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// 支持多种类型，使用｜符号
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">arr4</span>: <span class="kt">Array</span><span class="p">&lt;</span><span class="nt">number</span> <span class="err">|</span> <span class="na">string</span><span class="p">&gt;</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span> <span class="c1">//ok
</span></span></span></code></pre></div>
</div>
<h4 id="tuple元组"><em>Tuple</em>^元组^</h4>
<p><em>Tuple</em> 可以说是 <em>Array</em> 的一种特殊情况。</p>
<p><code>arr3</code> 的类型可以是 <em>string</em> 也可以是 <em>number</em> ，但对每个元素没有作出具体的限制。</p>
<p>那么 <em>Tuple</em> 的作用就是限制 <strong>元素的类型</strong> 并且 <strong>限制个数</strong> 的数组，同时 <code>Tuple</code>这个概念只存在于 <em>TS</em> ，在 <em>JS</em> 上是不存在的。</p>
<p>这里存在一个问题：在 <em>TS</em> 中，是允许对 <em>Tuple</em> 扩增的（也就是允许使用 <em>push</em> 方法），但在 <strong>访问上不允许</strong> 。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">t</span><span class="o">:</span> <span class="p">[</span><span class="kt">number</span><span class="p">,</span> <span class="kt">string</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">];</span> <span class="c1">// ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">t1</span><span class="o">:</span> <span class="p">[</span><span class="kt">number</span><span class="p">,</span> <span class="kt">string</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1">// TS2322: Type &#39;number&#39; is not assignable to type &#39;string&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">t2</span><span class="o">:</span> <span class="p">[</span><span class="kt">number</span><span class="p">,</span> <span class="kt">string</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1">// TS2322: Type &#39;[number]&#39; is not assignable to type &#39;[number, string]&#39;.  Source has 1 element(s) but target requires 2.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">t3</span><span class="o">:</span> <span class="p">[</span><span class="kt">number</span><span class="p">,</span> <span class="kt">string</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">];</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1">// Source has 3 element(s) but target allows only 2.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">t5</span><span class="o">:</span> <span class="p">[</span><span class="kt">number</span><span class="p">,</span> <span class="kt">string</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">];</span> <span class="c1">// ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">t</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="c1">// 允许通过push对tuple扩增，但并不能被访问
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="c1">// [1, &#39;2&#39;, 2]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span>  <span class="nx">t</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="c1">// ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">t</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="c1">// ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">t</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1">// TS2493: Tuple type &#39;[number, string]&#39; of length &#39;2&#39; has no element at index &#39;2&#39;.
</span></span></span></code></pre></div>
</div>
<p><em>TypeScript 4.0</em> 开始，支持为元组类型设置标签：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">addPerson</span><span class="p">(...</span><span class="nx">args</span><span class="o">:</span> <span class="p">[</span><span class="nx">name</span>: <span class="kt">string</span><span class="p">,</span> <span class="nx">age</span>: <span class="kt">number</span><span class="p">])</span><span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Person info: name: </span><span class="si">${</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="sb">, age: </span><span class="si">${</span><span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>之后，当我们使用 <code>addPerson</code> 方法时，<em>TypeScript</em> 的智能提示就会变得更加友好。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// 未使用标签的智能提示
</span></span></span><span class="line"><span class="cl"><span class="c1">// addPerson(args_0: string, args_1: number): void
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">addPerson</span><span class="p">(...</span><span class="nx">args</span><span class="o">:</span> <span class="p">[</span><span class="kt">string</span><span class="p">,</span> <span class="kt">number</span><span class="p">])</span><span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Person info: name: </span><span class="si">${</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="sb">, age: </span><span class="si">${</span><span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="sb">`</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 设置类型标签后的智能提示
</span></span></span><span class="line"><span class="cl"><span class="c1">// addPerson(name: string, age: number): void
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">addPerson2</span><span class="p">(...</span><span class="nx">args</span><span class="o">:</span> <span class="p">[</span><span class="nx">name</span>: <span class="kt">string</span><span class="p">,</span> <span class="nx">age</span>: <span class="kt">number</span><span class="p">])</span><span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Person info: name: </span><span class="si">${</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="sb">, age: </span><span class="si">${</span><span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> 
</span></span></code></pre></div>
</div>
<h4 id="object对象"><em>Object</em>^对象^</h4>
<h5 id="object首字母小写"><em>object</em><sup>首字母小写</sup></h5>
<p><em>object</em> 表示非原始类型。在定义上直接使用 <em>object</em> 是可以的，但不能更改对象的属性，原因是并没有使对象的内部具体的属性做限制，所以需要使用 <code>{}</code> 来定义内部类型</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">obj1</span>: <span class="kt">object</span> <span class="o">=</span> <span class="p">{</span><span class="nx">a</span>: <span class="kt">1</span><span class="p">,</span> <span class="nx">b</span>: <span class="kt">2</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj1</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1">// Property &#39;a&#39; does not exist on type &#39;object&#39;.(2339)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">obj2</span><span class="o">:</span> <span class="p">{</span> <span class="nx">a</span>: <span class="kt">number</span><span class="p">,</span> <span class="nx">b</span>: <span class="kt">number</span> <span class="p">}</span> <span class="o">=</span> <span class="p">{</span><span class="nx">a</span>: <span class="kt">1</span><span class="p">,</span> <span class="nx">b</span>: <span class="kt">2</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj2</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1">// ok
</span></span></span></code></pre></div>
</div>
<h5 id="object首字母大写"><em>Object</em>^首字母大写^</h5>
<p><em>Object</em> 表示 <em>Object</em> 类的实例，也即除了 <em>null</em> 和 <em>undefined</em> 的所有类型。（这是因为， <em>Function</em> 类型也是由 <em>Object</em> 继承而来 ）</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">obj</span>: <span class="kt">Object</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1">// Type &#39;null&#39; is not assignable to type &#39;Object&#39;.(2322)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1">// Type &#39;undefined&#39; is not assignable to type &#39;Object&#39;.(2322)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span> <span class="o">=</span> <span class="s2">&#34;a&#34;</span><span class="p">;</span> <span class="c1">// ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="c1">// ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span> <span class="o">=</span> <span class="p">{};</span> <span class="c1">// ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span> <span class="o">=</span> <span class="nx">Symbol</span><span class="p">()</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1">// BigInt literals are not available when targeting lower than ES2020.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span> <span class="o">=</span> <span class="mi">10</span><span class="nx">n</span> <span class="c1">//ok
</span></span></span></code></pre></div>
</div>
<p><kbd>:memo: <em>Note</em></kbd></p>
<ol>
<li><em>Object</em> 接口定义了 <em>Object.prototype</em> 原型对象上的属性</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// node_modules/typescript/lib/lib.es5.d.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">interface</span> <span class="nb">Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">constructor</span><span class="o">:</span> <span class="nb">Function</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">toString</span><span class="p">()</span><span class="o">:</span> <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">toLocaleString</span><span class="p">()</span><span class="o">:</span> <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">valueOf</span><span class="p">()</span><span class="o">:</span> <span class="nb">Object</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">v</span>: <span class="kt">PropertyKey</span><span class="p">)</span><span class="o">:</span> <span class="kr">boolean</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">isPrototypeOf</span><span class="p">(</span><span class="nx">v</span>: <span class="kt">Object</span><span class="p">)</span><span class="o">:</span> <span class="kr">boolean</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">propertyIsEnumerable</span><span class="p">(</span><span class="nx">v</span>: <span class="kt">PropertyKey</span><span class="p">)</span><span class="o">:</span> <span class="kr">boolean</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<ol start="2">
<li><em>ObjectConstructor</em> 接口定义了 <em>Object</em> 类的属性</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// node_modules/typescript/lib/lib.es5.d.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">interface</span> <span class="nx">ObjectConstructor</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/** Invocation via `new` */</span>
</span></span><span class="line"><span class="cl">  <span class="k">new</span><span class="p">(</span><span class="nx">value?</span>: <span class="kt">any</span><span class="p">)</span><span class="o">:</span> <span class="nb">Object</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/** Invocation via function calls */</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nx">value?</span>: <span class="kt">any</span><span class="p">)</span><span class="o">:</span> <span class="kt">any</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">readonly</span> <span class="nx">prototype</span>: <span class="kt">Object</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nx">o</span>: <span class="kt">any</span><span class="p">)</span><span class="o">:</span> <span class="kt">any</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// ···
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">declare</span> <span class="kd">var</span> <span class="nb">Object</span><span class="o">:</span> <span class="nx">ObjectConstructor</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p><em>Object</em> 类的所有实例都继承了 <em>Object</em> 接口中的所有属性。</p>
<h5 id="空对象"><em>{}</em>^空对象^</h5>
<p>类型描述了一个没有成员的对象。当你试图访问这样一个对象的任意属性时，<em>TypeScript</em> 会产生一个编译时错误。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// Type {}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Error: Property &#39;prop&#39; does not exist on type &#39;{}&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">prop</span> <span class="o">=</span> <span class="s2">&#34;semlinker&#34;</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p>但是，你仍然可以使用在 <em>Object</em> 类型上定义的所有属性和方法，这些属性和方法可通过 <em>JavaScript</em> 的原型链隐式地使用：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// Type {}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// &#34;[object Object]&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span></span></span></code></pre></div>
</div>
<h4 id="function函数"><em>Function</em>^函数^</h4>
<div class="ui-codeblock">
    
    <pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">classDiagram
  direction LR
  JavaScript --&gt; TypeScript
  
  class TypeScript{
    含有类型
    箭头函数
    函数类型
    必填和可选参数
    默认参数
    剩余参数
    函数重载
  }
     
  class JavaScript{
    无类型
    箭头函数（ES2015）
    无函数类型
    所有参数都是可选的
    默认参数
    剩余参数
    无函数重载
  }</code></pre>
</div>
<h5 id="定义函数">定义函数</h5>
<p>有两种定义方式：一种为 <em>function</em>， 另一种为 <strong>箭头函数</strong> 。</p>
<p>在书写的时候，也可以写入返回值的类型，如果写入，则 <strong>必须</strong> 要有对应类型的返回值，但通常情况下可以 <strong>省略</strong> ，因为 <em>TS</em> 的类型推断功能够正确推断出返回值类型。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">setName1</span><span class="p">(</span><span class="nx">name</span>: <span class="kt">string</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;hello&#34;</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">setName1</span><span class="p">(</span><span class="s2">&#34;Domes&#34;</span><span class="p">);</span> <span class="c1">// &#34;hello&#34;,  &#34;Domes&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">setName2</span><span class="p">(</span><span class="nx">name</span>: <span class="kt">string</span><span class="p">)</span><span class="o">:</span> <span class="kt">string</span> <span class="p">{</span> <span class="c1">//error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// TS2355: A function whose declared type is neither &#39;void&#39; nor &#39;any&#39; must return a value.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;hello&#34;</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">setName2</span><span class="p">(</span><span class="s2">&#34;Domes&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">setName3</span><span class="p">(</span><span class="nx">name</span>: <span class="kt">string</span><span class="p">)</span><span class="o">:</span> <span class="kt">string</span> <span class="p">{</span> <span class="c1">//error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;hello&#34;</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// TS2322: Type &#39;number&#39; is not assignable to type &#39;string&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">setName3</span><span class="p">(</span><span class="s2">&#34;Domes&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">setName4</span><span class="p">(</span><span class="nx">name</span>: <span class="kt">string</span><span class="p">)</span><span class="o">:</span> <span class="kt">string</span> <span class="p">{</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;hello&#34;</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">setName4</span><span class="p">(</span><span class="s2">&#34;Domes&#34;</span><span class="p">);</span> <span class="c1">// &#34;hello&#34;,  &#34;Domes&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// 箭头函数与上同理，不过写在内部
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">setName5</span> <span class="o">=</span> <span class="p">(</span><span class="nx">name</span>: <span class="kt">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;hello&#34;</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">setName5</span><span class="p">(</span><span class="s2">&#34;Domes&#34;</span><span class="p">)</span> <span class="c1">// &#34;hello&#34;,  &#34;Domes&#34;
</span></span></span></code></pre></div>
</div>
<h5 id="参数类型">参数类型</h5>
<ol>
<li>可选参数： 如果函数要配置可有可无的参数时，可以在形参数后加上 <code>?</code> 实现，注意可选参数要放在最后面</li>
</ol>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">TS1016</span><span class="o">:</span> <span class="nx">A</span> <span class="nx">required</span> <span class="nx">parameter</span> <span class="nx">cannot</span> <span class="nx">follow</span> <span class="nx">an</span> <span class="nx">optional</span> <span class="nx">parameter</span><span class="p">.</span></span></span></code></pre></div></div>
</div>
<ol start="2">
<li>
<p>默认参数：函数内可以自己设定其默认参数，用 <code>=</code> 实现</p>
</li>
<li>
<p>剩余参数：仍可以使用扩展运算符 <code>...</code></p>
</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="cm">/* 1. 可选参数 */</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">setInfo1</span> <span class="o">=</span> <span class="p">(</span><span class="nx">name</span><span class="o">:</span> <span class="nx">string</span><span class="p">,</span> <span class="nx">age</span><span class="o">?:</span> <span class="nx">number</span><span class="p">)</span> <span class="p">=&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">age</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nx">setInfo1</span><span class="p">(</span><span class="s1">&#39;Domesy&#39;</span><span class="p">)</span> <span class="c1">//&#34;Domesy&#34;,  undefined
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">setInfo1</span><span class="p">(</span><span class="s1">&#39;Domesy&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="c1">//&#34;Domesy&#34;,  7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* 2. 默认参数 */</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">setInfo2</span> <span class="o">=</span> <span class="p">(</span><span class="nx">name</span><span class="o">:</span> <span class="nx">string</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="nx">number</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span> <span class="p">=&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">age</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nx">setInfo2</span><span class="p">(</span><span class="s1">&#39;Domesy&#39;</span><span class="p">)</span> <span class="c1">//&#34;Domesy&#34;,  11
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">setInfo2</span><span class="p">(</span><span class="s1">&#39;Domesy&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="c1">//&#34;Domesy&#34;,  7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* 3. 剩余参数 */</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">allCount</span> <span class="o">=</span> <span class="p">(...</span><span class="nx">numbers</span><span class="o">:</span> <span class="nx">number</span><span class="p">[])</span> <span class="p">=&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`数字总和为：</span><span class="si">${</span><span class="nx">numbers</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">val</span><span class="p">,</span> <span class="nx">item</span><span class="p">)</span> <span class="p">=&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="nx">val</span> <span class="o">+=</span> <span class="nx">item</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">allCount</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="c1">//&#34;数字总和为：6&#34;
</span></span></span></code></pre></div>
</div>
<h5 id="函数重载">函数重载<sup id="function-overload-ts"> </sup></h5>
<p>是使用 <strong>相同名称</strong> 和 <strong>不同参数数量或类型</strong> 创建多个方法的一种能力。</p>
<p><em>TypeScript</em> 允许在同一范围中声明几个功能类似的 <strong>同名</strong> 函数，表现为给同一个函数提供多个函数类型定义，常用来实现功能类似而所处理的数据类型不同的问题。</p>
<p><kbd>:memo: <em>Note</em></kbd> <em>TS</em> 引擎按照自上而下的顺序查找重载表，因此要把最精确的定义放在最前面，以减少查找时间。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">obj</span>: <span class="kt">any</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 重载列表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">setInfo</span><span class="p">(</span><span class="nx">val</span>: <span class="kt">string</span><span class="p">)</span><span class="o">:</span> <span class="k">void</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">setInfo</span><span class="p">(</span><span class="nx">val</span>: <span class="kt">number</span><span class="p">)</span><span class="o">:</span> <span class="k">void</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">setInfo</span><span class="p">(</span><span class="nx">val</span>: <span class="kt">boolean</span><span class="p">,</span> <span class="nx">val2</span><span class="p">)</span><span class="o">:</span> <span class="k">void</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 实际函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">setInfo</span><span class="p">(</span><span class="nx">val</span>: <span class="kt">string</span> <span class="o">|</span> <span class="kt">number</span> <span class="o">|</span> <span class="kr">boolean</span><span class="p">,</span> <span class="nx">val2</span><span class="o">?</span><span class="p">)</span><span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">val</span> <span class="o">===</span> <span class="s2">&#34;string&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">obj</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">obj</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nx">val2</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">setInfo</span><span class="p">(</span><span class="s2">&#34;Domes&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">setInfo</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">setInfo</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="s1">&#39;any&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span> <span class="c1">// { name: &#39;Domes&#39;, age: 7 }
</span></span></span></code></pre></div>
</div>
<h5 id="returntype"><em>ReturnType</em></h5>
<p>获取函数返回值</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Bar</span> <span class="o">=</span> <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">foo</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">Bar</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">baz</span> <span class="o">=</span> <span class="nx">ReturnType</span><span class="p">&lt;</span><span class="nt">foo</span><span class="p">&gt;;</span></span></span></code></pre></div>
</div>
<h3 id="wildcard通配类型"><em>Wildcard</em>^通配类型^</h3>
<h4 id="any"><em>Any</em></h4>
<p>在 <em>TS</em> 中，任何类型都可以归于 <em>any</em> 类型，所以 <em>any</em> 类型也就成了所有类型的顶级类型，同时，如果不指定变量的类型，则默认为 <em>any</em> 类型，当然不推荐使用该类型，因为这样丧失了 <em>TS</em> 的作用，而且写和不写没什么区别。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">d</span>:<span class="kt">any</span><span class="p">;</span> <span class="c1">//等价于 let d
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">d</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">d</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">d</span> <span class="o">=</span> <span class="nx">etrue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">d</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nx">d</span> <span class="o">=</span> <span class="p">{}</span></span></span></code></pre></div>
</div>
<p><kbd>:memo: <em>Note</em></kbd> 类型推论</p>
<p>如果不设置类型，并且不进行赋值时，将会被被自动推论为 <em>any</em> 类型，如果对其进行赋值就会默认为该类型。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">let</span> <span class="kt">any</span><span class="p">;</span> <span class="c1">// 推断为any
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span><span class="p">;</span> <span class="c1">// 推断为string
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">num</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// 推断为number
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">flag</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span> <span class="c1">// 推断为boolean
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">str</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// TS2322: Type &#39;boolean&#39; is not assignable to type &#39;string&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">num</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// TS2322: Type &#39;string&#39; is not assignable to type &#39;number&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// TS2322: Type &#39;number&#39; is not assignable to type &#39;boolean&#39;.
</span></span></span></code></pre></div>
</div>
<h4 id="unknow"><em>Unknow</em></h4>
<p><em>unknow</em> 与 <em>any</em> 一样，都可以作为所有类型的 <strong>顶级类型</strong> ，但 <em>unknow</em> 更加<strong>严格</strong>，只能被赋值给 <em>any</em> 类型和 <em>unknown</em> 类型本身。不允许定义的值有任何操作（如 方法，<em>new</em>等），但 <em>any</em> 可以。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">u</span>:<span class="kt">unknown</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">a</span>: <span class="kt">any</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">u</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">;</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">u</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">u</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">u</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">u</span> <span class="o">=</span> <span class="p">{};</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">value</span>:<span class="kt">any</span> <span class="o">=</span> <span class="nx">u</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">value1</span>:<span class="kt">any</span> <span class="o">=</span> <span class="nx">a</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">value2</span>:<span class="kt">unknown</span> <span class="o">=</span> <span class="nx">u</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">value3</span>:<span class="kt">unknown</span> <span class="o">=</span> <span class="nx">a</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">value4</span>:<span class="kt">string</span> <span class="o">=</span> <span class="nx">u</span> <span class="c1">//error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">value5</span>:<span class="kt">string</span> <span class="o">=</span> <span class="nx">a</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">value6</span>:<span class="kt">number</span> <span class="o">=</span> <span class="nx">u</span> <span class="c1">//error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">value7</span>:<span class="kt">number</span> <span class="o">=</span> <span class="nx">a</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">value8</span>:<span class="kt">boolean</span> <span class="o">=</span> <span class="nx">u</span> <span class="c1">//error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">value9</span>:<span class="kt">boolean</span> <span class="o">=</span> <span class="nx">a</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">u</span><span class="p">.</span><span class="kr">set</span><span class="p">()</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">a</span><span class="p">.</span><span class="kr">set</span><span class="p">()</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">u</span><span class="p">()</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">a</span><span class="p">()</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">new</span> <span class="nx">u</span><span class="p">()</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">new</span> <span class="nx">a</span><span class="p">()</span> <span class="c1">//ok
</span></span></span></code></pre></div>
</div>
<h4 id="void"><em>Void</em></h4>
<p><em>void</em> 当一个函数，没有返回值时，<em>TS</em> 会默认它的返回值为 <em>void</em> 类型，实际为 <em>undefined</em> 。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">setInfo</span> <span class="o">=</span> <span class="p">()</span><span class="o">:</span><span class="k">void</span> <span class="o">=&gt;</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 等价于 const setInfo = () =&gt; {}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">setInfo1</span> <span class="o">=</span> <span class="p">()</span><span class="o">:</span><span class="k">void</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="k">return</span> <span class="s1">&#39;1&#39;</span> <span class="p">}</span>  <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">setInfo2</span> <span class="o">=</span> <span class="p">()</span><span class="o">:</span><span class="k">void</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">2</span> <span class="p">}</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">setInfo3</span> <span class="o">=</span> <span class="p">()</span><span class="o">:</span><span class="k">void</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">true</span> <span class="p">}</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">setInfo4</span> <span class="o">=</span> <span class="p">()</span><span class="o">:</span><span class="k">void</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="k">return</span>  <span class="p">}</span> <span class="c1">// ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">setInfo5</span> <span class="o">=</span> <span class="p">()</span><span class="o">:</span><span class="k">void</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">undefined</span> <span class="p">}</span> <span class="c1">//ok
</span></span></span></code></pre></div>
</div>
<h4 id="never"><em>Never</em></h4>
<p><em>never</em> 表示一个函数永远不存在返回值，<em>TS</em> 会认为类型为 <em>never</em> ，那么与 <em>void</em> 相比， <em>never</em> 应该是 <em>void</em> 子集， 因为 <em>void</em> 实际上的返回值为 <em>undefined</em> ，而 <em>never</em> 连 <em>undefined</em> 也不行</p>
<p>符合 <em>never</em> 的情况有：当抛出异常的情况和无限死循环</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">error</span> <span class="o">=</span> <span class="p">()</span><span class="o">:</span> <span class="kt">never</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 等价于 let error = () =&gt; {}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;error&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">_while</span> <span class="o">=</span> <span class="p">()</span><span class="o">:</span> <span class="kt">never</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span><span class="p">(</span><span class="kc">true</span><span class="p">){}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p><kbd>💡 <em>Trick</em></kbd> ^⭐️^ 全面性检查<sup id="type-wildcard-never-ts-comprehensive-inspection"> </sup></p>
<p>在 <em>TypeScript</em> 中，可以利用 <em>never</em> 类型的特性来实现全面性检查，具体示例如下：</p>
<p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Foo</span> <span class="o">=</span> <span class="kt">string</span> <span class="o">|</span> <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">controlFlowAnalysisWithNever</span><span class="p">(</span><span class="nx">foo</span>: <span class="kt">Foo</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">foo</span> <span class="o">===</span> <span class="s2">&#34;string&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 这里 foo 被收窄为 string 类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">foo</span> <span class="o">===</span> <span class="s2">&#34;number&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 这里 foo 被收窄为 number 类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// foo 在这里是 never
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kr">const</span> <span class="nx">check</span>: <span class="kt">never</span> <span class="o">=</span> <span class="nx">foo</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>注意在 <em>else</em> 分支里面，我们把收窄为 <em>never</em> 的 <em>foo</em> 赋值给一个显示声明的 <em>never</em> 变量。如果一切逻辑正确，那么这里应该能够编译通过。但是假如后来有一天你的同事修改了 <em>Foo</em> 的类型：</p>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Foo</span> <span class="o">=</span> <span class="kt">string</span> <span class="o">|</span> <span class="kt">number</span> <span class="o">|</span> <span class="kr">boolean</span><span class="p">;</span></span></span></code></pre></div></div>
</div>
<p>然而他忘记同时修改 <code>controlFlowAnalysisWithNever</code> 方法中的控制流程，这时候 <em>else</em> 分支的 <em>foo</em> 类型会被收窄为 <em>boolean</em> 类型，导致无法赋值给 <em>never</em> 类型的 <code>check</code> 变量，这时就会产生一个编译错误。通过这个方式，我们可以确保 <code>controlFlowAnalysisWithNever</code> 方法总是穷尽了 <em>Foo</em> 的所有可能类型。</p>
<p>通过这个示例，我们可以得出一个结论：使用 <em>never</em> 避免出现新增了联合类型没有对应的实现，目的就是写出类型绝对安全的代码。</p>
<h3 id="enum枚举"><em>Enum</em>^枚举^</h3>
<p>枚举类型，可以定义一些带名字的常量。</p>
<p><kbd>:memo: <em>Note</em></kbd></p>
<ol>
<li>
<p>枚举的类型只能是 <em>string</em> 或 <em>number</em></p>
</li>
<li>
<p>定义的名称不能为 <strong>关键字</strong></p>
</li>
</ol>
<h4 id="数字枚举">数字枚举</h4>
<p>枚组的类型默认为 <strong>数字类型</strong> ，默认从 <em>0</em> 开始以此累加，如果有设置默认值，则会对 <strong>后面</strong> 的值产生影响</p>
<p>同时支持类似数组下标方式访问的 <strong>反向映射</strong> 。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// TypeScript
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">enum</span> <span class="nx">numberType</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">A</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">B</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">C</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">D</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">num1</span> <span class="o">=</span> <span class="nx">numberType</span><span class="p">.</span><span class="nx">A</span> <span class="c1">// 正向映射
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">num2</span> <span class="o">=</span> <span class="nx">numberType</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">// 反向映射
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">num3</span> <span class="o">=</span> <span class="nx">numberType</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">num4</span> <span class="o">=</span> <span class="nx">numberType</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nx">num1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">num2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">num3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">num4</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span></span></span></code></pre></div>
</div>
<p>编译为 <em>JavaScript</em> 效果：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// ==&gt; ES2020
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">numberType</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 编译后为var，使得该枚举成为了一个全局变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">numberType</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">numberType</span><span class="p">[</span><span class="nx">numberType</span><span class="p">[</span><span class="s2">&#34;A&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;A&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">numberType</span><span class="p">[</span><span class="nx">numberType</span><span class="p">[</span><span class="s2">&#34;B&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;B&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">numberType</span><span class="p">[</span><span class="nx">numberType</span><span class="p">[</span><span class="s2">&#34;C&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;C&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">numberType</span><span class="p">[</span><span class="nx">numberType</span><span class="p">[</span><span class="s2">&#34;D&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;D&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">})(</span><span class="nx">numberType</span> <span class="o">||</span> <span class="p">(</span><span class="nx">numberType</span> <span class="o">=</span> <span class="p">{}));</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">num1</span> <span class="o">=</span> <span class="nx">numberType</span><span class="p">.</span><span class="nx">A</span><span class="p">;</span> <span class="c1">// 正向映射
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">num2</span> <span class="o">=</span> <span class="nx">numberType</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="c1">// 反向映射
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">num3</span> <span class="o">=</span> <span class="nx">numberType</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">num4</span> <span class="o">=</span> <span class="nx">numberType</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">num1</span><span class="p">,</span> <span class="nx">num2</span><span class="p">,</span> <span class="nx">num3</span><span class="p">,</span> <span class="nx">num4</span><span class="p">);</span></span></span></code></pre></div>
</div>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">numberType</span><span class="o">:</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="mi">0</span><span class="o">:</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="o">:</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="o">:</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="o">:</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="nx">A</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span> <span class="nx">B</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span> <span class="nx">C</span><span class="o">:</span><span class="mi">7</span><span class="p">,</span> <span class="nx">D</span><span class="o">:</span><span class="mi">8</span><span class="p">}</span></span></span></code></pre></div>
</div>
<h4 id="字符串枚举">字符串枚举</h4>
<p>字符串枚举要注意的是必须要有 <strong>默认值</strong> ，不支持 <strong>反向映射</strong> 。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// TypeScript
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">enum</span> <span class="nx">stringType</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">A</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">B</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">C</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">D</span> <span class="o">=</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// E
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="cm">/* TS1061: Enum member must have initializer. */</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* 使用字符串枚举的时候，后面的枚举成员必须先初始化 */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>编译为 <em>JavaScript</em> 效果：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// ==&gt; ES2020
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">stringType</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">stringType</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">stringType</span><span class="p">[</span><span class="s2">&#34;A&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;A&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">stringType</span><span class="p">[</span><span class="s2">&#34;B&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;B&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">stringType</span><span class="p">[</span><span class="s2">&#34;C&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;C&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">stringType</span><span class="p">[</span><span class="s2">&#34;D&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;D&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// E
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="cm">/* TS1061: Enum member must have initializer. */</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* 使用字符串枚举的时候，必须初始化 */</span>
</span></span><span class="line"><span class="cl"><span class="p">})(</span><span class="nx">stringType</span> <span class="o">||</span> <span class="p">(</span><span class="nx">stringType</span> <span class="o">=</span> <span class="p">{}));</span></span></span></code></pre></div>
</div>
<h4 id="异构枚举">异构枚举</h4>
<p>包含了 数字类型<sup><em>:array</em></sup> 和 字符串类型<sup><em>:string</em></sup> 的混合，同样字符串枚举类型也不支持反向映射。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// TypeScript
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">enum</span> <span class="nx">mixedType</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">A</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">B</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">C</span> <span class="o">=</span> <span class="s2">&#34;C&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">D</span> <span class="o">=</span> <span class="s2">&#34;D&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">E</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">F</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>编译为 <em>JavaScript</em> 效果：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// ==&gt; ES2020
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">mixedType</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">mixedType</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">mixedType</span><span class="p">[</span><span class="nx">mixedType</span><span class="p">[</span><span class="s2">&#34;A&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;A&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">mixedType</span><span class="p">[</span><span class="nx">mixedType</span><span class="p">[</span><span class="s2">&#34;B&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;B&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">mixedType</span><span class="p">[</span><span class="s2">&#34;C&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;C&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">mixedType</span><span class="p">[</span><span class="s2">&#34;D&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;D&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">mixedType</span><span class="p">[</span><span class="nx">mixedType</span><span class="p">[</span><span class="s2">&#34;E&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;E&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">mixedType</span><span class="p">[</span><span class="nx">mixedType</span><span class="p">[</span><span class="s2">&#34;F&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;F&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">})(</span><span class="nx">mixedType</span> <span class="o">||</span> <span class="p">(</span><span class="nx">mixedType</span> <span class="o">=</span> <span class="p">{}));</span></span></span></code></pre></div>
</div>
<h4 id="常量枚举">常量枚举</h4>
<p>除了 数字类型<sup><em>:array</em></sup> 和 字符串类型<sup><em>:string</em></sup> 之外，还有一种特殊的类型，那就是 <strong>常量枚举</strong>，也就是通过 <em>const</em> 去定义 <em>enum</em> ，但这种类型不会编译成任何 <em>JS</em> ，而是直接编译对应的值。</p>
<p><kbd>:memo: <em>Note</em></kbd> 并且，添加了 <em>const</em> 关键字后，后面必须使用相应实例，否则 <em>TypeScript</em> 将不会进行编译。</p>
<p>也就是说，普通情况下将会创建一个闭包，并将生成的数组传入 <em>var</em> 前缀的全局变量；而变为常量枚举后，则是直接将枚举值硬编码进相应函数中。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// TypeScript
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="kr">enum</span> <span class="nx">constType</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">A</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">B</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">C</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">D</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">con1</span> <span class="o">=</span> <span class="nx">constType</span><span class="p">.</span><span class="nx">A</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">con2</span> <span class="o">=</span> <span class="nx">constType</span><span class="p">.</span><span class="nx">C</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p>编译为 <em>JavaScript</em> 效果：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// ==&gt; ES2020
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">con1</span> <span class="o">=</span> <span class="mi">0</span> <span class="cm">/* A */</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">con2</span> <span class="o">=</span> <span class="mi">7</span> <span class="cm">/* C */</span><span class="p">;</span></span></span></code></pre></div>
</div>
<h3 id="literal字面量类型"><em>Literal</em>^字面量类型^</h3>
<p>可以直接指定参数的可选 字面量*^literal^* ，多个字面量通过 <code>|</code> 分隔 ，目前支持 字符串<sup><em>string</em></sup>、数字<sup><em>number</em></sup>、布尔<sup><em>boolean</em></sup> 类型。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">str</span><span class="o">:</span><span class="s1">&#39;foo&#39;</span><span class="o">|</span><span class="s1">&#39;bar&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// str变量的值只能是foo或bar
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">num</span>: <span class="kt">1</span> <span class="o">|</span> <span class="mi">2</span> <span class="o">|</span> <span class="mi">3</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">flag</span>:<span class="kt">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span> <span class="c1">// ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;baz&#39;</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1">// TS2322: Type &#39;&#34;baz&#34;&#39; is not assignable to type &#39;&#34;foo&#34; | &#34;bar&#34;&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">num</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">num</span> <span class="o">=</span> <span class="mi">7</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1">// TS2322: Type &#39;7&#39; is not assignable to type &#39;1 | 2 | 3&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">flag</span> <span class="o">=</span> <span class="kc">true</span> <span class="c1">// ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">flag</span> <span class="o">=</span> <span class="kc">false</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1">// TS2322: Type &#39;false&#39; is not assignable to type &#39;true&#39;.
</span></span></span></code></pre></div>
</div>
<h4 id="template模板字面量"><em>Template</em>^模板字面量^</h4>
<p>模板字面量类型以 字符串字面量类型*^literal^* 为基础，可以通过 联合类型*^union^* 扩展成多个字符串。</p>
<p>它们跟 <em>JavaScript</em> 的模板字符串是相同的语法，但是只能用在类型操作中。当使用模板字面量类型时，它会替换模板中的变量，返回一个新的字符串字面量：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">type</span> <span class="nx">world</span> <span class="o">=</span> <span class="s2">&#34;world&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">type</span> <span class="nx">World</span> <span class="o">=</span> <span class="s2">&#34;World&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">type</span> <span class="nx">Greeting</span> <span class="o">=</span> <span class="sb">`hello </span><span class="si">${</span><span class="nx">world</span> <span class="o">|</span> <span class="nx">World</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// type Greeting = &#34;hello world&#34;
</span></span></span></code></pre></div>
</div>
<h4 id="intrinsic内置字符操作类型"><em>Intrinsic</em>^内置字符操作类型^</h4>
<p><em>TypeScript</em> 的一些类型可以用于字符操作，这些类型处于性能的考虑被内置在编译器中，不能在 <code>.d.ts</code> 文件里找到它们。</p>
<p>模版: <code>Operation&lt;type&gt;</code></p>
<ol>
<li><em>Uppercase</em> - 把每个字符转为大写形式</li>
<li><em>Lowercase</em> - 把每个字符转为小写形式</li>
<li><em>Capitalize</em> - 把字符串的第一个字符转为大写形式</li>
<li><em>Uncapitalize</em> - 把字符串的第一个字符转换为小写形式</li>
</ol>
<h3 id="aliases类型别名"><em>Aliases</em>^类型别名^</h3>
<p><em>type</em> 用来给一个类型起个别名。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">InfoProps</span> <span class="o">=</span> <span class="kt">string</span> <span class="o">|</span> <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">setInfo</span> <span class="o">=</span> <span class="p">(</span><span class="nx">data</span>: <span class="kt">InfoProps</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{};</span></span></span></code></pre></div>
</div>
<h2 id="assertion断言"><em>Assertion</em>^断言^</h2>
<h3 id="as类型断言"><em>As</em>^类型断言^</h3>
<p>类型断言<sup><em>Type Assertion</em></sup> 可以用来手动指定一个值的类型。用途：</p>
<ol>
<li>将一个 联合类型*^union^* 断言为其中一个类型语法</li>
<li>将一个 父类*^parent^* 断言为更加具体的 子类*^child^*</li>
<li>将任何一个类型断言为 <em>any</em> / 将 <em>any</em> 断言为具体类型</li>
</ol>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="err">值</span> <span class="kr">as</span> <span class="err">类型</span></span></span></code></pre></div></div>
</div>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">类型</span><span class="p">&gt;</span><span class="err">值</span></span></span></code></pre></div></div>
</div>
<p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">//尖括号
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">num</span>: <span class="kt">any</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">res1</span>: <span class="kt">number</span> <span class="o">=</span> <span class="p">(&lt;</span><span class="nt">string</span><span class="p">&gt;</span><span class="nx">num</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span> <span class="c1">// React中会 error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// as 语法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">str</span>: <span class="kt">any</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">res</span>: <span class="kt">number</span> <span class="o">=</span> <span class="p">(</span><span class="nx">str</span> <span class="kr">as</span> <span class="kt">string</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p><kbd>:warning: <em>Caution</em></kbd> 尖括号语法在 <em>React</em> 中会报错，原因是与 <em>JSX</em> 语法会产生冲突，所以只能使用 <em>as</em> 。</p>
<h3 id="asas双重断言"><em>As^..as..^</em>^双重断言^</h3>
<p>使用类似 <code>as any as Foo</code> 的语法，对变量进行两次断言，来达到将任何一个类型断言为任何另一个类型的效果。</p>
<p><kbd>:warning: <em>Caution</em></kbd> 这种做法相当于抛弃了 <em>TypeScript</em> ，非常容易导致运行时错误，不推荐使用。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Cat</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">run</span><span class="p">()</span><span class="o">:</span> <span class="kt">never</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">swim</span><span class="p">()</span><span class="o">:</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Fish</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">swim</span><span class="p">()</span><span class="o">:</span> <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">cat2Fish</span><span class="p">(</span><span class="nx">cat</span><span class="o">:</span> <span class="p">{</span> <span class="nx">run</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span><span class="p">;</span> <span class="nx">swim</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span> <span class="p">})</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span><span class="nx">cat</span> <span class="kr">as</span> <span class="kt">any</span> <span class="kr">as</span> <span class="nx">Fish</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">Fish</span> <span class="kr">implements</span> <span class="nx">Fish</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">cat</span> <span class="o">=</span> <span class="k">new</span> <span class="kr">class</span> <span class="nx">Cat</span> <span class="kr">implements</span> <span class="nx">Cat</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">run() {</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">swim() {</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;cat.swim&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">cat2Fish</span><span class="p">(</span><span class="nx">cat</span><span class="p">).</span><span class="nx">swim</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="c1">// implemented as Fish
</span></span></span><span class="line"><span class="cl"><span class="c1">// cat.swim
</span></span></span></code></pre></div>
</div>
<h3 id="for-key确定赋值断言"><em>!^for-key^</em>^确定赋值断言^</h3>
<p>确定赋值断言，即允许在 实例属性*^properties^* 和 变量声明*^statement^* 后面放置一个 <code>!</code> 号，以告诉 <em>TS</em> 该属性会被明确赋值。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">foo</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">bar</span><span class="o">!:</span> <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">setFoo</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">foo</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">setBar</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">bar</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">setFoo</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">setBar</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">);</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1">// Variable &#39;foo&#39; is used before being assigned.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bar</span><span class="p">);</span> <span class="c1">// ok
</span></span></span></code></pre></div>
</div>
<h3 id="for-value非空断言"><em>!^for-value^</em>^非空断言^</h3>
<p>在上下文中当类型检查器无法断定类型时，一个新的后缀表达式操作符 <code>!</code> 可以用于断言操作对象是非 <em>null</em> 和非 <em>undefined</em> 类型。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">info</span> <span class="o">=</span> <span class="p">(</span><span class="nx">str</span><span class="o">:</span> <span class="nx">string</span> <span class="o">|</span> <span class="kc">null</span> <span class="o">|</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">name</span><span class="o">:</span> <span class="nx">string</span> <span class="o">=</span> <span class="nx">str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// Type &#39;undefined&#39; is not assignable to type &#39;string&#39;.(2322)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">name2</span><span class="o">:</span> <span class="nx">string</span> <span class="o">=</span> <span class="nx">str</span><span class="o">!</span><span class="p">;</span> <span class="c1">// 添加!符号进行非空断言
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nx">info</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">);</span></span></span></code></pre></div>
</div>
<h2 id="guards类型守卫"><em>Guards</em>^类型守卫^ <sup id="type-guards-ts"> </sup></h2>
<p><em>Type guards</em> 是可执行运行时检查的一种表达式，用于确保该类型在一定的范围内。使用守卫进行 <em>Type narrowing</em> 后，就可以使用相应的类型方法和属性了 。</p>
<p>类型保护可以保证一个字符串是一个字符串，尽管它的值也可以是一个数值。类型保护与特性检测并不是完全不同，其主要思想是尝试检测属性、方法或原型，以确定如何处理值。</p>
<h3 id="in成员检测"><em>In</em>^成员检测^</h3>
<p>用于判断某个 属性*^property^* 是否存在于 对象*^object^* 当中。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Employee</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span>: <span class="kt">string</span>
</span></span><span class="line"><span class="cl">  <span class="nx">salary</span>: <span class="kt">number</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Manager</span> <span class="kr">extends</span> <span class="nx">Employee</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">isManager</span>: <span class="kt">true</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">printInfo</span> <span class="o">=</span> <span class="p">(</span><span class="nx">data</span>: <span class="kt">Employee</span> <span class="o">|</span> <span class="nx">Manager</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`该</span><span class="si">${</span><span class="s2">&#34;isManager&#34;</span> <span class="k">in</span> <span class="nx">data</span> <span class="o">?</span> <span class="sb">`经理`</span> <span class="o">:</span> <span class="sb">`雇员`</span><span class="si">}</span><span class="sb">名字是：</span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">，薪水是：</span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">salary</span><span class="si">}</span><span class="sb">`</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">printInfo</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;David&#39;</span><span class="p">,</span> <span class="nx">salary</span>: <span class="kt">2000</span><span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="nx">printInfo</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;White&#39;</span><span class="p">,</span> <span class="nx">salary</span>: <span class="kt">7000</span><span class="p">,</span> <span class="nx">isManager</span>: <span class="kt">true</span><span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 该雇员名字是：David，薪水是：2000
</span></span></span><span class="line"><span class="cl"><span class="c1">// 该经理名字是：White，薪水是：7000
</span></span></span></code></pre></div>
</div>
<h3 id="typeof类型检测"><em>Typeof</em>^类型检测^</h3>
<p>用于 变量*^variable^* 是否属于某个 基本类型<sup><em>basic-type instance</em></sup> ，见 <em>EcmaScript</em> [<em>typeof</em>](04 JavaScript.md/#variable-typeof-es5) 。</p>
<h3 id="instanceof实例检测"><em>Instanceof</em>^实例检测^</h3>
<p>用于判断一个 对象*^object^* 是不是某个 类*^class^* 的 实例*^instance^* ，见 <em>EcmaScript</em> [<em>instanceof</em>](05 EcmaScript.md/#class-instanceof-usage-es6) 。</p>
<h3 id="is"><em>Is</em></h3>
<p><em>is</em> 关键字用于定义类型保护，用于自定义函数返回类型。</p>
<p>当类型符合的时候，可以直接调用类型相应的方法。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">Fish</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">swim() {</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;swimming&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">Bird</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">fly() {</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">getSmallPet() {</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="k">new</span> <span class="nx">Fish</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">isFish</span><span class="p">(</span><span class="nx">pet</span>: <span class="kt">Fish</span> <span class="o">|</span> <span class="nx">Bird</span><span class="p">)</span><span class="o">:</span> <span class="nx">pet</span> <span class="k">is</span> <span class="nx">Fish</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 告诉编译器将会返回Fish类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">return</span> <span class="p">(</span><span class="nx">pet</span> <span class="kr">as</span> <span class="nx">Fish</span><span class="p">).</span><span class="nx">swim</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Both calls to &#39;swim&#39; and &#39;fly&#39; are now okay.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">pet</span> <span class="o">=</span> <span class="nx">getSmallPet</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">pet</span><span class="p">.</span><span class="nx">swim</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">isFish</span><span class="p">(</span><span class="nx">pet</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">pet</span><span class="p">.</span><span class="nx">swim</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>通过上面的介绍，我们可以发现 <em>assertion</em>^断言^ 与 类型守卫 的概念非常相似，都是确定参数的类型，但 <em>assertion</em>^断言^ 它是直接告诉编辑器，这个参数就是这个类型，而类型守卫更像判断这个参数具体是什么类型。</p>
<h2 id="combine类型组合"><em>Combine</em>^类型组合^</h2>
<h3 id="union联合类型"><em>Union</em>^联合类型^<em>^|^</em></h3>
<p>使用 <code>|</code> 符号连接，将多个类型合并为一个类型*^type/interface^* 并集<sup>$\cup$</sup>，使得这个类型可以是多种类型 <strong>之一</strong> 。在使用 <a href="/techs/07-typescript/#type-guards-ts">类型守卫*^guards^*</a> 进行 <em>Narrowing</em> 之前，只能使用类型中共有的方法。</p>
<p>联合类型通常与 <em>null</em> 或 <em>undefined</em> 一起使用：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">sayHello</span> <span class="o">=</span> <span class="p">(</span><span class="nx">name</span>: <span class="kt">string</span> <span class="o">|</span> <span class="kc">undefined</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* ... */</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
</div>
<p>例如，这里 <code>name</code> 的类型是 <code>string|undefined</code> 意味着可以将 <em>string</em> 或 <em>undefined</em> 的值传递给 <code>sayHello</code> 函数。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="nx">sayHello</span><span class="p">(</span><span class="s2">&#34;semlinker&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">sayHello</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">sayHello</span><span class="p">(</span><span class="mi">123</span><span class="p">);</span> <span class="c1">// error
</span></span></span></code></pre></div>
</div>
<p>通过这个示例，你可以凭直觉知道类型 <code>A</code> 和类型 <code>B</code> 联合后的类型是同时接受 <code>A</code> 和 <code>B</code> 值的类型。此外，对于联合类型来说，你可能会遇到以下的用法：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">num</span>: <span class="kt">1</span> <span class="o">|</span> <span class="mi">2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">EventNames</span> <span class="o">=</span> <span class="s1">&#39;click&#39;</span> <span class="o">|</span> <span class="s1">&#39;scroll&#39;</span> <span class="o">|</span> <span class="s1">&#39;mousemove&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">event</span>:<span class="kt">EventNames</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span><span class="p">;</span> <span class="c1">// error
</span></span></span></code></pre></div>
</div>
<p>以上示例中的 <code>1</code>、<code>2</code> 或 <code>'click'</code> 被称为字面量类型，用来约束取值只能是某几个值中的一个。</p>
<h4 id="discriminated-unions可辨识联合"><em>Discriminated Unions</em>^可辨识联合^</h4>
<p>可辨识联合类型是 <em>TypeScript</em> 一个模仿 <em>Haskell</em> 的概念，也称为代数数据类型或标签联合类型。</p>
<p>这种类型的本质是结合 联合类型*^union^* 和 字面量类型 的一种类型保护方法。如果一个类型是多个类型的联合类型，且多个类型含有一个 <strong>公共属性</strong> ，那么就可以利用这个公共属性，来创建相似的类型 接口*^interface^* 组。</p>
<h5 id="discriminantable可辨识"><em>Discriminantable</em>^可辨识^</h5>
<p>可辨识要求联合类型中的每个元素都至少含有一个 <strong>相同</strong> 单例类型属性，比如：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">const</span> <span class="kr">enum</span> <span class="nx">CarTransmission</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">Automatic</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">Manual</span> <span class="o">=</span> <span class="mi">300</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Motorcycle</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">vType</span><span class="o">:</span> <span class="s2">&#34;motorcycle&#34;</span><span class="p">;</span> <span class="c1">// discriminant
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">make</span>: <span class="kt">number</span><span class="p">;</span> <span class="c1">// year
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Car</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">vType</span><span class="o">:</span> <span class="s2">&#34;car&#34;</span><span class="p">;</span> <span class="c1">// discriminant
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">transmission</span>: <span class="kt">CarTransmission</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Truck</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">vType</span><span class="o">:</span> <span class="s2">&#34;truck&#34;</span><span class="p">;</span> <span class="c1">// discriminant
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">capacity</span>: <span class="kt">number</span><span class="p">;</span> <span class="c1">// in tons
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></div>
</div>
<p>在上述代码中，我们分别定义了 <code>Motorcycle</code>、 <code>Car</code> 和 <code>Truck</code> 三个接口，在这些接口中都包含一个 <code>vType</code> 属性，该属性被称为可辨识的属性，而其它的属性只跟特性的接口相关。</p>
<p><kbd>:page_with_curl: <em>Example</em></kbd> <em>Narrowing</em></p>
<p>经过 <em>Type Guards</em> 的 <em>Narrowing</em> 后，就可以使用相应的方法了。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Shape</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">  <span class="o">|</span> <span class="p">{</span> <span class="nx">kind</span><span class="o">:</span> <span class="s2">&#34;circle&#34;</span><span class="p">;</span> <span class="nx">radius</span>: <span class="kt">number</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="o">|</span> <span class="p">{</span> <span class="nx">kind</span><span class="o">:</span> <span class="s2">&#34;square&#34;</span><span class="p">;</span> <span class="nx">x</span>: <span class="kt">number</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="o">|</span> <span class="p">{</span> <span class="nx">kind</span><span class="o">:</span> <span class="s2">&#34;triangle&#34;</span><span class="p">;</span> <span class="nx">x</span>: <span class="kt">number</span><span class="p">;</span> <span class="nx">y</span>: <span class="kt">number</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">area</span><span class="p">(</span><span class="nx">s</span>: <span class="kt">Shape</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">kind</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s2">&#34;circle&#34;</span><span class="o">:</span> <span class="c1">// Type Narrowing
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="nx">s</span><span class="p">.</span><span class="nx">radius</span> <span class="o">*</span> <span class="nx">s</span><span class="p">.</span><span class="nx">radius</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s2">&#34;square&#34;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">s</span><span class="p">.</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">s</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s2">&#34;triangle&#34;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">s</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 当类型无法收窄至上述类型，就会报错
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">const</span> <span class="nx">check</span>: <span class="kt">never</span> <span class="o">=</span> <span class="nx">s</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>编译成 <em>JavaScript</em> ：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="s2">&#34;use strict&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">area</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">kind</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s2">&#34;circle&#34;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="nx">s</span><span class="p">.</span><span class="nx">radius</span> <span class="o">*</span> <span class="nx">s</span><span class="p">.</span><span class="nx">radius</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s2">&#34;square&#34;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">s</span><span class="p">.</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">s</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s2">&#34;triangle&#34;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">s</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">check</span> <span class="o">=</span> <span class="nx">s</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h5 id="combine联合类型"><em>Combine</em>^联合类型^</h5>
<p>基于前面定义了三个接口，我们可以创建一个 <code>Vehicle</code> 联合类型：</p>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Vehicle</span> <span class="o">=</span> <span class="nx">Motorcycle</span> <span class="o">|</span> <span class="nx">Car</span> <span class="o">|</span> <span class="nx">Truck</span><span class="p">;</span></span></span></code></pre></div></div>
</div>
<p>现在我们就可以开始使用 <code>Vehicle</code> 联合类型，对于 <code>Vehicle</code> 类型的变量，它可以表示不同类型的车辆。</p>
<h5 id="guard类型守卫"><em>Guard</em>^类型守卫^</h5>
<p>下面我们来定义一个 <code>evaluatePrice</code> 方法，该方法用于根据车辆的类型、容量和评估因子来计算价格，具体实现如下：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">EVALUATION_FACTOR</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">evaluatePrice</span><span class="p">(</span><span class="nx">vehicle</span>: <span class="kt">Vehicle</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">vehicle</span><span class="p">.</span><span class="nx">capacity</span> <span class="o">*</span> <span class="nx">EVALUATION_FACTOR</span><span class="p">;</span> <span class="c1">// err
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// Property &#39;capacity&#39; does not exist on type &#39;Vehicle&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// Property &#39;capacity&#39; does not exist on type &#39;Motorcycle&#39;.(2339)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">myTruck</span>: <span class="kt">Truck</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">vType</span><span class="o">:</span> <span class="s2">&#34;truck&#34;</span><span class="p">,</span> <span class="nx">capacity</span>: <span class="kt">9.5</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nx">evaluatePrice</span><span class="p">(</span><span class="nx">myTruck</span><span class="p">);</span></span></span></code></pre></div>
</div>
<p>该代码将会报错，原因是在 <em>Motorcycle</em> 接口中，并不存在 <code>capacity</code> 属性，而对于 <code>Car</code> 接口来说，它也不存在 <code>capacity</code> 属性。那么，现在我们应该如何解决以上问题呢？这时，我们可以使用 类型守卫*<sup>type guard</sup>* 。下面我们来重构一下前面定义的 <code>evaluatePrice</code> 方法，重构后的代码如下：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">evaluatePrice</span><span class="p">(</span><span class="nx">vehicle</span>: <span class="kt">Vehicle</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span><span class="nx">vehicle</span><span class="p">.</span><span class="nx">vType</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s2">&#34;car&#34;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">vehicle</span><span class="p">.</span><span class="nx">transmission</span> <span class="o">*</span> <span class="nx">EVALUATION_FACTOR</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s2">&#34;truck&#34;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">vehicle</span><span class="p">.</span><span class="nx">capacity</span> <span class="o">*</span> <span class="nx">EVALUATION_FACTOR</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s2">&#34;motorcycle&#34;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">vehicle</span><span class="p">.</span><span class="nx">make</span> <span class="o">*</span> <span class="nx">EVALUATION_FACTOR</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>在以上代码中，我们使用 <code>switch</code> 和 <code>case</code> 运算符来实现类型守卫，从而确保在 <code>evaluatePrice</code> 方法中，我们可以安全地访问 <code>vehicle</code> 对象中的所包含的属性，来正确的计算该车辆类型所对应的价格。</p>
<h5 id="alias类型别名"><em>Alias</em>^类型别名^</h5>
<p>类型别名用来给一个类型起个新名字。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Message</span> <span class="o">=</span> <span class="kt">string</span> <span class="o">|</span> <span class="kt">string</span><span class="p">[];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">greet</span> <span class="o">=</span> <span class="p">(</span><span class="nx">message</span>: <span class="kt">Message</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span></span></span></code></pre></div>
</div>
<h3 id="intersect交叉类型"><em>Intersect</em>^交叉类型^<em>^&amp;^</em></h3>
<p>使用 <code>&amp;</code> 符号连接，将 <strong>多个类型</strong> 合并为 <strong>一个</strong> 拥有它们 属性*^property^* 并集<sup>$\cup$</sup> 的类型。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">AProps</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">foo</span>: <span class="kt">string</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">BProps</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">bar</span>: <span class="kt">number</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">allProps</span> <span class="o">=</span> <span class="nx">AProps</span> <span class="o">&amp;</span> <span class="nx">BProps</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">Info</span>: <span class="kt">allProps</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">foo</span><span class="o">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">bar</span>: <span class="kt">2</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h4 id="basic同名基础属性合并"><em>Basic</em>^同名基础属性合并^</h4>
<p>我们可以看到 <code>交叉类型</code> 是结合两个属性的属性值，那么我们现在有个问题，要是两个属性都有相同的属性值，那么此时总的类型会怎么样，先看看下面的案列：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">AProps</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">a</span>: <span class="kt">string</span><span class="p">,</span> <span class="nx">c</span>: <span class="kt">number</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">BProps</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">b</span>: <span class="kt">number</span><span class="p">,</span> <span class="nx">c</span>: <span class="kt">string</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">allProps</span> <span class="o">=</span> <span class="nx">AProps</span> <span class="o">&amp;</span> <span class="nx">BProps</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">Info</span>: <span class="kt">allProps</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">a</span><span class="o">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">b</span>: <span class="kt">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">c</span>: <span class="kt">3</span><span class="p">,</span> <span class="c1">// TS2322: Type &#39;number&#39; is not assignable to type &#39;never&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">c</span><span class="o">:</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="c1">// TS2300: Duplicate identifier &#39;c&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// TS2322: Type &#39;string&#39; is not assignable to type &#39;never&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// ts.ts(1, 28): The expected type comes from property &#39;c&#39; which is declared here on type &#39;allProps&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></div>
</div>
<p>如果是相同的类型，合并后的类型也是此类型，那如果是不同的类型会如何：</p>
<p>我们在 <code>Aprops</code> 和 <code>BProps</code> 中同时加入 <code>c</code> 属性，并且 <code>c</code> 属性的类型不同，一个是 <em>number</em> 类型，另一个是 <em>string</em> 类型。</p>
<p>现在结合为 <code>allProps</code> 后呢? 是不是 <code>c</code> 属性是 <em>number</em> 或 <em>string</em> 类型都可以，还是其中的一种？</p>
<p>然而在实际中， <code>c</code> 传入 数字类型<sup><em>number</em></sup> 和 字符串类型<sup><em>string</em></sup> 都不行，因此看到报错，现实的是 <code>c</code> 的类型是 <em>never</em> 。</p>
<p>这是因为对应 <code>c</code> 属性而言是 <em>number &amp; string</em> ，然而这种属性明显是不存在的，所以 <code>c</code> 的属性是 <em>never</em> ，即不能为任何值。</p>
<h4 id="reference同名非基础属性合并"><em>Reference</em>^同名非基础属性合并^</h4>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">A</span> <span class="p">{</span> <span class="nx">a</span>: <span class="kt">number</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">B</span> <span class="p">{</span> <span class="nx">b</span>: <span class="kt">string</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">C</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">x</span>: <span class="kt">A</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">D</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">x</span>: <span class="kt">B</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">allProps</span> <span class="o">=</span> <span class="nx">C</span> <span class="o">&amp;</span> <span class="nx">D</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">Info</span>: <span class="kt">allProps</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">x</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">a</span>: <span class="kt">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">b</span><span class="o">:</span> <span class="s1">&#39;1&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Info</span><span class="p">);</span> <span class="c1">// { x: { a: 0, b: &#39;1&#39; } }
</span></span></span></code></pre></div>
</div>
<p>我们来看看案例，对于混入多个类型时，若存在相同的成员，且成员类型为非基本数据类型，那么是可以成功合合并。</p>
<p>如果 接口 <code>A</code> 中的也是 <code>b</code> ，类型为 <em>number</em> ，就会跟 <strong>同名基础属性合并</strong> 一样，变为 <em>never</em> 类型。</p>
<h2 id="interfaces接口"><em>Interfaces</em>^接口^</h2>
<p>在 <em>TypeScript</em> 中，使用 接口*^Interfaces^* 来定义对象的类型。</p>
<p>在面向对象语言中，接口*^Interfaces^* 是一个很重要的概念，它是对行为的抽象，而具体如何行动需要由 类*^classes^<em>去 实现</em>^implement^* 。</p>
<p><em>TypeScript</em> 中的接口是一个非常灵活的概念，除了可用于对类的一部分行为进行 抽象*^abstract^* 以外，也常用于对对象的 形状*^Shape^* 进行描述。</p>
<h3 id="shape对象的形状"><em>Shape</em>^对象的形状^</h3>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Shape</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">height</span>: <span class="kt">bigint</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">width</span>: <span class="kt">bigint</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">rectangle</span>: <span class="kt">Shape</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">height</span>: <span class="kt">10n</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">width</span>: <span class="kt">10n</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
</div>
<p>上面的例子中，我们定义了一个接口 <code>Shape</code> ，接着定义了一个变量 <code>rectangle</code>，它的类型是 <code>Shape</code>。这样，我们就约束了 <code>rectangle</code> 的形状必须和接口 <code>Shape</code> 一致。</p>
<p>接口一般首字母大写，内部变量的形状必须和接口的形状保持一致。</p>
<h3 id="可选属性"><em>?</em>^可选属性^</h3>
<p>有时我们希望不要完全匹配一个形状，那么可以用可选属性，该属性可以不存在，且位置任意。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Shape</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">height</span>: <span class="kt">bigint</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">note?</span>: <span class="kt">string</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">width</span>: <span class="kt">bigint</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">rectangle</span>: <span class="kt">Shape</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">height</span>: <span class="kt">10n</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">width</span>: <span class="kt">10n</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
</div>
<h3 id="any任意属性"><em>Any</em>^任意属性^</h3>
<p>有时候我们希望一个接口成员允许有任意的属性类型，可以使用如下方式：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">note</span>: <span class="kt">any</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>使用 <code>[propName: string]</code> 定义了任意属性取 <code>string</code> 类型的值。</p>
<h3 id="readonly只读属性"><em>Readonly</em>^只读属性^<sup id="interface-readonly-ts"> </sup></h3>
<p>有时候我们希望对象中的一些 <strong>字段</strong> 只能在 <strong>创建的时候被赋值</strong> ，那么可以用 <em>readonly</em> 定义只读属性。</p>
<p>定义后，只允许一次初始化，之后便不允许修改。</p>
<p><kbd>🧪 <em>Experimental</em></kbd> <em>const</em> 可能只能影响变量，而不能影响成员。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">readonly</span> <span class="nx">id</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">age?</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">propName</span>: <span class="kt">string</span><span class="p">]</span><span class="o">:</span> <span class="kt">any</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">tom</span>: <span class="kt">Person</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">id</span>: <span class="kt">89757</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Tom&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">gender</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">tom</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="mi">9527</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// index.ts(14,5): error TS2540: Cannot assign to &#39;id&#39; because it is a constant or a read-only property.
</span></span></span></code></pre></div>
</div>
<p>上例中，使用 <em>readonly</em> 定义的属性 <code>id</code> 初始化后，又被赋值了，所以报错了。</p>
<p><kbd>:exclamation:<em>Warning</em></kbd> 只读*^readonly^* 的约束存在于第一次给 对象*^object^* 赋值的时候，而不是第一次给只读属性赋值的时候。</p>
<p><kbd>:memo: <em>Note 1</em></kbd> 可以理解为，初始化对象的时候，就必须提供一个初始值。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">readonly</span> <span class="nx">id</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">age?</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">propName</span>: <span class="kt">string</span><span class="p">]</span><span class="o">:</span> <span class="kt">any</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">tom</span>: <span class="kt">Person</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Tom&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">gender</span><span class="o">:</span> <span class="s1">&#39;male&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">tom</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="mi">89757</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Attempt to assign to const or readonly variable 
</span></span></span><span class="line"><span class="cl"><span class="c1">// TS2540: Cannot assign to &#39;id&#39; because it is a read-only property
</span></span></span></code></pre></div>
</div>
<p>上例中，报错信息有两处，第一处是在对 <code>tom</code> 进行赋值的时候，没有给 <code>id</code> 赋值。</p>
<p>第二处是在给 <code>tom.id</code> 赋值的时候，由于它是只读属性，所以报错了。</p>
<p><kbd>:memo: <em>Note 2</em></kbd> 此外 <em>TypeScript</em> 还提供了 <code>ReadonlyArray&lt;T&gt;</code> 数组范型*^genertic^* ，它与 <code>Array&lt;T&gt;</code> 相似，只是把所有可变方法去掉了，因此可以确保数组创建后再也不能被修改。</p>
<h3 id="signatures索引签名"><em>Signatures</em>^索引签名^</h3>
<p>有时并不提前知道类型属性的所有名称，但知道值的 形状*^shape^* 。此时可以使用 索引签名<sup><em>index signatures</em></sup> （类似方括号语法）来描述可能值的类型。值*^key^* 的可选类型有 <em>string, number, symbol</em> 。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">NumberOrStringDictionary</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">index</span>: <span class="kt">string</span><span class="p">]</span><span class="o">:</span> <span class="kt">number</span> <span class="o">|</span> <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">length</span>: <span class="kt">number</span><span class="p">;</span> <span class="c1">// ok, length is a number
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">name</span>: <span class="kt">string</span><span class="p">;</span> <span class="c1">// ok, name is a string
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></div>
</div>
<p>当 值*^value^* 类型不符时，就会报错：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">NumberDictionary</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">index</span>: <span class="kt">string</span><span class="p">]</span><span class="o">:</span> <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">length</span>: <span class="kt">number</span><span class="p">;</span> <span class="c1">// ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">name</span>: <span class="kt">string</span><span class="p">;</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 id="mapped映射类型"><em>Mapped</em>^映射类型^</h3>
<p>映射类型建立在 索引签名<sup><em>index signatures</em></sup> 的语法之上，用于声明未提前声明的属性类型：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">OnlyBoolsAndHorses</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">key</span>: <span class="kt">string</span><span class="p">]</span><span class="o">:</span> <span class="kr">boolean</span> <span class="o">|</span> <span class="nx">Horse</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">conforms</span>: <span class="kt">OnlyBoolsAndHorses</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">del</span>: <span class="kt">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">rodney</span>: <span class="kt">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
</div>
<p>当 键名*^key^* 类型不符时，就会报错：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">NumberDictionary</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">index</span>: <span class="kt">string</span><span class="p">]</span><span class="o">:</span> <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">  <span class="nx">length</span>: <span class="kt">number</span><span class="p">;</span> <span class="c1">// ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">name</span>: <span class="kt">string</span><span class="p">;</span> <span class="c1">// error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 id="distinguish辨别">^⭐️^<em>Distinguish</em>^辨别^</h3>
<p><kbd>:star: <em>Important</em></kbd> <em>Alias</em>^类型别名^ 和 <em>interface</em>^接口^ 的区别</p>
<h4 id="objects"><em>Objects</em></h4>
<h4 id="functions"><em>Functions</em></h4>
<p>接口和类型别名都可以用来描述对象的形状或函数签名：</p>
<h5 id="interface接口"><em>Interface</em>^接口^</h5>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Point</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">x</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">y</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">SetPoint</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nx">x</span>: <span class="kt">number</span><span class="p">,</span> <span class="nx">y</span>: <span class="kt">number</span><span class="p">)</span><span class="o">:</span> <span class="k">void</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h5 id="alias类型别名-1"><em>Alias</em>^类型别名^</h5>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Point</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">x</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">y</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">SetPoint</span> <span class="o">=</span> <span class="p">(</span><span class="nx">x</span>: <span class="kt">number</span><span class="p">,</span> <span class="nx">y</span>: <span class="kt">number</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span></span></span></code></pre></div>
</div>
<h4 id="other-types"><em>Other Types</em></h4>
<p>与接口类型不一样，类型别名可以用于一些其他类型，比如原始类型、联合类型和元组：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// primitive
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">Name</span> <span class="o">=</span> <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// object
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">PartialPointX</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">x</span>: <span class="kt">number</span><span class="p">;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">PartialPointY</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">y</span>: <span class="kt">number</span><span class="p">;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// union
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">PartialPoint</span> <span class="o">=</span> <span class="nx">PartialPointX</span> <span class="o">|</span> <span class="nx">PartialPointY</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// tuple
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">Data</span> <span class="o">=</span> <span class="p">[</span><span class="kt">number</span><span class="p">,</span> <span class="kt">string</span><span class="p">];</span></span></span></code></pre></div>
</div>
<h4 id="extend"><em>Extend</em></h4>
<p>接口和类型别名都能够被扩展，但语法有所不同。此外，接口和类型别名不是互斥的。接口*^interface^* 可以扩展 类型别名*^alias^* ，而反过来是不行的。</p>
<p><strong>Interface extends interface</strong></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">PartialPointX</span> <span class="p">{</span> <span class="nx">x</span>: <span class="kt">number</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Point</span> <span class="kr">extends</span> <span class="nx">PartialPointX</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">  <span class="nx">y</span>: <span class="kt">number</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p><strong>Type alias extends type alias</strong></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">PartialPointX</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">x</span>: <span class="kt">number</span><span class="p">;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Point</span> <span class="o">=</span> <span class="nx">PartialPointX</span> <span class="o">&amp;</span> <span class="p">{</span> <span class="nx">y</span>: <span class="kt">number</span><span class="p">;</span> <span class="p">};</span></span></span></code></pre></div>
</div>
<p><strong>Interface extends type alias</strong></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">PartialPointX</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">x</span>: <span class="kt">number</span><span class="p">;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Point</span> <span class="kr">extends</span> <span class="nx">PartialPointX</span> <span class="p">{</span> <span class="nx">y</span>: <span class="kt">number</span><span class="p">;</span> <span class="p">}</span></span></span></code></pre></div>
</div>
<p><strong>Type alias extends interface</strong></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">PartialPointX</span> <span class="p">{</span> <span class="nx">x</span>: <span class="kt">number</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Point</span> <span class="o">=</span> <span class="nx">PartialPointX</span> <span class="o">&amp;</span> <span class="p">{</span> <span class="nx">y</span>: <span class="kt">number</span><span class="p">;</span> <span class="p">};</span></span></span></code></pre></div>
</div>
<h4 id="implements"><em>Implements</em></h4>
<p>类可以以相同的方式实现 接口*^interface^* 或 类型别名*^type^* ，但类不能实现由 类型别名*^type^* 定义的 联合类型*^union^* ：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Point</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">x</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">y</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">SomePoint</span> <span class="kr">implements</span> <span class="nx">Point</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Point2</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">x</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">y</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">SomePoint2</span> <span class="kr">implements</span> <span class="nx">Point2</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">PartialPoint</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">x</span>: <span class="kt">number</span><span class="p">;</span> <span class="p">}</span> <span class="o">|</span> <span class="p">{</span> <span class="nx">y</span>: <span class="kt">number</span><span class="p">;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// A class can only implement an object type or 
</span></span></span><span class="line"><span class="cl"><span class="c1">// intersection of object types with statically known members.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">class</span> <span class="nx">SomePartialPoint</span> <span class="kr">implements</span> <span class="nx">PartialPoint</span> <span class="p">{</span> <span class="c1">// Error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h4 id="declaration-merging"><em>Declaration merging</em></h4>
<p>与类型别名不同，接口可以定义多次，会被自动合并为单个接口。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Point</span> <span class="p">{</span> <span class="nx">x</span>: <span class="kt">number</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Point</span> <span class="p">{</span> <span class="nx">y</span>: <span class="kt">number</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">point</span>: <span class="kt">Point</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">x</span>: <span class="kt">1</span><span class="p">,</span> <span class="nx">y</span>: <span class="kt">2</span> <span class="p">};</span></span></span></code></pre></div>
</div>
<h2 id="class类"><em>Class</em>^类^</h2>
<p><em>ES6</em> 中新增了 <em>class</em>  关键字，用于定义类。</p>
<h3 id="basic基本方法"><em>Basic</em>^基本方法^</h3>
<p>包括：静态属性，静态方法、成员属性、成员方法、私有属性、私有方法、构造器、<em>getter &amp; setter</em> 。</p>
<p><kbd>:memo: <em>Note</em></kbd> 需要注意的是： 在静态方法中，如果不给默认值，并且不使用是会报错的，如果不想报错就使用 <code>!</code> 关键字，如：<code>memberProperty!:string</code> 。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">Class</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* 1. 静态属性 */</span>
</span></span><span class="line"><span class="cl">    <span class="kr">static</span> <span class="nx">staticProperty</span>: <span class="kt">string</span> <span class="o">=</span> <span class="s1">&#39;静态属性&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// static name!:string;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// TS1255: A definite assignment assertion &#39;!&#39; is not permitted in this context.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* 2. 静态方法 */</span>
</span></span><span class="line"><span class="cl">    <span class="kr">static</span> <span class="nx">staticMember</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="sb">`我是静态方法:</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">staticProperty</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/* 3. 成员属性 */</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 实际上是通过public上进行修饰，只是省略了
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">member1</span>: <span class="kt">string</span> <span class="o">=</span> <span class="s1">&#39;成员属性&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">member2</span>: <span class="kt">string</span><span class="p">;</span> <span class="c1">// note: 并没有报错
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">memberProperty</span><span class="o">!:</span> <span class="kt">string</span><span class="p">;</span> <span class="c1">// ok 不设置默认值的时候必须加入！
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* 4. 成员方法 */</span>
</span></span><span class="line"><span class="cl">    <span class="nx">memberMethod</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="sb">`我是成员方法:</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">memberProperty</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">getPrivateMethod</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">privateMethod</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/* 5. 私有属性 */</span>
</span></span><span class="line"><span class="cl">    <span class="err">#</span><span class="nx">privateProperty</span>: <span class="kt">string</span> <span class="o">=</span> <span class="s1">&#39;私有属性&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/* 6. 私有方法 */</span>
</span></span><span class="line"><span class="cl">    <span class="err">#</span><span class="nx">privateMethod</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="sb">`我是私有方法:</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">privateProperty</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/* 7. 构造器 */</span>
</span></span><span class="line"><span class="cl">    <span class="kr">constructor</span><span class="p">(</span><span class="nx">_name</span>: <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">memberProperty</span> <span class="o">=</span> <span class="nx">_name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/* 8. get */</span>
</span></span><span class="line"><span class="cl">    <span class="kr">get</span> <span class="nx">getter() {</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">memberProperty</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/* ... &amp; set */</span>
</span></span><span class="line"><span class="cl">    <span class="kr">set</span> <span class="nx">getter</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">memberProperty</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Class</span><span class="p">(</span><span class="s1">&#39;成员属性&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Class</span><span class="p">.</span><span class="nx">staticMember</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">instance</span><span class="p">.</span><span class="nx">getPrivateMethod</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">instance</span><span class="p">.</span><span class="nx">memberMethod</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 我是静态方法:静态属性
</span></span></span><span class="line"><span class="cl"><span class="c1">// 我是私有方法:私有属性
</span></span></span><span class="line"><span class="cl"><span class="c1">// 我是成员方法:成员属性
</span></span></span></code></pre></div>
</div>
<h3 id="modifier修饰符"><em>Modifier</em>^修饰符^</h3>
<h4 id="public公开"><em>public</em>^公开^</h4>
<p>修饰的属性或方法是公有的，可以在任何地方被访问到，默认所有的属性和方法都是 <em>public</em> 的。</p>
<h4 id="protected保护"><em>protected</em>^保护^</h4>
<p>修饰的属性或方法是受保护的，它和 <em>private</em> 类似，但允许被子类继承从而被访问。</p>
<h4 id="private私有"><em>private</em>^私有^</h4>
<p>修饰的属性或方法是私有的，不能在声明它的类的外部访问。</p>
<p><kbd>:memo: <em>Note</em></kbd> 该限制仅存在于编译期间，编译之后的代码中，并没有限制  <em>private</em> 属性在外部的可访问性。</p>
<h4 id="私有字段"><em>#</em>^私有字段^</h4>
<p>在 <em>TS 3.8</em> 版本便开始支持 <em>ES2022</em> 新增的私有方法，而翻译成之前的版本则使用 <a href="/techs/07-typescript/#weakmap-as-private-before-es2022"><em>WeakMap()</em></a> 实现。</p>
<p>需要注意的是 <strong>私有字段</strong> 与常规字段不同，主要的区别是：</p>
<ol>
<li>私有字段以 <code>#</code> 字符开头，也叫私有名称</li>
<li>每个私有字段名称都 <strong>唯一</strong> 地限定于其包含的类</li>
<li>不能在私有字段上使用 <em>TypeScript</em> 可访问性修饰符（如 <em>public</em> 或 <em>private</em>）</li>
<li>私有字段不能在包含的类之外访问，甚至不能被检测到。</li>
</ol>
<h4 id="readonly只读属性-1"><em>readonly</em>^只读属性^</h4>
<p>见 <a href="/techs/07-typescript/#interface-readonly-ts">接口*^interface^*</a> 的只读属性。</p>
<p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">PropertyTest</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">public</span> <span class="nx">publicProperty</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kr">private</span> <span class="nx">privateProperty</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="err">#</span><span class="nx">property</span> <span class="o">=</span> <span class="s1">&#39;baz&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">method() {</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">publicProperty</span><span class="p">);</span> <span class="c1">// foo
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">privateProperty</span><span class="p">);</span> <span class="c1">// bar
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// 编译之后的代码中，并没有限制 private 属性在外部的可访问性
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">property</span><span class="p">);</span> <span class="c1">// baz
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// ES2022前，使用WeakMap()保存为真正的私有属性
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nx">PropertyTest</span><span class="p">().</span><span class="nx">method</span><span class="p">();</span></span></span></code></pre></div>
</div>
<p>编译为 <em>EcmaScript2020</em> ：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// ES2020
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="s2">&#34;use strict&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">__classPrivateFieldGet</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">__classPrivateFieldGet</span><span class="p">)</span> <span class="o">||</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">receiver</span><span class="p">,</span> <span class="nx">state</span><span class="p">,</span> <span class="nx">kind</span><span class="p">,</span> <span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">kind</span> <span class="o">===</span> <span class="s2">&#34;a&#34;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">f</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s2">&#34;Private accessor was defined without a getter&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">state</span> <span class="o">===</span> <span class="s2">&#34;function&#34;</span> <span class="o">?</span> <span class="nx">receiver</span> <span class="o">!==</span> <span class="nx">state</span> <span class="o">||</span> <span class="o">!</span><span class="nx">f</span> <span class="o">:</span> <span class="o">!</span><span class="nx">state</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">receiver</span><span class="p">))</span> <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s2">&#34;Cannot read private member from an object whose class did not declare it&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">kind</span> <span class="o">===</span> <span class="s2">&#34;m&#34;</span> <span class="o">?</span> <span class="nx">f</span> <span class="o">:</span> <span class="nx">kind</span> <span class="o">===</span> <span class="s2">&#34;a&#34;</span> <span class="o">?</span> <span class="nx">f</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">receiver</span><span class="p">)</span> <span class="o">:</span> <span class="nx">f</span> <span class="o">?</span> <span class="nx">f</span><span class="p">.</span><span class="nx">value</span> <span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">receiver</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">_PropertyTest_property</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">PropertyTest</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">constructor</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">publicProperty</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">privateProperty</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">_PropertyTest_property</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">method</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">publicProperty</span><span class="p">);</span> <span class="c1">// foo
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">privateProperty</span><span class="p">);</span> <span class="c1">// bar
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// 编译之后的代码中，并没有限制 private 属性在外部的可访问性
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">__classPrivateFieldGet</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">_PropertyTest_property</span><span class="p">,</span> <span class="s2">&#34;f&#34;</span><span class="p">));</span> <span class="c1">// baz
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// ES2022前，使用WeakMap()保存为真正的私有属性
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">_PropertyTest_property</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WeakMap</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nx">PropertyTest</span><span class="p">().</span><span class="nx">method</span><span class="p">();</span></span></span></code></pre></div>
</div>
<h3 id="extends继承"><em>Extends</em>^继承^</h3>
<p>继承*^Inheritance^* 是一种联结类与类的层次模型。指的是一个类（称为子类、子接口）继承另外的一个类（称为父类、父接口）的功能，并可以增加它自己的新功能的能力，继承是类与类或者接口与接口之间最常见的关系。</p>
<p>见 <em>EcmaScript</em> <em>Class</em> 一章中的 [继承](05 EcmaScript.md#class-extends-es6) 。继承是一种 <em>is-a</em> 关系：</p>
<div class="ui-codeblock">
    
    <pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">classDiagram
  direction BT
  Class_B --&gt; Class_A
  Interface_B --&gt; Interface_A
  
  class Class_A{
  }
     
  class Class_B{
  }
  
  class Interface_A{
  
  }
  
  class Interface_B{
  
  }</code></pre>
</div>
<h3 id="implements实现"><em>Implements</em>^实现^</h3>
<p>用于检测某个类是否实现了相应接口，不符合则报错。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// @errors: 2420
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">interface</span> <span class="nx">Pingable</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">ping</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">Sonar</span> <span class="kr">implements</span> <span class="nx">Pingable</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">ping() {</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;ping!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">Ball</span> <span class="kr">implements</span> <span class="nx">Pingable</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// error, Ball中没有ping()方法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">pong() {</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;pong!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 id="abstract抽象类"><em>Abstract</em>^抽象类^</h3>
<p>用 <em>abstract</em> 关键字声明的类叫做 <strong>抽象类</strong>，声明的方法叫做 <strong>抽象方法</strong> 。</p>
<ol>
<li>
<p><strong>抽象类</strong>：指不能被实例化，因为它里面包含一个或多个抽象方法。</p>
</li>
<li>
<p><strong>抽象方法</strong>：是指不包含具体实现的方法；</p>
</li>
</ol>
<p><kbd>:memo: <em>Note</em></kbd> 抽象类指的是不能直接实例化，只能实例化实现了所有抽象方法的子类。</p>
<p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">abstract</span> <span class="kr">class</span> <span class="nx">Shape</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">protected</span> <span class="kr">readonly</span> <span class="nx">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kr">protected</span> <span class="kr">constructor</span><span class="p">({</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">})</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Abstract class constructor can be made protected
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kr">abstract</span> <span class="nx">getArea</span><span class="p">()</span><span class="o">:</span> <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">Rectangle</span> <span class="kr">extends</span> <span class="nx">Shape</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">protected</span> <span class="kr">readonly</span> <span class="nx">height</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kr">protected</span> <span class="kr">readonly</span> <span class="nx">width</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kr">constructor</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="p">[</span><span class="nx">height</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">width</span> <span class="o">=</span> <span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">super</span><span class="p">({</span><span class="nx">name</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">height</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">width</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">getArea() {</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">Square</span> <span class="kr">extends</span> <span class="nx">Rectangle</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">constructor</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">length</span>: <span class="kt">number</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">super</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="p">[</span><span class="nx">length</span><span class="p">,</span> <span class="nx">length</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">Triangle</span> <span class="kr">extends</span> <span class="nx">Shape</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">protected</span> <span class="kr">readonly</span> <span class="nx">height</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kr">protected</span> <span class="kr">readonly</span> <span class="nx">width</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kr">constructor</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="p">[</span><span class="nx">height</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">width</span> <span class="o">=</span> <span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">super</span><span class="p">({</span><span class="nx">name</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">height</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">width</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">getArea() {</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="k">new</span> <span class="nx">Triangle</span><span class="p">(</span><span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">]).</span><span class="nx">getArea</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">    <span class="k">new</span> <span class="nx">Rectangle</span><span class="p">(</span><span class="s1">&#39;rectangle&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">]).</span><span class="nx">getArea</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">    <span class="k">new</span> <span class="nx">Square</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">).</span><span class="nx">getArea</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 60  120  100
</span></span></span></code></pre></div>
</div>
<h3 id="override--overload重写和重载"><em>Override &amp; overload</em>^重写和重载^</h3>
<ol>
<li>[<strong>重写</strong><sup><em>override</em></sup>](06 EcmaScript C/#class-extends-es6)：使用 <em>extends</em> 关键字使子类能重写继承自父类中的方法</li>
<li><a href="/techs/07-typescript/#function-overload-ts"><strong>重载</strong><sup><em>overload</em></sup></a>：允许同一个函数拥有多个类型定义</li>
</ol>
<h3 id="infer类型推断"><em>Infer</em>^类型推断^</h3>
<p>当 <code>noImplicitAny</code> 配置属性被启用之后，<em>TypeScript</em> 就可以使用控制流分析来确认类中的属性类型：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nx">fullName</span><span class="p">;</span>  <span class="c1">// (property) Person.fullName: string
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="nx">firstName</span><span class="p">;</span> <span class="c1">// (property) Person.firstName: string | undefined
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="nx">lastName</span><span class="p">;</span> <span class="c1">// (property) Person.lastName: string | undefined
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">   <span class="kr">constructor</span><span class="p">(</span><span class="nx">fullName</span>: <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="p">.</span><span class="nx">fullName</span> <span class="o">=</span> <span class="nx">fullName</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     <span class="k">if</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()){</span>
</span></span><span class="line"><span class="cl">       <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">=</span> <span class="nx">fullName</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">       <span class="k">this</span><span class="p">.</span><span class="nx">lastName</span> <span class="o">=</span>   <span class="nx">fullName</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">     <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p><kbd>:memo: <em>Note</em></kbd> 但在使用过程中，如果我们没法保证对成员属性都进行赋值，那么该属性可能会被认为是 <code>undefined</code>。</p>
<p>默认 <em>TS</em> 并不会自动推断 类*^class^* 的 成员*^property^* 类型：</p>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">TS7045: Member <span class="s1">&#39;fullName&#39;</span> implicitly has an <span class="s1">&#39;any&#39;</span> type, but a better <span class="nb">type</span> may be inferred from usage.</span></span></code></pre></div></div>
</div>
<h2 id="generics泛型"><em>Generics</em>^泛型^</h2>
<p>类似 <em>C++</em> 和 <em>Java</em> 的语法，<em>TypeScript</em> 可以在定义函数、接口或类的时候，不预先指定具体的类型，而在使用的时候再指定类型。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">identity</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;(</span><span class="nx">value</span>: <span class="kt">T</span><span class="p">)</span><span class="o">:</span> <span class="nx">T</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// T:传递类型 --&gt; T链式传递给参数类型和返回类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">identity</span><span class="p">&lt;</span><span class="nt">Number</span><span class="p">&gt;(</span><span class="mi">1</span><span class="p">);</span></span></span></code></pre></div>
</div>
<p>参考上面的图片，当我们调用 <code> identity&lt;Number&gt;(1)</code> ，<code>Number</code> 类型就像参数 <code>1</code> 一样，它将在出现 <code>T</code> 的任何位置填充该类型。</p>
<p><code>&lt;T&gt;</code> 内部的 <code>T</code> 被称为 类型变量<sup><em>type variable</em></sup> ，在定义泛型时通常用作第一个类型变量名称。但实际上 <code>T</code> 可以用任何有效名称代替。它是我们希望传递给 <em>identity</em> 函数的类型占位符，同时它被分配给 <code>value</code> 参数用来代替它的类型：此时 <code>T</code> 充当的是类型，而不是特定的 <em>Number</em> 类型。</p>
<p>除了 <code>T</code> 之外，以下是常见泛型变量代表的意思：</p>
<ol>
<li><em>K</em> <em>^key^</em>：表示对象中的键类型；</li>
<li><em>V</em> <em>^value^</em>：表示对象中的值类型；</li>
<li><em>E</em> <em>^element^</em>：表示元素类型。</li>
</ol>
<p>也就是说，泛型是允许同一个函数接受不同类型参数的一种模版，与 <em>any</em> 相比，使用泛型来创建可 复用*^multiplex^* 的组件要更好，因为泛型会保留 参数类型*^type^* 。</p>
<p>其实并不是只能定义一个类型变量，我们可以引入希望定义的任何数量的类型变量。比如我们引入一个新的类型变量 <code>U</code> ，用于扩展我们定义的 <code>identity</code> 函数：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">identity</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">,</span> <span class="na">U</span><span class="p">&gt;(</span><span class="nx">value</span>: <span class="kt">T</span><span class="p">,</span> <span class="nx">message</span>: <span class="kt">U</span><span class="p">)</span><span class="o">:</span> <span class="nx">T</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">identity</span><span class="p">&lt;</span><span class="nt">Number</span><span class="p">,</span> <span class="na">String</span><span class="p">&gt;(</span><span class="mi">68</span><span class="p">,</span> <span class="s1">&#39;semi-linker&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="c1">// semi-linker ~&gt; Number --&gt; T  
</span></span></span><span class="line"><span class="cl"><span class="c1">// 68          ~&gt; String --&gt; U  
</span></span></span></code></pre></div>
</div>
<p>除了为类型变量显式设定值之外，一种更常见的做法是使编译器自动选择这些类型，从而使代码更简洁。我们可以完全省略尖括号，比如：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">identity</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">,</span> <span class="na">U</span><span class="p">&gt;(</span><span class="nx">value</span>: <span class="kt">T</span><span class="p">,</span> <span class="nx">message</span>: <span class="kt">U</span><span class="p">)</span><span class="o">:</span> <span class="nx">T</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">identity</span><span class="p">(</span><span class="mi">68</span><span class="p">,</span> <span class="s2">&#34;Semlinker&#34;</span><span class="p">));</span></span></span></code></pre></div>
</div>
<p>对于上述代码，编译器足够聪明，能够知道我们的参数类型，并将它们赋值给 <code>T</code> 和 <code>U</code> ，而不需要开发人员显式指定它们。</p>
<h3 id="interface泛型接口"><em>Interface</em>^泛型接口^</h3>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">GenericIdentityFn</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nx">arg</span>: <span class="kt">T</span><span class="p">)</span><span class="o">:</span> <span class="nx">T</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 id="class泛型类"><em>Class</em>^泛型类^</h3>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">GenericNumber</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">zeroValue</span>: <span class="kt">T</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">add</span><span class="o">:</span> <span class="p">(</span><span class="nx">x</span>: <span class="kt">T</span><span class="p">,</span> <span class="nx">y</span>: <span class="kt">T</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">T</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">myGenericNumber</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GenericNumber</span><span class="p">&lt;</span><span class="nt">number</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl"><span class="nx">myGenericNumber</span><span class="p">.</span><span class="nx">zeroValue</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">myGenericNumber</span><span class="p">.</span><span class="nx">add</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
</div>
<h3 id="operator操作符"><em>Operator</em>^操作符^</h3>
<h4 id="typeof"><em>Typeof</em></h4>
<p>在 <em>TypeScript</em> 中，<em>typeof</em> 操作符可以用来获取一个变量声明或对象的类型。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">age</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">sem</span>: <span class="kt">Person</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;semi-linker&#39;</span><span class="p">,</span> <span class="nx">age</span>: <span class="kt">33</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Sem</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">sem</span><span class="p">;</span> <span class="c1">// -&gt; Person
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">Sam</span>: <span class="kt">Sem</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="nx">age</span>: <span class="kt">42</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ok 键名字面量相同、键值类型相同
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">toArray</span><span class="p">(</span><span class="nx">x</span>: <span class="kt">number</span><span class="p">)</span><span class="o">:</span> <span class="nb">Array</span><span class="p">&lt;</span><span class="nt">number</span><span class="p">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">[</span><span class="nx">x</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Func</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">toArray</span><span class="p">;</span> <span class="c1">// -&gt; (x: number) =&gt; number[]
</span></span></span><span class="line"><span class="cl"><span class="c1">// Alias for:  typeof toArray
</span></span></span><span class="line"><span class="cl"><span class="c1">// Initial type:  (x: number) =&gt; Array&lt;number&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">func</span>: <span class="kt">Func</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span>: <span class="kt">number</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="c1">// ok 参数相同、返回值相同
</span></span></span></code></pre></div>
</div>
<h4 id="keyof"><em>Keyof</em></h4>
<p><em>keyof</em> 操作符可以用于获取某种类型的所有键，其返回类型是联合类型。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">age</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">K1</span> <span class="o">=</span> <span class="k">keyof</span> <span class="nx">Person</span><span class="p">;</span> <span class="c1">// &#34;name&#34; | &#34;age&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">K2</span> <span class="o">=</span> <span class="k">keyof</span> <span class="nx">Person</span><span class="p">[];</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 数组类型  Alias for: keyof Person[]/keyof []
</span></span></span><span class="line"><span class="cl"><span class="c1">// &#34;length&#34; | &#34;toString&#34; | &#34;toLocaleString&#34; | &#34;pop&#34; | &#34;push&#34; | &#34;concat&#34; | &#34;join&#34; | &#34;reverse&#34; | &#34;shift&#34; | &#34;slice&#34; | &#34;sort&#34; | ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">K3</span> <span class="o">=</span> <span class="k">keyof</span> <span class="p">{</span> <span class="p">[</span><span class="nx">x</span>: <span class="kt">string</span><span class="p">]</span><span class="o">:</span> <span class="nx">Person</span> <span class="p">};</span>  <span class="c1">// string | number
</span></span></span><span class="line"><span class="cl"><span class="c1">// Alias for:  keyof {[p: string]: Person}
</span></span></span><span class="line"><span class="cl"><span class="c1">// Initial type:  string | number
</span></span></span></code></pre></div>
</div>
<p>在 <em>TypeScript</em> 中支持两种索引签名，数字索引和字符串索引：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">StringArray</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 字符串索引 -&gt; keyof StringArray =&gt; string | number
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">[</span><span class="nx">index</span>: <span class="kt">string</span><span class="p">]</span><span class="o">:</span> <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">NumberArray</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 数字索引 -&gt; keyof NumberArray =&gt; number
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">[</span><span class="nx">index</span>: <span class="kt">number</span><span class="p">]</span><span class="o">:</span> <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">age</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p><kbd>:memo: <em>Note</em></kbd></p>
<p>为了同时支持两种索引类型，就得要求把 数值*^number^* 索引*^index^* 的返回值必须是 字符串*^string^*  索引返回值的 <strong>子类</strong> 。其中的原因就是当使用数值索引时，<em>JavaScript</em> 在执行索引操作时，会先把 数值*^number^* 索引先转换为 字符串*^string^* 索引。所以下面 <code>k</code> 的类型是 <code>string|number</code> 。</p>
<p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">age</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">k</span> <span class="o">=</span> <span class="k">keyof</span> <span class="p">{</span> <span class="p">[</span><span class="nx">x</span>: <span class="kt">string</span><span class="p">]</span><span class="o">:</span> <span class="nx">Person</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Alias for: keyof {[p: string]: Person}
</span></span></span><span class="line"><span class="cl"><span class="c1">// Initial type: string | number
</span></span></span></code></pre></div>
</div>
<h4 id="in"><em>In</em></h4>
<p><code>in</code> 用来遍历 可枚举类型*^iterable-type^* ：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Keys</span> <span class="o">=</span> <span class="s2">&#34;a&#34;</span> <span class="o">|</span> <span class="s2">&#34;b&#34;</span> <span class="o">|</span> <span class="s2">&#34;c&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Obj</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">p</span> <span class="k">in</span> <span class="nx">Keys</span><span class="p">]</span><span class="o">:</span> <span class="kt">any</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="c1">// 遍历Key类型中的所有成员作为键名
</span></span></span><span class="line"><span class="cl"><span class="c1">// Initial type:  {a: any, b: any, c: any}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Str</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">P</span> <span class="k">in</span> <span class="k">keyof</span> <span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">[</span><span class="nx">P</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="c1">// 获取字符串中的所有键名: 内容为字符串类型中的所有键值
</span></span></span><span class="line"><span class="cl"><span class="c1">// Initial type:  {toString(): string, ...
</span></span></span></code></pre></div>
</div>
<h4 id="infer"><em>Infer</em></h4>
<p>在条件类型语句中，可以用 <code>infer</code> 声明一个类型变量并且对它进行使用。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">ReturnType</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">...</span><span class="nx">args</span>: <span class="kt">any</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">infer</span> <span class="nx">R</span> <span class="o">?</span> <span class="nx">R</span> : <span class="kt">any</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p>以上代码中 <code>infer R</code> 就是声明一个变量来承载传入函数签名的返回值类型，简单说就是用它取到函数返回值的类型方便之后使用。</p>
<h4 id="extends"><em>Extends</em></h4>
<p>有时候我们定义的泛型不想过于灵活或者说想继承某些类等，可以通过 <em>extends</em> 关键字添加泛型约束。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Lengthwise</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">length</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">loggingIdentity</span><span class="p">&lt;</span><span class="nt">T</span> <span class="na">extends</span> <span class="na">Lengthwise</span><span class="p">&gt;(</span><span class="nx">arg</span>: <span class="kt">T</span><span class="p">)</span><span class="o">:</span> <span class="nx">T</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arg</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">arg</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>现在这个泛型函数被定义了约束，因此它不再是适用于任意类型：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="nx">loggingIdentity</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="c1">// undefined
</span></span></span></code></pre></div>
</div>
<p>这时我们需要传入符合约束类型的值，必须包含必须的属性：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="nx">loggingIdentity</span><span class="p">({</span><span class="nx">length</span>: <span class="kt">3</span><span class="p">});</span> <span class="c1">// 3
</span></span></span></code></pre></div>
</div>
<h3 id="complex复合类型"><em>Complex</em>^复合类型^</h3>
<h4 id="record"><em>Record</em></h4>
<p>Record&lt;K extends string | number | symbol, T&gt;</p>
<p>以 typeof 格式快速创建一个类型，此类型包含一组指定的属性且都是必填。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Coord</span> <span class="o">=</span> <span class="nx">Record</span><span class="o">&lt;</span><span class="s1">&#39;x&#39;</span> <span class="o">|</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="kt">number</span><span class="o">&gt;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 等同于
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">Coord</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">x</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">y</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>具体的复杂业务场景中，一般会接口 <code>Pick</code> 、<code>Partial</code> 等组合使用，从而过滤和重组出新的类型定义。</p>
<h4 id="partial"><em>Partial</em></h4>
<p>Partial&lt;T&gt;</p>
<p>将类型定义的所有属性都修改为可选项 <code>?</code> 。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Coord</span> <span class="o">=</span> <span class="nx">Partial</span><span class="p">&lt;</span><span class="nt">Record</span><span class="err">&lt;</span><span class="s1">&#39;x&#39;</span> <span class="err">|</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="na">number</span><span class="p">&gt;</span><span class="o">&gt;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 等同于
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">Coord</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">x?</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">y?</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * node_modules/typescript/lib/lib.es5.d.ts
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Make all properties in T optional
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Partial</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">P</span> <span class="k">in</span> <span class="k">keyof</span> <span class="nx">T</span><span class="p">]</span><span class="o">?:</span> <span class="nx">T</span><span class="p">[</span><span class="nx">P</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
</div>
<p>在以上代码中，首先通过 <code>keyof T</code> 拿到 <code>T</code> 的所有属性名，然后使用 <code>in</code> 进行遍历，将值赋给 <code>P</code>，最后通过 <code>T[P]</code> 取得相应的属性值。中间的 <code>?</code> 号，用于将所有属性变为可选。</p>
<p><strong>示例：</strong></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Todo</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">title</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">updateTodo</span><span class="p">(</span><span class="nx">todo</span>: <span class="kt">Todo</span><span class="p">,</span> <span class="nx">fieldsToUpdate</span>: <span class="kt">Partial</span><span class="p">&lt;</span><span class="nt">Todo</span><span class="p">&gt;)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">{...</span><span class="nx">todo</span><span class="p">,</span> <span class="p">...</span><span class="nx">fieldsToUpdate</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 解构写法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">todo1</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">title</span><span class="o">:</span> <span class="s2">&#34;Learn TS&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s2">&#34;Learn TypeScript&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">todo2</span> <span class="o">=</span> <span class="nx">updateTodo</span><span class="p">(</span><span class="nx">todo1</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s2">&#34;Learn TypeScript Enum&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span></span></span></code></pre></div>
</div>
<p>在上面的 <code>updateTodo</code> 方法中，我们利用 <code>Partial&lt;T&gt;</code> 工具类型，定义 <code>fieldsToUpdate</code> 的类型为 <code>Partial&lt;Todo&gt;</code>，即：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">PartiallyTodo</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">title?</span>: <span class="kt">string</span> <span class="o">|</span> <span class="kc">undefined</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description?</span>: <span class="kt">string</span> <span class="o">|</span> <span class="kc">undefined</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h4 id="readonly"><em>Readonly</em></h4>
<p>Readonly&lt;T&gt;</p>
<p>不管是从字面意思，还是定义上都很好理解：将所有属性定义为自读。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Coord</span> <span class="o">=</span> <span class="nx">Readonly</span><span class="p">&lt;</span><span class="nt">Record</span><span class="err">&lt;</span><span class="s1">&#39;x&#39;</span> <span class="err">|</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="na">number</span><span class="p">&gt;</span><span class="o">&gt;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 等同于
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">Coord</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">readonly</span> <span class="nx">x</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kr">readonly</span> <span class="nx">y</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 如果进行了修改，则会报错：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">c</span>: <span class="kt">Coord</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">x</span>: <span class="kt">1</span><span class="p">,</span> <span class="nx">y</span>: <span class="kt">1</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nx">c</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// Error: Cannot assign to &#39;x&#39; because it is a read-only property.
</span></span></span></code></pre></div>
</div>
<h4 id="pick"><em>Pick</em></h4>
<p>type Pick&lt;T, K extends keyof T&gt;</p>
<p>从类型定义的属性中，选取指定一组属性，返回一个新的类型定义。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Coord</span> <span class="o">=</span> <span class="nx">Record</span><span class="o">&lt;</span><span class="s1">&#39;x&#39;</span> <span class="o">|</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="kt">number</span><span class="o">&gt;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">CoordX</span> <span class="o">=</span> <span class="nx">Pick</span><span class="p">&lt;</span><span class="nt">Coord</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">&gt;;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 等用于
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">CoordX</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">x</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h4 id="required"><em>Required</em></h4>
<p>Required&lt;T&gt;</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Make all properties in T required
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Required</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">P</span> <span class="k">in</span> <span class="k">keyof</span> <span class="nx">T</span><span class="p">]</span><span class="o">-?:</span> <span class="nx">T</span><span class="p">[</span><span class="nx">P</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></div>
</div>
<p>与 <code>Partial&lt;T&gt;</code> 程序类型的作用相反，将类型属性都变成必填。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Coord</span> <span class="o">=</span> <span class="nx">Required</span><span class="o">&lt;</span><span class="p">{</span> <span class="nx">x</span>: <span class="kt">number</span><span class="p">,</span> <span class="nx">y?</span>:<span class="kt">number</span> <span class="p">}</span><span class="o">&gt;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 等同于
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">Coord</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">x</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">y</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>方法通过 <code>-?</code> 映射条件装饰符，去掉了所有可选参数状态。</p>
<h4 id="exclude"><em>Exclude</em></h4>
<p>Exclude&lt;T, U&gt;</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Exclude from T those types that are assignable to U
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Exclude</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">,</span> <span class="na">U</span><span class="p">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="nx">U</span> <span class="o">?</span> <span class="kt">never</span> <span class="o">:</span> <span class="nx">T</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p>排除一个 <strong>联合类型</strong> 中指定的子类型：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">T0</span> <span class="o">=</span> <span class="nx">Exclude</span><span class="o">&lt;</span><span class="s1">&#39;a&#39;</span> <span class="o">|</span> <span class="s1">&#39;b&#39;</span> <span class="o">|</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="o">&gt;</span> <span class="c1">// &#39;a&#39; | &#39;c&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">T1</span> <span class="o">=</span> <span class="nx">Exclude</span><span class="p">&lt;</span><span class="nt">string</span> <span class="err">|</span> <span class="na">number</span> <span class="err">|</span> <span class="na">boolean</span><span class="p">,</span> <span class="na">boolean</span><span class="p">&gt;</span> <span class="c1">// string | number
</span></span></span></code></pre></div>
</div>
<p>主要是基于 extends 条件类型的 <strong>解析推迟</strong> 的特性 ，返回了匹配之外的所有 候选类型，配合 never 类型的空值特性，实现了这一高级类型。</p>
<h4 id="extract"><em>Extract</em></h4>
<p>Extract&lt;T, U&gt;</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Extract from T those types that are assignable to U
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Extract</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">,</span> <span class="na">U</span><span class="p">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="nx">U</span> <span class="o">?</span> <span class="nx">T</span> : <span class="kt">never</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p>与 <code>Exclude&lt;T, U&gt;</code> 完全相反的功能，用于提取指定的 <strong>联合类型</strong>，如果不存在提取类型，则返回never。可以用在判断一个复杂的 联合类型 中是否包含指定子类型：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">T0</span> <span class="o">=</span> <span class="nx">Extract</span><span class="o">&lt;</span><span class="s1">&#39;a&#39;</span> <span class="o">|</span> <span class="s1">&#39;b&#39;</span> <span class="o">|</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="o">&gt;</span> <span class="c1">// &#39;a&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">T1</span> <span class="o">=</span> <span class="nx">Extract</span><span class="p">&lt;</span><span class="nt">string</span> <span class="err">|</span> <span class="na">number</span> <span class="err">|</span> <span class="na">boolean</span><span class="p">,</span> <span class="na">boolean</span><span class="p">&gt;</span> <span class="c1">// boolean
</span></span></span></code></pre></div>
</div>
<h4 id="omit"><em>Omit</em></h4>
<p>Omit&lt;T, K extends keyof any&gt;</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Construct a type with the properties of T except for those in type K.
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Omit</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">,</span> <span class="na">K</span> <span class="na">extends</span> <span class="na">keyof</span> <span class="na">any</span><span class="p">&gt;</span> <span class="o">=</span> <span class="nx">Pick</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">,</span> <span class="na">Exclude</span><span class="p">&lt;</span><span class="nt">keyof</span> <span class="na">T</span><span class="p">,</span> <span class="na">K</span><span class="p">&gt;&gt;;</span></span></span></code></pre></div>
</div>
<p>排除<strong>接口</strong>中指定的属性：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">I1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">a</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">b</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">c</span>: <span class="kt">boolean</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">AC</span> <span class="o">=</span> <span class="nx">Omit</span><span class="p">&lt;</span><span class="nt">I1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">&gt;;</span>     <span class="c1">// { a:number; c:boolean } 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">type</span> <span class="nx">C</span> <span class="o">=</span> <span class="nx">Omit</span><span class="p">&lt;</span><span class="nt">I1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span> <span class="err">|</span><span class="s1">&#39;b&#39;</span><span class="p">&gt;</span>  <span class="c1">// { c: boolean }
</span></span></span></code></pre></div>
</div>
<p>这个在高级类型的使用频率也比较高。</p>
<h4 id="nonnullable"><em>NonNullable</em></h4>
<p>NonNullable&lt;T&gt;</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Exclude null and undefined from T
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonNullable</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="kc">null</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="o">?</span> <span class="kt">never</span> <span class="o">:</span> <span class="nx">T</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p>过滤掉 联合类型 中的 <code>null</code> 和 <code>undefined</code> 类型：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">T1</span> <span class="o">=</span> <span class="nx">NonNullable</span><span class="p">&lt;</span><span class="nt">string</span> <span class="err">|</span> <span class="na">null</span> <span class="err">|</span> <span class="na">undefined</span><span class="p">&gt;;</span> <span class="c1">// string
</span></span></span></code></pre></div>
</div>
<p>额外说明下，因为 <code>null</code> 和 <code>undefined</code> 类型的特殊性，他们可以赋值给任何类型，这往往会带来意料之外的错误。当你开启 <code>--strictNullChecks</code> 设置后，TS 就会严格检查，只有被声明 null 后才能被赋值：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// 关闭 --strictNullChecks
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">s</span>: <span class="kt">string</span> <span class="o">=</span> <span class="s2">&#34;foo&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">s</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// 正常
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// 开启 --strictNullChecks
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">s</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// Error: Type &#39;null&#39; is not assignable to type &#39;string&#39;. 
</span></span></span></code></pre></div>
</div>
<h4 id="parameters"><em>Parameters</em></h4>
<p>Parameters&lt;T extends (&hellip;args: any) =&gt; any&gt;</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Obtain the parameters of a function type in a tuple
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Parameters</span><span class="p">&lt;</span><span class="nt">T</span> <span class="na">extends</span> <span class="err">(</span><span class="na">...args</span><span class="err">:</span> <span class="na">any</span><span class="err">)</span> <span class="err">=</span><span class="p">&gt;</span> <span class="kt">any</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="p">(...</span><span class="nx">args</span>: <span class="kt">infer</span> <span class="nx">P</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kt">any</span> <span class="o">?</span> <span class="nx">P</span> : <span class="kt">never</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p>获取函数的全部参数类型，以 <strong>元组类型</strong> 返回：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">F1</span> <span class="o">=</span> <span class="p">(</span><span class="nx">a</span>: <span class="kt">string</span><span class="p">,</span> <span class="nx">b</span>: <span class="kt">number</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">F1ParamTypes</span> <span class="o">=</span> <span class="nx">Parameters</span><span class="p">(</span><span class="nx">F1</span><span class="p">);</span>  <span class="c1">// [string, number]
</span></span></span></code></pre></div>
</div>
<h4 id="constructorparameters"><em>ConstructorParameters</em></h4>
<p>ConstructorParameters&lt;T extends new (&hellip;args: any) =&gt; any&gt;</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Obtain the parameters of a constructor function type in a tuple
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">ConstructorParameters</span><span class="p">&lt;</span><span class="nt">T</span> <span class="na">extends</span> <span class="na">new</span> <span class="err">(</span><span class="na">...args</span><span class="err">:</span> <span class="na">any</span><span class="err">)</span> <span class="err">=</span><span class="p">&gt;</span> <span class="kt">any</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="k">new</span> <span class="p">(...</span><span class="nx">args</span>: <span class="kt">infer</span> <span class="nx">P</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kt">any</span> <span class="o">?</span> <span class="nx">P</span> : <span class="kt">never</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p>同上面的类型很相似，只是这里获取的是 <strong>构造函数</strong> 的全部参数。关于构造函数声明，以及如何使用此 高级类型 的方式：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">IEntity</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">count</span><span class="o">?:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="kt">number</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">IEntityConstructor</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">new</span> <span class="p">(</span><span class="nx">a</span>: <span class="kt">boolean</span><span class="p">,</span> <span class="nx">b</span>: <span class="kt">string</span><span class="p">)</span><span class="o">:</span> <span class="nx">IEntity</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">Entity</span> <span class="kr">implements</span> <span class="nx">IEntity</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">constructor</span><span class="p">(</span><span class="nx">a</span>: <span class="kt">boolean</span><span class="p">,</span> <span class="nx">b</span>: <span class="kt">string</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">EntityConstructorParamType</span> <span class="o">=</span> <span class="nx">ConstructorParameters</span><span class="p">&lt;</span><span class="nt">IEntityConstructor</span><span class="p">&gt;;</span> <span class="c1">// [boolean, string]
</span></span></span></code></pre></div>
</div>
<p>这里的 <code>IEntityConstructor</code> 接口用来干什么的呢，当基于 创建实例函数 时就派上了用场：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">createEntity</span><span class="p">(</span><span class="nx">ctor</span>: <span class="kt">IEntityConstructor</span><span class="p">,</span> <span class="p">...</span><span class="nx">arg</span>: <span class="kt">EntityConstructorParamType</span><span class="p">)</span><span class="o">:</span> <span class="nx">IEntity</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">new</span> <span class="nx">ctor</span><span class="p">(...</span><span class="nx">arg</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">entity</span> <span class="o">=</span> <span class="nx">createEntity</span><span class="p">(</span><span class="nx">Entity</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span></span></span></code></pre></div>
</div>
<h4 id="returntype-1"><em>ReturnType</em></h4>
<p>ReturnType&lt;T extends (&hellip;args: any) =&gt; any&gt;</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Obtain the return type of a function type
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">ReturnType</span><span class="p">&lt;</span><span class="nt">T</span> <span class="na">extends</span> <span class="err">(</span><span class="na">...args</span><span class="err">:</span> <span class="na">any</span><span class="err">)</span> <span class="err">=</span><span class="p">&gt;</span> <span class="kt">any</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="p">(...</span><span class="nx">args</span>: <span class="kt">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">infer</span> <span class="nx">R</span> <span class="o">?</span> <span class="nx">R</span> : <span class="kt">any</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p>接收函数声明，返回函数的返回值类型，如果多个类型则以 联合类型 方式返回：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">F1</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nb">Date</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">F1ReturnType</span> <span class="o">=</span> <span class="nx">ReturnType</span><span class="p">&lt;</span><span class="nt">F1</span><span class="p">&gt;;</span> <span class="c1">// Date
</span></span></span></code></pre></div>
</div>
<h4 id="instancetype"><em>InstanceType</em></h4>
<p>InstanceType&lt;T extends new (&hellip;args: any) =&gt; any&gt;</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Obtain the return type of a constructor function type
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">InstanceType</span><span class="p">&lt;</span><span class="nt">T</span> <span class="na">extends</span> <span class="na">new</span> <span class="err">(</span><span class="na">...args</span><span class="err">:</span> <span class="na">any</span><span class="err">)</span> <span class="err">=</span><span class="p">&gt;</span> <span class="kt">any</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="k">new</span> <span class="p">(...</span><span class="nx">args</span>: <span class="kt">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">infer</span> <span class="nx">R</span> <span class="o">?</span> <span class="nx">R</span> : <span class="kt">any</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p>获取 构造函数 的返回类型，如果是多个就以 联合类型 的方式返回，我们借用上面的定义：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">EntityType</span> <span class="o">=</span> <span class="nx">InstanceType</span><span class="p">&lt;</span><span class="nt">IEntityConstructor</span><span class="p">&gt;;</span> <span class="c1">// IEntity
</span></span></span></code></pre></div>
</div>
<h4 id="thisparametertype"><em>ThisParameterType</em></h4>
<p>ThisParameterType&lt;T&gt;</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Extracts the type of the &#39;this&#39; parameter of a function type, or &#39;unknown&#39; if the function type has no &#39;this&#39; parameter.
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">ThisParameterType</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kr">extends</span> <span class="p">(</span><span class="k">this</span><span class="o">:</span> <span class="k">infer</span> <span class="nx">U</span><span class="p">,</span> <span class="p">...</span><span class="nx">args</span>: <span class="kt">any</span><span class="p">[])</span> <span class="o">=&gt;</span> <span class="kt">any</span> <span class="o">?</span> <span class="nx">U</span> : <span class="kt">unknown</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p>获取函数中 <code>this</code> 的数据类型，如果没有则返回 <code>unknown</code> 类型：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Foo</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">x</span>: <span class="kt">number</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">fn</span><span class="p">(</span><span class="k">this</span><span class="o">:</span> <span class="nx">Foo</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Test</span> <span class="o">=</span> <span class="nx">ThisParameterType</span><span class="p">&lt;</span><span class="nt">typeof</span> <span class="na">fn</span><span class="p">&gt;;</span> <span class="c1">// Foo
</span></span></span></code></pre></div>
</div>
<p>因为可以在 TS 声明函数的 <code>this</code> ，此方法用于获取此声明，具体的使用：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="nx">fn</span><span class="p">.</span><span class="nx">bind</span><span class="p">({</span> <span class="nx">x</span>: <span class="kt">1</span> <span class="p">});</span>   <span class="c1">// 正常
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">fn</span><span class="p">.</span><span class="nx">bind</span><span class="p">({</span> <span class="nx">x</span><span class="o">:</span> <span class="s1">&#39;1&#39;</span> <span class="p">});</span> <span class="c1">// Error: ...Type &#39;string&#39; is not assignable to type &#39;number&#39;...
</span></span></span></code></pre></div>
</div>
<h4 id="omitthisparameter"><em>OmitThisParameter</em></h4>
<p>OmitThisParameter&lt;T&gt;</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Removes the &#39;this&#39; parameter from a function type.
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">OmitThisParameter</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;</span> <span class="o">=</span> <span class="kt">unknown</span> <span class="kr">extends</span> <span class="nx">ThisParameterType</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;</span> <span class="o">?</span> <span class="nx">T</span> : <span class="kt">T</span> <span class="kr">extends</span> <span class="p">(...</span><span class="nx">args</span>: <span class="kt">infer</span> <span class="nx">A</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">infer</span> <span class="nx">R</span> <span class="o">?</span> <span class="p">(...</span><span class="nx">args</span>: <span class="kt">A</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">R</span> : <span class="kt">T</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p>移除函数中的 <code>this</code> 数据类型：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">interface</span> <span class="nx">Foo</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">x</span>: <span class="kt">number</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">Fn</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="o">:</span> <span class="nx">Foo</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">type</span> <span class="nx">NonReturnFn</span> <span class="o">=</span> <span class="nx">OmitThisParameter</span><span class="p">&lt;</span><span class="nt">Fn</span><span class="p">&gt;;</span> <span class="c1">// () =&gt; void
</span></span></span></code></pre></div>
</div>
<p>声明此类的函数类型效果如下：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="o">:</span> <span class="k">void</span><span class="p">)</span> <span class="p">{}</span> <span class="c1">// 此声明在函数内不可使用 this
</span></span></span></code></pre></div>
</div>
<h2 id="decorator装饰器"><em>Decorator</em>^装饰器^</h2>
<p>随着 <em>TypeScript</em> 和 <em>ES6</em> 中 类*^class^* 的引入，现在存在某些需要附加功能来支持 注释*^comment^* 或修改类和类成员的场景。装饰器*^decorator^* 提供了一种为类声明和成员添加注释和元编程语法的方法。装饰器是 <em>JavaScript</em> 的 <em>stage2</em> 提案，可作为 <em>TypeScript</em> 的实验性功能使用。它是一个表达式：</p>
<ol>
<li>该表达式被执行后，返回一个函数</li>
<li>函数的入参分别为 <em>target</em>、<em>name</em> 和 <em>descriptor</em></li>
<li>执行该函数后，可能返回 <em>descriptor</em> 对象，用于配置 <em>target</em> 对象</li>
</ol>
<p>需要注意的是，若要启用实验性的装饰器特性，你必须在命令行或 <code>tsconfig.json</code> 里启用 <code>experimentalDecorators</code> 编译器选项：</p>
<p><strong>命令行</strong>：</p>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">tsc --target ES5 --experimentalDecorators</span></span></code></pre></div></div>
</div>
<p>或是在 <code>tsconfig.json</code>：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;compilerOptions&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;target&#34;</span><span class="p">:</span> <span class="s2">&#34;ES5&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;experimentalDecorators&#34;</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>装饰器是一种函数，写成 <code>@ + 函数名</code> 。它可以放在类和类方法的定义前面。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">@frozen</span> <span class="kr">class</span> <span class="nx">Foo</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">@configurable</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="kd">@enumerable</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nx">method() {</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">@throttle</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nx">expensiveMethod() {</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>上面代码一共使用了四个装饰器，一个用在类本身，另外三个用在类方法。它们不仅增加了代码的可读性，清晰地表达了意图，而且提供一种方便的手段，增加或修改类的功能。</p>
<h3 id="class类装饰器"><em>Class</em>^类装饰器^</h3>
<p>装饰器可以用来装饰整个类。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// lib.es5.d.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">declare</span> <span class="kr">type</span> <span class="nx">ClassDecorator</span> <span class="o">=</span> <span class="p">&lt;</span><span class="nt">TFunction</span> <span class="na">extends</span> <span class="na">Function</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nx">target</span>: <span class="kt">TFunction</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">TFunction</span> <span class="o">|</span> <span class="k">void</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 接收function类型，返回是function或void
</span></span></span></code></pre></div>
</div>
<p>基本上，装饰器的行为就是下面这样。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">@decorator</span>
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">A</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">decorator</span><span class="p">&lt;</span><span class="nt">FT</span> <span class="na">extends</span> <span class="na">Function</span><span class="p">&gt;(</span><span class="nx">target</span>: <span class="kt">FT</span><span class="p">)</span><span class="o">:</span> <span class="k">void</span> <span class="o">|</span> <span class="nx">FT</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 等同于
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">_A</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">_A_Decorated</span> <span class="o">=</span> <span class="nx">_decorator</span><span class="p">(</span><span class="nx">_A</span><span class="p">)</span> <span class="o">||</span> <span class="nx">_A</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">_decorator</span><span class="p">&lt;</span><span class="nt">FT</span> <span class="na">extends</span> <span class="na">Function</span><span class="p">&gt;(</span><span class="nx">target</span>: <span class="kt">FT</span><span class="p">)</span><span class="o">:</span> <span class="k">void</span> <span class="o">|</span> <span class="nx">FT</span> <span class="p">{}</span></span></span></code></pre></div>
</div>
<p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">decorator</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span><span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nx">target</span> <span class="kr">as</span> <span class="kt">any</span><span class="p">).</span><span class="nx">isTestable</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@decorator</span>
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">DecorativeClass</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">((</span><span class="nx">DecorativeClass</span> <span class="kr">as</span> <span class="kt">any</span><span class="p">).</span><span class="nx">isTestable</span><span class="p">);</span> <span class="c1">// true
</span></span></span></code></pre></div>
</div>
<p>上面代码中，<code>@testable</code> 就是一个装饰器。它修改了 <code>MyTestableClass</code> 这个类的行为，为它加上了 静态*^static^* 属性 <code>isTestable</code> 。<code>testable</code> 函数的参数 <code>target</code> 是 <code>MyTestableClass</code> 类本身。</p>
<p><kbd>🧪 <em>Experimental</em></kbd></p>
<p>可以为装饰器添加方法，此时返回 <code>ClassDecorator</code> 类型即可。</p>
<p><kbd>:memo: <em>Note</em></kbd></p>
<p>实际上 <code>decorator('foo', 'bar')</code> 处就执行并传参 <code>'foo', 'bar'</code> 给了 <code>decorator</code> 函数，将返回的函数给 <code>@</code> ，而这个返回的函数符合 <code>type ClassDecorator</code> 的范式。可以理解为 <em>IIFE</em> 。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">decorator</span><span class="p">(...</span><span class="nx">param</span><span class="p">)</span><span class="o">:</span> <span class="nx">ClassDecorator</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">target</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nx">target</span> <span class="kr">as</span> <span class="kt">any</span><span class="p">)[</span><span class="nx">param</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">param</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@decorator</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">ParamDecorativeClass</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">((</span><span class="nx">ParamDecorativeClass</span> <span class="kr">as</span> <span class="kt">any</span><span class="p">).</span><span class="nx">foo</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// bar
</span></span></span></code></pre></div>
</div>
<p>也就是说，装饰器是一个对类进行处理的函数。装饰器函数*^decorate^* 的第一个参数，就是所要装饰的目标类。</p>
<p><kbd>:memo: <em>Note</em></kbd> 装饰器对类的行为的改变，是代码 <strong>编译</strong> 时发生的，而不是在运行时。这意味着，装饰器能在编译阶段运行代码。也就是说，装饰器本质就是编译时执行的函数。</p>
<p>如果想添加实例属性，可以通过目标类的 <code>prototype</code> 对象操作。</p>
<p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">decorator</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span><span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">target</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">isTestable</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@decorator</span>
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">DecorativeClass</span> <span class="p">{</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DecorativeClass</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">((</span><span class="nx">obj</span> <span class="kr">as</span> <span class="kt">any</span><span class="p">).</span><span class="nx">isTestable</span><span class="p">);</span> <span class="c1">// true
</span></span></span></code></pre></div>
</div>
<p>上面代码中，装饰器函数 <code>testable</code> 是在目标类的 <code>prototype</code> 对象上添加属性，因此就可以在实例上调用。</p>
<p>下面是另外一个例子。</p>
<p><kbd>:page_with_curl: <em>Example</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// mixins.js
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">export</span> <span class="kd">function</span> <span class="nx">mixins</span><span class="p">(...</span><span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="p">...</span><span class="nx">list</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// main.js
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">mixins</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./mixins.js&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">Foo</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">foo() {</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@mixins</span><span class="p">(</span><span class="nx">Foo</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">MyClass</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nx">obj</span> <span class="kr">as</span> <span class="p">{</span> <span class="nx">foo</span><span class="p">()</span> <span class="p">}).</span><span class="nx">foo</span><span class="p">()</span> <span class="c1">// &#39;foo&#39;
</span></span></span></code></pre></div>
</div>
<p>上面代码通过装饰器 <code>mixins</code> ，把 <code>Foo</code> 对象的方法添加到了 <code>MyClass</code> 的实例上面。没有装饰器 <em>@decorator</em> 时，可以用 <code>Object.assign()</code> 模拟这个功能。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">Foo</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">foo() {</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">MyClass</span> <span class="p">{</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="nx">MyClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="nx">Foo</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">foo</span><span class="p">()</span> <span class="c1">// &#39;foo&#39;
</span></span></span></code></pre></div>
</div>
<p><kbd>:memo: <em>Note</em></kbd></p>
<p>实际开发中，<em>React</em> 与 <em>Redux</em> 库结合使用时，常常需要写成下面这样。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">MyReactComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="nx">connect</span><span class="p">(</span><span class="nx">mapStateToProps</span><span class="p">,</span> <span class="nx">mapDispatchToProps</span><span class="p">)(</span><span class="nx">MyReactComponent</span><span class="p">);</span></span></span></code></pre></div>
</div>
<p>有了装饰器，就可以改写上面的代码。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">@connect</span><span class="p">(</span><span class="nx">mapStateToProps</span><span class="p">,</span> <span class="nx">mapDispatchToProps</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">MyReactComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{}</span></span></span></code></pre></div>
</div>
<p>相对来说，后一种写法看上去更容易理解。</p>
<h3 id="property属性装饰器"><em>Property</em>^属性装饰器^</h3>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// lib.es5.d.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">declare</span> <span class="kr">type</span> <span class="nx">PropertyDecorator</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nx">target</span>: <span class="kt">Object</span><span class="p">,</span> <span class="c1">// 被装饰的类
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">propertyKey</span>: <span class="kt">string</span> <span class="o">|</span> <span class="kt">symbol</span> <span class="c1">//被装饰类的属性名
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p><kbd>:exclamation:<em>Warning</em></kbd> <strong>不要使用：</strong></p>
<p>使用属性装饰器的时候，几乎没有作用，原因是装饰器的本意是要“装饰”类的 实例*^instance^* ，但是这个时候实例还没生成，所以只能去装饰 原型*^prototype^* ；由于无法直接在类的顶层创建直接修改原型的语句，因此会产生一个和实例同名的属性，从而原型上的属性会直接被实例上的属性覆盖。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">Class</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="err">@</span><span class="p">(</span><span class="nx">decorator</span> <span class="kr">as</span> <span class="nx">PropertyDecorator</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nx">property</span>: <span class="kt">any</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">decorator</span><span class="p">(</span><span class="nx">target</span>: <span class="kt">object</span><span class="p">,</span> <span class="nx">propertyKey</span>: <span class="kt">string</span> <span class="o">|</span> <span class="kt">symbol</span><span class="p">)</span><span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">target</span> <span class="o">===</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></div>
</div>
<p>使用 方法装饰器*^method-decorator^* 的时候，由于方法是直接定义在 原型*^.prototype^* 上的，因此修改有效。</p>
<h3 id="method方法装饰器"><em>Method</em>^方法装饰器^</h3>
<p>装饰器不仅可以装饰类，还可以装饰类的方法。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="c1">// lib.es5.d.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">declare</span> <span class="kr">type</span> <span class="nx">MethodDecorator</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;(</span>
</span></span><span class="line"><span class="cl">        <span class="nx">target</span><span class="o">:</span> <span class="c1">// 被装饰的类
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>           <span class="nb">Object</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">propertyKey</span><span class="o">:</span> <span class="c1">//被装饰类的方法名
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>           <span class="kt">string</span> <span class="o">|</span> <span class="kt">symbol</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">descriptor</span><span class="o">:</span> <span class="c1">// 属性描述符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>           <span class="nx">TypedPropertyDescriptor</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">=&gt;</span> <span class="nx">TypedPropertyDescriptor</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;</span> <span class="o">|</span> <span class="k">void</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p>另外，上面代码说明，装饰器*^readonly^* 可以通过修改 描述对象*^descriptor^* 的值达到修改属性的方法*^method^* ，注意描述对象此时是存储在 原型链*^prototype^* 上的。</p>
<p><kbd>:page_with_curl: <em>Example</em></kbd> 使用 <em>@decorator</em> 实现 <em>logger</em></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">log</span><span class="p">(</span><span class="nx">target</span>: <span class="kt">Object</span><span class="p">,</span> <span class="nx">propertyKey</span>: <span class="kt">string</span><span class="p">,</span> <span class="nx">descriptor</span>: <span class="kt">PropertyDescriptor</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">originalMethod</span> <span class="o">=</span> <span class="nx">descriptor</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">descriptor</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(...</span><span class="nx">args</span>: <span class="kt">any</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;wrapped function: before invoking &#34;</span> <span class="o">+</span> <span class="nx">propertyKey</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">originalMethod</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;wrapped function: after invoking &#34;</span> <span class="o">+</span> <span class="nx">propertyKey</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">Task</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="err">@</span><span class="p">(</span><span class="nx">log</span> <span class="kr">as</span> <span class="nx">MethodDecorator</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nx">runTask</span><span class="p">(</span><span class="nx">arg</span>: <span class="kt">any</span><span class="p">)</span><span class="o">:</span> <span class="kt">any</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;runTask invoked, args: &#34;</span> <span class="o">+</span> <span class="nx">arg</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s2">&#34;finished&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">task</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Task</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">task</span><span class="p">.</span><span class="nx">runTask</span><span class="p">(</span><span class="s2">&#34;learn ts&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;result: &#34;</span> <span class="o">+</span> <span class="nx">result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// wrapped function: before invoking runTask
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// runTask invoked, args: learn ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// wrapped function: after invoking runTask
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// result: finished
</span></span></span></code></pre></div>
</div>
<p><kbd>:page_with_curl: <em>Example</em></kbd> 使用 <em>Proxy</em> 实现 <em>logger</em></p>
<p><em>Proxy</em> 和 <em>@decorator</em> 区别：</p>
<ol>
<li><em>Proxy</em> 只能实现“眼前”，看不长远（要么代理 <em>function</em>，要么代理 <em>class</em>），不能同时代理</li>
<li><em>@decorator</em> 可以通过 <em>target</em> 和 <em>propKey</em> 同时获得 <em>class</em> 和 <em>function</em><sup>作为<em>prototype</em>被修改</sup> ，以及通过 <em>descriptor</em> 获取 <em>function</em> 暴露的属性描述符，可以在运行之前通过 钩子*^hook^* 修改 值*^descriptor.value^* 插入</li>
</ol>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">Task</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">runTask</span><span class="p">(</span><span class="nx">arg</span>: <span class="kt">any</span><span class="p">)</span><span class="o">:</span> <span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`runTask invoked, args:</span><span class="si">${</span><span class="nx">arg</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s2">&#34;finished&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// log 通过Proxy的apply实现了@decorator的效果
</span></span></span><span class="line"><span class="cl"><span class="c1">// 区别是decorator是编译时就修改内容，而proxy要到运行时
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">log</span> <span class="o">=</span> <span class="p">(</span><span class="nx">targetFunction</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">Proxy</span><span class="p">(</span><span class="nx">targetFunction</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">apply</span><span class="p">&lt;</span><span class="nt">F</span> <span class="na">extends</span> <span class="na">Function</span><span class="p">&gt;(</span><span class="nx">target</span>: <span class="kt">F</span><span class="p">,</span> <span class="nx">thisArg</span>: <span class="kt">Object</span><span class="p">,</span> <span class="nx">argArray</span>: <span class="kt">Array</span><span class="p">&lt;</span><span class="nt">any</span><span class="p">&gt;)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;wrapped function: before invoking &#34;</span> <span class="o">+</span> <span class="nx">target</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">Reflect</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">thisArg</span><span class="p">,</span> <span class="nx">argArray</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;wrapped function: after invoking &#34;</span> <span class="o">+</span> <span class="nx">target</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">task</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Task</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">logFn</span> <span class="o">=</span> <span class="nx">log</span><span class="p">(</span><span class="nx">task</span><span class="p">.</span><span class="nx">runTask</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">logFn</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;result: &#34;</span> <span class="o">+</span> <span class="nx">result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// wrapped function: before invoking runTask
</span></span></span><span class="line"><span class="cl"><span class="c1">// runTask invoked, args:foo
</span></span></span><span class="line"><span class="cl"><span class="c1">// wrapped function: after invoking runTask
</span></span></span><span class="line"><span class="cl"><span class="c1">// result: finished
</span></span></span></code></pre></div>
</div>
<h3 id="parameter参数装饰器"><em>Parameter</em>^参数装饰器^</h3>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">declare</span> <span class="kr">type</span> <span class="nx">ParameterDecorator</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nx">target</span><span class="o">:</span> <span class="c1">// 被装饰的类
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>       <span class="nb">Object</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">propertyKey</span><span class="o">:</span> <span class="c1">// 方法名
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>       <span class="kt">string</span> <span class="o">|</span> <span class="kt">symbol</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">parameterIndex</span><span class="o">:</span> <span class="c1">// 方法中参数的索引值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>       <span class="kt">number</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p><kbd>:exclamation:<em>Warning</em></kbd> <strong>不要使用：</strong></p>
<p>由于传入的三个参数 <em>target, key, parameterIndex</em> 都无法对形参进行实质性修改，且是最早运行的，因此非常鸡肋。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">Log</span><span class="p">(</span><span class="nx">target</span>: <span class="kt">Function</span><span class="p">,</span> <span class="nx">key</span>: <span class="kt">string</span><span class="p">,</span> <span class="nx">parameterIndex</span>: <span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="k">void</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">functionLogged</span> <span class="o">=</span> <span class="nx">key</span> <span class="o">||</span> <span class="nx">target</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="kr">constructor</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`The parameter in position </span><span class="si">${</span><span class="nx">parameterIndex</span><span class="si">}</span><span class="sb"> at </span><span class="si">${</span><span class="nx">functionLogged</span><span class="si">}</span><span class="sb"> has been decorated`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">Greeter</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">greeting</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">constructor</span><span class="p">(</span><span class="err">@</span><span class="p">(</span><span class="nx">Log</span> <span class="kr">as</span> <span class="nx">ParameterDecorator</span><span class="p">)</span> <span class="nx">phrase</span>: <span class="kt">string</span><span class="p">)</span>  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">greeting</span> <span class="o">=</span> <span class="nx">phrase</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h3 id="usage应用"><em>Usage</em>^应用^</h3>
<p>装饰器有注释的作用。</p>
<p><kbd>:page_with_curl: <em>Example 1</em></kbd></p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">testableList</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Set</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">testable</span> <span class="o">=</span> <span class="p">&lt;</span><span class="nt">TFunction</span> <span class="na">extends</span> <span class="na">Function</span><span class="p">&gt;(</span><span class="nx">target</span>: <span class="kt">TFunction</span><span class="p">)</span><span class="o">:</span> <span class="k">void</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">testableList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="kr">readonly</span> <span class="o">=</span> <span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;(</span><span class="nx">target</span>: <span class="kt">Object</span><span class="p">,</span> <span class="nx">propertyKey</span>: <span class="kt">string</span> <span class="o">|</span> <span class="kt">symbol</span><span class="p">,</span> <span class="nx">descriptor</span>: <span class="kt">TypedPropertyDescriptor</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;)</span><span class="o">:</span> <span class="k">void</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">Reflect</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">propertyKey</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">writable</span>: <span class="kt">false</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">nonEnumAble</span> <span class="o">=</span> <span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;(</span><span class="nx">target</span>: <span class="kt">Object</span><span class="p">,</span> <span class="nx">propertyKey</span>: <span class="kt">string</span> <span class="o">|</span> <span class="kt">symbol</span><span class="p">,</span> <span class="nx">descriptor</span>: <span class="kt">TypedPropertyDescriptor</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;)</span><span class="o">:</span> <span class="k">void</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">Reflect</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">propertyKey</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">enumerable</span>: <span class="kt">false</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="p">(</span><span class="nx">testable</span> <span class="kr">as</span> <span class="nx">ClassDecorator</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">// @testable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">class</span> <span class="nx">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="err">#</span><span class="nx">name</span>
</span></span><span class="line"><span class="cl">  <span class="err">@</span><span class="p">(</span><span class="kr">readonly</span> <span class="kr">as</span> <span class="nx">MethodDecorator</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="err">@</span><span class="p">(</span><span class="nx">nonEnumAble</span> <span class="kr">as</span> <span class="nx">MethodDecorator</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// @readonly
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// @nonEnumAble
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">name() {</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([...</span><span class="nx">testableList</span><span class="p">]);</span> <span class="c1">// [ &#39;Person&#39; ]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Reflect</span><span class="p">.</span><span class="nx">getOwnPropertyDescriptor</span><span class="p">(</span><span class="nx">Person</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="c1">// {
</span></span></span><span class="line"><span class="cl"><span class="c1">//   value: &#39;Person&#39;,
</span></span></span><span class="line"><span class="cl"><span class="c1">//   writable: false,
</span></span></span><span class="line"><span class="cl"><span class="c1">//   enumerable: false,
</span></span></span><span class="line"><span class="cl"><span class="c1">//   configurable: true
</span></span></span><span class="line"><span class="cl"><span class="c1">// }
</span></span></span></code></pre></div>
</div>
<p>从上面代码中，我们一眼就能看出，<code>Person</code> 类是可测试的，而 <code>name</code> 方法是只读和不可枚举的。</p>
<p>下面是使用 <em>Decorator</em> 写法的<a href="https://github.com/ionic-team/stencil">组件</a>，看上去一目了然。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">@Component</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">tag</span><span class="o">:</span> <span class="s1">&#39;my-component&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">styleUrl</span><span class="o">:</span> <span class="s1">&#39;my-component.scss&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">@Prop</span><span class="p">()</span> <span class="nx">first</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kd">@Prop</span><span class="p">()</span> <span class="nx">last</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kd">@State</span><span class="p">()</span> <span class="nx">isVisible</span>: <span class="kt">boolean</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">render() {</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Hello</span><span class="p">,</span> <span class="nx">my</span> <span class="nx">name</span> <span class="k">is</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">first</span><span class="p">}</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">last</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<p>如果同一个方法有多个装饰器，会像剥洋葱一样，先从外到内进入，然后由内向外执行。</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">dec</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span><span class="o">:</span> <span class="nx">MethodDecorator</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;evaluated&#39;</span><span class="p">,</span> <span class="nx">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;executed&#39;</span><span class="p">,</span> <span class="nx">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">Example</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="kd">@dec</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">@dec</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nx">method</span><span class="p">(){}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// evaluated 1
</span></span></span><span class="line"><span class="cl"><span class="c1">// evaluated 2
</span></span></span><span class="line"><span class="cl"><span class="c1">// executed 2
</span></span></span><span class="line"><span class="cl"><span class="c1">// executed 1
</span></span></span></code></pre></div>
</div>
<p>上面代码中，外层装饰器 <code>@dec(1)</code> 先进入，但是内层装饰器 <code>@dec(2)</code> 先执行。</p>
<h2 id="compile编译"><em>Compile</em>^编译^</h2>
<p><em>TypeScript</em> 通过 <code>tsconfig.json</code> 修改编译选项，可以：</p>
<ol>
<li>用于标识 <em>TypeScript</em> 项目的根路径</li>
<li>用于配置 <em>TypeScript</em> 编译器</li>
<li>用于指定编译的文件</li>
</ol>
<h3 id="field重要字段"><em>Field</em>^重要字段^</h3>
<ol>
<li><em>files</em> - 设置要编译的文件的名称</li>
<li><em>include</em> - 设置需要进行编译的文件，支持路径模式匹配</li>
<li><em>exclude</em> - 设置无需进行编译的文件，支持路径模式匹配</li>
<li><em>compilerOptions</em> - 设置与编译流程相关的选项</li>
</ol>
<h4 id="compileroptions选项"><em>CompilerOptions</em>^选项^</h4>
<p><em>compilerOptions</em> 支持很多选项，常见的有 <code>baseUrl</code>、 <code>target</code>、<code>baseUrl</code>、 <code>moduleResolution</code> 和 <code>lib</code> 等。</p>
<p><em>compilerOptions</em> 每个选项的详细说明如下：</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;compilerOptions&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="err">/*</span> <span class="err">基本选项</span> <span class="err">*/</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;target&#34;</span><span class="p">:</span> <span class="s2">&#34;es5&#34;</span><span class="p">,</span>                       <span class="c1">// 指定 ECMAScript 目标版本: &#39;ES3&#39; (default), &#39;ES5&#39;, &#39;ES6&#39;/&#39;ES2015&#39;, &#39;ES2016&#39;, &#39;ES2017&#39;, or &#39;ESNEXT&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;module&#34;</span><span class="p">:</span> <span class="s2">&#34;commonjs&#34;</span><span class="p">,</span>                  <span class="c1">// 指定使用模块: &#39;commonjs&#39;, &#39;amd&#39;, &#39;system&#39;, &#39;umd&#39; or &#39;es2015&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;lib&#34;</span><span class="p">:</span> <span class="p">[],</span>                             <span class="c1">// 指定要包含在编译中的库文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;allowJs&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>                       <span class="c1">// 允许编译 javascript 文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;checkJs&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>                       <span class="c1">// 报告 javascript 文件中的错误
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;jsx&#34;</span><span class="p">:</span> <span class="s2">&#34;preserve&#34;</span><span class="p">,</span>                     <span class="c1">// 指定 jsx 代码的生成: &#39;preserve&#39;, &#39;react-native&#39;, or &#39;react&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;declaration&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>                   <span class="c1">// 生成相应的 &#39;.d.ts&#39; 文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;sourceMap&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>                     <span class="c1">// 生成相应的 &#39;.map&#39; 文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;outFile&#34;</span><span class="p">:</span> <span class="s2">&#34;./&#34;</span><span class="p">,</span>                       <span class="c1">// 将输出文件合并为一个文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;outDir&#34;</span><span class="p">:</span> <span class="s2">&#34;./&#34;</span><span class="p">,</span>                        <span class="c1">// 指定输出目录
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;rootDir&#34;</span><span class="p">:</span> <span class="s2">&#34;./&#34;</span><span class="p">,</span>                       <span class="c1">// 用来控制输出目录结构 --outDir.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;removeComments&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>                <span class="c1">// 删除编译后的所有的注释
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;noEmit&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>                        <span class="c1">// 不生成输出文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;importHelpers&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>                 <span class="c1">// 从 tslib 导入辅助工具函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;isolatedModules&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>               <span class="c1">// 将每个文件做为单独的模块 （与 &#39;ts.transpileModule&#39; 类似）.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="err">/*</span> <span class="err">严格的类型检查选项</span> <span class="err">*/</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;strict&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>                        <span class="c1">// 启用所有严格类型检查选项
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;noImplicitAny&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>                 <span class="c1">// 在表达式和声明上有隐含的 any类型时报错
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;strictNullChecks&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>              <span class="c1">// 启用严格的 null 检查
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;noImplicitThis&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>                <span class="c1">// 当 this 表达式值为 any 类型的时候，生成一个错误
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;alwaysStrict&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>                  <span class="c1">// 以严格模式检查每个模块，并在每个文件里加入 &#39;use strict&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="err">/*</span> <span class="err">额外的检查</span> <span class="err">*/</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;noUnusedLocals&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>                <span class="c1">// 有未使用的变量时，抛出错误
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;noUnusedParameters&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>            <span class="c1">// 有未使用的参数时，抛出错误
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;noImplicitReturns&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>             <span class="c1">// 并不是所有函数里的代码都有返回值时，抛出错误
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;noFallthroughCasesInSwitch&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>    <span class="c1">// 报告 switch 语句的 fallthrough 错误。（即，不允许 switch 的 case 语句贯穿）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="err">/*</span> <span class="err">模块解析选项</span> <span class="err">*/</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;moduleResolution&#34;</span><span class="p">:</span> <span class="s2">&#34;node&#34;</span><span class="p">,</span>            <span class="c1">// 选择模块解析策略： &#39;node&#39; (Node.js) or &#39;classic&#39; (TypeScript pre-1.6)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;baseUrl&#34;</span><span class="p">:</span> <span class="s2">&#34;./&#34;</span><span class="p">,</span>                       <span class="c1">// 用于解析非相对模块名称的基目录
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;paths&#34;</span><span class="p">:</span> <span class="p">{},</span>                           <span class="c1">// 模块名到基于 baseUrl 的路径映射的列表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;rootDirs&#34;</span><span class="p">:</span> <span class="p">[],</span>                        <span class="c1">// 根文件夹列表，其组合内容表示项目运行时的结构内容
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;typeRoots&#34;</span><span class="p">:</span> <span class="p">[],</span>                       <span class="c1">// 包含类型声明的文件列表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;types&#34;</span><span class="p">:</span> <span class="p">[],</span>                           <span class="c1">// 需要包含的类型声明文件名列表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;allowSyntheticDefaultImports&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>  <span class="c1">// 允许从没有设置默认导出的模块中默认导入。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="err">/*</span> <span class="err">Source</span> <span class="err">Map</span> <span class="err">Options</span> <span class="err">*/</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;sourceRoot&#34;</span><span class="p">:</span> <span class="s2">&#34;./&#34;</span><span class="p">,</span>                    <span class="c1">// 指定调试器应该找到 TypeScript 文件而不是源文件的位置
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;mapRoot&#34;</span><span class="p">:</span> <span class="s2">&#34;./&#34;</span><span class="p">,</span>                       <span class="c1">// 指定调试器应该找到映射文件而不是生成文件的位置
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;inlineSourceMap&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>               <span class="c1">// 生成单个 soucemaps 文件，而不是将 sourcemaps 生成不同的文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;inlineSources&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>                 <span class="c1">// 将代码与 sourcemaps 生成到一个文件中，要求同时设置了 --inlineSourceMap 或 --sourceMap 属性
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="err">/*</span> <span class="err">其他选项</span> <span class="err">*/</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;experimentalDecorators&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>        <span class="c1">// 启用装饰器
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;emitDecoratorMetadata&#34;</span><span class="p">:</span> <span class="kc">true</span>          <span class="c1">// 为装饰器提供元数据的支持
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
</div>
<h2 id="module模块"><em>Module</em>^模块^</h2>
<p>Solve - Cannot find module &lsquo;fs&rsquo; Error in TypeScript | bobbyhadz</p>

    <figure class="island text-base mb-4 not-prose">
        <blockquote class="island-body" >
            <h2 id="excerpt">Excerpt</h2>
<p>To solve the &ldquo;Cannot find module <code>fs</code> or its corresponding type declarations&rdquo; error, install the types for node by running the command <code>npm i -D @types/node</code>. You can then import <code>fs</code> with the following line of code <code>import * as fs from 'fs'</code>.</p>
        </blockquote>
        
    </figure>

<hr>
<p>Solve - Cannot find module &lsquo;fs&rsquo; Error in TypeScript <a href="https://bobbyhadz.com/blog/typescript-cannot-find-module-fs#solve---cannot-find-module-fs-error-in-typescript">#</a></p>
<p><strong>To solve the &ldquo;Cannot find module <code>fs</code> or its corresponding type declarations&rdquo; error, install the types for node by running the command <code>npm i -D @types/node</code>. You can then import <code>fs</code> with the following line of code <code>import * as fs from 'fs'</code>.</strong></p>
<p><img src="https://bobbyhadz.com/images/blog/typescript-cannot-find-module-fs/typescript-cannot-find-module-fs.webp" alt="typescript cannot find module fs"  /></p>
<p>Make sure to install the typings for node, by opening your terminal in your project&rsquo;s root directory and running the following command:</p>
<div class="ui-codeblock">
    
    <div class="ui-htmlblock-container"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">Copied!npm i -D @types/node</span></span></code></pre></div></div>
</div>
<p>This will install the typings for node as a dev dependency in your project.</p>
<p>Now you are able to import the <code>fs</code> module with the following line of code.</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">Copied!import * as fs from <span class="s1">&#39;fs&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">console.log<span class="o">(</span>fs<span class="o">)</span><span class="p">;</span></span></span></code></pre></div>
</div>
<p>If your error has not been resolved, open your <code>tsconfig.json</code> file and make sure the <code>types</code> array contains the string <code>node</code>.</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">Copied!<span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;compilerOptions&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;types&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;node&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>,
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
</div>
<p>This should fix the error and now TypeScript should be able to find the type definitions for the <code>fs</code> module.</p>
<p>If the error is not resolved, try to delete your <code>node_modules</code> and <code>package-lock.json</code> files, re-run <code>npm install</code> and restart your IDE.</p>
<div class="ui-codeblock">
    
    <pre tabindex="0"><code>Copied!rm -rf node_modules package-lock.json

npm install</code></pre>
</div>
<p>Make sure to restart your IDE if the error still persists. VSCode glitches often and a reboot solves things sometimes.</p>
<p>Here is an example of how you would read a file in the same directory named <code>another-file.ts</code> with the <code>fs</code> module using TypeScript.</p>
<div class="ui-codeblock">
    
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">Copied</span><span class="o">!</span><span class="kr">import</span> <span class="o">*</span> <span class="nx">as</span> <span class="nx">fs</span> <span class="nx">from</span> <span class="s1">&#39;fs&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="o">*</span> <span class="nx">as</span> <span class="nx">path</span> <span class="nx">from</span> <span class="s1">&#39;path&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">&#39;./another-file.ts&#39;</span><span class="p">),</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">encoding</span><span class="o">:</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">}),</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span></span></span></code></pre></div>
</div>
<p>And here is the output in my terminal showing the contents of <code>another-file.ts</code>.</p>
<p><img src="https://bobbyhadz.com/images/blog/typescript-cannot-find-module-fs/fs-reading-file-success.webp" alt="fs reading file success"  /></p>
<h2 id="tricks技巧"><em>Tricks</em>^技巧^</h2>
<h3 id="在线工具">在线工具</h3>
<p><kbd>:link: <em>Href</em></kbd> <a href="https://www.typescriptlang.org/play/"><em>TypeScript Playground</em></a></p>
<p><em>TypeScript</em> 官方提供的在线 <em>TypeScript</em> 运行环境，利用它你可以方便地学习 <em>TypeScript</em> 相关知识与不同版本的功能特性。</p>
<p><kbd>:link: <em>Href</em></kbd> <a href="https://tsuml-demo.firebaseapp.com/"><em>TypeScript UML Playground</em></a></p>
<p>一款在线 TypeScript UML 工具，利用它你可以为指定的 TypeScript 代码生成 UML 类图。</p>
<p><kbd>:link: <em>Href</em></kbd> <a href="https://www.jsontots.com"><em>JSON TO TS</em></a></p>
<p>为指定的 <em>JSON</em> 数据生成对应的 <em>TypeScript</em> 接口定义。</p>
<p><kbd>:link: <em>Href</em></kbd> <a href="https://github.com/SweetIQ/schemats"><em>Schemats</em></a></p>
<p>基于 <em>SQL</em> <em>^(Postgres,MySQL)^</em> 数据库中的 <em>schema</em> 字段自动生成 <em>TypeScript</em> 接口定义。</p>
<p><kbd>:link: <em>Href</em></kbd> <a href="https://ts-ast-viewer.com"><em>TypeScript AST Viewer</em></a></p>
<p>一款 <em>TypeScript AST</em> 在线工具，利用它你可以查看指定 <em>TypeScript</em> 代码对应的 <em>AST</em><sup><em>Abstract Syntax Tree</em></sup> 抽象语法树。</p>
<p><kbd>:link: <em>Href</em></kbd> <a href="https://typedoc.org"><em>TypeDoc</em></a></p>
<p><em>TypeDoc</em> 用于将 <em>TypeScript</em> 源代码中的注释转换为 <em>HTML</em> 文档或 <em>JSON</em> 模型。它可灵活扩展，并支持多种配置。</p>
<p><kbd>:link: <em>Href</em></kbd> <a href="https://typescript-eslint.io"><em>TypeScript ESLint</em></a></p>
<p>使用 <em>TypeScript ESLint (TSLint)</em> 可以帮助我们规范代码质量，提高团队开发效率。</p>
<h3 id="完整性检查"><a href="/techs/07-typescript/#type-wildcard-never-ts-comprehensive-inspection">完整性检查</a></h3>

  </div></div>

        <footer class="ui-footer flex flex-wrap gap-2 justify-between p-4"><time datetime='03/20' class="text-muted flex items-center">

    <i class="icon"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
    <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5" />
</svg>
</i>

    <span class="ms-1">2023-03-20</span>

</time>

</footer>
    </div>

    <div class="grid grid-cols-2 gap-4 text-sm h-14"><a href="/techs/06-ecmascript/"
                class="ui-button ui-interactive flex items-center justify-start p-4" draggable="false">
                <i class="icon mr-1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
  <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5" />
</svg>
</i>
                <span>06 EcmaScript</span>
            </a><a 
                href="/techs/08-async/"
                class="ui-button ui-interactive flex items-center justify-end p-4" draggable="false">
                <span>08 Async</span>
                <i class="icon mr-1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
  <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" />
</svg>
</i>
            </a></div>

</article>
</main>

          <aside class="ui-grid-right">
            <div class="ui-content" id="main-container-right">
    <div class="ui-card" id="toc-container">
            <header class="ui-card-header flex items-center justify-start gap-2 p-4">
                <i class="icon"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-full">
    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12" />
</svg>
</i>
                目录
            </header>
            <div class="ui-body text-muted text-sm p-4">
                <nav class="toc" id="toc-nav"><a href="#typescript" 
                           data-toc-link
                           data-level="1"
                           class="toc-link block py-1 text-base">










<div class="markdown">
    Typescript
  </div></a><a href="#usage%e4%bd%bf%e7%94%a8" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    <em>Usage</em>^使用^
  </div></a><a href="#type%e7%b1%bb%e5%9e%8b" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    <em>Type</em>^类型^
  </div></a><a href="#basic%e5%9f%ba%e6%9c%ac%e7%b1%bb%e5%9e%8b" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Basic</em>^基本类型^
  </div></a><a href="#reference%e5%bc%95%e7%94%a8%e7%b1%bb%e5%9e%8b" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Reference</em>^引用类型^
  </div></a><a href="#wildcard%e9%80%9a%e9%85%8d%e7%b1%bb%e5%9e%8b" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Wildcard</em>^通配类型^
  </div></a><a href="#enum%e6%9e%9a%e4%b8%be" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Enum</em>^枚举^
  </div></a><a href="#literal%e5%ad%97%e9%9d%a2%e9%87%8f%e7%b1%bb%e5%9e%8b" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Literal</em>^字面量类型^
  </div></a><a href="#aliases%e7%b1%bb%e5%9e%8b%e5%88%ab%e5%90%8d" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Aliases</em>^类型别名^
  </div></a><a href="#assertion%e6%96%ad%e8%a8%80" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    <em>Assertion</em>^断言^
  </div></a><a href="#as%e7%b1%bb%e5%9e%8b%e6%96%ad%e8%a8%80" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>As</em>^类型断言^
  </div></a><a href="#asas%e5%8f%8c%e9%87%8d%e6%96%ad%e8%a8%80" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>As^..as..^</em>^双重断言^
  </div></a><a href="#for-key%e7%a1%ae%e5%ae%9a%e8%b5%8b%e5%80%bc%e6%96%ad%e8%a8%80" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>!^for-key^</em>^确定赋值断言^
  </div></a><a href="#for-value%e9%9d%9e%e7%a9%ba%e6%96%ad%e8%a8%80" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>!^for-value^</em>^非空断言^
  </div></a><a href="#guards%e7%b1%bb%e5%9e%8b%e5%ae%88%e5%8d%ab" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    <em>Guards</em>^类型守卫^ <sup id="type-guards-ts"> </sup>
  </div></a><a href="#in%e6%88%90%e5%91%98%e6%a3%80%e6%b5%8b" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>In</em>^成员检测^
  </div></a><a href="#typeof%e7%b1%bb%e5%9e%8b%e6%a3%80%e6%b5%8b" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Typeof</em>^类型检测^
  </div></a><a href="#instanceof%e5%ae%9e%e4%be%8b%e6%a3%80%e6%b5%8b" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Instanceof</em>^实例检测^
  </div></a><a href="#is" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Is</em>
  </div></a><a href="#combine%e7%b1%bb%e5%9e%8b%e7%bb%84%e5%90%88" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    <em>Combine</em>^类型组合^
  </div></a><a href="#union%e8%81%94%e5%90%88%e7%b1%bb%e5%9e%8b" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Union</em>^联合类型^<em>^|^</em>
  </div></a><a href="#intersect%e4%ba%a4%e5%8f%89%e7%b1%bb%e5%9e%8b" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Intersect</em>^交叉类型^<em>^&amp;^</em>
  </div></a><a href="#interfaces%e6%8e%a5%e5%8f%a3" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    <em>Interfaces</em>^接口^
  </div></a><a href="#shape%e5%af%b9%e8%b1%a1%e7%9a%84%e5%bd%a2%e7%8a%b6" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Shape</em>^对象的形状^
  </div></a><a href="#%e5%8f%af%e9%80%89%e5%b1%9e%e6%80%a7" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>?</em>^可选属性^
  </div></a><a href="#any%e4%bb%bb%e6%84%8f%e5%b1%9e%e6%80%a7" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Any</em>^任意属性^
  </div></a><a href="#readonly%e5%8f%aa%e8%af%bb%e5%b1%9e%e6%80%a7" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Readonly</em>^只读属性^<sup id="interface-readonly-ts"> </sup>
  </div></a><a href="#signatures%e7%b4%a2%e5%bc%95%e7%ad%be%e5%90%8d" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Signatures</em>^索引签名^
  </div></a><a href="#mapped%e6%98%a0%e5%b0%84%e7%b1%bb%e5%9e%8b" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Mapped</em>^映射类型^
  </div></a><a href="#distinguish%e8%be%a8%e5%88%ab" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    ^⭐️^<em>Distinguish</em>^辨别^
  </div></a><a href="#class%e7%b1%bb" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    <em>Class</em>^类^
  </div></a><a href="#basic%e5%9f%ba%e6%9c%ac%e6%96%b9%e6%b3%95" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Basic</em>^基本方法^
  </div></a><a href="#modifier%e4%bf%ae%e9%a5%b0%e7%ac%a6" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Modifier</em>^修饰符^
  </div></a><a href="#extends%e7%bb%a7%e6%89%bf" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Extends</em>^继承^
  </div></a><a href="#implements%e5%ae%9e%e7%8e%b0" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Implements</em>^实现^
  </div></a><a href="#abstract%e6%8a%bd%e8%b1%a1%e7%b1%bb" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Abstract</em>^抽象类^
  </div></a><a href="#override--overload%e9%87%8d%e5%86%99%e5%92%8c%e9%87%8d%e8%bd%bd" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Override &amp; overload</em>^重写和重载^
  </div></a><a href="#infer%e7%b1%bb%e5%9e%8b%e6%8e%a8%e6%96%ad" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Infer</em>^类型推断^
  </div></a><a href="#generics%e6%b3%9b%e5%9e%8b" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    <em>Generics</em>^泛型^
  </div></a><a href="#interface%e6%b3%9b%e5%9e%8b%e6%8e%a5%e5%8f%a3" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Interface</em>^泛型接口^
  </div></a><a href="#class%e6%b3%9b%e5%9e%8b%e7%b1%bb" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Class</em>^泛型类^
  </div></a><a href="#operator%e6%93%8d%e4%bd%9c%e7%ac%a6" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Operator</em>^操作符^
  </div></a><a href="#complex%e5%a4%8d%e5%90%88%e7%b1%bb%e5%9e%8b" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Complex</em>^复合类型^
  </div></a><a href="#decorator%e8%a3%85%e9%a5%b0%e5%99%a8" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    <em>Decorator</em>^装饰器^
  </div></a><a href="#class%e7%b1%bb%e8%a3%85%e9%a5%b0%e5%99%a8" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Class</em>^类装饰器^
  </div></a><a href="#property%e5%b1%9e%e6%80%a7%e8%a3%85%e9%a5%b0%e5%99%a8" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Property</em>^属性装饰器^
  </div></a><a href="#method%e6%96%b9%e6%b3%95%e8%a3%85%e9%a5%b0%e5%99%a8" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Method</em>^方法装饰器^
  </div></a><a href="#parameter%e5%8f%82%e6%95%b0%e8%a3%85%e9%a5%b0%e5%99%a8" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Parameter</em>^参数装饰器^
  </div></a><a href="#usage%e5%ba%94%e7%94%a8" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Usage</em>^应用^
  </div></a><a href="#compile%e7%bc%96%e8%af%91" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    <em>Compile</em>^编译^
  </div></a><a href="#field%e9%87%8d%e8%a6%81%e5%ad%97%e6%ae%b5" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <em>Field</em>^重要字段^
  </div></a><a href="#module%e6%a8%a1%e5%9d%97" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    <em>Module</em>^模块^
  </div></a><a href="#excerpt" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    Excerpt
  </div></a><a href="#tricks%e6%8a%80%e5%b7%a7" 
                                   data-toc-link
                                   data-level="2"
                                   class="toc-link block py-1 pl-4 text-sm">










<div class="markdown">
    <em>Tricks</em>^技巧^
  </div></a><a href="#%e5%9c%a8%e7%ba%bf%e5%b7%a5%e5%85%b7" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    在线工具
  </div></a><a href="#%e5%ae%8c%e6%95%b4%e6%80%a7%e6%a3%80%e6%9f%a5" 
                                           data-toc-link
                                           data-level="3"
                                           class="toc-link block py-0.5 pl-8 text-xs">










<div class="markdown">
    <a href="#type-wildcard-never-ts-comprehensive-inspection">完整性检查</a>
  </div></a></nav>
            </div>
        </div>

        
          
            <script src="/js/toc.8604a31f519eceda306690e4c19046496d448aae30653aea919df268e9100af7.js" integrity="sha256-hgSjH1GeztowZpDkwZBGSW1Eiq4wZTrqkZ3yaOkQCvc=" defer></script>
          
        
</div>
          </aside>
        </div>

        <footer>
          <div class="ui-grid">
            <aside class="ui-grid-left">
              <div class="ui-content"></div>
            </aside>

            <main class="ui-grid-main"></main>

            <aside class="ui-grid-right">
              <div class="ui-content"></div>
            </aside>
          </div>

          <div class="ui-page-footer ui-footer mt-8 ui-base col-span-full">
            <div class="py-6 flex flex-col gap-1 items-center justify-center">
              <p>
                &copy;&nbsp;Peter&#39;s Blog
              </p>
              <p class="text-xs text-muted">
                <text id="copyright"></text> All rights reserved.
              </p>
            </div>
          </div>
        </footer>
      </div>
    </div>
  </div>

  <button id="scroll-to-top" class="ui-button ui-interactive fixed bottom-4 right-8 z-50 p-4 invisible"
    aria-label="回到顶部"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
  <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 15.75 7.5-7.5 7.5 7.5" />
</svg>
</button>
</body>

</html>