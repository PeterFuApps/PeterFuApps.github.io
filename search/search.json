[{"content":"","date":"2025-06-10","section":"about","summary":"","title":"About","url":"/about/about/"},{"content":"Symbol â\nâœ…\nâ˜•ï¸ Q\u0026amp;A\nğŸ§ [Q]\nğŸ¤” [A]\nğŸ“ Note\nğŸ’¡ Trick\nğŸ“ƒ Example\nğŸ“ Location\nâ˜•ï¸ Pros \u0026amp; Cons\nğŸ§ª Experimental\nğŸ§ª Experimental\nğŸ—‘ Depreciated\nâ­ï¸ Important\nâ“ Question\nğŸ§© Solution\nâš ï¸ Caution\nâ—ï¸ Warning\nâ³ Future\nğŸ”— Href\n[ES5](04 JavaScript.md#\n[ES6](05 EcmaScript.md/#\n./node_modules/.bin/vue-cli-service serve\nU+203B â€» REFERENCE MARK\nğŸš«\nÂ¶\n:anchor:\nğŸ”— Href [ES5](04 JavaScript.md#1)\nğŸ”— Href [ES6](05 EcmaScript.md/#array-es6)\nğŸ”— Href [TS](06 TypeScript.md/#array-es6)\n^sup^\n^object^\n^array^\n^number^\n^string^\n^function^\n^prototype^\nInline image ","date":"2023-03-20","section":"techs","summary":"Symbol â\nâœ…\nâ˜•ï¸ Q\u0026amp;A\nğŸ§ [Q]\nğŸ¤” [A]\nğŸ“ Note\nğŸ’¡ Trick\nğŸ“ƒ Example\nğŸ“ Location\nâ˜•ï¸ Pros \u0026amp; Cons\nğŸ§ª Experimental\nğŸ§ª Experimental\nğŸ—‘ Depreciated\nâ­ï¸ Important\nâ“ Question\nğŸ§© Solution\nâš ï¸ Caution\nâ—ï¸ Warning\nâ³ Future\nğŸ”— Href\n[ES5](04 JavaScript.md#\n[ES6](05 EcmaScript.md/#\n./node_modules/.bin/vue-cli-service serve\nU+203B â€» REFERENCE MARK\nğŸš«\nÂ¶\n:anchor:\nğŸ”— Href [ES5](04 JavaScript.md#1)\nğŸ”— Href [ES6](05 EcmaScript.md/#array-es6)\nğŸ”— Href [TS](06 TypeScript.md/#array-es6)\n","title":"00 Symbol","url":"/techs/00-symbol/"},{"content":"Git æ§åˆ¶ ç‰ˆæœ¬æ§åˆ¶ç”¨æ¥è®°å½•æ–‡ä»¶å˜åŒ–ï¼Œå› æ­¤ä¹Ÿç§°ä¹‹ â€œç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿâ€œ\nä¼˜ç‚¹ï¼šæ“ä½œç®€ä¾¿ æ˜“äºå¯¹æ¯” æ˜“äºå›æº¯ ä¸æ˜“ä¸¢å¤± åä½œæ–¹ä¾¿\næœ¬åœ°ç‰ˆæœ¬æ§åˆ¶ â†’ é›†ä¸­åŒ–*^SVN^* â†’ åˆ†å¸ƒå¼*^Git^* çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ\né…ç½® ğŸ”— Href git å®˜ç½‘\né¦–å…ˆéœ€è¦è®¾ç½®è‡ªå·±çš„ ç”¨æˆ·å å’Œ é‚®ä»¶åœ°å€ ã€‚\n# ä½¿ç”¨ --global é€‰é¡¹æ—¶ï¼Œè¯¥å‘½ä»¤åªéœ€è¦è¿è¡Œä¸€æ¬¡ï¼Œå³å¯æ°¸ä¹…ç”Ÿæ•ˆ git config --global user.name \u0026#34;User Name\u0026#34; git config --global user.email \u0026#34;useremail@host.com\u0026#34; æ·»åŠ  --global å‚æ•°æ—¶ï¼Œå°†åœ¨ç”¨æˆ·æ–‡ä»¶å¤¹ ~ æ–°å»ºä¸€ä¸ª .gitconfig ä¿å­˜å…¨å±€é…ç½®ã€‚\n[user] email = useremail@host.com name = User Name åœ¨ç»ˆç«¯æŸ¥çœ‹ï¼š\n# æŸ¥çœ‹æ‰€æœ‰çš„å…¨å±€é…ç½®é€‰é¡¹ git config --list --global # æŸ¥çœ‹æŒ‡å®šçš„å…¨å±€é…ç½®é¡¹ git config user.name git config user.email æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯ï¼š\n# è¦æƒ³æ‰“å¼€ git config å‘½ä»¤çš„å¸®åŠ©æ‰‹å†Œ git help config # è·å–å‘½ä»¤çš„å¿«é€Ÿå‚è€ƒ git config -h æ›¿æ¢ æœ‰æ—¶ä¸¤å°ç”µè„‘ä¸­çš„ç”¨æˆ·é…ç½®ä¿¡æ¯ä¸ä¸€è‡´ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹çš„è„šæœ¬è¿›è¡ŒåŒæ­¥ã€‚\nGit, rewrite previous commit usernames and emails\nYou can add this alias:\n# Linux ç‰ˆæœ¬ # fixed for \u0026#34;eval: [[: not found\u0026#34; on ubuntu and add a confirm git config --global alias.change-commits = \u0026#34;!f() { VAR1=$1; VAR=\u0026#39;$\u0026#39;$1; OLD=$2; NEW=$3; echo \\\u0026#34;Are you sure for replace $VAR $OLD =\u0026gt; $NEW ?(Y/N)\\\u0026#34;;read OK;if [ \\\u0026#34;$OK\\\u0026#34; = \u0026#39;Y\u0026#39; ] ; then shift 3; git filter-branch --env-filter \\\u0026#34;if [ \\\\\\\u0026#34;${VAR}\\\\\\\u0026#34; = \u0026#39;$OLD\u0026#39; ]; then export $VAR1=\u0026#39;$NEW\u0026#39;;echo \u0026#39;to $NEW\u0026#39;; fi\\\u0026#34; $@; fi;}; f \u0026#34; To change the author name:\ngit change-commits GIT_AUTHOR_NAME \u0026#34;old name\u0026#34; \u0026#34;new name\u0026#34; or the email for only the last 10 commits:\ngit change-commits GIT_AUTHOR_EMAIL \u0026#34;old@email.com\u0026#34; \u0026#34;new@email.com\u0026#34; HEAD~10..HEAD git filter-branch -f --env-filter \\ \u0026#34;GIT_AUTHOR_NAME=\u0026#39;Newname\u0026#39;; GIT_AUTHOR_EMAIL=\u0026#39;newemail\u0026#39;; \\ GIT_COMMITTER_NAME=\u0026#39;committed-name\u0026#39;; GIT_COMMITTER_EMAIL=\u0026#39;committed-email\u0026#39;;\u0026#34; HEAD \u0026hellip;to push the changed history on the original repository use:\ngit push origin +yourbranch git push --force #æš´åŠ›åŒæ­¥ æ¦‚å¿µ Git ä¸­çš„åŒºåŸŸåˆ†ä¸º å·¥ä½œåŒºã€æš‚å­˜åŒºã€å­˜å‚¨åŒºï¼ˆGit ä»“åº“ï¼‰\nå·²ä¿®æ”¹^modified^ â†’ å·²æš‚å­˜^staged^ â†’ å·²æäº¤^committed^\nå·¥ä½œåŒº: å¤„ç†å·¥ä½œçš„åŒºåŸŸ æš‚å­˜åŒº: å·²å®Œæˆå·¥ä½œçš„ä¸´æ—¶å­˜æ”¾åŒºåŸŸï¼Œç­‰å¾…è¢«æäº¤ Gitä»“åº“: æœ€ç»ˆçš„å­˜æ”¾åŒºåŸŸ Working Directory âŸ¹ Staged Fixes âŸ¹Staged Fixes Staging Area âŸ¹ Commit âŸ¹Commit .git directory^Repostory^\nå·¥ä½œåŒº ä»¥ä¸Šä¸¤ç§æ–¹å¼éƒ½èƒ½å¤Ÿåˆ›å»ºgitä»“åº“\nå°†å°šæœªè¿›è¡Œç‰ˆæœ¬æ§åˆ¶çš„æœ¬åœ°ç›®å½•è½¬æ¢ä¸º Git ä»“åº“\nåœ¨é¡¹ç›®ç›®å½•ä¸­ï¼Œæ‰“å¼€ git bash\næ‰§è¡Œ git init å‘½ä»¤å°†å½“å‰çš„ç›®å½•è½¬åŒ–ä¸º git ä»“åº“\nğŸ“ Note git init å‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ªåä¸º .git çš„éšè—ç›®å½•ï¼Œè¿™ä¸ªç›®å½•å°±æ˜¯å½“å‰é¡¹ç›®çš„ä»“åº“\nä»å…¶å®ƒæœåŠ¡å™¨å…‹éš†ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ Git ä»“åº“\nçŠ¶æ€\nå·¥ä½œåŒºä¸­çš„æ¯ä¸ªæ–‡ä»¶æœ‰ 4 ç§å¯èƒ½çš„çŠ¶æ€ï¼Œè¿™4ç§çŠ¶æ€åˆåˆ†ä¸ºä¸¤å¤§ç±»ï¼š\næœªè¢« git ç®¡ç†çš„è½¯ä»¶\næœªè·Ÿè¸ª^untracked^ï¼šä¸è¢« git æ‰€ç®¡ç†çš„æ–‡ä»¶ å·²è¢« git ç®¡ç†\næœªä¿®æ”¹^Unmodified^ - æ–‡ä»¶å†…å®¹ä¸ git ä»“åº“ä¸­çš„å†…å®¹ä¿æŒä¸€è‡´ å·²ä¿®æ”¹^Modified^ - å·¥ä½œåŒºçš„å†…å®¹å’Œ git ä»“åº“ä¸­çš„ä¸ä¸€è‡´ å·²æš‚å­˜^Staged^ - å·¥ä½œåŒºä¸­è¢«ä¿®æ”¹çš„æ–‡ä»¶è¢«æ”¾åˆ°æš‚å­˜åŒº git æ“ä½œçš„ç»ˆæç»“æœï¼šè®©å·¥ä½œåŒºçš„æ–‡ä»¶éƒ½å¤„äºâ€œæœªä¿®æ”¹â€çš„çŠ¶æ€ã€‚\nå¯ä»¥ä½¿ç”¨ git status å‘½ä»¤æŸ¥çœ‹æ–‡ä»¶å¤„äºä»€ä¹ˆçŠ¶æ€ï¼Œä¾‹å¦‚ï¼š\n\u0026gt; git status On branch master No commits yet Untracked files: ... ğŸ“ Note æœªè·Ÿè¸ªçš„æ–‡ä»¶æ„å‘³ç€ git åœ¨ä¹‹å‰çš„å¿«ç…§ï¼ˆæäº¤ï¼‰ä¸­æ²¡æœ‰è¿™äº›æ–‡ä»¶ï¼›git ä¸ä¼šè‡ªåŠ¨çº³å…¥è·Ÿè¸ªèŒƒå›´ ï¼Œé™¤éæ˜ç¡®æ·»åŠ ã€‚\næ·»åŠ  -s æˆ– --short å¯ä»¥ä»¥ç²¾ç®€çš„æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶çš„çŠ¶æ€ï¼š\n# ä»¥ç²¾ç®€çš„æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶çš„çŠ¶æ€ git status æœªè·Ÿè¸ª æ–‡ä»¶ä»¥ ?? è¡¨ç¤º æ–°æ·»åŠ åˆ°æš‚å­˜åŒº çš„æ–‡ä»¶ä»¥ A è¡¨ç¤º å·²è·Ÿè¸ª å‘ç”Ÿå˜åŒ– ä½† æœªæ·»åŠ åˆ°æš‚å­˜åŒº çš„æ–‡ä»¶ä»¥ M è¡¨ç¤º å·²è·Ÿè¸ª å‘ç”Ÿå˜åŒ– ä¸” æ”¾å…¥æš‚å­˜åŒº ä»¥ M è¡¨ç¤º å·²ä» git ä»“åº“ \u0026amp; å·¥ä½œåŒºä¸­ ç§»é™¤ ä»¥ D è¡¨ç¤º è·Ÿè¸ªæ–°æ–‡ä»¶ ä½¿ç”¨ git add å¼€å§‹è·Ÿè¸ªä¸€ä¸ªæ–‡ä»¶ã€‚æ‰€ä»¥ï¼Œè¦è·Ÿè¸ª index.html æ–‡ä»¶ï¼Œè¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤å³å¯ï¼š\ngit add index.html æ­¤æ—¶å†è¿è¡Œ git status å‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ° index.html æ–‡ä»¶åœ¨ Changes to be committed è¿™è¡Œçš„ä¸‹é¢ï¼Œè¯´æ˜ å·²è¢«è·Ÿè¸ª ï¼Œå¹¶å¤„äº æš‚å­˜çŠ¶æ€ ã€‚\nç§»é™¤è·Ÿè¸ª\nä½¿ç”¨ git reset HEAD è¦ç§»é™¤çš„æ–‡ä»¶åç§° å°†æ–‡ä»¶ä»æš‚å­˜åŒºä¸­ç§»é™¤\næš‚å­˜åŒº ç°åœ¨æš‚å­˜åŒºä¸­æœ‰ä¸€ä¸ª index.html æ–‡ä»¶ç­‰å¾…è¢«æäº¤åˆ° git ä»“åº“ä¸­è¿›è¡Œä¿å­˜ã€‚å¯ä»¥æ‰§è¡Œ git commit å‘½ä»¤è¿›è¡Œæäº¤ï¼Œå…¶ä¸­ ``-m` é€‰é¡¹åé¢æ˜¯æœ¬æ¬¡çš„æäº¤æ¶ˆæ¯ï¼Œç”¨æ¥å¯¹æäº¤çš„å†…å®¹åšè¿›ä¸€æ­¥çš„æè¿°ã€‚\ngit commit -m \u0026#34;æ–°å»ºäº†index.htmlæ–‡ä»¶\u0026#34; æ­¤æ—¶å†è¿›è¡Œæ£€æŸ¥ï¼Œå¾—åˆ° clean çš„æç¤ºï¼š\n\u0026gt; git status On branch master nothing to commit, working tree clean ä¸ºäº†æ–¹ä¾¿æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨ git add . ä¸€æ¬¡æ€§å°†æ‰€æœ‰æ–°å¢åŠ å’Œä¿®æ”¹è¿‡çš„æ–‡ä»¶åŠ å…¥æš‚å­˜åŒº\nä¿®æ”¹ ç›®å‰ï¼Œindex.html æ–‡ä»¶å·²ç»è¢« git è·Ÿè¸ªï¼Œå¹¶ä¸”å·¥ä½œåŒºå’Œ git ä»“åº“ä¸­çš„ index.html æ–‡ä»¶å†…å®¹ä¿æŒä¸€è‡´ã€‚å½“æˆ‘ä»¬ä¿®æ”¹äº†å·¥ä½œåŒºä¸­ index.html çš„å†…å®¹ä¹‹åï¼Œå†æ¬¡è¿è¡Œ git status å’Œ git status-s å‘½ä»¤ï¼Œä¼šçœ‹åˆ°å¦‚ä¸‹çš„å†…å®¹:\n\u0026gt; git status On branch master Changes not staged for commit: (use \u0026#34;git add \u0026lt;file\u0026gt; ...\u0026#34; to update what will be committed) (use \u0026#34;git checkout --- \u0026lt;file\u0026gt; ...\u0026#34; to discard changes in working directory) modified index.html \u0026gt; git status -s M index.html æ–‡ä»¶ index.html å‡ºç°åœ¨ Changes not staged for commit è¿™è¡Œä¸‹é¢ï¼Œè¯´æ˜å·²è·Ÿè¸ªæ–‡ä»¶çš„å†…å®¹å‘ç”Ÿäº†å˜åŒ–ï¼Œä½†è¿˜æ²¡æœ‰æ”¾åˆ°æš‚å­˜åŒºã€‚\nä¿å­˜ å†æ¬¡è¿è¡Œ git commit-m \u0026quot;æäº¤æ¶ˆæ¯\u0026quot; å‘½ä»¤ï¼Œå³å¯å°† æš‚å­˜åŒº ä¸­è®°å½•çš„ index.html çš„å¿«ç…§ï¼Œæäº¤åˆ° git ä»“åº“ä¸­è¿›è¡Œä¿å­˜ï¼š\n\u0026gt; git commit -m \u0026#34;åˆå§‹åŒ–äº†index.htmlä¸­çš„å†…å®¹\u0026#34; [master 5467a] åˆå§‹åŒ–äº† index.html ä¸­çš„å†…å®¹ 1 file changed, 14 insertions(+) \u0026gt; git status -s On branch master nothing to commit, woring tree clean æ¢å¤ æ’¤é”€å¯¹æ–‡ä»¶çš„ä¿®æ”¹æŒ‡çš„æ˜¯ï¼šæŠŠå¯¹å·¥ä½œåŒºä¸­å¯¹åº”æ–‡ä»¶çš„ä¿®æ”¹ï¼Œè¿˜åŸæˆ git ä»“åº“ä¸­ä¿å­˜çš„ç‰ˆæœ¬^checkpoint^ ã€‚\nâ—ï¸ Warning æ‰€æœ‰çš„ä¿®æ”¹ä¼šä¸¢å¤±ï¼Œä¸”æ— æ³•æ¢å¤ã€‚\nä½¿ç”¨ git checkout -- index.html å‘½ä»¤ï¼Œæ’¤é”€å¯¹ index.html æ–‡ä»¶çš„ä¿®æ”¹ã€‚\nğŸ“ Note æ’¤é”€æ“ä½œçš„æœ¬è´¨å°±æ˜¯ç”¨ git ä»“åº“é‡Œä¿å­˜çš„æ–‡ä»¶è¦†ç›–å·¥ä½œåŒºä¸­æŒ‡å®šçš„æ–‡ä»¶\nç›´æ¥ä¿å­˜ git æ ‡å‡†çš„å·¥ä½œæµç¨‹æ˜¯ å·¥ä½œåŒº â†’ æš‚å­˜åŒº â†’ git ä»“åº“ï¼Œä½†æœ‰æ—¶å€™è¿™ä¹ˆåšç•¥æ˜¾ç¹çã€‚æ­¤æ—¶å¯ä»¥è·³è¿‡æš‚å­˜åŒºï¼Œç›´æ¥å°†å·¥ä½œåŒºä¸­çš„ä¿®æ”¹æäº¤åˆ° gitä»“åº“ã€‚è¿™æ—¶å€™ git å·¥ä½œçš„æµç¨‹ç®€åŒ–ä¸ºäº†å·¥ä½œåŒº â†’ git ä»“åº“ã€‚\nä½¿ç”¨ git commit -a å‘½ä»¤ï¼Œå³å¯ç›´æ¥å°†æœ¬ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ä¸€å¹¶æäº¤ä»“åº“ï¼Œä»è€Œè·³è¿‡ git add æ­¥éª¤ã€‚\ngit commit -a -m \u0026#34;æè¿°æ¶ˆæ¯\u0026#34; ç›¸å½“äºï¼š\ngit add . git commit -m \u0026#34;æè¿°æ¶ˆæ¯\u0026#34; è½¬ç§» æš‚å­˜å½“å‰æ›´æ”¹ï¼š\ngit \u0026gt; Stash \u0026gt; Stash (Include Untracked)\nCreate stash as patch\ngit stash show \u0026#34;stash@{0}\u0026#34; -p \u0026gt; changes.patch Apply stash\ngit apply changes.patch å­˜å‚¨åŒº ç§»é™¤ ä» git ä»“åº“ä¸­ç§»é™¤æ–‡ä»¶çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š\nä» git ä»“åº“å’Œå·¥ä½œåŒºä¸­ åŒæ—¶ç§»é™¤ å¯¹åº”çš„æ–‡ä»¶ åªä» git ä»“åº“ä¸­ç§»é™¤æŒ‡å®šçš„æ–‡ä»¶ï¼Œä½†ä¿ç•™å·¥ä½œåŒºä¸­å¯¹åº”çš„æ–‡ä»¶ # ä» git ä»“åº“å’Œå·¥ä½œåŒºä¸­åŒæ—¶ç§»é™¤ index.js æ–‡ä»¶ git rm -f index.js # åªä» git ä»“åº“ä¸­ç§»é™¤æŒ‡å®šçš„æ–‡ä»¶ï¼Œä½†ä¿ç•™å·¥ä½œåŒºä¸­å¯¹åº”çš„æ–‡ä»¶ git rm --cached index.css å¿½ç•¥ ä¸€èˆ¬æˆ‘ä»¬æ€»ä¼šæœ‰äº›æ–‡ä»¶æ— éœ€çº³å…¥ git çš„ç®¡ç†ï¼Œä¹Ÿä¸å¸Œæœ›å®ƒä»¬æ€»å‡ºç°åœ¨æœªè·Ÿè¸ªæ–‡ä»¶åˆ—è¡¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªåä¸º .gitignore çš„é…ç½®æ–‡ä»¶ï¼Œåˆ—å‡ºè¦å¿½ç•¥çš„æ–‡ä»¶çš„åŒ¹é…æ¨¡å¼ã€‚\næ–‡ä»¶ .gitignore çš„æ ¼å¼è§„èŒƒå¦‚ä¸‹ï¼š\n# æ³¨é‡Š\nç»“å°¾ /ç›®å½•\nå¼€å¤´ / é˜²æ­¢é€’å½’\n! å–å\nåŒæ—¶å¯ä»¥ä½¿ç”¨ glob æ¨¡å¼è¿›è¡Œæ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„åŒ¹é…ã€‚\nglob è§„åˆ™ï¼š\n? åŒ¹é… ä¸€ä¸ªä»»æ„å­—ç¬¦ * åŒ¹é… é›¶ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ [abc] åŒ¹é… ä»»ä½•ä¸€ä¸ªåˆ—åœ¨æ–¹æ‹¬å·ä¸­çš„å­—ç¬¦ - ç¤ºä¾‹ä¸­ a, b, c å‡å¯ [0-9] åŒ¹é… ä»»ä½•ä¸€ä¸ªåˆ—åœ¨æ–¹æ‹¬å·ä¸­çš„å­—ç¬¦èŒƒå›´å†…æ‰€æœ‰ - ç¤ºä¾‹ä¸­ 0 - 9 å‡å¯ ** åŒ¹é… ä»»æ„ä¸­é—´ç›®å½• - a/**/z åŒ¹é… a/z, a/b/z, a/b/c/z å‡å¯ .gitingnore æ–‡ä»¶ä¾‹å­ï¼š\n# å¿½ç•¥æ‰€æœ‰çš„ .a æ–‡ä»¶ *.a # ä½†è·Ÿè¸ªæ‰€æœ‰çš„ lib.a ï¼Œå³ä½¿å‰é¢å¿½ç•¥äº† .a æ–‡ä»¶ !lib.a # åªå¿½ç•¥å½“å‰ç›®å½•ä¸‹çš„ TODO æ–‡ä»¶ï¼Œè€Œä¸å¿½ç•¥ subdir/TODO /TODO # å¿½ç•¥ä»»ä½•ç›®å½•ä¸‹åä¸º build çš„æ–‡ä»¶å¤¹ build/ # å¿½ç•¥ doc/notes.txtï¼Œä½†ä¸å¿½ç•¥ doc/server/arch.txt doc/*.txt # å¿½ç•¥ doc/ ç›®å½•åŠå…¶æ‰€æœ‰å­—ç›®å½•ä¸‹çš„ .pdf æ–‡ä»¶ doc/**/*.pdf ğŸ“ƒ Example Vue ä¸­è‡ªå¸¦çš„ .gitignore æ–‡ä»¶ # Logs logs *.log npm-debug.log* yarn-debug.log* yarn-error.log* pnpm-debug.log* lerna-debug.log* node_modules .DS_Store dist dist-ssr coverage *.local /cypress/videos/ /cypress/screenshots/ # Editor directories and files .vscode/* !.vscode/extensions.json .idea *.suo *.ntvs* *.njsproj *.sln *.sw? å†å² å¦‚æœå¸Œæœ›å›é¡¾é¡¹ç›®çš„æäº¤å†å²ï¼Œå¯ä»¥ä½¿ç”¨ git log è¿™ä¸ªå‘½ä»¤ã€‚\n# æŒ‰æ—¶é—´å…ˆåé¡ºåºåˆ—å‡ºæ‰€æœ‰çš„æäº¤å†å²ï¼Œæœ€è¿‘çš„æäº¤æ’åœ¨æœ€ä¸Šé¢ git log # åªå±•ç¤ºæœ€æ–°çš„ä¸¤æ¡æäº¤å†å²ï¼Œæ•°å­—å¯ä»¥æŒ‰éœ€å¡«å†™ git log -2 # åœ¨ä¸€è¡Œä¸Šå±•ç¤ºæœ€æ–°ä¸¤æ¡æäº¤å†å²çš„ä¿¡æ¯ git log -2 --pretty=oneline # åœ¨ä¸€è¡Œä¸Šå±•ç¤ºæœ€è¿‘ä¸¤æ¡æäº¤å†å²çš„ä¿¡æ¯ï¼Œå¹¶è‡ªå®šä¹‰è¾“å‡ºçš„æ ¼å¼ # %h æäº¤çš„ç®€å†™å“ˆå¸Œå€¼ # %an ä½œè€…åå­— # %ar ä½œè€…ä¿®è®¢æ—¥æœŸï¼ŒæŒ‰å¤šä¹…ä»¥å‰çš„æ–¹å¼æ˜¾ç¤º # %s æäº¤è¯´æ˜ git log -2 --pretty=format:\u0026#34;%h | %an | %ar | %s\u0026#34; å›é€€ # åœ¨ä¸€è¡Œä¸Šå±•ç¤ºæ‰€æœ‰çš„æäº¤å†å² git log --pretty=oneline # ä½¿ç”¨ git reset --hard å‘½ä»¤ï¼Œæ ¹æ®æŒ‡å®šçš„æäº¤ id å›åˆ°æŒ‡å®šç‰ˆæœ¬ git reset --hard \u0026lt;CommitID\u0026gt; # åœ¨æ—§ç‰ˆæœ¬ä¸­ä½¿ç”¨ git reflog --pretty=online å‘½ä»¤ï¼ŒæŸ¥çœ‹å‘½ä»¤æ“ä½œçš„å†å² git reflog --pretty=online # å†æ¬¡æ ¹æ®æœ€æ–°æäº¤çš„ ID ï¼Œè·³è½¬åˆ°æœ€æ–°çš„ç‰ˆæœ¬ git reset --hard \u0026lt;CommitID\u0026gt; åˆ†æ”¯ è¿›è¡Œå¤šäººåä½œå¼€å‘çš„æ—¶å€™ï¼Œä¸ºäº†é˜²æ­¢äº’ç›¸å¹²æ‰°ã€æé«˜ååŒå¼€å‘çš„ä½“éªŒï¼Œå»ºè®®æ¯ä¸ªå¼€å‘è€…éƒ½åŸºäºåˆ†æ”¯è¿›è¡Œé¡¹ç›®åŠŸèƒ½çš„å¼€å‘ï¼Œæ¯ä¸ªåˆ†æ”¯å¯¹åº”ä¸€ä¸ªå…·ä½“çš„åŠŸèƒ½ï¼Œåˆ†æ”¯ä¹‹é—´äº’ä¸å½±å“ã€‚ä¾‹å¦‚ï¼š\nç™»å½•ï¼š åˆ†æ”¯ login æ³¨å†Œï¼š åˆ†æ”¯ reg æ”¯ä»˜ï¼š åˆ†æ”¯ payment æ‰€æœ‰åŠŸèƒ½å¼€å‘æµ‹è¯•å®Œæ¯•åï¼Œåˆå¹¶åˆ° master ä¸»åˆ†æ”¯ã€‚\nğŸ“ Note åœ¨å®é™…å¼€å‘ä¸­ï¼Œmaster ä¸»åˆ†æ”¯çš„ä½œç”¨æ˜¯ï¼šç”¨æ¥ä¿å­˜å’Œè®°å½•æ•´ä¸ªé¡¹ç›®å·²å®Œæˆçš„åŠŸèƒ½ä»£ç  ã€‚å› æ­¤ï¼Œä¸å…è®¸ç¨‹åºå‘˜ç›´æ¥åœ¨ master åˆ†æ”¯ä¸Šç›´æ¥ä¿®æ”¹ä»£ç ï¼Œå› ä¸ºè¿™æ ·åšçš„é£é™©å¤ªé«˜ï¼Œå®¹æ˜“å¯¼è‡´æ•´ä¸ªé¡¹ç›®å´©æºƒã€‚\nåŠŸèƒ½åˆ†æ”¯ æŒ‡çš„æ˜¯ ä¸“é—¨ç”¨æ¥å¼€å‘æ–°åŠŸèƒ½ çš„åˆ†æ”¯ï¼Œå®ƒæ˜¯ä¸´æ—¶ä» master ä¸»åˆ†æ”¯ä¸Šåˆ†å‰å‡ºæ¥çš„ã€‚å½“æ–°åŠŸèƒ½å¼€å‘ä¸”æµ‹è¯•å®Œæ¯•åï¼Œæœ€ç»ˆéœ€è¦åˆå¹¶åˆ° master ä¸»åˆ†æ”¯ä¸Šã€‚\nåˆ›å»º ä½¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤ï¼Œå¯ä»¥ åŸºäºå½“å‰åˆ†æ”¯åˆ›å»ºä¸€ä¸ªæ–°åˆ†æ”¯ ã€‚æ­¤æ—¶ï¼Œæ–°åˆ†æ”¯ä¸­çš„ä»£ç ä¸å½“å‰åˆ†æ”¯å®Œå…¨ä¸€æ ·ã€‚\ngit branch åˆ†æ”¯åç§° âš ï¸ Caution æ‰§è¡Œä¸‡åˆ›å»ºåˆ†æ”¯çš„å‘½ä»¤åï¼Œç”¨æˆ·æ‰€å¤„çš„è¿˜æ˜¯ åŸæ¥çš„åˆ†æ”¯ ã€‚\nåˆ‡æ¢ åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯è¿›è¡Œå¼€å‘ï¼š\ngit checkout åˆ†æ”¯åç§° åˆ›å»º \u0026amp; åˆ‡æ¢ ä½¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤ï¼Œå¯ä»¥ åˆ›å»ºæŒ‡å®šåç§°çš„æ–°åˆ†æ”¯ ï¼Œå¹¶ ç«‹å³åˆ‡æ¢åˆ°æ–°åˆ†æ”¯ä¸Š ã€‚\n# -b è¡¨ç¤ºåˆ›å»ºä¸€ä¸ªæ–°åˆ†æ”¯ # checkout è¡¨ç¤ºåˆ‡æ¢åˆ°åˆšæ‰æ–°å»ºçš„åˆ†æ”¯ä¸Š git checkout -b åˆ†æ”¯åç§° åˆå¹¶ åŠŸèƒ½åˆ†æ”¯çš„ä»£ç å¼€å‘æµ‹è¯•å®Œæ¯•åï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤ï¼Œå°†å®Œæˆåçš„ä»£ç åˆå¹¶åˆ° master ä¸»åˆ†æ”¯ä¸Šã€‚\n# 1. åˆ‡æ¢åˆ° master åˆ†æ”¯ git checkout master # 2. åœ¨ master åˆ†æ”¯ä¸Šè¿è¡Œ git merge å‘½ä»¤ï¼Œå°† login åˆ†æ”¯çš„ä»£ç åˆå¹¶åˆ° master åˆ†æ”¯ git merge login ğŸ“ƒ Example å‡è®¾è¦æŠŠ C åˆ†æ”¯çš„ä»£ç åˆå¹¶åˆ° A åˆ†æ”¯ï¼Œåˆ™å¿…é¡» å…ˆåˆ‡æ¢åˆ° A åˆ†æ”¯ ä¸Šï¼Œå†è¿è¡Œ git merge å‘½ä»¤ ï¼Œæ¥åˆå¹¶ C åˆ†æ”¯ã€‚\nå†²çªè§£å†³\nå¦‚æœåœ¨ä¸¤ä¸ªä¸åŒçš„åˆ†æ”¯ä¸­ï¼Œå¯¹ åŒä¸€ä¸ªæ–‡ä»¶ è¿›è¡Œäº†ä¸åŒçš„ä¿®æ”¹ï¼Œgit å°±æ²¡æ³•å¹²å‡€çš„åˆå¹¶å®ƒä»¬ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ‰“å¼€è¿™äº›åŒ…å«å†²çªçš„æ–‡ä»¶ç„¶å æ‰‹åŠ¨è§£å†³å†²çª ã€‚\n# å‡è®¾ï¼šåœ¨æŠŠ reg åˆ†æ”¯åˆå¹¶åˆ° master åˆ†æ”¯æœŸé—´ï¼Œä»£ç å‘ç”Ÿäº†å†²çª git checkout master git merge reg # æ‰“å¼€åŒ…å«å†²çªçš„æ–‡ä»¶ï¼Œæ‰‹åŠ¨è§£å†³å†²çªä¹‹åï¼Œå†æ‰§è¡Œå¦‚ä¸‹çš„å‘½ä»¤ git add . git commit -m \u0026#34;è§£å†³äº†åˆ†æ”¯åˆå¹¶å†²çªçš„é—®é¢˜\u0026#34; ğŸ“ Note åˆå¹¶ä¸åŒæ‹¥æœ‰ .git ç›®å½•çš„é¡¹ç›®\nTo combine the two repositories, first add the second repository as a remote to the first. Then, run git fetch to fetch its branch information:\n# åå­—/ä½ç½® git remote add two ../two git fetch two Then merge, with the remote set up, merge the second repositoryâ€™s history into the first by using the --allow-unrelated-histories flag:\n# /main åé¢æ˜¯åˆ†æ”¯åç§°ï¼Œå¦‚æœæ˜¯ git åˆ›å»ºçš„åˆ™æœ‰å¯èƒ½æ˜¯ master git merge two/main --allow-unrelated-histories åˆ é™¤ åˆå¹¶åˆ°ä¸»åˆ†æ”¯åï¼Œå°±å¯ç”¨å¦‚ä¸‹å‘½ä»¤åˆ é™¤å¯¹åº”çš„åŠŸèƒ½åˆ†æ”¯ï¼š\ngit branch -d åˆ†æ”¯åç§° è¿œç¨‹æ¨é€åˆ†æ”¯ ğŸ”— Href è§ è¿œç¨‹ - æ¨é€ éƒ¨åˆ†\nWorkTree // TODO\nrebase git config pull.rebase true å¯ä»¥æœ€å¤§ç¨‹åº¦å‡å°åˆå¹¶å†²çª\n* branch master -\u0026gt; FETCH_HEAD hint: You have divergent branches and need to specify how to reconcile them. hint: You can do so by running one of the following commands sometime before hint: your next pull: hint: hint: git config pull.rebase false # merge hint: git config pull.rebase true # rebase hint: git config pull.ff only # fast-forward only hint: hint: You can replace \u0026#34;git config\u0026#34; with \u0026#34;git config --global\u0026#34; to set a default hint: preference for all repositories. You can also pass --rebase, --no-rebase, hint: or --ff-only on the command line to override the configured default per hint: invocation. fatal: Need to specify how to reconcile divergent branches. è¿œç¨‹ GitHub æ˜¯å…¨çƒæœ€å¤§çš„ å¼€æºé¡¹ç›®æ‰˜ç®¡å¹³å° ã€‚å› ä¸ºåªæ”¯æŒ git ä½œä¸ºå”¯ä¸€çš„ç‰ˆæœ¬æ§åˆ¶å·¥å…·ï¼Œæ•…å GitHub ã€‚\nSo, GitHub â‰  Git\nè®¿é—® æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥è®¿é—®è¿œç¨‹ä»“åº“ï¼š HTTPS å’Œ SSH ã€‚\nHTTPSï¼šé›¶é…ç½®ï¼›æ¯æ¬¡è®¿é—®ä»“åº“æ—¶éœ€è¦é‡å¤è¾“å…¥è´¦å·å¯†ç  SSHï¼šä½¿ç”¨ SSL åè®®ï¼Œé…ç½®å®Œæˆå³å¯ä¸€é”®ç™»å½• HTTPS # æœ¬åœ°æ²¡æœ‰ä»“åº“ # step1 echo \u0026#34;# project1\u0026#34; \u0026gt;\u0026gt; README.md # ä½¿ç”¨ç»ˆç«¯åˆ›å»ºmdæ–‡ä»¶ï¼Œå¹¶å†™å…¥åˆå§‹å†…å®¹ # step2 git init git add README.md git commit -m \u0026#34;first commit\u0026#34; # step3 git remote add origin https://github.com/.../.git # å…³è”è¿œç¨‹ä»“åº“ï¼Œå¹¶å‘½åä¸ºorigin git push -u origin master # æ¨é€è‡³è¿œç¨‹originä»“åº“ä¸­ # æœ¬åœ°æœ‰ç°æˆçš„gitä»“åº“ git remote add origin https://github.com/.../.git git push -u origin master # é¦–æ¬¡æ¨é€ é»˜è®¤æ¨é€ä¸»åˆ†æ”¯master # ä¸‹æ¬¡æ¨é€æ—¶ä½¿ç”¨ git push SSH SSH ç”¨äºå®ç°æœ¬åœ°ä»“åº“å’Œ GitHub ä¹‹é—´ å…ç™»å½• çš„ åŠ å¯†æ•°æ®ä¼ è¾“ã€‚\nSSH Key ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š\nid_rsaï¼šç§é’¥æ–‡ä»¶ï¼Œå­˜æ”¾äºå®¢æˆ·ç«¯çš„ç”µè„‘ id_rsa.pub ï¼šå…¬é’¥æ–‡ä»¶ï¼Œéœ€è¦é…ç½®åœ¨ GitHub ä¸­ ç”Ÿæˆ æ‰“å¼€ git bash\nç²˜è´´å¦‚ä¸‹çš„å‘½ä»¤ï¼Œå¹¶å°† your_email@example.com æ›¿æ¢ä¸ºæ³¨å†Œ GitHub è´¦å·æ—¶å¡«å†™çš„é‚®ç®±ï¼š\nssh-keygen -t rsa -b 4096 -C \u0026#34;your_email@example.com\u0026#34; # è¿œç¨‹å¼€å‘ä½¿ç”¨ ssh-keygen -t rsa -b 1024 -C \u0026#34;\u0026#34; è¿ç»­æ•²å‡» 3 æ¬¡å›è½¦ï¼Œå³åœ¨ ~/.ssh ä¸­ç”Ÿæˆ id_rsa å’Œ id_rsa.pub ä¸¤ä¸ªæ–‡ä»¶ é…ç½® æ‰“å¼€ id_rsa.pub æ–‡ä»¶ï¼Œå¤åˆ¶å…¶ä¸­çš„å†…å®¹ åœ¨æµè§ˆå™¨ä¸­ç™»å½• GitHub ï¼Œç‚¹å‡»å¤´åƒ â†’ Settings â†’ SSH andGPG Keys â†’ New SSH Key å°† id_rsa.pub æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œç²˜è´´åˆ° Key å¯¹åº”çš„æ–‡æœ¬æ¡†ä¸­ åœ¨ Title æ–‡æœ¬æ¡†ä¸­ä»»æ„å¡«å†™ä¸€ä¸ªåç§°ï¼Œæ¥æ ‡è¯†è¿™ä¸ª Key éœ€è¦è¿œç¨‹ç™»å½•æ—¶ï¼Œç›´æ¥å°†å…¬é’¥å¤åˆ¶è‡³ ~/.ssh/authorized_keys å³å¯\nmkdir -p ~/.ssh touch ~/.ssh/authorized_keys éœ€è¦è¿œç¨‹ç™»å½•æ—¶ï¼Œç›´æ¥å°†å…¬é’¥å¤åˆ¶è‡³ ~/.ssh/authorized_keys å³å¯\nmkdir -p ~/.ssh touch ~/.ssh/authorized_keys chmod 600 ~/.ssh/authorized_keys éœ€è¦è¿œç¨‹ç™»å½•æ—¶ï¼Œç›´æ¥å°†å…¬é’¥å¤åˆ¶è‡³ ~/.ssh/authorized_keys å³å¯\nmkdir -p ~/.ssh touch ~/.ssh/authorized_keys chmod 600 ~/.ssh/authorized_keys æ£€æµ‹ æ‰“å¼€ Git Bashï¼Œè¾“å…¥å¦‚ä¸‹çš„å‘½ä»¤å¹¶å›è½¦æ‰§è¡Œï¼š\nssh -T git@github.com é…ç½®æˆåŠŸï¼š\nHi username Youâ€™ve successfully authenticated, but GitHub does not provide shell access.\n# æœ¬åœ°æ²¡æœ‰ä»“åº“ # step1 echo \u0026#34;# project1\u0026#34; \u0026gt;\u0026gt; README.md # ä½¿ç”¨ç»ˆç«¯åˆ›å»ºmdæ–‡ä»¶ï¼Œå¹¶å†™å…¥åˆå§‹å†…å®¹ # step2 git init git add README.md git commit -m \u0026#34;first commit\u0026#34; # step3 git remote add origin git@github.com:username/repository.git git push -u origin master # æ¨é€è‡³è¿œç¨‹originä»“åº“ä¸­ # æœ¬åœ°æœ‰ç°æˆçš„gitä»“åº“ git remote add origin git@github.com:username/repository.git git push -u origin master # é¦–æ¬¡æ¨é€ é»˜è®¤æ¨é€ä¸»åˆ†æ”¯master # ä¸‹æ¬¡æ¨é€æ—¶ä½¿ç”¨ git push åˆ‡æ¢ é€šè¿‡é…ç½® ~/.ssh/config æ–‡ä»¶ï¼Œå¯ä»¥é…ç½®å¤šä¸ªè¿œç¨‹æœåŠ¡å™¨ï¼Œå¹¶è®¾ç½®åˆ«åã€‚è¿™åœ¨æœ‰å¤šä¸ªè¿œç¨‹æœåŠ¡å™¨æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚\nç”Ÿæˆ SSH-Key ssh-keygen -t rsa -b 4096 -C \u0026#39;works_account@mail.com\u0026#39; -f ~/.ssh/github-works_rsa ssh-keygen -t rsa -b 4096 -C \u0026#39;personal_account@mail.com\u0026#39; -f ~/.ssh/github-personal_rsa è¿›å…¥ github ï¼Œåœ¨è®¾ç½®ä¸­ç²˜è´´ç”Ÿæˆçš„ key ä½œä¸ºç§é’¥\nåœ¨ ~/.ssh ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª config æ–‡æ¡£ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š\n# github-works Host github.com-works HostName github.com PreferredAuthentications publickey IdentityFile ~/.ssh/github-works_rsa # github-personal Host github.com-personal HostName github.com PreferredAuthentications publickey IdentityFile ~/.ssh/github-personal_rsa ç”¨ ssh å‘½ä»¤åˆ†åˆ«æµ‹è¯• ssh -T git@github.com-works ssh -T git@github.com-personal github è®¿é—®æˆåŠŸçš„è¯ä¼šè¿”å›å¦‚ä¸‹å†…å®¹ï¼š Hi User! You\u0026#39;ve successfully authenticated, but GitHub does not provide shell access. åˆ†æ”¯ æ¨é€ \u0026amp; å…³è” å¦‚æœæ˜¯ ç¬¬ä¸€æ¬¡ å°† æœ¬åœ°åˆ†æ”¯ æ¨é€åˆ° è¿œç¨‹ä»“åº“ ï¼Œéœ€è¦æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š\n# -u å…³è”æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯ï¼Œåªéœ€è¦ç¬¬ä¸€æ¬¡æ¨é€çš„æ—¶å€™å¸¦ -u å‚æ•° git push -u è¿œç¨‹ä»“åº“çš„åˆ«å æœ¬åœ°åˆ†æ”¯åç§°:è¿œç¨‹åˆ†æ”¯åç§° # å®é™…æ¡ˆä¾‹ git push -u origin payment:pay # å¦‚æœå¸Œæœ›è¿œç¨‹åˆ†æ”¯çš„åç§°å’Œæœ¬åœ°åˆ†æ”¯ä¿æŒåç§°ä¸€è‡´ï¼Œå¯ä»¥å¯¹å‘½ä»¤è¿›è¡Œç®€åŒ– git push -u origin payment # å®Œæ•´å†™æ³• git push --set-upstream origin master ğŸ“ Note ç¬¬ä¸€æ¬¡æ¨é€åˆ†æ”¯éœ€è¦å¸¦ -u å‚æ•°ï¼Œæ­¤åå¯ä»¥ç›´æ¥ä½¿ç”¨ git push æ¨é€ä»£ç åˆ°è¿œç¨‹åˆ†æ”¯ã€‚\nğŸ“ Note github é»˜è®¤çš„åˆ†æ”¯åä¸º main ï¼Œè€Œæœ¬åœ°é»˜è®¤åˆ›å»ºçš„åˆ†æ”¯åä¸º master ã€‚å¯ä»¥é€šè¿‡ git branch -m å‘½ä»¤é‡å‘½åå½“å‰åˆ†æ”¯ã€‚\nåˆ—è¡¨ æŸ¥çœ‹è¿œç¨‹ä»“åº“ä¸­æ‰€æœ‰åˆ†æ”¯åˆ—è¡¨ä¿¡æ¯ï¼š\ngit remote show è¿œç¨‹ä»“åº“åç§° ğŸ“ Note GitHub ä¸­é»˜è®¤ç”Ÿæˆçš„åç§°ç»Ÿä¸€ä¸º origin\n\u0026gt; git remote show origin remote origin Fetch URL: git@github.com:... # ä½¿ç”¨SSHæ–¹å¼ç™»å½• Push URL: git@github.com:... Remote branches: master tracked register tracked Local branches configured for \u0026#39;git pull\u0026#39; master merges with remote master reg merges with remote register Local ref cinfigured for \u0026#39;git push\u0026#39;: # å³ï¼Œåˆå§‹åŒ–æ—¶é…ç½®çš„åˆ†æ”¯ master pushes to master (fast-forwardable) è·Ÿè¸ª è·Ÿè¸ªåˆ†æ”¯æŒ‡çš„æ˜¯ï¼šä»è¿œç¨‹ä»“åº“ä¸­ï¼ŒæŠŠè¿œç¨‹åˆ†æ”¯ä¸‹è½½åˆ°æœ¬åœ°ä»“åº“ä¸­ï¼š\n# ä¸‹è½½åˆ°æœ¬åœ°ä»“åº“ï¼Œä¿æŒç›¸åŒåˆ†æ”¯åç§° git checkout è¿œç¨‹åˆ†æ”¯åç§° # ç¤ºä¾‹ git checkout pay # ä¸‹è½½åˆ°æœ¬åœ°ä»“åº“ï¼Œæœ¬åœ°ä½¿ç”¨åˆ«å git checkout -b æœ¬åœ°åˆ†æ”¯å è¿œç¨‹ä»“åº“å/è¿œç¨‹åˆ†æ”¯åç§° # ç¤ºä¾‹ git checkout -b payment origin/pay # GitHub é»˜è®¤ç”Ÿæˆçš„è¿œç¨‹ä»“åº“éƒ½æ˜¯ origin æ‹‰å– å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼ŒæŠŠè¿œç¨‹åˆ†æ”¯æœ€æ–°çš„ä»£ç ä¸‹è½½åˆ°æœ¬åœ°å¯¹åº”çš„åˆ†æ”¯ä¸­ï¼š\n# ä»è¿œç¨‹ä»“åº“ï¼Œæ‹‰å–å½“å‰åˆ†æ”¯æœ€æ–°çš„ä»£ç ï¼Œä¿æŒå½“å‰åˆ†æ”¯çš„ä»£ç å’Œè¿œç¨‹åˆ†æ”¯ä¸€è‡´ git pull ğŸ“ Note mac é»˜è®¤å°† . å¼€å¤´è§†ä¸ºéšè—æ–‡ä»¶ï¼Œæ­£å¸¸ ls æ— æ³•æ˜¾ç¤ºã€‚éœ€è¦ ls -a æ˜¾ç¤ºéšè—æ–‡ä»¶ï¼Œä½¿ç”¨ du -h \u0026lt;file\u0026gt; æŸ¥çœ‹æ–‡ä»¶å¤§å°ã€‚æ‹‰å–æ—¶å®é™…å°†æ•´ä¸ª .git ä»“åº“éƒ½æ‹‰å–ä¸‹æ¥äº†ã€‚\nåˆ é™¤ # åˆ é™¤è¿œç¨‹ä»“åº“ä¸­çš„åˆ†æ”¯ git push origin --delete \u0026lt;remote_branch\u0026gt; # åˆ é™¤æœ¬åœ°ä»“åº“ä¸­çš„åˆ†æ”¯ # NOTE: é¦–å…ˆè¦å…ˆåˆ‡æ¢åˆ°å…¶å®ƒåˆ†åŒºä¸Šåï¼Œå¦åˆ™æ— æ³•åˆ é™¤ git checkout \u0026lt;branch\u0026gt; git branch -d \u0026lt;branch\u0026gt; git branch -D \u0026lt;branch\u0026gt; #å¼ºåˆ¶åˆ é™¤æœ‰æœªåˆå¹¶ä»£ç çš„åˆ†æ”¯ ","date":"2023-03-20","section":"techs","summary":"Git æ§åˆ¶ ç‰ˆæœ¬æ§åˆ¶ç”¨æ¥è®°å½•æ–‡ä»¶å˜åŒ–ï¼Œå› æ­¤ä¹Ÿç§°ä¹‹ â€œç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿâ€œ\nä¼˜ç‚¹ï¼šæ“ä½œç®€ä¾¿ æ˜“äºå¯¹æ¯” æ˜“äºå›æº¯ ä¸æ˜“ä¸¢å¤± åä½œæ–¹ä¾¿\næœ¬åœ°ç‰ˆæœ¬æ§åˆ¶ â†’ é›†ä¸­åŒ–*^SVN^* â†’ åˆ†å¸ƒå¼*^Git^* çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ\né…ç½® ğŸ”— Href git å®˜ç½‘\né¦–å…ˆéœ€è¦è®¾ç½®è‡ªå·±çš„ ç”¨æˆ·å å’Œ é‚®ä»¶åœ°å€ ã€‚\n# ä½¿ç”¨ --global é€‰é¡¹æ—¶ï¼Œè¯¥å‘½ä»¤åªéœ€è¦è¿è¡Œä¸€æ¬¡ï¼Œå³å¯æ°¸ä¹…ç”Ÿæ•ˆ git config --global user.name \u0026#34;User Name\u0026#34; git config --global user.email \u0026#34;useremail@host.com\u0026#34; æ·»åŠ  --global å‚æ•°æ—¶ï¼Œå°†åœ¨ç”¨æˆ·æ–‡ä»¶å¤¹ ~ æ–°å»ºä¸€ä¸ª .gitconfig ä¿å­˜å…¨å±€é…ç½®ã€‚\n[user] email = useremail@host.com name = User Name åœ¨ç»ˆç«¯æŸ¥çœ‹ï¼š\n# æŸ¥çœ‹æ‰€æœ‰çš„å…¨å±€é…ç½®é€‰é¡¹ git config --list --global # æŸ¥çœ‹æŒ‡å®šçš„å…¨å±€é…ç½®é¡¹ git config user.name git config user.email æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯ï¼š\n# è¦æƒ³æ‰“å¼€ git config å‘½ä»¤çš„å¸®åŠ©æ‰‹å†Œ git help config # è·å–å‘½ä»¤çš„å¿«é€Ÿå‚è€ƒ git config -h æ›¿æ¢ æœ‰æ—¶ä¸¤å°ç”µè„‘ä¸­çš„ç”¨æˆ·é…ç½®ä¿¡æ¯ä¸ä¸€è‡´ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹çš„è„šæœ¬è¿›è¡ŒåŒæ­¥ã€‚\n","title":"01 ToolSet","url":"/techs/01-toolset/"},{"content":"W3C W3C æ ‡å‡†æ˜¯ç”±ä¸‡ç»´ç½‘è”ç›Ÿåˆ¶å®šçš„ä¸€ç³»åˆ—æ ‡å‡†ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š\nç»“æ„åŒ–æ ‡å‡†è¯­è¨€ ï¼ˆ HTML \u0026amp; XML ï¼‰ è¡¨ç°æ ‡å‡†è¯­è¨€ ï¼ˆ CSS ï¼‰ è¡Œä¸ºæ ‡å‡†è¯­è¨€ï¼ˆ DOM \u0026amp; ECMAScript ï¼‰ å€¡å¯¼ ç»“æ„ã€æ ·å¼ã€**è¡Œä¸º **åˆ†ç¦»ã€‚\nUnicode Unicode å­—ç¬¦åœ¨ HTML ã€CSS å’Œ JS ä¸­çš„è¡¨ç¤ºæ–¹æ³•å‡ä¸ç›¸åŒï¼Œä¸‹é¢åˆ†åˆ«ä½œä»‹ç»ã€‚\nCSS é¦–å…ˆæ¥ä¸€æ®µå¾ˆå¸¸è§çš„ Bootstrap çš„å­—ä½“å›¾æ ‡ä»£ç ï¼š\n.glyphicon-home:before { content: \u0026#34;\\e021\u0026#34;; } ä¸Šé¢ä»£ç ä¸­çš„ e021 å°±æ˜¯è¿™ä¸ªå­—ç¬¦çš„ Unicode ç ï¼Œæ˜¯16è¿›åˆ¶ã€‚\nè¯­æ³•ï¼š\n\u0026#39;\\ + 16è¿›åˆ¶çš„unicodeç¼–ç \u0026#39; å¦‚ï¼š\\5b89 è¡¨ç¤ºæ±‰å­— å®‰ ï¼š\n\u0026lt;div class=\u0026#34;test\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;style\u0026gt; .test: before {content: \u0026#34;\\e021\u0026#34;;} \u0026lt;/style\u0026gt; JS è¯­æ³•ï¼š\n\u0026#39;\\u + 16è¿›åˆ¶çš„unicodeç¼–ç \u0026#39; ç¤ºä¾‹ï¼š\n// å¦‚ï¼š\u0026#39;\\u5b89\u0026#39;è¡¨ç¤ºæ±‰å­—â€œå®‰â€ console.log(\u0026#39;\\u5b89\u0026#39;); // è¾“å‡ºâ€œå®‰â€ HTML HTML ç‰¹æ®Šä¸€ç‚¹ï¼Œä½¿ç”¨çš„æ˜¯ 10è¿›åˆ¶\nè¯­æ³•ï¼š\n\u0026#39;\u0026amp;# + 10è¿›åˆ¶çš„unicodeç¼–ç  + è‹±æ–‡åˆ†å·;\u0026#39; å¦‚ \u0026amp;#23433; è¡¨ç¤ºæ±‰å­— å®‰ ï¼Œç»“å°¾çš„åˆ†å·ç»æµ‹è¯•ä¸åŠ ä¹Ÿæ²¡é—®é¢˜ï¼Œä½†æ˜¯æœ€å¥½è¿˜æ˜¯åŠ ä¸€ä¸‹ã€‚\n\u0026lt;div\u0026gt; è¿™æ˜¯unicodeè¡¨ç¤ºçš„å­—ç¬¦\u0026#34;å®‰\u0026#34;ï¼š\u0026amp;#23433; \u0026lt;/div\u0026gt; å¦å¤–ï¼Œä¸€äº›ç‰¹æ®Šå­—ç¬¦è¿˜æœ‰å…¶å®ƒè¡¨ç¤ºï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„ htmlè½¬ä¹‰å­—ç¬¦ ï¼š\n\u0026amp;nbsp; == \u0026amp;#160; == ç©ºæ ¼ ç¼–ç  é‚£ä¹ˆï¼Œå¦‚ä½•çŸ¥é“ä¸€ä¸ªæ±‰å­—çš„unicodeçš„ç¼–ç å‘¢ï¼Ÿå¾ˆç®€å•ï¼š\n\u0026#39;å®‰\u0026#39;.charCodeAt()ï¼› // è¾“å‡ºçš„ 23433 å°±æ˜¯æ±‰å­— å®‰ çš„unicodeç¼–ç ï¼Œä¸è¿‡æ³¨æ„æ˜¯10è¿›åˆ¶çš„ String.fromCharCode(23433); // è¾“å‡º \u0026#39;å®‰\u0026#39; '\\\\u' + 'â–¶ï¸'.charCodeAt().toString(16); â†’ JS ç”¨ ''\\\\' + 'â–¶ï¸'.charCodeAt().toString(16); â†’ CSS ç”¨ '\u0026amp;#' + 'â–¶ï¸'.charCodeAt().toString(10); â†’ HTML ç”¨ å¾—åˆ°äº†10è¿›åˆ¶çš„unicodeç¼–ç ï¼Œå†å¦‚æœæƒ³åœ¨ JS å’Œ CSS é‡Œé¢ç”¨çš„è¯ï¼Œå°±éœ€è¦ç”¨ toString(16) è½¬ 16 è¿›åˆ¶å†åšè¿›ä¸€æ­¥å¤„ç†äº†ã€‚\nJSON.parse(\u0026#39;\u0026#34;\u0026#39;+unicode+\u0026#39;\u0026#34;\u0026#39;); // è¾“å‡ºæ±‰å­—ï¼š\u0026#34;èŒ—\u0026#34; eval(\u0026#39;\u0026#34;\u0026#39;+unicode+\u0026#39;\u0026#34;\u0026#39;); // æˆ–è€…ä½¿ç”¨evalè§£æä¹Ÿå¯ä»¥ è½¬æ¢ Number.parseInt(string , radix); æŠŠå­—ç¬¦ä¸²æ ¹æ®ç›¸åº”çš„è¿›åˆ¶è¿›è¡Œè§£æè½¬ä¸º 10 è¿›åˆ¶ï¼Œradix è¡¨ç¤ºè¿›åˆ¶ï¼Œå–å€¼2~36ï¼Œé»˜è®¤æŒ‰ç…§ 10 è¿›åˆ¶è§£æã€‚\nNumber.parseInt(\u0026#39;010\u0026#39;,8)\t//8 Number.parseInt(\u0026#39;20\u0026#39;,2)\t//NaN Number.toString(radix); è¿™ä¸ªå‡½æ•°å°†åè¿›åˆ¶æ•°å­—è½¬æ¢ä¸ºä»»æ„è¿›åˆ¶çš„å­—ç¬¦ä¸²å½¢å¼ã€‚radix è¡¨ç¤ºè¿›åˆ¶ï¼Œå–å€¼2~36ã€‚\n(10).toString(2)\t//\u0026#34;1010\u0026#34;è½¬2è¿›åˆ¶ (10).toString(16)\t//\u0026#34;a\u0026#34; è½¬16è¿›åˆ¶ (1000).toString(36)\t//\u0026#34;rs\u0026#34; è½¬36è¿›åˆ¶ DOM å…³äº JS ä¸ CSS æ˜¯å¦é˜»å¡ DOM çš„æ¸²æŸ“å’Œè§£æ - æ˜é‡‘ Excerpt å‰è¨€ æœ€è¿‘ç³»ç»Ÿæ¢³ç†HTML5æ‰€æœ‰æ¶‰åŠåˆ°çš„æ ‡ç­¾æ—¶ï¼Œæ¢³ç†è‡³å’Œ","date":"2023-03-20","section":"techs","summary":"W3C W3C æ ‡å‡†æ˜¯ç”±ä¸‡ç»´ç½‘è”ç›Ÿåˆ¶å®šçš„ä¸€ç³»åˆ—æ ‡å‡†ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š\nç»“æ„åŒ–æ ‡å‡†è¯­è¨€ ï¼ˆ HTML \u0026amp; XML ï¼‰ è¡¨ç°æ ‡å‡†è¯­è¨€ ï¼ˆ CSS ï¼‰ è¡Œä¸ºæ ‡å‡†è¯­è¨€ï¼ˆ DOM \u0026amp; ECMAScript ï¼‰ å€¡å¯¼ ç»“æ„ã€æ ·å¼ã€**è¡Œä¸º **åˆ†ç¦»ã€‚\nUnicode Unicode å­—ç¬¦åœ¨ HTML ã€CSS å’Œ JS ä¸­çš„è¡¨ç¤ºæ–¹æ³•å‡ä¸ç›¸åŒï¼Œä¸‹é¢åˆ†åˆ«ä½œä»‹ç»ã€‚\nCSS é¦–å…ˆæ¥ä¸€æ®µå¾ˆå¸¸è§çš„ Bootstrap çš„å­—ä½“å›¾æ ‡ä»£ç ï¼š\n.glyphicon-home:before { content: \u0026#34;\\e021\u0026#34;; } ä¸Šé¢ä»£ç ä¸­çš„ e021 å°±æ˜¯è¿™ä¸ªå­—ç¬¦çš„ Unicode ç ï¼Œæ˜¯16è¿›åˆ¶ã€‚\nè¯­æ³•ï¼š\n\u0026#39;\\ + 16è¿›åˆ¶çš„unicodeç¼–ç \u0026#39; å¦‚ï¼š\\5b89 è¡¨ç¤ºæ±‰å­— å®‰ ï¼š\n\u0026lt;div class=\u0026#34;test\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;style\u0026gt; .test: before {content: \u0026#34;\\e021\u0026#34;;} \u0026lt;/style\u0026gt; JS è¯­æ³•ï¼š\n\u0026#39;\\u + 16è¿›åˆ¶çš„unicodeç¼–ç \u0026#39; ç¤ºä¾‹ï¼š\n// å¦‚ï¼š\u0026#39;\\u5b89\u0026#39;è¡¨ç¤ºæ±‰å­—â€œå®‰â€ console.log(\u0026#39;\\u5b89\u0026#39;); // è¾“å‡ºâ€œå®‰â€ HTML HTML ç‰¹æ®Šä¸€ç‚¹ï¼Œä½¿ç”¨çš„æ˜¯ 10è¿›åˆ¶\nè¯­æ³•ï¼š\n\u0026#39;\u0026amp;# + 10è¿›åˆ¶çš„unicodeç¼–ç  + è‹±æ–‡åˆ†å·;\u0026#39; å¦‚ \u0026amp;#23433; è¡¨ç¤ºæ±‰å­— å®‰ ï¼Œç»“å°¾çš„åˆ†å·ç»æµ‹è¯•ä¸åŠ ä¹Ÿæ²¡é—®é¢˜ï¼Œä½†æ˜¯æœ€å¥½è¿˜æ˜¯åŠ ä¸€ä¸‹ã€‚\n","title":"02 W3C","url":"/techs/02-w3c/"},{"content":"HTML HTML - HyperText Markup Language\nè¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ ç”±W3Cç»„ç»‡æ‰€ç»´æŠ¤ æ­å»ºç½‘é¡µç»“æ„ åˆ’åˆ†é¡µé¢åŒºåŸŸ æ¡†æ¶ \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;zh\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;!--æºä»£ç çš„å¤´--\u0026gt; \u0026lt;!--æ²¡æœ‰è®¾ç½®ç¼–ç æ—¶ï¼Œæµè§ˆå™¨æ ¹æ®æœ¬æœºç¼–ç æ¥è¿›è¡Œè§£æ--\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;!--è®¾ç½®å­—ç¬¦é›†ï¼šUTF-8æ˜¯ä¸€ç§unicodeï¼ŒåŒ…å«äº†ä¸–ç•Œå¤§å¤šæ•°çš„æ–‡ä»¶ --\u0026gt; \u0026lt;title\u0026gt;æˆ‘çš„é¡µé¢\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;!--ç”¨äºæ˜¾ç¤ºçš„æ­£æ–‡--\u0026gt; æˆ‘çš„ç¬¬ä¸€ä¸ªHTMLé¡µé¢ \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; æ ‡ç­¾ \u0026lt;strong\u0026gt;æ–‡å­—å†…å®¹\u0026lt;/strong\u0026gt; \u0026lt;!-- å¼€å§‹æ ‡ç­¾ åŒ…è£¹çš„å†…å®¹ ç»“æŸæ ‡ç­¾ --\u0026gt; ç»“æ„ æ ‡ç­¾ç”± \u0026lt; ã€ \u0026gt; ã€ / ã€ è‹±æ–‡å•è¯æˆ–å­—æ¯ ç»„æˆã€‚å¹¶ä¸”æŠŠæ ‡ç­¾ä¸­ \u0026lt;\u0026gt; åŒ…æ‹¬èµ·æ¥çš„éƒ¨åˆ†ç§°ä¸ºæ ‡ç­¾å å¸¸è§æ ‡ç­¾ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š\u0026lt;å¼€å§‹æ ‡ç­¾\u0026gt;åŒ…è£¹å†…å®¹\u0026lt;ç»“æŸæ ‡ç­¾\u0026gt; éƒ¨åˆ†å•æ ‡ç­¾æ— æ³•åŒ…è£¹å†…å®¹ï¼š\u0026lt;å•æ ‡ç­¾\u0026gt; \u0026lt;br\u0026gt; \u0026lt;hr\u0026gt; \u0026lt;img\u0026gt; å…³ç³» æ ‡ç­¾ä¹‹é—´çš„å…³ç³»åŒ…æ‹¬ï¼š\nåµŒå¥—å…³ç³»ï¼ˆçˆ¶å­å…³ç³»ï¼‰\n\u0026lt;head\u0026gt; \u0026lt;title\u0026gt;\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; å…„å¼Ÿå…³ç³»ï¼ˆå¹¶åˆ—å…³ç³»ï¼‰\n\u0026lt;head\u0026gt;\u0026lt;/head\u0026gt; \u0026lt;body\u0026gt;\u0026lt;/body\u0026gt; æ ‡é¢˜ \u0026lt;h1\u0026gt;è¿™æ˜¯ä¸€ä¸ªæ ‡é¢˜\u0026lt;/h1\u0026gt; \u0026lt;!--æ‰€æœ‰çš„æ ‡é¢˜å•ç‹¬å æ®ä¸€è¡Œ--\u0026gt; æ®µè½ \u0026lt;p\u0026gt;è¿™æ˜¯ä¸€ä¸ªæ®µè½\u0026lt;/p\u0026gt; é»˜è®¤æ ·å¼ï¼š \u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;ä¸­é—´ä¼šç©ºè¡Œ \u0026lt;br\u0026gt;ä¸­é—´ä¸ä¼šç©ºè¡Œ\t\u0026lt;!--Break--\u0026gt; \u0026lt;!--è¿™åªæ˜¯é»˜è®¤æ ·å¼ï¼Œp=paragraphï¼Œbr=break--\u0026gt; \u0026lt;hr\u0026gt;åˆ†éš”ç¬¦å·\u0026lt;/hr\u0026gt; HTMLå†™ç»“æ„ï¼ŒCSSå†™æ ·å¼\nHTMLæ ‡è®°è¡¨ç¤ºæ˜¯ä»€ä¹ˆ CSSæ ·å¼è¡¨è¾¾é•¿ä»€ä¹ˆæ · \u0026lt;p\u0026gt;\u0026nbsp;ä¸­é—´ä¼šç©ºè¡Œ\n\u0026nbsp;\u0026lt;/p\u0026gt;\n\u0026lt;br\u0026gt;\u0026nbsp;\nä¸­é—´ä¸ä¼šç©ºè¡Œ\u0026nbsp;\n\u0026lt;hr\u0026gt;\u0026nbsp;åˆ†éš”çº¿\u0026nbsp;\u0026lt;/hr\u0026gt;\næ ‡è®° \u0026lt;wbr\u0026gt;åŠ å…¥è¿å­—ç¬¦ï¼ˆéœ€è¦æ—¶æ¢è¡Œï¼Œword-breakï¼‰\u0026lt;/wbr\u0026gt; \u0026lt;hgroup\u0026gt; \u0026lt;h1\u0026gt;ç”¨äº\u0026lt;/h1\u0026gt;\u0026lt;h2\u0026gt;ç»„åˆæ ‡é¢˜\u0026lt;/h2\u0026gt; \u0026lt;/hgroup\u0026gt; FernstraÃŸenbauprivatfinanzierungsgesetz\nFernstraÃŸenbauprivatfinanzierungsgesetz FernstraÃŸen\u0026shy;bau\u0026shy;privat\u0026shy;finanzierungs\u0026shy;gesetz\n## æ®µè½ å­—ä½“æ ·å¼ \u0026lt;b\u0026gt;bold\u0026lt;/b\u0026gt; \u0026lt;i\u0026gt;italics\u0026lt;/i\u0026gt; \u0026lt;tt\u0026gt;typewriter/monospace\u0026lt;/tt\u0026gt; \u0026lt;small\u0026gt;smaller size\u0026lt;/small\u0026gt; \u0026lt;del\u0026gt;delete line\u0026lt;/del\u0026gt; \u0026lt;ins\u0026gt;insert line\u0026lt;/ins\u0026gt; \u0026lt;sup\u0026gt;super/ä¸Šæ ‡\u0026lt;/sup\u0026gt; \u0026lt;sub\u0026gt;subscript/ä¸‹æ ‡\u0026lt;/sub\u0026gt; \u0026lt;mark\u0026gt;highlight/é«˜äº®\u0026lt;/mark\u0026gt; \u0026lt;em\u0026gt;emphasis/å¼ºè°ƒ\u0026lt;/em\u0026gt; \u0026lt;strong\u0026gt;strong/ç€é‡\u0026lt;/strong\u0026gt; \u0026lt;dfn\u0026gt;definition/å®šä¹‰\u0026lt;/dfn\u0026gt; \u0026lt;b\u0026gt;\u0026nbsp;bold\u0026nbsp;\u0026lt;/b\u0026gt;\n\u0026lt;i\u0026gt;\u0026nbsp;italics\u0026nbsp;\u0026lt;/i\u0026gt;\n\u0026lt;tt\u0026gt;\u0026nbsp;typewriter/monospace\u0026nbsp;\u0026lt;/tt\u0026gt;\n\u0026lt;small\u0026gt;\u0026nbsp;smaller size\u0026nbsp;\u0026lt;/small\u0026gt;\n\u0026lt;del\u0026gt;\u0026nbsp;delete line\u0026nbsp;\u0026lt;/del\u0026gt;\n\u0026lt;s\u0026gt;\u0026nbsp;delete line\u0026nbsp;\u0026lt;/s\u0026gt;\n\u0026lt;ins\u0026gt;\u0026nbsp;insert line\u0026nbsp;\u0026lt;/ins\u0026gt;\n\u0026lt;u\u0026gt;\u0026nbsp;insert line\u0026nbsp;\u0026lt;/u\u0026gt;\n\u0026lt;sup\u0026gt;\u0026nbsp;super/ä¸Šæ ‡\u0026nbsp;\u0026lt;/sup\u0026gt;\n\u0026lt;sub\u0026gt;\u0026nbsp;subscript/ä¸‹æ ‡\u0026nbsp;\u0026lt;/sub\u0026gt;\n\u0026lt;mark\u0026gt;\u0026nbsp;highlight/é«˜äº®\u0026nbsp;\u0026lt;/mark\u0026gt;\n\u0026lt;em\u0026gt;\u0026nbsp;emphasis/å¼ºè°ƒ\u0026nbsp;\u0026lt;/em\u0026gt;\n\u0026lt;i\u0026gt;\u0026nbsp;emphasis/å¼ºè°ƒ\u0026nbsp;\u0026lt;/i\u0026gt;\n\u0026lt;strong\u0026gt;\u0026nbsp;strong/ç€é‡\u0026nbsp;\u0026lt;/strong\u0026gt;\n\u0026lt;b\u0026gt;\u0026nbsp;b/ç€é‡\u0026nbsp;\u0026lt;/b\u0026gt;\n\u0026lt;dfn\u0026gt;\u0026nbsp;definition/å®šä¹‰\u0026nbsp;\u0026lt;/dfn\u0026gt;\n#### æ³¨éŸ³ \u0026lt;ruby\u0026gt; æ±‰\u0026lt;rt\u0026gt;Han\u0026lt;/rt\u0026gt; å­—\u0026lt;rt\u0026gt;zi\u0026lt;/rt\u0026gt; \u0026lt;/ruby\u0026gt; æ±‰Hanå­—zi :memo: Note\n\u0026lt;ruby\u0026gt; å…ƒç´ ç”±ä¸€ä¸ªæˆ–å¤šä¸ªéœ€è¦è§£é‡Š/å‘éŸ³çš„å­—ç¬¦å’Œä¸€ä¸ªæä¾›è¯¥ä¿¡æ¯çš„ \u0026lt;rp\u0026gt; å…ƒç´ ç»„æˆ \u0026lt;rp\u0026gt; æ ‡ç­¾å®šä¹‰å­—ç¬¦çš„è§£é‡Šæˆ–å‘éŸ³ã€‚ çŸ­è¯­æ ¼å¼ \u0026lt;code\u0026gt;code/ä»£ç \u0026lt;/code\u0026gt; \u0026lt;samp\u0026gt;sample/ä¾‹å­\u0026lt;/samp\u0026gt; \u0026lt;kbd\u0026gt;keyboard/ç”¨æˆ·è¾“å…¥\u0026lt;/kbd\u0026gt; \u0026lt;var\u0026gt;variable/å˜é‡\u0026lt;/var\u0026gt; \u0026lt;cite\u0026gt;cite/å¼•ç”¨\u0026lt;/cite\u0026gt; \u0026lt;code\u0026gt;\u0026nbsp;code/ä»£ç \u0026nbsp;\u0026lt;/code\u0026gt;\n\u0026lt;samp\u0026gt;\u0026nbsp;sample/ä¾‹å­\u0026nbsp;\u0026lt;/samp\u0026gt;\n\u0026lt;kbd\u0026gt;\u0026nbsp;keyboard/ç”¨æˆ·è¾“å…¥\u0026nbsp;\u0026lt;/kbd\u0026gt;\n\u0026lt;variable\u0026gt;\u0026nbsp;variable/å˜é‡\u0026nbsp;\u0026lt;/variable\u0026gt;\n\u0026lt;cite\u0026gt;\u0026nbsp;cite/å¼•ç”¨\u0026nbsp;\u0026lt;/cite\u0026gt;\nç‰¹æ®Šæ ¼å¼ \u0026lt;address\u0026gt;åœ°å€\u0026lt;/address\u0026gt; \u0026lt;blockquote\u0026gt;blockquote/ç¼©è¿›\u0026lt;/blockquote\u0026gt; \u0026lt;q\u0026gt;quote/å°å¼•ç”¨\u0026lt;/q\u0026gt; \u0026lt;code\u0026gt;ä»£ç \u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;\u0026lt;pre\u0026gt;ä¸åšå†…å®¹çš„æ ¼å¼åŒ–\u0026lt;/pre\u0026gt;\u0026lt;/code\u0026gt; \u0026lt;address\u0026gt;\u0026nbsp;address/åœ°å€\u0026nbsp;\u0026lt;/address\u0026gt;\n\u0026lt;blockquote\u0026gt;\u0026nbsp;blockquote/ç¼©è¿›\u0026nbsp;\u0026lt;/blockquote\u0026gt;\n\u0026lt;q\u0026gt;\u0026nbsp;quote/å°å¼•ç”¨\u0026nbsp;\u0026lt;/q\u0026gt;\n\u0026lt;code\u0026gt;\u0026nbsp;ä»£ç \u0026nbsp;\u0026lt;/code\u0026gt;\n\u0026lt;code\u0026gt;\u0026lt;pre\u0026gt;\u0026nbsp;ä¸åšå†…å®¹çš„æ ¼å¼åŒ–\u0026nbsp;\u0026lt;/pre\u0026gt;\u0026lt;/code\u0026gt;\nå±æ€§ æ¯ä¸€ä¸ªHTMLæ ‡è®°ä¸­ï¼Œè¿˜æœ‰å¾ˆå¤šçš„å±æ€§\n\u0026lt;img src=\u0026#34;\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; \u0026lt;!-- æ ‡ç­¾å±æ€§: [å±æ€§å å±æ€§å€¼] --\u0026gt; \u0026lt;!-- å±æ€§å=å±æ€§å€¼ --\u0026gt; ç»“æ„ æ ‡ç­¾çš„å±æ€§å†™åœ¨å¼€å§‹æ ‡ç­¾å†…éƒ¨ æ ‡ç­¾ä¸Šå¯ä»¥åŒæ—¶å­˜åœ¨å¤šä¸ªå±æ€§ å±æ€§ä¹‹é—´ä»¥ç©ºæ ¼éš”å¼€ï¼Œä¸”æ ‡ç­¾åä¸å±æ€§ä¹‹é—´å¿…é¡»ä»¥ç©ºæ ¼éš”å¼€ å±æ€§ä¹‹é—´æ²¡æœ‰é¡ºåºä¹‹åˆ† \u0026lt;hr width=\u0026#34;50%\u0026#34; align=left size=10\u0026gt; \u0026lt;abbr title=\u0026#34;ä¸­åäººæ°‘å…±å’Œå›½\u0026#34;\u0026gt;PRC\u0026lt;/abbr\u0026gt; \u0026lt;!--é¼ æ ‡æ‚¬æµ®æç¤º--\u0026gt; \u0026lt;bdo dir=rtl\u0026gt;è¿™æ˜¯ä¸€æ®µæ–‡å­—\u0026lt;/bdo\u0026gt; \u0026lt;bdo dir=rtl\u0026gt;è¿™æ˜¯\u0026lt;bdi\u0026gt;ä¸€æ®µ\u0026lt;/bdi\u0026gt;æ–‡å­—\u0026lt;/bdo\u0026gt; \u0026lt;!--é¢ å€’æ–‡å­—é¡ºåº--\u0026gt; \u0026lt;hr width=\"50%\" align=left size=10\u0026gt;\n\u0026lt;abbr title=\u0026quot; ä¸­åäººæ°‘å…±å’Œå›½ \u0026quot;\u0026gt;PRC\u0026lt;/abbr\u0026gt;\n\u0026lt;bro dir=rtl\u0026gt; è¿™æ˜¯ä¸€æ®µæ–‡å­— \u0026lt;/bro\u0026gt;\n\u0026lt;bdo dir=rtl\u0026gt; è¿™æ˜¯\u0026lt;bdi\u0026gt;ä¸€æ®µ\u0026lt;/bdi\u0026gt;æ–‡å­— \u0026lt;/bdo\u0026gt;\nåœ¨HTML5å½“ä¸­ï¼Œå±æ€§ä¸å†å¼ºåˆ¶éœ€è¦åŠ ä¸Šå¼•å· ç›®å‰æ›´åŠ å€¾å‘äºä½¿ç”¨å±‚å æ ·å¼è¡¨ï¼ˆCSSï¼‰å®ç° ç¬¦å· less than \u0026amp;lt; and \u0026amp;amp; non-breakable space \u0026amp;nbsp; \u0026amp;uuml; less than \u0026amp;lt; \u0026lt;\nand \u0026amp;amp; \u0026amp;\nnon-breakable space \u0026nbsp;\u0026amp;nbsp; '\u0026nbsp;'\n## ç»“æ„ åˆ—è¡¨ é¤åçš„é¥®æ–™æœ‰ï¼š \u0026lt;ul\u0026gt; \u0026lt;!--unordered list/æ— åºåˆ—è¡¨ --\u0026gt; \u0026lt;li\u0026gt;çº¢èŒ¶\u0026lt;/li\u0026gt; \u0026lt;!-- list item/åˆ—è¡¨é¡¹ç›® --\u0026gt; \u0026lt;li\u0026gt;å’–å•¡\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;å¯ä¹\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;ol start=2\u0026gt; \u0026lt;!-- unordered list/æ— åºåˆ—è¡¨ --\u0026gt; \u0026lt;li\u0026gt;çº¢èŒ¶\u0026lt;/li\u0026gt; \u0026lt;!-- list item/åˆ—è¡¨é¡¹ç›® --\u0026gt; \u0026lt;li\u0026gt;å’–å•¡\u0026lt;/li\u0026gt; \u0026lt;ul\u0026gt; \u0026lt;li\u0026gt;ä¸åŠ ç³–\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;ä¸åŠ å¥¶\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;li\u0026gt;å¯ä¹\u0026lt;/li\u0026gt; \u0026lt;/ol\u0026gt; é¤åçš„é¥®æ–™æœ‰ï¼š\n\u0026lt;ul\u0026gt; \u0026lt;li\u0026gt;çº¢èŒ¶\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;å’–å•¡\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;å¯ä¹\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt; é¤åçš„é¥®æ–™æœ‰ï¼š\n\u0026lt;ol start=2\u0026gt; \u0026lt;li\u0026gt;çº¢èŒ¶\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;å’–å•¡\u0026lt;/li\u0026gt;\n\u0026lt;ul\u0026gt; \u0026lt;li\u0026gt;ä¸åŠ ç³–\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;ä¸åŠ å¥¶\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt; \u0026lt;li\u0026gt;å¯ä¹\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt; **Note:** é¡µé¢çš„æ•ˆæœå¹¶ä¸æ˜¯ç”± Tab ç¬¦å·å¼•èµ·ï¼Œè€Œæ˜¯ç”±æµè§ˆå™¨è‡ªå¸¦ æ ·å¼è¡¨ æ§åˆ¶ï¼Œå…·ä½“å¯çœ‹ CSS éƒ¨åˆ†çš„ æ ¼å¼åŒ–æ ·å¼ æ·»åŠ  list-style: none æ¸…é™¤å°åœ†ç‚¹ è¯æ¡ é¤åçš„é¥®æ–™æœ‰ï¼š \u0026lt;dl\u0026gt;\u0026lt;!-- è¯æ¡ --\u0026gt; \u0026lt;dt\u0026gt;æ–¹ç³–\u0026lt;/dt\u0026gt; \u0026lt;dd\u0026gt;æ–¹çš„ç³–\u0026lt;/dd\u0026gt; \u0026lt;/dl\u0026gt; \u0026lt;dl\u0026gt;\n\u0026lt;dt\u0026gt;æ–¹ç³–\u0026lt;/dt\u0026gt;\n\u0026lt;dd\u0026gt;æ–¹çš„ç³–\u0026lt;/dd\u0026gt;\n\u0026lt;/dl\u0026gt; ### å›¾ç‰‡ \u0026lt;img\u0026gt; \u0026lt;!--å•ä¸ªæ ‡è®°--\u0026gt; \u0026lt;img src=\u0026#34;\u0026#34;\u0026gt; \u0026lt;!-- imageæ˜¯ä¸€ä¸ªâ€œå­—\u0026#34;ï¼Œä¼šå’Œåé¢çš„å›¾ç‰‡è¿èµ·æ¥ --\u0026gt; \u0026lt;iframe src=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/iframe\u0026gt; \u0026lt;img src=\u0026quot;fav.png\u0026quot;\u0026gt; alt=\u0026quot;å›¾ç‰‡\u0026quot;\nFAV\n\u0026lt;iframe src=\u0026quot;\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\niframe #### \u0026lt;Img\u0026gt; å±æ€§åï¼š width å’Œ height\nå±æ€§å€¼ï¼šå®½åº¦ \u0026amp; é«˜åº¦\nNote:\nå¦‚æœåªè®¾ç½® width æˆ– height ä¸­çš„ä¸€ä¸ªï¼Œå¦ä¸€ä¸ªè®¾ç½®çš„æ—¶å€™ä¼šè‡ªåŠ¨ç­‰æ¯”ä¾‹ç¼©æ”¾ å¦‚æœåŒæ—¶è®¾ç½®ä¸¤ä¸ªï¼Œè‹¥è®¾ç½®ä¸å½“å¯èƒ½ä¼šå˜å½¢ \u0026lt;Iframe\u0026gt; ç”¨æ¥å®ç°é•¿è¿æ¥ è·¨åŸŸé€šä¿¡ å†å²è®°å½•ç®¡ç† çº¯å‰ç«¯çš„utf8å’Œgbkç¼–ç äº’è½¬ æ— åˆ·æ–°æ–‡ä»¶ä¸Šä¼  ç½‘é¡µè°ƒèµ·å®¢æˆ·ç«¯åº”ç”¨ åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ç‹¬ç«‹çš„å®¿ä¸»ç¯å¢ƒ IE6ä¸‹ç”¨äºé®ç½©select éŸ³é¢‘ \u0026lt;audio\u0026gt;\nGoogle ç¦ç”¨äº†éŸ³è§†é¢‘è‡ªåŠ¨æ’­æ”¾åŠŸèƒ½\næµè§ˆå™¨ MP3 WAV Internet Explorer :heavy_check_mark: :heavy_multiplication_x: Chrome :heavy_check_mark: :heavy_check_mark: FireFox :heavy_check_mark: :heavy_check_mark: Safari :heavy_check_mark: :heavy_check_mark: Opera :heavy_check_mark: :heavy_check_mark: \u0026lt;audio src=\u0026#34;./audio.mp4\u0026#34; autoplay controls\u0026gt;\u0026lt;/audio\u0026gt; \u0026lt;audio controls=\u0026#34;controls\u0026#34;\u0026gt; \u0026lt;source src=\u0026#34;./audio.mp3\u0026#34; type=\u0026#34;audio/mpeg\u0026#34;\u0026gt; \u0026lt;source src=\u0026#34;./audio.ogg\u0026#34; type=\u0026#34;audio/ogg\u0026#34;\u0026gt; æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ audio æ ‡ç­¾ \u0026lt;/audio\u0026gt; è§†é¢‘ \u0026lt;video\u0026gt;\nHTML5 å¯ä»¥åœ¨ä¸ä½¿ç”¨æ’ä»¶çš„æƒ…å†µä¸‹åŸç”Ÿæ”¯æŒè§†é¢‘æ–‡ä»¶çš„æ’­æ”¾ã€‚\næµè§ˆå™¨ MP4 WebM Ogg Internet Explorer :heavy_check_mark: :heavy_multiplication_x: :heavy_multiplication_x: Chrome :heavy_check_mark: :heavy_check_mark: :heavy_check_mark: FireFox :heavy_check_mark: :heavy_check_mark: :heavy_check_mark: Safari :heavy_check_mark: :heavy_multiplication_x: :heavy_multiplication_x: Opera :heavy_check_mark: :heavy_check_mark: :heavy_check_mark: \u0026lt;video src=\u0026#34;./video.mp4\u0026#34; controls\u0026gt;\u0026lt;/video\u0026gt; \u0026lt;video width=\u0026#34;320\u0026#34; height=\u0026#34;240\u0026#34; controls\u0026gt; \u0026lt;source src=\u0026#34;./video.mp4\u0026#34; type=\u0026#34;video/mp4\u0026#34;\u0026gt; \u0026lt;source src=\u0026#34;./video.ogg\u0026#34; type=\u0026#34;video/ogg\u0026#34;\u0026gt; æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ video æ ‡ç­¾ \u0026lt;/video\u0026gt; é“¾æ¥ \u0026lt;a\u0026gt;\n\u0026lt;a href=\u0026#34;src/hyper reference\u0026#34; target=\u0026#34;_black\u0026#34;\u0026gt;è¿™æ˜¯ä¸€ä¸ªè¶…é“¾æ¥\u0026lt;/a\u0026gt; \u0026lt;!--targetè¡¨ç¤ºæ‰“å¼€æ–°çª—å£çš„ä½ç½®--\u0026gt; \u0026lt;p id=\u0026#34;loc\u0026#34;\u0026gt;paragraph\u0026lt;/p\u0026gt; \u0026lt;a href=\u0026#34;#loc\u0026#34;\u0026gt;to location\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026quot;src/hyper reference\u0026quot; target=\u0026quot;_black\u0026quot;\u0026gt;è¿™æ˜¯ä¸€ä¸ªè¶…é“¾æ¥\u0026lt;/a\u0026gt;\n\u0026lt;p id=\u0026quot;loc\u0026quot;\u0026gt;paragraph\n\u0026lt;/p\u0026gt;\n\u0026lt;a href=\u0026quot;#loc\u0026quot;\u0026gt;to location\u0026lt;/a\u0026gt; ### æ˜ å°„ å¸¦æœ‰å¯ç‚¹å‡»åŒºåŸŸçš„å›¾åƒæ˜ å°„\n\u0026lt;img src=\u0026#34;mama.jpg\u0026#34; width=100 height=100 usemap = \u0026#34;#map\u0026#34;\u0026gt; \u0026lt;map name=\u0026#34;map\u0026#34;\u0026gt; \u0026lt;area shape =\u0026#34;rect\u0026#34; coords =\u0026#34;0,0,50,50\u0026#34; href =\u0026#34;http://news.163.com\u0026#34; alt=\u0026#34;news\u0026#34; ","date":"2023-03-20","section":"techs","summary":"HTML HTML - HyperText Markup Language\nè¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ ç”±W3Cç»„ç»‡æ‰€ç»´æŠ¤ æ­å»ºç½‘é¡µç»“æ„ åˆ’åˆ†é¡µé¢åŒºåŸŸ æ¡†æ¶ \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;zh\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;!--æºä»£ç çš„å¤´--\u0026gt; \u0026lt;!--æ²¡æœ‰è®¾ç½®ç¼–ç æ—¶ï¼Œæµè§ˆå™¨æ ¹æ®æœ¬æœºç¼–ç æ¥è¿›è¡Œè§£æ--\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;!--è®¾ç½®å­—ç¬¦é›†ï¼šUTF-8æ˜¯ä¸€ç§unicodeï¼ŒåŒ…å«äº†ä¸–ç•Œå¤§å¤šæ•°çš„æ–‡ä»¶ --\u0026gt; \u0026lt;title\u0026gt;æˆ‘çš„é¡µé¢\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;!--ç”¨äºæ˜¾ç¤ºçš„æ­£æ–‡--\u0026gt; æˆ‘çš„ç¬¬ä¸€ä¸ªHTMLé¡µé¢ \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; æ ‡ç­¾ \u0026lt;strong\u0026gt;æ–‡å­—å†…å®¹\u0026lt;/strong\u0026gt; \u0026lt;!-- å¼€å§‹æ ‡ç­¾ åŒ…è£¹çš„å†…å®¹ ç»“æŸæ ‡ç­¾ --\u0026gt; ç»“æ„ æ ‡ç­¾ç”± \u0026lt; ã€ \u0026gt; ã€ / ã€ è‹±æ–‡å•è¯æˆ–å­—æ¯ ç»„æˆã€‚å¹¶ä¸”æŠŠæ ‡ç­¾ä¸­ \u0026lt;\u0026gt; åŒ…æ‹¬èµ·æ¥çš„éƒ¨åˆ†ç§°ä¸ºæ ‡ç­¾å å¸¸è§æ ‡ç­¾ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š\u0026lt;å¼€å§‹æ ‡ç­¾\u0026gt;åŒ…è£¹å†…å®¹\u0026lt;ç»“æŸæ ‡ç­¾\u0026gt; éƒ¨åˆ†å•æ ‡ç­¾æ— æ³•åŒ…è£¹å†…å®¹ï¼š\u0026lt;å•æ ‡ç­¾\u0026gt; \u0026lt;br\u0026gt; \u0026lt;hr\u0026gt; \u0026lt;img\u0026gt; å…³ç³» æ ‡ç­¾ä¹‹é—´çš„å…³ç³»åŒ…æ‹¬ï¼š\nåµŒå¥—å…³ç³»ï¼ˆçˆ¶å­å…³ç³»ï¼‰\n\u0026lt;head\u0026gt; \u0026lt;title\u0026gt;\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; å…„å¼Ÿå…³ç³»ï¼ˆå¹¶åˆ—å…³ç³»ï¼‰\n\u0026lt;head\u0026gt;\u0026lt;/head\u0026gt; \u0026lt;body\u0026gt;\u0026lt;/body\u0026gt; æ ‡é¢˜ \u0026lt;h1\u0026gt;è¿™æ˜¯ä¸€ä¸ªæ ‡é¢˜\u0026lt;/h1\u0026gt; \u0026lt;!--æ‰€æœ‰çš„æ ‡é¢˜å•ç‹¬å æ®ä¸€è¡Œ--\u0026gt; æ®µè½ \u0026lt;p\u0026gt;è¿™æ˜¯ä¸€ä¸ªæ®µè½\u0026lt;/p\u0026gt; é»˜è®¤æ ·å¼ï¼š \u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;ä¸­é—´ä¼šç©ºè¡Œ \u0026lt;br\u0026gt;ä¸­é—´ä¸ä¼šç©ºè¡Œ\t\u0026lt;!--Break--\u0026gt; \u0026lt;!--è¿™åªæ˜¯é»˜è®¤æ ·å¼ï¼Œp=paragraphï¼Œbr=break--\u0026gt; \u0026lt;hr\u0026gt;åˆ†éš”ç¬¦å·\u0026lt;/hr\u0026gt; HTMLå†™ç»“æ„ï¼ŒCSSå†™æ ·å¼\n","title":"03 HTML","url":"/techs/03-html/"},{"content":"CSS CSS - Cascading Style Sheets å±‚å æ ·å¼è¡¨\nHTMLè¡¨è¾¾ç»“æ„ï¼ŒCSSè¡¨è¾¾æ ·å¼ æ ·å¼å’Œå†…å®¹/ç»“æ„æ˜¯åˆ†ç¦»çš„ \u0026lt;!-- ä½¿ç”¨æ–¹æ³• --\u0026gt; \u0026lt;!-- æ–¹æ³•1ï¼šè¡Œå†…æ ·å¼ --\u0026gt; \u0026lt;block style=\u0026#34;property:value;\u0026#34;\u0026gt;\u0026lt;/block\u0026gt; \u0026lt;!-- æ–¹æ³•2:å†…éƒ¨æ ·å¼è¡¨ --\u0026gt; \u0026lt;head\u0026gt; \u0026lt;style\u0026gt; selector{ property:value; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;!-- æ–¹æ³•3:å¤–éƒ¨æ ·å¼è¡¨ --\u0026gt; \u0026lt;!-- aï¼šé“¾æ¥å¼ --\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;path\u0026#34; /\u0026gt; \u0026lt;!-- bï¼šå¯¼å…¥å¼ --\u0026gt; \u0026lt;style\u0026gt; @import url(\u0026#34;css/style.css\u0026#34;); \u0026lt;/style\u0026gt; æˆ‘çš„ç¬¬ä¸€ä¸ªHTMLé¡µé¢\né€‰æ‹© æ ‡ç­¾ tag å½±å“èŒƒå›´å¤§ï¼Œå»ºè®®å°½é‡åº”ç”¨åœ¨å±‚çº§é€‰æ‹©å™¨ä¸­ã€‚\n\u0026lt;style\u0026gt; *{margin:0;padding:0}/* å½±å“æ‰€æœ‰çš„æ ‡ç­¾ */ div{color:red} /* å½±å“æ‰€æœ‰çš„divæ ‡ç­¾ */ \u0026lt;/style\u0026gt; Id # é€šè¿‡idåæ¥é€‰æ‹©å…ƒç´ ï¼Œä¸èƒ½å¤ç”¨ï¼Œ ä¸æ¨è ä½¿ç”¨ã€‚\n\u0026lt;style\u0026gt; #box{color:red} \u0026lt;/style\u0026gt; \u0026lt;div id=\u0026#34;box\u0026#34;\u0026gt;......\u0026lt;/div\u0026gt; \u0026lt;!--å¯¹åº”ä»¥ä¸Šä¸€æ¡æ ·å¼ï¼Œå…¶å®ƒå…ƒç´ ä¸å…è®¸åº”ç”¨æ­¤æ ·å¼--\u0026gt; ç±» . é€šè¿‡ç±»åæ¥é€‰æ‹©å…ƒç´ ï¼Œå¤šå¯¹å¤šã€‚\n\u0026lt;style\u0026gt; .red{color:red} .big{font-size:20px} .mt10{margin-top:10px} *.important{color:red} p.important{color:red}/*ç»„åˆä½¿ç”¨*/ p .important{color:red}/*æœ‰ç©ºæ ¼æ—¶å°±æ˜¯å±‚çº§é€‰æ‹©å™¨*/ \u0026lt;/style\u0026gt; \u0026lt;div class=\u0026#34;red\u0026#34;\u0026gt;......\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;important warning\u0026#34;\u0026gt;......\u0026lt;/div\u0026gt; \u0026lt;!--ä¸€ä¸ªå…ƒç´ å¯ä»¥åŒæ—¶å±äºå¤šä¸ªç±»--\u0026gt; å­ä»£ \u0026gt; ä¾æ® HTML æ ‡ç­¾çš„åµŒå¥—å…³ç³»ï¼Œé€‰æ‹©çˆ¶å…ƒç´ ä¸­å­ä»£ä¸­æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ã€‚\nNote: å­ä»£åªåŒ…æ‹¬å„¿å­\n\u0026lt;style\u0026gt; .box \u0026gt; a {color: indianred} \u0026lt;/style\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt; \u0026lt;p\u0026gt;\u0026lt;a href=\u0026#34;#\u0026#34;\u0026gt;......\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34;\u0026gt;......\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; å±‚çº§/åä»£ é€‰æ‹©çˆ¶å…ƒç´ ä¸­åä»£ä¸­æ»¡è¶³æ¡ä»¶çš„å…ƒç´ .\nNote: åä»£åŒ…æ‹¬å„¿å­ã€å­™å­ã€é‡å­™å­\u0026hellip;\u0026hellip;\né€šè¿‡å±‚çº§é˜²æ­¢å‘½åå†²çª\næœ€å¥½ä¸è¦è¶…è¿‡å››å±‚ï¼Œå¦åˆ™ä¼šå½±å“æ€§èƒ½\n\u0026lt;style\u0026gt; .box span{color:red} .box .red{color:pink} .red{color:red} \u0026lt;/style\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt; \u0026lt;span\u0026gt;......\u0026lt;/span\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;red\u0026#34;\u0026gt;......\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;h3 class=\u0026#34;red\u0026#34;\u0026gt;......\u0026lt;/h3\u0026gt;\u0026lt;/div\u0026gt; ç»„ , ç”¨é€—å·åˆ†éš”ï¼Œå°†å¤šä¸ªå…ƒç´ ç»„åˆä¸ºä¸€ç»„\n\u0026lt;style\u0026gt; .box1,.box2,.box3{width:100px;height:100px} .box1{background:red} .box2{background:pink} .box2{background:gold} \u0026lt;/style\u0026gt; äº¤é›† :no_entry_sign: é€‰ä¸­é¡µé¢ä¸­åŒæ—¶æ»¡è¶³å¤šä¸ªé€‰æ‹©å™¨çš„æ ‡ç­¾ï¼› æ—¢èƒ½è¢« 1 é€‰ä¸­ï¼Œåˆèƒ½è¢« 2 é€‰ä¸­ï¼Œä¸­é—´æ²¡æœ‰ç©ºæ ¼ã€‚\nNote: äº¤é›†é€‰æ‹©å™¨ä¸­å¦‚æœæœ‰æ ‡ç­¾é€‰æ‹©å™¨ï¼Œæ ‡ç­¾é€‰æ‹©å™¨å¿…é¡»å†™åœ¨æœ€å‰é¢\n\u0026lt;style\u0026gt; p.box{color: blueviolet} \u0026lt;/style\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt; \u0026lt;p class=\u0026#34;box\u0026#34;\u0026gt;......\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;......\u0026lt;/p\u0026gt; ä»¥ä¸‹å±æ€§ä¸º CSS3 æ–°å¢â†“\nå±æ€§ [attribute] [attribute] é€‰æ‹©æ‰€æœ‰å¸¦æœ‰ç‰¹å®šå±æ€§çš„å…ƒç´ ã€‚\né€‰æ‹©ç¬¦ ç®€ä»‹ E[att] é€‰æ‹©å…·æœ‰ att å±æ€§çš„ E å…ƒç´  E[att=\u0026ldquo;val\u0026rdquo;] é€‰æ‹©å…·æœ‰ att å±æ€§ä¸”å±æ€§å€¼ç­‰äº val çš„ E å…ƒç´  E[att^=\u0026ldquo;val\u0026rdquo;] åŒ¹é…å…·æœ‰ att å±æ€§ä¸”ä»¥ val å¼€å¤´çš„ E å…ƒç´  E[att$=\u0026ldquo;val\u0026rdquo;] åŒ¹é…å…·æœ‰ att å±æ€§ä¸”ä»¥ val ç»“å°¾çš„ E å…ƒç´  E[att*=\u0026ldquo;val\u0026rdquo;] åŒ¹é…å…·æœ‰ att å±æ€§ä¸”å€¼ä¸­å«æœ‰ val çš„ E å…ƒç´  \u0026lt;style\u0026gt; *[title]{color=red} \u0026lt;/style\u0026gt; \u0026lt;div title=hello class=\u0026#34;box1\u0026#34;\u0026gt;......\u0026lt;/div\u0026gt; \u0026lt;a href=/home\u0026gt;......\u0026lt;/a\u0026gt; \u0026lt;style\u0026gt; /* é€‰æ‹©div å…·æœ‰classå±æ€§ ä¸”å±æ€§å€¼å¼€å¤´æ˜¯icon */ div[class^=icon]{ color:red; } \u0026lt;/style\u0026gt; \u0026lt;div class=\u0026#34;title icon1\u0026#34;\u0026gt;å°å›¾æ ‡\u0026lt;/div\u0026gt; \u0026lt;!-- æ³¨æ„ï¼Œåªè¦é¡ºåºå‰åé¢ å€’å°±æ— æ•ˆ --\u0026gt; \u0026lt;div class=\u0026#34;icon2\u0026#34;\u0026gt;å°å›¾æ ‡\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;icon3\u0026#34;\u0026gt;å°å›¾æ ‡\u0026lt;/div\u0026gt; ç»“æ„ä¼ªç±» :pseudo class ä¸»è¦æ ¹æ® æ–‡æ¡£ç»“æ„ æ¥é€‰æ‹©å™¨å…ƒç´ ï¼Œå¸¸ç”¨ä¸æ ¹æ®çˆ¶çº§é€‰æ‹©å™¨é€‰æ‹©é‡Œé¢çš„å­å…ƒç´ ã€‚\né€‰æ‹©ç¬¦ ç®€ä»‹ E:first-child åŒ¹é…çˆ¶å…ƒç´ çš„ç¬¬ä¸€ä¸ªå­å…ƒç´  E E:last-child åŒ¹é…çˆ¶å…ƒç´ çš„æœ€åä¸€ä¸ªå­å…ƒç´  E E:nth-child(n) åŒ¹é…çˆ¶å…ƒç´ ä¸­çš„ç¬¬nä¸ªå­å…ƒç´  E E:first-child æŒ‡å®šç±»å‹ E çš„ç¬¬ä¸€ä¸ª E:first-of-type æŒ‡å®šç±»å‹ E çš„æœ€åä¸ª E:nth-of-type(n) æŒ‡å®šç±»å‹ E çš„ç¬¬ n ä¸ª e.g.: ç”¨äºè¡¨æ ¼éš”è¡Œå˜è‰²ã€‚\nE:nth-child(n) é€‰æ‹©æŸä¸ª çˆ¶å…ƒç´  çš„ä¸€ä¸ªæˆ–å¤šä¸ªç‰¹å®šçš„ å­å…ƒç´  ã€‚\nn å¯ä»¥æ˜¯æ•°å­—ã€å…³é”®å­—å’Œå…¬å¼\næ•°å­—ï¼šé€‰æ‹©ç¬¬ n ä¸ªå­å…ƒç´ ï¼ˆä»åºå· 1 å¼€å§‹ï¼‰ å…³é”®å­—ï¼ševen å¶æ•°ï¼Œodd å¥‡æ•° E:nth-child(even){} å…¬å¼ï¼šåºå· n å–å€¼èŒƒå›´ $$[0,n]$$ ã€‚ç¬¬ 0 ä¸ªå…ƒç´ æˆ–è€…è¶…å‡ºäº†å…ƒç´ çš„ä¸ªæ•°éƒ½ä¼šè¢«å¿½ç•¥ *: å­å…ƒç´ çš„åºå·è¿˜æ˜¯ä» 1 å¼€å§‹ E:nth-child(n){} é€‰æ‹©æ‰€æœ‰å…ƒç´  E:nth-child(2n+1){} é€‰æ‹©å¥‡å…ƒç´  E:nth-child(-n+5){} é€‰æ‹©å‰ 5 ä¸ªå…ƒç´  NOTE:\nnth-child ä¼šæŠŠ æ‰€æœ‰ ç›’å­æ’åºé€‰æ‹©ï¼Œå†çœ‹æ˜¯å¦å’Œ E åŒ¹é… nth-of-type ä¼šé€‰ä¸­æ‰€æœ‰ E ï¼Œå†æŠŠ æŒ‡å®šå…ƒç´  ç›’å­æ’åºé€‰æ‹© ä¼ªå…ƒç´  ::pseudo elements å¯ä»¥åˆ©ç”¨ CSS åˆ›å»ºæ–°æ ‡ç­¾å…ƒç´ è€Œæ— éœ€ HTML æ ‡ç­¾ä»è€Œç®€åŒ–ç»“æ„ã€‚\nA CSS pseudo-element is a keyword added to a selector that lets you style a specific part of the selected element(s). For example, ::first-line can be used to change the font of the first line of a paragraph.\n::before ::after\nå®ƒä»¬å¯ä»¥é€šè¿‡æ ·å¼åœ¨å…ƒç´ ä¸­æ’å…¥å†…å®¹ ä¸€èˆ¬ç”¨åœ¨é“¾æ¥çš„å“åº” e.g.: å¯ä»¥åœ¨è§†é¢‘æ ‡ç­¾å‰ååˆ›å»ºä¼ªå…ƒç´ ï¼Œä½¿å…¶æ”¯æŒé¼ æ ‡æ‚¬åœæ˜¾ç¤ºæš‚åœé®ç½©ã€‚\n\u0026lt;style\u0026gt; .player{ height: 10vh;width: 15vh; position: relative; background-image: linear-gradient(-27deg, #fccb90 0%, #d57eeb 100%); } .player::before { content:\u0026#39;\u0026#39;; /* å¿…éœ€ */ top: 0; left: 0; visibility: hidden; /* éšè—é®ç½©å±‚ */ /* åˆ©ç”¨ç»å¯¹å®šä½å±…ä¸­ */ position: absolute; width: 100%; height: 100%; /* ä¼ªå…ƒç´ ä½œä¸ºè¯¥å…ƒç´ çš„å­å…ƒç´ å‡ºç° */ background-image: linear-gradient(-27deg, rgba(0, 0, 0, 0.1) -7%, rgba(0, 0, 0, 0.2) 100%); } .player::after { content: \u0026#39;\\25b6\u0026#39;; font-family: \u0026#39;icon-font\u0026#39;,serif; visibility: hidden; /* éšè—é®ç½©å±‚ */ position: absolute; /* åˆ©ç”¨ç»å¯¹å®šä½å±…ä¸­ */ top: 50%;left: 50%; transform: translate(-50%,-50%); } .player:hover::before { visibility: visible; } .player:hover::after { visibility: visible; } \u0026lt;/style\u0026gt; \u0026lt;div class=\u0026#34;player\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; â–¶ ğŸ“ Note CSS3 å¼•å…¥ ::before æ˜¯ä¸ºäº†åŒºåˆ† ä¼ªç±» å’Œ ä¼ªå…ƒç´ \nåˆ›å»ºçš„å…ƒç´ å±äº è¡Œå†…å…ƒç´  ï¼Œä¸å­˜åœ¨äº æ–‡æ¡£æ ‘ ä¸­ è¯­æ³•ï¼šelement::before{} before å’Œ after å¿…é¡»æœ‰ content å±æ€§ï¼šcontent: '' ğŸ“ Note ä¼ªå…ƒç´ ä½œä¸º element çš„å­å…ƒç´ å¼•å…¥ï¼Œå› æ­¤æ ¹æ®â€œå­ç»çˆ¶ç›¸â€ï¼Œéœ€è¦åœ¨çˆ¶å…ƒç´ çš„ä½ç½®è®¾ä¸º position: relative\n/* CSS3 è¯­æ³• */ element::before {Cascading style sheets} /* ï¼ˆå•å†’å·ï¼‰ CSS2 è¿‡æ—¶è¯­æ³• - ä»…ç”¨äºæ”¯æŒ IE8 */ /* IE8 æ˜¯ Windows XP è‡ªå¸¦æµè§ˆå™¨*/ element:before {Cascading style sheets} /* åœ¨æ¯ä¸ª p å…ƒç´ å‰æ’å…¥å†…å®¹ */ p::before {content: \u0026#34;Hello World!\u0026#34;} + ::before -element- ::after + å…¶å®ƒ element + element div + p\né€‰æ‹©æ‰€æœ‰ç´§è·Ÿåœ¨ \u0026lt;div\u0026gt; å…ƒç´ ä¹‹åçš„ç¬¬ä¸€ä¸ª \u0026lt;p\u0026gt; å…ƒç´  etc\u0026hellip;\næ€§èƒ½ æ•ˆç‡ä½ä¸‹çš„ CSS é€‰æ‹©å™¨ä¼šé™ä½é¡µé¢æ¸²æŸ“é€Ÿåº¦ï¼ŒCSS è§„åˆ™çš„æŸäº›ç±»å‹ä»¥åŠä¸ JavaScript çš„äº¤äº’å¯èƒ½ä¼šä½¿é¡µé¢å˜æ…¢ã€‚ å¤æ‚çš„é¡µé¢ï¼ˆ å­é€‰æ‹©å™¨ å’Œ åä»£é€‰æ‹©å™¨ ï¼‰é€šå¸¸è¡¨ç°æœ€å·®ã€‚\nä¸è¿‡åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒCSS å¯¹æ€§èƒ½çš„å½±å“å¾ˆå°ï¼Œå¯¹ CSS é€‰æ‹©å™¨çš„æ”¹è¿›åªä¼šå¸¦æ¥å‡ åæ¯«ç§’çš„æå‡ã€‚\né€‰æ‹©å™¨æ•ˆç‡ é€‰æ‹©å™¨æ•ˆç‡ä»é«˜åˆ°ä½æ’åºå¦‚ä¸‹ï¼š\nç­‰çº§ é€‰æ‹©å™¨ ç”¨æ³• 1 Id é€‰æ‹©å™¨ #myId 2 ç±»é€‰æ‹©å™¨ .myClass 3 æ ‡ç­¾é€‰æ‹©å™¨ div 4 ç›¸é‚»é€‰æ‹©å™¨ h1 + p 5 å­é€‰æ‹©å™¨ ul \u0026gt; li 6 åä»£é€‰æ‹©å™¨ li a 7 é€šé…ç¬¦é€‰æ‹©å™¨ * 8 å±æ€§ç¬¦é€‰æ‹©å™¨ a[rel=\u0026lsquo;external\u0026rsquo;] 9 ä¼ªç±»ç¬¦é€‰æ‹©å™¨ a:hover ID é€‰æ‹©å™¨å’Œç±»é€‰æ‹©å™¨åœ¨é€Ÿåº¦ä¸Šçš„å·®å¼‚å¾ˆå°å¾ˆå°ï¼Œåœ¨é‡ç»˜é€Ÿåº¦ä¸Šï¼ŒID é€‰æ‹©å™¨è¦æ¯”ç±»é€‰æ‹©å™¨æ…¢ä¸€ç‚¹ç‚¹ï¼ˆ0.2ms çš„å·®å¼‚ï¼‰ã€‚\nä½¿ç”¨åŸåˆ™ ä½¿ç”¨æœ€åˆç†ä¼˜å…ˆçº§çš„é€‰æ‹©å™¨ æå°‘æƒ…å†µä¸‹ä½¿ç”¨ id é€‰æ‹©å™¨ï¼Œæœ€å¸¸ç”¨çš„æ˜¯ ç±»é€‰æ‹©å™¨ liã€tdã€dd ç­‰å¤§é‡è¿ç»­å‡ºç°æ—¶ï¼Œå¹¶ä¸”æ ·å¼ç›¸åŒï¼Œé‡‡ç”¨ åä»£é€‰æ‹©å™¨ é¿å…ä½¿ç”¨ å†…è”æ ·å¼ ï¼Œå³åœ¨æ ‡ç­¾ä¸­å†™å…¥ CSSï¼Œè¿èƒŒäº† å†…å®¹ä¸æ˜¾ç¤ºåˆ†ç¦» çš„æ€æƒ³ï¼Œå¹¶ä¸”å¾ˆéš¾è¦†ç›–å…¶æ ·å¼ !important ä½¿ç”¨åŸåˆ™\nä¼˜å…ˆè€ƒè™‘ä½¿ç”¨æ ·å¼è§„åˆ™çš„ä¼˜å…ˆçº§æ¥è§£å†³é—®é¢˜è€Œä¸æ˜¯ !important åªæœ‰åœ¨éœ€è¦è¦†ç›–å…¨ç«™æˆ–å¤–éƒ¨ CSS çš„ç‰¹å®šé¡µé¢ä¸­ä½¿ç”¨ !important æ°¸è¿œä¸è¦åœ¨ä½ çš„æ’ä»¶ä¸­ä½¿ç”¨ !important æ°¸è¿œä¸è¦åœ¨å…¨ç«™èŒƒå›´çš„ CSS ä»£ç ä¸­ä½¿ç”¨ !important è¦†ç›–å†…è”æ ·å¼æ—¶æˆ–è€…ä¼˜å…ˆçº§å¾ˆé«˜çš„é€‰æ‹©å™¨ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ !important æå‡ é¿å…ä½¿ç”¨é€šç”¨é€‰æ‹©å™¨ .content { color: red; } æµè§ˆå™¨åŒ¹é…æ–‡æ¡£ä¸­æ‰€æœ‰çš„å…ƒç´ åï¼Œåˆ†åˆ«å‘ä¸Šé€çº§åŒ¹é… class ä¸º content çš„å…ƒç´ ï¼Œç›´åˆ°æ–‡æ¡£çš„æ ¹èŠ‚ç‚¹ã€‚å› æ­¤åŒ¹é…å¼€é”€å¾ˆå¤§ï¼Œæ‰€ä»¥é¿å…ä½¿ç”¨å…³è”é€‰æ‹©å™¨æ˜¯é€šé…é€‰æ‹©å™¨çš„æƒ…å†µã€‚\né¿å…ä½¿ç”¨æ ‡ç­¾æˆ– class é€‰æ‹©å™¨é™åˆ¶ ID é€‰æ‹©å™¨ ID é€‰æ‹©å™¨æ˜¯ å”¯ä¸€ çš„ï¼ŒåŠ ä¸Šé™åˆ¶æ¡ä»¶ï¼Œåè€Œå¢åŠ äº†ä¸å¿…è¦çš„åŒ¹é…ã€‚\n/* é¿å…ä½¿ç”¨ */ button#backButton { } /* æ¨èä½¿ç”¨ */ #backButton { } /* é¿å…ä½¿ç”¨ */ .menu-left#backButton { } /* æ¨èä½¿ç”¨ */ #backButton { } é¿å…ä½¿ç”¨æ ‡ç­¾é™åˆ¶ class å±æ€§ /* é¿å…ä½¿ç”¨ */ button.backButton { } /* æ¨èä½¿ç”¨ */ .backButton { } é¿å…ä½¿ç”¨ å¤šå±‚æ ‡ç­¾é€‰æ‹©å™¨ ï¼Œä½¿ç”¨ class é€‰æ‹©å™¨æ›¿æ¢å¤šå±‚çº§ï¼Œå‡å°‘ CSS æŸ¥æ‰¾ /* é¿å…ä½¿ç”¨ */ treeitem[mailfolder=\u0026#39;true\u0026#39;] \u0026gt; treerow \u0026gt; treecell { } /* æ¨èä½¿ç”¨ */ .treecell-mailfolder { } é¿å…ä½¿ç”¨å­é€‰æ‹©å™¨ /* é¿å…ä½¿ç”¨ */ treehead treerow treecell { } treehead \u0026gt; treerow \u0026gt; treecell { } /* æ¨èä½¿ç”¨ */ .treecell-header { } ä½¿ç”¨ç»§æ‰¿ CSS å…·æœ‰é«˜æ•ˆçš„ ç»§æ‰¿ æ€§ã€‚\næ¸²æŸ“ ç»§æ‰¿æ€§ ç‰¹æ€§ï¼šå­å…ƒç´ å…·æœ‰é»˜è®¤ç»§æ‰¿çˆ¶å…ƒç´ æ ·å¼çš„ç‰¹ç‚¹ï¼ˆå­æ‰¿çˆ¶ä¸šï¼‰\nå¯ä»¥ç»§æ‰¿çš„å¸¸è§å±æ€§ï¼ˆæ–‡å­—ã€æ§åˆ¶ã€å±æ€§éƒ½å¯ä»¥ç»§æ‰¿ï¼‰\ncolor font-style font-weight font-size text-indent text-align line-height \u0026hellip; Note:\nå¯ä»¥é€šè¿‡ è°ƒè¯•å·¥å…· åˆ¤æ–­æ ·å¼æ˜¯å¦å¯ä»¥ç»§æ‰¿ æ§åˆ¶æ–‡å­— çš„å±æ€§éƒ½èƒ½ç»§æ‰¿ï¼Œä¸æ˜¯ æ§åˆ¶æ–‡å­— çš„éƒ½ä¸èƒ½ç»§æ‰¿ å½“æµè§ˆå™¨æœ‰ é»˜è®¤æ ·å¼ ï¼Œåˆ™æŸäº›å…ƒç´ å‘ç”Ÿ ç»§æ‰¿å¤±æ•ˆ ï¼š\na æ ‡ç­¾çš„ color h ç³»åˆ—æ ‡ç­¾çš„ font-size è¶…é“¾æ¥ h6æ ‡é¢˜ ### å±‚å æ€§ ç»™åŒä¸€ä¸ªæ ‡ç­¾è®¾ç½®äº†ç›¸åŒçš„æ ·å¼ï¼Œæ­¤æ—¶æµè§ˆå™¨ä¼šå¦‚ä½•æ¸²æŸ“å‘¢ï¼Ÿ\n\u0026lt;style\u0026gt; p{ color:red; color:blue; } \u0026lt;/style\u0026gt; æ­¤æ—¶æ ·å¼å‘ç”Ÿå±‚å ï¼ˆè¦†ç›–ï¼‰ï¼Œå†™åœ¨æœ€ä¸‹é¢çš„ä¼šç”Ÿæ•ˆ\nç‰¹æ€§ï¼š\nç»™åŒä¸€ä¸ªæ ‡ç­¾è®¾ç½® ä¸åŒ çš„æ ·å¼ -\u0026gt; æ­¤æ—¶æ ·å¼ä¼šå±‚å±‚ å åŠ  -\u0026gt; å…±åŒä½œç”¨ åœ¨æ ‡ç­¾ä¸Š ç»™åŒä¸€ä¸ªæ ‡ç­¾è®¾ç½® ç›¸åŒ çš„æ ·å¼ -\u0026gt; æ­¤æ—¶æ ·å¼ä¼šå±‚å±‚ è¦†ç›– -\u0026gt; å†™åœ¨ æœ€å çš„æ ·å¼ä¼šç”Ÿæ•ˆ Note:\nå½“æ ·å¼å†²çªåï¼Œåªæœ‰å½“ é€‰æ‹©å™¨ å…·æœ‰ç›¸åŒ ä¼˜å…ˆçº§ æ—¶ï¼Œæ‰èƒ½é€šè¿‡å±‚å æ€§åˆ¤æ–­ç»“æœ ä¼˜å…ˆçº§ CSS ä¼šå¯¹ä¸åŒé€‰æ‹©å™¨è¿›è¡Œ å åŠ è®¡ç®— ï¼Œä¼˜å…ˆçº§é«˜çš„é€‰æ‹©å™¨æ ·å¼ä¼šä¼˜å…ˆè¦†ç›–ä¼˜å…ˆçº§ä½çš„é€‰æ‹©å™¨æ ·å¼ã€‚\nä¼˜å…ˆçº§å…¬å¼ï¼š\nç»§æ‰¿ \u0026lt; é€šé…ç¬¦é€‰æ‹©å™¨ \u0026lt; æ ‡ç­¾é€‰æ‹©å™¨ \u0026lt; ç±»é€‰æ‹©å™¨ \u0026lt; idé€‰æ‹©å™¨ \u0026lt; è¡Œå†…æ ·å¼ \u0026lt; !important Note:\nè°çš„èŒƒå›´è¶Šå¹¿ï¼Œè°çš„ä¼˜å…ˆçº§è¶Šä½ !important ä¸èƒ½æå‡ç»§æ‰¿çš„ä¼˜å…ˆçº§ å®é™…å¼€å‘ä¸­ä¸å»ºè®®ä½¿ç”¨ !important å¯¹äº å¤åˆé€‰æ‹©å™¨ ï¼Œæ­¤æ—¶é€šè¿‡ æƒé‡å åŠ è®¡ç®— çš„æ–¹æ³•ï¼Œåˆ¤æ–­å“ªä¸ªé€‰æ‹©å™¨ä¼˜å…ˆçº§æœ€é«˜ã€‚æƒé‡å åŠ è®¡ç®—å…¬å¼ï¼š $$ ( \\begin{matrix} ç¬¬ä¸€çº§\\\\ {\\Large 0}\\\\ \\Downarrow\\\\ {\\small{{\\color{Red}è¡Œå†…æ ·å¼}}\\color[RGB]{221,7,7}çš„ä¸ªæ•°} \\end{matrix}, \\begin{matrix} ç¬¬äºŒçº§\\\\ {\\Large 0}\\\\ \\Downarrow\\\\ {\\small{{\\color{Red}idé€‰æ‹©å™¨}}\\color[RGB]{221,7,7}çš„ä¸ªæ•°} \\end{matrix}, \\begin{matrix} ç¬¬ä¸‰çº§\\\\ {\\Large 0}\\\\ \\Downarrow\\\\ {\\small{{\\color{Red}ç±»é€‰æ‹©å™¨}}\\color[RGB]{221,7,7}çš„ä¸ªæ•°} \\end{matrix}, \\begin{matrix} ç¬¬å››çº§\\\\ {\\Large 0}\\\\ \\Downarrow\\\\ {\\small{{\\color{Red}æ ‡ç­¾é€‰æ‹©å™¨}}\\color[RGB]{221,7,7}ä¸ªæ•°} \\end{matrix} ) $$ *: ç±»ã€ä¼ªç±»ã€å±æ€§é€‰æ‹©å™¨çš„æƒé‡ç›¸åŒ\næ¯”è¾ƒè§„åˆ™ï¼š\nä»é«˜åˆ°ä½æ¯”è¾ƒ ç›¸åŒæƒé‡é€‰æ‹©å™¨ æ•°ç›®ï¼Œæ•°é‡ å¤š è€…èƒœå‡ºï¼Œç›¸åŒ åˆ™æ¯”è¾ƒ ä¸‹ä¸€çº§ï¼Œä¾æ¬¡ç±»æ¨ å¦‚æœæœ€ç»ˆæ‰€æœ‰æ•°å­—ç›¸åŒï¼Œè¡¨ç¤ºä¼˜å…ˆçº§ç›¸åŒï¼Œåˆ™æ¯”è¾ƒ å±‚å æ€§ !important å¦‚æœä¸ç»§æ‰¿ï¼Œåˆ™æƒé‡æœ€é«˜ \u0026lt;style\u0026gt; /* ï¼ˆè¡Œå†…ï¼Œidï¼Œç±»ï¼Œæ ‡ç­¾ï¼‰*/ /*(0, 1, 0, 1)*/ div #one { color: orange; } /*(0, 0, 2, 0)*/ .father .son { color: skyblue; } /*(0, 0, 1, 1)*/ .father p { color: purple; } /*(0, 0, 0, 2)*/ div p{ color: pink; } \u0026lt;/style\u0026gt; \u0026lt;div id=\u0026#34;father\u0026#34;\u0026gt; \u0026lt;p class=\u0026#34;son\u0026#34; id=\u0026#34;one\u0026#34;\u0026gt;æˆ‘æ˜¯ä¸€ä¸ªæ ‡ç­¾\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; æˆ‘æ˜¯ä¸€ä¸ªæ ‡ç­¾\n```css /* (0, 2, 0, 0) */ #father #son{ color: orange; } /(0, 1, 1, 1)/ #father p.c2 { color: black; }\n/(0, 0, 1, 1)/ #father{ color: green; }\n/(0, 0, 0, 2)/ div#father.c1{ color: yellow; }\n\u0026lt;div id=\u0026#34;father\u0026#34; class=\u0026#34;c1\u0026#34;\u0026gt; \u0026lt;p id=\u0026#34;son\u0026#34; class=\u0026#34;c2\u0026#34; style=\u0026#34;color: orange;\u0026#34;\u0026gt;è¿™è¡Œæ–‡æœ¬æ˜¯ä»€ä¹ˆé¢œè‰²çš„ï¼Ÿ\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; ## èƒŒæ™¯ ### é¢œè‰² 1. å±æ€§åï¼š`background-color `(bgc) 2. å±æ€§å€¼ï¼š - é¢œè‰²å–å€¼ï¼šå…³é”®å­—ã€RGB è¡¨ç¤ºæ³•ã€RGBA è¡¨ç¤ºæ³•ã€åå…­è¿›åˆ¶ 3. **NOTE:** - èƒŒæ™¯é¢œè‰²é»˜è®¤æ˜¯é€æ˜ï¼š `rgba(0, 0, 0, 0)`ã€`transparent` - èƒŒæ™¯é¢œè‰²ä¸ä¼šå½±å“ç›’å­å¤§å°ï¼Œå¹¶ä¸”è¿˜èƒ½çœ‹æ¸…ç›’å­å¤§å°å’Œä½ç½®ï¼Œä¸€èˆ¬åœ¨å¸ƒå±€ä¸­ä¹ æƒ¯ç»™ç›’å­è®¾ç½®èƒŒæ™¯é¢œè‰² ```html \u0026lt;div style=\u0026#34;background-color:gray\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;background-color:#RRGGBB\u0026#34;\u0026gt; \u0026lt;div style=\u0026#34;background-color:rgb(r,g,b)\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;background-color:rbga(r,g,b,a)\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;background-image:url(href)\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;background-image: linear-gradient(to right, #ffecd2 0%, #fcb69f 100%);\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; è®¾ç½®èƒŒæ™¯é¢œè‰²\né»˜è®¤é¢œè‰² = transparent \u0026lt;div style=\u0026#34;background-repeat:norepeat/repeat-x/repeat-y\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;background-position:center/right/top right/100px 100px\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;background-image: linear-gradient(to right, #ffecd2 0%, #fcb69f 100%);\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;background-attachment:scrool/fixed\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; å›¾ç‰‡ å±æ€§åï¼šbackground-image (bgc)\nå±æ€§å€¼ï¼š\nurl('')\nlinear-gradient()\nNOTE:\nèƒŒæ™¯å›¾ç‰‡ä¸­ url ä¸­å¯ä»¥çœç•¥å¼•å·\né»˜è®¤æ˜¯åœ¨æ°´å¹³å’Œå‚ç›´æ–¹å‘å¹³é“ºçš„\nç±»ä¼¼äºèƒŒæ™¯é¢œè‰²ï¼ŒèƒŒæ™¯å›¾ç‰‡ä»…ä»…æ˜¯ç»™ç›’å­èµ·åˆ°è£…é¥°æ•ˆæœï¼Œæ— æ³•æ’‘å¼€ç›’å­\nå¹³é“º å±æ€§åï¼šbackground-repeat (bgr) å±æ€§å€¼ï¼š å–å€¼ æ•ˆæœ repeat ï¼ˆé»˜è®¤å€¼ï¼‰æ°´å¹³å’Œå‚ç›´æ–¹å‘ä¸Šéƒ½å¹³é“º no-repeat ä¸å¹³é“º repeat-x æ²¿ç€æ°´å¹³æ–¹å‘ï¼ˆxè½´ï¼‰å¹³é“º repeat-y æ²¿ç€å‚ç›´æ–¹å‘ï¼ˆyè½´ï¼‰å¹³é“º ä½ç½® å±æ€§åï¼šbackground-position (bgp)\nå±æ€§å€¼ï¼šbackground-position: æ°´å¹³æ–¹å‘ä½ç½® å‚ç›´æ–¹å‘ä½ç½®\nbackground-posion: right 0; background-posion: center center; background-posion: center; background-posion: 50px 0; background-posion: 50px 100px; background-posion: -50px -100px; æ–¹ä½åè¯ï¼ˆæœ€å¤šè¡¨ç¤º9ä¸ªä½ç½®ï¼‰\næ°´å¹³æ–¹å‘ï¼šleft center right å‚ç›´æ–¹å‘ï¼štop center buttom æ•°å­— + pxï¼ˆåæ ‡ï¼‰\nåæ ‡ç³» åŸç‚¹ï¼š(0,0) - ç›’å­çš„å·¦ä¸Šè§’ xè½´ï¼š æ°´å¹³å‘å³ yè½´ï¼šå‚ç›´å‘ä¸‹ æ“ä½œ å°†å›¾ç‰‡å·¦ä¸Šè§’ä¸åæ ‡ç‚¹é‡åˆå³å¯ NOTE:\næ–¹ä½åè¯å–å€¼å’Œåæ ‡å–å€¼å¯ä»¥æ··ç”¨ï¼Œç¬¬ä¸€ä¸ªå–å€¼è¡¨ç¤ºæ°´å¹³ï¼Œç¬¬äºŒä¸ªå–å€¼è¡¨ç¤ºå‚ç›´ è´Ÿæ•°è¡¨ç¤ºä»å¦ä¸€ä¾§å¼€å§‹ èƒŒæ™¯è‰²å’ŒèƒŒæ™¯å›¾ç‰‡åªåœ¨ç›’å­æ¨¡å‹å†…éƒ¨æ˜¾ç¤º è¿å†™ å±æ€§åï¼šbackground (bg)\nå±æ€§å€¼ï¼šbackground: color image repeat position\n/* ä¸åˆ†å…ˆåé¡ºåº èƒŒæ™¯è‰² èƒŒæ™¯å›¾ èƒŒæ™¯å›¾å¹³é“º èƒŒæ™¯å›¾ä½ç½® */ /* èƒŒæ™¯å›¾ä½ç½®å¦‚æœæ˜¯è‹±æ–‡å•è¯å¯ä»¥é¢ å€’é¡ºåº */ background: pink url(./images/1.jpg) no-repeat center buttom; /* æµ‹è¯•èƒŒæ™¯å›¾ä½ç½®å¦‚æœæ˜¯æ•°å€¼ï¼Œåˆ™ä¸èƒ½é¢ å€’é¡ºåºï¼šæ°´å¹³-å‚ç›´ */ /* æ°´å¹³50pxï¼Œå‚ç›´100px */ background: pink url(./images/1.jpg) no-repeat 100px 50px; å•ä¸ªå±æ€§å€¼çš„åˆå†™ï¼Œå–å€¼ä¹‹é—´ä»¥ç©ºæ ¼éš”å¼€\nçœç•¥é—®é¢˜\nå¯ä»¥æŒ‰ç…§éœ€æ±‚çœç•¥ ç‰¹æ®Šæƒ…å†µï¼šåœ¨ PC ç«¯ï¼Œå¦‚æœç›’å­å¤§å°å’ŒèƒŒæ™¯å›¾ç‰‡å¤§å°ä¸€æ ·ï¼Œå¯ä»¥ç›´æ¥å†™background: url() NOTE:\nå¦‚æœéœ€è¦è®¾ç½®å•ç‹¬çš„æ ·å¼å’Œè¿å†™ è¦ä¹ˆæŠŠå•ç‹¬çš„æ ·å¼å†™åœ¨è¿å†™çš„ä¸‹é¢ è¦ä¹ˆæŠŠå•ç‹¬çš„æ ·å¼å†™åœ¨è¿å†™çš„é‡Œé¢ è¾¨æ img æ ‡ç­¾å’ŒèƒŒæ™¯å›¾ç‰‡çš„åŒºåˆ«\néœ€æ±‚ï¼šéœ€è¦åœ¨ç½‘é¡µä¸­å±•ç¤ºä¸€å¼ å›¾ç‰‡\næ–¹æ³•ä¸€ï¼šç›´æ¥å†™ä¸Š img æ ‡ç­¾ img æ ‡ç­¾æ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œä¸è®¾ç½®å®½é«˜é»˜è®¤ä¼šä»¥åŸå°ºå¯¸æ˜¾ç¤º æ–¹æ³•äºŒï¼šdiv æ ‡ç­¾ + èƒŒæ™¯å›¾ç‰‡ éœ€è¦è®¾ç½® div çš„å®½é«˜ï¼Œå› ä¸ºèƒŒæ™¯å›¾ç‰‡åªæ˜¯è£…é¥°çš„ CSS æ ·å¼ï¼Œä¸èƒ½æ’‘å¼€ div æ ‡ç­¾ img æ ‡ç­¾å’ŒèƒŒæ™¯å›¾ç‰‡çš„é€‰æ‹©\nimg å®é™…åº”ç”¨ä¸­ç”¨æ¥æ˜¾ç¤ºæ¯”è¾ƒé‡è¦çš„å›¾ç‰‡ äº§å“å›¾ã€è½®æ’­å›¾ èµ·åˆ°ä¿®é¥°ä½œç”¨/è£…é¥°ã€ç¾åŒ–æ€§ä½¿ç”¨èƒŒæ™¯å›¾ æ–‡æœ¬ å­—ä½“ å­—ä½“æ ·å¼ å­—ä½“å¤§å°ï¼šfont-size å­—ä½“ç²—ç»†ï¼šfont-weight å­—ä½“æ ·å¼ï¼šfont-style å­—ä½“ç±»å‹ï¼šfont-family å­—ä½“ç±»å‹ï¼šfontå±æ€§è¿å†™ æ–‡æœ¬æ ·å¼ line-height è¡Œé«˜ \u0026lt;div style=\u0026#34;text-transform:uppercase\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;text-transform:capitalize\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;text-decoration:underline\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;text-decoration:line-through\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;!-- å¼€å‘ä¸­ä¼šä½¿ç”¨text-decoration:none æ¸…é™¤aæ ‡ç­¾é»˜è®¤çš„ä¸‹åˆ’çº¿ --\u0026gt; \u0026lt;div style=\u0026#34;text-align:center\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;!-- ï¼ˆå†…å®¹å¯¹é½æ–¹å¼ï¼‰å¯¹äºå›¾ç‰‡ï¼Œåœ¨çˆ¶å…ƒç´ è®¾ç½® --\u0026gt; \u0026lt;!-- æ”¯æŒæ–‡æœ¬ã€span/aæ ‡ç­¾ã€input/imgæ ‡ç­¾ --\u0026gt; \u0026lt;div style=\u0026#34;white-space:pre\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;font-family:monospace\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;!-- serif sans-serif monospace cursive fantasy --\u0026gt; \u0026lt;!-- Times, TimesNR, serif --\u0026gt; \u0026lt;div style=\u0026#34;font-style:oblique\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;font-variant:small-caps\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;font-weight:bold\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; word spacing letter spacing upper case capitalize underline line-through center no auto word-wrap monospace cursive è‰ä¹¦fantasy æ¢¦å¹» italic oblique Italic font faces are generally cursive in nature, usually using less horizontal space than their unstyled counterparts, while oblique faces are usually just sloped versions of the regular face small-caps weight bold weight 100 weight 450 weight 700 size 1.5em æ•ˆæœ \u0026lt;div style=\u0026#34;text-shadow:3px 5px 5px #4facfe\u0026#34;\u0026gt;x y range color\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;text-shadow:0px -1px 0px #00f2fe,0px -1px 0px #4facfe;color:#4facfe;font-weight:700;text-align:left\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;outline-color:#ff7eb3;outline-style:solid\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;!--groove ridge inset outset--\u0026gt; text-shadow: x-offset y-offset range color text-shadow:0px -1px 0px #00f2fe,0px -1px 0px #4facfe;color:#4facfe;font-weight:700 outline-color:#ff7eb3;outline-style:groove æ®µè½ \u0026lt;div style=\u0026#34;text-indent:5em\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;line-height:2em\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;text-align:right\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;text-align:justify\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;letter-spacing:5px\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; è¿™æ˜¯ä¸€ä¸ª5emçš„ç¼©è¿› è¿™æ˜¯ä¸€ä¸ª10%çš„ç¼©è¿› è¿™æ˜¯ä¸€ä¸ª2cmçš„ç¼©è¿› è¿™æ˜¯ä¸€ä¸ª1ptçš„ç¼©è¿› ä¹Ÿå°±æ˜¯1/72è‹±å¯¸ è¿™æ˜¯ä¸€è¡Œè¡Œé«˜2emçš„æ–‡å­— è¿™æ˜¯ä¸€è¡Œå³å¯¹é½çš„æ–‡å­— è¿™æ˜¯ä¸€è¡Œä¸¤ç«¯å¯¹é½çš„æ–‡å­— Note: å»ºè®®ä½¿ç”¨emæ ¼å¼\nè¡Œé«˜ line-height\næ§åˆ¶ä¸€è¡Œçš„ä¸Šä¸‹é—´è·ã€‚\nå–å€¼ æ•°å­— + å®½åº¦å•ä½ å€æ•°ï¼ˆå½“å‰æ ‡ç­¾ font-size çš„å€æ•°ï¼‰ åº”ç”¨ è®©å•è¡Œæ–‡æœ¬å‚ç›´å±…ä¸­å¯ä»¥è®¾ç½® line-height: æ–‡å­—çˆ¶å…ƒç´ é«˜åº¦ ç½‘é¡µç²¾å‡†å¸ƒå±€æ—¶ï¼Œä¼šè®¾ç½® line-height: 1 å¯ä»¥å–æ¶ˆä¸Šä¸‹é—´è· Note:\nå¦‚æœè®¾ç½®äº†è¡Œé«˜å’Œ font è¿å†™ï¼Œæ³¨æ„è¦†ç›–é—®é¢˜ font: style weight size/line-height family 001 line-height: 1.8em 002 line-height: 3em åˆ—è¡¨ æœ‰åºåˆ—è¡¨ \u0026lt;ul style=\u0026#34;list-style-type:square\u0026#34;\u0026gt; \u0026lt;li\u0026gt;è¯­æ–‡\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;æ•°å­¦\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;ç‰©ç†\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åŒ–å­¦\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; list-style-image: linear-gradient(217deg, #fbc2eb 0%, #a6c1ee 100%);\nlist-style-postion:insideï¼ˆç¬¬äºŒè¡Œå·¦è¾¹å’Œå°åœ†ç‚¹å¯¹é½ï¼‰ è¯­æ–‡ æ•°å­¦ ç‰©ç† åŒ–å­¦ 2. æ— åºåˆ—è¡¨ è¡¨æ ¼ border-collapse æ§åˆ¶è¡¨æ ¼è¡¨æ ¼çš„è¾¹æ¡†æ˜¯åˆ†å¼€çš„è¿˜æ˜¯åˆå¹¶çš„\ncollapse: åˆ†å¼€ separate: åˆå¹¶ \u0026lt;table id=\u0026#34;example-element\u0026#34; class=\u0026#34;transition-all\u0026#34; style=\u0026#34; border-collapse: separate; border: 5px solid; border-color: #dc143c #1e90ff orange #32cd32; padding: 0.75rem; table-layout-fixed\u0026#34;\u0026gt; \u0026lt;!--æ ¹æ®ç¬¬ä¸€è¡Œçš„å¤§å°å†³å®šä¹‹åå¤§å°--\u0026gt; \u0026lt;caption\u0026gt;test\u0026lt;/caption\u0026gt; \u0026lt;tbody\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;td style=\u0026#34;border: 5px solid;border-color: #dc143c #1e90ff orange #32cd32;padding: 0.75rem;\u0026#34;\u0026gt;Cell 1.1\u0026lt;/td\u0026gt; \u0026lt;td width=25px\u0026gt;Cell 1.2\u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;td\u0026gt;Cell 2.1\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;Cell 2.2\u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;td\u0026gt;Cell 3.1\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;Cell 3.2\u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/tbody\u0026gt; \u0026lt;/table\u0026gt; test Cell 1.1 Cell 1.2 Cell 2.1 Cell 2.2 Cell 3.1 Cell 3.2 CSSå®ç°è¡¨æ ¼ï¼š\n\u0026lt;style\u0026gt; ul { margin: 0; padding: 0; list-style: none; } .table { display: table; border-collapse: collapse; border: 1px solid #ccc; } .table-caption { display: table-caption; margin: 0; padding: 0; font-size: 16px; } .table-column-group { display: table-column-group; } .table-column { display: table-column; width: 100px; } .table-row-group { display: table-row-group; } .table-row { display: table-row; } .table-row-group .table-row:hover, .table-footer-group .table-row:hover { background: #f6f6f6; } .table-cell { display: table-cell; padding: 0 5px; border: 1px solid #ccc; } .table-header-group { display: table-header-group; background: #eee; font-weight: bold; } .table-footer-group { display: table-footer-group; } \u0026lt;/style\u0026gt; \u0026lt;div class=\u0026#34;table\u0026#34;\u0026gt; \u0026lt;h2 class=\u0026#34;table-caption\u0026#34;\u0026gt;èŠ±åå†Œï¼š\u0026lt;/h2\u0026gt; \u0026lt;div class=\u0026#34;table-column-group\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;table-column\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;table-column\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;table-column\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;table-header-group\u0026#34;\u0026gt; \u0026lt;ul class=\u0026#34;table-row\u0026#34;\u0026gt; \u0026lt;li class=\u0026#34;table-cell\u0026#34;\u0026gt;åºå·\u0026lt;/li\u0026gt; \u0026lt;li class=\u0026#34;table-cell\u0026#34;\u0026gt;å§“å\u0026lt;/li\u0026gt; \u0026lt;li class=\u0026#34;table-cell\u0026#34;\u0026gt;å¹´é¾„\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;table-footer-group\u0026#34;\u0026gt; \u0026lt;ul class=\u0026#34;table-row\u0026#34;\u0026gt; \u0026lt;li class=\u0026#34;table-cell\u0026#34;\u0026gt;footer\u0026lt;/li\u0026gt; \u0026lt;li class=\u0026#34;table-cell\u0026#34;\u0026gt;footer\u0026lt;/li\u0026gt; \u0026lt;li class=\u0026#34;table-cell\u0026#34;\u0026gt;footer\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;table-row-group\u0026#34;\u0026gt; \u0026lt;ul class=\u0026#34;table-row\u0026#34;\u0026gt; \u0026lt;li class=\u0026#34;table-cell\u0026#34;\u0026gt;1\u0026lt;/li\u0026gt; \u0026lt;li class=\u0026#34;table-cell\u0026#34;\u0026gt;John\u0026lt;/li\u0026gt; \u0026lt;li class=\u0026#34;table-cell\u0026#34;\u0026gt;19\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;ul class=\u0026#34;table-row\u0026#34;\u0026gt; \u0026lt;li class=\u0026#34;table-cell\u0026#34;\u0026gt;2\u0026lt;/li\u0026gt; \u0026lt;li class=\u0026#34;table-cell\u0026#34;\u0026gt;Mark\u0026lt;/li\u0026gt; \u0026lt;li class=\u0026#34;table-cell\u0026#34;\u0026gt;21\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;ul class=\u0026#34;table-row\u0026#34;\u0026gt; \u0026lt;li class=\u0026#34;table-cell\u0026#34;\u0026gt;3\u0026lt;/li\u0026gt; \u0026lt;li class=\u0026#34;table-cell\u0026#34;\u0026gt;Kate\u0026lt;/li\u0026gt; \u0026lt;li class=\u0026#34;table-cell\u0026#34;\u0026gt;26\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; åºå· å§“å å¹´é¾„ 1 John 19 2 Mark 21 3 Kate 26 ç”Ÿæˆ emmet è¯­æ³•ä¹Ÿå³é€šè¿‡ç±»ä¼¼ CSS é€‰æ‹©å™¨çš„è¯­æ³•ï¼Œåœ¨ç¼–è¯‘å™¨ä¸­è‡ªåŠ¨ç”Ÿæˆç›¸åº”çš„ä»£ç ã€‚\nè®°å¿† ç¤ºä¾‹ æ•ˆæœ æ ‡ç­¾å div \u0026lt;div\u0026gt;\u0026lt;/div\u0026gt; ç±»é€‰æ‹©å™¨ red \u0026lt;div class=\u0026quot;red\u0026quot;\u0026gt;\u0026lt;/div\u0026gt; idé€‰æ‹©å™¨ #one \u0026lt;div id=\u0026quot;one\u0026quot;\u0026gt;\u0026lt;/div\u0026gt; äº¤é›†é€‰æ‹©å™¨ p.red#one \u0026lt;p class=\u0026quot;red\u0026quot; id=\u0026quot;one\u0026quot;\u0026gt;\u0026lt;/p\u0026gt; å­ä»£é€‰æ‹©å™¨ ul\u0026gt;li \u0026lt;ul\u0026gt;\u0026lt;li\u0026gt;\u0026lt;/li\u0026gt;\u0026lt;/ul\u0026gt; å†…éƒ¨æ–‡æœ¬ ul\u0026gt;li(æˆ‘æ˜¯liçš„å†…å®¹) \u0026lt;ul\u0026gt;\u0026lt;li\u0026gt;æ˜¯1içš„å†…å®¹\u0026lt;/li\u0026gt;\u0026lt;/ul\u0026gt; åˆ›å»ºå¤šä¸ª ul\u0026gt;li*3 \u0026lt;ul\u0026gt;\u0026lt;li\u0026gt;\u0026lt;/lixli\u0026gt;\u0026lt;/li\u0026gt;xli\u0026gt;\u0026lt;/li\u0026gt;\u0026lt;/ul\u0026gt; \u0026lt;!-- ç”Ÿæˆ div å¸¦ç±»å --\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;div.box\u0026lt;/div\u0026gt; \u0026lt;p class=\u0026#34;box\u0026#34;\u0026gt;p.box\u0026lt;/p\u0026gt; \u0026lt;div id=\u0026#34;box\u0026#34;\u0026gt;div#box\u0026lt;/div\u0026gt; \u0026lt;p id=\u0026#34;bo\u0026#34;\u0026gt;p#bo\u0026lt;/p\u0026gt; \u0026lt;p class=\u0026#34;red\u0026#34; id=\u0026#34;one\u0026#34;\u0026gt;p.red#one\u0026lt;/p\u0026gt; \u0026lt;!-- div åŒçº§ p --\u0026gt; div+p \u0026lt;div\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;p\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;!-- çˆ¶å­ --\u0026gt; \u0026lt;div\u0026gt; \u0026lt;p\u0026gt;div\u0026gt;p\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;!-- ui ä¸­ æœ‰ä¸‰ä¸ª li --\u0026gt; ui\u0026gt;li*3 \u0026lt;ui\u0026gt; \u0026lt;li\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;/ui\u0026gt; \u0026lt;!-- ui ä¸­ æœ‰ä¸‰ä¸ª liï¼Œliä¸­æœ‰æ–‡å­— --\u0026gt; ui\u0026gt;li{111}*3 \u0026lt;ui\u0026gt; \u0026lt;li\u0026gt;111\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;111\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;111\u0026lt;/li\u0026gt; \u0026lt;/ui\u0026gt; \u0026lt;!-- ui ä¸­ æœ‰ä¸‰ä¸ª liï¼Œliä¸­æœ‰æ–‡å­—1, 2, 3 --\u0026gt; ui\u0026gt;li{$}*3 \u0026lt;ui\u0026gt; \u0026lt;li\u0026gt;1\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;2\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;3\u0026lt;/li\u0026gt; \u0026lt;/ui\u0026gt; æ ·å¼è¾“å…¥ï¼šå•è¯çš„é¦–å­—æ¯\nfw -\u0026gt; font-weight fw700 -\u0026gt; font-weight: 700 fs -\u0026gt; font-style bgc -\u0026gt; background-color ç›’å­ æµè§ˆå™¨åœ¨ æ¸²æŸ“ é¡µé¢æ—¶ï¼Œä¼šå°†å…ƒç´ çœ‹ä½œæ˜¯ä¸€ä¸ªä¸ªçš„ çŸ©å½¢åŒºåŸŸ ï¼›æ¯ä¸€ä¸ª æ ‡ç­¾ ï¼Œéƒ½å¯çœ‹ä½œæ˜¯ä¸€ä¸ª ç›’å­ ï¼Œè¿™å°±æ˜¯ ç›’å­æ¨¡å‹ ã€‚\nCSS ä¸­è§„å®šæ¯ä¸ªç›’å­ç”±ä»¥ä¸‹å…ƒç´ æ„æˆï¼šå†…å®¹åŒºåŸŸ(content) å†…è¾¹è·åŒºåŸŸ(padding) è¾¹æ¡†åŒºåŸŸ(border) å¤–è¾¹è·åŒºåŸŸ(margin) div { width: 100px;height: 100px; background-color: pink; /* è¾¹æ¡†çº¿ */ border: 1px solid; /* å†…è¾¹è· */ padding: 20px; /* å¤–è¾¹è· */ margin: 50px; } å¤–è¾¹è·åŒºåŸŸ(margin) è¾¹æ¡†åŒºåŸŸ(border) å†…è¾¹è·åŒºåŸŸ(padding) å†…å®¹åŒºåŸŸ(content) æ–‡æ¡£æµ\u0010\u0010\u0010\u0010\u0010 Normal flow\nä»ä¸Šåˆ°ä¸‹ï¼Œä»å·¦åˆ°å³ï¼Œè¾“å‡ºæ–‡æ¡£å†…å®¹\nç”± å—çº§å…ƒç´  å’Œ è¡Œå†…å…ƒç´  ç»„æˆ\nå®šä½æœºåˆ¶åŒ…æ‹¬ï¼šé™æ€ æµ®åŠ¨ ç»å¯¹å®šä½\npositionï¼šstatic relative absolute fixed -webkit-sticky\nposition:absolute;top:120px \u0026lt;!-- æ ¹æ®å¤–å±‚å…ƒç´ ä½ç½®å®šä½ --\u0026gt; position:float; \u0026lt;!-- æ ¹æ®å¤–å±‚å…ƒç´ ä½ç½®å®šä½ --\u0026gt; å—çº§å…ƒç´  display: block; often\nä»å·¦åˆ°å³æ’‘æ»¡é¡µé¢ï¼Œç‹¬å ä¸€è¡Œ\nå®½åº¦é»˜è®¤ä¸º çˆ¶å…ƒç´  çš„å®½åº¦ï¼Œé«˜åº¦é»˜è®¤ç”± å†…å®¹ æ’‘å¼€\nè§¦ç¢°åˆ° é¡µé¢è¾¹ç¼˜ æ—¶ï¼Œä¼šè‡ªåŠ¨æ¢è¡Œ\nå¦‚ï¼šdiv p h ul li dl dd dt form header nav footer \u0026hellip;\n\u0026lt;div\u0026gt;: The Content Division element\næ–‡å­—ç±»çš„å…ƒç´ ï¼š p h* ä¹‹ç±»çš„å…ƒç´ å†…éƒ¨ä¸èƒ½æ”¾å—çº§å…ƒç´ ï¼Œä¼šè¢«æµè§ˆå™¨å¼ºè¡Œåˆ‡å¼€\n\u0026lt;!-- å—ï¼šç‹¬å ä¸€è¡Œï¼›å®½åº¦é»˜è®¤æ˜¯çˆ¶çº§å®½åº¦çš„100%ï¼›æ·»åŠ å®½é«˜éƒ½ç”Ÿæ•ˆ-\u0026gt; \u0026lt;style\u0026gt; div { width: 10vw; height: 10vh; background-color: deeppink; } \u0026lt;/style\u0026gt; \u0026lt;div\u0026gt;111\u0026lt;/div\u0026gt; \u0026lt;div\u0026gt;222\u0026lt;/div\u0026gt; \u0026lt;div\u0026gt; \u0026lt;p\u0026gt; \u0026lt;h\u0026gt; æ°´å¹³å±…ä¸­æ–¹æ³•ï¼š\nmargin: 0 auto **Note:** å¯¹äºæ­¤ç±»ç›’å­æ¨¡å‹æ°´å¹³å±…ä¸­ï¼Œç›´æ¥ç»™ **å½“å‰å…ƒç´ ** æœ¬èº«è®¾ç½®å³å¯ã€‚è¯¥é€‰é¡¹é’ˆå¯¹ **å›ºå®šå®½åº¦** çš„ç›’å­ï¼Œå¦‚æœå¤§ç›’å­æ²¡æœ‰è®¾ç½®å®½åº¦ï¼Œæ­¤æ—¶ä¼šé»˜è®¤å æ»¡ **çˆ¶å…ƒç´ ** çš„å®½åº¦ã€‚ \u0026lt;div\u0026gt; \u0026lt;div style=\u0026#34;width: 10em; height: 2.5em; background-image: linear-gradient(-20deg, #f794a4 0%, #fdd6bd 100%);\u0026#34;\u0026gt;111 \u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;width: 10em; height: 2.5em; background-image: linear-gradient(-20deg, #f794a4 0%, #fdd6bd 100%);\u0026#34;\u0026gt;222 \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; #### è¡Œå†…å…ƒç´  \u0026lt;kbd\u0026gt;display: inline;\u0026lt;/kbd\u0026gt; seldom 1. ä¸ä¼šå æ®æ•´è¡Œï¼Œåœ¨ä¸€æ¡ç›´çº¿ä¸Šæ’åˆ— - **å®½åº¦** \u0026amp; **é«˜åº¦** é»˜è®¤ç”±å†…å®¹æ’‘å¼€ - ç›’æ¨¡å‹å±æ€§ä¸­ï¼Œæ— æ³•ä¿®æ”¹ \u0026lt;kbd\u0026gt;**width**\u0026lt;/kbd\u0026gt; \u0026lt;kbd\u0026gt;**height**\u0026lt;/kbd\u0026gt; \u0026lt;kbd\u0026gt;margin\u0026lt;/kbd\u0026gt; \u0026lt;kbd\u0026gt;padding\u0026lt;/kbd\u0026gt; ï¼Œä½†å¯ä»¥è®¾ç½® \u0026lt;kbd\u0026gt;line-height\u0026lt;/kbd\u0026gt; - è®¾ç½®è¡Œé«˜åå†…éƒ¨æ–‡å­—å°†è‡ªåŠ¨å‚ç›´å±…ä¸­ - å¯ä»¥åˆ©ç”¨çˆ¶å…ƒç´ è®¾ç½®è¡Œé«˜ï¼Œè®©å­å…ƒç´  **ç»§æ‰¿** çš„æ–¹å¼å®ç°æ‰€æœ‰çš„å­å…ƒç´ å‚ç›´å±…ä¸­å¯¹é½ - å¦‚ï¼š\u0026lt;kbd\u0026gt;span\u0026lt;/kbd\u0026gt; \u0026lt;kbd\u0026gt;strong\u0026lt;/kbd\u0026gt; \u0026lt;kbd\u0026gt;input\u0026lt;/kbd\u0026gt; \u0026lt;kbd\u0026gt;img\u0026lt;/kbd\u0026gt; ... 2. \\\u0026lt;span\\\u0026gt;: The Content **Span** element 3. **NOTE:** \u0026lt;kbd\u0026gt;a\u0026lt;/kbd\u0026gt; æ ‡ç­¾ä¸èƒ½åµŒå¥—ï¼Œä½†å¯ä»¥æ”¾å—çº§å…ƒç´  ```html \u0026lt;style\u0026gt; /* è¡Œå†…ï¼šä¸æ¢è¡Œï¼Œè®¾ç½®å®½é«˜ä¸ç”Ÿæ•ˆï¼›å°ºå¯¸å’Œå†…å®¹å¤§å°ä¸€è‡´ */ span { /*w10em+h10em+bgc*/ width: 10em; height: 10em; background-color: deeppink; } \u0026lt;/style\u0026gt; \u0026lt;span\u0026gt;001\u0026lt;/span\u0026gt; \u0026lt;span\u0026gt;002\u0026lt;/span\u0026gt; 001 002 è¡Œå†…å—å…ƒç´  display: inline-block; often\nä¸ä¼šå æ®æ•´è¡Œï¼Œåœ¨ä¸€æ¡ç›´çº¿ä¸Šæ’åˆ—\nå¯ä»¥è®¾ç½® å®½åº¦ \u0026amp; é«˜åº¦\nå¦‚ï¼šinput textarea button select â€¦\nNote: \u0026lt;img\u0026gt; is a replaced element (whose representation is outside the scope of CSS); it has a display value of inline by default, but its default dimensions are defined by the embedded image\u0026rsquo;s intrinsic values, like it were inline-block.\n\u0026lt;style\u0026gt; /* è¡Œå†…å—ï¼šä¸€è¡Œæ˜¾ç¤ºå¤šä¸ªï¼›åŠ å®½é«˜ç”Ÿæ•ˆ */ img { width: 10vw;height: 10vh; } \u0026lt;/style\u0026gt; \u0026lt;img src=\u0026#34;portrait.svg\u0026#34; alt=\u0026#34;\u0026#34; srcset=\u0026#34;\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;portrait.svg\u0026#34; alt=\u0026#34;\u0026#34; srcset=\u0026#34;\u0026#34;\u0026gt; display: inline-block img img åµŒå¥—è§„èŒƒ å¤§ç›’å­ åŒ…è£¹ å°ç›’å­ï¼Œå—çº§å…ƒç´  åŒ…è£¹ è¡Œçº§å…ƒç´ ã€‚\nå—çº§å…ƒç´ ä¸€èˆ¬ä½œä¸ºå¤§å®¹å™¨ï¼Œå¯ä»¥åµŒå¥—ï¼šæ–‡æœ¬ã€å—çº§å…ƒç´ ã€è¡Œå†…å…ƒç´ ã€è¡Œå†…å—å…ƒç´ ç­‰\nNote: \u0026lt;p\u0026gt; æ ‡ç­¾ä¸­ä¸è¦åµŒå¥— \u0026lt;div\u0026gt; \u0026lt;p\u0026gt; \u0026lt;h\u0026gt; ç­‰å—çº§å…ƒç´ \n\u0026lt;!-- p å’Œ h æ ‡é¢˜ä¸èƒ½ç›¸äº’åµŒå¥— --\u0026gt; \u0026lt;p\u0026gt; \u0026lt;h1\u0026gt;ä¸€çº§æ ‡é¢˜\u0026lt;/h1\u0026gt; \u0026lt;/p\u0026gt; \u0026lt;!-- æµè§ˆå™¨è§£æä¼šå˜æˆ --\u0026gt; \u0026lt;p\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;h1\u0026gt;ä¸€çº§æ ‡é¢˜\u0026lt;/h1\u0026gt; \u0026lt;/p\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;a\u0026gt; æ ‡ç­¾å†…éƒ¨å¯ä»¥åµŒå¥—ä»»æ„å…ƒç´ \nNote: \u0026lt;a\u0026gt; æ ‡ç­¾ä¸èƒ½åµŒå¥— \u0026lt;a\u0026gt; æ ‡ç­¾ ç›’å­æ¨¡å‹ CSS3 å¯ä»¥é€šè¿‡ box-sizing æŒ‡å®šç›’æ¨¡å‹ï¼Œæœ‰ 2 ä¸ªå€¼å¯ä»¥æŒ‡å®š content-box border-box\nbox-sizing å¯ä»¥åˆ†æˆä¸¤ç§æƒ…å†µ:\ncontent-box ç›’å­å¤§å° width + padding + borderï¼ˆé»˜è®¤ï¼‰ border-box ç›’å­å¤§å° border ï¼›ä¸ä¼šè¢«æ’‘å¼€ç›’å­ box-sizing:content-box ç›’å­1 box-sizing:border-box ç›’å­2 æ ·å¼æ§åˆ¶ å®½ \u0026amp; é«˜ å±æ€§åï¼š width / height å±æ€§å€¼ï¼šæ•°å­— + å•ä½ ä½œç”¨ï¼šåˆ©ç”¨ width å’Œ heightå±æ€§é»˜è®¤è®¾ç½®æ˜¯ç›’å­ å†…å®¹åŒºåŸŸ çš„å¤§å° height è¾¹æ¡† å±æ€§åï¼šborder\nå±æ€§å€¼ï¼šå¤åˆå±æ€§ï¼Œå•ä¸ªå–å€¼çš„è¿å†™ï¼Œå–å€¼ä¹‹é—´ç”±ç©ºæ ¼åˆ†å¼€\nå¦‚ border: 10px dashed red\nsolid å®çº¿ dashed æŠ˜çº¿ dotted ç‚¹çº¿ double åŒå®çº¿\nä¸åˆ†å…ˆåé¡ºåº\nå¿«æ·é”®ï¼š bd + tab\nNote: border å¦‚æœä¸å†™è¾¹æ¡†æ ·å¼ï¼Œé»˜è®¤ä¸ºæ— è¾¹æ¡†ä¸æ˜¾ç¤º\nå¤§å°è®¡ç®—\néœ€æ±‚ï¼šç›’å­å¤§å° 40 Ã— 40 ï¼ŒèƒŒæ™¯ç»¿è‰²ï¼Œè¾¹æ¡† 3px å®çº¿ é»‘è‰²\nå…¬å¼ï¼š\n\u0026lt;style\u0026gt; div { --wh-size:40px; --bd-size:10px; width: calc( var(--wh-size) - var(--bd-size) * 2 ); height: calc( var(--wh-size) - var(--bd-size) * 2 ); border: var(--bd-size) solid black; } \u0026lt;/style\u0026gt; \u0026lt;div\u0026gt;\u0026lt;/div\u0026gt; æ•ˆæœï¼š\nå†…è¾¹è· å±æ€§åï¼špadding\nå±æ€§å€¼ï¼šæ•°å­— + å•ä½\nå¯ä½œä¸ºå¤åˆå±æ€§ï¼Œæœ€å¤šå››ä¸ªå•ä½\n4å€¼ï¼šä¸Š å³ ä¸‹ å·¦ï¼ˆé¡ºæ—¶é’ˆï¼‰ 3å€¼ï¼šä¸Š å·¦å³ ä¸‹ï¼ˆé¡ºæ—¶é’ˆ+æ²¡æœ‰äº†çœ‹å¯¹é¢ï¼‰ 2å€¼ï¼šä¸Šä¸‹ å·¦å³ 1å€¼ï¼šä¸Šä¸‹å·¦å³ padding å’Œå®½é«˜åˆ†å¼€è®¡ç®—\nborder padding éƒ½èƒ½æ’‘å¤§ç›’å­\nä½†æ˜¯å¦‚æœç›’å­æœ¬èº«æ²¡æœ‰æŒ‡å®š width / height å±æ€§ï¼Œæ­¤æ—¶ padding ä¸ä¼šæ’‘å¼€ç›’å­å¤§å°\nè‹¥ä¸è®¾ç½® width ï¼Œé»˜è®¤ä¼šæ‡‚è®¡ç®—åŠ ä¸Š padding çš„å®½åº¦æ˜¯ çˆ¶å…ƒç´  çš„å®½åº¦ï¼ˆtotal 100%ï¼‰ è§£å†³æ–¹æ³•ï¼šwidth å‡å»å¢åŠ çš„å·¦å³ padding å€¼\ncalc( 100% - var(--var-padding) * 2 ) pæ²¡æœ‰æŒ‡å®šå®½é«˜\nå¤–è¾¹è· å±æ€§åï¼šmargin\nå±æ€§å€¼ï¼šæ•°å­— + å•ä½\nå…¸å‹åº”ç”¨ï¼šå—çº§ç›’å­ æ°´å¹³å±…ä¸­æ˜¾ç¤ºï¼Œä½†éœ€æ»¡è¶³ï¼š\nç›’å­å¿…é¡»æŒ‡å®šäº†å®½åº¦ width\nç›’å­å·¦å³çš„ å¤–è¾¹è· éƒ½è®¾ç½®ä¸º auto\nä»¥ä¸‹ä¸‰ç§éƒ½å¯ä»¥ï¼š\nmargin-left:auto;margin-left:auto; margin: auto; margin: 0 auto; ç›’å­1 ç›’å­2 Note:\nå¯¹äºè¡Œå†…å…ƒç´  / è¡Œå†…å—å…ƒç´ ï¼Œç”±äºå…¶æ²¡æœ‰å®½åº¦ï¼Œå¯ä»¥ä¸ºå…¶çˆ¶å…ƒç´ æ·»åŠ text-align:centerå³å¯ã€‚ï¼ˆçœ‹ä½œæ˜¯æ™®é€šçš„æ–‡å­—ï¼‰ \u0026lt;span\u0026gt;é‡Œé¢çš„æ–‡å­—\u0026lt;/span\u0026gt; text-align: center ä½¿ç”¨ margin å®šä¹‰å—å…ƒç´ çš„å‚ç›´å¤–è¾¹è·æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°å¤–è¾¹è·çš„åˆå¹¶ã€‚ä¸»è¦æœ‰ä¸¤ç§ï¼š\nç›¸é‚»å—å…ƒç´  å‚ç›´å¤–è¾¹è·çš„ åˆå¹¶ å½“ä¸Šä¸‹ç›¸é‚»çš„ä¸¤ä¸ªå—å…ƒç´ ï¼ˆå…„å¼Ÿå…³ç³»ï¼‰ç›¸é‡æ—¶ï¼Œå¦‚æœä¸Šé¢çš„å…ƒç´ æœ‰ ä¸‹å¤–è¾¹è· margin-buttomï¼Œä¸‹é¢çš„å…ƒç´ æœ‰ ä¸Šå¤–è¾¹è· margin-top ï¼Œåˆ™ä»–ä»¬ ç›¸é‚» åï¼Œè¾¹è·ä¼šè‡ªåŠ¨å˜ä¸ºä¸¤è€…ä¹‹é—´çš„ æœ€å¤§å€¼\n$$ \\mathrm{ \\begin{cases} {\\small \\mathrm{margin{-}buttom:\\ 20px}} \\\\ {\\small \\mathrm{margin{-}top:\\ 10px }} \\end{cases} \\Rightarrow {\\normalsize {\\color[RGB]{221,7,7}new}\\ margin{-}top:\\ 20px } } $$ $$\\mathrm{{\\color[RGB]{221,7,7}new}\\ margin=\\max(margin\\ 1, margin\\ 2)}$$ è§£å†³æ–¹æ¡ˆï¼šå°½é‡åªä¸ºä¸€ä¸ªç›’å­æ·»åŠ  margin å€¼\n10px ç›’å­1 20px ç›’å­2 new:20px ç›’å­1 ç›’å­2 åµŒå¥—å—å…ƒç´  å‚ç›´å¤–è¾¹è·çš„ å¡Œé™·\nå¯¹äºä¸¤ä¸ª åµŒå¥—å…³ç³»ï¼ˆçˆ¶å­å…³ç³»ï¼‰çš„å—å…ƒç´ ï¼Œçˆ¶å…ƒç´ æœ‰ä¸Šè¾¹è·çš„åŒæ—¶å­å…ƒç´ ä¹Ÿæœ‰ä¸Šè¾¹è·ï¼Œæ­¤æ—¶çˆ¶å…ƒç´ çš„ å¡Œé™· ä¼šè‡ªåŠ¨å˜ä¸ºä¸¤è€…ä¸­çš„ æœ€å¤§å€¼\n$$ \\mathrm{ \\begin{cases} {\\small \\mathrm{margin{-}buttom:\\ 20px}} \\\\ {\\small \\mathrm{margin{-}top:\\ 10px }} \\end{cases} \\Rightarrow {\\normalsize {\\color[RGB]{221,7,7}new}\\ margin{-}top:\\ 20px } } $$ $$\\mathrm{{\\color[RGB]{221,7,7}new}\\ margin=\\max(margin\\ 1, margin\\ 2)}$$ è§£å†³æ–¹æ¡ˆ\nå¯ä»¥ä¸ºçˆ¶å…ƒç´ å®šä¹‰ ä¸Šè¾¹æ¡†\nborder:1px solid red å¯ä»¥ä¸ºçˆ¶å…ƒç´ å®šä¹‰ ä¸Šå†…è¾¹è·\nå¯ä»¥ä¸ºçˆ¶å…ƒç´ æ·»åŠ  æº¢å‡ºæ§åˆ¶\noverflow: hidden 10px ç›’å­1 20px ç›’å­2 new:20px ç›’å­1 ç›’å­2 æµ®åŠ¨ ã€å›ºå®š ã€ç»å¯¹å®šä½ çš„ç›’å­ä¸ä¼šæœ‰å¡Œé™·é—®é¢˜\næ¸…é™¤è¾¹è· éƒ¨åˆ†å…ƒç´ è‡ªå¸¦ å†…å¤–è¾¹è· ï¼Œè€Œä¸”ä¸åŒçš„æµè§ˆå™¨é»˜è®¤ä¹Ÿä¸ä¸€è‡´ã€‚å› æ­¤åœ¨å¸ƒå±€å‰ï¼Œéœ€è¦å…ˆæ¸…é™¤ç½‘é¡µå…ƒç´ çš„ å†…å¤–è¾¹è·ã€‚ï¼ˆå‚è§ CSSæ ¼å¼åŒ– ï¼‰\n* { margin: 0; /* æ¸…é™¤å†…è¾¹è· */ paddding: 0; /* æ¸…é™¤å¤–è¾¹è· */ } Note: è¡Œå†…å…ƒç´  ä¸ºäº†ç…§é¡¾å…¼å®¹æ€§ï¼Œå°½é‡åªè®¾ç½® å·¦å³å†…å¤–è¾¹è· ï¼Œä¸è¦è®¾ç½® ä¸Šä¸‹å†…å¤–è¾¹è· ã€‚ä½†æ˜¯è½¬æ¢ä¸º å—çº§ï½œè¡Œå†…å—å…ƒç´  å°±å¯ä»¥äº†ã€‚\nè£…é¥°æ§åˆ¶ åœ†è§’è¾¹æ¡† CSS3 ä¸­ æ–°å¢äº† åœ†è§’è¾¹æ¡† æ ·å¼ï¼Œè¿™æ ·ç›’å­å°±å˜æˆåœ†è§’äº†ã€‚\n/* border-radius ç”¨äºè®¾ç½®å…ƒç´ çš„å¤–è¾¹æ¡†åœ†è§’ */ border-radius: length; å‚æ•°å€¼å¯ä»¥æ˜¯ æ•°å€¼ æˆ–è€… ç™¾åˆ†æ¯” çš„å½¢å¼ã€‚\nç›’å­é˜´å½± box-shadow: h-shadow v-shadow blur spread color inset å€¼ æè¿° h-shadow å¿…é¡»ã€‚æ°´å¹³é˜´å½± çš„ä½ç½®ï¼Œå…è®¸è´Ÿå€¼ v-shadow å¿…é¡»ã€‚å‚ç›´é˜´å½± çš„ä½ç½®ï¼Œå…è®¸è´Ÿå€¼ blur å¯é€‰ã€‚æ¨¡ç³Šè·ç¦» spread å¯é€‰ã€‚é˜´å½±çš„å°ºå¯¸ color å¯é€‰ã€‚é˜´å½±çš„é¢œè‰² inset å¯é€‰ã€‚å°† å¤–éƒ¨é˜´å½± æ”¹ä¸º å†…éƒ¨é˜´å½± NOTE:\né»˜è®¤æ˜¯ å¤–é˜´å½± ï¼ˆoutsetï¼‰ã€‚ä½†æ˜¯ä¸å¯ä»¥å†™è¿™ä¸ªå•è¯ï¼Œå¦åˆ™å¯¼è‡´é˜´å½±æ— æ•ˆ ç›’å­é˜´å½± ä¸å ç”¨ç©ºé—´ ï¼Œä¸ä¼šå½±å“å…¶å®ƒç›’å­æ’åˆ—ã€‚ æ–‡å­—é˜´å½± text-shadow: h-shadow v-shadow blur color; å€¼ æè¿° h-shadow å¿…é¡»ã€‚æ°´å¹³é˜´å½± çš„ä½ç½®ï¼Œå…è®¸è´Ÿå€¼ v-shadow å¿…é¡»ã€‚å‚ç›´é˜´å½± çš„ä½ç½®ï¼Œå…è®¸è´Ÿå€¼ blur å¯é€‰ã€‚æ¨¡ç³Šè·ç¦» color å¯é€‰ã€‚é˜´å½±çš„é¢œè‰² è¿™æ˜¯æ–‡å­—é˜´å½± å¸ƒå±€ CSS æä¾›äº†ä¸‰ç§ä¼ ç»Ÿå¸ƒå±€çš„æ–¹å¼ï¼ˆç®€å•è¯´ï¼Œå°±æ˜¯ç›’å­å¦‚ä½•è¿›è¡Œæ’åˆ—é¡ºåºï¼‰\næ ‡å‡†æµï¼ˆæ™®é€šæµ/æ–‡æ¡£æµï¼‰ æµ®åŠ¨ å®šä½ è¿™ä¸‰ç§æ–¹å¼éƒ½æ˜¯ç”¨æ¥æ‘†æ”¾ç›’å­çš„ã€‚ç›’å­æ‘†æ”¾åˆ°åˆé€‚ä½ç½®ï¼Œå¸ƒå±€è‡ªç„¶å°±å®Œæˆäº†ã€‚å®é™…å¼€å‘ä¸­ï¼Œä¸€ä¸ªé¡µé¢åŸºæœ¬éƒ½åŒ…å«äº†è¿™ä¸‰ç§å¸ƒå±€æ–¹å¼ã€‚\nè€Œéšç€ç§»åŠ¨ç«¯çš„å‘å±•ã€ç°ä»£æµè§ˆå™¨çš„è¯ç”Ÿï¼Œ HTML5 å¼€å§‹æ”¯æŒ è¯­æ„åŒ–æ ‡ç­¾ ã€‚\nNOTE:\nè¿™ç§è¯­ä¹‰åŒ–çš„æ ‡å‡†æ˜¯é’ˆå¯¹ æœç´¢å¼•æ“ çš„ã€‚æœç´¢å¼•æ“å¯¹æ™®é€šçš„ div æ ‡ç­¾ä¸å‹å¥½ã€‚ IE9 ä¸­ï¼Œè¿™äº›æ–°å¢çš„å…ƒç´ ä¸æ˜¯ å—çº§å…ƒç´  ï¼Œæ‰€ä»¥éœ€è¦åœ¨åˆå§‹åŒ– CSS ä»£ç çš„æ—¶å€™ï¼Œå°†è¿™äº›å…ƒç´ è®¾ç½®ä¸ºå—çº§å…ƒç´  æµå¼å¸ƒå±€ æµå¼ å¸ƒå±€ï¼Œå°±æ˜¯ ç™¾åˆ†æ¯” å¸ƒå±€ï¼Œä¹Ÿç§°éå›ºå®šåƒç´ å¸ƒå±€ã€‚ é€šè¿‡ç›’å­çš„å®½åº¦è®¾ç½®æˆç™¾åˆ†æ¯”æ¥æ ¹æ® å±å¹•çš„å®½åº¦ æ¥è¿›è¡Œä¼¸ç¼©ï¼Œä¸å—å›ºå®šåƒç´ çš„é™åˆ¶ï¼Œå†…å®¹å‘ ä¸¤ä¾§ å¡«å……ã€‚æµå¼å¸ƒå±€æ–¹å¼æ˜¯ ç§»åŠ¨webå¼€å‘ ä½¿ç”¨çš„æ¯”è¾ƒå¸¸è§çš„å¸ƒå±€æ–¹å¼ã€‚\nè¡¨æ ¼å¸ƒå±€ï¼ˆç©ºï¼‰ åœ¨ CSS3 æ²¡å‡ºç°æ—¶\nFlexå¸ƒå±€ è§ flex éƒ¨åˆ†ã€‚\nRemå¸ƒå±€ rem å•ä½æ˜¯è·Ÿç€ HTML æ¥èµ°çš„ï¼Œæœ‰äº† rem é¡µé¢å…ƒç´ å¯ä»¥è®¾ç½®ä¸åŒçš„å°ºå¯¸ï¼›è€Œ åª’ä½“æŸ¥è¯¢ å¯ä»¥æ ¹æ® ä¸åŒè®¾å¤‡å®½åº¦ æ¥ä¿®æ”¹æ ·å¼ã€‚äºŒè€…ç»“åˆå³å¯å®ç°ä¸åŒè®¾å¤‡å®½åº¦ä¸‹å…ƒç´ å¤§å°çš„åŠ¨æ€å˜åŒ–ã€‚\nè®©ä¸€äº›ä¸èƒ½ç­‰æ¯”ä¾‹è‡ªé€‚åº”çš„å…ƒç´ ï¼Œå½“è®¾å¤‡å°ºå¯¸å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œ ç­‰æ¯”ä¾‹ é€‚é…å½“å‰è®¾å¤‡ ä½¿ç”¨ åª’ä½“æŸ¥è¯¢ æ ¹æ®ä¸åŒè®¾å¤‡æŒ‰æ¯”ä¾‹è®¾ç½® HTML çš„å­—ä½“å¤§å°ï¼Œç„¶åé¡µé¢å…ƒç´ ä½¿ç”¨ rem åšå°ºå¯¸å•ä½ã€‚å½“ HTML å­—ä½“å¤§å°å˜åŒ–æ—¶å…ƒç´ å°ºå¯¸ä¹Ÿå°†å‘ç”Ÿå˜åŒ–ï¼Œä»è€Œè¾¾åˆ°ç­‰æ¯”ä¾‹ç¼©æ”¾çš„é€‚é… åœ¨ VSCode è®¾ç½®é‡Œæœç´¢ CSSRoot å³å¯æŠŠ px è½¬æ¢ä¸º remï¼ˆè®¾ä¸º 75pxï¼‰\nWebStrom å¯ä»¥ä½¿ç”¨ px2remæ’ä»¶ æŠ€æœ¯å®ç°ï¼š\næ–¹æ¡ˆ1ï¼šrem + åª’ä½“æŸ¥è¯¢ + LESS\nè®¾è®¡ç¨¿å¸¸è§å°ºå¯¸å®½åº¦ è®¾å¤‡ å¸¸è§å®½åº¦ iPhone 4 5 640px iPhone 6 7 8 750px Android å¸¸è§ï¼š320px 360px 375px 384px 400px 414px 500px 720pxï¼›å¤§éƒ¨åˆ†4.7~5å¯¸çš„å®‰å“è®¾å¤‡ä¸º720px ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä»¥ä¸€å¥—æˆ–ä¸¤å¥—æ•ˆæœå›¾é€‚åº”å¤§éƒ¨åˆ†çš„å±å¹•ï¼Œæ”¾å¼ƒ æç«¯å± æˆ–å¯¹å…¶ ä¼˜é›…é™çº§ ï¼Œç‰ºç‰²ä¸€äº›æ•ˆæœã€‚ç°åœ¨å±å¹•å®½åº¦åŸºæœ¬ä»¥ 750px ä¸ºå‡†ã€‚\nåŠ¨æ€é€‚é… HTML æ ‡ç­¾ font-size å¤§å° e.g.: å‡è®¾è®¾è®¡ç¨¿æ˜¯ 750px æŠŠæ•´ä¸ªå±å¹•åˆ’åˆ†ä¸º15ç­‰ä»½ **éš¾ç‚¹ï¼š**å¦‚ä½•åˆ’åˆ†ä¸º 15 ç­‰ä»½ï¼Ÿ åˆ’åˆ†æ ‡å‡†ä¸ä¸€ï¼ˆå¯ä»¥æ˜¯20ä»½ä¹Ÿå¯ä»¥æ˜¯10ç­‰ä»½ï¼‰ æ¯ä¸€ä»½ä½œä¸º HTML å­—ä½“å¤§å°ï¼Œè¿™é‡Œå°±æ˜¯ 50px åœ¨ 320px å®½åº¦è®¾å¤‡ä¸‹ å­—ä½“å¤§å°ä¸º 320 Ã· 15 å°±æ˜¯ 21.33px ç”¨æˆ‘ä»¬é¡µé¢å…ƒç´ çš„å¤§å°é™¤ä»¥ä¸åŒçš„ HTML å­—ä½“å¤§å°ï¼Œä¼šå‘ç°ä»–ä»¬æ¯”ä¾‹è¿˜æ˜¯ç›¸åŒçš„ æ¯”å¦‚æˆ‘ä»¬ä»¥ 750px ä¸ºæ ‡å‡†è®¾è®¡ç¨¿ ä¸€ä¸ª 100 Ã— 100çš„é¡µé¢å…ƒç´ åœ¨ 750px å±å¹•ä¸‹ å°±æ˜¯100 Ã· (750px Ã· 15ä»½) = 2ä»½ âˆ¨ 2rem è½¬æ¢ä¸º rem â†’ 2rem Ã— 2rem â†’ æ¯”ä¾‹ 1: 1 å å±å¹•å®½åº¦ä¸º $$\\frac{2}{15}$$ 320px å±å¹•ä¸‹ï¼ŒHTML å­—ä½“å¤§å°ä¸º 21.33px 2rem = 42.66px æ­¤æ—¶å®½å’Œé«˜éƒ½æ˜¯ 42.66px ï¼Œæ¯”ä¾‹è¿˜æ˜¯1: 1 å å±å¹•å®½åº¦ä»ç„¶æ˜¯ $$\\frac{2}{15}$$ å¦‚æ­¤å³å¯å®ç°ä¸åŒå±å¹•ä¸‹é¡µé¢å…ƒç´ ç›’å­ç­‰æ¯”ä¾‹ç¼©æ”¾ @media screen and (min-width: 320px) { html { font-size: 21.33px; } } @media screen and (min-width: 750px) { html { font-size: 50px; } } å…ƒç´ å¤§å°å–å€¼æ–¹æ³• âˆµ $$å±å¹•å®½åº¦/åˆ’åˆ†çš„ä»½æ•°$$ å°±æ˜¯ HTML font-size å¤§å° âˆ´ $$rem=\\frac{é¡µé¢å…ƒç´ å€¼{\\ }px}{å±å¹•å®½åº¦/åˆ’åˆ†çš„ä»½æ•°}$$ âˆ¨ $$rem=\\frac{é¡µé¢å…ƒç´ å€¼{\\ }px}{html\\ font-size\\ å­—ä½“å¤§å°}$$ å½“æ ·å¼æ¯”è¾ƒç¹å¤šçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥é’ˆå¯¹ä¸åŒçš„åª’ä½“ä½¿ç”¨ä¸åŒ æ ·å¼è¡¨ ã€‚åŸç†å°±æ˜¯ç›´æ¥åœ¨ link ä¸­åˆ¤æ–­è®¾å¤‡çš„å°ºå¯¸ï¼Œç„¶åå¼•ç”¨ä¸åŒçš„ CSS æ–‡ä»¶ã€‚\n/* å½“å±å¹•å¤§äº640pxï¼Œæˆ‘ä»¬è®©divä¸€è¡Œæ˜¾ç¤º2ä¸ª */ /* å½“å±å¹•å°äº640pxï¼Œæˆ‘ä»¬è®©divä¸€è¡Œæ˜¾ç¤º1ä¸ª */ /* ä¸€èˆ¬åª’ä½“æŸ¥è¯¢æœ€å¥½çš„æ–¹æ³•æ˜¯ä»å°åˆ°å¤§ */ \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;style320.css\u0026#34; media=\u0026#34;screen and (min-width: 320px)\u0026#34;\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;style640.css\u0026#34; media=\u0026#34;screen and (min-width: 640px)\u0026#34;\u0026gt; /* å¼•å…¥èµ„æºå°±æ˜¯é’ˆå¯¹äºä¸åŒçš„å°ºå¯¸è°ƒç”¨ä¸åŒçš„CSSæ–‡ä»¶ */ /* style320.css */ div{ width: 100%; height: 100px } /* style640.css */ div{ width: 50%; height: 100px } æ–¹æ¡ˆ2ï¼šflexible.js + rem\næ‰‹æœºæ·˜å®å›¢é˜Ÿå‡ºå“çš„ç®€æ´é«˜æ•ˆç§»åŠ¨ç«¯é€‚é…åº“\næŠŠå½“å‰è®¾å¤‡å®½åº¦åˆ’åˆ†ä¸º10 ç­‰ä»½ï¼Œåœ¨ä¸åŒè®¾å¤‡ä¸‹æ¯”ä¾‹ä»ç„¶ä¸€è‡´ æ¯”å¦‚å½“å‰è®¾è®¡ç¨¿æ˜¯ 750px åªéœ€è¦æŠŠ HTML æ–‡å­—å¤§å°è®¾ç½®ä¸º 75pxï¼ˆ$$\\frac{750px}{10}$$ï¼‰ $$rem=\\frac{é¡µé¢å…ƒç´ å€¼{\\ }px}{75}$$ $$1rem$$ å³ä¸ºé¡µé¢å®½åº¦çš„ $$\\frac{1}{10}$$ å‰©ä½™çš„ç”± flexible.js è®¡ç®— Github åœ°å€ï¼šhttps://github.com/amfe/lib-flexible\nNOTE: ç”±äºviewportå•ä½å¾—åˆ°ä¼—å¤šæµè§ˆå™¨çš„å…¼å®¹ï¼Œlib-flexibleè¿™ä¸ªè¿‡æ¸¡æ–¹æ¡ˆå·²ç»å¯ä»¥æ”¾å¼ƒä½¿ç”¨ï¼Œä¸ç®¡æ˜¯ç°åœ¨çš„ç‰ˆæœ¬è¿˜æ˜¯ä»¥å‰çš„ç‰ˆæœ¬ï¼Œéƒ½å­˜æœ‰ä¸€å®šçš„é—®é¢˜ã€‚å»ºè®®å¤§å®¶å¼€å§‹ä½¿ç”¨viewportæ¥æ›¿ä»£æ­¤æ–¹ã€‚\n1vh will be 1% of the height of the document 1vw will be 1% of the width of the document ç°åœ¨åªéœ€ä¸€è¡Œ html { font-size: 10vw; } å³å¯å°†é¡µé¢åˆ’åˆ†ä¸º 10 ç­‰ä»½ã€‚\nå“åº”å¼å¸ƒå±€ PCç«¯ å’Œ ç§»åŠ¨ç«¯ åªéœ€è®¾è®¡ä¸€ä¸ªé¡µé¢å³å¯ã€‚\nè®¾å¤‡åˆ’åˆ† å°ºå¯¸åŒºé—´ åˆ’åˆ† è¶…å°å±å¹•ï¼ˆæ‰‹æœºï¼‰ \u0026lt; 768px 100% å°å±è®¾å¤‡ï¼ˆå¹³æ¿ï¼‰ â‰¥ 768px â‡† \u0026lt; 992px 750px ä¸­ç­‰å±å¹•ï¼ˆæ¡Œé¢æ˜¾ç¤ºå™¨ï¼‰ â‰¥ 992px â‡† \u0026lt;1200px 970px å®½å±è®¾å¤‡ï¼ˆå¤§æ¡Œé¢æ˜¾ç¤ºå™¨ï¼‰ â‰¥ 1200px 1170px NOTE: å¯¹äº vw / vh å¸ƒå±€ï¼Œå½“å±å¹•å®½åº¦ä¸º 750px æ—¶ï¼Œé»˜è®¤ 16px çš„å­—ä½“å¯¹åº”äº $$\\frac{16px}{750/100}=2.1333$$ vwï¼Œå¯åœ¨ root è®¾ç½®ã€‚\nå“åº”å¼éœ€è¦ä¸€ä¸ª çˆ¶çº§ åšå¸ƒå±€å®¹å™¨ï¼Œæ¥é…åˆ å­çº§ å…ƒç´ çš„å˜åŒ–æ•ˆæœã€‚é€šè¿‡ åª’ä½“æŸ¥è¯¢ ä¿®æ”¹ å¸ƒå±€å®¹å™¨ å®½åº¦å®ç°ã€‚\n\u0026lt;style\u0026gt; /* è¶…å°å®¹å™¨ | Width \u0026lt; 768px | 100% */ @media screen and (min-width: 767px) .container{ width: 100% } } /* å°å±å¹• | 768px \u0026lt;= Width \u0026lt;= 992px | 750px */ @media screen and (min-width: 750px) .container{ width: 750px } } /* ä¸­ç­‰å±å¹• | 992px \u0026lt;= Width \u0026lt;= 1200px | 970px */ @media screen and (min-width: 992px) .container{ width: 970px } } /* å¤§å±å¹• | 1200px \u0026lt;= Width | 1170px */ @media screen and (min-width: 1200px) .container{ width: 1170px } } \u0026lt;/style\u0026gt; \u0026lt;!-- å“åº”å¼å¼€å‘é‡Œé¢ï¼Œé¦–å…ˆéœ€è¦ä¸€ä¸ªå¸ƒå±€å®¹å™¨ --\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; ... \u0026lt;/div\u0026gt; BootStrap Bootstrap æ¥è‡ª Twitter ï¼Œæ˜¯ç›®å‰æœ€å—æ¬¢è¿çš„å‰ç«¯æ¡†æ¶ã€‚Bootstrap åŸºäºHTML ã€ CSS å’Œ JavaScript ï¼Œç®€æ´çµæ´»ï¼Œä½¿å¾—Webå¼€å‘æ›´åŠ å¿«æ·ã€‚\nå®˜ç½‘ï¼šhttps://getbootstrap.com/\nä¸­æ–‡ç½‘å€ï¼šhttps://www.bootcss.com/\næ¡†æ¶ï¼šé¡¾åæ€ä¹‰å°±æ˜¯ä¸€å¥—æ¶æ„ï¼Œå®ƒæœ‰ä¸€å¥—æ¯”è¾ƒå®Œæ•´çš„ç½‘é¡µåŠŸèƒ½è§£å†³æ–¹æ¡ˆï¼Œè€Œä¸”æ§åˆ¶æƒåœ¨æ¡†æ¶æœ¬èº«ï¼Œæœ‰é¢„åˆ¶æ ·å¼åº“ã€ç»„ä»¶å’Œæ’ä»¶ã€‚ä½¿ç”¨è€…è¦æŒ‰ç…§æ¡†æ¶æ‰€è§„å®šçš„æŸç§è§„èŒƒè¿›è¡Œå¼€å‘ã€‚\nä¼˜ç‚¹ï¼š\næ ‡å‡†åŒ–çš„ HTML + CSS ç¼–ç è§„èŒƒ æä¾›äº†ä¸€å¥—ç®€æ´ç›´è§‚ã€å¼ºæ‚çš„ç»„ä»¶ æœ‰è‡ªå·±çš„ç”Ÿæ€åœˆï¼Œä¸æ–­çš„æ›´æ–°é€‰ä»£ï¼Œè®©å¼€å‘æ›´ç®€å•ï¼Œæé«˜äº†å¼€å‘çš„æ•ˆç‡ ä½¿ç”¨ï¼š\nåˆ›å»ºæ–‡ä»¶å¤¹ç»“æ„ åˆ›å»º HTML éª¨æ¶ç»“æ„ \u0026lt;!--è¦æ±‚å½“å‰ç½‘é¡µä½¿ç”¨IEæµè§ˆå™¨æœ€é«˜ç‰ˆæœ¬çš„å†…æ ¸æ¥æ¸²æŸ“--\u0026gt; \u0026lt;meta http-equiv=\u0026#34;X-UA-Compatible\u0026#34; content=\u0026#34;IE=edge\u0026#34;\u0026gt; \u0026lt;!--è§†å£çš„è®¾ç½®:è§†å£çš„å®½åº¦å’Œè®¾å¤‡ä¸€è‡´,é»˜è®¤çš„ç¼©æ”¾æ¯”ä¾‹å’ŒPCç«¯ä¸€è‡´,ç”¨æˆ·ä¸èƒ½è‡ªè¡Œç¼©æ”¾--\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1, user-scalable=0\u0026#34;\u0026gt; \u0026lt;!--[if lt IE 9]\u0026gt; \u0026lt;!--è§£å†³ie9ä»¥ä¸‹æµè§ˆå™¨å¯¹html5æ–°å¢æ ‡ç­¾çš„ä¸è¯†åˆ«,å¹¶å¯¼è‡´CSSä¸èµ·ä½œç”¨çš„é—®é¢˜--\u0026gt; \u0026lt;script src=\u0026#34;https://oss.maxcdn.com/htm15shiv/3.7.2/htm15shiv.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;!--è§£å†³ie9ä»¥ä¸‹æµè§ˆå™¨å¯¹css3 Media Queryçš„ä¸è¯†åˆ«--\u0026gt; \u0026lt;script src=\u0026#34;https://oss.maxcdn.com/respond/1.4.2/respond.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;![endif]--\u0026gt; å¼•å…¥ç›¸å…³æ ·å¼æ–‡ä»¶ \u0026lt;!-- Bootstrapæ ¸å¿ƒæ ·å¼--\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;bootstrap/css/bootstrap.min.css\u0026#34;\u0026gt; ä¹¦å†™å†…å®¹ NOTE: BootStrap è‡ªå¸¦ normalize.css ï¼Œæ— éœ€å†æ¬¡å¯¹ CSS è¿›è¡Œåˆå§‹åŒ–ã€‚\nå¸ƒå±€å®¹å™¨ Bootstrap éœ€è¦ä¸ºé¡µé¢å†…å®¹å’Œæ …æ ¼ç³»ç»ŸåŒ…è£¹ä¸€ä¸ª .container å®¹å™¨ï¼Œ Bootstarp é¢„å…ˆå®šä¹‰å¥½äº†è¿™ä¸ªç±»ï¼Œå« .container ï¼Œå®ƒæä¾›äº†ä¸¤ä¸ªä½œæ­¤ç”¨å¤„çš„ç±»ã€‚\n.container-fluid ï¼šæµå¼å¸ƒå±€ï¼ŒæŠŠå±å¹•ä»¥ç™¾åˆ†æ¯”å¸ƒå±€åˆ’åˆ†ï¼Œæ˜¯å æ®å…¨éƒ¨è§†å£ viewpoint çš„å®¹å™¨ï¼Œé€‚ç”¨äºç§»åŠ¨ç«¯å¼€å‘ã€‚\næ …æ ¼ç³»ç»Ÿ æ …æ ¼ç³»ç»Ÿ è‹±æ–‡ä¸º gridsystems ï¼Œä¹Ÿæœ‰äººç¿»è¯‘ä¸º ç½‘æ ¼ç³»ç»Ÿ ã€‚å®ƒæ˜¯æŒ‡å°†é¡µé¢å¸ƒå±€åˆ’åˆ†ä¸º ç­‰å®½çš„åˆ—ï¼Œç„¶åé€šè¿‡åˆ—æ•°çš„å®šä¹‰æ¥æ¨¡å—åŒ–é¡µé¢å¸ƒå±€ã€‚ Bootstrap æä¾›äº†ä¸€å¥—å“åº”å¼ã€ç§»åŠ¨è®¾å¤‡ä¼˜å…ˆçš„æµå¼æ …æ ¼ç³»ç»Ÿï¼Œéšç€å±å¹•æˆ–è§†å£ viewport å°ºå¯¸çš„å¢åŠ ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ†ä¸ºæœ€å¤š 12 åˆ—ã€‚\nè®©æˆ‘ä»¬æ¥äº²è‡ªå®ç°ä¸€ä¸ªæ …æ ¼åŒ–ç³»ç»Ÿï¼Œå‡è®¾æˆ‘ä»¬è¦å°†ä¸€è¡Œåˆ’åˆ†ä¸º 12 ç­‰åˆ†ï¼Œé‚£ 1 ç­‰åˆ†å°±å æœ‰ $$\\frac{100\\%}{12}=8.33\\%$$ çš„å®½åº¦ã€‚\nç›¸åº”çš„ CSS å¯ä»¥è¿™æ ·è®¾ç½®ï¼š\n\u0026lt;!-- éœ€æ±‚ï¼šåœ¨ PC ä¸Šï¼Œå› ä¸ºå±å¹•æ¯”è¾ƒå¤§ï¼Œæˆ‘ä»¬è¦æ±‚ä¸€è¡Œæ˜¾ç¤º 4 åˆ—çš„å†…å®¹ã€‚ä½†æ˜¯åœ¨æ‰‹æœºä¸Šï¼Œå› ä¸ºå±å¹•æ¯”è¾ƒå°ï¼Œè¦æ±‚ä¸€è¡Œæ˜¾ç¤º 3 åˆ—çš„å†…å®¹ã€‚ å³ä¸€ä¸ªç½‘ç«™åŒæ—¶é€‚é… PC å’Œæ‰‹æœºç«¯ï¼Œæ ¹æ®ä¸åŒçš„ç«¯è‡ªåŠ¨è°ƒæ•´é¡µé¢ã€‚ --\u0026gt; \u0026lt;style\u0026gt; /* é€šè¿‡ç™¾åˆ†æ¯”å¸ƒå±€æ¥è¿›è¡Œæ§åˆ¶ */ /* å±å¹•åˆ†è¾¨ç‡å¤§äºç­‰äº1200px */ @media (min-width: 1200px) { .col-md1 {width: 8.33%} .col-md2 {width: 16.66%} .col-md3 {width: 25%} .col-md4 {width: 33.33%} .col-md5 {width: 41.66%} .col-md6 {width: 50%} .col-md7 {width: 58.33%} .col-md8 {width: 66.66%} .col-md9 {width: 75%} .col-md10 {width: 83.33%} .col-md11 {width: 91.66%} .col-md12 {width: 100%} } /* é’ˆå¯¹å±å¹•åˆ†è¾¨ç‡å°äº1200pxçš„ */ @media (max-width: 1199px) { .col-sm1 {width: 8.33%} .col-sm2 {width: 16.66%} .col-sm3 {width: 25%} .col-sm4 {width: 33.33%} .col-sm5 {width: 41.66%} .col-sm6 {width: 50%} .col-sm7 {width: 58.33%} .col-sm8 {width: 66.66%} .col-sm9 {width: 75%} .col-sm10 {width: 83.33%} .col-sm11 {width: 91.66%} .col-sm12 {width: 100%} } \u0026lt;/style\u0026gt; \u0026lt;!-- å¦‚æœå­©å­çš„ä»½æ•°ç›¸åŠ å°äº12 åˆ™å ä¸æ»¡æ•´ä¸ªcontainerå®½åº¦ --\u0026gt; \u0026lt;!-- å¦‚æœå­©å­çš„ä»½æ•°ç›¸åŠ ç­‰äº12 åˆ™èƒ½å æ»¡æ•´ä¸ªcontainerå®½åº¦ --\u0026gt; \u0026lt;!-- å¦‚æœå­©å­çš„ä»½æ•°ç›¸åŠ å¤§äº12 åˆ™å¤šä½™çš„éƒ¨åˆ†å°†ä¼šå¦èµ·ä¸€è¡Œ --\u0026gt; \u0026lt;div class=\u0026#34;row\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;col-md3 col-sm4\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;col-md3 col-sm4\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;col-md3 col-sm4\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;col-md3 col-sm4\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; ä¸€ä¸ª DIVï¼ŒåŒæ—¶è®¾ç½®ä¸¤ä¸ªç±»åã€‚å½“å±å¹• â‰¥ 1200px æ—¶ï¼Œä¸€è¡Œæ˜¾ç¤º 4 åˆ—ï¼Œå½“å±å¹• \u0026lt;1200px æ—¶ï¼Œä¸€è¡Œæ˜¾ç¤º 3 åˆ—ï¼Œè€Œä¸”æ˜¯æµè§ˆå™¨æ ¹æ® åª’ä½“æŸ¥è¯¢ è‡ªåŠ¨è°ƒæ•´ã€‚\nwidth: \u0026lt; 1200px3 col/row block block block width: â‰¥ 1200px4 col/row block block block block é€‰é¡¹å‚æ•° æ …æ ¼ç³»ç»Ÿç”¨äºé€šè¿‡ä¸€ç³»åˆ—çš„ è¡Œ(row) ä¸ åˆ—(column) çš„ç»„åˆæ¥åˆ›å»ºé¡µé¢å¸ƒå±€ï¼Œå†…å®¹å°±å¯ä»¥æ”¾å…¥è¿™äº›åˆ›å»ºå¥½çš„å¸ƒå±€ä¸­ã€‚\nè¶…å°å±å¹•ï¼ˆæ‰‹æœºï¼‰ å°å±è®¾å¤‡ï¼ˆå¹³æ¿ï¼‰ ä¸­ç­‰å±å¹•ï¼ˆæ¡Œé¢æ˜¾ç¤ºå™¨ï¼‰ å®½å±è®¾å¤‡ï¼ˆå¤§æ¡Œé¢æ˜¾ç¤ºå™¨ï¼‰ width range \u0026lt; 768px â‰¥ 768px â‰¥ 992px â‰¥ 1200px container 100% 750px 970px 1170px class prefix .col-xs- .col-sm- .col-md- .col-lg- col count 12 12 12 12 è¡Œ(row) å¿…é¡»æ”¾åˆ° container å¸ƒå±€å®¹å™¨é‡Œé¢ æˆ‘ä»¬å®ç°åˆ—çš„å¹³å‡åˆ’åˆ†éœ€è¦ç»™åˆ—æ·»åŠ  ç±»å‰ç¼€ xs-extra small ï¼šè¶…å° sm-smallï¼šå° md-mediumï¼šä¸­ç­‰ lg-large ï¼šå¤§ åˆ—(column)å¤§äº12ï¼Œå¤šä½™çš„åˆ—(column)æ‰€åœ¨çš„å…ƒç´ å°†è¢«ä½œä¸ºä¸€ä¸ªæ•´ä½“ å¦èµ·ä¸€è¡Œ æ’åˆ— æ¯ä¸€åˆ—é»˜è®¤æœ‰ 15px çš„ paddingï¼Œè€ŒåŠ ä¸Šè¡Œ(row)åˆ™å¯ä»¥å»é™¤ å¯ä»¥åŒæ—¶ä¸ºä¸€åˆ—æŒ‡å®šå¤šä¸ª è®¾å¤‡ çš„ç±»åï¼Œä»¥ä¾¿åˆ’åˆ†ä¸åŒä»½æ•°ä¾‹å¦‚ class=\u0026quot;col-md-4 col-sm-6\u0026quot; åˆ—åµŒå¥— æ …æ ¼ç³»ç»Ÿå†…ç½®çš„æ …æ ¼ç³»ç»Ÿå°†å†…å®¹å†æ¬¡åµŒå¥—ã€‚ç®€å•ç†è§£å°±æ˜¯ä¸€ä¸ªåˆ—å†…å†åˆ†æˆè‹¥å¹²ä»½å°åˆ—ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ ä¸€ä¸ªæ–°çš„ .row å…ƒç´ å’Œä¸€ç³»åˆ— .col-sm-* å…ƒç´ åˆ°å·²ç»å­˜åœ¨çš„ .col-sm-* å…ƒç´ å†…ã€‚\n\u0026lt;!-- åˆ—åµŒå¥—æœ€å¥½åŠ ä¸Š1ä¸ªè¡Œrow å¯ä»¥å–æ¶ˆçˆ¶å…ƒç´ çš„padding --\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;row\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;col-md-4\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;row\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;col-md-6\u0026#34;\u0026gt;a\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;col-md-6\u0026#34;\u0026gt;b\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;col-md-4\u0026#34;\u0026gt;2\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;col-md-4\u0026#34;\u0026gt;3\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; col nest 1 {1} {2} {3} 3 åˆ—åç§» ä½¿ç”¨ .col-md-offset-* ç±»å¯ä»¥å°†åˆ—å‘å³ä¾§åç§»ã€‚è¿™äº›ç±»å®é™…æ˜¯ç”¨ * é€‰æ‹©å™¨ä¸ºå½“å‰å…ƒç´ å¢åŠ äº†å·¦ä¾§çš„è¾¹è·ã€‚\n@media (min-width: 992px) { .col-md-offset-4 { margin-left: 33.333333333% } } åˆ—æ’åº .col-md-push-* .col-md-pull-* ç±»å¯ä»¥å¾ˆå®¹æ˜“æ”¹å˜åˆ—çš„é¡ºåºã€‚\ncol order å·¦ä¾§ å³ä¾§ å³ä¾§ å·¦ä¾§ \u0026lt;!-- å®ç°å·¦å³è°ƒæ¢åŸç† --\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;row\u0026gt; \u0026lt;div class=\u0026#34;col-md-4 col-md-push-8\u0026#34;\u0026gt;å·¦ä¾§\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;col-md-8 col-md-pull-4\u0026#34;\u0026gt;å³ä¾§\u0026lt;/div\u0026gt; \u0026lt;/row\u0026gt; \u0026lt;/div\u0026gt; å“åº”å¼å·¥å…· ä¸ºäº†åŠ å¿«å¯¹ç§»åŠ¨è®¾å¤‡å‹å¥½çš„é¡µé¢å¼€å‘å·¥ä½œï¼Œåˆ©ç”¨åª’ä½“æŸ¥è¯¢åŠŸèƒ½ï¼Œå¹¶ä½¿ç”¨è¿™äº›å·¥å…·ç±»å¯ä»¥æ–¹ä¾¿çš„é’ˆå¯¹ä¸åŒè®¾å¤‡å±•ç¤ºæˆ–éšè—é¡µé¢å†…å®¹ã€‚\nç±»å è¶…å°å± å°å± ä¸­å± å¤§å± .hidden-xs éšè— å¯è§ å¯è§ å¯è§ .hidden-sm å¯è§ éšè— å¯è§ å¯è§ .hidden-md å¯è§ å¯è§ éšè— å¯è§ .hidden-lg å¯è§ å¯è§ å¯è§ éšè— ä¸ä¹‹ç›¸åçš„ï¼Œæ˜¯ visible-xs visible-sm visible-md visible-lg æ˜¯æ˜¾ç¤ºæŸä¸ªé¡µé¢å†…å®¹ã€‚\nå¸ƒå±€æŠ€å·§ ç¡®å®šè¿™ä¸ªé¡µé¢çš„ ç‰ˆå¿ƒ æœ‰å¤šå®½ å…ˆåˆ†æè¡Œæ¨¡å—ï¼Œå†åˆ†ææ¯ä¸ªè¡Œæ¨¡å—ä¸­çš„ åˆ—æ¨¡å— ï¼ˆé¡µé¢å¸ƒå±€ç¬¬ä¸€å‡†åˆ™ï¼‰ é¡µé¢ç¬¬äºŒå‡†åˆ™ï¼Œç¡®å®šä¸€è¡Œä¸­æ¯ä¸€åˆ—çš„ä½ç½® æ³¨æ„ï¼šç»“æ„æ°¸è¿œæ¯”æ ·å¼é‡è¦ æ’ç‰ˆä¼˜åŒ– å¯¼èˆªæ é€šå¸¸é‡‡ç”¨ li + a çš„å½¢å¼ã€‚å¦‚æœå¾ˆå¤šä¸ª a é“¾æ¥åœ¨ä¸€èµ·ï¼Œæœç´¢å¼•æ“ä¼šå°†å…¶è§†ä¸ºå †ç Œå…³é”®å­—ï¼Œä¼šå¯¹å…¶è¿›è¡Œé™æƒï¼Œä»è€Œå½±å“ç½‘ç«™æ’åã€‚\nå¯¼èˆªæ çš„å„ä¸ªé€‰é¡¹æ–‡å­—ä¸ä¸€æ ·å¤šï¼Œæ‰€ä»¥ä¸è¦å®šæ­»å®½åº¦ï¼Œåªéœ€è®¾ç½® padding è®©å…¶ä¸ç›¸é‚»å…ƒç´ ä¿æŒç›¸åŒçš„è·ç¦»\né»˜è®¤è¡Œå†…å—å…ƒç´ ä¹‹é—´æ˜¯æœ‰ä¸€å®šçš„é—´éš™ï¼Œæ¯”å¦‚ input è¡¨å•å…ƒç´ ä¸ button æŒ‰é’®ä¹‹é—´å…·æœ‰ä¸€å®šé—´éš™ã€‚è§£å†³æ–¹æ³•æ˜¯è®¾ç½®ä¸º æµ®åŠ¨æ¨¡å‹ ï¼Œä¸¤ä¸ª æµ®åŠ¨çš„å…ƒç´  ä¹‹é—´æ˜¯æ²¡æœ‰é—´éš™çš„ã€‚\nå–æ¶ˆæŒ‰é’®çš„é»˜è®¤è¾¹æ¡†ï¼šborder: 0\nå¯¹äºæ–‡å­—æ˜¯å˜é•¿çš„å…ƒç´ ï¼Œä¸è¦å®šæ­»å®½åº¦\næµ®åŠ¨çš„ç›’å­æ²¡æœ‰ å¤–è¾¹è·åˆå¹¶ çš„é—®é¢˜ï¼Œæ‰€ä»¥å¯ä»¥åœ¨å­å…ƒç´ ä¸Šæ”¾å¿ƒçš„è®¾ç½® margin-top\nå¯ä»¥åˆ©ç”¨çˆ¶å…ƒç´ è®¾ç½®è¡Œé«˜ï¼Œè®©å­å…ƒç´ æ¥ç»§æ‰¿çš„æ–¹å¼å®ç°æ‰€æœ‰çš„å­å…ƒç´ å‚ç›´å±…ä¸­å¯¹é½\néšè—è¾¹æ¡† æ¸…é™¤ float: left å¯¼è‡´çš„é‡å è¾¹æ¡†ã€‚\n\u0026lt;style\u0026gt; ul li { list-style: none; float: left; width: 150px;height: 200px; border: 1px solid #000; margin-left: -1px; /* æ¸…é™¤å¤šä¸ªæµ®åŠ¨å åŠ åœ¨ä¸€èµ·æ˜¾ç¤ºçš„å¤šä½™è¾¹æ¡† */ } \u0026lt;/style\u0026gt; \u0026lt;ul\u0026gt; \u0026lt;li\u0026gt;1\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;2\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;3\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;4\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;5\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; before after: margin=-è¾¹æ¡†é•¿åº¦ æ–‡å­—ç¯ç»• é¼ æ ‡ç»è¿‡æŸä¸ªç›’å­ï¼ˆ:hoverï¼‰çš„æ—¶å€™ï¼Œæé«˜å½“å‰ç›’å­çš„å±‚çº§ï¼Œä»¥ä¾¿é€‰ä¸­\næ²¡æœ‰å®šä½ â†’ æ·»åŠ ç›¸å¯¹å®šä½ï¼ˆä¿ç•™ä½ç½®ï¼‰\nul \u0026gt; li:hover{ /* hover ä¼ªç±»é€‰æ‹©å™¨å’Œå…ƒç´ ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼ */ position: relative; /* ç›¸å¯¹å®šä½å¯ä»¥å‹ä½å…¶å®ƒæ ‡å‡†æµçš„ç›’å­ */ border-color: lightblue; } æœ‰å®šä½ â†’ æ·»åŠ  z-index\nul \u0026gt; li:hover{ z-index: 1; } å‚ç›´å±…ä¸­ æ–¹æ³•ä¸€\nè¡Œå†…å…ƒç´ \né€šè¿‡è®¾ç½®è¾¹è· margin ä¸º 0 auto æ¥å®ç°å±…ä¸­ã€‚\næ–¹æ³•äºŒ\nè¡Œå†…å—å…ƒç´ \né¡µç å¸ƒå±€ï¼šé€šè¿‡è®¾ç½®è¡Œé«˜ inline-height ä¸ç›’å­å¤§å°ç›¸åŒæ¥å®ç°ç‰ˆå¿ƒå±…ä¸­ã€‚\n\u0026lt;\u0026lt;ä¸Šä¸€é¡µ 2 3 4 5 6 ... ä¸‹ä¸€é¡µ\u0026gt;\u0026gt; åˆ°ç¬¬é¡µ ç¡®å®š æ–¹æ³•ä¸‰\nä½¿ç”¨ç»å¯¹å®šä½ï¼Œâ€œçˆ¶ç»å­ç›¸â€ã€‚\n.container { position: relative; height: 200px; width: 200px; background-color: orange; margin: auto; } .box { position: absolute; width: 50px; height: 50px; background-color: yellow; top: 50%;left: 50%; margin-top: -25px; margin-left: -25px; } /* CSS3å¯ä»¥ç”¨transform: translate(-50%, -50%); -\u0026gt; æ€§èƒ½æ›´å¥½çš„åŒæ—¶ï¼Œä¹Ÿæ— éœ€çŸ¥é“çˆ¶ç›’å­çš„å®½åº¦ */ æ–¹æ³•å››\nä½¿ç”¨è¡¨æ ¼å±…ä¸­ã€‚\n.container { display: table; text-align: center; vertical-align: middle; } æ–¹æ³•äº”\nå¼•å…¥ Flex å¼¹æ€§ç›’å­åï¼Œåªéœ€ç®€å•çš„è®¾ç½®å³å¯å±…ä¸­ã€‚\n.container { display:flex; justify-content: center; align-items: center } Calc() å¯ä»¥åœ¨å£°æ˜ CSS å±æ€§çš„æ—¶å€™æ‰§è¡Œè®¡ç®—ã€‚ CSS3 å¼•å…¥ã€‚\næ‹¬å·å†…å¯ä»¥ç”¨ + âˆ’ Ã— Ã· ç¬¦å·ã€‚æ³¨æ„åŠ ç©ºæ ¼ã€‚\nwidth: calc(10vh + 30px); æ˜¾ç¤ºä¸éšè— æœ¬è´¨ï¼šè®©ä¸€ä¸ªå…ƒç´ åœ¨é¡µé¢ä¸­éšè—æˆ–è€…æ˜¾ç¤ºå‡ºæ¥\ndisplay æ˜¾ç¤ºéšè— visibility æ˜¾ç¤ºéšè— overflow æº¢å‡ºæ˜¾ç¤ºéšè— Display display: none: éšè—å¯¹è±¡ éšè—å…ƒç´ ä¹‹åï¼Œ ä¸å† å æœ‰åŸæ¥çš„ä½ç½® display: blocké™¤äº†è½¬æ¢ä¸ºå—çº§å…ƒç´ ä¹‹å¤–ï¼ŒåŒæ—¶è¿˜æœ‰ æ˜¾ç¤ºå…ƒç´  çš„æ„æ€ï¼›åº”ç”¨æå…¶å¹¿æ³›ï¼Œæ­é… JS åå¯ä»¥åšå¾ˆå¤šçš„ç½‘é¡µç‰¹æ•ˆã€‚\nVisibility åœ¨ä¸æ”¹å˜åŸ æ–‡æ¡£æµ å¸ƒå±€çš„æƒ…å†µä¸‹ï¼Œ éšè— æŸä¸ªç‰¹å®šçš„å…ƒç´ \nvisible å…ƒç´ å¯è§† hidden å…ƒç´ éšè— Overflow visible é»˜è®¤ï¼Œè¶…å‡ºæ¡†æ¶ hidden éšè—æº¢å‡ºéƒ¨åˆ† scroll å§‹ç»ˆæ˜¾ç¤ºæ»šåŠ¨æ¡ auto ä»…åœ¨æº¢å‡ºæ—¶æ·»åŠ æ»šåŠ¨æ¡ overflow:scroll; Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas eget justo turpis. Duis consequat, quam sit amet convallis convallis, nulla neque condimentum orci, rhoncus euismod enim nisi vel erat. Curabitur vel maximus massa. Praesent ut accumsan lectus, ac laoreet sapien. Aliquam porttitor, lacus at consequat vestibulum, justo arcu sagittis orci, ut porta nibh magna sodales enim. overflow:hidden; Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas eget justo turpis. Duis consequat, quam sit amet convallis convallis, nulla neque condimentum orci, rhoncus euismod enim nisi vel erat. Curabitur vel maximus massa. Praesent ut accumsan lectus, ac laoreet sapien. Aliquam porttitor, lacus at consequat vestibulum, justo arcu sagittis orci, ut porta nibh magna sodales enim. overflow:visible Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas eget justo turpis. Duis consequat, quam sit amet convallis convallis, nulla neque condimentum orci, rhoncus euismod enim nisi vel erat. Curabitur vel maximus massa. Praesent ut accumsan lectus, ac laoreet sapien. Aliquam porttitor, lacus at consequat vestibulum, justo arcu sagittis orci, ut porta nibh magna sodales enim. æ»šåŠ¨å¯ä»¥ä¸ postition: sticky; ç»“åˆï¼Œè®©è¿™ä¸ªå…ƒç´ åªåœ¨é¡µé¢çš„æŸäº›éƒ¨åˆ†æ˜¾ç¤ºï¼›å¯¹äºæœ‰å®šä½çš„ç›’å­ï¼Œæ…ç”¨ overflow: hidden å› ä¸ºå®ƒä¼šéšè—å¤šä½™çš„éƒ¨åˆ†ã€‚\nhot img hot overflow: hidden; æµ®åŠ¨ å¼•å…¥ Q1: å¦‚ä½•è®©å¤šä¸ª å—çº§ç›’å­ div æ°´å¹³æ’åˆ—æˆä¸€è¡Œï¼Ÿ ä½¿ç”¨ display: inline-block æ—¶ï¼Œå—ä¹‹é—´ä¼šæœ‰ç¼éš™ï¼Œä¸”ä¸èƒ½ä½¿ç”¨ width:100% æ¥å¹³å‡åˆ†é… R G B R G B Q2: å¦‚ä½•è®©å¤šä¸ª å—çº§ç›’å­ div å·¦å³å¯¹é½ï¼Ÿ R B æ€»ç»“ï¼šæœ‰å¾ˆå¤šçš„å¸ƒå±€æ•ˆæœï¼Œæ ‡å‡†æµæ— æ³•å®Œæˆï¼Œæ­¤æ—¶å°±å¯ä»¥åˆ©ç”¨æµ®åŠ¨å®Œæˆå¸ƒå±€ï¼Œå› ä¸ºæµ®åŠ¨å¯ä»¥æ”¹å˜å…ƒç´ æ ‡ç­¾é»˜è®¤çš„æ’åˆ—æ–¹å¼ã€‚\nå…¸å‹åº”ç”¨ï¼šè®©å¤šä¸ª å—å…ƒç´  åœ¨ ä¸€è¡Œ å†…æ’åˆ—æ˜¾ç¤ºã€‚\nNote:\nå¤šä¸ªå—çº§å…ƒç´  çºµå‘æ’åˆ— æ‰¾ æ ‡å‡†æµ å¤šä¸ªå—çº§å…ƒç´  æ¨ªå‘æ’åˆ— æ‰¾ æµ®åŠ¨ ä»€ä¹ˆæ˜¯æµ®åŠ¨ï¼Ÿ\nfloat å±æ€§ç”¨äºåˆ›å»º æµ®åŠ¨æ¡† ï¼Œå°†å…¶ç§»åŠ¨åˆ°ä¸€è¾¹ï¼Œç›´åˆ°å·¦è¾¹ç¼˜æˆ–å³è¾¹ç¼˜è§¦åŠåŒ…å«å—æˆ–å¦ä¸€ä¸ª æµ®åŠ¨æ¡† çš„è¾¹ç¼˜ã€‚\nè¯­æ³• é€‰æ‹©å™¨ {float: å±æ€§å€¼} å±æ€§å€¼ æè¿° none å…ƒç´ ä¸æµ®åŠ¨ left å…ƒç´ å‘å·¦æµ®åŠ¨ right å…ƒç´ å‘å³æµ®åŠ¨ ç‰¹æ€§ æµ®åŠ¨å…ƒç´ æˆ–è„±ç¦» æ ‡å‡†æµï¼ˆè„±æ ‡ï¼‰ï¼Œä¸å†ä¿ç•™åŸæ¥çš„ä½ç½® å¦‚æœç»™å¤šä¸ªç›’å­éƒ½è®¾ç½®äº†æµ®åŠ¨ï¼Œåˆ™å®ƒä»¬ä¼šæŒ‰ç…§å±æ€§å€¼åœ¨ ä¸€è¡Œå†… æ˜¾ç¤ºå¹¶ä¸” é¡¶ç«¯å¯¹é½ æ’åˆ—ï¼›è‹¥è¶…å‡ºçˆ¶å…ƒç´ å®½åº¦èŒƒå›´ï¼Œåˆ™å¤šä½™å…ƒç´ ä¼š è‡ªåŠ¨æ¢è¡Œ æµ®åŠ¨å…ƒç´ å…·æœ‰ è¡Œå†…å—å…ƒç´  çš„ç‰¹ç‚¹ï¼ˆå…·æœ‰ å®½ \u0026amp; é«˜ ä¸”ä¸å æ®ä¸€è¡Œï¼‰ã€‚ ä»»ä½•å…ƒç´  éƒ½å¯ä»¥æµ®åŠ¨ï¼Œä¸ç®¡åŸå…ˆæ˜¯ä»€ä¹ˆæ¨¡å¼çš„å…ƒç´ ï¼Œæ·»åŠ æµ®åŠ¨åéƒ½å°†å…·æœ‰æ­¤ç‰¹æ€§ å¦‚æœ å—çº§å…ƒç´  æ²¡æœ‰è®¾ç½®å®½åº¦ï¼Œé»˜è®¤å®½åº¦å°†å’Œ çˆ¶çº§ ä¸€æ ·å®½ï¼Œä½†æ˜¯æ·»åŠ æµ®åŠ¨åï¼Œå®ƒçš„å¤§å°å°†ä¼šæ ¹æ® å†…å®¹ æ¥å†³å®šï¼ˆæ‰€ä»¥ç™¾åˆ†æ¯”å¤±æ•ˆäº†ï¼Ÿï¼‰ æµ®åŠ¨çš„ç›’å­ä¸­é—´æ²¡æœ‰ ç¼éš™ æµ®åŠ¨å…ƒç´ ä¼šè‡ªåŠ¨å–æ¶ˆå¤–è¾¹è·åˆå¹¶ æµ®åŠ¨çš„ç›’å­ æ ‡å‡†çš„ç›’å­ æµ®åŠ¨çš„ç›’å­1 æµ®åŠ¨çš„ç›’å­2 æµ®åŠ¨çš„ç›’å­3 ä½¿ç”¨ ä¸ºäº† çº¦æŸ æµ®åŠ¨å…ƒç´ ä½ç½®ï¼Œç½‘é¡µå¸ƒå±€ä¸€èˆ¬é‡‡å–çš„ç­–ç•¥æ˜¯ï¼š\nå…ˆç”¨æ ‡å‡†çš„çˆ¶å…ƒç´ æ’åˆ— ä¸Šä¸‹ä½ç½® ï¼Œä¹‹åå†…éƒ¨å­å…ƒç´ é‡‡å–æµ®åŠ¨æ’åˆ—åœ¨ **å·¦å³ä½ç½® **ï¼Œç¬¦åˆç½‘é¡µå¸ƒå±€ç¬¬ä¸€å‡†åˆ™ã€‚\næ ‡å‡†æµçˆ¶ç›’å­ æµ®åŠ¨å­ç›’å­ æµ®åŠ¨å­ç›’å­ æµ®åŠ¨å­ç›’å­ å’Œ æ ‡å‡†æµ çš„çˆ¶ç›’å­æ­é… å…ˆç”¨æ ‡å‡†æµçš„çˆ¶å…ƒç´ æ’åˆ—ä¸Šä¸‹ä½ç½®ï¼Œä¹‹åçš„å†…éƒ¨å­å…ƒç´ é‡‡å–æµ®åŠ¨æ’åˆ—å·¦å³ä½ç½® ä¸€ä¸ªå…ƒç´ æµ®åŠ¨äº†ï¼Œç†è®ºä¸Šå…¶ä½™çš„ å…„å¼Ÿå…ƒç´  ä¹Ÿè¦è·Ÿç€æµ®åŠ¨ æ¸…é™¤ ç†æƒ³ä¸­çš„çŠ¶æ€ï¼šè®©å­ç›’å­æ’‘å¼€çˆ¶äº²ã€‚æœ‰å¤šå°‘å­©å­ï¼Œçˆ¶ç›’å­å°±æœ‰å¤šé«˜ã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼Œç”±äºæµ®åŠ¨å…ƒç´ è„±ç¦»æ–‡æ¡£æµï¼Œå› æ­¤çˆ¶ç›’å­é«˜åº¦ä¸º0ï¼Œ ä¸‹é¢å…ƒç´  ä¸ å½“å‰å…ƒç´  é‡åˆ å› æ­¤éœ€è¦ æ¸…é™¤æµ®åŠ¨ ï¼Œé˜²æ­¢å½±å“ ä¸‹é¢ çš„å…ƒç´ ï¼›æ­¤æ—¶ çˆ¶å…ƒç´  å°±ä¼šæ ¹æ®æµ®åŠ¨çš„å­ç›’å­ è‡ªåŠ¨ æ£€æµ‹é«˜åº¦ã€‚çˆ¶å…ƒç´ æœ‰äº†é«˜åº¦ä¹‹åå°±ä¸ä¼šå½±å“åç»­çš„æ ‡å‡†æµäº† æ¸…é™¤ç­–ç•¥ï¼šé—­åˆæµ®åŠ¨ å­ç›’å­æµ®åŠ¨ å­ç›’å­æµ®åŠ¨ å­ç›’å­æµ®åŠ¨ å­ç›’å­æµ®åŠ¨ï¼Œè„±æ ‡ã€‚çˆ¶ç›’å­æ²¡æœ‰é«˜åº¦å°±ä¸º0ï¼Œä¸ä¼šè¢«æ’‘å¼€ç›’å­ ä¸‹ç›’å­ç§»åŠ¨åˆ°ä¸‹ä¾§ æœ‰ä»¥ä¸‹å‡ ä¸ªä¸»è¦æ–¹æ³•å¯ä»¥æ¸…é™¤ï¼š\né¢å¤–æ ‡ç­¾æ³• ä¹Ÿç§°ä¸ºéš”ç¦»æ³•ï¼Œæ˜¯ W3C æ¨èçš„åšæ³•ï¼ˆä½†å®é™…ä¸å¸¸ç”¨ï¼‰\nåœ¨æµ®åŠ¨å…ƒç´ æœ«å°¾æ·»åŠ ä¸€ä¸ªç©ºçš„æ ‡ç­¾ï¼Œä¾‹å¦‚ï¼š\n\u0026lt;style\u0026gt; .clear { clear: both; } \u0026lt;/style\u0026gt; \u0026lt;div style=\u0026#34;clear:both\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;clear\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;br\u0026gt; ä¼˜ç‚¹ï¼šä¹¦å†™æ–¹ä¾¿\nç¼ºç‚¹ï¼šæ·»åŠ è®¸å¤šæ— æ„ä¹‰çš„æ ‡ç­¾ï¼Œç»“æ„åŒ–è¾ƒå·®\næ€»ç»“ï¼š\næœ¬è´¨ä¸Šæ¸…é™¤æµ®åŠ¨å…ƒç´ è„±ç¦» æ ‡å‡†æµ çš„å½±å“ é—­åˆæµ®åŠ¨ ï¼Œåªè®©æµ®åŠ¨åœ¨çˆ¶ç›’å­å†…éƒ¨ç”Ÿæ•ˆï¼Œä¸å½±å“å¤–éƒ¨çš„å…¶å®ƒç›’å­ã€‚ NOTE: æ·»åŠ çš„æ ‡ç­¾å¿…é¡»æ˜¯ å—çº§å…ƒç´ \nçˆ¶çº§æ·»åŠ  overflow å±æ€§\n/* æ¸…é™¤æµ®åŠ¨å…ƒç´  */ oveflow: hidden; ä¼˜ç‚¹ï¼šä»£ç ç®€æ´\nç¼ºç‚¹ï¼šæ— æ³•æ˜¾ç¤ºæº¢å‡ºçš„éƒ¨åˆ†\nçˆ¶çº§æ·»åŠ  :after ä¼ªå…ƒç´ \nç±»ä¼¼ é¢å¤–æ ‡ç­¾æ³• çš„ å‡çº§ç‰ˆ\n.clearfix:after{ content: \u0026#34;\u0026#34;; /* ä¼ªå…ƒç´ å¿…é¡»å†™çš„é€‰é¡¹ */ display: block; /* æ’å…¥çš„å…ƒç´ å¿…é¡»æ˜¯å—çº§ */ height: 0; /* ä¸æ˜¾ç¤ºè¿™ä¸ªå…ƒç´  */ visibility: hidden; clear: both; /* æ ¸å¿ƒä»£ç  */ } .clearfix{ /* IE6ã€7ä¸“ç”¨ */ *zoom: 1; } ä¼˜ç‚¹ï¼šæ²¡æœ‰å¢åŠ æ ‡ç­¾ï¼Œç»“æ„æ›´ç®€å•\nç¼ºç‚¹ï¼šç…§é¡¾ä½ç‰ˆæœ¬æµè§ˆå™¨\nä»£è¡¨ç½‘ç«™ï¼šç™¾åº¦ã€æ·˜å®ç½‘ã€ç½‘æ˜“ç­‰\nçˆ¶çº§æ·»åŠ åŒä¼ªå…ƒç´ \n} .clearfix:before{ content: \u0026#34;\u0026#34;; display: table; } .clearfix:after{ clear: both; } .clearfix{ *zoom:1; } ä¼˜ç‚¹ï¼šä»£ç ç®€æ´\nä»£è¡¨ç½‘ç«™ï¼šå°ç±³ã€è…¾è®¯ç­‰\nä¸ºä»€ä¹ˆéœ€è¦æ¸…é™¤æµ®åŠ¨ï¼Ÿ\nçˆ¶çº§æ²¡æœ‰è®¾ç½®é«˜åº¦ å­ç›’å­æµ®åŠ¨ å½±å“ä¸‹æ–¹å¸ƒå±€ æ¸…é™¤å‰ before æ¸…é™¤å after å®šä½ æé—®ï¼šä»¥ä¸‹æƒ…å†µä½¿ç”¨æ ‡å‡†æµæˆ–è€…æµ®åŠ¨èƒ½å®ç°å—?\næŸä¸ªå…ƒç´ å¯ä»¥è‡ªç”±çš„åœ¨ä¸€ä¸ªç›’å­å†…ç§»åŠ¨ä½ç½®ï¼Œå¹¶ä¸”å‹ä½å…¶ä»–ç›’å­ã€‚ å½“æˆ‘ä»¬æ»šåŠ¨çª—å£çš„æŸä¸ªä½ç½®æ—¶ï¼Œç›’å­å›ºå®šåœ¨çª—å£çš„æŸä¸ªä½ç½® æ‰€ä»¥ï¼š\næµ®åŠ¨ å¯ä»¥è®©å¤šä¸ªå—çº§ç›’å­ä¸€è¡Œ æ²¡æœ‰ç¼éš™ æ’åˆ—æ˜¾ç¤ºï¼Œç»å¸¸ç”¨äºæ¨ªå‘æ’åˆ—ç›’å­ å®šä½ åˆ™æ˜¯å¯ä»¥è®©ç›’å­è‡ªç”±çš„åœ¨æŸä¸ªç›’å­å†… ç§»åŠ¨ä½ç½® æˆ–è€… å›ºå®šåœ¨æŸä¸ªä½ç½® ï¼Œå¹¶ä¸”å¯ä»¥å‹ä½å…¶å®ƒç›’å­ ç»„æˆ å°†ç›’å­å›ºå®šåœ¨æŸä¸€ä¸ªä½ç½®ï¼Œæ‰€ä»¥å®šä½ä¹Ÿæ˜¯åœ¨ æ‘†æ”¾ç›’å­ ï¼ŒæŒ‰ç…§å®šä½çš„æ–¹å¼ ç§»åŠ¨ç›’å­ ã€‚ $$ å®šä½=å®šä½æ¨¡å¼+è¾¹åç§» $$å®šä½æ¨¡å¼ æŒ‡å®šå…ƒç´ åœ¨æ–‡æ¡£ä¸­çš„å®šä½æ–¹å¼ï¼Œå®ƒé€šè¿‡ CSS çš„ position å±æ€§è®¾ç½®ï¼Œå…¶å€¼å¯ä»¥åˆ†ä¸ºå››ä¸ªï¼š\nstatic: é™æ€å®šä½ relative: ç›¸å¯¹å®šä½ absolute: ç»å¯¹å®šä½ fixed: å›ºå®šå®šä½ æ§åˆ¶è¢«å®šä½çš„ç›’å­ç§»åŠ¨è·ç¦»ï¼š\ntop: é¡¶éƒ¨åç§» bottom: åº•éƒ¨åç§» left: å·¦ä¾§åç§» right: å³ä¾§åç§» NOTE: æ ‡å‡†æµ å’Œ æµ®åŠ¨å¸ƒå±€ æ˜¯ä¸èƒ½ä½¿ç”¨è¿™å››ä¸ªå±æ€§çš„ã€‚\né™æ€å®šä½ é»˜è®¤æ¨¡å¼ï¼Œæ— å®šä½ï¼›æŒ‰ç…§æ ‡å‡†æµç‰¹æ€§æ”¾ç½®ã€æ²¡æœ‰è¾¹åç§»ï¼Œå¾ˆå°‘ç”¨åˆ°ã€‚\nNOTE: æ­¤æ—¶ left top right bottom å‡å®æ•ˆ\né€‰æ‹©å™¨ { postition: static; } position:static;\nç›¸å¯¹å®šä½ ç›¸å¯¹ åŸæ¥ä½ç½® è¿›è¡Œå®šä½åç§»ï¼›åé¢ç›’å­çš„å¸ƒå±€ä»ç„¶ä¸å—å½±å“ã€‚\nNOTE: ä¹Ÿå°±æ˜¯åœ¨é™æ€å®šä½çš„åŸºç¡€ä¸Šå¯ä»¥è®¾ç½® left top right bottom çš„åç§»ï¼›æ­¤æ—¶æ‰€å ä½ç½®ä¸å˜ï¼Œä»ç„¶å­˜åœ¨äºæ–‡æ¡£æµä¸­ã€‚\né€‰æ‹©å™¨ { postition: relative; } çˆ¶å…ƒç´  position:relative;\ntop: 2vh;\nright: 2vw; ç»å¯¹å®šä½ ç›¸å¯¹äº æœ€è¿‘ä¸€çº§ æœ‰å®šä½ï¼ˆç›¸å¯¹ã€ç»å¯¹ã€å›ºå®šå®šä½ï¼‰çš„ ç¥–å…ˆå…ƒç´  è¿›è¡Œå®šä½ï¼›å¦‚æœç¥–å…ˆå…ƒç´ æ²¡æœ‰å®šä½ï¼Œåˆ™ä»¥æµè§ˆå™¨ä¸ºå‡†å®šä½ï¼ˆDocument æ–‡æ¡£ï¼‰\n! NOTE: ä¹Ÿå°±æ˜¯è¯´ï¼Œè‹¥ çˆ¶å…ƒç´  å­˜åœ¨å®šä½ï¼Œåˆ™ å­å…ƒç´  å¯ä¾ç…§å…¶å®šä½ï¼›ä¸æ˜¯è¯´ä¸€å®šå°±æ ¹æ®çˆ·çˆ·å…ƒç´ è¿›è¡Œå®šä½ã€‚\nç»å¯¹å®šä½è„±ç¦» æ ‡å‡†æµ ï¼Œ ä¸å†å æœ‰ åŸæ¥çš„ä½ç½® ç»å¯¹å®šä½ å’Œ å›ºå®šå®šä½ åŒ æµ®åŠ¨ ä¸€æ ·ï¼Œä¼šä½¿å…ƒç´ è½¬æ¢ä¸º è¡Œå†…å—å…ƒç´  ã€‚ æ­¤æ—¶åŸè¡Œå†…å…ƒç´ å¯ä»¥è®¾ç½®å®½é«˜ï¼Œ åŸå—çº§å…ƒç´ å°†ä¸å†å æ»¡ä¸€æ•´è¡Œï¼Œå…¶å®½åº¦ç­‰äºå†…å®¹çš„å®½åº¦ï¼Œä½†ç›¸å¯¹å®šä½ä¸å…·æœ‰è¯¥ç‰¹æ€§ ç»å¯¹å®šä½ ã€ å›ºå®šå®šä½ ã€ æµ®åŠ¨ éƒ½æœ‰è„±æ ‡çš„ç°è±¡ï¼Œæ‰€ä»¥éƒ½ä¸ä¼šè§¦å‘ å¤–è¾¹è·åˆå¹¶ - è§ margin é€‰æ‹©å™¨ { postition: absolute; } ç¥–å…ˆå…ƒç´  çˆ¶å…ƒç´  position:absolute;\ntop: 2vh;\nright: 2vw; â€œå­ç»çˆ¶ç›¸â€ å¦‚æœå­çº§ä½¿ç”¨ ç»å¯¹å®šä½ ï¼Œçˆ¶çº§åˆ™éœ€è¦ä½¿ç”¨ ç›¸å¯¹å®šä½\nçˆ¶ç›’å­å¸ƒå±€æ—¶ï¼Œéœ€è¦ å æœ‰ä½ç½® ï¼Œå› æ­¤çˆ¶äº²åªèƒ½æ˜¯ ç›¸å¯¹å®šä½\nå­çº§ä¸ä¼šå æœ‰ä½ç½®ã€‚å¯ä»¥æ”¾åˆ°çˆ¶ç›’å­é‡Œé¢çš„ä»»ä½•ä¸€ä¸ªåœ°æ–¹ï¼Œä¸ä¼šå½±å“å…¶ä»–çš„å…„å¼Ÿç›’å­\nçˆ¶ç›’å­éœ€è¦åŠ å®šä½é™åˆ¶å­ç›’å­åœ¨çˆ¶ç›’å­å†…æ˜¾ç¤º\n\u0026lt;box\u0026gt; \u0026lt;div\u0026gt; \u0026lt;div style=\u0026#34;position:absolute;\u0026#34;\u0026gt; å†…å®¹ä¼šè‡ªåŠ¨æ ¹æ®boxçš„ä½ç½®è¿›è¡Œå®šä½ï¼Œä¸”ä¸ä¼šåƒfloaté‚£æ ·å½±å“åé¢çš„ç›’å­ \u0026#34;å­ç»çˆ¶ç›¸\u0026#34; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/box\u0026gt; å›ºå®šå®šä½ å…ƒç´  å›ºå®š äºæµè§ˆå™¨å¯è§†åŒºçš„ä½ç½®ã€‚ä¸»è¦ä½¿ç”¨åœºæ™¯ï¼šå¯ä»¥åœ¨æµè§ˆå™¨é¡µé¢æ»šåŠ¨æ—¶å…ƒç´ çš„ä½ç½®ä¸ä¼šæ”¹å˜ã€‚\nä»¥æµè§ˆå™¨çš„ å¯è§†çª—å£ ä¸ºå‚ç…§ç‚¹ç§»åŠ¨å…ƒç´  ä¸çˆ¶å…ƒç´ æ²¡æœ‰ä»»ä½•å…³ç³» ä¸éšæ»šåŠ¨æ¡æ»šåŠ¨ã€ä¸å æœ‰åŸæ¥ä½ç½® é€‰æ‹©å™¨ { postition: fixed; } å›ºå®šç‰ˆå¿ƒå³ä¾§ï¼š\nè®©å›ºå®šå®šä½çš„ç›’å­ left: 50% èµ°åˆ°æµè§ˆå™¨å¯è§†åŒºï¼ˆä¹Ÿå¯ä»¥çœ‹ä½œç‰ˆå¿ƒï¼‰çš„ä¸€åŠä½ç½® è®©å›ºå®šå®šä½çš„ ç›’å­ margin-left: ç‰ˆå¿ƒå®½åº¦çš„ä¸€åŠè·ç¦»ã€‚å¤šèµ°ç‰ˆå¿ƒå®½åº¦çš„ä¸€åŠä½ç½® å°±å¯ä»¥è®©å›ºå®šå®šä½çš„ç›’å­è´´ç€ç‰ˆå¿ƒå³ä¾§å¯¹é½äº†ã€‚\n\u0026lt;/style\u0026gt; .w { width: 800px;height: 1400px; background-color: #f0f; margin: 0 auto; } .fixed { position: fixed; width: 50px;height: 150px; /* èµ°æµè§ˆå™¨å®½åº¦çš„ä¸€åŠ */ left: 50%; /* åˆ©ç”¨marginèµ°ç‰ˆå¿ƒç›’å­å®½åº¦çš„ä¸€åŠ */ margin-left: 400px; background-color: skyblue; } \u0026lt;/style\u0026gt; \u0026lt;div class=\u0026#34;fixed\u0026#34;\u0026gt;å›ºå®šç›’å­\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;w\u0026#34;\u0026gt;ç‰ˆå¿ƒç›’å­ 800åƒç´ \u0026lt;/div\u0026gt; ç²˜æ€§å®šä½ ç›¸å¯¹å®šä½ å’Œ å›ºå®šå®šä½ çš„æ··åˆã€‚\nä»¥æµè§ˆå™¨çš„ å¯è§†çª—å£ ä¸ºå‚ç…§ç‚¹ç§»åŠ¨å…ƒç´ ï¼ˆå›ºå®šå®šä½ç‰¹ç‚¹ï¼‰ ç²˜æ€§å®šä½å æœ‰ åŸå…ˆ çš„ä½ç½®ï¼ˆç›¸å¯¹å®šä½ç‰¹ç‚¹ï¼‰ å¿…é¡»æ·»åŠ  top left right bottom å…¶ä¸­ä¸€ä¸ªæ‰æœ‰æ•ˆ å…ƒç´ ä¸å®ƒçš„å®¹å™¨ä¸€èµ·æ»šåŠ¨ï¼Œç›´åˆ°å®ƒä½äºå®¹å™¨çš„é¡¶éƒ¨ï¼ˆæˆ–åˆ°è¾¾é¡¶éƒ¨æŒ‡å®šçš„åç§»é‡ï¼‰ï¼Œç„¶åå°† åœæ­¢ç§»åŠ¨ ï¼Œå› æ­¤åœ¨ç¬¬ä¸€æ¬¡å‡ºç°åå°†å§‹ç»ˆä¿æŒå¯è§ é€‰æ‹©å™¨ { postition: sticky; top: 10px } position: sticky; Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas eget justo turpis. Duis consequat, before: static; sticky after: fixed; quam sit amet convallis convallis, nulla neque condimentum orci, rhoncus euismod enim nisi vel erat. Curabitur vel maximus massa. Praesent ut accumsan lectus, ac laoreet sapien. Aliquam porttitor, lacus at consequat vestibulum, justo arcu sagittis orci, ut porta nibh magna sodales enim. æ€»ç»“ å®šä½æ¨¡å¼ æ˜¯å¦è„±æ ‡ ç§»åŠ¨ä½ç½® æ˜¯å¦å¸¸ç”¨ static é™æ€å®šä½ å¦ ä¸èƒ½ä½¿ç”¨è¾¹åç§» å¾ˆå°‘ relative ç›¸å¯¹å®šä½ å¦ - å æœ‰ä½ç½® ç›¸å¯¹è‡ªèº«ä½ç½®ç§»åŠ¨ å¸¸ç”¨ absolute ç›¸å¯¹å®šä½ æ˜¯ - ä¸å æœ‰ä½ç½® å¸¦æœ‰å®šä½çš„çˆ¶çº§ å¸¸ç”¨ fixed å›ºå®šå®šä½ æ˜¯ - ä¸å æœ‰ä½ç½® æµè§ˆå™¨å¯è§†åŒº å¸¸ç”¨ sticky ç²˜æ€§å®šä½ å¦ - å æœ‰ä½ç½® æµè§ˆå™¨å¯è§†åŒº å½“å‰é˜¶æ®µå¾ˆå°‘ è®°ä½ç‰¹ç‚¹ï¼šä»¥è°ä¸ºåŸºå‡†ç‚¹ç§»åŠ¨ä½ç½®\nå æ”¾é¡ºåº åœ¨ä½¿ç”¨å®šä½å¸ƒå±€æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°ç›’å­é‡å çš„æƒ…å†µã€‚æ­¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ z-index æ¥æ§åˆ¶ç›’å­çš„å‰åæ¬¡åº ï¼ˆzè½´ï¼‰\næ•°å€¼å¯ä»¥æ˜¯æ­£æ•´æ•°ã€è´Ÿæ•´æ•°æˆ–è€… 0 ï¼Œé»˜è®¤ä¸º auto æ•°å€¼è¶Šå¤§ï¼Œç›’å­è¶Šé ä¸Š æ•°å€¼ä¸€æ ·ï¼Œåæ¥å±…ä¸Š æ•°å€¼æ²¡æœ‰å•ä½ï¼Œåªæœ‰ å®šä½ çš„ç›’å­æ‰æœ‰ z-index å±æ€§ æµ®åŠ¨ä¸æ”¯æŒè¿™ä¸ªå±æ€§ é€‰æ‹©å™¨ { z-index:1; } çˆ¶å…ƒç´  z-index: 3; z-index: 3; z-index: 1; æ‰©å±• åŠ äº† ç»å¯¹å®šä½ çš„ç›’å­ä¸èƒ½é€šè¿‡ margin: 0 auto æ°´å¹³å±…ä¸­ï¼Œç„¶æ˜¯å¯ä»¥é€šè¿‡ä»¥ä¸‹è®¡ç®—æ–¹æ³•å®ç° æ°´å¹³ å’Œ å‚ç›´ å±…ä¸­ï¼š\n.box .horizontal{ /* ç»å¯¹å®šä½æ°´å¹³å±…ä¸­ */ position: absolute; /* 1. leftèµ°50% çˆ¶å®¹å™¨å®½åº¦çš„ä¸€åŠ */ left: 50%; /* 2. marginè´Ÿå€¼ å¾€å·¦è¾¹èµ°è‡ªå·±ç›’å­å®½åº¦çš„ä¸€åŠ */ margin-left: -100px; width: 200px;height: 200px; background-color: #fff; } .box .vertical{ /* ç»å¯¹å®šä½å‚ç›´å±…ä¸­ */ position: absolute; /* 1. topèµ°50% çˆ¶å®¹å™¨å®½åº¦çš„ä¸€åŠ */ top: 50%; /* 2. marginè´Ÿå€¼ å¾€å·¦è¾¹èµ°è‡ªå·±ç›’å­å®½åº¦çš„ä¸€åŠ */ margin-top: -100px; width: 200px;height: 200px; background-color: #fff; } ç»å¯¹å®šä½ / å›ºå®šå®šä½ ä¹Ÿä¸æµ®åŠ¨ç±»ä¼¼\u0010ï¼š\nè¡Œå†…å…ƒç´ æ·»åŠ ç»å¯¹æˆ–è€…å›ºå®šå®šä½ï¼Œå¯ä»¥ç›´æ¥è®¾ç½® é«˜åº¦ å’Œ å®½åº¦\nå—çº§å…ƒç´ æ·»åŠ ç»å¯¹æˆ–è€…å›ºå®šå®šä½ï¼Œå¦‚æœä¸ç»™å®½åº¦æˆ–è€…é«˜åº¦ï¼Œé»˜è®¤å¤§å°ä¸º å†…å®¹å¤§å°\nè„±æ ‡çš„ç›’å­ï¼ˆæµ®åŠ¨å…ƒç´ ã€ç»å¯¹å®šä½å…ƒç´ ï¼‰ä¸ä¼šè§¦å‘å¤–è¾¹è·å¡Œé™·\n\u0026lt;style\u0026gt; span{ position: absolute; width: 200px; height: 150px; background-color: #fff; } \u0026lt;/style\u0026gt; \u0026lt;span\u0026gt;\u0026lt;/span\u0026gt; çˆ¶å…ƒç´  \u0026lt;span\u0026gt; ç»å¯¹å®šä½ ä¼šå®Œå…¨å‹ä½ç›’å­ï¼Œè€Œ æµ®åŠ¨ åªä¼šå‹ä½æ ‡å‡†æµçš„ç›’å­ï¼Œä½†ä¸ä¼šå‹ä½ä¸‹é¢æ ‡å‡†æµç›’å­é‡Œé¢çš„æ–‡å­—\nè¿™æ˜¯å› ä¸ºï¼Œæµ®åŠ¨ä¹‹æ‰€ä»¥ä¸ä¼šå‹ä½æ–‡å­—ï¼Œæ˜¯å› ä¸ºæµ®åŠ¨äº§ç”Ÿçš„ç›®çš„æœ€åˆæ˜¯ä¸ºäº†åš æ–‡å­—ç¯ç»•æ•ˆæœ çš„ã€‚æ–‡å­—ä¼š å›´ç»• æµ®åŠ¨å…ƒç´ æ’å¸ƒ Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas eget justo turpis. Duis consequat, quam sit amet convallis convallis, img nulla neque condimentum orci, rhoncus euismod enim nisi vel erat. Curabitur vel maximus massa. Praesent ut accumsan lectus, ac laoreet sapien. Aliquam porttitor, lacus at consequat vestibulum, justo arcu sagittis orci, ut porta nibh magna sodales enim. Maecenas sit amet nulla in lectus condimentum egestas malesuada id orci. Nam fringilla quis dui eget volutpat. Aenean id nisi at nulla commodo consequat vel sit amet diam. Nunc ut ligula ac dolor viverra egestas. Mauris et eros vulputate nisi suscipit blandit id non erat. Pellentesque fringilla quam sem, in elementum turpis egestas eu. Sed dignissim nulla sed ligula egestas fringilla. Nam id erat augue. Suspendisse aliquam nulla purus. Flex ä¼ ç»Ÿå¸ƒå±€ å…¼å®¹æ€§å¥½ å¸ƒå±€ç¹ç å±€é™æ€§ï¼Œä¸èƒ½åœ¨ç§»åŠ¨ç«¯å¾ˆå¥½çš„å¸ƒå±€ flex å¼¹æ€§å¸ƒå±€ æ“ä½œæ–¹ä¾¿ã€å¸ƒå±€ç®€å•ã€åº”ç”¨å¹¿æ³› PC ç«¯æµè§ˆå™¨æ”¯æŒè¾ƒå·® IE11 æˆ–æ›´ä½ç‰ˆæœ¬ä¸æ”¯æŒæˆ–ä»…éƒ¨åˆ†æ”¯æŒ å»ºè®®ï¼šå¦‚æœæ˜¯ PC ç«¯é¡µé¢å¸ƒå±€ï¼Œè¿˜æ˜¯ä½¿ç”¨ä¼ ç»Ÿå¸ƒå±€ï¼›è‹¥ä»…é™äºç§»åŠ¨ç«¯ï¼Œå¯åªä½¿ç”¨ flex å¼¹æ€§å¸ƒå±€ã€‚\n\u0026lt;!-- å¼€å¯flexå¸ƒå±€åä¸å†éœ€è¦æ¸…é™¤æµ®åŠ¨\t--\u0026gt; \u0026lt;style\u0026gt; div { display: flex; width: 100%;height: 300px; background-color: pink; justify-content: space-around; } div span { width: 150px;height: 100px; background-color: purple; margin-right: 5px; } \u0026lt;/style\u0026gt; \u0026lt;div\u0026gt; \u0026lt;span\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span\u0026gt;2\u0026lt;/span\u0026gt; \u0026lt;span\u0026gt;3\u0026lt;/span\u0026gt; \u0026lt;/div\u0026gt; åŸç† flex æ˜¯ Flexible Box çš„ç¼©å†™ï¼Œæ„ä¸ºâ€œå¼¹æ€§å¸ƒå±€â€ã€‚ä»»ä½•å®¹å™¨éƒ½å¯è¢«æŒ‡å®šä¸º flex å¸ƒå±€ã€‚\nå½“ä¸ºçˆ¶ç›’å­è®¾ç½®ä¸º flex å¸ƒå±€ä¹‹åï¼Œå­ç›’å­çš„ float clear vertical-align å±æ€§å°†å¤±æ•ˆ ä¼¸ç¼©å¸ƒå±€ = å¼¹æ€§å¸ƒå±€ = ä¼¸ç¼©ç›’å¸ƒå±€ = å¼¹æ€§ç›’å¸ƒå±€ = flex å¸ƒå±€ é‡‡ç”¨ flex å¸ƒå±€çš„å…ƒç´ ï¼Œæˆä¸º flex å®¹å™¨flex container ã€‚å®ƒçš„æ‰€æœ‰å­å…ƒç´ è‡ªåŠ¨æˆä¸ºå®¹å™¨æˆå‘˜ï¼Œæˆä¸º flex é¡¹ç›® flex itemã€‚\nå­å®¹å™¨æ”¯æŒæ¨ªå‘ / çºµå‘æ’åˆ— é€šè¿‡ä¸º çˆ¶ç›’å­ æ·»åŠ  flex å±æ€§ï¼Œæ¥æ§åˆ¶ å­ç›’å­ çš„ä½ç½®å’Œæ’åˆ—æ–¹å¼ Flex container flex-directionï¼šrow \u0026lrarr; Item Item Item å±æ€§ çˆ¶é¡¹ ä»¥ä¸‹ 6 ä¸ªå±æ€§æ˜¯å¯¹çˆ¶å…ƒç´ è®¾ç½®çš„\nå±æ€§ æè¿° flex-direction è®¾ç½®ä¸»è½´çš„æ–¹å‘ justify-content è®¾ç½®ä¸»è½´ä¸Šçš„å­å…ƒç´ æ’åˆ—æ–¹å¼ flex-wrap è®¾ç½®å­å…ƒç´ æ˜¯å¦æ¢è¡Œ align-content è®¾ç½®ä¾§è½´ä¸Šçš„å­å…ƒç´ çš„æ’åˆ—æ–¹å¼ï¼ˆå¤šè¡Œï¼‰ align-items è®¾ç½®ä¾§è½´ä¸Šçš„å­å…ƒç´ æ’åˆ—æ–¹å¼ï¼ˆå•è¡Œï¼‰ flex-flow å¤åˆå±æ€§ï¼Œç›¸å½“äºåŒæ—¶è®¾ç½®äº† flex-direction å’Œ flex-wrap Flex-direction åœ¨ flex å¸ƒå±€ä¸­ï¼Œåˆ†ä¸ºä¸»è½´å’Œä¾§è½´ä¸¤ä¸ªæ–¹å‘ã€‚åŒæ ·çš„å«æ³•æœ‰ï¼šè¡Œå’Œåˆ— / x è½´å’Œ y è½´\né»˜è®¤ ä¸»è½´ æ–¹å‘æ˜¯ x è½´æ–¹å‘ï¼Œæ°´å¹³å‘å³ é»˜è®¤ ä¾§è½´ æ–¹å‘æ˜¯ y è½´æ–¹å‘ï¼Œæ°´å¹³å‘ä¸‹ å±æ€§å€¼ï¼ˆå­å…ƒç´ æ ¹æ®å­è½´æ’åˆ—ï¼‰ï¼š\nå±æ€§å€¼ è¯´æ˜ row ä»å·¦åˆ°å³ â†’ row-reverse ä»å³åˆ°å·¦ â† column ä»ä¸Šåˆ°ä¸‹ â†“ column-reverse ä»ä¸‹åˆ°ä¸Š â†‘ NOTE: é»˜è®¤å€¼ä¸º row ã€‚\nJustify-content è®¾ç½® ä¸»è½´ å¯¹é½æ¨¡å¼ã€‚\nå±æ€§å€¼ è¯´æ˜ flex-start ä» å¤´éƒ¨ å¼€å§‹ â†’ flex-end ä» å°¾éƒ¨ å¼€å§‹ â† center åœ¨ä¸»è½´ å±…ä¸­ å¯¹é½ Â· space-around å¹³åˆ† å‰©ä½™ç©ºé—´ â†” space-between å…ˆä¸¤è¾¹ è´´è¾¹ å† å¹³åˆ† å‰©ä½™ç©ºé—´ï¼ˆé‡è¦ï¼‰â‡” NOTE:\né»˜è®¤å€¼ä¸º flex-start ï¼Œé¦–å…ˆç¡®å®šä¸»è½´ä½ç½® space-around ä¸å¿½ç•¥é‡å çš„ margin space-between ç›¸å½“äºå¿½ç•¥ä¸¤ä¾§è´´è¾¹å…ƒç´  margin çš„ space-around Align-items è®¾ç½® ä¾§è½´ å¯¹é½æ¨¡å¼ã€‚\nåœ¨å­é¡¹ä¸º å•è¡Œ çš„æ—¶å€™ä½¿ç”¨ã€‚\nå±æ€§å€¼ è¯´æ˜ flex-start ä»ä¸Šåˆ°ä¸‹ â†“ flex-end ä»ä¸‹åˆ°ä¸Š â†‘ center å‚ç›´å±…ä¸­ Â· stretch æ‹‰ä¼¸ â‡… Align-content è®¾ç½® ä¾§è½´ å¯¹é½æ¨¡å¼ã€‚\nåœ¨å­é¡¹ä¸º å¤šè¡Œ çš„æ—¶å€™ä½¿ç”¨ï¼ˆå­é¡¹æ‰“å¼€æ¢è¡ŒåŠŸèƒ½ï¼‰ã€‚\nå±æ€§å€¼ è¯´æ˜ flex-start åœ¨ä¾§è½´çš„å¤´éƒ¨å¼€å§‹æ’åˆ— â†“ flex-end åœ¨ä¾§è½´çš„å°¾éƒ¨å¼€å§‹æ’åˆ— â†‘ center åœ¨ä¾§è½´ä¸­é—´æ˜¾ç¤º Â· space-around å­é¡¹åœ¨ä¾§è½´å¹³åˆ†å‰©ä½™ç©ºé—´ â†• space-between å­é¡¹åœ¨ä¾§è½´å…ˆåˆ†å¸ƒåœ¨ä¸¤å¤´ï¼Œå†å¹³åˆ†å‰©ä½™ç©ºé—´ â‡• stretch æ‹‰ä¼¸ å­é¡¹å…ƒç´ ä»¥å¹³åˆ†çˆ¶å…ƒç´ é«˜åº¦ â‡… Flex container align-content: center; \u0026middot; flex-wrap: wrap; \u0026crarr; Item0 Item1 Item2 Item3 Item4 Item5 NOTE: align-items å’Œ align-content åŒºåˆ«\nalign-items é€‚ç”¨äº å•è¡Œ æƒ…å†µï¼Œåªæœ‰ä¸Šå¯¹é½ã€ä¸‹å¯¹é½ã€å±…ä¸­å’Œæ‹‰ä¼¸ align-content é€‚ç”¨äº å¤šè¡Œ æƒ…å†µï¼ˆå•è¡Œæ— æ•ˆï¼‰ï¼Œå¯ä»¥è®¾ç½®ä¸Šå¯¹é½ã€ä¸‹å¯¹é½ã€å±…ä¸­ã€æ‹‰ä¼¸ä»¥åŠå¹³å‡åˆ†é…å‰©ä½™ç©ºé—´ç­‰å±æ€§å€¼ Flex-wrap é»˜è®¤æƒ…å†µä¸‹ï¼Œflex å¸ƒå±€ä¸­é»˜è®¤æ˜¯ ä¸æ¢è¡Œ çš„ï¼Œæ’åœ¨ä¸€æ¡çº¿ï¼ˆè½´çº¿ï¼‰ä¸Šï¼›å¦‚æœè£…ä¸å¼€ï¼Œä¼šç¼©å° å­å…ƒç´  çš„å®½åº¦ï¼Œæ”¾åˆ° ä¸€è¡Œ å½“ä¸­ã€‚\nå±æ€§å€¼ è¯´æ˜ nowrap ä¸æ¢è¡Œ â†’ wrap æ¢è¡Œ â†µ Flex-flow æ˜¯ flex-direction å’Œ flex-wrap çš„ å¤åˆå±æ€§ ã€‚\nflex-flow: column wrap; /* æŠŠè®¾ç½®ä¸»è½´æ–¹å‘å’Œæ˜¯å¦æ¢è¡Œç®€å†™ */ å­é¡¹ ä»¥ä¸‹ 3 ä¸ªå±æ€§æ˜¯å¯¹å­å…ƒç´ è®¾ç½®çš„\nå±æ€§ æè¿° flex å­é¡¹ç›®å çš„ä»½æ•° align-self æ§åˆ¶å­é¡¹ç›®åœ¨ä¾§è½´çš„æ’åˆ—æ–¹å¼ order å®šä¹‰å­é¡¹çš„æ’åˆ—é¡ºåºï¼ˆå‰åé¡ºåºï¼‰ Flex å®šä¹‰å­é¡¹ç›®å å‰©ä½™ç©ºé—´åˆ†åˆ°çš„ ä»½æ•° ã€‚\n.item { flex: \u0026lt;number\u0026gt;; /* default: 0 */ } \u0026lt;style\u0026gt; section { width: 100%;height: 150px; display: flex; background-color: pink; } section \u0026gt; div:nth-child(1), section \u0026gt; div:nth-child(2), section \u0026gt; div:nth-child(3) { background-color: purple; margin: .5em; } section \u0026gt; div:nth-child(1), section \u0026gt; div:nth-child(3) { width: 17%; } section \u0026gt; div:nth-child(2) { /* è®¾ç½®ä¸º1å æ»¡å…¨éƒ¨å®½åº¦ï¼ˆå‰©ä½™é¢ç§¯å 1ä»½ï¼‰ */ flex: 1; } \u0026lt;/style\u0026gt; \u0026lt;section\u0026gt; \u0026lt;div\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/section\u0026gt; flex: 1 flex: 2 flex: 1 flex: 1 align-self å•ç‹¬ æ§åˆ¶å­é¡¹åœ¨ä¾§è½´ä¸Šçš„æ’åˆ—æ–¹å¼ã€‚\nalign-self å±æ€§å…è®¸ å•ä¸ªé¡¹ç›® æœ‰ä¸å…¶ä»–é¡¹ç›® ä¸ä¸€æ · çš„å¯¹é½æ–¹å¼ï¼Œå¯è¦†ç›–align-items å±æ€§ã€‚é»˜è®¤å€¼ä¸º auto ï¼Œè¡¨ç¤ºç»§æ‰¿çˆ¶å…ƒç´ çš„ align-items å±æ€§ã€‚å¦‚æœæ²¡æœ‰çˆ¶å…ƒç´ ï¼Œåˆ™ç­‰åŒäº stretch ã€‚\norder å®šä¹‰é¡¹ç›®çš„ æ’åˆ—é¡ºåº ã€‚\né»˜è®¤ä¸º 0 ï¼Œæ•°å€¼è¶Šå°è¶Šé å‰ï¼Œå’Œ z-index ä¸ä¸€æ ·ã€‚\nä¼˜åŒ– Image Sprites æµè§ˆå™¨ å‘é€è¯·æ±‚ ------\u0026gt; æ¥å—è¯·æ±‚ \u0026lt;------ æœåŠ¡å™¨ ä¸€ä¸ªç½‘é¡µä¸­å¾€å¾€ä¼šåº”ç”¨å¾ˆå¤šå°çš„èƒŒæ™¯å›¾åƒä½œä¸ºä¿®é¥°ï¼Œå½“ç½‘é¡µä¸­çš„å›¾åƒè¿‡å¤šæ—¶ï¼ŒæœåŠ¡å™¨å°±ä¼šé¢‘ç¹åœ°æ¥æ”¶å’Œå‘é€è¯·æ±‚å›¾ç‰‡ï¼Œé€ æˆæœåŠ¡å™¨è¯·æ±‚å‹åŠ›è¿‡å¤§ï¼Œè¿™å°†å¤§å¤§é™ä½é¡µé¢çš„åŠ è½½é€Ÿåº¦ã€‚\nImage sprites are used in numerous web apps where multiple images are used. Rather than include each image as a separate image file, it is much more memory- and bandwidth-friendly to send them as a single image; using background position as a way to distinguish between individual images in the same image file, so the number of HTTP requests is reduced.\nå°†ç½‘é¡µä¸­çš„ä¸€äº› å°èƒŒæ™¯å›¾åƒ æ•´åˆåˆ°ä¸€å¼  å¤§å›¾ ä¸­ï¼Œè¿™æ—¶æµè§ˆå™¨åªéœ€è¯·æ±‚ä¸€æ¬¡ é€šè¿‡ background-position æ¥æ§åˆ¶æ˜¾ç¤ºç‰¹å®šä½ç½® ç§»åŠ¨çš„è·ç¦»å°±æ˜¯è¿™ä¸ªå›¾ç‰‡çš„åæ ‡ã€‚æ³¨æ„ç½‘é¡µä¸­çš„åæ ‡ä¸åŒï¼ˆåŸç‚¹åœ¨å·¦ä¸Šè§’ï¼Œå›¾ç‰‡ å‘å·¦/ä¸Šåç§» åˆ™åœ°å€ä¸ºè´Ÿå€¼ï¼‰ 1 2 3 4 5 1 2 3 1 2 1 background-position: xåç§» yåç§» /* ä»å·¦ä¸Šè§’å¼€å§‹è®¡ç®— */ å­—ä½“å›¾æ ‡ æœ€åˆçš„å­—ä½“å›¾æ ‡ä½¿ç”¨çš„æ˜¯ ç²¾çµå›¾ ï¼Œä½†ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼š\nå›¾ç‰‡æ–‡ä»¶æœ¬èº«è¾ƒå¤§ å›¾ç‰‡æ”¾å¤§ç¼©å°ä¼šå¼•å‘ å¤±çœŸ ä¸€æ—¦å›¾ç‰‡åˆ¶ä½œå®Œæˆåæ›´æ¢å°†ä¼šå˜å¾—éå¸¸å¤æ‚ æ­¤æ—¶ï¼Œä¸€ç§æŠ€æœ¯çš„å‡ºç°å®Œç¾è§£å†³äº†ä»¥ä¸Šé—®é¢˜ï¼š iconfont ã€‚\nå­—ä½“å›¾æ ‡å¯ä»¥ä¸ºå‰ç«¯å·¥ç¨‹å¸ˆæä¾›ä¸€ç§æ–¹ä¾¿é«˜æ•ˆçš„å›¾æ ‡æ˜¾ç¤ºæ–¹å¼ï¼Œå±•ç¤ºçš„æ˜¯ å›¾æ ‡ ï¼Œè€Œæœ¬è´¨å±äº å­—ä½“ ã€‚æ–‡å­—æ”¾å¤§ç¼©å°ä¸ä¼šå‘ç”Ÿå¤±çœŸã€‚\nä¼˜ç‚¹ï¼š\nè½»é‡çº§ï¼šä¸€ä¸ªå›¾æ ‡å­—ä½“è¦æ¯”ä¸€ç³»åˆ—çš„å›¾åƒè¦å°ã€‚ä¸€æ—¦å­—ä½“åŠ è½½äº†ï¼Œå›¾æ ‡å°±ä¼šé©¬ä¸Šæ¼”æŸ“å‡ºæ¥ï¼Œå‡å°‘äº†æœåŠ¡å™¨è¯·æ±‚\nçµæ´»æ€§ï¼šæœ¬è´¨å…¶å®æ˜¯ æ–‡å­— ï¼Œå¯ä»¥éšæ„çš„æ”¹å˜é¢œè‰²ã€äº§ç”Ÿé˜´å½±ã€é€æ˜æ•ˆæœã€æ—‹è½¬ç­‰\nå…¼å®¹æ€§\u0010ï¼šå‡ ä¹æ”¯æŒæ‰€æœ‰çš„æµè§ˆå™¨ï¼Œ\nNOTE: å­—ä½“å›¾æ ‡ä¸èƒ½æ›¿ä»£ç²¾çµæŠ€æœ¯ï¼Œåªæ˜¯å¯¹å·¥ä½œä¸­å›¾æ ‡éƒ¨åˆ†æŠ€æœ¯çš„æå‡å’Œä¼˜åŒ–\nå­—ä½“å›¾æ ‡æ¨èä¸‹è½½ç½‘ç«™ï¼š\nicomoon å­—åº“ https://icomoon.io/ https://icomoon.io/app/#/select å¯ä»¥è‡ªå®šä¹‰å­—ä½“åŒ… å›½å¤–æœåŠ¡å™¨ã€ç§ç±»é½å…¨ é˜¿é‡Œ iconfont å­—åº“ https://iconfont.cn/ ä¸åŒæµè§ˆå™¨æ‰€æ”¯æŒçš„å­—ä½“æ ¼å¼æ˜¯ä¸ä¸€æ ·çš„.å­—ä½“å›¾æ ‡ä¹‹æ‰€ä»¥å…¼å®¹,å°±æ˜¯å› ä¸ºåŒ…å«äº†ä¸»æµæµè§ˆå™¨æ”¯æŒçš„å­—ä½“æ–‡ä»¶ã€‚\nTureType .TTF æ ¼å¼\nTTF å­—ä½“æ˜¯ Windows å’Œ Mac çš„æœ€å¸¸è§çš„å­—ä½“ã€‚æ”¯æŒè¿™ç§å­—ä½“çš„æµè§ˆå™¨æœ‰IE9+ã€Firefox3.5+ã€ Chrome4+ã€Safari3+ã€Opera10+ã€iOS Mobileã€Safari4.2+ Web Open Font Format .WOFF æ ¼å¼\n- WOFF å­—ä½“ï¼Œæ”¯æŒè¿™ç§å­—ä½“çš„æµè§ˆå™¨æœ‰IE9+ã€ Firefox3.5+ï¼ŒChrome6+ã€ Safari3.6+ã€Opera11.1+ Embedded Open Type .EOT æ ¼å¼ã€‚ - EOT å­—ä½“æ˜¯ IE ä¸“ç”¨å­—ä½“ã€æ”¯æŒè¿™ç§å­—ä½“çš„æµè§ˆå™¨æœ‰ IE4+ SVG .SVG æ ¼å¼ SVGå­—ä½“æ˜¯åŸºäºSVGå­—ä½“æ¼”æŸ“çš„ä¸€ç§æ ¼å¼ï¼Œæ”¯æŒè¿™ç§å­—ä½“çš„æµè§ˆå™¨æœ‰Chrome4+ã€Safari3.1+ã€ Opera10.0+ã€iOS Mobile Safari3.2+ ä½¿ç”¨æ–¹æ³•ï¼š\nåœ¨ CSS æ ·å¼ä¸­å…¨å±€å£°æ˜å­—ä½“ï¼šæŠŠè¿™äº›å­—ä½“æ–‡ä»¶é€šè¿‡ CSS å¼•å…¥åˆ°æˆ‘ä»¬é¡µé¢ä¸­ã€‚ æ³¨æ„å­—ä½“æ–‡ä»¶è·¯å¾„çš„é—®é¢˜ã€‚å­—ä½“å›¾æ ‡æ”¯æŒå½©è‰²ï¼Œç±»ä¼¼äº emoji ã€‚\n/* å¼•å…¥å­—ä½“å®¶æ— */ @font-face { font-family: \u0026#39;icomoon\u0026#39;; src: url(\u0026#39;fonts/icomoon.eot?7kkyc2\u0026#39;); src: url(\u0026#39;fonts/icomoon.eot?7kkyc2 #iefix\u0026#39;) format(\u0026#39;embedded-opentype\u0026#39;), url(\u0026#39;fonts/icomoon.ttf?7kkyc2\u0026#39;) format(\u0026#39;truetype\u0026#39;), url(\u0026#39;fonts/icomoon.woff?7kkyc2) format(\u0026#39;woff\u0026#39;), url(\u0026#39;fonts/icomoon.svg?7kkyc2#icomoon\u0026#39;) format(\u0026#39;svg\u0026#39;); font-weight: normal; font-style: normal; } \u0026lt;style\u0026gt; /* é…ç½®å­—ä½“ */\ticonfont { font-family: \u0026#39;iconmooon\u0026#39; } \u0026lt;/style\u0026gt; \u0026lt;span\u0026gt;å­—ä½“å›¾æ ‡ä¸“ç”¨å­—ç¬¦\u0026lt;/span\u0026gt; \u0026lt;span\u0026gt;\u0026amp;#64;\u0026lt;/span\u0026gt; Unicode æ— å…¼å®¹æ€§é—®é¢˜ã€‚åœ¨ iconfont ç±»è®¾ç½® icon-family å±æ€§ä¸ºä¸“æœ‰å›¾æ ‡å­—ä½“ã€‚\n\u0026lt;span class=\u0026#34;iconfont\u0026#34;\u0026gt;î˜¾\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026#34;iconfont\u0026#34;\u0026gt;îšš\u0026lt;/span\u0026gt; \u0026lt;br\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; Font-class å’Œç¬¬ä¸€ä¸ªçš„åŒºåˆ«æ˜¯åœ¨ä¸“é—¨çš„ class å­˜æ”¾è¿™äº›å†…å®¹ã€‚è¿™ç§æ–¹å¼åœ¨å®é™…åº”ç”¨ä¸­å¯ä»¥ç»“åˆ CSS3 æ–°å¢çš„ä¼ªå…ƒç´ é€‰æ‹©å™¨ä¸€èµ·ä½¿ç”¨ï¼Œæ¯”å¦‚ç›´æ¥å°†ä¼ªå…ƒç´ é€‰æ‹©å™¨ ::before çš„ content è®¾ç½®ä¸º \\e63e; ã€‚\nNOTE: éœ€è¦è½¬æ¢ä¸º CSS ä¸“æœ‰ Unicode è¡¨ç¤ºï¼Œå³ $#x éœ€è¦æ”¹ä¸º \\ ã€‚ï¼ˆå…·ä½“è§ä¸‹ä¸€èŠ‚ï¼‰\n\u0026lt;span class=\u0026#34;iconfont iconTips\u0026#34;\u0026gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026#34;iconfont iconWarning\u0026#34;\u0026gt;\u0026lt;/span\u0026gt; Symbol SVG \u0026lt;symbol\u0026gt; å…ƒç´ å®šä¹‰å¯é‡å¤ä½¿ç”¨çš„ç¬¦å·ã€‚é™¤éè¢« \u0026lt;use\u0026gt; å…ƒç´ å¼•ç”¨, å¦åˆ™åµŒå¥—åœ¨ \u0026lt;symbol\u0026gt; å†…çš„å½¢çŠ¶ä¸ä¼šæ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚\nç”¨è¿™ä¸ªæ–¹æ³•æ’å…¥ SVG å­—ä½“å›¾æ ‡ã€‚\nNOTE:\nSVG åŸºäº XML åœ¨ HTML ä¸­ä½¿ç”¨éœ€è¦æŒ‡æ˜ namespace SVG2 removed the need for the xlink namespace, so instead of xlink:href you should use href. \u0026lt;!-- \u0026lt;symbol\u0026gt;å¼•å…¥ \u0026lt;use href=\u0026#34;id\u0026#34;\u0026gt;ä½¿ç”¨ --\u0026gt; \u0026lt;svg aria-hidden=\u0026#34;true\u0026#34; style=\u0026#34;position: absolute; width: 0px; height: 0px; overflow: hidden;\u0026#34;\u0026gt; \u0026lt;symbol id=\u0026#34;iconproduct-brand\u0026#34; viewBox=\u0026#34;0 0 1025 1024\u0026#34;\u0026gt;...\u0026lt;/symbol\u0026gt; \u0026lt;symbol id=\u0026#34;iconbrandbook\u0026#34; viewBox=\u0026#34;0 0 1024 1024\u0026#34;\u0026gt;...\u0026lt;/symbol\u0026gt; \u0026lt;symbol id=\u0026#34;icon08\u0026#34; viewBox=\u0026#34;0 0 1024 1024\u0026#34;\u0026gt;...\u0026lt;/symbol\u0026gt; \u0026lt;symbol id=\u0026#34;icon06\u0026#34; viewBox=\u0026#34;0 0 1024 1024\u0026#34;\u0026gt;...\u0026lt;/symbol\u0026gt; \u0026lt;symbol id=\u0026#34;iconcaihong\u0026#34; viewBox=\u0026#34;0 0 1024 1024\u0026#34;\u0026gt;...\u0026lt;/symbol\u0026gt; \u0026lt;symbol id=\u0026#34;iconshanbeng-huapo\u0026#34; viewBox=\u0026#34;0 0 1024 1024\u0026#34;\u0026gt;...\u0026lt;/symbol\u0026gt; \u0026lt;symbol id=\u0026#34;iconhuoshan\u0026#34; viewBox=\u0026#34;0 0 1024 1024\u0026#34;\u0026gt;...\u0026lt;/symbol\u0026gt; \u0026lt;symbol id=\u0026#34;iconhuozai\u0026#34; viewBox=\u0026#34;0 0 1024 1024\u0026#34;\u0026gt;...\u0026lt;/symbol\u0026gt; \u0026lt;symbol id=\u0026#34;icontaiyang\u0026#34; viewBox=\u0026#34;0 0 1024 1024\u0026#34;\u0026gt;...\u0026lt;/symbol\u0026gt; \u0026lt;/svg\u0026gt; \u0026lt;svg class=\u0026#34;icon\u0026#34; aria-hidden=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;use href=\u0026#34;#iconcaihong\u0026#34;\u0026gt;\u0026lt;/use\u0026gt; \u0026lt;!-- obsoleted expression --\u0026gt; \u0026lt;!-- \u0026lt;use xlink:href=\u0026#34;#iconcaihong\u0026#34;\u0026gt;\u0026lt;/use\u0026gt; --\u0026gt; \u0026lt;/svg\u0026gt; \u0026lt;svg class=\u0026#34;icon\u0026#34; aria-hidden=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;use href=\u0026#34;#icon08\u0026#34;\u0026gt;\u0026lt;/use\u0026gt; \u0026lt;/svg\u0026gt; \u0026lt;!-- \u0026lt;symbol\u0026gt;çš„idå±æ€§å®šä¹‰äº†ç¬¦å·çš„å”¯ä¸€åç§°--\u0026gt; \u0026lt;!-- idå±æ€§æ˜¯\u0026lt;symbol\u0026gt;å…ƒç´ æ‰€å¿…éœ€çš„ --\u0026gt; \u0026lt;!-- å› æ­¤ä»¥åå¯ä»¥ç”±\u0026lt;use\u0026gt;å…ƒç´ å¼•ç”¨ç›¸åº”å­—ä½“å›¾æ ‡ --\u0026gt; ä¸‰è§’å½¢ ç½‘é¡µä¸­ä¸€äº›å¸¸è§ä¸‰è§’å½¢å¯é€šè¿‡ CSS æ§åˆ¶ border å±æ€§ç›´æ¥ç”»å‡ºï¼š\n.box1 { border-top: 5vh solid rgb(60, 186, 84); border-bottom: 5vh solid rgb(244, 194, 13); border-left: 5vh solid rgb(219, 50, 54); border-right: 5vh solid rgb(72, 133, 237); } .box2 { height: 0; width: 0; border: 5vh solid transparent; /* è®¾ç½®å…¶å®ƒéƒ¨åˆ†ä¸ºé€æ˜è¾¹æ¡† */ border-top-color: rgb(60, 186, 84); /* å…¼å®¹ä½ç‰ˆæœ¬æµè§ˆå™¨ */ line-height: 0; font-size: 0; } display: block å››è‰²è¾¹æ¡† å•è¾¹æ¡† ä¸‰è§’å½¢ display: block å››è‰²è¾¹æ¡† å•è¾¹æ¡† ä¸‰è§’å½¢ â€»: è¿™ä¸ªç‰ˆæœ¬ä½¿ç”¨ border-image-slice ä¸ border-image-source:conic-gradient æ§åˆ¶ æ¢¯å½¢ .triangle { /* åªæœ‰æœ€é¡¶ä¸Šçš„è¾¹æœ‰é¢œè‰² */ border-color: rgb(72, 133, 237) transparent transparent transparent; border-style: solid; /* æ§åˆ¶ä¸‰è§’å½¢çš„å®½é«˜ï¼ˆåªæ˜¾ç¤ºçŸ©å½¢çš„å³ä¸Šè§’ï¼‰ */ border-width: 10vh 5vh 0 0; } åº•è¾¹è¾¹é•¿ä¸º0 ç›´è§’ä¸‰è§’å½¢ æ§åˆ¶é¡¶è¾¹é•¿åº¦ å’ŒçŸ©å½¢åˆå¹¶ çŸ©å½¢ æœ€ç»ˆæ•ˆæœå›¾\nÂ¥888 Â¥1888 NOTEï¼š è‹¥æ·»åŠ æµ®åŠ¨åçˆ¶ç›’å­æ— æ³•æ­£ç¡®åŒ…è£¹å­ç›’å­ï¼Œåˆ™åœ¨æµ®åŠ¨å…ƒç´ å‰åæ·»åŠ clear: both æ¸…é™¤æµ®åŠ¨å…ƒç´ ã€‚\nVertical-align vertical-align: ç”¨äºè®¾ç½® å›¾ç‰‡ æˆ–è€… è¡¨å• ï¼ˆè¡Œå†…å—å…ƒç´ ï¼‰å’Œæ–‡å­— å‚ç›´å¯¹é½ã€‚\nç”¨äºè®¾ç½®ä¸€ä¸ªå…ƒç´ çš„å‚ç›´å¯¹é½æ–¹å¼ï¼Œä½†åªå¯¹ è¡Œå†…å…ƒç´  å’Œ è¡Œå†…å—å…ƒç´  æœ‰æ•ˆã€‚\nvertical-align: baseline | top | middle | bottom å€¼ æè¿° baseline é»˜è®¤ã€‚å…ƒç´ æ”¾ç½®åœ¨çˆ¶å…ƒç´ çš„åŸºçº¿ä¸Š top æŠŠå…ƒç´ çš„é¡¶ç«¯ä¸è¡Œä¸­æœ€é«˜å…ƒç´ çš„é¡¶éƒ¨å¯¹é½ middle æŠŠæ­¤å…ƒç´ æ”¾ç½®åœ¨çˆ¶å…ƒç´ çš„ä¸­éƒ¨ bottom æŠŠå…ƒç´ çš„ é¡¶ç«¯ ä¸è¡Œä¸­ æœ€ä½çš„å…ƒç´  çš„é¡¶ç«¯å¯¹é½ ä¸­æ–‡å­—ç¬¦ é¡¶çº¿ top line ä¸­çº¿ top line åŸºçº¿ base line åº•çº¿ bottom line ğŸ“ Note å›¾ç‰‡ã€è¡¨å•éƒ½å±äº è¡Œå†…å—å…ƒç´  ï¼Œé»˜è®¤çš„ vertically-align æ˜¯ åŸºçº¿å¯¹é½ ï¼ˆ baselineï¼‰ã€‚\nè§£å†³åŠæ³•ï¼š\nç»™å›¾ç‰‡æ·»åŠ  vertical-align: middle | top | bottom ç­‰åªè¦ä¸æ˜¯ åŸºçº¿å¯¹é½ å³å¯ æŠŠå›¾ç‰‡è½¬æ¢ä¸º å—çº§å…ƒç´  display: block Lorem ipsum dolor sit amet bug:å›¾ç‰‡åº•ä¾§ä¼šæœ‰ä¸€ä¸ªç©ºç™½ç¼éš™ï¼ŒåŸå› æ˜¯è¡Œå†…å—å…ƒç´ ä¼šå’Œæ–‡å­—çš„åŸºçº¿å¯¹é½ã€‚ Lorem ipsum dolor sit amet ğŸ“ Note vertically-align: middle å¯¹ inline-block è®¾ç½®æ— æ•ˆåŸç†\ndisplay: inline-blockå°†å¯¹è±¡å‘ˆé€’ä¸º å†…è”å¯¹è±¡ ï¼Œä½†æ˜¯å¯¹è±¡çš„å†…å®¹ä½œä¸º å—å¯¹è±¡ ï¼ˆvertically-align è®¾ç½®æ— æ•ˆï¼‰å‘ˆé€’ã€‚æ—è¾¹çš„ å†…è”å¯¹è±¡ ä¼šè¢«å‘ˆé€’åœ¨ åŒä¸€è¡Œ ï¼ˆè¡Œå†…å…ƒç´ ï¼‰å†…ã€‚\nè§£å†³åŠæ³•ï¼š\nå¦‚æœæˆ‘ä»¬å°† display å±æ€§è®¾ç½®ä¸º table-cell ï¼Œå°† å—å…ƒç´  è½¬åŒ–ä¸º å•å…ƒæ ¼ ï¼Œç„¶ååŠ ä¸Š vertical-align:middle \u0026amp; text-align: center å³å¯å±…ä¸­ æˆ–è€…å¯ä»¥è®¾ç½®è¡Œé«˜å³ line-height ï¼Œä½†æ˜¯è¦æ³¨æ„ï¼Œè¦ä¸ div çš„é«˜åº¦ä¸€è‡´ \u0026lt;style\u0026gt; textarea { vertically-align: center; } \u0026lt;/style\u0026gt; \u0026lt;textarea cols=\u0026#34;30\u0026#34; rows=\u0026#34;10\u0026#34;\u0026gt;\u0026lt;/textarea\u0026gt;è¯·æ‚¨ç•™è¨€ æº¢å‡ºæ§åˆ¶ å•è¡Œæ–‡æœ¬æº¢å‡ºæ˜¾ç¤ºçœç•¥å·\n/* 1. å…ˆå¼ºåˆ¶ä¸€è¡Œå†…æ˜¾ç¤ºæ–‡æœ¬ -\u0026gt; é»˜è®¤å±æ€§ normal è‡ªåŠ¨æ¢è¡Œ \u0026lt;- */ white-space: nowrap; /* 2. è¶…å‡ºçš„éƒ¨åˆ†éšè— */ overflow: hidden; /* 3. æ–‡å­—ç”¨çœç•¥å·æ›¿ä»£è¶…å‡ºçš„éƒ¨åˆ† */ text-overflow: ellipsis; Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas eget justo turpis. Duis consequat, quam sit amet convallis convallis, nulla neque condimentum orci, rhoncus euismod enim nisi vel erat. Curabitur vel maximus massa. Praesent ut accumsan lectus, ac laoreet sapien. Aliquam porttitor, lacus at consequat vestibulum, justo å¤šè¡Œæ–‡æœ¬æº¢å‡ºæ˜¾ç¤ºçœç•¥å· å­˜åœ¨è¾ƒå¤§å…¼å®¹æ€§é—®é¢˜ï¼Œåªé€‚ç”¨äº WebKit å†…æ ¸æµè§ˆå™¨ / ç§»åŠ¨ç«¯\næ›´æ¨èè®©åå°äººå‘˜æ¥åšè¿™ä¸ªæ•ˆæœï¼Œå› ä¸ºåå°äººå‘˜å¯ä»¥è®¾ç½®æ˜¾ç¤ºå¤šå°‘ä¸ªå­—ï¼Œæ“ä½œæ›´åŠ ç®€å•\noverflow: hidden; text-overflow: ellipsis; /* 1. å¼¹æ€§ä¼¸ç¼©ç›’å­æ¨¡å‹æ˜¾ç¤º */ display: -webkit-box; /* 2. é™åˆ¶åœ¨ä¸€ä¸ªå—å…ƒç´ æ˜¾ç¤ºçš„æ–‡æœ¬çš„è¡Œæ•° */ -webkit-line-clamp: 2; /* 3. è®¾ç½®æˆ–æ£€ç´¢ä¼¸ç¼©ç›’å­å¯¹è±¡çš„å­å…ƒç´ æ’åˆ—æ–¹å¼ */ -webkit-box-orient: vertical; Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas eget justo turpis. Duis consequat, quam sit amet convallis convallis, nulla neque condimentum orci, rhoncus euismod enim nisi vel erat. Curabitur vel maximus massa. Praesent ut accumsan lectus, ac laoreet sapien. Aliquam porttitor, lacus at consequat vestibulum, justo åˆå§‹åŒ– ä¸åŒæµè§ˆå™¨å¯¹æœ‰äº›æ ‡ç­¾çš„ é»˜è®¤å€¼ æ˜¯ä¸åŒçš„ã€‚ä¸ºäº†æ¶ˆé™¤ä¸åŒæµè§ˆå™¨å¯¹ HTML æ–‡æœ¬å‘ˆç°çš„å·®å¼‚ï¼Œç…§é¡¾æµè§ˆå™¨çš„å…¼å®¹ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ CSS è¿›è¡Œ åˆå§‹åŒ–\nCSS Resetï¼Œä¹Ÿå³é‡è®¾æµè§ˆå™¨çš„æ ·å¼ æ¯ä¸ªç½‘é¡µéƒ½å¿…é¡»å…ˆè¿›è¡Œ CSS åˆå§‹åŒ– å¸¸è§ CSS åˆå§‹åŒ–æ ·å¼ï¼š\n* { /* æŠŠæ‰€æœ‰æ ‡ç­¾çš„å†…å¤–è¾¹è·æ¸…é›¶ */ margin: 0; padding: 0; /* å°†æ‰€æœ‰å…ƒç´ çš„ç›’å­æ¨¡å‹éƒ½ä¿®æ”¹ä¸ºborder-box */ box-sizing: border-box; } em, i { /* æ–œä½“æ–‡å­—ä¸å€¾æ–œ */ font-style: normal; } /* å»æ‰åˆ—è¡¨çš„å°åœ†ç‚¹ */ li { list-style: none; } img { /* å…¼å®¹ä½ç‰ˆæœ¬æµè§ˆå™¨ï¼Œå¦‚æœå›¾ç‰‡åŒ…å«é“¾æ¥æœ‰è¾¹æ¡†é—®é¢˜ */ border: 0; /* ä½¿å³ä¾§æ–‡å­—ä¸å›¾ç‰‡çš„ä¸­å¿ƒå¯¹é½ï¼Œå–æ¶ˆå›¾ç‰‡åº•ä¾§æœ‰ç©ºç™½ç¼éš™çš„é—®é¢˜ */ vertical-align: middle; } button { /* ç»è¿‡æ—¶é¼ æ ‡å˜æˆå°æ‰‹ */ cursor: pointer; } a { color: #666; text-decoration: none; } a:hover { color: #c81623; } button, input { font-family: \u0026#34;Microsoft YaHei\u0026#34;, \u0026#34;Heiti SC\u0026#34;, sans-serif; } body { ---webkit-font-smoothing: antialiased; background-color: #fff; font-size: 12px; color: #666; } .hide, .none { display: none; } .clearfix { *zoom: 1; } .clearfix:after { visibility: hidden; clear: both; content: \u0026#34;.\u0026#34;; display: block; height: 0; } NOTE: æŠŠä¸­æ–‡å­—ä½“çš„åç§°ç”¨ç›¸åº”çš„ Unicode ç¼–ç æ¥ä»£æ›¿ï¼Œè¿™æ ·å°±å¯ä»¥æœ‰æ•ˆçš„é¿å…æµè§ˆå™¨è§£é‡Š CSS ä»£ç æ—¶å€™å‡ºç°ä¹±ç çš„é—®é¢˜ã€‚\næ¯”å¦‚è½½å…¥å­—ä½“æ—¶ï¼š\né»‘ä½“ \\9ED1\\4F53 å®‹ä½“ \\5B8B\\4F53 å¾®è½¯é›…é»‘\\5FAE\\8F6F\\96C5\\9ED1 ç§»åŠ¨ç«¯CSSåˆå§‹åŒ–æ¨èä½¿ç”¨ normalize.css\næ¨¡å—åŒ–ï¼Œä¿æŠ¤æœ‰ä»·å€¼çš„é»˜è®¤å€¼ ä¿®å¤æµè§ˆå™¨çš„bug å®˜ç½‘åœ°å€: http://necolas.github.io/normalize.css/\n/*CSS3ç›’å­æ¨¡å‹*/ box-sizing: border-box; -webkit-box-sizing: border-box; /*ç‚¹å‡»é«˜äº®æˆ‘ä»¬éœ€è¦æ¸…é™¤æ¸…é™¤ è®¾ç½®ä¸ºtransparentå®Œæˆé€æ˜*/ -webkit-tap-highlight-color: transparent; /*IOSä¸ŠåŠ ä¸Šè¿™ä¸ªå±æ€§æ‰èƒ½ç»™æŒ‰é’®å’Œè¾“å…¥æ¡†è‡ªå®šä¹‰æ ·å¼*/ -webkit-appearance: none; /*ç¦ç”¨é•¿æŒ‰é¡µé¢æ—¶çš„å¼¹å‡ºèœå•*/ img, a { -webkit-touch-callout: none; } å…¼å®¹ æ–°å¢çš„ CSS3 ç‰¹æ€§æœ‰å…¼å®¹æ€§é—®é¢˜ï¼Œ IE9+ æ‰æ”¯æŒ\nç§»åŠ¨ç«¯çš„æ”¯æŒä¼˜äº PC ç«¯ æ»¤é•œ CSS3 ä¸­çš„ filter å±æ€§å°†æ¨¡ç³Šæˆ–è€…é¢œè‰²åç§»ç­‰æ•ˆæœåº”ç”¨äºå…ƒç´ \nfilter: fun(); æ¨¡ç³Š\nblur æ¨¡ç³Šå¤„ç† æ•°å€¼è¶Šå¤§è¶Šæ¨¡ç³Š\nfilter: blur(5px); è½¬æ¢ 2Dè½¬æ¢ è½¬æ¢ï¼ˆ transform ï¼‰æ˜¯ CSS3 ä¸­å…·æœ‰é¢ è¦†æ€§çš„ç‰¹å¾ä¹‹ä¸€ï¼Œå¯ä»¥å®ç°å…ƒç´ çš„ä½ç§»ã€æ—‹è½¬ã€ç¼©æ”¾ç­‰æ•ˆæœã€‚\nå¯ä»¥ç®€å•ç†è§£ä¸ºå˜å½¢ï¼›åæ ‡ä»ç„¶ä»å·¦ä¸Šè§’å¼€å§‹ã€‚\ntranslate ç§»åŠ¨\ntransform: translate(x,y); transform: translateX(n); transform: translateY(n); /* =\u0026gt; å®šä¹‰2Dè½¬æ¢ä¸­çš„ç§»åŠ¨ï¼Œæ²¿ç€Xå’ŒYè½´ç§»åŠ¨å…ƒç´  =\u0026gt; æœ€å¤§ä¼˜ç‚¹ï¼šä¸ä¼šå½±å“å…¶å®ƒå…ƒç´ çš„ä½ç½® -\u0026gt; å½“ç„¶ï¼Œpositionä¹Ÿä¸ä¼šå½±å“ -\u0026gt; ä½†æ˜¯ï¼Œä½¿ç”¨transformä¼šæ¯”topå°‘ä¸€ä¸ªlayoutå»¶æ—¶ -\u0026gt; ç»è¿‡æµ‹è¯•ï¼ŒTRANSFORMæ€§èƒ½æ¶ˆè€—åªæœ‰positionçš„ååˆ†ä¹‹ä¸€ï¼å¯æƒ³è€ŒçŸ¥ï¼ŒCSS3æ¨å‡ºæ–°çš„transformå±æ€§ä¹Ÿæ˜¯åŠ å¿«äº†æµè§ˆå™¨çš„è¿è¡Œé€Ÿåº¦ã€‚ =\u0026gt; translateä¸­çš„ç™¾åˆ†æ¯”å•ä½æ˜¯ç›¸å¯¹äºè‡ªèº«å…ƒç´ çš„translate:(50%, 50%); =\u0026gt; å¯¹è¡Œå†…æ ‡ç­¾æ²¡æœ‰æ•ˆæœ */ rotate æ—‹è½¬\nscale ç¼©æ”¾\ntransform: translate() transform: rotate() transform: scale() NOTE: åœ¨æ”¯æŒ CSS3 å±æ€§çš„ç°ä»£æµè§ˆå™¨å½“ä¸­ï¼Œå¯ä»¥åˆ©ç”¨ CSS3 çš„ translate å±æ€§å®ç°æ°´å¹³å‚ç›´å±…ä¸­ã€‚\nå°¤å…¶æ˜¯å½“å­å…ƒç´ çš„ width å’Œ height æœªçŸ¥æ—¶ï¼Œæ— æ³•é€šè¿‡è®¾ç½® margin-left:-width/2 å’Œ margin-top:-height/2 æ¥å®ç°ï¼Œè¿™æ—¶å€™å¯ä»¥è®¾ç½®å­å…ƒç´  position|top:50%;left:50% \u0026amp; transform:translate(-50%, -50%)ã€‚\né€šè¿‡ border ç”»ä¸‰è§’å½¢ï¼šï¼ˆæ˜¾ç¤ºä¸¤ä¸ªè¾¹ï¼Œå’Œä¸Šæ¬¡é‚£ä¸ªå®å¿ƒä¸‰è§’å½¢åŸç†ä¸åŒï¼‰\n\u0026lt;style\u0026gt; div { position: relative; width: 249px;height: 35px; border: 1px solid #000; } div::after { position: absolute; height: 10px;width: 10px; top: 50%;right: .5em; content: \u0026#34;\u0026#34;; border: solid red; border-width: 0 1px 1px 0; transform: translate(-50%, -50%) rotate(45deg); transition: ease-out .2s; } div:hover::after { transform: translate(-50%, -50%) rotate(-45deg); } \u0026lt;/style\u0026gt; \u0026lt;div\u0026gt;\u0026lt;/div\u0026gt; ä¸­å¿ƒç‚¹ transform-origin å¯ä»¥è®¾ç½®å…ƒç´ è½¬æ¢çš„ä¸­å¿ƒç‚¹\nå‚æ•° x å’Œ y ç”¨ ç©ºæ ¼ åˆ†å¼€ x y é»˜è®¤è½¬æ¢çš„ä¸­å¿ƒç‚¹æ˜¯å…ƒç´ çš„ä¸­å¿ƒç‚¹ï¼ˆ50% 50%ï¼‰ è¿˜å¯ä»¥ç»™ x y è®¾ç½® åƒç´  æˆ–è€… æ–¹ä½åè¯ ï¼ˆe.g.: top botton left right centerï¼‰ transform-origin: x y; /* é»˜è®¤å€¼50% 50% ç­‰æ•ˆäº center center */ ç¼©æ”¾ scale æ§åˆ¶å…ƒç´ æ”¾å¤§ç¼©å°\nå¯ä»¥è®¾ç½® è½¬æ¢ä¸­å¿ƒç‚¹ ç¼©æ”¾ä¸” ä¸å½±å“ å…¶å®ƒç›’å­ e.g.: é¼ æ ‡ç»è¿‡æ”¾å¤§å†…å®¹ transform: scale(x, y); /* -\u0026gt; æ”¯æŒå•å‚æ•° \u0026lt;- */ ç»¼åˆå†™æ³• åŒæ—¶ä½¿ç”¨å¤šä¸ªè½¬æ¢ï¼Œå…¶æ ¼å¼ä¸ºï¼š transform: translateO rotatep scale() å…¶é¡ºåºä¼š å½±å“ è½¬æ¢çš„æ•ˆæœã€‚(å…ˆæ—‹è½¬ä¼š æ”¹å˜åæ ‡è½´æ–¹å‘ ) å½“æˆ‘ä»¬åŒæ—¶æœ‰ä½ç§»å’Œå…¶ä»–å±æ€§çš„æ—¶å€™ï¼Œè®°å¾—è¦å°† ä½ç§» æ”¾åˆ°æœ€å‰ æ”¯æŒè´Ÿæ•°ï¼Œæ¯”å¦‚ transform: scale(-1) 3Dè½¬æ¢ xè½´: å·¦è´Ÿâ† Â· â†’å³æ­£ yè½´: ä¸Šè´Ÿâ†‘ Â· â†“ä¸‹æ­£ zè½´: å¤–æ­£â† Â· â†’å†…è´Ÿ ä¹Ÿå³ï¼šå³ã€ä¸‹ã€å¤–ä¸ºæ­£\nä½ç§» translate3d(x, y, z) æ·»åŠ äº† Z è½´æ–¹å‘\ntransform: translateX(100px); transform: translateY(100px); transform: translateZ(100px); /* ä¸€èˆ¬ç”¨pxå•ä½ */ transform: translate3d(x,y,z); /* xyzå‚æ•°ä¸èƒ½çœç•¥ï¼Œå¦‚æœæ²¡æœ‰å°±å†™0 */ æ—‹è½¬ rotate3d(x, y, z)\n3Dæ—‹è½¬å¯ä»¥è®©å…ƒç´ åœ¨ä¸‰ç»´å¹³é¢å†…æ²¿ç€ x y z è½´æˆ–è€…è‡ªå®šä¹‰è½´è¿›è¡Œæ—‹è½¬ã€‚\ntransform: rotateX(45deg); /* xè½´æ­£-\u0026gt; 45deg */ transform: rotateY(45deg); /* yè½´æ­£-\u0026gt; 45deg */ transform: rotateZ(45deg); /* zè½´æ­£-\u0026gt; 45deg */ /* æ—‹è½¬zè½´å’Œ2Dæ—‹è½¬æ–¹å¼æ˜¯ä¸€æ ·çš„ */ transform: rotate3d(x,y,z,deg); /* æ²¿ç€è‡ªå®šä¹‰è½´æ—‹è½¬degä¸ºè§’åº¦ */ /* e.g.: */ transform: rotate3d(1,0,0,deg); /* xè½´-\u0026gt; 45deg*/ transform: rotate3d(1,1,0,deg); /* å¯¹è§’çº¿-\u0026gt; 45deg*/ NOTE: æ‰“å¼€æ—‹è½¬æ•ˆæœéœ€è¦åŠ  é€è§† æ‰èƒ½æ¯”è¾ƒæ¼‚äº®çš„æ˜¾ç¤ºå‡ºæ¥ã€‚\ntransform-origin\nè®¾ç½®æ—‹è½¬çš„åŸç‚¹ï¼Œé»˜è®¤ä¸º center ã€‚\n/* One-value syntax */ transform-origin: 2px; transform-origin: bottom; /* x-offset-keyword | y-offset */ transform-origin: left 2px; /* y-offset-keyword | x-offset-keyword | z-offset */ transform-origin: bottom right 2cm; transform-origin: 10% 50% 0 é€è§† perspective é€è§† perspective åœ¨2Då¹³é¢äº§ç”Ÿç«‹ä½“è§†è§‰æ•ˆæœã€‚å†™åˆ°è¢«é€è§†å…ƒç´  çˆ¶ç›’å­ ä¸Šã€‚\næ­¤æ—¶ä¸º å­ç›’å­ æ·»åŠ  translateZ() åˆ™è·ç¦»è¿œè¿‘å°†ä¼šä½“ç°å‡ºæ¥ã€‚\nd: è§†è·ï¼Œä¹Ÿå³è·ç¦»çœ¼ç›åˆ°å±å¹•çš„è·ç¦»\nz: zè½´\n:eyes: eyes â‡† d â‡† :desktop_computer: screen â‡† z â‡† :diamond_shape_with_a_dot_inside: object\n*: é€è§†æŒ‡çš„æ˜¯è§‚å¯Ÿçš„è·ç¦»ï¼Œè·ç¦»è¶ŠçŸ­ï¼Œç«‹ä½“æ„Ÿè¶Šå¼ºã€‚\nperspective: distance; \u0026lt;style\u0026gt; .outset { perspective: 200px; height: 100px; width: 200px; transform: translateX(100px); /*background-color: #000;*/ } .outset \u0026gt; .inset { border: 1px solid #000; height: 50px; width: 100px; } \u0026lt;/style\u0026gt; \u0026lt;div class=\u0026#34;outset\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;inset\u0026#34; style=\u0026#34;transform: translateZ(0px);\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;inset\u0026#34; style=\u0026#34;transform: translateZ(25px);\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;inset\u0026#34; style=\u0026#34;transform: translateZ(50px);\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; perspective: 100px -100px +100px perspective: 200px -100px +100px perspective: 400px -100px +100px å‘ˆç° transfrom-style æ§åˆ¶å­å…ƒç´ æ˜¯å¦å¼€å¯ 3Dç«‹ä½“ç¯å¢ƒ\ntransform-style:flat: å­å…ƒç´ ä¸å¼€å¯ 3D ç«‹ä½“ç©ºé—´ é»˜è®¤ transform-style:perspective-3d: å­å…ƒç´ å¼€å¯ç«‹ä½“ç©ºé—´ ä»£ç ä»ç„¶å†™åœ¨ çˆ¶ç›’å­ ä¸Šï¼Œä½†å½±å“çš„æ˜¯ å­ç›’å­ transform-style: flat transform-style: preserve-3d e.g.1: æ”¯æŒå‰åç¿»è½¬çš„ç›’å­\n\u0026lt;style\u0026gt; .box { width: 300px;height: 300px; margin: 100px auto; position: relative; transition: all 1s; /* è®©èƒŒé¢çš„imageç´«è‰²ç›’å­ä¿ç•™ç«‹ä½“ç©ºé—´ */ transform-style: preserve-3d; } .box:hover { transform: rotateY(180deg); } .front, .back{ position: absolute; top: 0;left: 0; height: 100%;width: 100%; -webkit-border-radius: 50%;-moz-border-radius: 50%;border-radius: 50%; font-size: 30px; color: #fff; text-align: center; line-height: 300px; } .front { background-color: purple; /* å¦‚æœä¸æ‰“å¼€yè½´çš„åç§»ï¼Œ -\u0026gt; åœ¨æ–°ç‰ˆchromeé‡Œåªä¼šæ˜¾ç¤ºä¸ºä¸€ä¸ªé¢ */ transform: translateZ(1px); z-index: 1; } .back { background-color: pink; transform: rotateY(180deg); } \u0026lt;/style\u0026gt; \u0026lt;!--å¯ä»¥åœ¨æœ€å¤–å±‚æ·»åŠ é€è§†æ•ˆæœ--\u0026gt; \u0026lt;div style=\u0026#34;perspective: 400px\u0026#34;\u0026gt; \u0026lt;!--ç¿»è½¬çš„æ˜¯çˆ¶ç›’å­--\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;front\u0026#34;\u0026gt;è¿™æ˜¯\u0026lt;br\u0026gt;æ­£é¢\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;back\u0026#34;\u0026gt;è¿™æ˜¯\u0026lt;br\u0026gt;èƒŒé¢\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; é¼ æ ‡ç»è¿‡ç¿»é¢æ•ˆæœ è¿™æ˜¯\næ­£é¢ è¿™æ˜¯\nèƒŒé¢ e.g.2: 3Då¯¼èˆªæ \n\u0026lt;style\u0026gt; * { margin: 0; padding: 0; } ul { height: 30px; margin-top: 100px; } li { list-style: none; float: left; width: 100px; height: 30px; line-height: 30px; text-align: center; margin: 0 10px; perspective: 500px; } .box { position: relative; width: 100%; height: 100%; transform-style: preserve-3d; transition: all 0.3s; } .front, .bottom { width: 100%; height: 100%; } .front { background-color: orange; /* è¦ç‚¹4ï¼šçˆ¶å…ƒç´ æœ€å¼€å§‹çš„æ—‹è½¬è½´æ˜¯å¤–å¹³é¢çš„Xè½´ï¼Œä¸ºäº†å®ç°åœ¨é•¿æ–¹ä½“çš„ä¸­å¿ƒæ—‹è½¬ï¼Œ éœ€è¦å°†æœ€å¤–å±‚çš„fronté¢å’Œæœ€ä¸‹é¢çš„bottomé¢å‘Zè½´ç§»å‡ºé•¿æ–¹ä½“é«˜çš„ä¸€åŠï¼Œå¯¹åº”çš„å³ä¸ºhightçš„ä¸€åŠ */ transform: translateZ(15px); } .bottom { /* è¦ç‚¹1ï¼šå°†ä¸‹é¢çš„å…ƒç´ è®¾ç½®ç»å¯¹å®šä½ï¼Œå¹¶å‘ä¸‹ç§»åŠ¨100% */ position: absolute; top: 100%; left: 0; background-color: red; /* è¦ç‚¹2ï¼šè®¾ç½®æ—‹è½¬ä¸­å¿ƒä¸ºé¡¶éƒ¨ï¼Œå¹¶å‘åæ—‹è½¬90degï¼Œåœ¨è°ƒè¯•çš„æ—¶å€™å¯ä»¥è®¾ç½®ä¸º80degæŸ¥çœ‹æ˜¯å¦æœ‰æ•ˆæœã€‚ ä¸”éœ€è¦ä¸ºæœ€å¤–å±‚åŠ¨ç”»å…ƒç´ çš„çˆ¶å…ƒç´ æ·»åŠ é€è§†è·ç¦»perspective:500pxå®ç°3Dçš„æ•ˆæœï¼Œ å¦‚æœæ²¡æœ‰ä¸¥æ ¼æŒ‰ç…§è¦æ±‚ä¸ºâ€˜è¯¥çˆ¶å…ƒç´ â€™æ·»åŠ è¯¥å±æ€§ï¼Œåˆ™é€è§†çš„æ•ˆæœä¼šå®Œå…¨ä¸åŒ; */ transform-origin: top; transform: translateZ(15px) rotateX(-90deg); /* è¦ç‚¹2ä¹‹æ–¹æ³•äºŒï¼š */ /* transform: rotateX(-90deg) translateZ(-15px); */ } .box:hover { /* è¦ç‚¹3ï¼šä¸ºçˆ¶å…ƒç´ æ·»åŠ æ—‹è½¬æ•ˆæœï¼Œæ­¤æ—¶éœ€è¦ä¸ºè¯¥çˆ¶å…ƒç´ æ·»åŠ transform-style:preserve-3d */ transform: rotateX(90deg); } \u0026lt;/style\u0026gt; \u0026lt;ul\u0026gt; \u0026lt;li\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;front\u0026#34;\u0026gt;æ­£é¢\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;bottom\u0026#34;\u0026gt;èƒŒé¢\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/li\u0026gt; \u0026lt;li\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;front\u0026#34;\u0026gt;æ­£é¢\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;bottom\u0026#34;\u0026gt;èƒŒé¢\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/li\u0026gt; \u0026lt;li\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;front\u0026#34;\u0026gt;æ­£é¢\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;bottom\u0026#34;\u0026gt;èƒŒé¢\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; e.g.3: æ—‹è½¬æœ¨é©¬æ•ˆæœ\n\u0026lt;style\u0026gt; .container { /* å¤–éƒ¨æ–‡æ¡£æµå®šä½å®¹å™¨*/ width: 10vh; height: 10vh; position: relative; margin: auto; } .container \u0026gt; .inner { /* å†…éƒ¨åŠ¨ç”»å±…ä¸­å®¹å™¨ */ width: 7vh;height: 6vh; /* åœ¨å¤–éƒ¨å®¹å™¨ä¸­æ‰“å¼€é€è§† */ perspective: 400px; /* è®©åŠ¨ç”»åœ¨å®¹å™¨å±…ä¸­ */ position: absolute; top: 50%;left: 50%; transform: translate(-50%, -50%); } .boxes { /* å›¾ç‰‡ç»„å®¹å™¨ */ height: 100%;width: 100%; transform-style: preserve-3d; animation: rotate 10s linear infinite; } .boxes \u0026gt; .box:nth-child(1) { transform: rotateY(0deg) translateZ(120px); } .boxes \u0026gt; .box:nth-child(2) { transform: rotateY(60deg) translateZ(120px); } .boxes \u0026gt; .box:nth-child(3) { transform: rotateY(120deg) translateZ(120px); } .boxes \u0026gt; .box:nth-child(4) { transform: rotateY(180deg) translateZ(120px); } .boxes \u0026gt; .box:nth-child(5) { transform: rotateY(240deg) translateZ(120px); } .boxes \u0026gt; .box:nth-child(6) { transform: rotateY(300deg) translateZ(120px); } .box { margin: auto; width: 100%;height: 100%; top: 0;left: 0; position: absolute; /* åœ¨æ¯ä¸€å¼ å›¾ç‰‡ä¸­ä¹Ÿè¦ä¿ç•™3dæ•ˆæœ */ transform-style: preserve-3d; } .box::before, .box::after { display: block; content: \u0026#39;\u0026#39;; position: absolute; top: 0;left: 0; height: 100%;width: 100%; border-radius: 25%; text-align: center; font-size: .8em; /* è®¾ç½®è¡Œé«˜ä»¥å‚ç›´å±…ä¸­ */ line-height: 6vh; } .box::before { content: \u0026#39;å¤–éƒ¨\u0026#39;; color:white; background-image: linear-gradient(37deg, #4facfe 0%, #00f2fe 100%); /* å¦‚æœä¸æ‰“å¼€Zè½´çš„åç§»ï¼Œåœ¨æ–°ç‰ˆchromeé‡Œåªä¼šæ˜¾ç¤ºä¸€ä¸ªé¢ */ transform: translateZ(1px); z-index: 1; } .box::after { content: \u0026#39;å†…éƒ¨\u0026#39;; color:black; background-image: linear-gradient(117deg, #fdfbfb 0%, #f6f6f7 22%, #f3f4f7 100%); /* æ˜¾ç¤ºå¦ä¸€é¢ */ transform: rotateY(180deg); } @keyframes rotate { from { transform: rotateY(0deg); } to { transform: rotateY(360deg); } } \u0026lt;/style\u0026gt; \u0026lt;!-- å¤–éƒ¨æ–‡æ¡£æµå®šä½å®¹å™¨ --\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;!-- å†…éƒ¨åŠ¨ç”»å®šä½å®¹å™¨ --\u0026gt; \u0026lt;div class=\u0026#34;inner\u0026#34;\u0026gt; \u0026lt;!-- å›¾ç‰‡ç»„å®¹å™¨ --\u0026gt; \u0026lt;div class=\u0026#34;boxes\u0026#34;\u0026gt; \u0026lt;!-- å…ƒç´ å—å¼€å§‹ --\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;!-- å…ƒç´ å—ç»“æŸ --\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; æ—‹è½¬æœ¨é©¬æ•ˆæœ å¤–éƒ¨ å†…éƒ¨ å¤–éƒ¨ å†…éƒ¨ å¤–éƒ¨ å†…éƒ¨ å¤–éƒ¨ å†…éƒ¨ å¤–éƒ¨ å†…éƒ¨ å¤–éƒ¨ å†…éƒ¨ è¿‡æ¸¡ è¿‡æ¸¡ï¼ˆ transition ï¼‰æ˜¯ CSS3 ä¸­å…·æœ‰é¢ è¦†æ€§çš„ç‰¹å¾ä¹‹ä¸€ã€‚æ®æ­¤å¯ä»¥åœ¨ä¸ä½¿ç”¨ FlashåŠ¨ç”» / JavaScript çš„æƒ…å†µä¸‹ï¼Œå½“å…ƒç´ ä»ä¸€ç§çŠ¶æ€å˜åŒ–åˆ°å¦ä¸€ç§çŠ¶æ€æ—¶æ·»åŠ æ•ˆæœã€‚\nIE9+ ä»¥ä¸Šæ”¯æŒã€‚å³ä½¿ä¸æ”¯æŒï¼Œä¹Ÿä¸ä¼šå½±å“é¡µé¢å¸ƒå±€ã€‚ç°åœ¨ç»å¸¸ä¸ :hover ä¸€èµ·æ­é…ä½¿ç”¨ã€‚\nå±æ€§: éœ€è¦å˜åŒ–çš„ CSS å±æ€§ã€‚å®½åº¦é«˜åº¦ èƒŒæ™¯é¢œè‰² å†…å¤–è¾¹è· éƒ½å¯ä»¥ã€‚å¦‚æœæƒ³è¦æ‰€æœ‰å±æ€§éƒ½å˜åŒ–è¿‡æ¸¡ï¼Œæ·»åŠ  all å³å¯\nèŠ±è´¹æ—¶é—´: å¿…é¡»æ·»åŠ å•ä½\nè¿åŠ¨æ›²çº¿: é»˜è®¤ ease ï¼ˆé€æ¸å‡é€Ÿï¼‰ï¼Œå¯ä»¥çœç•¥\nlinear: åŒ€é€Ÿ; ease: é€æ¸å‡é€Ÿ; ease-in: åŠ é€Ÿ; ease-out: å‡é€Ÿ; ease-in-out: å…ˆåŠ é€Ÿåå‡é€Ÿ; steps(4, jump-end); transition-timing-function: cubic-bezier(0.1, 0.7, 1.0, 0.1); ä½•æ—¶å¼€å§‹: è®¾ç½®å»¶æ—¶è§¦å‘æ—¶é—´ï¼Œå¯ä»¥çœç•¥\ntransition: è¦è¿‡æ¸¡çš„å±æ€§ èŠ±è´¹æ—¶é—´ è¿åŠ¨æ›²çº¿ ä½•æ—¶å¼€å§‹; NOTE: å¯ä»¥å¼€å¯ GPU ç¡¬ä»¶åŠ é€Ÿæ¨¡å¼ï¼Œä½¿ç”¨æ–¹æ³•ï¼š\ntransform: translateZ(0); transform: translate3d(0,0,0); e.g.:\ndiv { width: 200px; height: 100px; background-color: pink; transition: width .5s; } div:hover{ width: 400px; } e.g 2:\nè¿›åº¦æ¡\n\u0026lt;style\u0026gt; .bar { width: 30vh;height: 1.5vh; border: 1px solid #dc2a2a; border-radius: 1vh; padding: 1px; } .bar_in{ width: 0%;height: 100%; background-color: indianred; transition: ease-in .3s; border-radius: 1vh; } .bar:hover \u0026gt; .bar_in{ width: 100%;height: 100%; background-color: indianred; } \u0026lt;/style\u0026gt; \u0026lt;div class=\u0026#34;bar\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;bar_in\u0026#34;\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt; è¿›åº¦æ¡æ•ˆæœ åŠ¨ç”» åŠ¨ç”»*^animation^* æ˜¯ CSS3 ä¸­å…·æœ‰é¢ è¦†æ€§çš„ç‰¹å¾ä¹‹ä¸€ï¼Œå¯é€šè¿‡è®¾ç½®å¤šä¸ªèŠ‚ç‚¹æ¥ç²¾ç¡®æ§åˆ¶ä¸€ä¸ªæˆ–ä¸€ç»„åŠ¨ç”»ï¼Œå¸¸ç”¨æ¥å®ç°å¤æ‚çš„åŠ¨ç”»æ•ˆæœã€‚\nç›¸æ¯”è¾ƒ è¿‡æ¸¡ ^transition^ ï¼Œ åŠ¨ç”» å¯ä»¥å®ç°æ›´å¤šå˜åŒ–ã€æ›´å¤šæ§åˆ¶ã€è¿ç»­è‡ªåŠ¨æ’­æ”¾ç­‰æ•ˆæœã€‚\nå®šä¹‰ keyframe å…³é”®å­—\n0% æ˜¯åŠ¨ç”»çš„å¼€å§‹ï¼Œ100% æ˜¯åŠ¨ç”»çš„å®Œæˆã€‚è¿™æ ·çš„è§„åˆ™å°±æ˜¯ åŠ¨ç”»åºåˆ— åœ¨ @keyframe ä¸­è§„å®šæŸé¡¹ CSS æ ·å¼ï¼Œå°±èƒ½åˆ›å»ºç”±å½“å‰æ ·å¼é€æ¸å˜ä¸ºæ–°æ ·å¼çš„åŠ¨ç”»æ•ˆæœ å…³é”®å­— from to å¯ä»£æ›¿ 0% 100% @keyframes åŠ¨ç”»åç§° { /* å¼€å§‹çŠ¶æ€ */ 0% { width: 100px; } /* ç»“æŸçŠ¶æ€ */ 100% { width: 200px; } } ä½¿ç”¨ åŠ¨ç”»æ”¯æŒ è‡ªåŠ¨æ’­æ”¾\ndiv { width: 200px; height: 200px; background-color: aqua; /* è°ƒç”¨åŠ¨ç”» */ animation-time: åŠ¨ç”»åç§°; /* æŒç»­æ—¶é—´ */ animation-duration: æŒç»­æ—¶é—´; } å±æ€§ å±æ€§ æè¿° @keyframes è§„å®šåŠ¨ç”» animation æ‰€æœ‰åŠ¨ç”»å±æ€§çš„ç®€å†™å±æ€§ï¼Œé™¤äº† animation-play-state å±æ€§ animation-name è§„å®š @keyframes åŠ¨ç”»çš„åç§°ã€‚å¿…éœ€ animation-duration è§„å®šåŠ¨ç”»å®Œæˆä¸€ä¸ªå‘¨æœŸæ‰€èŠ±è´¹çš„ç§’æˆ–æ¯«ç§’ï¼Œé»˜è®¤æ˜¯0ã€‚å¿…éœ€ animation-timing-function è§„å®šåŠ¨ç”»çš„é€Ÿåº¦æ›²çº¿ï¼Œé»˜è®¤æ˜¯ ease animation-delay è§„å®šåŠ¨ç”»ä½•æ—¶å¼€å§‹ï¼Œé»˜è®¤æ˜¯ 0 animation-iteration-count è§„å®šåŠ¨ç”»è¢«æ’­æ”¾çš„æ¬¡æ•°ï¼Œé»˜è®¤æ˜¯1ã€æ— é™å¾ªç¯ infinite animation-direction è§„å®šåŠ¨ç”»æ˜¯å¦åœ¨ä¸‹ä¸€å‘¨æœŸé€†å‘æ’­æ”¾ï¼Œé»˜è®¤æ˜¯ normalï¼›è€Œ alternate é€†æ’­æ”¾ animation-play-state è§„å®šåŠ¨ç”»æ˜¯å¦æ­£åœ¨è¿è¡Œæˆ–æš‚åœã€‚é»˜è®¤æ˜¯ running ï¼Œæš‚åœ pause animation-fill-mode è§„å®šåŠ¨ç”»ç»“æŸåçŠ¶æ€ï¼Œä¿æŒ forwardsã€å›åˆ°èµ·å§‹backwards ç®€å†™å±æ€§ï¼š\nanimation: åŠ¨ç”»åç§° æŒç»­æ—¶é—´ è¿åŠ¨æ›²çº¿ ä½•æ—¶å¼€å§‹ æ’­æ”¾æ¬¡æ•° æ˜¯å¦åæ–¹å‘ åŠ¨ç”»èµ·å§‹æˆ–ç»“æŸçš„çŠ¶æ€; animation: name duration timing-function delay iteration-count direction fill-mode; /* å‰ä¸¤ä¸ªå±æ€§å¿…å†™ */ NOTE: ç®€å†™å±æ€§ä¸­ä¸åŒ…å« animation-stateã€‚\n@keyframes move{ from { transform: translate(0, 0); } to { transform:translate(1000px, 0); } } div { width: 100px; height: 100px; background-color: pink; /* åŠ¨ç”»åç§° */ animation-name: move; /* æŒç»­æ—¶é—´ */ animation-duration: 2s; /* è¿åŠ¨æ›²çº¿ */ animation-duration-function: ease; /* ä½•æ—¶å¼€å§‹ */ animation-delay: 0; /* å¾ªç¯è®¡æ•° */ animation-iteration-count: infinite; /* åŠ¨ç”»æ–¹å‘ */ animation-direction: alternate; /* æ’­æ”¾æš‚åœ */ animation-play-state: running; /* ç»“æŸä½ç½® */ animation-fill-mode: forwards; /* -\u0026gt; ç®€å†™ */ animation: move 2s ease infinite alternate; } å¯¹äºé€Ÿåº¦æ›²çº¿ animation-timing-functionï¼š\nå€¼ æè¿° linear åŠ¨ç”»ä»å¤´åˆ°å°¾çš„é€Ÿåº¦æ˜¯ç›¸åŒçš„ã€‚åŒ€é€Ÿ ease é»˜è®¤ã€‚åŠ¨ç”»ä»¥ä½é€Ÿå¼€å§‹ï¼Œç„¶ååŠ å¿«ï¼Œåœ¨ç»“æŸå‰å˜æ…¢ ease-in åŠ¨ç”»ä»¥ä½é€Ÿå¼€å§‹ ease-out åŠ¨ç”»ä»¥ä½é€Ÿç»“æŸ ease-in-out åŠ¨ç”»ä»¥ä½é€Ÿå¼€å§‹å’Œç»“æŸ steps() æŒ‡å®šäº†æ—¶é—´å‡½æ•°ä¸­çš„é—´éš”æ•°é‡ï¼ˆæ­¥é•¿ï¼‰ *: step() å¯ä»¥ç”¨äºå®ç°æ‰“å­—æœºæ•ˆæœ\ne.g.: æ‰“å­—æœºæ•ˆæœ\n\u0026lt;style\u0026gt; div.typewriter { font-size: 20px; width: 0; height: 30px; /* stepså°±æ˜¯åˆ†å‡ æ­¥æ¥å®ŒæˆåŠ¨ç”» -\u0026gt; æœ‰stepå°±ä¸éœ€è¦å†™ease/linear */ animation: typewriter 2s steps(10) forwards, cursor 1s steps(1) infinite; /* æ˜¾ç¤ºç±»ä¼¼å…‰æ ‡æ•ˆæœ */ border-right: 1px solid; /* å¼ºåˆ¶ä¸€è¡Œæ˜¾ç¤º */ white-space: nowrap; /* \u0026amp; éšè—çªå‡ºéƒ¨åˆ† */ overflow: hidden; } @keyframes typewriter{ from { width: 0; } to { width: 200px } } @keyframes cursor{ from { border-right-color: darkslateblue; } 50% { border-right-color: transparent; } } \u0026lt;/style\u0026gt; \u0026lt;!-- è¿™æ®µæ–‡å­—ä¸€å…±æœ‰10ä¸ªå­—ï¼Œè®¾ç½®å­—ä½“å¤§å°ä¸º20px --\u0026gt; \u0026lt;!-- åˆ™200pxå®½åº¦åˆšå¥½å¯ä»¥æ˜¾ç¤º10ä¸ªå­— --\u0026gt; \u0026lt;!-- å› æ­¤å°†stepåŠ¨ç”»è®¾ç½®ä¸º10æ®µåˆ™å¯ä»¥æ˜¾ç¤ºé€å­—æ‰“å­—æ•ˆæœ --\u0026gt; \u0026lt;div class=\u0026#34;typewriter\u0026#34;\u0026gt;ä¸–çºªä½³ç¼˜æˆ‘åœ¨è¿™é‡Œç­‰ä½ \u0026lt;/div\u0026gt; ä¸–çºªä½³ç¼˜æˆ‘åœ¨è¿™ **e.g.2:** å½©è™¹çƒ­ç‚¹å›¾ \u0026lt;style\u0026gt; .box { height: 50%; width: 700px; height: 700px; margin: 10px auto; } .centerbox { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 50px; height: 50px; border-radius: 50%; } .center { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 50px; height: 50px; border-radius: 50%; text-align: center; line-height: 50px; } div[class^=\u0026#34;div\u0026#34;] { /* è¦ç‚¹1ï¼šéœ€è¦å®šä½è‡³ä¸­å¿ƒï¼Œè¿™æ ·æ‰èƒ½ä»ä¸­å¿ƒå¼€å§‹æ‰©æ•£ */ position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); border-radius: 50%; /* è¦ç‚¹2ï¼šè®¾ç½®ä¸ºæ— æ•ˆå¾ªç¯ï¼Œé€Ÿåº¦ä¸ºåŒ€é€Ÿ */ animation: spread 1.4s linear infinite; } .box .div1 { box-shadow: 0 0 10px red; } .box .div2 { /* è¦ç‚¹3ï¼ˆæ ¸å¿ƒï¼‰ï¼šä¸ºæ¯ä¸€ä¸ªåœˆå•ç‹¬è®¾ç½®å»¶è¿Ÿæ—¶é—´ */ animation-delay: 0.2s; box-shadow: 0 0 10px orange; } .box .div3 { animation-delay: 0.4s; box-shadow: 0 0 10px yellow; } .box .div4 { animation-delay: 0.6s; box-shadow: 0 0 10px green; } .box .div5 { animation-delay: 0.8s; box-shadow: 0 0 10px rgb(0, 228, 0); } .box .div6 { animation-delay: 1s; box-shadow: 0 0 10px blue; } .box .div7 { /* è¦ç‚¹4ï¼šæœ€åä¸€ä¸ªåœˆçš„å»¶è¿Ÿæ—¶é—´åŠ ä¸Šæ—¶é—´å·®æœ€å¥½ç­‰äºæ•´ä¸ªåŠ¨ç”»çš„æŒç»­æ—¶é—´ï¼Œè¿™æ ·å¯ä»¥æ— é—´éš™çš„å®ç°å¾ªç¯åŠ¨ç”» */ animation-delay: 1.2s; box-shadow: 0 0 10px purple; } @keyframes spread { 0% { } 20% { /* è¦ç‚¹5ï¼šè¿™é‡Œä¸ä½¿ç”¨transform:scaleçš„åŸå› æ˜¯ç¼©æ”¾ä¹Ÿä¼šä½¿é˜´å½±ç­‰æ¯”ä¾‹ç¼©æ”¾ã€‚æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœåªæ˜¯å®½é«˜å˜å¤§ï¼Œé˜´å½±çš„å¤§å°ä¸å˜ */ width: 1px; height: 1px; opacity: 0.5; } 70% { width: 100px; height: 100px; opacity: 1; } 100% { width: 200px; height: 200px; /* è¦ç‚¹6ï¼šæœ€åå°†é€æ˜åº¦è®¾ç½®ä¸º0ï¼Œå°±ä¸ä¼šæ˜¾å¾—å¾ˆçªå…€ï¼Œæœ‰ä¸€ç§æ¸å˜çš„æ„Ÿè§‰ */ opacity: 0; } } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;centerbox\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;center\u0026#34;\u0026gt;æˆéƒ½\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;div1\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;div2\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;div3\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;div4\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;div5\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;div6\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;div7\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; e.g.3: å¥”è·‘çš„å¤§ç†Š\n.bear { position: absolute; top: 50%; transform: translate(0, -50%); width: 200px; height: 100px; /* å…³é”®ç‚¹åœ¨äºstepsæ­¥è¿›åŠ¨ç”» */ background: url(../images/bear.png) no-repeat; animation: bear 1s steps(8) infinite, move 2s linear forwards; } å‰ç¼€ æµè§ˆå™¨ç§æœ‰å‰ç¼€æ˜¯ä¸ºäº† å…¼å®¹ è€ç‰ˆæœ¬çš„å†™æ³•ï¼Œæ¯”è¾ƒæ–°ç‰ˆæœ¬çš„æµè§ˆå™¨ æ— é¡»æ·»åŠ  ã€‚\nç§æœ‰å‰ç¼€ -moz-ï¼šä»£è¡¨ Firefox æµè§ˆå™¨ç§æœ‰å±æ€§ -ms-ï¼šä»£è¡¨ IE æµè§ˆå™¨ç§æœ‰å±æ€§ -safari-ï¼šä»£è¡¨ Safariã€Chromeç§æœ‰å±æ€§ NOTE: Internet Explorer å·²ç»è¢«å¾®è½¯æ”¾å¼ƒ\næå€¡å†™æ³•\n-webkit-border-radius: radius; -moz-border-radius: radius; border-radius: radius; ç§»åŠ¨ PC ç«¯å¸¸è§æµè§ˆå™¨ï¼š360æµè§ˆå™¨ è°·æ­Œæµè§ˆå™¨ ç«ç‹æµè§ˆå™¨ QQæµè§ˆå™¨ ç™¾åº¦æµè§ˆå™¨ æœç‹—æµè§ˆå™¨ IEæµè§ˆå™¨\nç§»åŠ¨ç«¯å¸¸è§æµè§ˆå™¨ï¼šUCæµè§ˆå™¨ QQæµè§ˆå™¨ ç™¾åº¦æ‰‹æœºæµè§ˆå™¨ æœç‹—æ‰‹æœºæµè§ˆå™¨ çŒè±¹æµè§ˆå™¨ ä»¥åŠå…¶å®ƒæ‚ç‰Œæµè§ˆå™¨ï¼ˆåŸºäº Chromium Webkit å†…æ ¸ï¼‰\nç§»åŠ¨ç«¯è®¾å¤‡å±å¹•å°ºå¯¸éå¸¸å¤šï¼Œç¢ç‰‡åŒ–ä¸¥é‡ã€‚\nAndroidè®¾å¤‡æœ‰å¤šç§åˆ†è¾¨ç‡: 480 Ã— 800ã€480 Ã— 854ã€540 Ã— 960ã€720 Ã— 1280ã€1080 Ã— 1920ç­‰ã€è¿˜æœ‰ä¼ è¯´ä¸­çš„2Kã€4kå±ã€‚\nè¿‘å¹´æ¥iPhoneçš„ç¢ç‰‡åŒ–ä¹ŸåŠ å‰§äº†ï¼Œå…¶è®¾å¤‡çš„ä¸»è¦åˆ†è¾¨ç‡æœ‰ï¼š640 Ã— 960ã€640 Ã— 1136ã€750 Ã— 1334ã€1242 Ã— 2208ç­‰ã€‚\nä½œä¸ºå¼€å‘è€…æ— éœ€å…³æ³¨è¿™äº›åˆ†è¾¨ç‡ï¼Œå› ä¸ºæˆ‘ä»¬å¸¸ç”¨çš„å°ºå¯¸å•ä½æ˜¯ px ã€‚\nè®¾å¤‡ å°ºå¯¸(è‹±å¯¸) å¼€å‘å°ºå¯¸(px) ç‰©ç†åƒç´ æ¯”(dpr) iPhone 3G 3.5 320Ã—480 1.0 iPhone 4/4s 3.5 320 Ã— 480 2.0 iPhone 5/5s/5c 4.0 320 Ã— 568 2.0 HTC One M8 4.5 360 Ã— 640 3.0 iPhone 6 4.7 375 Ã— 667 2.0 Nexus 4 4.7 384 Ã— 640 2.0 Nexus 5x 5.2 411 Ã— 731 2.6 iPhone6 Plus 5.5 414 Ã— 736 3.0 Samsung Galaxy Note 4 5.7 480 Ã— 853 3.0 Sony Xperia Z Ultra 6.4 540 Ã— 960 2.0 Nexus 7 (\u0026lsquo;12) 7.0 600 Ã— 960 1.3 iPad Mini 7.9 768 Ã— 1024 1.0 NOTE:\nä»¥ä¸Šæ•°æ®æ¥è‡ª https://material.io/devices/ ä¸å»ºè®®å¤§å®¶çº ç»“äº dp dpi pt ppi ç­‰å•ä½ è°ƒè¯• Chrome DevTools æ¨¡æ‹Ÿæ‰‹æœºè°ƒè¯• æ­å»ºæœ¬åœ° Web æœåŠ¡å™¨ï¼Œæ‰‹æœºå’ŒæœåŠ¡å™¨åœ¨ä¸€ä¸ªå±€åŸŸç½‘å†…ï¼Œé€šè¿‡æ‰‹æœºè®¿é—®æœåŠ¡å™¨ ä½¿ç”¨å¤–ç½‘æœåŠ¡å™¨ï¼Œç›´æ¥ IP æˆ–è€…åŸŸåè®¿é—® è§†å£ viewpoint å°±æ˜¯æµè§ˆå™¨æ˜¾ç¤ºé¡µé¢å†…å®¹çš„å±å¹•åŒºåŸŸã€‚è§†å£å¯ä»¥åˆ†ä¸º å¸ƒå±€è§†å£ ã€ è§†è§‰è§†å£ å’Œ ç†æƒ³è§†å£ ã€‚\nå¸ƒå±€è§†å£ layout viewport ä¸€èˆ¬ç§»åŠ¨è®¾å¤‡çš„æµè§ˆå™¨éƒ½é»˜è®¤è®¾ç½®äº†ä¸€ä¸ª å¸ƒå±€è§†å£ ï¼Œç”¨äºè§£å†³æ—©æœŸçš„PCç«¯é¡µé¢åœ¨æ‰‹æœºä¸Šæ˜¾ç¤ºçš„é—®é¢˜ã€‚iOSã€Android åŸºæœ¬éƒ½å°†è¿™ä¸ªè§†å£åˆ†è¾¨ç‡è®¾ç½®ä¸º 980px ï¼Œæ‰€ä»¥PCä¸Šçš„ç½‘é¡µå¤§å¤šéƒ½èƒ½åœ¨æ‰‹æœºä¸Šå‘ˆç°ï¼Œåªä¸è¿‡å…ƒç´ çœ‹ä¸Šå»å¾ˆå°ï¼Œä¸€èˆ¬é»˜è®¤å¯ä»¥é€šè¿‡æ‰‹åŠ¨ç¼©æ”¾ç½‘é¡µã€‚\nè§†è§‰è§†å£ visual viewport æŒ‡çš„æ˜¯ç”¨æˆ·èƒ½çœ‹åˆ°çš„ ç½‘ç«™åŒºåŸŸ ã€‚å¯ä»¥é€šè¿‡ç¼©æ”¾æ“ä½œè§†è§‰è§†å£ï¼Œä½†ä¸ä¼šå½±å“å¸ƒå±€è§†å£ã€‚\nç†æƒ³è§†å£ ideal viewport ä¸ºäº†ä½¿ç½‘ç«™åœ¨ç§»åŠ¨ç«¯æœ‰æœ€ç†æƒ³çš„æµè§ˆå’Œé˜…è¯»å®½åº¦è€Œè®¾å®šã€‚\néœ€è¦æ‰‹åŠ¨æ·»åŠ  metaæ ‡ç­¾é€šçŸ¥æµè§ˆå™¨æ“ä½œ è®¾å¤‡æœ‰å¤šå®½ï¼Œåˆ™å¸ƒå±€çš„ è§†å£ å°±å¤šå®½ ä¹”å¸ƒæ–¯å‘æ˜ Layout viewport Visual viewport Meta æ ‡ç­¾ \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0\u0026#34;\u0026gt; å±æ€§ è§£é‡Šè¯´æ˜ width å®½åº¦è®¾ç½®çš„æ˜¯ viewport å®½åº¦ï¼ˆä¹Ÿå³è§†å£å®½åº¦ï¼‰ï¼Œå¯ä»¥è®¾ç½® device-width ç‰¹æ®Šå€¼ initial-scale åˆå§‹ç¼©æ”¾æ¯”ï¼Œå¤§äº0çš„æ•°å­— maximum-scale æœ€å¤§ç¼©æ”¾æ¯”ï¼Œå¤§äº0çš„æ•°å­— minimum-scale æœ€å°ç¼©æ”¾æ¯”ï¼Œå¤§äº0çš„æ•°å­— user-scalable ç”¨æˆ·æ˜¯å¦å¯ä»¥ç¼©æ”¾ï¼Œyesæˆ–noï¼ˆ1æˆ–0ï¼‰ äºŒå€å›¾ ç‰©ç†åƒç´ \u0026amp;ç‰©ç†åƒç´ æ¯”ï¼š\nç‰©ç†åƒç´ ç‚¹æŒ‡çš„æ˜¯å±å¹•æ˜¾ç¤ºçš„æœ€å°é¢—ç²’ï¼Œæ˜¯ç‰©ç†çœŸå®å­˜åœ¨çš„ã€‚è¿™æ˜¯å‚å•†åœ¨å‡ºå‚æ—¶å°±è®¾ç½®å¥½çš„ï¼Œæ¯”å¦‚ iPhone 6/7/8 æ˜¯ 750 Ã— 1334 ã€‚æˆ‘ä»¬å¼€å‘æ—¶å€™çš„ 1px ä¸æ˜¯ä¸€å®šç­‰äº 1 ä¸ªç‰©ç†åƒç´ çš„ã€‚PCç«¯é¡µé¢ï¼Œ1px ç­‰äº1ä¸ªç‰©ç†åƒç´ ï¼Œä½†æ˜¯ç§»åŠ¨ç«¯å°±ä¸å°½ç›¸åŒã€‚ä¸€ä¸ªpxçš„èƒ½æ˜¾ç¤ºçš„ç‰©ç†åƒç´ ç‚¹çš„ä¸ªæ•°ï¼Œç§°ä¸ºç‰©ç†åƒç´ æ¯”æˆ–å±å¹•åƒç´ æ¯”ã€‚\nå¯¹äºä¸€å¼  50px Ã— 50px çš„å›¾ç‰‡ï¼Œåœ¨æ‰‹æœº Retina å±ä¸­æ‰“å¼€ï¼ŒæŒ‰ç…§åˆšæ‰çš„ç‰©ç†åƒç´ æ¯”ä¼šæ”¾å¤§å€æ•°ï¼Œè¿™æ ·ä¼šé€ æˆå›¾ç‰‡æ¨¡ç³Šã€‚åœ¨æ ‡å‡†çš„ Viewfort è®¾ç½®ä¸­ï¼Œä½¿ç”¨å€å›¾æ¥æé«˜å›¾ç‰‡è´¨é‡ã€è§£å†³åœ¨é«˜æ¸…è®¾å¤‡ä¸­çš„æ¨¡ç³Šé—®é¢˜ï¼Œé€šå¸¸ä½¿ç”¨ äºŒå€å›¾ ã€‚å› ä¸º iPhone 6/7/8 çš„å½±å“ï¼Œç°åœ¨è¿˜å­˜åœ¨3å€å›¾ã€4å€å›¾ï¼Œè¿™ä¸ªçœ‹å®é™…å¼€å‘å…¬å¸éœ€æ±‚ã€‚\nèƒŒæ™¯ç¼©æ”¾ background-size è§„å®šèƒŒæ™¯å›¾åƒçš„å°ºå¯¸\nbackground-size: èƒŒæ™¯å›¾ç‰‡å®½åº¦ èƒŒæ™¯å›¾ç‰‡é«˜åº¦; å•ä½ï¼šé•¿åº¦ï½œç™¾åˆ†æ¯”ï½œcoverï½œcontain\ncover æŠŠèƒŒæ™¯å›¾åƒæ‹“å±•åˆ°è¶³å¤Ÿå¤§ï¼Œä»¥ä½¿èƒŒæ™¯å›¾åƒå®Œå…¨è¦†ç›–èƒŒæ™¯åŒºåŸŸ contain æŠŠå›¾åƒæ‰©å±•è‡³æœ€å¤§å°ºå¯¸ï¼Œä»¥ä½¿å…¶å®½åº¦å’Œé«˜åº¦é€æ¸é€‚åº”å†…å®¹åŒºåŸŸ å¼€å‘ å•ç‹¬ åˆ¶ä½œç§»åŠ¨ç«¯é¡µé¢ï¼ˆä¸»æµï¼‰ é€šå¸¸ç½‘å€å‰é¢åŠ  mï¼ˆmobileï¼‰å¯ä»¥æ‰“å¼€ç§»åŠ¨ç«¯ã€‚é€šè¿‡åˆ¤æ–­è®¾å¤‡è¿›è¡ŒåŠ è½½å“åº”é¡µé¢ äº¬ä¸œå•†åŸæ‰‹æœºç‰ˆ æ·˜å®è§¦å±ç‰ˆ è‹å®æ˜“è´­æ‰‹æœºç‰ˆ å¸ƒå±€æ–¹å¼ æµå¼å¸ƒå±€ï¼ˆç™¾åˆ†æ¯”å¸ƒå±€ï¼‰ flex å¼¹æ€§å¸ƒå±€ less + rem + åª’ä½“æŸ¥è¯¢å¸ƒå±€ æ··åˆå¸ƒå±€ å“åº”å¼ é¡µé¢å…¼å®¹ç§»åŠ¨ç«¯ é€šè¿‡åˆ¤æ–­å±å¹•å®½åº¦æ¥æ”¹å˜ç•Œé¢ åˆ¶ä½œéº»çƒ¦ï¼Œéœ€è¦èŠ±è´¹å¾ˆå¤§ç²¾åŠ›è°ƒè¯•å…¼å®¹é¡µé¢ ä¸‰æ˜Ÿæ‰‹æœºå®˜ç½‘ å¸ƒå±€æ–¹å¼ åª’ä½“æŸ¥è¯¢ bootstrap ç§»åŠ¨ç«¯æµè§ˆå™¨åŸºæœ¬ä»¥ Webkit å†…æ ¸ä¸ºä¸»ï¼Œå› æ­¤æˆ‘ä»¬å°±è€ƒè™‘ Webkit å…¼å®¹æ€§é—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥æ”¾å¿ƒä½¿ç”¨ H5 æ ‡ç­¾å’Œ CSS3 æ ·å¼ã€‚ åŒæ—¶æˆ‘ä»¬æµç›‘å™¨çš„ç§æœ‰å‰ç¼€æˆ‘ä»¬åªéœ€è¦è€ƒè™‘æ·»åŠ  Webkit å³å¯ã€‚\nç•Œé¢ æ‰€è°“çš„ç•Œé¢æ ·å¼ï¼Œå°±æ˜¯æ›´æ”¹ä¸€äº›ç”¨æˆ·æ“ä½œæ ·å¼ï¼Œä»¥ä¾¿æé«˜æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚\né¼ æ ‡ The cursor CSS property sets the mouse cursor, if any, to show when the mouse pointer is over an element.\nelement { cursor: pointer; } å±æ€§å€¼ æè¿° default é»˜è®¤ pointer æŒ‡é’ˆ move ç§»åŠ¨ text æ–‡æœ¬ not-allowed ç¦æ­¢ è¡¨å• è¡¨å•è½®å»“\nè½®å»“çº¿ outline\noutline: 0; outline: none; /* è¿™æ ·å³å¯å»é™¤é»˜è®¤è·å¾—ç„¦ç‚¹æ—¶çš„è¡¨å•è¾¹æ¡† */ default outline: none; é˜²æ­¢æ‹–æ‹½æ–‡æœ¬åŸŸ\n\u0026lt;style\u0026gt; textarea{ /* ç¦æ­¢æ”¹å˜å¤§å° */ resize: none; /* å–æ¶ˆè½®å»“çº¿ */ outline: none; } \u0026lt;/style\u0026gt; \u0026lt;textarea name=\u0026#34;\u0026#34; id=\u0026#34;\u0026#34; cols=\u0026#34;30\u0026#34; rows=\u0026#34;10\u0026#34;\u0026gt;\u0026lt;/textarea\u0026gt; æ‹–æ”¾ ç»“åˆ JS ä½¿ç”¨ã€‚\ndragstart:åœ¨å¼€å§‹æ‹–æ”¾å…ƒç´ æ—¶è§¦å‘ã€‚ï¼ˆäº‹ä»¶æºï¼šè¢«æ‹–æ”¾å…ƒç´ ï¼‰ drag:æ­£åœ¨æ‹–æ”¾å…ƒç´ æ—¶è§¦å‘ã€‚ï¼ˆäº‹ä»¶æºï¼šè¢«æ‹–æ”¾å…ƒç´ ï¼‰ dragenter:åœ¨å…ƒç´ è¢«æ‹–è¿›æŸå…ƒç´ æ—¶è§¦å‘ã€‚ï¼ˆäº‹ä»¶æºï¼šç›®æ ‡å…ƒç´ ï¼‰ dragoverï¼šåœ¨è¢«æ‹–æ”¾åœ¨æŸå…ƒç´ å†…ç§»åŠ¨æ—¶è§¦å‘ã€‚ï¼ˆäº‹ä»¶æºï¼šç›®æ ‡å…ƒç´ ï¼‰ dragleaveï¼šåœ¨è¢«æ‹–æ”¾å…ƒç´ ç§»å‡ºç›®æ ‡å…ƒç´ æ—¶è§¦å‘ã€‚ï¼ˆäº‹ä»¶æºï¼šç›®æ ‡å…ƒç´ ï¼‰ dropï¼šç›®æ ‡å…ƒç´ å®Œå…¨æ¥å—è¢«æ‹–æ”¾å…ƒç´ æ—¶è§¦å‘ã€‚ï¼ˆäº‹ä»¶æºï¼šç›®æ ‡å…ƒç´ ï¼‰ dragend:åœ¨æ•´ä¸ªæ‹–æ”¾æ“ä½œç»“æŸæ—¶è§¦å‘ã€‚ï¼ˆäº‹ä»¶æºï¼šè¢«æ‹–æ”¾å…ƒç´ ï¼‰ \u0026lt;body\u0026gt; \u0026lt;div id=\u0026#34;box1\u0026#34; ondragover=\u0026#34;dragover(event)\u0026#34; ondragenter=\u0026#34;dragenter()\u0026#34; ondragleave=\u0026#34;dragleave()\u0026#34; ondrop=\u0026#34;drop(event)\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;!-- æ­¥éª¤ä¸€ï¼šè®¾ç½®å…ƒç´ ä¸ºå¯æ‹–æ”¾ --\u0026gt; \u0026lt;div id=\u0026#34;box2\u0026#34; draggable=\u0026#34;true\u0026#34; ondragstart=\u0026#34;dragstart(event)\u0026#34; ondrag=\u0026#34;drag(event)\u0026#34; ondragend=\u0026#34;end(event)\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; // æ­¥éª¤äºŒï¼šä¸ºæ¬²æ‹–åŠ¨çš„å…ƒç´ æ·»åŠ ondragstartäº‹ä»¶ï¼Œç”¨äºè§„å®šå…ƒç´ è¢«æ‹–åŠ¨æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆ function dragstart(ev) { // dataTransfer.setData() æ–¹æ³•è®¾ç½®è¢«æ‹–æ•°æ®çš„æ•°æ®ç±»å‹å’Œå€¼ï¼š // å°†è¢«æ‹–åŠ¨å…ƒç´ çš„idä¿å­˜èµ·æ¥ ev.dataTransfer.setData(\u0026#34;Text\u0026#34;, ev.target.id); console.log(\u0026#34;å¼€å§‹æ‹–åŠ¨è¯¥å…ƒç´ \u0026#34;); } function drag() { console.log(\u0026#34;æ­£åœ¨æ‹–åŠ¨è¯¥å…ƒç´ \u0026#34;); } function dragenter() { console.log(\u0026#34;å•Šï¼Œä½ ä¸è¦ç¢°æˆ‘å•Š\u0026#34;); } function dragleave() { console.log(\u0026#34;å“å‘€å¦ˆå‘€ï¼Œç»ˆäºèµ°äº†\u0026#34;); } // æ­¥éª¤3ï¼šä¸ºå…ƒç´ è¢«æ‹–åŠ¨åˆ°çš„ä½ç½®æ‰€åœ¨çš„å…ƒç´ ç»‘å®šondragoveräº‹ä»¶ function dragover(ev) { console.log(\u0026#34;å•Šå•Šå•Šï¼Œå®ƒåœ¨æˆ‘å†…éƒ¨ç§»åŠ¨\u0026#34;); // é»˜è®¤åœ°ï¼Œæ— æ³•å°†æ•°æ®/å…ƒç´ æ”¾ç½®åˆ°å…¶ä»–å…ƒç´ ä¸­ã€‚ ev.preventDefault(); } // æ­¥éª¤4ï¼šå½“æ”¾ç½®è¢«æ‹–å…ƒç´ æ—¶ï¼Œä¼šè§¦å‘dropäº‹ä»¶ function drop(ev) { console.log(\u0026#34;å¥½å§ï¼Œæ¥éƒ½æ¥äº†\u0026#34;); // drop äº‹ä»¶çš„é»˜è®¤è¡Œä¸ºæ˜¯ä»¥é“¾æ¥å½¢å¼æ‰“å¼€ ev.preventDefault(); // è·å–ä¹‹å‰ä¿å­˜çš„idï¼Œå°†å…¶å…ƒç´ æ·»åŠ åœ¨ç›®æ ‡å…ƒç´ ä¸­ã€‚ let data = ev.dataTransfer.getData(\u0026#34;Text\u0026#34;); ev.target.appendChild(document.getElementById(data)); } function end(e) { console.log(\u0026#34;ç»ˆäºç»“æŸäº†\u0026#34;); } \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; å®½åº¦ä¿æŠ¤ ä¸ºäº†ä¿æŠ¤ç›’å­å®½åº¦ï¼Œæä¾›ï¼šmax-height max-width min-height min-width å±æ€§ï¼š\nsection{ max-width: lengh; min-width: lengh; margin: 0 auto; } é•¿åº¦å•ä½ Ems Using an em value creates a dynamic or computed font size (historically the em unit was derived from the width of a capital \u0026ldquo;M\u0026rdquo; in a given typeface.). The numeric value acts as a multiplier of the font-size property of the element on which it is used. Consider this example:\np { font-size: 2em; } Copy to Clipboard\nIn this case, the font size of \u0026lt;p\u0026gt; elements will be double the computed font-size inherited by \u0026lt;p\u0026gt; elements. By extension, a font-size of 1em equals the computed font-size of the element on which it is used.\nRem é¡µé¢å¸ƒå±€æ–‡å­—èƒ½å¦éšç€å±å¹•å¤§å°å˜åŒ–è€Œå˜åŒ–ï¼Ÿ æµå¼å¸ƒå±€ å’Œ flexå¸ƒå±€ ä¸»è¦é’ˆå¯¹äº å®½åº¦ å¸ƒå±€ï¼Œé‚£ é«˜åº¦ å¦‚ä½•è®¾ç½®ï¼Ÿ æ€ä¹ˆæ ·è®©å±å¹•å‘ç”Ÿå˜åŒ–çš„æ—¶å€™å…ƒç´ é«˜åº¦å’Œå®½åº¦ç­‰æ¯”ä¾‹ç¼©æ”¾ï¼Ÿ rem ï¼ˆRoot emï¼‰æ˜¯ä¸€ä¸ª ç›¸å¯¹å•ä½ ï¼Œç±»ä¼¼äº em ï¼Œ em æ˜¯ çˆ¶å…ƒç´  å­—ä½“å¤§å°ã€‚ ä¸åŒçš„æ˜¯ rem çš„åŸºå‡†æ˜¯ç›¸å¯¹äº html å…ƒç´ çš„å­—ä½“å¤§å°ã€‚\næ¯”å¦‚ï¼Œæ ¹å…ƒç´ ï¼ˆHTMLï¼‰è®¾ç½® font-size=12px; éæ ¹å…ƒç´ è®¾ç½® width:2rem;ï¼Œåˆ™æ¢æˆ px è¡¨ç¤ºå°±æ˜¯ 24px ã€‚ åª’ä½“æŸ¥è¯¢ åª’ä½“æŸ¥è¯¢ï¼ˆMedia Queryï¼‰æ˜¯ CSS3 æ–°è¯­æ³•ã€‚\nä½¿ç”¨ @media æŸ¥è¯¢ï¼Œå¯ä»¥é’ˆå¯¹ä¸åŒçš„åª’ä½“ç±»å‹å®šä¹‰ä¸åŒçš„æ ·å¼ï¼Œå½“é‡ç½®æµè§ˆå™¨å¤§å°çš„è¿‡ç¨‹ä¸­ï¼Œé¡µé¢ä¹Ÿä¼šæ ¹æ®æµè§ˆå™¨çš„å®½åº¦å’Œé«˜åº¦ é‡æ–°æ¸²æŸ“ é¡µé¢ã€‚\nç›®å‰é’ˆå¯¹å¾ˆå¤šè‹¹æœæ‰‹æœºã€Androidæ‰‹æœºã€å¹³æ¿ç­‰è®¾å¤‡éƒ½ç”¨å¾—åˆ°å¤šåª’ä½“æŸ¥è¯¢ã€‚\nä»¥ @media å¼€å¤´ mediatype åª’ä½“ç±»å‹ å…³é”®å­— and not only media feature å¿…é¡»ç”± å°æ‹¬å· () åŒ…è£¹ @media mediatype and|not|only (media feature) { CSS-Code; } æŸ¥è¯¢ç±»å‹ mediatype å°†ä¸åŒç»ˆç«¯åˆ’åˆ†ä¸ºä¸åŒçš„ç±»å‹ã€‚\nå€¼ è¯´æ˜ all ç”¨äºæ‰€æœ‰è®¾å¤‡ print ç”¨äºæ‰“å°æœºå’Œæ‰“å°é¢„è§ˆ screen ç”¨äºç”µè„‘å±å¹•ã€å¹³æ¿ç”µè„‘ã€æ™ºèƒ½æ‰‹æœºç­‰ å…³é”®å­— å€¼ è¯´æ˜ and å°†å¤šä¸ªåª’ä½“ç‰¹æ€§è¿æ¥åˆ°ä¸€èµ· not æ’é™¤æŸä¸ªç±»å‹ only æŒ‡å®šæŸä¸ªç‰¹å®šç±»å‹ï¼Œå¯çœç•¥ åª’ä½“åŠŸèƒ½ (media feature)\nå€¼ è¯´æ˜ width å®šä¹‰å¯è§åŒºåŸŸå®½åº¦ min-width å®šäºæœ€å°åŒºåŸŸå®½åº¦ max-width å®šä¹‰æœ€å¤§åŒºåŸŸå®½åº¦ prefers-color-scheme ç³»ç»Ÿæ ·å¼ light / dark /* åœ¨å„ç±»å±å¹•ä¸Š \u0026amp; æœ€å¤§å®½åº¦800åƒç´ ä»¥å†… åº”ç”¨ä»¥ä¸‹çš„æ ·å¼ */ @media screen and (max-width: 800px) { .Selector { CSS-Code; } } /* åœ¨å„ç±»å±å¹•ä¸Š \u0026amp; æœ€å°å®½åº¦500åƒç´ ä»¥å†… åº”ç”¨ä»¥ä¸‹çš„æ ·å¼ */ @media screen and (min-width: 500px) { .Selector { CSS-Code; } } LESS ä¸ºäº†é¿å… CSS çš„å¼Šç«¯ï¼ˆéç¨‹åºå¼è¯­è¨€ï¼Œæ²¡æœ‰å˜é‡ã€å‡½æ•°ã€ä½œç”¨åŸŸScope ç­‰æ¦‚å¿µï¼‰ï¼Œå¼•å…¥äº† LESS ã€‚\nCSS ç¼ºç‚¹ï¼š\nCSS éœ€è¦ä¹¦å†™å¤§é‡çœ‹ä¼¼æ²¡æœ‰é€»è¾‘çš„ä»£ç ï¼Œå†—ä½™åº¦æ˜¯æ¯”è¾ƒé«˜ ä¸æ–¹ä¾¿ç»´æŠ¤åŠæ‰©å±•ã€å¤ç”¨ æ²¡æœ‰å¾ˆå¥½çš„è®¡ç®—èƒ½åŠ› å¯¹äºéå‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆï¼Œå¾€å¾€ä¼šå› ä¸ºç¼ºå°‘ CSS ç¼–å†™ç»éªŒè€Œå¾ˆéš¾å†™å‡ºç»„ç»‡è‰¯å¥½ä¸”æ˜“äºç»´æŠ¤çš„ CSS ä»£ç é¡¹ç›® LESS ï¼ˆLeaner Style Sheetsï¼‰æ˜¯ä¸€é—¨ CSS æ‰©å±•è¯­è¨€ ï¼Œä¹Ÿç§°ä¸º CSS é¢„å¤„ç†å™¨ ã€‚ ä½œä¸º CSS çš„ä¸€ç§å½¢å¼çš„æ‰©å±•\u0010ï¼Œå®ƒå¹¶æ²¡æœ‰å‡å°‘CSSçš„åŠŸèƒ½ï¼Œè€Œæ˜¯åœ¨ç°æœ‰çš„CSSè¯­æ³•ä¸Šï¼Œä¸ºCSSåŠ å…¥ç¨‹åºå¼è¯­è¨€çš„ç‰¹æ€§ã€‚å®ƒåœ¨CSSçš„è¯­æ³•åŸºç¡€ä¹‹ä¸Šï¼Œå¼•å…¥äº†å˜é‡ã€ Mixin (æ··å…¥)ã€è¿ç®—ä»¥åŠå‡½æ•°ç­‰åŠŸèƒ½ï¼Œå¤§å¤§ç®€åŒ–äº† CSS çš„ç¼–å†™ã€‚\nLess ä¸­æ–‡ç½‘å€: http://lesscss.cn/\nå¸¸è§çš„ CSS é¢„å¤„ç†å™¨ï¼š SASS LESS STYLUS\n.less æ˜¯ LESS æ ¼å¼çš„æ‹“å±•ã€‚\nç¼–è¯‘ æœ¬è´¨ä¸Šï¼Œ Less åŒ…å«ä¸€å¥—è‡ªå®šä¹‰çš„ è¯­æ³• åŠä¸€ä¸ª è§£æå™¨ ï¼Œç”¨æˆ·æ ¹æ®è¿™äº›è¯­æ³•å®šä¹‰è‡ªå·±çš„æ ·å¼è§„åˆ™ï¼Œè¿™äº›è§„åˆ™æœ€ç»ˆä¼šé€šè¿‡è§£æå™¨ï¼Œç¼–è¯‘ç”Ÿæˆå¯¹åº”çš„ CSS æ–‡ä»¶ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæˆ‘ä»¬çš„ LESS æ–‡ä»¶,ç¼–è¯‘ç”Ÿæˆä¸ºcssæ–‡ä»¶,è¿™æ ·æˆ‘ä»¬çš„htmlé¡µé¢æ‰èƒ½ä½¿ç”¨ã€‚\nVScode ä¸­çš„ Easy LESS æ’ä»¶å¯ä»¥æŠŠ LESS æ–‡ä»¶è‡ªåŠ¨ç¼–è¯‘ä¸º CSS æ–‡ä»¶ã€‚\n\u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;path/to/file\u0026#34;\u0026gt; å˜é‡ å¿…é¡»ä»¥ @ ä¸ºå‰ç¼€ ä¸èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦ ä¸èƒ½ä»¥æ•°å­—å¼€å¤´ å¤§å°å†™æ•æ„Ÿ @å˜é‡å: å€¼; // å®šä¹‰ä¸€ä¸ªç²‰è‰²çš„å˜é‡ @color: pink; // é”™è¯¯çš„å˜é‡å @1color @color~@# // å˜é‡åŒºåˆ†å¤§å°å†™ @color @Color æ˜¯ä¸¤ä¸ªä¸åŒçš„å˜é‡ body { background-color: @color; } div { color: @color; } åµŒå¥— å­å…ƒç´  ç›´æ¥å†™åœ¨ çˆ¶å…ƒç´  é‡Œé¢ï¼Œå°†ä¼šåœ¨ CSS è‡ªåŠ¨ç”Ÿæˆç›¸åº”çš„ åä»£é€‰æ‹©å™¨ ã€‚\n// less.less .header { width: 200px; height: 200px; background-color: pink; // lessåµŒå¥— å­å…ƒç´ ç›´æ¥å†™åœ¨çˆ¶å…ƒç´ é‡Œé¢å³å¯ a { color: red; } } /*----------------------------------*/ #header.logo{ width: 300px; } /* less.css */ .header { width: 200px; height: 200px; background-color: pink; } .header a { color: red; } /*----------------------------------*/ #header { .logo { width: 300px; } } å¦‚æœé‡è§ äº¤é›†é€‰æ‹©å™¨ ä¼ªç±»é€‰æ‹©å™¨ ä¼ªå…ƒç´ é€‰æ‹©å™¨ ï¼š\nå†…å±‚é€‰æ‹©å™¨å‰é¢æ²¡æœ‰ \u0026amp; ç¬¦å·ï¼Œåˆ™å®ƒè¢«è§£æä¸º çˆ¶é€‰æ‹©å™¨ çš„åä»£ å¦‚æœæœ‰ \u0026amp; ç¬¦å·ï¼Œå®ƒå°±è¢«è§£æä¸º çˆ¶å…ƒç´ è‡ªèº« / çˆ¶å…ƒç´ çš„ä¼ªç±» // less.less a { color: red; :hover { color: blue; } } // 2 a { color: red; \u0026amp;:hover {\t//æ·»åŠ  \u0026amp; ç¬¦å· color: blue; } } /* less.css */ /* 1 */ a { color: red; /* ä¸­é—´æœ‰ç©ºæ ¼ï¼Œå˜æˆåä»£é€‰æ‹©å™¨ */ } a :hover { color: blue; } /* 2 */ a { color: red; /* æ­£å¸¸è§£æ */ } a:hover { color: blue; } è¿ç®— ä»»ä½•æ•°å­—ã€é¢œè‰²æˆ–è€…å˜é‡éƒ½å¯ä»¥å‚ä¸è¿ç®—ã€‚\nLESS æä¾›äº†åŠ ï¼ˆ+ï¼‰ã€å‡ï¼ˆâˆ’ï¼‰ã€ä¹˜ï¼ˆÃ—ï¼‰ã€é™¤ï¼ˆÃ·ï¼‰å››ç§ç¬¦å·ã€‚\nNOTE:\nä¹˜å· * ã€é™¤å· / è¿ç®—ç¬¦ä¸­é—´å·¦å³ç”± ç©ºæ ¼ åˆ†å¼€ï¼ˆç±»ä¼¼ CSS ä¸­çš„ calcï¼‰ å¯¹äºä¸¤ä¸ª ä¸åŒå•ä½ çš„å€¼çš„è¿ç®—ï¼Œç»“æœå– ç¬¬ä¸€ä¸ªå€¼ çš„å•ä½ è‹¥ä¸¤ä¸ªå€¼ä¹‹é—´åªæœ‰ä¸€ä¸ªå€¼æœ‰å•ä½ï¼Œåˆ™ç»“æœå°±å–è¯¥å•ä½ LESS 4.0 ä¹‹åï¼Œé™¤æ³•å¤–é¢å¿…é¡»åŠ ä¸Šæ‹¬å· ()ï¼Œå¦åˆ™ä¸æ‰§è¡Œè®¡ç®— æˆ–è€…ä½¿ç”¨ ./ ä»£æ›¿ï¼Œä»¥å¼ºåˆ¶æ‰§è¡Œé™¤æ³•è®¡ç®—ï¼ˆdepreciatedï¼‰ //LESS @border: 10px + 5; //è¿ç®—ä»¥ç¬¬ä¸€ä¸ªå•ä½ä¸ºå‡† width: (@width + 5) * 2; div { border: @border solid red; } // 2 @baseFont: 50px; html { font-size: @baseFont; } img { height: (82rem / @baseFont); width: 82rem / @baseFont; } /* ç”Ÿæˆçš„CSS */ div { border:15px solid red; } /* 2 */ html { font-size: 50px; } img { height: 1.64rem; //ç»“æœä»¥ç¬¬ä¸€ä¸ªå•ä½ä¸ºå‡† width: 82rem / 50px; //ä¸åŠ æ‹¬å·ä¸ä¼šæ­£ç¡®ç”Ÿæˆ } ","date":"2023-03-20","section":"techs","summary":"CSS CSS - Cascading Style Sheets å±‚å æ ·å¼è¡¨\nHTMLè¡¨è¾¾ç»“æ„ï¼ŒCSSè¡¨è¾¾æ ·å¼ æ ·å¼å’Œå†…å®¹/ç»“æ„æ˜¯åˆ†ç¦»çš„ \u0026lt;!-- ä½¿ç”¨æ–¹æ³• --\u0026gt; \u0026lt;!-- æ–¹æ³•1ï¼šè¡Œå†…æ ·å¼ --\u0026gt; \u0026lt;block style=\u0026#34;property:value;\u0026#34;\u0026gt;\u0026lt;/block\u0026gt; \u0026lt;!-- æ–¹æ³•2:å†…éƒ¨æ ·å¼è¡¨ --\u0026gt; \u0026lt;head\u0026gt; \u0026lt;style\u0026gt; selector{ property:value; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;!-- æ–¹æ³•3:å¤–éƒ¨æ ·å¼è¡¨ --\u0026gt; \u0026lt;!-- aï¼šé“¾æ¥å¼ --\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;path\u0026#34; /\u0026gt; \u0026lt;!-- bï¼šå¯¼å…¥å¼ --\u0026gt; \u0026lt;style\u0026gt; @import url(\u0026#34;css/style.css\u0026#34;); \u0026lt;/style\u0026gt; æˆ‘çš„ç¬¬ä¸€ä¸ªHTMLé¡µé¢\né€‰æ‹© æ ‡ç­¾ tag å½±å“èŒƒå›´å¤§ï¼Œå»ºè®®å°½é‡åº”ç”¨åœ¨å±‚çº§é€‰æ‹©å™¨ä¸­ã€‚\n\u0026lt;style\u0026gt; *{margin:0;padding:0}/* å½±å“æ‰€æœ‰çš„æ ‡ç­¾ */ div{color:red} /* å½±å“æ‰€æœ‰çš„divæ ‡ç­¾ */ \u0026lt;/style\u0026gt; Id # é€šè¿‡idåæ¥é€‰æ‹©å…ƒç´ ï¼Œä¸èƒ½å¤ç”¨ï¼Œ ä¸æ¨è ä½¿ç”¨ã€‚\n\u0026lt;style\u0026gt; #box{color:red} \u0026lt;/style\u0026gt; \u0026lt;div id=\u0026#34;box\u0026#34;\u0026gt;......\u0026lt;/div\u0026gt; \u0026lt;!--å¯¹åº”ä»¥ä¸Šä¸€æ¡æ ·å¼ï¼Œå…¶å®ƒå…ƒç´ ä¸å…è®¸åº”ç”¨æ­¤æ ·å¼--\u0026gt; ç±» . é€šè¿‡ç±»åæ¥é€‰æ‹©å…ƒç´ ï¼Œå¤šå¯¹å¤šã€‚\n\u0026lt;style\u0026gt; .red{color:red} .big{font-size:20px} .mt10{margin-top:10px} *.important{color:red} p.important{color:red}/*ç»„åˆä½¿ç”¨*/ p .important{color:red}/*æœ‰ç©ºæ ¼æ—¶å°±æ˜¯å±‚çº§é€‰æ‹©å™¨*/ \u0026lt;/style\u0026gt; \u0026lt;div class=\u0026#34;red\u0026#34;\u0026gt;......\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;important warning\u0026#34;\u0026gt;......\u0026lt;/div\u0026gt; \u0026lt;!--ä¸€ä¸ªå…ƒç´ å¯ä»¥åŒæ—¶å±äºå¤šä¸ªç±»--\u0026gt; å­ä»£ \u0026gt; ä¾æ® HTML æ ‡ç­¾çš„åµŒå¥—å…³ç³»ï¼Œé€‰æ‹©çˆ¶å…ƒç´ ä¸­å­ä»£ä¸­æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ã€‚\n","title":"04 CSS","url":"/techs/04-css/"},{"content":"JavaScript å¯¼è®º æ˜¯ä¸€ç§å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„è„šæœ¬è¯­è¨€\næµè§ˆå™¨ç«¯çš„åŠ¨ä½œ ç”¨æˆ·äº¤äº’ æ•°æ®å¤„ç† å’Œ Java åŒºåˆ«ï¼š\nJava éœ€è¦ ç¼–è¯‘ JavaScript æ˜¯ è§£é‡Šæ€§ è¯­è¨€ JavaScript æºä»£ç æ”¾åœ¨ HTML é‡Œ JavaScript ç”± EcmaScript (JavaScriptè¯­æ³•)ã€DOM (é¡µé¢æ–‡æ¡£å¯¹è±¡æ¨¡å‹)ã€BOM (æµè§ˆå™¨å¯¹è±¡æ¨¡å‹) ç»„æˆã€‚\n1997 å¹´ï¼Œæ¬§æ´²è®¡ç®—æœºåˆ¶é€ å•†åä¼š ECMA è®¾ç½®äº† JavaScript çš„æ ‡å‡†ï¼Œå‘½åä¸º ECMAScriptã€‚\nJavaScript å®ç°äº† EcmaScript\nEcmaScript è§„èŒƒäº† JavaScript\nåŒºåˆ« å‰ç«¯è¯­è¨€ï¼šå¤„ç† ç•Œé¢ ï¼ˆHTMLã€CSSã€JavaScriptã€â€¦â€¦ï¼‰\nåç«¯è¯­è¨€ï¼šå¤„ç† æ•°æ® ï¼ˆJavaã€PHPã€Pythonã€Goã€â€¦â€¦ï¼‰\næµè§ˆå™¨/APPå‰ç«¯\tâ‡† HTTP åè®® â‡† æœåŠ¡å™¨åç«¯\nä¼ ç»Ÿçš„ JS æ˜¯ä¸€é—¨å‰ç«¯è¯­è¨€ï¼Œåªèƒ½è¿è¡Œåœ¨æµè§ˆå™¨ç«¯ï¼Œä¸èƒ½åœ¨æœåŠ¡å™¨ç«¯å¤„ç†æ•°æ®ã€‚\nåœ¨ 2009 å¹´ï¼Œè¯ç”Ÿäº† Node.js ï¼Œè¿™æ˜¯ä¸€ä¸ª JavaScript çš„æœåŠ¡ç«¯è¿è¡Œå¹³å°ã€‚\nNode.js å‡ºç°åï¼ŒJavaScript å¼€å§‹æ”¯æŒåç«¯ã€‚\nå¼•å…¥ è¡Œå†…å¼ JS ç›´æ¥å†™åˆ°å…ƒç´ çš„å†…éƒ¨ å¯ä»¥å°†å•è¡Œæˆ–å°‘é‡ JS ä»£ç å†™åœ¨ HTML æ ‡ç­¾çš„äº‹ä»¶å±æ€§ä¸­ï¼ˆä»¥ on å¼€å¤´çš„å±æ€§ï¼‰ï¼Œå¦‚ï¼šonclick æ³¨æ„å•åŒå¼•å·çš„ä½¿ç”¨ï¼šåœ¨HTMLä¸­æˆ‘ä»¬æ¨èä½¿ç”¨ åŒå¼•å· ï¼ŒJSä¸­æˆ‘ä»¬æ¨èä½¿ç”¨ å•å¼•å· å¯è¯»æ€§å·®ï¼Œåœ¨ HTML ä¸­ç¼–å†™å¤§é‡ä»£ç æ—¶ï¼Œä¸æ–¹ä¾¿é˜…è¯» å¼•å·æ˜“é”™ï¼Œå¼•å·å¤šå±‚åµŒå¥—åŒ¹é…æ—¶ï¼Œéå¸¸å®¹æ˜“å¼„æ·· ç‰¹æ®Šæƒ…å†µä¸‹ä½¿ç”¨ \u0026lt;input type=\u0026#34;button\u0026#34; value=\u0026#34; \u0026#34; onAction=\u0026#34; \u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;button\u0026#34; value=\u0026#34;è¿™æ˜¯ä¸€ä¸ªæŒ‰é’®\u0026#34; onclick=\u0026#34;alert(\u0026#39;Hello World!\u0026#39;);\u0026#34;\u0026gt; å†…åµŒå¼ å®šä¹‰åœ¨ head ä¸­ å¯ä»¥å°†å¤šè¡Œ JS ä»£ç å†™å…¥ script æ ‡ç­¾ä¸­ å†…åµŒ JS æ˜¯å­¦ä¹ æ—¶å¸¸ç”¨çš„æ–¹å¼ \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;zh\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Title\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body onload=\u0026#34;alert(\u0026#39;hi\u0026#39;)\u0026#34;\u0026gt; \u0026lt;!--onloadå±æ€§è½½å…¥--\u0026gt; \u0026lt;script\u0026gt; document.write(\u0026#34;\u0026lt;h1\u0026gt;hello World!\u0026lt;/h1\u0026gt;\u0026#34;); console.log(\u0026#34;hello world!\u0026#34;); //.æ˜¯ä¸€ä¸ªè¿ç®—ç¬¦ \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; // e.g.: /* 1. äº‹ä»¶å¤„ç†å™¨ */ onMouseOver=\u0026#34;alert(\u0026#39;hi\u0026#39;);\u0026#34; //-\u0026gt; bodyäº‹ä»¶ - onLoad - onUnload - etc... /* 2. ç®€å•å¯¹è¯æ¡† */ //-\u0026gt; - alert() - confirm() - prompt() /* 3. å®šæ—¶å™¨ */ //-\u0026gt; - setInterval() \u0026gt;\u0026gt; let count = 5; let update = () =\u0026gt; { if (count\u0026gt;0) count--; document.title=count; } setInterval(update, 1000); - setTimeOut() å¤–éƒ¨å¼•å…¥ script åŒæ ‡ç­¾ åˆ©äºæŠŠ HTML ç»“æ„åŒ–ï¼Œæ–¹ä¾¿æ–‡ä»¶çš„å¤ç”¨ åŒæ ‡ç­¾ï¼Œæœ‰ src å±æ€§åæ ‡ç­¾ä¸­é—´ä¸èƒ½å†™ä»£ç  \u0026lt;script src=\u0026#34;my.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;!-- Obsolete syntax - Before HTML5 --\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; I/O ç±»ä¼¼ Javaï¼Œ JavaScript æä¾›äº†ä¸€äº›å¸¸ç”¨çš„è¾“å…¥è¾“å‡ºè¯­å¥ã€‚\næ–¹æ³• è¯´æ˜ å½’å± alert(msg) æµè§ˆå™¨å¼¹å‡ºè­¦ç¤ºæ¡† æµè§ˆå™¨ console.log(msg) æµè§ˆå™¨æ§åˆ¶å°æ‰“å°è¾“å‡ºä¿¡æ¯ æµè§ˆå™¨ prompt(info) æµè§ˆå™¨å¼¹å‡ºè¾“å…¥æ¡†,ç”¨æˆ·å¯ä»¥è¾“å…¥ æµè§ˆå™¨ æ‚é¡¹ è§£é‡Šå‹è¯­è¨€å’Œç¼–è¯‘å‹è¯­è¨€ è®¡ç®—æœºä¸èƒ½ç›´æ¥ç†è§£ä»»ä½•é™¤æœºå™¨è¯­è¨€ä»¥å¤–çš„è¯­è¨€ï¼Œæ‰€ä»¥å¿…é¡»è¦æŠŠç¨‹åºå‘˜æ‰€å†™çš„ç¨‹åºè¯­è¨€ç¿»è¯‘æˆæœºå™¨è¯­è¨€æ‰èƒ½æ‰§è¡Œç¨‹åºã€‚\nç¨‹åºè¯­è¨€ç¿»è¯‘æˆæœºå™¨è¯­è¨€çš„å·¥å…·ï¼Œè¢«ç§°ä¸º ç¿»è¯‘å™¨ ã€‚\nç¿»è¯‘å™¨ç¿»è¯‘çš„æ–¹å¼æœ‰ä¸¤ç§ï¼šç¼–è¯‘ã€è§£é‡Šã€‚ ä¸¤ç§æ–¹å¼ä¹‹é—´çš„åŒºåˆ«åœ¨äºç¿»è¯‘çš„æ—¶é—´ç‚¹ä¸åŒï¼š ç¼–è¯‘å™¨ æ˜¯åœ¨ä»£ç æ‰§è¡Œä¹‹å‰è¿›è¡Œç¼–è¯‘ï¼Œç”Ÿæˆ ä¸­é—´ä»£ç  æ–‡ä»¶ è§£é‡Šå™¨ æ˜¯åœ¨è¿è¡Œæ—¶è¿›è¡ŒåŠæ—¶è§£é‡Šï¼Œå¹¶ ç«‹å³æ‰§è¡Œ ï¼ˆå½“ç¼–è¯‘å™¨ä»¥è§£é‡Šæ–¹å¼è¿è¡Œçš„æ—¶å€™ï¼Œä¹Ÿç§°ä¹‹ä¸ºè§£é‡Šå™¨ï¼‰ æ ‡è¯†(zhi)ç¬¦ã€å…³é”®å­—ã€ä¿ç•™å­— æ ‡è¯†ç¬¦ï¼šä¸ºå˜é‡ã€å±æ€§ã€å‡½æ•°ã€å‚æ•°å–çš„åå­—ï¼Œä¸èƒ½æ˜¯ ä¿ç•™å­— ã€‚\nå…³é”®å­—ï¼š break, case, catch, continue, default, delete, do, else, finally, for, function, if, in, instanceof, new, return, switch, this, throw, try, typeof, var, void, while, with \u0026hellip; etc.\nä¿ç•™å­—ï¼šç±»ä¼¼äºé¢„ç•™çš„â€å…³é”®å­—â€œï¼Œå³ä½¿ç°åœ¨è¿˜ä¸æ˜¯å…³é”®å­—ï¼Œä½†æœªæ¥å¯èƒ½ä¼šæˆä¸ºå…³é”®å­—ï¼Œå¹¶ä¸”ä¸èƒ½ä½¿ç”¨å®ƒä»¬å½“ å˜é‡å æˆ– æ–¹æ³•å ã€‚\nåŒ…æ‹¬: boolean, byte, char, class, const, debugger, double, enum, export, extends. fimal, float, goto, implements, import, int, interface, long, mative, package. private, protected, public, short, static, super, synchronized, throws, transient, volatile \u0026hellip; etc. å˜é‡ JavaScript ä¸­çš„å˜é‡ä¸º å¼±ç±»å‹ ã€‚ä½¿ç”¨ [TypeScript](06 TypeScript.md) å¯ä»¥å¼ºåˆ¶å®šä¹‰å˜é‡ç±»å‹ï¼Œä½¿å…¶æˆä¸ºä¸€é—¨ å¼ºç±»å‹ è¯­è¨€ã€‚\nå®šä¹‰å˜é‡ï¼švarï¼›å®šä¹‰å¸¸é‡ï¼šconst\nES6 å¼•å…¥æ–°ç±»å‹ï¼šlet\nvar hello;\t//variable hello = \u0026#34;hello\u0026#34;; document.write(hello); å¯ä»¥ä½œä¸ºå˜é‡åå­—ï¼š\nè‹±æ–‡å­—æ¯ï¼šAaBbCc\u0026hellip; æ•°å­—ï¼š123\u0026hellip; ä¸‹åˆ’çº¿ï¼š_ ç¾å…ƒç¬¦å·ï¼š\u0026amp; :memo: Note\nç¬¬ä¸€ä¸ªå­—ç¬¦ä¸èƒ½æ˜¯æ•°å­—ï¼Œä¸”å˜é‡åä¸­ä¸èƒ½æœ‰ç©ºæ ¼ï¼›å»ºè®®ä½¿ç”¨ å°é©¼å³°æ³• å¯¹å˜é‡è¿›è¡Œå‘½å\nä¸€ä¸ªå˜é‡è¢« é‡æ–°èµ‹å€¼ åï¼Œå®ƒåŸæœ‰çš„å€¼å°±ä¼šè¢«è¦†ç›–ï¼Œä»¥æœ€åä¸€æ¬¡çš„å€¼ä¸ºå‡†\nåŒæ—¶å£°æ˜å¤šä¸ªå˜é‡æ—¶ï¼Œåªéœ€å†™ä¸€ä¸ª var ï¼Œå¤šä¸ªå˜é‡åä¹‹é—´ç”±è‹±æ–‡é€—å·éš”å¼€\nä¸ç”¨ var å®šä¹‰ï¼Œè€Œç›´æ¥å°†å€¼èµ‹äºˆå®ƒï¼Œä¼šè‡ªåŠ¨å˜æˆå…¨å±€å˜é‡ï¼Œäº§ç”Ÿä½œç”¨åŸŸé—®é¢˜ã€‚ - å¯¹äºé™æ€å¼ºç±»å‹æ£€æŸ¥çš„è¯­è¨€ï¼Œä½¿ç”¨å‰å¿…é¡»å…ˆå£°æ˜ã€‚å¯ä»¥æ·»åŠ  \u0026quot;use strict\u0026quot;; å¼ºåˆ¶ä½¿ç”¨å‰æ£€æŸ¥\nå˜é‡å‘½åæ–¹æ³•ï¼š 1. é©¼å³°å‘½åæ³•ï¼šmathTestScore ï¼ˆæ¨èï¼‰ 2. C é£æ ¼å˜é‡å‘½åæ³•ï¼šmath_test_score\nvar age = 18, adderss = \u0026#34;loc\u0026#34; , money = \u0026#34;300\u0026#34;; ä»£ç  è¯´æ˜ ç»“æœ var age; console.log (age); åªå£°æ˜ä¸èµ‹å€¼ undefined console.log(age) ä¸å£°æ˜ä¸èµ‹å€¼ ç›´æ¥ä½¿ç”¨ æŠ¥é”™ age = 10; console.log (age); ä¸å£°æ˜åªèµ‹å€¼ 10 :memo: Note é€šè¿‡ emmit è¯­æ³•ï¼Œå¯ç›´æ¥è¾“å…¥ log æ¥å®ç°å¿«é€Ÿæ‰“å‡º console.log(); çš„æ•ˆæœ\nType å˜é‡æ²¡æœ‰ç±»å‹ï¼ˆå¼±ç±»å‹/åŠ¨æ€è¯­è¨€ï¼‰ï¼Œä½†å€¼æœ‰ç±»å‹ï¼Œè¿è¡Œæ—¶è¢«è‡ªåŠ¨ç¡®å®šã€‚\nå€¼ç±»å‹ï¼šæ•°å€¼ Numberã€å¸ƒå°”å€¼ Booleanã€å­—ç¬¦ä¸² String\nå¼•ç”¨ç±»å‹ï¼šå¯¹è±¡ Objectã€æ•°ç»„ Arrayã€å‡½æ•° Function ã€ç©ºç±»å‹ Nullã€æœªå®šä¹‰ Undefinedã€ç¬¦å· Symbol\nè¿™äº›éƒ½å±äº å¯¹è±¡ [ES6](06 EcmaScript.md/#symbol-es6) å¼•å…¥äº†ä¸€ç§æ–°çš„åŸå§‹æ•°æ®ç±»å‹ï¼šSymbolï¼Œè¡¨ç¤ºç‹¬ä¸€æ— äºŒçš„å€¼\nç±»ä¼¼ C è¯­è¨€çš„ æŒ‡é’ˆpointer åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œè§£æå¼•æ“ä¼šæ ¹æ® å³å€¼r-value è‡ªåŠ¨åˆ¤æ–­æ•°æ®ç±»å‹ï¼š\nvar x = 6;\t//xä¸ºæ•°å­— var x = \u0026#34;Bill\u0026#34;; //xä¸ºå­—ç¬¦ä¸² :memo: Note\nåœ¨ JavaScript ä¸­ï¼Œå­—ç¬¦ä¸²ç±»å‹ä¹Ÿå±äº å€¼ç±»å‹ ã€‚è¿™ä¸€ç‚¹å’Œå¤§éƒ¨åˆ†è¯­è¨€éƒ½ä¸åŒ :star: è°ƒç”¨å„ç§ åŸºç¡€ç±»å‹ æ–¹æ³•çš„æ—¶å€™ï¼Œ JavaScript å®é™…ä¸Šæ˜¯äº§ç”Ÿäº†ç›¸åº”çš„ä¸´æ—¶ åŒ…è£¹ç±» ï¼Œå¹¶åœ¨æ–¹æ³•æ‰§è¡Œå®Œæ¯•åè‡ªåŠ¨é”€æ¯ Number æ­¤æ•°æ®ç±»å‹ä»£è¡¨æ‰€æœ‰çš„æ•°å­—ã€‚\nğŸ”— Href æ•°å­¦ç±»\næ•°å€¼å­˜åœ¨æé™èŒƒå›´ï¼š\n+Infinityï¼Œä»£è¡¨ $$+\\infin $$ ï¼Œå¤§äºä»»ä½•æ•°å€¼ âˆ’Infinityï¼Œä»£è¡¨ $$-\\infin $$ ï¼Œå°äºä»»ä½•æ•°å€¼ NaNï¼ŒNot a Number ï¼Œä»£è¡¨ä¸€ä¸ªéæ•°å€¼ æå°å¸¸é‡ [Number.EPSILON](06 EcmaScript.md/#number-epsilon) (Number.MAX_VALUE); //1.7976931348623157e+308 (Number.MIN_VALUE); //5e-324 (Number.MAX_VALUE * 2); //Infinity (-Number.MAX_VALUE * 2); //-Infinity (NaN); //NaN :memo: Note\n0 $$\\div$$ 0 = NaN\nNaN ä¸è‡ªç­‰\n-\u0026gt; NaN == NaN \u0026gt;\u0026gt; false NaN æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ å€¼ ï¼Œè€Œé ç±»å‹ ï¼ŒisNaN() ç”¨æ¥åˆ¤æ–­æ˜¯å¦ä¸ºéæ•°å€¼ï¼Œè¿”å›å¸ƒå°”ç±»å‹ï¼š -\u0026gt; (isNaN(\u0026#39;String\u0026#39;)); \u0026gt;\u0026gt; true -\u0026gt; (isNaN(12)); \u0026gt;\u0026gt; false è¿›åˆ¶ å…«è¿›åˆ¶å‰åŠ 0ã€åå…­è¿›åˆ¶å‰åŠ 0xï¼š\n/* å…«è¿›åˆ¶æ•°å­—åºåˆ—èŒƒå›´ï¼š0ï½7 */ var num1 = 07; // å¯¹åº”åè¿›åˆ¶çš„7 var num2 = 019; // å¯¹åº”åè¿›åˆ¶çš„19 var num3 = 08; // å¯¹åº”åè¿›åˆ¶çš„8 /* 2. åå…­è¿›åˆ¶æ•°å­—æ•°åˆ—èŒƒå›´ 0ï½9 ä»¥åŠ Aï½F */ var num0x = 0xA; æµ®ç‚¹ ECMAScript æ ¹æ® IEEE754 çš„æ ‡å‡†å­˜æ”¾æµ®ç‚¹æ•°æ®ï¼Œè¿™ä¼šä½¿ä¸€äº›ä¸ªåˆ«çš„å°æ•°è¿ç®—äº§ç”Ÿ â€œä¸¢å¤±ç²¾åº¦â€ é—®é¢˜ã€‚\n-\u0026gt; 0.2+0.1 \u0026gt;\u0026gt; 0.30000000000000004 å¯è°ƒç”¨æ•°å­—çš„ toFixed() æ–¹æ³•ä¿ç•™æŒ‡å®šçš„å°æ•°ä½æ•°ï¼Œè¿”å› string ç±»å‹ã€‚\n-\u0026gt; (0.1 + 0.2).toFixed(2); \u0026gt;\u0026gt; \u0026#39;0.30\u0026#39; -\u0026gt; (0.9945).toFixed(3); \u0026gt;\u0026gt; \u0026#39;0.995\u0026#39; //ç»“æœå››èˆäº”å…¥ -\u0026gt; Number((0.1 + 0.2).toFixed(2)); \u0026gt;\u0026gt; 0.3 æœ€åè¦æ³¨æ„æµ®ç‚¹æ•°çš„ç›¸ç­‰æ¯”è¾ƒï¼š\n-\u0026gt; 1 / 3 === (1 - 2 / 3); \u0026gt;\u0026gt; false\t//è®¡ç®—æœºæ— æ³•ç²¾ç¡®è¡¨ç¤ºå°æ•° Math.abs(1 / 3 - (1 - 2 / 3)) \u0026lt; 0.0000001; \u0026gt;\u0026gt; true //è¡¨ç¤ºæ–¹æ³• æ–¹æ³• ToFixed toFixed æˆªå–æ—¶å››èˆäº”å…¥ï¼Œå¹¶è¿”å› string ç±»å‹ã€‚\nä»£ç  è¯´æ˜ numObj.toFixed(digits) ä¿ç•™æŒ‡å®šçš„ä½æ•° -\u0026gt; (12345.6789).toFixed() \u0026gt;\u0026gt; \u0026#39;12346\u0026#39; // å–æ•´ -\u0026gt; (12345.6789).toFixed(2) \u0026gt;\u0026gt; \u0026#39;12345.68\u0026#39; // ä¿ç•™ä¸¤ä½ String å¯ä»¥æ˜¯å¼•å·ä¸­çš„ä»»æ„æ–‡æœ¬ï¼Œå…¶è¯­æ³•ä¸º åŒå¼•å·\u0026quot;\u0026quot; å•å¼•å·'' ï¼Œ ES6 æ–°å¢äº†æ¨¡ç‰ˆå­—ç¬¦ä¸² (``) ï¼Œæ”¯æŒ äº’ç›¸åµŒå¥— ã€‚\n:link: Href [ES6](06 EcmaScript.md/#string-es6) å­—ç¬¦ä¸²å¯¹è±¡çš„æ–°å¢æ–¹æ³•\né€šè¿‡å­—ç¬¦ä¸²çš„ length å±æ€§å¯ä»¥è·å–æ•´ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ã€‚\n-\u0026gt; \u0026#39;Hello World\u0026#39;.length \u0026gt;\u0026gt; 11 å¤šä¸ªå­—ç¬¦ä¸²ä¹‹é—´å¯ä½¿ç”¨ + è¿›è¡Œæ‹¼æ¥\nå­—ç¬¦ä¸² + ä»»ä½•ç±»å‹ = æ–°å­—ç¬¦ä¸² + ï¼šæ•°å€¼ç›¸åŠ ã€å­—ç¬¦ç›¸è¿ å¯ä»¥é€šè¿‡ä¸‹æ ‡ç›´æ¥è®¿é—®æ•°ç»„æˆå‘˜\nconsole.log(\u0026#39;Hello world\u0026#39;[0]); //H for (const index in \u0026#39;Hello world\u0026#39;) { console.log(index); // 0 1 2 3 4 5 6 7 8 9 10 } for (const item of \u0026#39;Hello world\u0026#39;) { console.log(item); // H e l l o w o r l d } let str = \u0026#39;Hello world\u0026#39; str[1] = \u0026#39;E\u0026#39;; console.log(str); // Hello world // æ— æ³•é€šè¿‡ä¸‹æ ‡ä¿®æ”¹å­—ç¬¦ // æ˜¯å› ä¸ºjså¼•æ“åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¸´æ—¶ç”ŸæˆåŒ…è£¹ç±»new String() é€šè¿‡è½¬ä¹‰ç¬¦æ˜¾ç¤ºç‰¹æ®Šå­—ç¬¦ï¼š\nè½¬ä¹‰ç¬¦ è§£é‡Šè¯´æ˜ \\n æ¢è¡Œç¬¦ newline \\\\ æ–œæ  \\' å•å¼•å· \\\u0026quot; åŒå¼•å· \\t tab é”è¿› \\b ç©ºæ ¼ blank Prototypeï¼š\næ–¹æ³• åŠŸèƒ½ charAt() å¾—åˆ°æŒ‡å®šä½ç½®å­—ç¬¦ substring() æå–å­ä¸² substr() æå–å­ä¸² slice() æå–å­ä¸² toUpperCase() å°†å­—ç¬¦ä¸²å˜ä¸ºå¤§å†™ toLowerCase() å°†å­—ç¬¦ä¸²å˜ä¸ºå°å†™ indexOf() æ£€ç´¢å­—ç¬¦ä¸² :memo: Note indexOf() æ–¹æ³•è¿”å›è°ƒç”¨å®ƒçš„ String å¯¹è±¡ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå€¼çš„ç´¢å¼•ï¼Œä» fromIndex å¤„è¿›è¡Œæœç´¢ã€‚å¦‚æœæœªæ‰¾åˆ°è¯¥å€¼ï¼Œåˆ™è¿”å› -1ã€‚\nå¯ç”¨äºæ£€æµ‹ User Agent ä¸­æµè§ˆå™¨ç±»å‹ã€‚\nBoolean true / false\n(true + 1); //2 (false + 1); //1 Null ç©ºã€‚\nvar space = null; (null + \u0026#39;pink\u0026#39;); //ä»»ä½•ç±»å‹ + String = ç›´æ¥æ‹¼æ¥ (space + 1); //1 ç‹­ä¹‰ä¸Šï¼Œnull å¯ä»¥ç†è§£ä¸º â€œç©ºå¯¹è±¡â€ï¼Œè¿™æ ·å¯ä»¥åˆç†çš„è§£é‡Šä¸ºä»€ä¹ˆ null çš„ç±»å‹ä¸º objectã€‚\nä½†æ˜¯å‡†ç¡®çš„æ¥è¯´ï¼Œnull ä¸æ˜¯ä¸€ä¸ª â€œå¯¹è±¡â€ï¼Œå®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ â€œåŸºæœ¬æ•°æ®ç±»å‹â€ã€‚\n-\u0026gt; typeof null \u0026gt;\u0026gt; \u0026#39;object\u0026#39; Undefined å˜é‡å£°æ˜ä¹‹åæœªè¢«èµ‹å€¼ã€‚\nvar variable = undefined; (variable + \u0026#39;pink\u0026#39;); //ä»»ä½•ç±»å‹ + String = ç›´æ¥æ‹¼æ¥ (variable + 1); //NaN Typeof typeof æ˜¯ä¸€ä¸ª è¿ç®—ç¬¦ ï¼Œè€Œä¸æ˜¯å†…ç½®å‡½æ•°ï¼Œæ‰€ä»¥ä¸ç”¨åŠ  ()ï¼Œå¦‚æœåŠ äº†ä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œä½†æ˜¯å¹¶ä¸æ¨èã€‚\nè·å–æ£€æµ‹å˜é‡çš„ æ•°æ®ç±»å‹ ã€‚\nvar num = 10; (typeof num); //number var str = \u0026#39;pink\u0026#39;; (typeof str); //string var flag = true; (typeof vari) //boolean var vari = undefined (typeof vari); //undefined var timer = null; /* null is typeof object */ (typeof timer) //object å­—é¢é‡ å­—é¢é‡æ˜¯æºä»£ç ä¸­ä¸€ä¸ªå›ºå®šå€¼çš„è¡¨ç¤ºæ–¹æ³•ã€‚\n// 1. æ•°å€¼å­—é¢é‡ 8, 9, 10; // 2. å­—ç¬¦ä¸²å­—é¢é‡ \u0026#39;Hello World\u0026#39;, \u0026#39;front-end\u0026#39;; // 3. å¸ƒå°”å­—é¢é‡ true, false; å¯¹æ¯” æ‰€æœ‰çš„å˜é‡åˆ†ä¸ºä¸¤ç±»ï¼š åŸºæœ¬ç±»å‹å€¼ å’Œ å¼•ç”¨ç±»å‹å€¼ ã€‚ $$ \\mathrm{{\\small JavaScript}}\\ çš„æ•°æ®ç±»å‹\\begin{cases} åŸºæœ¬æ•°æ®ç±»å‹ \\begin{cases} æ•°å€¼ç±»å‹ \u0026 \\mathrm{Number} \\\\ å­—ç¬¦ä¸²ç±»å‹ \u0026 \\mathrm{String}\\\\ å¸ƒå°”ç±»å‹ \u0026 \\mathrm{Boolean}\\\\ ç©ºç±»å‹ \u0026 \\mathrm{Null}\\\\ æœªå®šä¹‰ \u0026 \\mathrm{Undefined}\\\\ ç¬¦å· \u0026 \\mathrm{Symbol} \u0026 {\\small ES\\ 6}\\\\ å¤§æ•´æ•° \u0026 \\mathrm{BigInt} \u0026 {\\small ES\\ Stage 3}\\\\ \\end{cases} \\\\ å¼•ç”¨æ•°æ®ç±»å‹ \\begin{cases} å¯¹è±¡ \u0026 \\mathrm{Object}\\begin{cases} å¯¹è±¡ \u0026 \\mathrm{Object} \\\\ æ•°ç»„ \u0026 \\mathrm{Array} \\\\ æ•°å­¦ \u0026 \\mathrm{Math} \\\\ æ—¶é—´ \u0026 \\mathrm{Date} \\\\ æ­£åˆ™ \u0026 \\mathrm{RegExp} \\\\ \\end{cases}\\\\ å‡½æ•° \u0026 \\mathrm{Function} \\end{cases} \\end{cases} $$ $$LaTeX$$ æ°¸è¿œçš„ç¥ï¼\nåŸºæœ¬ç±»å‹ å¼•ç”¨ç±»å‹ èµ‹å€¼ï¼švar a = b äº§ç”Ÿæ–°çš„å‰¯æœ¬ å¤åˆ¶åŸæŒ‡é’ˆ æ¯”è¾ƒï¼š== æ¯”è¾ƒå€¼æ˜¯å¦ç›¸ç­‰ æ¯”è¾ƒå†…å­˜åœ°å€ å…¨ç­‰ï¼š=== å…ˆè¦æ±‚ç±»å‹ç›¸ç­‰ æ¯”è¾ƒå†…å­˜åœ°å€ :memo: Note String ç±»å‹ä¹Ÿå±äºåŸºæœ¬ç±»å‹ã€‚\n:link: Href [ES6](06 EcmaScript.md/#object-is-es6) ä¸­çš„ Object.is() ä¹Ÿå¯ä»¥ç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªæ•°æ˜¯å¦ç›¸ç­‰\n:link: Href [ES6](06 EcmaScript.md/#symbol-es6) æ–°å¢äº† symbol åŸºæœ¬æ•°æ®ç±»å‹\nè½¬æ¢ ä½¿ç”¨ è¡¨å• ã€prompt() è·å–çš„æ•°æ®é»˜è®¤æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„ï¼Œæ­¤æ—¶ä¸èƒ½ç›´æ¥è¿›è¡Œæ•°å­—åŠ å‡ï¼ˆå‘ç”Ÿå­—ç¬¦ä¸²æ‹¼æ¥ï¼‰ï¼Œè€Œéœ€è¦å¯¹å˜é‡ç±»å‹è¿›è¡Œè½¬æ¢ï¼Œä¹Ÿå³æŠŠä¸€ç§æ•°æ®ç±»å‹è½¬æ¢ä¸ºå¦ä¸€ç§æ•°æ®ç±»å‹ã€‚\ne.g.: prompt() è·å–çš„â€œæ•°å­—â€ä»ç„¶æ˜¯å­—ç¬¦ç±»å‹çš„ã€‚\nvar age = prompt(\u0026#34;è¯·è¾“å…¥ä½ çš„å¹´é¾„\u0026#34;); console.log(age); console.log(typeof age) //string To String ä»£ç  è¯´æ˜ obj.toString() è½¬æˆå­—ç¬¦ä¸² String(obj) å¼ºåˆ¶è½¬æ¢ è½¬æˆå­—ç¬¦ä¸² $$+$$ æ‹¼æ¥ :memo: Note å¯ä»¥åŠ ä¸Šç©ºå­—ç¬¦''ç›´æ¥è½¬ä¸ºå­—ç¬¦ä¸²ã€‚\n-\u0026gt; typeof (12+\u0026#39;\u0026#39;) \u0026gt;\u0026gt; string //è¿™ç§æ–¹æ³•ä¹Ÿè¢«ç§°ä¸ºéšå¼è½¬æ¢ To Number æ–¹å¼ è¯´æ˜ æ¡ˆä¾‹ parselnt(str) å°† String ç±»å‹è½¬æˆ æ•´æ•° æ•°å€¼å‹ parselnt('78')' parseFloat(str) å°† String ç±»å‹è½¬æˆ æµ®ç‚¹æ•°æ•°å€¼å‹ parseFloat('78.21'); Number(str) å°† String ç±»å‹è½¬æ¢ä¸º æ•°å€¼å‹ Number('12'); $$+\\ -\\ \\times\\ \\div$$ åˆ©ç”¨ ç®—æœ¯è¿ç®— éšå¼è½¬æ¢ä¸ºæ•°å€¼å‹ '12' - 0; parseInt() -\u0026gt; parseInt(\u0026#39;120px\u0026#39;); \u0026gt;\u0026gt; 120 //ç¬¬ä¸€ä¸ªä¸ºæ•°å­—å³å¯å¼€å§‹è½¬æ¢ -\u0026gt; parseInt(\u0026#39;rem120px\u0026#39;); \u0026gt;\u0026gt; NaN -\u0026gt; parseInt(\u0026#39;3.99\u0026#39;);\t//ä¸å­˜åœ¨å››èˆäº”å…¥ \u0026gt;\u0026gt; 3 parseFloat() -\u0026gt; parseFloat(\u0026#39;3.14\u0026#39;); \u0026gt;\u0026gt; 3.14 -\u0026gt; parseFloat(\u0026#39;120px\u0026#39;); \u0026gt;\u0026gt; 120 //è‡ªåŠ¨æˆªå»ç¬¬ä¸€ä¸ªéæ•°å­—å­—ç¬¦ä¹‹åçš„æ‰€æœ‰å­—ç¬¦ Number() -\u0026gt; Number(\u0026#39;12\u0026#39;); \u0026gt;\u0026gt; 12 -\u0026gt; Number(\u0026#39;123å¹´\u0026#39;); \u0026gt;\u0026gt; NaN -\u0026gt; Number(\u0026#39;2e3\u0026#39;); \u0026gt;\u0026gt; 2000 éšå¼è½¬æ¢ -\u0026gt; typeof (\u0026#39;12\u0026#39; - 0); \u0026gt;\u0026gt; number -\u0026gt; \u0026#39;123\u0026#39; - \u0026#39;120\u0026#39;; \u0026gt;\u0026gt; 3 //å‘ç”Ÿäº†éšå¼è½¬æ¢ /* ä½†ä¸å»ºè®®è¿™æ ·ä½¿ç”¨ */ To Boolean æ–¹å¼ è¯´æ˜ æ¡ˆä¾‹ Boolean() å…¶å®ƒç±»å‹è½¬ä¸ºå¸ƒå°”å€¼ Boolean('true'); :memo: Note ä»£è¡¨ ç©ºã€å¦å®šçš„è¯éƒ½ä¼šè¢«è½¬æ¢ä¸º false ï¼Œå…¶ä½™å…¨éƒ¨å˜ä¸º trueï¼ˆåŒ…æ‹¬ Stringï¼‰\n''ã€0ã€NaNã€nullã€undefined -\u0026gt; Boolean(123); \u0026gt;\u0026gt; true -\u0026gt; Boolean(0); \u0026gt;\u0026gt; false -\u0026gt; Boolean(NaN); \u0026gt;\u0026gt; false -\u0026gt; Boolean(Infinity); \u0026gt;\u0026gt; true -\u0026gt; Boolean(-Infinity); \u0026gt;\u0026gt; true è¿ç®—ç¬¦ è¿ç®—ç¬¦(operator)ä¹Ÿè¢«ç§°ä¸º æ“ä½œç¬¦ ï¼Œæ˜¯ç”¨äºå®ç°èµ‹å€¼ã€æ¯”è¾ƒå’Œæ‰§è¡Œç®—æ•°è¿ç®—ç­‰åŠŸèƒ½çš„ç¬¦å·ã€‚\nç®—æ•° ç”¨äºæ‰§è¡Œä¸¤ä¸ªå˜é‡æˆ–å€¼ä¹‹é—´çš„ç®—æ•°è¿ç®—ï¼ŒåŒ…æ‹¬ $$+\\ - \\ \\times\\ \\div\\ \\%$$ ã€‚\nè¿ç®—ç¬¦ ç¬¦å· æè¿° $+$ + $a+b$ $-$ - $a-b$ $\\times$ * $a\\times b$ $\\div$ / $a\\div b$ $\\wedge$ ** $a^{b}$ :memo: Note æŒ‡æ•°è¿ç®—ç¬¦\nES2016 æ–°å¢äº†ä¸€ä¸ªæŒ‡æ•°è¿ç®—ç¬¦ï¼ˆ**ï¼‰ã€‚\n2 ** 2 // 4 2 ** 3 // 8 è¿™ä¸ªè¿ç®—ç¬¦çš„ä¸€ä¸ªç‰¹ç‚¹æ˜¯ å³ç»“åˆ ï¼Œè€Œä¸æ˜¯å¸¸è§çš„å·¦ç»“åˆã€‚å¤šä¸ªæŒ‡æ•°è¿ç®—ç¬¦è¿ç”¨æ—¶ï¼Œæ˜¯ä»æœ€å³è¾¹å¼€å§‹è®¡ç®—çš„ã€‚\n// ç›¸å½“äº 2 ** (3 ** 2) 2 ** 3 ** 2 // 512 ä¸Šé¢ä»£ç ä¸­ï¼Œé¦–å…ˆè®¡ç®—çš„æ˜¯ç¬¬äºŒä¸ªæŒ‡æ•°è¿ç®—ç¬¦ï¼Œè€Œä¸æ˜¯ç¬¬ä¸€ä¸ªã€‚\næŒ‡æ•°è¿ç®—ç¬¦å¯ä»¥ä¸ç­‰å·ç»“åˆï¼Œå½¢æˆä¸€ä¸ªæ–°çš„èµ‹å€¼è¿ç®—ç¬¦ï¼ˆ**=ï¼‰ã€‚\nlet a = 1.5; a **= 2; // ç­‰åŒäº a = a * a; let b = 4; b **= 3; // ç­‰åŒäº b = b * b * b; :memo: Note\nJS åœ¨æŸä¸ªæ•°æ®ç±»å‹å‰ä½¿ç”¨ + ï¼Œå¯ä»¥è°ƒç”¨å…¶è‡ªå¸¦çš„ valueOf æ–¹æ³•ï¼Œè‹¥æ–¹æ³•ä¸å­˜åœ¨æˆ–æ˜¯è¿”å›éåŸå§‹å€¼ ï¼Œåˆ™è°ƒç”¨ toString æ–¹æ³•ã€‚\nå› æ­¤ +new Date() ä¼šè°ƒç”¨ Date.prototype.valueOf()Â ï¼Œä»¥ä¸‹è¿”å›æ•ˆæœç­‰åŒï¼š\nnew Date().getTime() === new Date().valueOf() // true // è¿”å›æ•ˆæœç­‰åŒ + new Date() new Date().getTime() new Date().valueOf() new Date() * 1 é€’å¢å’Œé€’å‡ åŒ Cã€‚\næ¯”è¾ƒ è¿ç®—ç¬¦åç§° è¯´æ˜ æ¡ˆä¾‹ ç»“æœ \u0026lt; å°äº 1\u0026lt;2 true \u0026gt; å¤§äº 1\u0026gt;2 false \u0026gt;= å¤§äºç­‰äº 2\u0026gt;=2 true \u0026lt;= å°äºç­‰äº 3 \u0026lt;= 2 false == åˆ¤ç­‰å·ï¼ˆä¼šè½¬æ¢ï¼‰ 37 == 37 true = ä¸ç­‰å· 37!= 37 false === / !== å€¼\u0026amp;æ•°æ® å…¨ç­‰ 37 === '37' false é€»è¾‘ é€»è¾‘è¿ç®—ç¬¦ è¯´æ˜ æ¡ˆä¾‹ \u0026amp;\u0026amp; é€»è¾‘ä¸ï¼ˆ$$\\and$$ï¼‰ true \u0026amp;\u0026amp; false || é€»è¾‘æˆ–ï¼ˆ$$\\or$$ï¼‰ `true ! é€»è¾‘éï¼ˆ$$\\lnot$$ï¼‰ !true ä½è¿ç®—ç¬¦ è¿ç®—ç¬¦ åç§° æè¿° \u0026amp; AND $a\\ \\\u0026\\ b$ | OR $a\\ ^ XOR $a\\oplus b$ ~ NOT $\\bar{a}$ \u0026laquo; é›¶å¡«å……å·¦ä½ç§» $a\\ll b$ \u0026raquo; æœ‰ç¬¦å·å³ä½ç§» $a\\gg b$ \u0026raquo;\u0026gt; é›¶å¡«å……å³ä½ç§» $a\\ggg b$ èµ‹å€¼ èµ‹å€¼è¿ç®—ç¬¦ è¯´æ˜ æ¡ˆä¾‹ += ç›´æ¥èµ‹å€¼ var usrName = 'æˆ‘æ˜¯å€¼'; = åŠ ã€å‡ä¸€ä¸ªæ•°åå†èµ‹å€¼ var age = 10; age+=5; -\u0026gt; 15 *=ã€/=ã€%= ä¹˜ã€é™¤ã€å–æ¨¡åå†èµ‹å€¼ var age = 2; age*=5; -\u0026gt; 10 èµ‹å€¼è¿ç®—ä¹Ÿäº§ç”Ÿå€¼ï¼Œå¯ä»¥è¿ç»­ä½¿ç”¨èµ‹å€¼è¿ç®—ç¬¦ã€‚\nvar a, b, c; a = b = c = 15; ä¼˜å…ˆçº§ ä¸€å…ƒè¿ç®—ç¬¦é‡Œé¢çš„é€»è¾‘éä¼˜å…ˆçº§å¾ˆé«˜ é€»è¾‘ $$\\and$$ æ¯” é€»è¾‘ $$\\or$$ ä¼˜å…ˆçº§é«˜ å»ºè®®ä½¿ç”¨ () è§„å®šä¼˜å…ˆçº§ ä¼˜å…ˆçº§ è¿ç®—ç¬¦ é¡ºåº 1 å°æ‹¬å· () 2 ä¸€å…ƒè¿ç®—ç¬¦ ++ âˆ’âˆ’ ! 3 ç®—æ•°è¿ç®—ç¬¦ å…ˆ Ã— Ã· â‰¡ å + âˆ’ 4 å…³ç³»è¿ç®—ç¬¦ \u0026gt; â‰¥ \u0026lt; â‰¤ 5 ç›¸ç­‰è¿ç®—ç¬¦ == != === !== 6 é€»è¾‘è¿ç®—ç¬¦ å…ˆ \u0026amp;\u0026amp; å || 7 èµ‹å€¼è¿ç®—ç¬¦ = 8 é€—å·è¿ç®—ç¬¦ , -\u0026gt; (3\u0026gt;5\u0026amp;\u0026amp;2\u0026lt;7\u0026amp;\u0026amp;3==4); \u0026gt;\u0026gt; false -\u0026gt; (3\u0026lt;=4||3\u0026gt;1|3!=2) \u0026gt;\u0026gt; true -\u0026gt; (2==\u0026#34;2\u0026#34;); \u0026gt;\u0026gt; true -\u0026gt; (2===\u0026#34;2\u0026#34;); \u0026gt;\u0026gt; false æ§åˆ¶ é¡ºåº é¡ºåºç»“æ„æ˜¯ç¨‹åºä¸­æœ€ç®€å•ã€æœ€åŸºæœ¬çš„æµç¨‹æ§åˆ¶ï¼Œå®ƒæ²¡æœ‰ç‰¹å®šçš„è¯­æ³•ç»“æ„ï¼Œç¨‹åºä¼šæŒ‰ç…§ä»£ç çš„å…ˆåé¡ºåºï¼Œä¾æ¬¡æ‰§è¡Œã€‚ç¨‹åºä¸­å¤§å¤šæ•°çš„ä»£ç éƒ½æ˜¯è¿™æ ·æ‰§è¡Œçš„ã€‚\nåˆ†æ”¯ ç”±ä¸Šåˆ°ä¸‹æ‰§è¡Œä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œæ ¹æ®ä¸åŒçš„æ¡ä»¶æ‰§è¡Œä¸åŒçš„è·¯å¾„ä»£ç ï¼ˆæ‰§è¡Œä»£ç å¤šé€‰ä¸€çš„è¿‡ç¨‹ï¼‰ï¼Œä»è€Œå¾—åˆ°ä¸åŒçš„ç»“æœã€‚\nIf-else if (condition) { statement1; } else { statement2; } :memo: Note JSä¸­æ²¡æœ‰è¿æ¯”ï¼Œ3 \u0026lt;= a \u0026lt;= 15 çš„å†™æ³•æ˜¯é”™è¯¯çš„ï¼Œåº”è¯¥ä¸ºï¼ša \u0026gt;= 3 \u0026amp;\u0026amp; a \u0026lt;= 15ã€‚\nä¸‰å…ƒè¿ç®—ç¬¦ Conditional operator\ncondition ? exprIfTrue : exprIfFalse; Switch å¤šåˆ†æ”¯è¯­å¥ã€‚å¿…é¡»è¦ å€¼ å’Œ æ•°æ® ç±»å‹ä¸€è‡´æ‰å¯ä»¥ï¼Œå³ å…¨ç­‰ ===ï¼› default ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†ä¸ç”¨ break å°±ä¸ä¼šè·³å‡º switch ã€‚\nä¸ if å¯¹æ¯”ï¼š\nä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªè¯­å¥å¯ä»¥äº’æ¢ switch..case è¯­å¥é€šå¸¸å¤„ç† case ä¸ºæ¯”è¾ƒç¡®å®šå€¼çš„æƒ…å†µï¼Œè€Œ if..else.. è¯­å¥æ›´åŠ çµæ´»ï¼Œå¸¸ç”¨äºèŒƒå›´åˆ¤æ–­ åˆ†æ”¯å°‘ if ï¼Œåˆ†æ”¯å¤š switch switch (expression) { case value1: //Statements executed when the //result of expression matches value1 [break;] case value2: statement2; [break;] ... case valueN: statementN; [break;] [default: statement default; [break;]] } çŸ­è·¯ å½“æœ‰å¤šä¸ªè¡¨è¾¾å¼ã€å·¦è¾¹çš„è¡¨è¾¾å¼å¯ä»¥ç›´æ¥ç¡®å®šç»“æœæ—¶ï¼Œå°±ä¸å†è®¡ç®—å³è¾¹çš„è¡¨è¾¾å¼çš„å€¼ï¼Œç§°ä¸º çŸ­è·¯è¿ç®—ã€‚\n:memo: Note\n\u0026amp;\u0026amp; æ—¶ï¼Œæ‰¾åˆ°ä¸º false çš„åˆ†é¡¹å°±åœæ­¢å¤„ç†ï¼Œå¹¶è¿”å›è¯¥åˆ†é¡¹çš„å€¼ï¼Œå¦åˆ™å°±æ‰§è¡Œå®Œï¼Œå¹¶è¿”å›æœ€åçš„åˆ†é¡¹çš„å€¼ã€‚ ||æ‰¾åˆ°ä¸º true çš„åˆ†é¡¹å°±åœæ­¢å¤„ç†ï¼Œå¹¶è¿”å›è¯¥åˆ†é¡¹çš„å€¼ï¼Œå¦åˆ™æ‰§è¡Œå®Œï¼Œå¹¶è¿”å›æœ€åçš„åˆ†é¡¹çš„å€¼ï¼› é€»è¾‘ $$\\and$$ è¯­æ³•ï¼šè¡¨è¾¾å¼1 \u0026amp;\u0026amp; è¡¨è¾¾å¼2\né‡ å‡ è¿” å‡ï¼Œæ— å‡è¿”å›æœ«å°¾è¡¨è¾¾å¼ã€‚\n:page_with_curl: Example\n-\u0026gt; (123 \u0026amp;\u0026amp; 456); \u0026gt;\u0026gt; 456 //è¡¨è¾¾å¼1 -\u0026gt; (0 \u0026amp;\u0026amp; 456); \u0026gt;\u0026gt; 0 //è¡¨è¾¾å¼2 -\u0026gt; (0 \u0026amp;\u0026amp; 1 + 2 \u0026amp;\u0026amp; 456 * 56789); // å¦‚æœæœ‰ç©ºçš„æˆ–å¦å®šçš„ä¸ºå‡ å…¶ä½™ä¸ºçœŸ // 0 \u0026#39;\u0026#39; null undefined NaN \u0026gt;\u0026gt; 0 :warning: Caution AND \u0026amp; æŒ‰ä½ä¸\nThe bitwise AND operator \u0026amp; returns a 1 in each bit position for which the corresponding bits of both operands are 1s.\nconst a = 5; // 00000000000000000000000000000101 const b = 3; // 00000000000000000000000000000011 console.log(a \u0026amp; b); // 00000000000000000000000000000001 \u0026gt;\u0026gt; 1 é€»è¾‘ $$\\or$$ é‡ çœŸ è¿” çœŸ ï¼Œæ— çœŸè¿”å›æœ«å°¾è¡¨è¾¾å¼ã€‚\n:page_with_curl: Example\n-\u0026gt; (\u0026#39;\u0026#39;||false||NaN); \u0026gt;\u0026gt; 0 -\u0026gt; typeof(\u0026#39;\u0026#39;||false||NaN); \u0026gt;\u0026gt; number -\u0026gt; (123 || 456); // 123 -\u0026gt; (0 || 456); // 456 -\u0026gt; (123 || 456 || 789); //123 :warning: Caution Bitwise OR | æŒ‰ä½æˆ–\nThe bitwise OR operator | returns a 1 in each bit position for which the corresponding bits of either or both operands are 1s.\nconst a = 5; // 00000000000000000000000000000101 const b = 3; // 00000000000000000000000000000011 -\u0026gt; console.log(a | b); // 00000000000000000000000000000111 \u0026gt;\u0026gt; 7 å¾ªç¯ For for ([initialization]; [condition]; [final-expression]) statement; For-in :link: Href Object [for-in]( 06 EcmaScript.md#object-for-in)\n:link: Href [for-of ä¸ for-in åŒºåˆ«](06 EcmaScript.md#for-of-for-in-es6)\néå†é”®å object ã€‚å®ƒå¯ä»¥æŠŠä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§ä¾æ¬¡å¾ªç¯å‡ºæ¥ã€‚\nfor (let key in object) { // åªéå†å¯æšä¸¾å±æ€§ // ä¼šè‡ªåŠ¨æŠŠé”®åè½¬ä¸ºstringç±»å‹ statement; } è¦è¿‡æ»¤æ‰å¯¹è±¡ ç»§æ‰¿ çš„å±æ€§ï¼Œå¢åŠ  hasOwnProperty() åˆ¤æ–­ï¼š\nfor (let key in object) { if (hasOwnProperty()) { statement; } } ç”±äºæ•°ç»„ä¹Ÿæ˜¯å¯¹è±¡ï¼Œè€Œå®ƒçš„æ¯ä¸ªå…ƒç´ çš„ç´¢å¼•è¢«è§†ä¸ºå¯¹è±¡çš„å±æ€§ï¼Œå› æ­¤ï¼Œfor ... in å¾ªç¯å¯ä»¥ç›´æ¥å¾ªç¯å‡ºæ•°ç»„çš„ç´¢å¼•ï¼š\nfor (const i in a) { console.log(i); // \u0026#39;0\u0026#39;, \u0026#39;1\u0026#39;, \u0026#39;2\u0026#39; console.log(a[i]); // \u0026#39;A\u0026#39;, \u0026#39;B\u0026#39;, \u0026#39;C\u0026#39; console.log([typeof i, typeof a[i]]); //[ \u0026#39;string\u0026#39;, \u0026#39;string\u0026#39; ] } :memo: Note å¯¹æ•°ç»„çš„å¾ªç¯å¾—åˆ°çš„ç´¢å¼•ç±»å‹æ˜¯ string è€Œä¸æ˜¯ number ã€‚\nFor-of éå†é”®å€¼array ï¼Œåœ¨ å¯è¿­ä»£å¯¹è±¡iterable ä¸Šåˆ›å»ºä¸€ä¸ªè¿­ä»£å¾ªç¯ã€‚\n:link: Href\n[Object](06 EcmaScript.md/#object-traversal) çš„éå†å™¨ [iterator](06 EcmaScript.md/#iterator-es6) éå†æ¥å£ :memo: Note Object ç±»å‹é»˜è®¤æ˜¯ ä¸å¯éå† çš„ï¼Œå¯é€šè¿‡ Object è¿­ä»£å™¨iterator è¿›è¡ŒåŒ…è£¹ä»è€Œå®ç°éå†ã€‚\nfor (variable of iterable) { statement; } While while (condition) statement; Do-while do { statement; } while (condition); æ§åˆ¶ breakï¼šè·³å‡ºå¾ªç¯ continueï¼šè·³è¿‡å¹¶è¿›å…¥ä¸‹ä¸€è½® æ¯”è¾ƒ ä¸‰ç§å¾ªç¯ for, while, do-while çš„åŠŸèƒ½æ˜¯ç­‰ä»·çš„ å¦‚æœéœ€è¦å¾ªç¯è‡³å°‘æ‰§è¡Œä¸€æ¬¡ï¼Œdo é€šå¸¸æ˜¯æ›´å¥½çš„é€‰æ‹© å½“å¾ªç¯çš„æ¬¡æ•°æ˜¯å›ºå®šçš„ï¼Œæˆ–è€…å¾ˆå®¹æ˜“è®¡ç®—å¾—åˆ°çš„æ—¶å€™ï¼Œé€‰æ‹© for å¾ªç¯ :page_with_curl: Example\ne.g.: æ±‚æœ€å¤§å…¬çº¦æ•°\n/* * é—®é¢˜ï½œæ‰¾åˆ°ä¸¤ä¸ªéè´Ÿæ•´æ•°uå’Œvçš„æœ€å¤§å…¬çº¦æ•°gcd * æ–¹æ³•ï½œè¾—è½¬ç›¸é™¤æ³• * ç¬¬ä¸€æ­¥ï¼šå¦‚æœvç­‰äº0ï¼Œgcdå°±æ˜¯uï¼Œç®—æ³•ç»“æŸ * ç¬¬äºŒæ­¥ï¼šè®¡ç®—temp = u%vï¼Œu=vï¼Œv=tempï¼Œç„¶åå›åˆ°ç¬¬ä¸€æ­¥ */ let u = 42; let v = 21; let temp = v; while (v != 0) { temp = u % v; u = v; v = temp; } alert(u + \u0026#34;å’Œ\u0026#34; + v + \u0026#34;çš„æœ€å¤§å…¬çº¦æ•°æ˜¯\u0026#34; + u); è°ƒè¯• æ–­ç‚¹è°ƒè¯• æ˜¯æŒ‡è‡ªå·±åœ¨ç¨‹åºçš„æŸä¸€è¡Œè®¾ç½®ä¸€ä¸ªæ–­ç‚¹ã€‚\nè°ƒè¯•æ—¶ï¼Œç¨‹åºè¿è¡Œåˆ°è¿™ä¸€è¡Œå°±ä¼šåœä½ï¼Œç„¶åä½ å¯ä»¥ä¸€æ­¥ä¸€æ­¥å¾€ä¸‹è°ƒè¯•ï¼Œè°ƒè¯•è¿‡ç¨‹ä¸­å¯ä»¥çœ‹å„ä¸ªå˜é‡å½“å‰çš„å€¼ï¼Œå‡ºé”™çš„è¯ï¼Œè°ƒè¯•åˆ°å‡ºé”™çš„ä»£ç è¡Œå³æ˜¾ç¤ºé”™è¯¯ï¼Œåœä¸‹ã€‚\nä½¿ç”¨ï¼š\næµè§ˆå™¨ä¸­æŒ‰ F12 â†’ Sources â†’ æ‰¾åˆ°éœ€è¦è°ƒè¯•çš„æ–‡ä»¶ â†’ åœ¨ç¨‹åºçš„æŸä¸€è¡Œè®¾ç½®æ–­ç‚¹ã€‚\næ•°ç»„Â The Array object, enables storing a collection of multiple items under a single variable name, and has members for performing common array operations\n[ES6](06 EcmaScript.md/#array-es6) åˆåœ¨åŸæœ‰çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†æ‰©å±•ã€‚\nå…è®¸åŠ¨æ€å¢é•¿\nlet A = new Array(); let B = new Array(size); //typeof B[0] -\u0026gt; undefined let C = new Array(d1, d2, ..., dn); let D = [d1, d2, ..., dn]; è®¿é—® ä½¿ç”¨ [] è¿ç®—ç¬¦è®¿é—®æ•°ç»„ä¸­çš„ä¸€ä¸ªå•å…ƒï¼Œä¸‹æ ‡ä» 0 å¼€å§‹ã€‚\na[x] = n åˆ›å»ºäº†å¹¶èµ‹å€¼æ•°ç»„ä¸­çš„å•å…ƒ x ä¸º n ã€‚\n/* ä¸‹æ ‡è¶Šç•Œä¸ä¼šæŠ¥é”™ */ -\u0026gt; [0,1][1]; \u0026gt;\u0026gt; 1 -\u0026gt; [0,1][2]; \u0026gt;\u0026gt; undefined å±æ€§ length è¿”å›æˆå‘˜æ•°ç›®ï¼ˆå¯¹ string ä¹Ÿæœ‰æ•ˆï¼‰ï¼Œä¿®æ”¹è¯¥å±æ€§å¯ä»¥ç›´æ¥ä¿®æ”¹æ•°ç»„é•¿åº¦ã€‚\n/* å¯ä»¥é€šè¿‡ä¸‹æ ‡å¯¹æ•°ç»„ç›´æ¥èµ‹å€¼ï¼Œè‹¥ä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»º */ -\u0026gt; let arr = new Array(0,1,2); -\u0026gt; console.log(arr); -\u0026gt; arr[arr.length]=\u0026#34;new\u0026#34;; -\u0026gt; console.log(arr); \u0026gt;\u0026gt; [ 0, 1, 2] \u0026gt;\u0026gt; [ 0, 1, 2, \u0026#39;new\u0026#39; ] æ–¹æ³• æ•°ç»„çš„ prototype è‡ªå¸¦äº†ä¸€äº›æ–¹æ³•ï¼š\nç±»å‹æ£€æŸ¥ -\u0026gt; Array.isArray([1, 2, 3]); \u0026gt;\u0026gt; true -\u0026gt; Array.isArray([]); \u0026gt;\u0026gt; true æ•°ç»„çš„éå† -\u0026gt; let arr = [1, 2, 3, 4]; for (let i = 0; i \u0026lt; arr.length; i++) { console.log(arr[i]); } \u0026gt;\u0026gt; 1ï¼Œ2ï¼Œ3ï¼Œ4 -\u0026gt; let arr = [\u0026#39;A\u0026#39;,\u0026#39;B\u0026#39;,\u0026#39;C\u0026#39;]; for (const i in arr) { console.log(i); // \u0026#39;0\u0026#39;, \u0026#39;1\u0026#39;, \u0026#39;2\u0026#39; console.log(a[i]); // \u0026#39;A\u0026#39;, \u0026#39;B\u0026#39;, \u0026#39;C\u0026#39; console.log([typeof i, typeof a[i]]); //[ \u0026#39;string\u0026#39;, \u0026#39;string\u0026#39; ] } forEach è¯­æ³• array.forEach(callback(currentvalue, index, arr), thisValue); å…¶ä¸­ callback ä¸ºæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ æ‰§è¡Œçš„å‡½æ•°ï¼Œè¯¥å‡½æ•°å¯æ¥å— 1-3 ä¸ªå‚æ•°ï¼š\ncurrentvalue è¡¨ç¤ºæ•°ç»„çš„å½“å‰å…ƒç´ é¡¹ï¼Œå¿…é¡»\nindex è¡¨ç¤ºçš„å½“å‰å…ƒç´ ä¸‹æ ‡ï¼Œå¯é€‰\narr è¡¨ç¤ºå½“å‰å…ƒç´ æ‰€å±çš„æ•°ç»„ï¼Œå¯é€‰\nthisValue è¡¨ç¤ºæ‰§è¡Œå›è°ƒå‡½æ•° callback() æ—¶çš„ this æŒ‡å‘ã€‚å¯é€‰å‚æ•°ã€‚å½“ä¸å†™æ—¶ï¼Œåˆ™é»˜è®¤æ˜¯æŒ‡å‘ window å…¨å±€\n:page_with_curl: Example\nconst arr = [1, 3, 5, 13, 2]; const res = arr.forEach(function (item, index) { console.log(`æ•°ç»„ç¬¬${index + 1}ä¸ªå…ƒç´ æ˜¯${item}`); }); console.log(res); // forEachçš„è¿”å›å€¼ä¸ºundefined :memo: Note\nforEach() æ²¡æœ‰ è¿”å›å€¼ ã€‚\nå’Œ for åŒºåˆ« forEach() æ–¹æ³•æ— æ³•æå‰ç»“æŸï¼Œä¹Ÿå°±æ˜¯ break \u0026amp; continue ä¼šå¤±æ•ˆã€‚\n:memo: Note ä½† return ä»ç„¶èƒ½æå‰ç»ˆæ­¢å•è½®å¾ªç¯ã€‚\nä¾‹å¦‚ï¼Œæˆ‘ä»¬æƒ³è¦æ‰¾åˆ°æŸä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ æ—¶å°±ç»“æŸå¾ªç¯ã€‚\n:page_with_curl: Example 1\nåœ¨ for è¯­å¥ä¸­æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™\nconst arr = [1, 3, 5, 13, 2]; for (let i = 0; i \u0026lt; arr.length; i++) { if (arr[i] === 3) { console.log(\u0026#34;æ‰¾åˆ°äº†3ï¼Œå¹¶ç»“æŸå¾ªç¯\u0026#34;); break; } console.log(arr[i]); } for è¯­å¥æ‰§è¡Œäº† 2 æ¬¡ï¼Œåœ¨ç¬¬äºŒæ¬¡æ‰¾åˆ°äº†æ•°ç»„ä¸­çš„ 3 ï¼Œå¹¶ç»“æŸäº†å¾ªç¯ã€‚\né‚£ forEach() ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ\n:page_with_curl: Example 2\nconst arr = [1, 3, 5, 13, 2]; arr.forEach(function(item) { if (item === 3) { return console.log(\u0026#39;æ‰¾åˆ°äº†3ï¼Œä½†æœªç»“æŸéå†\u0026#39;); } console.log(item); }) æœ¬æƒ³ç€åœ¨æ‰¾åˆ° 3 ä¹‹åç”¨ return ç»“æŸéå†ï¼Œç»“æœä»ç„¶è¾“å‡ºäº† 3 åé¢çš„å…ƒç´ ã€‚\nç»ˆæ­¢æˆ–è€…è·³å‡º forEach() å¾ªç¯ï¼Œé™¤é æŠ›å‡ºå¼‚å¸¸ ï¼Œæ‰€ä»¥æƒ³æ‰§è¡Œä¸€ä¸ªæ•°ç»„æ˜¯å¦æ»¡è¶³æŸç§æ¡ä»¶ç„¶åè¿”å›æŸå€¼ï¼Œå¯ä»¥ç”¨ä¸€èˆ¬çš„ for å¾ªç¯å®ç°ï¼Œæˆ–è€…ç”¨ Array.every() æˆ–è€… Array.some() ã€‚\nArray.every() ç”¨äºæ£€æµ‹æ•°ç»„æ‰€æœ‰å…ƒç´ æ˜¯å¦å…¨éƒ¨éƒ½ç¬¦åˆæŒ‡å®šæ¡ä»¶ Array.some() ç”¨äºæ£€æµ‹æ•°ç»„ä¸­çš„å…ƒç´ æ˜¯å¦æœ‰ä»»æ„ä¸€ä¸ªæ»¡è¶³æŒ‡å®šæ¡ä»¶ forEach() ä¼šè·³è¿‡ ç©ºå€¼ ã€‚\n:page_with_curl: Example 3\nconst arr1 = [1, 3, , 13, 2]; const arr2 = [1, 3, , 13, 2]; for (let i = 0; i \u0026lt; arr1.length; i++) { arr1[i] = 2; } console.log(arr1); // [ 2, 2, 2, 2, 2 ] arr2.forEach(function (item, index) { // item = 2; //ä¿®æ”¹ä¸äº†åŸæ•°ç»„ // forEach é€šè¿‡indexä¿®æ”¹åŸæ•°ç»„ arr2[index] = 2; }); console.log(arr2); // [ 2, 2, \u0026lt;1 empty item\u0026gt;, 2, 2 ] æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œfor å¾ªç¯å¯¹äºæ•°ç»„ä¸­çš„ç©ºå€¼è¿›è¡Œäº†ä¿®æ”¹ï¼Œè€Œ forEach() æ–¹æ³•è·³è¿‡äº†ç©ºå€¼ã€‚\n:warning: Caution\nforEach() æ–¹æ³•ä¿®æ”¹æ•°ç»„å…ƒç´ ä¸èƒ½ä½¿ç”¨ item ç›´æ¥ä¿®æ”¹ã€‚\nitem ç›¸å½“äºä» arr2 ä¸­å¤åˆ¶è¿‡æ¥çš„å€¼ï¼Œå¹¶ä¸æ˜¯çœŸæ­£æŒ‡å‘åŸæ•°ç»„ arr2 é‡Œé¢çš„å…ƒç´ ã€‚\næ‰€ä»¥æˆ‘ä»¬æƒ³è¦ ä¿®æ”¹åŸæ•°ç»„ çš„æ¯ä¸ªå…ƒç´ å¿…é¡»é€šè¿‡æ‹¿åˆ°å®ƒçš„ ç´¢å¼•å€¼ index å»è¿›è¡Œä¿®æ”¹ï¼š arr2[index] = 2;\nforEach() çš„å¾ªç¯æ¬¡æ•°ç”±æ•°ç»„ åˆå§‹é•¿åº¦ å†³å®šã€‚\n:page_with_curl: Example 3\nconst arr1 = [1, 3, , 13, 2]; const arr2 = [1, 3, , 13, 2]; for (let i = 0; i \u0026lt; arr1.length; i++) { if (arr1[i] === 3) { arr1.push(14); arr1.push(5); } console.log(\u0026#34;æ•°ç»„å¾ªç¯äº†\u0026#34; + (i + 1) + \u0026#34;æ¬¡\u0026#34;); } console.log(arr1); arr2.forEach(function(item, index) { if (arr2[index] === 3) { arr2.push(14); arr2.push(5); } console.log(\u0026#34;æ•°ç»„å¾ªç¯äº†\u0026#34; + index + \u0026#34;æ¬¡\u0026#34;); }) console.log(arr2); æˆ‘ä»¬å¯ä»¥å‘ç° for å¾ªç¯æ—¶ï¼Œå‘æ•°ç»„ä¸­æ·»åŠ æ•°æ®ï¼Œå¾ªç¯æ¬¡æ•°ä¹Ÿå¢åŠ äº†ã€‚è€Œ forEach() æ–¹æ³•å´åªå¾ªç¯æ•°ç»„ arr2 çš„åˆå§‹é•¿åº¦ã€‚\nç»¼ä¸Šï¼ŒforEach é€‚ç”¨äºåªæ˜¯è¿›è¡Œ é›†åˆ æˆ– æ•°ç»„ éå†ï¼Œfor åˆ™åœ¨è¾ƒå¤æ‚çš„å¾ªç¯ä¸­æ•ˆç‡æ›´é«˜ã€‚\nmap() è¯­æ³• array.map(callback(currentValue, index, arr), thisValue) å…¶ä¸­ callback ä¸ºæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ æ‰§è¡Œçš„å‡½æ•°ï¼Œè¯¥å‡½æ•°å¯æ¥å—1-3ä¸ªå‚æ•°ï¼š\ncurrentvalue è¡¨ç¤ºæ•°ç»„çš„å½“å‰å…ƒç´ é¡¹ï¼Œå¿…é¡»\nindex å‚æ•°è¡¨ç¤ºçš„å½“å‰å…ƒç´ ä¸‹æ ‡ï¼Œå¯é€‰\narr å‚æ•°è¡¨ç¤ºå½“å‰å…ƒç´ æ‰€å±çš„æ•°ç»„ï¼Œå¯é€‰\nthisValue è¡¨ç¤ºæ‰§è¡Œå›è°ƒå‡½æ•° callback() æ—¶çš„ this æŒ‡å‘ã€‚å¯é€‰å‚æ•°ã€‚å¦‚æœçœç•¥ï¼Œæˆ–æ˜¯ä¼ å…¥ null undefined ï¼Œåˆ™é»˜è®¤è¿”å›å…¨å±€å¯¹è±¡ - window / global ã€‚\n:memo: Note\nArray.map() ä¸ä¼šç©ºå…ƒç´ è¿›è¡Œæ£€æµ‹ï¼Œä¹Ÿä¸ä¼šæ”¹å˜åŸæ•°ç»„ã€‚\nå’Œ forEach åŒºåˆ« æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä»–ä»¬çš„ç›¸åŒç‚¹ï¼š\n:page_with_curl: Example 1\nconst arr = [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;]; const thisValue = {fun(){}}; arr.forEach(function (item, index, arr) { //itemè¡¨ç¤ºæ•°ç»„ä¸­çš„æ¯ä¸€é¡¹ï¼Œindexæ ‡è¯†å½“å‰é¡¹çš„ä¸‹æ ‡ï¼Œarrè¡¨ç¤ºå½“å‰æ•°ç»„ console.log(item); // a b c d console.log(index); // 0 1 2 3 console.log(arr); // [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;] * 4 console.log(this); // { fun: [Function: fun] } }, thisValue); // è¿™é‡Œçš„thisValueå‚æ•°ï¼Œè¡¨ç¤ºå‡½æ•°ä¸­çš„thisæŒ‡å‘ï¼Œå¯å†™å¯ä¸å†™ // å¦‚æœä¸å†™ï¼Œåˆ™thisæŒ‡å‘å…¨å±€å¯¹è±¡ï¼šglobal/window arr.map(function(item,index,arr){ //å‚æ•°å«ä¹‰åŒforEach console.log(item); console.log(index); console.log(arr); console.log(this); },thisValue); è¿è¡Œä¹‹åï¼Œå¯ä»¥çœ‹å‡ºä¸¤è€…å‚æ•°æ²¡æœ‰ä»»ä½•çš„åŒºåˆ«ï¼Œé™¤æ­¤ä¹‹å¤–ä¸¤è€…ä¹‹é—´è¿˜æœ‰ä¸€ä¸ªå…±åŒçš„ç‰¹æ€§ï¼Œå°±æ˜¯ä¸èƒ½åœæ­¢é‡Œé¢çš„éå†ï¼Œé™¤éç¨‹åºæŠ¥é”™ã€‚\nè‹¥åœ¨è¿™é‡Œä½¿ç”¨ [ç®­å¤´å‡½æ•°](04 JavaScript.md#arrow-function-es6)ï¼Œä¼šå¯¼è‡´ thisValue å¤±æ•ˆã€‚\n:page_with_curl: Example 2\nconst arr = [1, 3, , 13, 2]; arr.map(function (item, index) { if (arr[index] === 3) { arr.push(14); arr.push(5); } console.log(index); // 0 1 3 4 }); console.log(arr); // [ 1, 3, \u0026lt;1 empty item\u0026gt;, 13, 2, 14, 5 ] map() æ–¹æ³•åŒæ ·ä¹Ÿä¸èƒ½å¾ªç¯çš„åŒæ—¶å¢åŠ æ•°ç»„å…ƒç´ è¯•å›¾æ”¹å˜å¾ªç¯æ¬¡æ•°ã€‚\né‚£ä»–ä»¬çš„åŒºåˆ«åœ¨å“ªå‘¢ï¼Ÿ\nè¿”å›å€¼ :page_with_curl: Example\nconst arr = [1, 3, 5, 13, 2]; const res = arr.map((item, index) =\u0026gt; { item += 1; return item + 1; }); console.log(res); // [ 3, 5, 7, 15, 4 ] const res2 = arr.forEach((item, index) =\u0026gt; { item += 1; return item + 1; // Void function return value is used }); console.log(res2); //undefined map() ä¼šè¿”å›ä¸€ä¸ª æ–°æ•°ç»„ ï¼Œæ•°ç»„ä¸­çš„å…ƒç´ ä¸ºåŸå§‹æ•°ç»„å…ƒç´ è°ƒç”¨å‡½æ•°å¤„ç†åçš„å€¼ã€‚ forEach() è¿”å›å€¼åˆ™æ°¸è¿œæ˜¯ undefined ã€‚\n:memo: Note\nArray.map() å¯ä»¥é€šè¿‡ä¼ å…¥ index ä¿®æ”¹åŸæ•°ç»„ã€‚\næ‰§è¡Œé€Ÿåº¦ forEach() æ‰§è¡Œçš„é€Ÿåº¦ç›¸æ¯” map() æ…¢äº† 70% ã€‚\nfilter() æŠŠæ•°ç»„çš„æŸäº›å…ƒç´ è¿‡æ»¤æ‰ï¼Œç„¶åè¿”å›å‰©ä¸‹çš„å…ƒç´ ã€‚\nå’Œ map() ç±»ä¼¼ï¼Œfilter() ä¹Ÿæ¥æ”¶ä¸€ä¸ªå‡½æ•°ã€‚å’Œ map() ä¸åŒçš„æ˜¯ï¼Œfilter() æŠŠä¼ å…¥çš„å‡½æ•°ä¾æ¬¡ä½œç”¨äºæ¯ä¸ªå…ƒç´ ï¼Œè¿”å›å€¼ä¸º true åˆ™ä¿ç•™è¯¥å…ƒç´ ã€‚\nå›è°ƒå‡½æ•°\nfilter() æ¥æ”¶çš„å›è°ƒå‡½æ•°ï¼Œå…¶å®å¯ä»¥æœ‰å¤šä¸ªå‚æ•°ã€‚é€šå¸¸æˆ‘ä»¬ä»…ä½¿ç”¨ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè¡¨ç¤º Array çš„æŸä¸ªå…ƒç´ ã€‚å›è°ƒå‡½æ•°è¿˜å¯ä»¥æ¥æ”¶å¦å¤–ä¸¤ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºå…ƒç´ çš„ä½ç½®å’Œæ•°ç»„æœ¬èº«ï¼š\nconst arr = [\u0026#39;A\u0026#39;, \u0026#39;B\u0026#39;, \u0026#39;C\u0026#39;]; const r = arr.filter(function (item, index, arr) { console.log(item); // \u0026#39;A\u0026#39; \u0026#39;B\u0026#39; \u0026#39;C\u0026#39; console.log(index); // 0 1 2 console.log(arr); // [\u0026#39;A\u0026#39;, \u0026#39;B\u0026#39;, \u0026#39;C\u0026#39;] return false; }); r; // [] åˆ©ç”¨ filter() ï¼Œå¯ä»¥å·§å¦™åœ°å»é™¤ Array çš„é‡å¤å…ƒç´ \nlet arr = [\u0026#39;apple\u0026#39;, \u0026#39;strawberry\u0026#39;, \u0026#39;banana\u0026#39;, \u0026#39;pear\u0026#39;, \u0026#39;apple\u0026#39;, \u0026#39;orange\u0026#39;, \u0026#39;orange\u0026#39;, \u0026#39;strawberry\u0026#39;]; let r = arr.filter(function (item, index, self) { return self.indexOf(item) === index; // indexOf()æ–¹æ³•è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ å‡ºç°çš„ä½ç½® }); console.log(r); // [ \u0026#39;apple\u0026#39;, \u0026#39;strawberry\u0026#39;, \u0026#39;banana\u0026#39;, \u0026#39;pear\u0026#39;, \u0026#39;orange\u0026#39; ] :link: Href Array.prototype.indexOf()\nè¯·å°è¯•ç”¨ filter() ç­›é€‰å‡ºç´ æ•°ï¼š\n\u0026#39;use strict\u0026#39;; function get_primes(arr) { return (arr.filter(function(ele){ if(ele === 1){ return false; }else { for(var i=2;i\u0026lt;ele;i++){ if(ele%i ===0){ return false } //return true;æ”¾åœ¨è¿™é‡Œå°±æ˜¯\u0026#34;åªè¦ä¸è¢«2æ•´é™¤å°±éƒ½è¿”å› true äº†,æ ¹æœ¬ä¸ç”¨å†å¾€ä¸‹æŸ¥äº†\u0026#34; } return true;//æ”¾åœ¨è¿™é‡Œå°±æ˜¯è¡¨ç¤º:ä»2å¼€å§‹ä¸€ç›´åˆ°è¢«ä»–å°çš„æ•°éƒ½è¦è¢«å®ƒé™¤ä¸€é,éƒ½ä¸è¡Œæ‰è¿”å› true } })) } // æµ‹è¯•: var x, r, arr = []; for (x = 1; x \u0026lt; 100; x++) { arr.push(x); } r = get_primes(arr); if (r.toString() === [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97].toString()) { console.log(\u0026#39;æµ‹è¯•é€šè¿‡!\u0026#39;); } else { console.log(\u0026#39;æµ‹è¯•å¤±è´¥: \u0026#39; + r.toString()); } valueOf() æ–¹æ³•è¿”å›æŒ‡å®šå¯¹è±¡çš„ åŸå§‹å€¼primitive valueã€‚\n-\u0026gt; let a =[\u0026#34;A\u0026#34;,\u0026#34;B\u0026#34;,\u0026#34;C\u0026#34;]; a.valueOf()[0]=1; console.log(a); \u0026gt;\u0026gt; Array [1, \u0026#34;B\u0026#34;, \u0026#34;C\u0026#34;] indexOf() indexOf æ— æ³•æ‰¾åˆ° NaN ã€‚\nğŸ“ Note ES2016 æ–°å¢çš„ includes æ–¹æ³•æ˜¯ indexOf çš„æ›¿ä»£ã€‚\npush() åœ¨æ•°ç»„ æœ«å°¾ æ¨å…¥æ–°é¡¹ï¼Œå¤šé¡¹åˆ™ä½¿ç”¨é€—å·éš”å¼€ï¼Œè¿”å›æ–°æ•°ç»„çš„é•¿åº¦ã€‚\n-\u0026gt; let arr = [1, 2, 3]; arr.push(4); arr.push(5, 6, 7); console.log(arr); \u0026gt;\u0026gt; [1, 2, 3, 4, 5, 6, 7] pop() åˆ é™¤æ•°ç»„ä¸­çš„æœ€åé¡¹ç›®ï¼Œä¸æ¥å—å‚æ•°ï¼Œè¿”å›æ–°æ•°ç»„çš„é•¿åº¦ã€‚\n-\u0026gt; let arr = [1, 2, 3]; arr.pop(); console.log(arr); \u0026gt;\u0026gt; [1, 2] unshift() åœ¨æ•°ç»„ å¤´éƒ¨ æ’å…¥æ–°é¡¹ç›®ï¼Œè¿”å›æ–°æ•°ç»„çš„é•¿åº¦ã€‚\n-\u0026gt; let arr = [1, 2, 3]; arr.unshift(4); arr.unshift(5, 6, 7); console.log(arr); \u0026gt;\u0026gt; [5, 6, 7, 4, 1, 2, 3] shift() åˆ é™¤å¹¶ è¿”å› æ•°ç»„ å¼€å¤´ é¡¹ç›®ã€‚\n-\u0026gt; let arr = [1, 2, 3]; arr.shift(); console.log(arr) \u0026gt;\u0026gt; [2, 3] splice()Â æ›¿æ¢æ•°ç»„ä¸­çš„æŒ‡å®šé¡¹ï¼Œï¼ˆä»ä¸‹æ ‡ startä¸‹æ ‡ä»0å¼€å§‹ å¼€å§‹ï¼Œå…ˆåˆ é™¤ deleteCount ï¼Œå†æ’å…¥ item æ•°ç»„ ï¼‰å¹¶è¿”å›åˆ é™¤çš„é¡¹ç›®ã€‚\n:memo: Note The splice() method changes the contents of an array by removing or replacing existing elements and/or adding new elements in place.\n// SyntaX splice(start); splice(start, deleteCount); splice(start, deleteCount, item1); splice(start, deleteCount, item1, item2, ...,itemN); splice(start, deleteCount, ...itemArray); // Usage -\u0026gt; let a = [0,1,2,3,4]; console.log(a.splice(3,1,...[\u0026#39;arr\u0026#39;,\u0026#39;ay\u0026#39;,\u0026#39;List\u0026#39;])); console.log(a); \u0026gt;\u0026gt; [3] //è¿”å›åˆ é™¤çš„é¡¹ç›® (7) [0, 1, 2, \u0026#39;arr\u0026#39;, \u0026#39;ay\u0026#39;, \u0026#39;List\u0026#39;, 4] slice() æˆªå–å¹¶ å¯¼å‡º ï¼ˆä»ä¸‹æ ‡ start$x\\in N+$ å¼€å§‹åˆ° end ï¼‰æ•°ç»„ä¸­çš„æŒ‡å®šé¡¹ï¼Œä¸å½±å“åŸæ•°ç»„ã€‚\n:memo: Note 1 endä¸ºè´Ÿå€¼è¡¨ç¤ºæˆªæ­¢èŒƒå›´ä» æœ«å°¾ å¼€å§‹\n:memo: Note 2 The slice() method returns a shallow copy of a portion of an array into a new array object selected from start to end (end not included) where start and end represent the index of items in that array. The original array will not be modified.\n//SyntaX slice(); //å¯åˆ›å»ºå•å±‚æ•°ç»„æ·±æ‹·è´ã€‚è§åé¢çš„æ‹·è´ä¸€èŠ‚ã€‚ slice(start); slice(start, end); join() split() join() æ•°ç»„ â†’ å­—ç¬¦ä¸²ï¼Œå‚æ•°è¡¨ç¤ºåˆ†å‰²é“¾æ¥å­—ç¬¦ï¼Œä¸ºç©ºæ—¶åˆ™é»˜è®¤ä»¥é€—å· , åˆ†å‰²ï¼Œç­‰åŒäºè°ƒç”¨ toString() æ–¹æ³•ã€‚\n-\u0026gt; [0,1,2,3].toString() \u0026gt;\u0026gt; \u0026#39;0,1,2,3\u0026#39; -\u0026gt; [0,1,2,3].join() \u0026gt;\u0026gt; \u0026#39;0,1,2,3\u0026#39; -\u0026gt; [0,1,2,3].toString()===[0,1,2,3].join() \u0026gt;\u0026gt; true split() å­—ç¬¦ä¸² â†’ æ•°ç»„ï¼Œå‚æ•°è¡¨ç¤ºåˆ†å‰²å­—ç¬¦ä¸²çš„æ–¹æ³•ã€‚\n-\u0026gt; let arr = [0,1,2,3]; let arrToString = arr.toString(); let arrJoinString = arr.join(); let subArr = arrJoinString.split(\u0026#39;,\u0026#39;); console.log([arrToString,arrJoinString,subArr]) \u0026gt;\u0026gt; [\u0026#39;0,1,2,3\u0026#39;, \u0026#39;0,1,2,3\u0026#39;, [\u0026#39;0\u0026#39;, \u0026#39;1\u0026#39;, \u0026#39;2\u0026#39;, \u0026#39;3\u0026#39;]] reverse() å°†æ•°ç»„ä¸­çš„å…¨éƒ¨é¡¹é¡ºåº é¢ å€’ ã€‚\n-\u0026gt; let arr = [0,1,2,3]; arr.reverse(); console.log(arr); \u0026gt;\u0026gt; [3, 2, 1, 0] :page_facing_up: Example å­—ç¬¦ä¸²é€†åº\n-\u0026gt; \u0026#39;ABCDEFG\u0026#39;.split(\u0026#39;\u0026#39;).reverse().join(\u0026#39;\u0026#39;); \u0026gt;\u0026gt; \u0026#34;GFEDCBA\u0026#34; sort() å¯¹æ•°ç»„è¿›è¡Œæ’åºã€‚\n// SyntaX /* Functionless */ //-\u0026gt; ä¸æä¾›å‚æ•°æ—¶ï¼Œå…ƒç´ æŒ‰ç…§è½¬æ¢ä¸ºçš„å­—ç¬¦ä¸²çš„å„ä¸ªå­—ç¬¦çš„Unicodeä½ç‚¹è¿›è¡Œæ’åº sort() /* Arrow function */ sort((firstEl, secondEl) =\u0026gt; { /* ... */ } ) /* Compare function */ sort(compareFn) /* Inline compare function */ sort(function compareFn(firstEl, secondEl) { /* ... */ }) :memo: Note 1 JavaScript ä¸­å‡½æ•°æœ¬èº«å¯ä»¥ä½œä¸º å€¼ è¿›è¡Œä¼ é€’ã€‚\n:memo: Note 2 ä¼ å…¥å‡½æ•°æ—¶ï¼Œå¦‚æœéœ€è¦å°†å®ƒä»¬äº¤æ¢ä½ç½®ï¼Œåˆ™è¿”å›æ­£æ•´æ•°ï¼›å¦åˆ™å°±è¿”å›è´Ÿæ•°ã€‚\ncompareFunction(a, b) return value sort order \u0026gt; 0 sort b before a \u0026lt; 0 sort a before bdefault === 0 keep original order of a and b // ä»å°åˆ°å¤§æ’åº const arr = [3, 2, 1, 0]; arr.sort((x, y) =\u0026gt; x - y); console.log(arr);\t// [0,1,2,3] :link: Href å…³äºå¦‚ä½•ä¿æŒ ES6 [sort()](06 EcmaScript.md/#sort-stable) çš„æ’åºç¨³å®šæ€§\ncontcat() æ‹¼æ¥æ•°ç»„ã€‚\n-\u0026gt; const array1 = [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;]; const array2 = [\u0026#39;d\u0026#39;, \u0026#39;e\u0026#39;, \u0026#39;f\u0026#39;]; const array3 = array1.concat(array2); console.log(array3); \u0026gt;\u0026gt; Array [\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;, \u0026#34;c\u0026#34;, \u0026#34;d\u0026#34;, \u0026#34;e\u0026#34;, \u0026#34;f\u0026#34;] :memo: Note 1 returns a shallow copy of a portion of an array\u0026gt;\n:memo: Note 2 å’Œ slice() ä¸€æ ·å¯ä»¥ç”¨æ¥åˆ›å»ºå•å±‚æ•°ç»„æ·±æ‹·è´\n-\u0026gt; const arr = [0, 1, 2, 3]; const layerCopyArr = arr.concat([]); console.log([arr, layerCopyArr, arr === layerCopyArr]) \u0026gt;\u0026gt; [[ 0, 1, 2, 3 ], [ 0, 1, 2, 3 ], false] reduce() Array.prototype.reduce()\nreduce() æ–¹æ³•å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ æŒ‰åºæ‰§è¡Œä¸€ä¸ªç”±æ‚¨æä¾›çš„ reducer å‡½æ•°ï¼Œæ¯ä¸€æ¬¡è¿è¡Œ reducer ä¼šå°†å…ˆå‰å…ƒç´ çš„è®¡ç®—ç»“æœä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œæœ€åå°†å…¶ç»“æœæ±‡æ€»ä¸ºå•ä¸ªè¿”å›å€¼ã€‚\npreviousValue, currentValue\nArray\u0026lt;any\u0026gt;.reduce( callbackfn: ( previousValue: any, currentValue: any, currentIndex: number, array: any[] ) =\u0026gt; any, initialValue: any ): any ç¬¬ä¸€æ¬¡æ‰§è¡Œå›è°ƒå‡½æ•°æ—¶ï¼Œä¸å­˜åœ¨â€œä¸Šä¸€æ¬¡çš„è®¡ç®—ç»“æœâ€ã€‚å¦‚æœéœ€è¦å›è°ƒå‡½æ•°ä»æ•°ç»„ç´¢å¼•ä¸º 0 çš„å…ƒç´ å¼€å§‹æ‰§è¡Œï¼Œåˆ™éœ€è¦ä¼ é€’åˆå§‹å€¼ã€‚å¦åˆ™ï¼Œæ•°ç»„ç´¢å¼•ä¸º 0 çš„å…ƒç´ å°†è¢«ä½œä¸ºåˆå§‹å€¼ initialValueï¼Œè¿­ä»£å™¨å°†ä»ç¬¬äºŒä¸ªå…ƒç´ å¼€å§‹æ‰§è¡Œï¼ˆç´¢å¼•ä¸º 1 è€Œä¸æ˜¯ 0ï¼‰ã€‚\nå°†äºŒç»´æ•°ç»„è½¬ä¸ºä¸€ç»´æ•°ç»„ const testArr = [[1,2], [3,4], [5,6]] testArr.reduce((acc, cur) =\u0026gt; { return acc.concat(cur) }, []) // [1,2,3,4,5,6] è®¡ç®—æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ å‡ºç°çš„ä¸ªæ•° const testArr = [1, 3, 4, 1, 3, 2, 9, 8, 5, 3, 2, 0, 12, 10] testArr.reduce((acc, cur) =\u0026gt; { if (!(cur in acc)) { acc[cur] = 1 } else { acc[cur] += 1 } return acc }, {}) // {0: 1, 1: 2, 2: 2, 3: 3, 4: 1, 5: 1, 8: 1, 9: 1, 10: 1, 12: 1} å¤åˆ¶ä»£ç  è¿™é‡Œæ³¨æ„ï¼Œæˆ‘åˆå§‹åŒ–çš„å€¼å˜æˆäº† {} ,è¿™ä¸ªéœ€æ±‚éœ€è¦é”®å€¼å¯¹çš„å½¢å¼ï¼Œåˆ©ç”¨ cur in acc åˆ¤æ–­ç´¯è®¡å™¨ acc ä¸­æ˜¯å¦å«æœ‰ cur å±æ€§ï¼Œå¦‚æœæ²¡æœ‰é»˜è®¤èµ‹å€¼ 1ï¼Œå¦‚æœå·²ç»å­˜åœ¨ += 1 ç´¯åŠ ä¸€æ¬¡ã€‚ åœ¨å®é™…çš„å¼€å‘ä¸šåŠ¡ä¸­ï¼Œè¿™ä¸ªæ–¹æ³•éå¸¸å¸¸ç”¨ï¼Œå˜ç§ä¹Ÿå¾ˆå¤šã€‚æ¯”å¦‚ç»™ä½ ä¸€ä¸ªè´¦å•åˆ—è¡¨ï¼ˆé¡¹ä¸é¡¹ä¹‹é—´çš„æ¶ˆè´¹ç±»å‹æœ‰ç›¸åŒæƒ…å†µï¼‰ï¼Œè®©ä½ ç»Ÿè®¡è´¦å•åˆ—è¡¨ä¸­å„ä¸ªæ¶ˆè´¹ç±»å‹çš„æ”¯å‡ºæƒ…å†µï¼Œå¦‚ è´­ç‰© ã€ å­¦ä¹  ã€ è½¬è´¦ ç­‰æ¶ˆè´¹ç±»å‹çš„æ”¯å‡ºæƒ…å†µã€‚è¿™å°±ç”¨åˆ°äº†ä¸Šè¿°æ–¹æ³•ï¼Œå»é€šè¿‡å½’ç±»ã€‚\næŒ‰å±æ€§ç»™æ•°ç»„åˆ†ç±» ä»€ä¹ˆå«æŒ‰ç…§å±æ€§ç»™æ•°ç»„åˆ†ç±»ï¼Œå…¶å®å°±æ˜¯ç»™å®šä¸€ä¸ªä¾æ®ï¼ŒæŠŠç¬¦åˆæ¡ä»¶çš„å½’å¹¶åˆ°ä¸€èµ·ã€‚å†æ‹¿è´¦å•ä¸¾ä¾‹ï¼Œå°±æ˜¯æŒ‰å„ä¸ªæ¶ˆè´¹ç±»å‹å½’ä¸ºä¸€ç±»ã€‚\nconst bills = [ { type: \u0026#39;shop\u0026#39;, momey: 223 }, { type: \u0026#39;study\u0026#39;, momey: 341 }, { type: \u0026#39;shop\u0026#39;, momey: 821 }, { type: \u0026#39;transfer\u0026#39;, momey: 821 }, { type: \u0026#39;study\u0026#39;, momey: 821 } ]; bills.reduce((acc, cur) =\u0026gt; { // å¦‚æœä¸å­˜åœ¨è¿™ä¸ªé”®ï¼Œåˆ™è®¾ç½®å®ƒèµ‹å€¼ [] ç©ºæ•°ç»„ if (!acc[cur.type]) { acc[cur.type] = []; } acc[cur.type].push(cur) return acc }, {}) å¤åˆ¶ä»£ç  æ•°ç»„å»é‡ è¿™ä¸ªå°±ä¸è§£é‡Šäº†ï¼Œç›´æ¥ä¸Šä»£ç ã€‚\nconst testArr = [1,2,2,3,4,4,5,5,5,6,7] testArr.reduce((acc, cur) =\u0026gt; { if (!(acc.includes(cur))) { acc.push(cur) } return acc }, []) // [1, 2, 3, 4, 5, 6, 7] å¤åˆ¶ä»£ç  ä¸Šè¿°ä»£ç é€»è¾‘ï¼Œå°±æ˜¯é€ä¸€å¯¹æ¯”ï¼Œé€šè¿‡ includes æ–¹æ³•æ£€æŸ¥ç´¯è®¡å™¨é‡Œæ˜¯å¦å·²ç»æœ‰å½“å‰é¡¹ã€‚\næ±‚æœ€å¤§å€¼æˆ–æœ€å°å€¼ ä¸€ä¸ªå¯¹è±¡æ•°ç»„å†…ï¼Œæˆ‘æƒ³æ‹¿åˆ°æŸä¸€é¡¹é‡ŒæŸä¸ªå±æ€§æœ€å¤§æˆ–è€…æœ€å°çš„é‚£ä¸€é¡¹ã€‚\nconst testArr = [ { age: 20 }, { age: 21 }, { age: 22 } ] testArr.reduce((acc, cur) =\u0026gt; { if (!acc) { acc = cur return acc } if (acc.age \u0026lt; cur.age) { acc = cur return acc } return acc }, 0) // {age: 22} å¤åˆ¶ä»£ç  ç¬¬ä¸€æ¬¡æ²¡æœ‰å¯¹æ¯”ç›´æ¥ acc èµ‹å€¼ cur ï¼Œåé¢è¿›å…¥å¯¹æ¯”åˆ¤æ–­ï¼Œå¦‚æœ acc çš„ age å±æ€§å°äº cur çš„ age å±æ€§ï¼Œé‡åˆ¶ acc ã€‚ç›¸ç­‰çš„è¯é»˜è®¤è¿”å› acc ã€‚\nå®ƒçš„èƒ½åŠ›è¿œä¸æ­¢äºæ­¤ï¼Œå®ƒå°±åƒç¥å¥‡å®è´é‡Œçš„â€œç™¾å˜æ€ªâ€ï¼Œæƒ³è¦å˜æˆä»€ä¹ˆå°±å˜æˆä»€ä¹ˆã€‚\nreduce -\u0026gt; map map æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå‡½æ•°å†…æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œå½“å‰é¡¹ã€ç´¢å¼•ã€åŸæ•°ç»„ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œå¹¶ä¸”æ•°ç»„é•¿åº¦ä¸å˜ã€‚ çŸ¥é“äº†è¿™äº›ç‰¹å¾ä¹‹åï¼Œæˆ‘ä»¬ç”¨ reduce é‡å¡‘ map ã€‚\nconst testArr = [1, 2, 3, 4] Array.prototype.reduceMap = function(callback) { return this.reduce((acc, cur, index, array) =\u0026gt; { const item = callback(cur, index, array) acc.push(item) return acc }, []) } testArr.reduceMap((item, index) =\u0026gt; { return item + index }) // [1, 3, 5, 7] å¤åˆ¶ä»£ç  åœ¨ Array çš„åŸå‹é“¾ä¸Šæ·»åŠ  reduceMap æ–¹æ³•ï¼Œæ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•° callback ä½œä¸ºå‚æ•°ï¼ˆå°±æ˜¯ map ä¼ å…¥çš„å›è°ƒå‡½æ•°ï¼‰ï¼Œå†…éƒ¨é€šè¿‡ this æ‹¿åˆ°å½“å‰éœ€è¦æ“ä½œçš„æ•°ç»„ï¼Œè¿™é‡Œ reduce æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°åˆå§‹å€¼å¾ˆå…³é”®ï¼Œéœ€è¦è®¾ç½®æˆä¸€ä¸ª [] ï¼Œè¿™æ ·ä¾¿äºåé¢æŠŠæ“ä½œå®Œçš„å•é¡¹å¡å…¥ acc ã€‚æˆ‘ä»¬éœ€è¦ç»™ callback æ–¹æ³•ä¼ å…¥ä¸‰ä¸ªå€¼ï¼Œå½“å‰é¡¹ã€ç´¢å¼•ã€åŸæ•°ç»„ï¼Œä¹Ÿå°±æ˜¯åŸç”Ÿ map å›è°ƒå‡½æ•°èƒ½æ‹¿åˆ°çš„å€¼ã€‚è¿”å› item å¡è¿› accï¼Œå¹¶ä¸”è¿”å› acc ï¼Œä½œä¸ºä¸‹ä¸€ä¸ªå¾ªç¯çš„ accï¼ˆè´ªåƒè›‡åŸç†ï¼‰ã€‚æœ€ç»ˆ this.reduce è¿”å›äº†æ–°çš„æ•°ç»„ï¼Œå¹¶ä¸”é•¿åº¦ä¸å˜ã€‚\nreduce -\u0026gt; forEach forEach æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå‡½æ•°å†…æ¥æ”¶å››ä¸ªå‚æ•°å½“å‰é¡¹ã€ç´¢å¼•ã€åŸå‡½æ•°ã€å½“æ‰§è¡Œå›è°ƒå‡½æ•° callback æ—¶ï¼Œç”¨ä½œ this çš„å€¼ï¼Œå¹¶ä¸”ä¸è¿”å›å€¼ã€‚\nconst testArr = [1, 2, 3, 4] Array.prototype.reduceForEach = function(callback) { this.reduce((acc, cur, index, array) =\u0026gt; { callback(cur, index, array) }, []) } testArr.reduceForEach((item, index, array) =\u0026gt; { console.log(item, index) }) // 1234 // 0123 å¤åˆ¶ä»£ç  åªè¦çœ‹å¾—æ‡‚ reduce -\u0026gt; map ï¼Œè½¬ forEach åªæ˜¯æ”¹æ”¹ç»“æ„çš„é—®é¢˜ã€‚\nreduce -\u0026gt; filter filter åŒæ ·æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå›è°ƒå‡½æ•°è¿”å› true åˆ™è¿”å›å½“å‰é¡¹ï¼Œåä¹‹åˆ™ä¸è¿”å›ã€‚å›è°ƒå‡½æ•°æ¥æ”¶çš„å‚æ•°åŒ forEach ã€‚\nconst testArr = [1, 2, 3, 4] Array.prototype.reduceFilter = function (callback) { return this.reduce((acc, cur, index, array) =\u0026gt; { if (callback(cur, index, array)) { acc.push(cur) } return acc }, []) } testArr.reduceFilter(item =\u0026gt; item % 2 == 0) // è¿‡æ»¤å‡ºå¶æ•°é¡¹ã€‚ // [2, 4] å¤åˆ¶ä»£ç  filter æ–¹æ³•ä¸­ callback è¿”å›çš„æ˜¯ Boolean ç±»å‹ï¼Œæ‰€ä»¥é€šè¿‡ if åˆ¤æ–­æ˜¯å¦è¦å¡å…¥ç´¯è®¡å™¨ acc ï¼Œå¹¶ä¸”è¿”å› acc ç»™ä¸‹ä¸€æ¬¡å¯¹æ¯”ã€‚æœ€ç»ˆè¿”å›æ•´ä¸ªè¿‡æ»¤åçš„æ•°ç»„ã€‚\nreduce -\u0026gt; find find æ–¹æ³•ä¸­ callback åŒæ ·ä¹Ÿæ˜¯è¿”å› Boolean ç±»å‹ï¼Œè¿”å›ä½ è¦æ‰¾çš„ç¬¬ä¸€ä¸ªç¬¦åˆè¦æ±‚çš„é¡¹ã€‚\nconst testArr = [1, 2, 3, 4] const testObj = [{ a: 1 }, { a: 2 }, { a: 3 }, { a: 4 }] Array.prototype.reduceFind = function (callback) { return this.reduce((acc, cur, index, array) =\u0026gt; { if (callback(cur, index, array)) { if (acc instanceof Array \u0026amp;\u0026amp; acc.length == 0) { acc = cur } } // å¾ªç¯åˆ°æœ€åè‹¥ acc è¿˜æ˜¯æ•°ç»„ï¼Œä¸”é•¿åº¦ä¸º 0ï¼Œä»£è¡¨æ²¡æœ‰æ‰¾åˆ°æƒ³è¦çš„é¡¹ï¼Œåˆ™ acc = undefined if ((index == array.length - 1) \u0026amp;\u0026amp; acc instanceof Array \u0026amp;\u0026amp; acc.length == 0) { acc = undefined } return acc }, []) } testArr.reduceFind(item =\u0026gt; item % 2 == 0) // 2 testObj.reduceFind(item =\u0026gt; item.a % 2 == 0) // {a: 2} testObj.reduceFind(item =\u0026gt; item.a % 9 == 0) // undefined å¤åˆ¶ä»£ç  ä½ ä¸çŸ¥é“æ“ä½œçš„æ•°ç»„æ˜¯å¯¹è±¡æ•°ç»„è¿˜æ˜¯æ™®é€šæ•°ç»„ï¼Œæ‰€ä»¥è¿™é‡Œåªèƒ½ç›´æ¥è¦†ç›– acc çš„å€¼ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªç¬¦åˆåˆ¤æ–­æ ‡å‡†çš„å€¼å°±ä¸å†è¿›è¡Œèµ‹å€¼æ“ä½œã€‚\né€’å½’ å‡½æ•°çš„å†…éƒ¨è¯­å¥å¯ä»¥è°ƒç”¨è¿™ä¸ªå‡½æ•°è‡ªèº«ï¼Œä»è€Œå‘èµ·å¯¹å‡½æ•°çš„ä¸€æ¬¡ è¿­ä»£iteratorã€‚åœ¨æ–°çš„è¿­ä»£ä¸­ï¼Œåˆä¼šæ‰§è¡Œè°ƒç”¨å‡½æ•°è‡ªèº«çš„è¯­å¥ï¼Œä»è€Œåˆäº§ç”Ÿä¸€æ¬¡è¿­ä»£ã€‚å½“å‡½æ•°æ‰§è¡Œåˆ°æŸä¸€æ¬¡æ—¶ï¼Œä¸å†è¿›è¡Œæ–°çš„è¿­ä»£ï¼Œå‡½æ•°è¢«ä¸€å±‚ä¸€å±‚è¿”å›ï¼Œå‡½æ•°è¢«é€’å½’ã€‚\né€’å½’æ˜¯ä¸€ç§è¾ƒä¸ºé«˜çº§çš„ç¼–ç¨‹æ€æƒ³ï¼Œå®ƒæŠŠä¸€ä¸ªå¤§å‹å¤æ‚çš„é—®é¢˜å±‚å±‚è½¬åŒ–ä¸ºä¸€ä¸ªä¸åŸé—®é¢˜ç›¸ä¼¼çš„è§„æ¨¡è¾ƒå°çš„é—®é¢˜æ¥æ±‚è§£ã€‚\n:memo: Note é€’å½’æŠ€å·§ï¼š\nåˆ†æé—®é¢˜ï¼ŒæŠ½è±¡å‡ºå…·ä½“çš„æ•°å­¦æ¨¡å‹ åˆ†ææ•°å­¦æ¨¡å‹æ˜¯å¦æœ‰ è§„å¾‹æ€§ æ‰¾åˆ°åŸºæœ¬çš„ è§„å¾‹ $$n!=n*(n-1)!$$ å°† è§„å¾‹ è½¬æ¢ä¸ºä»£ç ï¼ˆe.g.: return n * factorial(n - 1);ï¼‰ æ‰¾åˆ° å‡ºå£ ä¹Ÿå°±æ˜¯ ä¸´ç•Œæƒ…å†µ $$1!\\ =\\ 1$$ å°† å‡ºå£ è½¬åŒ–ä¸ºä»£ç ï¼ˆe.g.: if (n === 1) { return 1; }ï¼‰ ç»„åˆä»£ç å½¢æˆ é€’å½’ç®—æ³• ğŸ“ƒ Example æ±‚é˜¶ä¹˜\nlet factorial = n =\u0026gt; Number(!(n - 1)) || n * factorial(n - 1); console.log(factorial(1)); // 1 console.log(factorial(2)); // 2 console.log(factorial(3)); // 6 console.log(factorial(4)); // 24 console.log(factorial(5)); // 120 æ‹·è´ æµ…æ‹·è´ A shallow copy of an object is a copy whose properties share the same references (point to the same underlying values) as those of the source object from which the copy was made.\nåœ¨ä½¿ç”¨ JavaScript å¯¹æ•°ç»„è¿›è¡Œæ“ä½œçš„æ—¶å€™ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å°†æ•°ç»„è¿›è¡Œå¤‡ä»½ã€‚\nå¦‚ä¸‹ä»£ç ï¼Œå¦‚æœåªæ˜¯ç®€å•æ‰ç”¨èµ‹å€¼çš„æ–¹æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦æ›´æ”¹å…¶ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼Œç„¶åå…¶ä»–çš„ä¹Ÿä¼šè·Ÿç€æ”¹å˜ï¼Œè¿™å°±å¯¼è‡´äº†é—®é¢˜çš„å‘ç”Ÿã€‚\n-\u0026gt; let arr1 = [\u0026#34;red\u0026#34;,\u0026#34;yellow\u0026#34;,\u0026#34;black\u0026#34;]; let arr2 = arr1; arr2[1] = \u0026#34;green\u0026#34;; console.log(\u0026#34;æ•°ç»„çš„åŸå§‹å€¼ï¼š\u0026#34; + arr1 ); console.log(\u0026#34;æ•°ç»„çš„æ–°å€¼ï¼š\u0026#34; + arr2); \u0026gt;\u0026gt; æ•°ç»„çš„åŸå§‹å€¼ï¼šred,green,black æ•°ç»„çš„æ–°å€¼ï¼šred,green,black //æµ…æ‹·è´ä»…å¤åˆ¶æŒ‡é’ˆ åƒä¸Šé¢çš„è¿™ç§ç›´æ¥èµ‹å€¼çš„æ–¹å¼å°±æ˜¯æ•°ç»„çš„æµ…æ‹·è´ï¼Œæµ…æ‹·è´æ”¹å˜å…¶ä¸­ä¸€ä¸ªæ•°ç»„ï¼Œå¦å¤–ä¸€ä¸ªæ•°ç»„ä¹Ÿä¼šè·Ÿç€æ”¹å˜ã€‚å¾ˆå¤šæ—¶å€™ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚\næ·±æ‹·è´ A deep copy of an object is a copy whose properties do not share the same references (point to the same underlying values) as those of the source object from which the copy was made.\nslice() å¯¹äº Array å¯¹è±¡çš„ slice å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„çš„ä¸€æ®µã€‚ï¼ˆä»ä¸ºæ•°ç»„ï¼‰å…·ä½“è§ä¸Šä¸€èŠ‚ã€‚\næµ‹è¯•ä¾‹å­ï¼š\n-\u0026gt; let arr1 = [\u0026#34;1\u0026#34;,\u0026#34;2\u0026#34;,\u0026#34;3\u0026#34;]; let arr2 = arr1.slice(0); //è¿”å› arr2[1] = \u0026#34;9\u0026#34;; console.log(\u0026#34;æ•°ç»„çš„åŸå§‹å€¼ï¼š\u0026#34; + arr1 ); console.log(\u0026#34;æ•°ç»„çš„æ–°å€¼ï¼š\u0026#34; + arr2 ); \u0026gt;\u0026gt; æ•°ç»„çš„åŸå§‹å€¼ï¼š1,2,3 æ•°ç»„çš„æ–°å€¼ï¼š1,9,3 å¦‚æµ‹è¯•ç»“æœæ˜¾ç¤ºï¼Œé€šè¿‡JSçš„sliceæ–¹æ³•ï¼Œæ”¹å˜æ‹·è´å‡ºæ¥çš„æ•°ç»„çš„æŸé¡¹å€¼åï¼Œå¯¹åŸæ¥æ•°ç»„æ²¡æœ‰ä»»ä½•å½±å“ã€‚\nconcat() concat() æ–¹æ³•ç”¨äºè¿æ¥ä¸¤ä¸ªæˆ–å¤šä¸ªæ•°ç»„ã€‚è¯¥æ–¹æ³•ä¸ä¼šæ”¹å˜ç°æœ‰çš„æ•°ç»„ï¼Œè€Œä»…ä»…ä¼šè¿”å›è¢«è¿æ¥æ•°ç»„çš„ä¸€ä¸ªå‰¯æœ¬ã€‚\nè¯­æ³•ï¼š\narrayObject.concat(array1, array2, ..., arrayX); è¯´æ˜ï¼šè¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ã€‚è¯¥æ•°ç»„æ˜¯é€šè¿‡æŠŠæ‰€æœ‰ arrayX å‚æ•°æ·»åŠ åˆ° arrayObject ä¸­ç”Ÿæˆçš„ã€‚å¦‚æœè¦è¿›è¡Œ concat() æ“ä½œçš„å‚æ•°æ˜¯æ•°ç»„ï¼Œé‚£ä¹ˆæ·»åŠ çš„æ˜¯æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œè€Œä¸æ˜¯æ•°ç»„ã€‚\næµ‹è¯•ä¾‹å­:\n-\u0026gt; let arr1 = [\u0026#34;1\u0026#34;,\u0026#34;2\u0026#34;,\u0026#34;3\u0026#34;]; let arr2 = arr1.concat(); arr2[1] = \u0026#34;9\u0026#34;; console.log(\u0026#34;æ•°ç»„çš„åŸå§‹å€¼ï¼š\u0026#34; + arr1 ); console.log(\u0026#34;æ•°ç»„çš„æ–°å€¼ï¼š\u0026#34; + arr2 ); \u0026gt;\u0026gt; æ•°ç»„çš„åŸå§‹å€¼ï¼š1,2,3 æ•°ç»„çš„æ–°å€¼ï¼š1,9,3 å±€é™æ€§ e.g.1: concat()\n-\u0026gt; let arr1 = [[0, 1], [2, 3]];//åŸæ•°ç»„ let arr2 = [].concat(arr1);//æ‹·è´æ•°ç»„ arr1[1][0] = 4; console.log(arr1); console.log(arr2); \u0026gt;\u0026gt; [[0, 1], [4, 3]] [[0, 1], [4, 3]] e.g.2: slice()\n-\u0026gt; let a1 = [[\u0026#34;1\u0026#34;, \u0026#34;2\u0026#34;, \u0026#34;3\u0026#34;], \u0026#34;2\u0026#34;, \u0026#34;3\u0026#34;], a2; a2 = a1.slice(0); a1[0][0] = 0; //æ”¹å˜a1ç¬¬ä¸€ä¸ªå…ƒç´ ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´  console.log(a2[0][0]); //å½±å“åˆ°äº†a2 let b1 = [[\u0026#34;1\u0026#34;, \u0026#34;2\u0026#34;, \u0026#34;3\u0026#34;], \u0026#34;2\u0026#34;, \u0026#34;3\u0026#34;], b2; b2 = b1.slice(0); b1[0][0] = 0; //æ”¹å˜a1ç¬¬ä¸€ä¸ªå…ƒç´ ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´  console.log(b2[0][0]); //å½±å“åˆ°äº†a2 \u0026gt;\u0026gt; 0 0 ä»ä¸Šé¢ä¸¤ä¸ªä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œç”±äºæ•°ç»„ å†…éƒ¨ å±æ€§å€¼ä¸º å¼•ç”¨å¯¹è±¡ï¼ˆæŒ‡é’ˆï¼‰ï¼Œå› æ­¤ä½¿ç”¨ slice å’Œ concat å¯¹å¯¹è±¡æ•°ç»„çš„æ‹·è´ï¼Œæ•´ä¸ªæ‹·è´è¿˜æ˜¯æµ…æ‹·è´ï¼Œæ‹·è´ä¹‹åæ•°ç»„å„ä¸ªå€¼çš„æŒ‡é’ˆè¿˜æ˜¯æŒ‡å‘ç›¸åŒçš„å­˜å‚¨åœ°å€ã€‚\nå› æ­¤ï¼Œslice å’Œ concat è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œä»…é€‚ç”¨äºå¯¹ä¸åŒ…å« å¼•ç”¨å¯¹è±¡ çš„ ä¸€ç»´æ•°ç»„ çš„æ·±æ‹·è´ã€‚\næ— æ³•å®ç° å†…éƒ¨å¯¹è±¡ çš„æ·±æ‹·è´ã€‚\n:x:JSON æ·±æ‹·è´ JSON.parse()ã€JSON.stringify()\né€’å½’æ·±æ‹·è´ ä¸ºäº†ä¿è¯å®ç°åŒ…æ‹¬ å¼•ç”¨å¯¹è±¡ çš„å®Œå…¨çš„æ·±æ‹·è´ï¼Œéœ€è¦ä½¿ç”¨ é€’å½’ ç®—æ³•ã€‚\nconst obj1 = { a: 1, b: 2, c: [33, 44, { m: 55, n: 66, p: [77, 88] }], f: () =\u0026gt; { return 1; } }; // æ·±å…‹éš† function deepClone(o) { let result; // è¦åˆ¤æ–­ o æ˜¯å¯¹è±¡è¿˜æ˜¯æ•°ç»„ if (Array.isArray(o)) { // æ•°ç»„ //-\u0026gt; typeof [] // \u0026gt;\u0026gt; \u0026#39;object\u0026#39; result = []; for (let i = 0; i \u0026lt; o.length; i++) { result.push(deepClone(o[i])); } } else if (typeof o === \u0026#39;object\u0026#39;) { // å¯¹è±¡ result = {}; for (const k in o) { // for-in éå†é”®å // æ•°ç»„ä¹Ÿæ˜¯ç‰¹æ®Šçš„å¯¹è±¡ï¼Œä½†çº¯å¯¹è±¡è¿˜æœ‰é”®å result[k] = deepClone(o[k]); } } else { // åŸºæœ¬ç±»å‹å€¼ // NOTE: è™½ç„¶å‡½æ•°å±äºå¯¹è±¡ï¼Œä½†typeofç»“æœä¸º\u0026#39;function\u0026#39; result = o; } console.log(result); return result; } const obj2 = deepClone(obj1); console.log(obj2); console.log(obj1.c === obj2.c); // false obj1.c.push(99); console.log(obj2); // obj2 ä¸å˜ï¼Œå› ä¸ºæ²¡æœ‰â€œè—•æ–­ä¸è¿â€çš„ç°è±¡ obj1.c[2].p.push(999); console.log(obj2); // ä¸å˜ obj1.f = () =\u0026gt; { return 0; }; console.log([obj1.f(),obj2.f()]) // ä¸å˜ :memo: Note æ•°ç»„å’Œå¯¹è±¡åŒºåˆ«ï¼š\n-\u0026gt; for (let o in [0, 1, 2, 3]) {console.log([o, typeof[o]])} \u0026gt;\u0026gt; [\u0026#39;0\u0026#39;, \u0026#39;object\u0026#39;] \u0026gt;\u0026gt; [\u0026#39;1\u0026#39;, \u0026#39;object\u0026#39;] \u0026gt;\u0026gt; [\u0026#39;2\u0026#39;, \u0026#39;object\u0026#39;] \u0026gt;\u0026gt; [\u0026#39;3\u0026#39;, \u0026#39;object\u0026#39;] -\u0026gt; for (let o in {0:0, 1:1, 2:2, 3:3}) {console.log([o, typeof[o]])} \u0026gt;\u0026gt; [\u0026#39;0\u0026#39;, \u0026#39;object\u0026#39;] \u0026gt;\u0026gt; [\u0026#39;1\u0026#39;, \u0026#39;object\u0026#39;] \u0026gt;\u0026gt; [\u0026#39;2\u0026#39;, \u0026#39;object\u0026#39;] \u0026gt;\u0026gt; [\u0026#39;3\u0026#39;, \u0026#39;object\u0026#39;] -\u0026gt; Array.isArray([0,1,2,3]) \u0026gt;\u0026gt; true -\u0026gt; Array.isArray({0:0, 1:1, 2:2, 3:3}) \u0026gt;\u0026gt; false äºŒç»´æ•°ç»„ äºŒç»´æ•°ç»„ï¼šä»¥æ•°ç»„ä½œä¸ºæ•°ç»„å…ƒç´ çš„æ•°ç»„ï¼Œå³ â€œæ•°ç»„çš„æ•°ç»„â€ã€‚\näºŒç»´æ•°ç»„å¯ä»¥çœ‹åšæ˜¯ â€œçŸ©é˜µâ€ã€‚\n$$\\mathbf{A}=\\begin{bmatrix}11\u002633\u002655\\\\22\u002633\u002644\\\\36\u002649\u002652\\end{bmatrix}$$ const matrix = [ [11, 33, 55], [22, 33, 44], [36, 49, 52], ]; // äºŒç»´æ•°ç»„é•¿åº¦ console.log(matrix.length);\t// 4 console.log(matrix[1].length);\t// 3 // éå†äºŒç»´æ•°ç»„ for (let i = 0; i \u0026lt; matrix.length; i++) { for (let j = 0; j \u0026lt; matrix[i].length; j++) { console.log(matrix[i][j]); } } //ä½¿ç”¨for-in for (let row in matrix) { for (let col in matrix) { console.log(matrix[row][col]) } } ä¾‹é¢˜ æ•°ç»„å»é‡ é¢˜ç›®ï¼šå»æ‰æ•°ç»„ä¸­çš„é‡å¤é¡¹ã€‚\næ€è·¯ï¼šå‡†å¤‡ä¸€ä¸ªç©ºç»“æœæ•°ç»„ï¼Œéå†åŸæ•°ç»„ï¼Œå¦‚æœéå†åˆ°çš„é¡¹ä¸åœ¨ç»“æœæ•°ç»„ä¸­ï¼Œåˆ™æ¨å…¥ç»“æœæ•°ç»„ã€‚\n-\u0026gt; const arr = [1, 1, 1, 2, 2, 3, 3, 3, 2, 1]; const resultArr = []; for (let i = 0; i \u0026lt; arr.length; i++) { if (!resultArr.includes(arr[i])) { //includeåˆ¤æ–­æ˜¯å¦åŒ…å« resultArr.push(arr[i]); } } console.log(resultArr); \u0026gt;\u0026gt; [ 1, 2, 3 ] éšæœºæ ·æœ¬ é¢˜ç›®ï¼šè¯·éšæœºä»åŸæ•°ç»„åˆ é™¤è‹¥å¹²é¡¹ã€‚\næ€è·¯ï¼šå‡†å¤‡ä¸€ä¸ªç©ºç»“æœæ•°ç»„ï¼Œéå†åŸæ•°ç»„ï¼Œéšæœºé€‰æ‹©ä¸€é¡¹ï¼Œæ¨å…¥ç»“æœæ•°ç»„ï¼Œå¹¶ä¸”å°†è¿™é¡¹åœ¨åŸæ•°ç»„ä¸­åˆ é™¤ã€‚\n-\u0026gt; const arr = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]; const resultArr = []; const deleteCount = Math.random() * arr.length; for (let i = 0; i \u0026lt; deleteCount; i++) { const n = parseInt(Math.random() * arr.length); resultArr.push(arr[n]); arr.splice(n, 1); } console.log(resultArr); \u0026gt;\u0026gt; [ 2, 1, 8, 5, 9 ] å†’æ³¡æ’åº å†’æ³¡æ’åºæ˜¯ä¸€ä¸ªè‘—åçš„æ’åºç®—æ³•ï¼Œä¹Ÿæ˜¯æœ€åŸºç¡€çš„äº¤æ¢æ’åºã€‚\nå†’æ³¡æ’åºçš„æ ¸å¿ƒæ€æƒ³ï¼šä¸€è¶Ÿä¸€è¶Ÿåœ°è¿›è¡Œå¤šæ¬¡é¡¹çš„ ä¸¤ä¸¤æ¯”è¾ƒ ï¼Œæ¯æ¬¡éƒ½ä¼šå°†æœ€å¤§çš„å…ƒç´ æ’å¥½ä½ç½®ï¼Œå¦‚åŒæ°´ä¸­çš„æ°”æ³¡ä¸Šæµ®ä¸€æ ·ã€‚æ—¶é—´å¤æ‚åº¦ä¸º $$O(n^2)$$ ã€‚\n-\u0026gt; const arr = [9, 5, 6, 8, 2, 7, 3, 1, 4]; let temp; for (let i = 0; i \u0026lt; arr.length - 1; i++) { for (let j = i + 1; j \u0026lt; arr.length; j++) { if (arr[i] \u0026gt; arr[j]) { temp = arr[i]; arr[i] = arr[j]; arr[j] = temp; } } } console.log(arr); \u0026gt;\u0026gt; [1, 2, 3, 4, 5, 6, 7, 8, 9] //ä½¿ç”¨sort()å‡½æ•° -\u0026gt; const arr = [9, 5, 6, 8, 2, 7, 3, 1, 4]; arr.sort((a, b) =\u0026gt; { return a - b; }); console.log(arr); \u0026gt;\u0026gt; [1, 2, 3, 4, 5, 6, 7, 8, 9] å¯¹è±¡ :link: Href [ES6](06 EcmaScript.md/#object-es6) å¯¹å¯¹è±¡åˆè¿›è¡Œäº†ä¸€äº›æ‹“å±•\nå¯¹è±¡ Object æ˜¯ JavaScript çš„ä¸€ç§ å¤åˆæ•°æ®ç±»å‹ ï¼Œå®ƒå¯ä»¥æŠŠå¤šä¸ªæ•°æ®é›†ä¸­åœ¨ä¸€ä¸ªå˜é‡ä¸­ï¼Œå¹¶ä¸”ç»™å…¶ä¸­çš„æ¯ä¸ªæ•°æ®èµ· åå­— ã€‚\næˆ–è€…è¯´ï¼Œå¯¹è±¡æ˜¯ä¸€ä¸ª **å±æ€§é›†åˆ **ï¼Œæ¯ä¸ªå±æ€§æœ‰è‡ªå·±çš„ åå­— key å’Œ å€¼ value ã€‚JavaScript å¹¶ä¸åƒå…¶ä»– OOP è¯­è¨€é‚£æ ·æœ‰ ç±» çš„æ¦‚å¿µï¼Œä¸æ˜¯å…ˆè®¾è®¡ ç±» å†åˆ¶é€  å¯¹è±¡ã€‚\nä¸¥æ ¼æ¥è¯´ï¼ŒJS æ˜¯ä¸€é—¨ å…·æœ‰å¯¹è±¡ çš„è¯­è¨€ï¼Œè€Œä¸ä¸€å®šèƒ½è¢«ç§°ä¸º é¢å‘å¯¹è±¡ çš„è¯­è¨€ å¤§æ‹¬å· {} è¡¨ç¤ºå¯¹è±¡ï¼Œä½¿ç”¨ é”®å€¼å¯¹ key: value è¡¨ç¤ºæˆå‘˜ï¼Œæœ€åçš„å±æ€§åé¢ä¸åŠ é€—å·ã€‚ åˆ›å»º new Object() let o = new Object() let o = new Object(undefined) let o = new Object(null) //Using Object given undefined and null types /* equivalent to o = new Boolean(true) */ let o = new Object(true) /* equivalent to o = new Boolean(false) */ let o = new Object(Boolean()) //Using Object to create Boolean objects Object.create()\ncreates a new object, using an existing object as the prototype of the newly created object Object.create(proto[, propertiesObject])\nprotoå¿…å¡«å‚æ•°ï¼Œæ˜¯æ–°å¯¹è±¡çš„åŸå‹å¯¹è±¡ï¼Œå¦‚ä¸Šé¢ä»£ç é‡Œæ–°å¯¹è±¡meçš„__proto__æŒ‡å‘personã€‚æ³¨æ„ï¼Œå¦‚æœè¿™ä¸ªå‚æ•°æ˜¯nullï¼Œé‚£æ–°å¯¹è±¡å°±å½»å½»åº•åº•æ˜¯ä¸ªç©ºå¯¹è±¡ï¼Œæ²¡æœ‰ç»§æ‰¿Object.prototypeä¸Šçš„ä»»ä½•å±æ€§å’Œæ–¹æ³•ï¼Œå¦‚hasOwnProperty()ã€toString()ç­‰ã€‚ propertiesObjectæ˜¯å¯é€‰å‚æ•°ï¼ŒæŒ‡å®šè¦æ·»åŠ åˆ°æ–°å¯¹è±¡ä¸Šçš„å¯æšä¸¾çš„å±æ€§ï¼ˆå³å…¶è‡ªå®šä¹‰çš„å±æ€§å’Œæ–¹æ³•ï¼Œå¯ç”¨hasOwnProperty()è·å–çš„ï¼Œè€Œä¸æ˜¯åŸå‹å¯¹è±¡ä¸Šçš„ï¼‰çš„æè¿°ç¬¦åŠç›¸åº”çš„å±æ€§åç§°ã€‚ const person = { isHuman: false, printIntroduction: function() { console.log(`My name is ${this.name}. Am I human? ${this.isHuman}`); } }; const me = Object.create(person); me.name = \u0026#39;Matthew\u0026#39;; /* \u0026#34;name\u0026#34; is a property set on \u0026#34;me\u0026#34;, but not on \u0026#34;person\u0026#34; */ me.isHuman = true; /* inherited properties can be overwritten */ me.printIntroduction(); \u0026gt; \u0026#34;My name is Matthew. Am I human? true\u0026#34; person.printIntroduction(); \u0026gt; \u0026#34;My name is undefined. Am I human? false\u0026#34; note:å¯ä»¥ä½¿ç”¨ Object.create(null) æ¥åˆ›å»ºä¸€ä¸ªæ²¡æœ‰åŸå‹çš„å¯¹è±¡\nUsing initializer notation {} const object1 = { a: \u0026#39;foo\u0026#39;, b: 42, c: {} }; console.log(object1.a); \u0026gt; \u0026#34;foo\u0026#34; const a = \u0026#39;foo\u0026#39;; const b = 42; const c = {}; const object2 = { a: a, b: b, c: c }; console.log(object2.b); \u0026gt; 42 const object3 = { a, b, c }; console.log(object3.a); \u0026gt; \u0026#34;foo\u0026#34; const obj = { key: value, \u0026#39;key-name\u0026#39;: value // å±æ€§åä¸­æœ‰çŸ­æ¨ªï¼Œä¸ç¬¦åˆJSæ ‡è¯†ç¬¦å‘½åè§„èŒƒæ—¶ï¼Œå±æ€§åå¿…é¡»ç”¨å¼•å·åŒ…è£¹ã€‚ }; åˆ é™¤ There isn\u0026rsquo;t any method in an Object itself to delete its own properties (such as Map.prototype.delete()). To do so, one must use the delete operator.\ndelete let president = {firstname: \u0026#39;Joe\u0026#39;,lastname: \u0026#39;Biden\u0026#39; }; console.log(president.firstname); \u0026gt; \u0026#34;Joe\u0026#34; delete president.firstname; console.log(president.firstname); \u0026gt; undefined å¯¹è±¡å±æ€§åˆ é™¤\nfunction Fun() { this.foo = \u0026#39;bar\u0026#39;; } const obj = new Fun(); console.log( obj.foo, // bar delete obj.foo, // true obj.foo //undefined ); å˜é‡åˆ é™¤\nlet foo = \u0026#39;bar\u0026#39;; delete foo; console.log(foo); // \u0026#39;bar\u0026#39; :memo: Note delete æ“ä½œç¬¦ä¸èƒ½ç›´æ¥åˆ é™¤å˜é‡ã€‚\nåˆ é™¤ä¸äº†åŸå‹é“¾ä¸­çš„å˜é‡\nfunction Obj() { Obj.prototype.foo = \u0026#39;bar\u0026#39;; } const obj = new Obj(); console.log( obj.foo, // bar delete obj.foo, // true obj.foo, // bar delete Obj.prototype.foo, // false obj.foo //undefined ); :link: Href Object.prototype\næ–¹æ³• å¦‚æœæŸä¸ªå±æ€§å€¼æ˜¯å‡½æ•°ï¼Œåˆ™å®ƒä¹Ÿè¢«ç§°ä¸ºå¯¹è±¡çš„ æ–¹æ³• ã€‚\næ–¹æ³•æ—¢å¯ä»¥é€šè¿‡ . è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ [] è°ƒç”¨ã€‚\ndefineProperty() defineProperties() ?å’Œprototypeæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\nå°†åœ¨Es6ä¸­é€æ¸è¢«reflectä»£æ›¿\néå† :link: Href [ES6](06 EcmaScript.md/##iterator-es6) iterator\nfor-in :link: Href for-in\nfor(var x in o){ o[name];\t/* å¯ä»¥ç»™å¯¹è±¡æä¾›è¿è¡Œæ—¶åˆ»æ‰çŸ¥é“çš„å€¼ */ statement; } :link: Href Object çš„æ·±æ‹·è´å’Œæµ…æ‹·è´\næ„é€ å‡½æ•° ç±»ä¼¼äºå…¶å®ƒ OOP è¯­è¨€ä¸­çš„ class\nä¸ç›´æ¥ åˆ¶é€ å¯¹è±¡\né€šè¿‡ this æ¥å®šä¹‰æˆå‘˜\nthis æŒ‡å‘çš„æ˜¯ç”±è¿™ä¸ªå‡½æ•°æ‰€åˆ›å»ºçš„ç©ºç™½å¯¹è±¡ æ²¡æœ‰ return\nnew å‘½ä»¤çš„ä½œç”¨ï¼Œå°±æ˜¯æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªå®ä¾‹å¯¹è±¡\næ„é€ å‡½æ•°å¿…é¡»æœ‰ new å…³é”®å­—\nnew å°±æ˜¯ åˆ›é€ å¯¹è±¡ çš„è¿‡ç¨‹ new ä¹Ÿå«åš å®ä¾‹åŒ–å¯¹è±¡ çš„è¿‡ç¨‹ new åˆ›é€ å‡ºæ¥çš„å¯¹è±¡å«åš æ„é€ å‡½æ•° çš„ å®ä¾‹å¯¹è±¡ æ„é€ å‡½æ•°å’Œ OOP ä¸­çš„ class\nJavaã€C++ ç­‰æ˜¯ â€œé¢å‘å¯¹è±¡â€ è¯­è¨€ JavaScript æ˜¯ â€œåŸºäºå¯¹è±¡â€ è¯­è¨€ é¢å‘å¯¹è±¡ $$\\neq$$ åŸºäºå¯¹è±¡ JavaScript ä¸­çš„æ„é€ å‡½æ•°å¯ä»¥ç±»æ¯”äº OOP è¯­è¨€ä¸­çš„ class ï¼Œå†™æ³•çš„ç¡®ç±»ä¼¼ï¼Œä½†å’ŒçœŸæ­£çš„ OOP è¯­è¨€è¿˜æ˜¯æœ‰æœ¬è´¨ä¸åŒã€‚ :memo: Note ä¸€ä¸ªå‡½æ•°æ˜¯ä¸æ˜¯æ„é€ å‡½æ•°ï¼Œè¦çœ‹å®ƒæ˜¯å¦ç”¨ new è°ƒç”¨ï¼Œè€Œè‡³äºåç§°é¦–å­—æ¯å¤§å†™ï¼Œå®Œå…¨æ˜¯å¼€å‘è€…çš„ä¹ æƒ¯çº¦å®šã€‚\nfunction Rect(w,h) { this.width = w; this.height = h; this.area = function () { return this.width * this.height; }; /* // :memo: NOTE: ä½¿ç”¨ç®­å¤´å‡½æ•°çš„æ—¶å€™thiså¹¶æ²¡æœ‰å—åˆ°å½±å“ // thisé»˜è®¤æŒ‡å‘çˆ¶çº§å³æ„é€ å‡½æ•°æœ¬èº«ï¼Œå› æ­¤ä¸å—å½±å“ this.area = () =\u0026gt; this.width * this.height; */ } // Usage let r = new Rect(5,10); console.log(r.area()); // ä¸ä½¿ç”¨ Rect(1, 2); Rect(3, 4); Rect(5, 6); /* æ­¤æ—¶thisæŒ‡å‘windowå¯¹è±¡ï¼Œæ‰€ä»¥è¿™ä¸‰æ¡è¯­å¥ä¼šä¾æ¬¡è¦†ç›– */ /* ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œç”±äºthisæŒ‡å‘undefinedï¼Œå› æ­¤ä¼šæŠ¥é”™ */ /* TypeError: Cannot set properties of undefined (setting \u0026#39;width\u0026#39;) */ æµ‹è¯• åŒ¿åå‡½æ•° this æŒ‡å‘å’Œ æ™®é€šå‡½æ•° åŒºåˆ«ï¼š\nfunction Rect(w, h) { this.width = w; this.height = h; this.area = _ =\u0026gt; this.width * this.height; this.deep = { fnAnonymous: _ =\u0026gt; [this, this.width * this.height], fnThis: function () { return [this, this.width * this.height]; } } } let area = new Rect(5, 10); console.log ([area.deep.fnAnonymous(), area.deep.fnThis()]); \u0026gt;\u0026gt;(2) [Array(2), Array(2)] 0: Array(2) 0: Rect {...} //ç®­å¤´åŒ¿åå‡½æ•°æŒ‡å‘å®šä¹‰æ—¶æ‰€å¤„çš„å¯¹è±¡ //è‹¥çˆ¶çº§thisæŒ‡é’ˆä¸å­˜åœ¨ï¼Œåˆ™ä¸€ç›´å‘ä¸Šç»§ç»­å¯»æ‰¾ //è€Œfunction Rectå­˜åœ¨thisæŒ‡é’ˆ //æ•…æŒ‡å‘Rect //ç±»ä¼¼äºâ€œå­ç»çˆ¶ç›¸â€ï¼Œç»å¯¹å®šä½ä¼šä¸€ç›´å‘ä¸Šæº¯æº //ç›´åˆ°æ‰¾åˆ°å…·æœ‰å®šä½çš„ç›’å­ 1: 50 length: 2 [[Prototype]]: Array(0) 1: Array(2) 0: {fnAnonymous: Æ’, fnThis: Æ’} //æ™®é€šå‡½æ•°æŒ‡å‘è°ƒç”¨è€…ï¼Œä¹Ÿå°±æ˜¯æŒ‡å‘äº†deep 1: NaN length: 2 [[Prototype]]: Array(0) length: 2 [[Prototype]]: Array(0) :link: Href for-of\nNew new å‡½æ•°()\nä½¿ç”¨ new æ“ä½œç¬¦è°ƒç”¨å‡½æ•°ä¼šè¿›è¡Œ â€œå››æ­¥èµ°â€ï¼š\nå‡½æ•°ä½“å†…ä¼šè‡ªåŠ¨åˆ›å»ºå‡ºä¸€ä¸ª ç©ºç™½å¯¹è±¡ å‡½æ•°ä½“å†… this æŒ‡é’ˆä¼šæŒ‡å‘è¿™ä¸ªå¯¹è±¡ å‡½æ•°ä½“å†…çš„è¯­å¥ä¼šæ‰§è¡Œ è¿”å› this æŒ‡é’ˆ -\u0026gt; let fun = function () { console.log(this); } let foo = new fun(); console.log(foo); \u0026gt;\u0026gt; fun {} fun {} åŸå‹å¯¹è±¡ Prototype å¯¹è±¡çš„ prototype å±æ€§æŒ‡å®šäº†å®ƒçš„åŸå‹å¯¹è±¡ã€‚\n:link: Href [ES6](06 EcmaScript.md/#proto-es6) prototype åŸå‹å¯¹è±¡æ‰©å±•\nå¯ä»¥ç”¨ . è¿ç®—ç¬¦ç›´æ¥è¯»å®ƒçš„åŸå‹å¯¹è±¡çš„å±æ€§ï¼Œå½“å†™è¿™ä¸ªå±æ€§æ—¶æ‰åœ¨å®ƒè‡ªå·±å†…éƒ¨äº§ç”Ÿ å®é™…çš„å±æ€§ï¼Œå¦åˆ™å°†å…±äº« åŒä¸€ä¸ª å…ƒç´ ã€‚å¯ä»¥å‡å°‘å†…å­˜çš„æµªè´¹ã€‚\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;å‡½æ•°\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; prototype ------\u0026gt; \u0026lt;------ constructor å‡½æ•°.prototype -\u0026gt; function Sum(a, b) { return a + b; } -\u0026gt; console.log(Sum.prototype); \u0026gt;\u0026gt; {constructor: Æ’} constructor: Æ’ Sum(a, b) [[Prototype]]: Object -\u0026gt; console.log(typeof Sum.prototype); \u0026gt;\u0026gt; object -\u0026gt; console.log(Sum.prototype.constructor); \u0026gt;\u0026gt; Æ’ Sum(a, b) { return a + b; } -\u0026gt; console.log(typeof Sum.prototype.constructor); \u0026gt;\u0026gt; function -\u0026gt; console.log(Sum.prototype.constructor === Sum); \u0026gt;\u0026gt; true å¯¹äºæ™®é€šå‡½æ•°æ¥è¯´çš„ prototype å±æ€§æ²¡æœ‰ä»»ä½•ç”¨å¤„ï¼Œè€Œæ„é€ å‡½æ•°çš„ prototype å±æ€§æ˜¯å®ƒçš„ construct çš„åŸå‹ã€‚\ngraph LR _constructor[Peopleæ„é€ å‡½æ•°]--prototype--\u0026gt;_prototype[People.prototype] _person[Nicholas]--Object.getPrototypeOf--\u0026gt;_prototype[People.prototype] _constructor--new--\u0026gt;_person :warning:Warning Changing the [[Prototype]] of an object is, by the nature of how modern JavaScript engines optimize property accesses, a very slow operation, in every browser and JavaScript engine. The effects on the performance of altering inheritance are subtle and far-flung, and are not limited to the time spent in obj.__proto__ = ... statements, but may extend to any code that has access to any object whose [[Prototype]] has been altered. If you care about performance you should avoid setting the [[Prototype]] of an object. Instead, create a new object with the desired [[Prototype]] using Object.create().\n:warning:Warning While Object.prototype.__proto__ is supported today in most browsers, its existence and exact behavior has only been standardized in the ECMAScript 2015 specification as a legacy feature to ensure compatibility for web browsers. For better support, use Object.getPrototypeOf() instead.\nfunction Person() { Person.prototype.name = \u0026#34;Nicholas\u0026#34;; Person.prototype.age = 29; Person.prototype.job = \u0026#34;Software Engineer\u0026#34;; Person.prototype.sayName = function () { return this.name; } }; let person1 = new Person(); person1.sayName(); //\u0026#34;Nicholas\u0026#34; let person2 = new Person(); person2.sayName(); //\u0026#34;Nicholas\u0026#34; document.writeln(`${person1.sayName()}`); document.writeln(`${person2.sayName()}`); graph LR _constructor[Personæ„é€ å‡½æ•°]-- prototype--\u0026gt;_prototype[Person.prototype] _person1[Nicholas\u0026lt;br\u0026gt;]-- Object.getPrototypeOf--\u0026gt;_prototype[People.prototype\u0026lt;br\u0026gt;\u0026lt;div style=\u0026#39;text-align:left\u0026#39;\u0026gt;\u0026lt;kbd\u0026gt;name\u0026lt;/kbd\u0026gt;: \u0026#39;Nicholas\u0026#39;\u0026lt;br\u0026gt;\u0026lt;kbd\u0026gt;age\u0026lt;/kbd\u0026gt;: 29\u0026lt;br\u0026gt;\u0026lt;kbd\u0026gt;job\u0026lt;/kbd\u0026gt;: \u0026#39;Software Engineer\u0026#39;\u0026lt;br\u0026gt;\u0026lt;kbd\u0026gt;sayName\u0026lt;/kbd\u0026gt;: function\u0026lt;/div\u0026gt; ] _person2[Greg\u0026lt;br\u0026gt;\u0026lt;div style=\u0026#39;text-align:left\u0026#39;\u0026gt;\u0026lt;kbd\u0026gt;name\u0026lt;/kbd\u0026gt;: \u0026#39;Greg\u0026#39;\u0026lt;/div\u0026gt;]-- Object.getPrototypeOf--\u0026gt;_prototype _constructor--new--\u0026gt;_person1 _constructor--new--\u0026gt;_person2 Person1\n__proto__: Person Prototpe name: \u0026ldquo;Greg\u0026rdquo; Person2\n__proto__: Person Prototpe Person Prototpe\nconstructor: :black_small_square:\nname: \u0026ldquo;Nicholas\u0026rdquo;\nage: \u0026ldquo;29\u0026rdquo;\njob: \u0026ldquo;Software Engineer\u0026rdquo;\nsayName: ( function )\nPerson.prototype= { constructor: Person, name: \u0026#34;Nicholas\u0026#34;, age: 29, job: \u0026#34;Software Engineer\u0026#34;, friends: [\u0026#34;Shelby\u0026#34;, \u0026#34;Court\u0026#34;], sayName: () =\u0026gt; this.name } let person1 = new Person(); let person2 = new Person(); person1.friends.push(\u0026#34;Van\u0026#34;); document.writeln(person1.friends); document.writeln(person2.friends); è‹¥ä¸å¸Œæœ›éƒ¨åˆ†æˆå‘˜åœ¨å…ƒç´ ä¹‹é—´å…±äº«ï¼š\nfunction Person(name, age, job){ this.name = name; this.age = age; this.job = job; this.friends = [\u0026#34;Shelby\u0026#34;, \u0026#34;Court\u0026#34;]; } Person.prototype = { constructor: Person, sayName: () =\u0026gt; this.name } let person1 = new Person(\u0026#34;Nicolas\u0026#34;,29,\u0026#34;Software Engineer\u0026#34;); let person2 = new Person(\u0026#34;Vans\u0026#34;,31,\u0026#34;Manager\u0026#34;); person1.friends.push(\u0026#34;Van\u0026#34;); document.writeln(person1.sayName()); document.writeln(person2.friends); console.log(person2); ä½¿ç”¨ ES6 - ECMAScript 2015 æ–°ç‰¹æ€§ classï¼š\nclass Person { constructor(name, age, job) { this.name = name; this.age = age; this.job = job; this.friends = [\u0026#34;Shelby\u0026#34;, \u0026#34;Court\u0026#34;]; } sayName = () =\u0026gt; this.name; sayJob(){ return this.job; } } Create The Object.create() method creates a new object, using an existing object as the prototype of the newly created object.\nå¯ä»¥ä»£æ›¿ new çš„ä½œç”¨ï¼Œä»¥åŸå¯¹è±¡ä¸º prototype åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚\n// Syntax Object.create(proto) Object.create(proto, propertiesObject) const person = { isHuman: false, printIntroduction: function() { console.log(`My name is ${this.name}. Am I human? ${this.isHuman}`); } }; const me = Object.create(person); me.name = \u0026#39;Matthew\u0026#39;; // \u0026#34;name\u0026#34; is a property set on \u0026#34;me\u0026#34;, but not on \u0026#34;person\u0026#34; me.isHuman = true; // inherited properties can be overwritten :page_with_curl: Example\nconst obj = Object.create({}, {p: {value: 42}}); Object.values(obj) // [] ä¸Šé¢ä»£ç ä¸­ï¼ŒObject.create æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ·»åŠ çš„å¯¹è±¡å±æ€§ï¼ˆå±æ€§pï¼‰ï¼Œå¦‚æœä¸æ˜¾å¼å£°æ˜ï¼Œé»˜è®¤æ˜¯ä¸å¯éå†çš„ï¼Œå› ä¸ºpçš„å±æ€§æè¿°å¯¹è±¡çš„ enumerable é»˜è®¤æ˜¯ false ï¼ŒObject.valuesä¸ä¼šè¿”å›è¿™ä¸ªå±æ€§ã€‚åªè¦æŠŠ enumerable æ”¹æˆtrueï¼ŒObject.valueså°±ä¼šè¿”å›å±æ€§p`çš„å€¼ã€‚\nconst obj = Object.create({}, {p: { value: 42, enumerable: true } }); Object.values(obj) // [42] In The in operator returns true if the specified property is in the specified object or its prototype chain.\n// Syntax prop in object; const car = { make: \u0026#39;Honda\u0026#39;, model: \u0026#39;Accord\u0026#39;, year: 1998 }; console.log(\u0026#39;make\u0026#39; in car); // expected output: true delete car.make; if (\u0026#39;make\u0026#39; in car === false) { car.make = \u0026#39;Suzuki\u0026#39;; } console.log(car.make); // expected output: \u0026#34;Suzuki\u0026#34; ç»ˆç‚¹ å¯¹è±¡ åœ¨ JavaScript ä¸­ï¼Œ Object å¯ä»¥çœ‹ä½œæ˜¯æ‰€æœ‰å¯¹è±¡çš„æ„é€ å‡½æ•°ã€‚æ‰€ä»¥ï¼ŒPeople.prototype è¿™ä¸ªå¯¹è±¡å¯ä»¥çœ‹ä½œæ˜¯ Object é€šè¿‡ new è¿ç®—ç¬¦åˆ›é€ å‡ºæ¥çš„\næ•°ç»„ ä»»ä½•æ•°ç»„å®é™…ä¸Šéƒ½æ˜¯å¯ä»¥çœ‹åšæ˜¯ Array è¿™ä¸ªæ„é€ å‡½æ•° new å‡ºæ¥çš„ã€‚è€Œ Array å¯¹è±¡ç»§ç»­å‘ä¸Šæº¯æºçš„åŸå‹æ˜¯ Object ã€‚\nObject Prototype\nconstructor: :black_small_square: hasOwnproperty(): ( function Æ’ ) toString(): ( function Æ’ ) \u0026hellip;\u0026hellip; Array Prototype\nconstructor: :black_small_square: hasOwnproperty(): ( function Æ’ ) toString(): ( function Æ’ ) \u0026hellip;\u0026hellip; [...]\n0: \u0026quot; Value \u0026ldquo; \u0026hellip;\u0026hellip; length: [].length [[Prototype]]: Array (0) å¯¹è±¡é€šè¿‡ ç»§æ‰¿é“¾ å®ç°ç»§æ‰¿ã€‚\n// å…³é”®è¯­å¥ï¼Œå®ç°ç»§æ‰¿ // åˆ›å»ºæ–°å¯¹è±¡æ—¶ä¼šè‡ªåŠ¨ä»åŸæ¥çš„åŸå‹é“¾ç»§æ‰¿ Student.prototype = new People(); get set åŒ…è£…ç±» å¾ˆå¤šç¼–ç¨‹è¯­è¨€éƒ½æœ‰ åŒ…è£…ç±» çš„è®¾è®¡ï¼ŒåŒ…è£…ç±»çš„ç›®çš„å°±æ˜¯ä¸ºäº†è®©åŸºæœ¬ç±»å‹å€¼å¯ä»¥ä»å®ƒä»¬çš„æ„é€ å‡½æ•°çš„ prototype ä¸Šè·å¾—æ–¹æ³•ã€‚\nè€Œ Number() ã€String() ã€Boolean() åˆ†åˆ«æ˜¯æ•°å­—ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼çš„ åŒ…è£…ç±» ã€å®ä¾‹éƒ½æ˜¯ object ç±»å‹ï¼Œå®ƒä»¬çš„ PrimitiveValue å±æ€§å­˜å‚¨å®ƒä»¬çš„æœ¬èº«å€¼ã€‚\nåŒ…è£…ç±»çš„ç›®çš„å°±æ˜¯ä¸ºäº†è®©åŸºæœ¬ç±»å‹å€¼å¯ä»¥ä»å®ƒä»¬çš„æ„é€ å‡½æ•°çš„ prototype ä¸Šè·å¾—æ–¹æ³•ã€‚ï¼ˆ. è¿ç®—ç¬¦ï¼‰\n// åŸºæœ¬ç±»å‹é€šè¿‡åŒ…è£…ç±»ä½¿ç”¨ç›¸åº”çš„æ–¹æ³•ï¼ˆåŒJavaï¼‰ let a = Number(42); let b = String(\u0026#39;String\u0026#39;); let c = Boolean(true); console.log([typeof a,a]); // [ \u0026#39;number\u0026#39;, 42 ] console.log([typeof b,b]); // [ \u0026#39;string\u0026#39;, \u0026#39;String\u0026#39; ] console.log([typeof c,c]); // [ \u0026#39;boolean\u0026#39;, true ] let d = 1; console.log(Object.getPrototypeOf(d) === Number.prototype); let e = \u0026#39;Str\u0026#39;; // true console.log(Object.getPrototypeOf(e) === String.prototype); let f = false; // true console.log(Object.getPrototypeOf(f) === Boolean.prototype); // true :memo: Note Array() ä¸æ˜¯æ•°ç»„çš„åŒ…è£…ç±»ï¼Œå› ä¸ºæ•°ç»„ ä¸æ˜¯åŸºæœ¬ç±»å‹ ï¼Œarray ç±»å‹å±äº object ã€‚\næ•°å­¦ç±» Math is a built-in object that has properties and methods for mathematical constants and functions. It\u0026rsquo;s not a function object.\nMath works with the Number type. It doesn\u0026rsquo;t work with BigInt.\n:link: Href [ES6](06 EcmaScript.md/#number-es6) æ–°å¢çš„ Math æ–¹æ³•\nå¹‚æ¬¡ JS ä¸­æ²¡æœ‰æä¾›å¹‚è¿ç®—ã€å¼€æ ¹å·çš„è¿ç®—ç¬¦ã€‚éœ€è¦ä½¿ç”¨ Math å¯¹è±¡çš„ç›¸å…³æ–¹æ³•è¿›è¡Œè®¡ç®—ã€‚\nä»£ç  è¯´æ˜ Math.pow(a, b) $$a^b$$ Math.sqrt(a) $$\\sqrt{a}$$ -\u0026gt; Math.pow(2, 3); \u0026gt;\u0026gt; 8 -\u0026gt; Math.pow(3, 2); \u0026gt;\u0026gt; 9 -\u0026gt; Math.sqrt(81); \u0026gt;\u0026gt; 9 -\u0026gt; Math.sqrt(-81); \u0026gt;\u0026gt; NaN -\u0026gt; Math.pow(3, 1/2); \u0026gt;\u0026gt; 1.7320508075688772 -\u0026gt; Math.sqrt(3); \u0026gt;\u0026gt; 1.7320508075688772 å–æ•´ ä»£ç  è¯´æ˜ Math.ceil(x) $\\lceil x \\rceil$ Math.floor(x) $\\lfloor x \\rfloor$ ä¿ç•™ä½æ•° ğŸ”— Href Number.prototype.toFixed()\nå››èˆäº”å…¥ ä»£ç  è¯´æ˜ Math.ceil(x) å››èˆäº”å…¥ -\u0026gt; Math.round(3.98) \u0026gt;\u0026gt; 4 -\u0026gt; let a = 3.7554; Math.round(a * 100) / 100; \u0026gt;\u0026gt; 3.76 æå€¼ ä»£ç  è¯´æ˜ Math.max() $$\\max \\limits_{\\left[paramList \\right]}f(x)$$ Math.min() $$\\min \\limits_{\\left[paramList \\right]}f(x)$$ éšæœºæ•° ä»£ç  è¯´æ˜ Math.random() $${\\small random} \\ x\\in\\left [ 0,1 \\right )$$ parseInt(Math.random() * (b - a + 1)) + a $${\\small random} \\ x\\in\\left [ a,b \\right )$$ // å¯ä»¥ç”¨Math.random()*n|0å–æ•´ï¼Œè¯­æ³•ä¸Šæ›´åŠ ç®€æ´ let F = 0, T = 0; for (let i = 0; i \u0026lt; 65553600; i++) { Math.random() * 20 | 0 ? F++ : T++; } console.log(F, T, F / T); // æ¥è¿‘1:19 æ—¥æœŸç±» new Date() å³å¯å¾—åˆ°å½“å‰æ—¶é—´çš„æ—¥æœŸå¯¹è±¡ï¼Œå®ƒæ˜¯ object ç±»å‹å€¼ã€‚\nCreates a JavaScript Date instance that represents a single moment in time in a platform-independent format.Date objects contain a Number that represents milliseconds since 1 January 1970 UTC.\n// Syntax new Date() new Date(value) new Date(dateString) new Date(dateObject) new Date(year, monthIndex) new Date(year, monthIndex, day) new Date(year, monthIndex, day, hours) new Date(year, monthIndex, day, hours, minutes) new Date(year, monthIndex, day, hours, minutes, seconds) new Date(year, monthIndex, day, hours, minutes, seconds, milliseconds) // Demo const date1 = new Date(\u0026#39;December 17, 1995 03:24:00\u0026#39;); const date2 = new Date(\u0026#39;1995-12-17T03:24:00\u0026#39;); -\u0026gt; console.log(date1 === date2); console.log(date1 - date2); console.log([date1,date2]); \u0026gt;\u0026gt; false 0 Sun Dec 17 1995 03:24:00 GMT+0800 (China Standard Time) å¸¸è§æ–¹æ³• æ–¹æ³• åŠŸèƒ½ getDate() å¾—åˆ°æ—¥æœŸ $$D\\in[1,31]$$ getDay() å¾—åˆ°æ˜ŸæœŸ $$W\\in[0,6]$$ getMonth() å¾—åˆ°æœˆä»½ $$M\\in[0,11]$$ getFullYear() å¾—åˆ°å¹´ä»½ getHours() å¾—åˆ°å°æ—¶æ•° $$H\\in[0,23]$$ getMinutes() å¾—åˆ°åˆ†é’Ÿæ•° $$M\\in[0,59]$$ getSeconds() å¾—åˆ°ç§’æ•° $$S\\in[0,59]$$ //Usage -\u0026gt; (_ =\u0026gt; console.log([typeof _.getDate(), _.getDate()]))(new Date()); \u0026gt;\u0026gt; [ \u0026#39;number\u0026#39;, 30 ] æ—¶é—´æˆ³ æ—¶é—´æˆ³è¡¨ç¤º 1970 å¹´ 1 æœˆ 1 æ—¥ é›¶ç‚¹æ•´è·ç¦»æŸæ—¶åˆ»çš„æ¯«ç§’æ•°ï¼ˆUNIX æ—¶é—´ï¼‰\nThe DOMHighResTimeStamp type is a double and is used to store a time value in milliseconds.\nThis type can be used to describe a discrete point in time or a time interval (the difference in time between two discrete points in time).\nThe time, given in milliseconds, should be accurate to 5 Âµs (microseconds)\né€šè¿‡ getTime() æ–¹æ³•æˆ–è€… Date.parse() å‡½æ•°å¯ä»¥å°†æ—¥æœŸå¯¹è±¡å˜ä¸ºæ—¶é—´æˆ³ é€šè¿‡ new Date(æ—¶é—´æˆ³) çš„å†™æ³•ï¼Œå¯ä»¥å°† æ—¶é—´æˆ³ å˜ä¸º æ—¥æœŸå¯¹è±¡ // æ—¥æœŸå¯¹è±¡ const d = new Date(); // æ˜¾ç¤ºæ—¶é—´æˆ³çš„ä¸¤ç§æ–¹å¼ const timestamp1 = d.getTime(); // ç²¾ç¡®åˆ°æ¯«ç§’ const timestamp2 = Date.parse(d); // ç²¾ç¡®åˆ°ç§’ï¼Œä¹Ÿæ˜¯æ¯«ç§’æ•°ï¼Œåªä¸è¿‡æœ€åä¸‰ä½ä¸€å®šæ˜¯ 000 -\u0026gt; console.log(timestamp1); console.log(timestamp2); \u0026gt;\u0026gt; 1648690017974 1648690017000 // å°†æ—¶é—´æˆ³å˜ä¸ºæ—¥æœŸå¯¹è±¡ -\u0026gt; const dd = new Date(1644661417000); console.log(dd); \u0026gt;\u0026gt; Sat Feb 12 2022 18:23:37 GMT+0800 (China Standard Time) new new éƒ½åšäº†ä»€ä¹ˆï¼Ÿ\n// ç±»ï¼šæ‰€æœ‰å±æ€§å’Œæ–¹æ³•æ¨¡æ¿çš„é›†åˆ function Person(name=\u0026#39;\u0026#39;, age=0, sex=\u0026#39;\u0026#39;) { this.name = name this.age = age this.sex = sex } // æ‰€æœ‰å®ä¾‹å¯¹è±¡å…±äº«æ–¹æ³• - èŠ‚çœå†…å­˜ Person.prototype.say = function(){} // ç”Ÿäº§å¯¹è±¡ let person = new Person(\u0026#39;foo\u0026#39;, 18, \u0026#39;ç”·\u0026#39;) console.log(person) // Person {name: \u0026#39;foo\u0026#39;, age: 18, sex: \u0026#39;ç”·\u0026#39;} new ä¼šåˆ›å»ºä¸€ä¸ªç©ºç™½å¯¹è±¡ è°ƒç”¨ Person æ‰§è¡Œ new Person ï¼Œæ­¤æ—¶æ›¿æ¢ person å‡½æ•°é‡Œ this çš„æŒ‡å‘ä¸ºä¸€ä¸ªæ–°çš„ç©ºç™½å¯¹è±¡ æ¡ˆä¾‹ çº¢ç»¿ç¯ ğŸš¥ \u0026lt;!-- æœªå®Œæˆ --\u0026gt; \u0026lt;style\u0026gt; :root { font-size: 625%; } @media screen and (min-width: 128px) { .traffic_light { height: 2em; width: .75em; } } .traffic_light { background-image: linear-gradient(87deg, #434343 0%, black 90%); border-radius: .1em; display: flex; flex-direction: column; align-items: center; justify-content: space-around; } .red, .yellow, .green { background-color: red; background-image: linear-gradient(60deg, rgba(134, 143, 150, 0.98) 0%, #596164 100%); border-radius: 50%; height: .45em; width: .45em; box-shadow: .01em .01em .15em 0 #363636 inset; } .red::before, .yellow::before, .green::before { content: \u0026#39;\u0026#39;; display: block; border-radius: 50%; height: 100%; width: 100%; transition: all 1s cubic-bezier(0, 0.6, 1, 1.03); } .red.off::before, .yellow.off::before, .green.off::before { opacity: 0; } .red::before { background-image: linear-gradient(60deg, #ff0844 0%, #ffb199 100%); box-shadow: 0 0 .05em 0 red; } .yellow::before { background-image: linear-gradient(60deg, #ff962a 0%, #fff029); box-shadow: 0 0 .05em 0 yellow; } .green::before { background-image: linear-gradient(60deg, #12992c 0%, #5ce0d3 100%); box-shadow: 0 0 .05em 0 green; } .off { } \u0026lt;/style\u0026gt; \u0026lt;div class=\u0026#34;traffic_light\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;red\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;yellow off\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;green\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; \u0026#34;use strict\u0026#34; let control = [[1, 0, 0], [0, 1, 0], [0, 0, 1], [0, 1, 1], [1, 0, 1], [1, 1, 0], [1, 1, 1]]; // .children function TrafficLight() { this.color = []; } for (let i = 10; i \u0026gt; 0; i--) { Object.create({ dom: document.getElementsByClassName(\u0026#34;traffic_light\u0026#34;)[0], status: [], bindEvent: function () { } }); } \u0026lt;/script\u0026gt; å°çƒ âšªï¸ \u0026lt;!-- æœªå®Œæˆ --\u0026gt; \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34; name=\u0026#34;viewport\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Document\u0026lt;/title\u0026gt; \u0026lt;style\u0026gt; body { background-color: black; } .ball { position: absolute; border-radius: 50%; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;script\u0026gt; // å°çƒç±» function Ball(x, y) { // å±æ€§xã€yè¡¨ç¤ºçš„æ˜¯åœ†å¿ƒçš„åæ ‡ this.x = x; this.y = y; // åŠå¾„å±æ€§ this.r = 20; // é€æ˜åº¦ this.opacity = 1; // å°çƒèƒŒæ™¯é¢œè‰²ï¼Œä»é¢œè‰²æ•°ç»„ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªé¢œè‰² this.color = colorArr[parseInt(Math.random() * colorArr.length)]; // è¿™ä¸ªå°çƒçš„xå¢é‡å’Œyçš„å¢é‡ï¼Œä½¿ç”¨do whileè¯­å¥ï¼Œå¯ä»¥é˜²æ­¢dXå’ŒdYéƒ½æ˜¯é›¶ do { this.dX = parseInt(Math.random() * 20) - 10; this.dY = parseInt(Math.random() * 20) - 10; } while (this.dX === 0 \u0026amp;\u0026amp; this.dY === 0) // åˆå§‹åŒ– this.init(); // æŠŠè‡ªå·±æ¨å…¥æ•°ç»„ï¼Œæ³¨æ„ï¼Œè¿™é‡Œçš„thisä¸æ˜¯ç±»æœ¬èº«ï¼Œè€Œæ˜¯å®ä¾‹ ballArr.push(this); } // åˆå§‹åŒ–æ–¹æ³• Ball.prototype.init = function () { // åˆ›å»ºè‡ªå·±çš„dom this.dom = document.createElement(\u0026#39;div\u0026#39;); this.dom.className = \u0026#39;ball\u0026#39;; this.dom.style.width = this.r * 2 + \u0026#39;px\u0026#39;; this.dom.style.height = this.r * 2 + \u0026#39;px\u0026#39;; this.dom.style.left = this.x - this.r + \u0026#39;px\u0026#39;; this.dom.style.top = this.y - this.r + \u0026#39;px\u0026#39;; this.dom.style.backgroundColor = this.color; // ä¸Šæ ‘ document.body.appendChild(this.dom); }; // æ›´æ–° Ball.prototype.update = function () { // ä½ç½®æ”¹å˜ this.x += this.dX; this.y -= this.dY; // åŠå¾„æ”¹å˜ this.r += 0.2; // é€æ˜åº¦æ”¹å˜ this.opacity -= 0.01; this.dom.style.width = this.r * 2 + \u0026#39;px\u0026#39;; this.dom.style.height = this.r * 2 + \u0026#39;px\u0026#39;; this.dom.style.left = this.x - this.r + \u0026#39;px\u0026#39;; this.dom.style.top = this.y - this.r + \u0026#39;px\u0026#39;; this.dom.style.opacity = this.opacity; // å½“é€æ˜åº¦å°äº0çš„æ—¶å€™ï¼Œå°±éœ€è¦ä»æ•°ç»„ä¸­åˆ é™¤è‡ªå·±ï¼ŒDOMå…ƒç´ ä¹Ÿè¦åˆ æ‰è‡ªå·± if (this.opacity \u0026lt; 0) { // ä»æ•°ç»„ä¸­åˆ é™¤è‡ªå·± for (var i = 0; i \u0026lt; ballArr.length; i++) { if (ballArr[i] === this) { ballArr.splice(i, 1); } } // è¿˜è¦åˆ é™¤è‡ªå·±çš„dom document.body.removeChild(this.dom); } }; // æŠŠæ‰€æœ‰çš„å°çƒå®ä¾‹éƒ½æ”¾åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ var ballArr = []; // åˆå§‹é¢œè‰²æ•°ç»„ var colorArr = [\u0026#39;#66CCCC\u0026#39;, \u0026#39;#CCFF66\u0026#39;, \u0026#39;#FF99CC\u0026#39;, \u0026#39;#FF6666\u0026#39;, \u0026#39;#CC3399\u0026#39;, \u0026#39;#FF6600\u0026#39;]; // å®šæ—¶å™¨ï¼Œè´Ÿè´£æ›´æ–°æ‰€æœ‰çš„å°çƒå®ä¾‹ setInterval(function () { // éå†æ•°ç»„ï¼Œè°ƒç”¨è°ƒç”¨çš„updateæ–¹æ³• for (var i = 0; i \u0026lt; ballArr.length; i++) { ballArr[i].update(); } }, 20); // é¼ æ ‡æŒ‡é’ˆçš„ç›‘å¬ document.onmousemove = function (e) { // å¾—åˆ°é¼ æ ‡æŒ‡é’ˆçš„ä½ç½® var x = e.clientX; var y = e.clientY; new Ball(x, y); }; \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; å€’è®¡æ—¶ \u0026lt;h1\u0026gt;2022é«˜è€ƒå€’è®¡æ—¶\u0026lt;/h1\u0026gt; \u0026lt;h2 id=\u0026#34;info\u0026#34;\u0026gt;\u0026lt;/h2\u0026gt; \u0026lt;script\u0026gt; const info = document.getElementById(\u0026#39;info\u0026#39;); // target dateï¼Œ5è¡¨ç¤ºå…­æœˆ const targetDate = new Date(2022, 5, 7); // å®šæ—¶å™¨ const refreshTime = () =\u0026gt; { // æŠŠdiffæ¢ç®—ä¸ºå¤©ã€å°æ—¶ã€åˆ†é’Ÿã€ç§’ // è¿”å›ç²¾ç¡®åˆ°ç§’çš„æ¯«ç§’å€¼ let date = (targetDate - new Date()); const millSecondsPerDay = 1000 * 60 * 60 * 24; console.log(date) info.innerText = `è¿˜æœ‰${parseInt(date / millSecondsPerDay)}å¤©` + `${parseInt(date % millSecondsPerDay / (1000 * 60 * 60))}å°æ—¶` + `${parseInt((date % (1000 * 60 * 60) / (1000 * 60)))}åˆ†é’Ÿ` + `${parseInt(date % (1000 * 60 * 60) % (1000 * 60) / 1000)}ç§’`; } setInterval(refreshTime, 1000); refreshTime(); \u0026lt;/script\u0026gt; å‡½æ•° å‡½æ•°å°±æ˜¯ è¯­å¥çš„å°è£… ï¼Œå¯ä»¥è®©è¿™äº›ä»£ç æ–¹ä¾¿åœ°è¢«å¤ç”¨ã€‚å‡½æ•°å…·æœ‰ â€œä¸€æ¬¡å®šä¹‰ï¼Œå¤šæ¬¡è°ƒç”¨â€ çš„ä¼˜ç‚¹ã€‚\nä½¿ç”¨å‡½æ•°ï¼Œå¯ä»¥ç®€åŒ–ä»£ç ï¼Œè®©ä»£ç æ›´å…·æœ‰å¯è¯»æ€§ã€‚\nç®—æ³• $y=f(x),f:X\\to Y$\nIn mathematics and computer science, an algorithm is a finite sequence of well-defined instructions, typically used to solve a class of specific problems or to perform a computation.\nè¾“å…¥ è¾“å‡º æœ‰ç©·æ€§ ç¡®å®šæ€§ å¯è¡Œæ€§ ä¼ å‚ å‚æ•°æ˜¯å‡½æ•°å†…çš„ä¸€äº›å¾…å®šå€¼ï¼Œåœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œå¿…é¡»ä¼ å…¥è¿™äº›å‚æ•°çš„å…·ä½“å€¼ã€‚\nå‡½æ•°çš„å‚æ•°å¯å¤šå¯å°‘ï¼Œå‡½æ•°å¯ä»¥æ²¡æœ‰å‚æ•°ï¼Œä¹Ÿå¯ä»¥æœ‰å¤šä¸ªå‚æ•°ï¼Œå¤šä¸ªå‚æ•°ä¹‹é—´éœ€è¦ç”¨é€—å·éš”å¼€ã€‚è‹¥å½¢å‚çš„æ•°ç›®å¤§äºä¼ å…¥å®å‚çš„æ•°ç›®ï¼Œå¤šä½™çš„å†…å®¹å°†ä¼šè¢« undefined å¡«å……ã€‚\nundefined å’Œæ•°å­—è¿›è¡Œè¿ç®—çš„ç»“æœéƒ½æ˜¯ NaN ã€‚typeof NaN = 'number'\n// å½¢å‚ function add(a, b) { let sum = a + b; console.log(\u0026#39;a + b = \u0026#39; + sum); } // å®å‚ add(3, 5); :memo: Note å½¢å¼å‚æ•° å’Œ å®é™…å‚æ•° æ˜¯å½¼æ­¤ç‹¬ç«‹çš„ï¼Œé™¤äº†ä¼ é€’å€¼ä¹‹å¤–ï¼Œäº’ä¸å¹²æ‰°ã€‚ä¼ å…¥æ•°ç»„çš„æ—¶å€™ç›¸å½“äº C/C++ ä¼ å…¥çš„æŒ‡é’ˆï¼Œå‡½æ•°å†…å¯ä»¥ç›´æ¥ä¿®æ”¹æ•°ç»„å†…å®¹ã€‚\nArguments åœ¨ ES5 ä¸­ï¼Œç”¨ apply() æ–¹æ³•å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å°†ä¸€ä¸ªæ•°ç»„ä¼ é€’ç»™å‡½æ•°ã€‚å½“ä¼ å…¥å‡½æ•°çš„æ•°ç»„é•¿åº¦ä¸ç¡®å®šçš„æ—¶å€™ï¼Œä½¿ç”¨ arguments ã€‚\nå‡½æ•°å†… arguments è¡¨ç¤ºå®ƒæ¥æ”¶åˆ°çš„å®å‚åˆ—è¡¨ï¼Œå®ƒæ˜¯ä¸€ä¸ª ç±»æ•°ç»„å¯¹è±¡ ã€‚\n:link: Href [ES6](06 EcmaScript.md/#rest-es6) ä¸­ï¼Œ arguments å¯è¢« rest parameters æ‰€æ›¿ä»£\n:memo: Note ç±»æ•°ç»„å¯¹è±¡ï¼šæ‰€æœ‰å±æ€§å‡ä¸ºä» 0 å¼€å§‹çš„è‡ªç„¶æ•°åºåˆ—ï¼Œå¹¶ä¸”æœ‰ length å±æ€§ï¼Œå’Œæ•°ç»„ç±»ä¼¼å¯ä»¥ç”¨æ–¹æ‹¬å·ä¹¦å†™ä¸‹æ ‡è®¿é—®å¯¹è±¡çš„æŸä¸ªå±æ€§å€¼ï¼Œä½†æ˜¯ä¸èƒ½è°ƒç”¨ æ•°ç»„çš„æ–¹æ³•ã€‚\nfunction fun() { console.log(arguments);\t// [11 22 33 44] console.log(arguments[0]);\t// 11 console.log(arguments[1]);\t// 22 console.log(arguments[9]);\t// undefined } fun(11, 22, 33, 44); :bookmark_tabs: Example JS æœ¬èº«æ²¡æœ‰å‡½æ•°çš„é‡è½½ï¼Œä½†æ˜¯å¯ä»¥å€ŸåŠ© arguments æ¨¡æ‹Ÿã€‚ä»¥ä¸‹ä¾‹å­æ˜¯ä¸€ä¸ªå…¸å‹çš„ å‡½æ•°é‡è½½ ï¼Œå‚æ•°ä¸ªæ•°ä¸åŒå½¢æˆ é‡è½½ã€‚\n:warning: Caution Lorem ipsum dolor sit amet.\nfunction fun() { if (arguments.length === 0) { console.log(0); } else if (arguments.length === 1) { console.log(1); } else { console.log(2); } } fun(); // 0 fun(1); // 1 fun(1, 2); // 2 Parameters The rest parameter syntax allows a function to accept an indefinite number of arguments as an array, providing a way to represent variadic functions in JavaScript.\nparameter çš„æ“ä½œç¬¦ä¸º ... ï¼Œåè¾¹ä¸å†è·Ÿå‚æ•°ã€‚\n// Syntax function f(a, b, ...theArgs) { // theArgs: [restParameters] } :warning: Caution parameter ä¸èƒ½å’Œ arguments ä¸€èµ·ä½¿ç”¨ï¼Œä¼šæŠ¥é”™ã€‚\n:memo: Note arguments å’Œ å‰©ä½™å‚æ•° çš„åŒºåˆ«ï¼š\narguments æ˜¯ä¸€ä¸ª ä¼ªæ•°ç»„Array-like å‰©ä½™å‚æ•° æ˜¯ä¸€ä¸ª çœŸæ­£æ•°ç»„Arrayï¼Œå…·æœ‰ Array.prototype ä¸Šçš„æ‰€æœ‰æ–¹æ³• arguments ä¸Šæœ‰ callee å¯¹è±¡ï¼Œcalleeä¸Šæœ‰ caller å¦å¤–ï¼Œåœ¨ä¼ å…¥å‚æ•°æ—¶ï¼Œæ‰©å±•æ“ä½œç¬¦ ... ä¹Ÿå¯ä»¥ç”¨æ¥æ‰©å±•æ•°ç»„ [] ä¸ºå‚æ•°åˆ—è¡¨ï¼Œå’Œå…¶å®ƒå‚æ•°æ··åˆä½¿ç”¨ï¼š\nfunction fun() { for(const i in arguments){ console.log(arguments[i]); } } function foo(...rest){ console.log(rest); } const params = [10, 15]; fun(5, ...params, 20, ...[25]);// 5 10 15 20 25 foo(5, ...params, 20, ...[25]);// [5, 10, 15, 20, 25] åˆ†ç±» æ™®é€šå‡½æ•° JS ä¸æ”¯æŒ å‡½æ•°é‡è½½ï¼š\nå®šä¹‰ç›¸åŒå‡½æ•°åã€ä¸åŒå‚æ•°çš„å‡½æ•°ï¼Œåé¢çš„å‡½æ•°ä¼š è¦†ç›– å‰é¢çš„å‡½æ•°ã€‚è°ƒç”¨æ—¶ï¼Œåªä¼šè°ƒç”¨åé¢çš„å‡½æ•°ã€‚\né»˜è®¤è¿”å› undefined\nfunction fun() { // Statements... } functionï¼šè¡¨ç¤ºå®šä¹‰å‡½æ•° funï¼šå‡½æ•°åï¼ˆå¿…é¡»ç¬¦åˆ JS æ ‡è¯†ç¬¦å‘½åè§„åˆ™ï¼‰ ()ï¼šåœ†æ‹¬å·ä¸­æ˜¯å½¢å‚åˆ—è¡¨ï¼Œå³ä½¿æ²¡æœ‰å½¢å‚ï¼Œä¹Ÿå¿…é¡»ä¹¦å†™åœ†æ‹¬å· {}ï¼šèŠ±æ‹¬å·å†…ä¸ºå‡½æ•°è¯­å¥å— åŒ¿åå‡½æ•° å˜é‡ å¯ä»¥æŠŠå‡½æ•°èµ‹å€¼ç»™å˜é‡ã€äº‹ä»¶\nvar foo = function bar() { // Statements; } function(){}ï¼šåŒ¿åå‡½æ•° ()ï¼šåœ†æ‹¬å·ä¸­æ˜¯å½¢å‚åˆ—è¡¨ï¼Œå³ä½¿æ²¡æœ‰å½¢å‚ï¼Œä¹Ÿå¿…é¡»ä¹¦å†™åœ†æ‹¬å· {}ï¼šèŠ±æ‹¬å·å†…ä¸ºå‡½æ•°è¯­å¥å— funï¼šå‡½æ•°å˜é‡ :memo: Note åˆ†å·çš„ä½¿ç”¨ï¼š\nfunction fun() { // å‡½æ•°è¯­å¥å— } // æœ«å°¾ä¸éœ€è¦åŠ  ; var fun = function() { // å‡½æ•°è¯­å¥å— };\t// æœ«å°¾æœ€å¥½åŠ ä¸Š ; ç®­å¤´å‡½æ•° ES6 æ ‡å‡†æ–°å¢äº†ä¸€ç§æ–°çš„å‡½æ•°ï¼šArrow Functionï¼ˆç®­å¤´å‡½æ•°ï¼‰ã€‚ç®­å¤´å‡½æ•°ç›¸å½“äºåŒ¿åå‡½æ•°ï¼Œå¹¶ä¸”ç®€åŒ–äº†å‡½æ•°å®šä¹‰ ã€‚\nWarning:\nArrow functions don\u0026rsquo;t have their own bindings to this or super, and should not be used as methods. Arrow functions aren\u0026rsquo;t suitable for call, apply and bind methods, which generally rely on establishing a scope. //ä¸€ä¸ªå‚æ•°ï¼Œå¯ç®€åŒ–æ‹¬å·\u0026amp;è¡¨è¾¾å¼ x =\u0026gt; x * x; _ =\u0026gt; 42; // ä¸¤ä¸ªå‚æ•°: (x, y) =\u0026gt; x * x + y * y; // æ— å‚æ•°: () =\u0026gt; 3.14; // å¯å˜å‚æ•°: (x, y, ...rest) =\u0026gt; { var i, sum = x + y; for (i=0; i\u0026lt;rest.length; i++) { sum += rest[i]; } return sum; } åŒ…å«å¤šæ¡è¯­å¥æ—¶ä¸èƒ½çœç•¥ { ... } å’Œreturn :memo: Note When (and why) you should use ES6 arrow functions:\n// ES5 function timesTwo(params) { return params * 2} timesTwo(4); // 8 // ES6 var timesTwo = params =\u0026gt; params * 2 timesTwo(4); // 8 One thing you will quickly notice is the variety of syntaxes available in arrow functions.\nVarations No parameters If there are no parameters, you can place an empty parentheses before =\u0026gt;.\n() =\u0026gt; 42 In fact, you donâ€™t even need the parentheses! â˜†\n_ =\u0026gt; 42 Single parameter With these functions, parentheses are optional:\nx =\u0026gt; 42 || (x) =\u0026gt; 42 Multiple parameters Parentheses are required for these functions:\n(x, y) =\u0026gt; 42 Statements (as opposed to expressions) â˜† In its most basic form, a function expression produces a value, while a function statement performs an action.\nWith the arrow function, it is important to remember that statements need to have curly braces. Once the curly braces are present, you always need to write return as well.\nHere is an example of the arrow function used with an if statement:\nvar feedTheCat = (cat) =\u0026gt; { if (cat === \u0026#39;hungry\u0026#39;) { return \u0026#39;Feed the cat\u0026#39;; } else { return \u0026#39;Do not feed the cat\u0026#39;; } } Block body If your function is in a block, you must also use the explicit return statement:\nvar addValues = (x, y) =\u0026gt; { return x + y } Object literals â˜† If you are returning an object literal, it needs to be wrapped in parentheses. This forces the interpreter to evaluate what is inside the parentheses, and the object literal is returned.\nx =\u0026gt;({ y: x }) Anonymous It is important to note that arrow functions are anonymous, which means that they are not named.\nThis anonymity creates some issues:\nHarder to debug When you get an error, you will not be able to trace the name of the function or the exact line number where it occurred.\nNo self-referencing If your function needs to have a self-reference at any point (e.g. recursion, event handler that needs to unbind), it will not work.\nN: new æ„é€ å‡½æ•°æœ€å¤–å±‚ä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œä½†å†…éƒ¨æˆå‘˜å‡½æ•°å®æµ‹æ— å½±å“ã€‚\nMain benefit: No binding of this In classic function expressions, the this keyword is bound to different values based on the context in which it is called.\nWith arrow functions however, this is lexically bound(è¯æ±‡ç»‘å®š). It means that it usesthis from the code that contains the arrow function.\nFor example, look at the setTimeout function below:\n// ES5 var obj = { id: 42, counter: function counter() { setTimeout(function() { console.log(this.id); }.bind(this), 1000); } }; In the ES5 example, .bind(this) is required to help pass the this context into the function. Otherwise, by default this would be undefined.\n// ES6 var obj = { id: 42, counter: function counter() { setTimeout(() =\u0026gt; { console.log(this.id); }, 1000); } }; ES6 arrow functions canâ€™t be bound to a this keyword, so it will lexically go up a scope, and use the value of this in the scope in which it was defined.\n:memo: Note ä»ç„¶å’Œåˆ›å»ºå®ƒçš„è¯­å¥ç»‘å®šã€‚\nä¸é€‚ç”¨åœºæ™¯ ä½œä¸ºæ„é€ å‡½æ•° å› ä¸ºç®­å¤´å‡½æ•°æ²¡æœ‰ thisï¼Œè€Œæ„é€ å‡½æ•°çš„æ ¸å¿ƒå°±æ˜¯ thisã€‚\nå¯¹è±¡æ–¹æ³• When you call cat.jumps, the number of lives does not decrease. It is because this is not bound to anything, and will inherit the value of this from its parent scope.\nvar cat = { lives: 9, jumps: () =\u0026gt; { this.lives--; } } éœ€è¦ä½¿ç”¨ arguments çš„æ—¶å€™ ç®­å¤´å‡½æ•°æ²¡æœ‰ arguments ï¼Œä½†å¯ä»¥ä½¿ç”¨ ES6 çš„ å‰©ä½™å‚æ•°...theArgs ä»£æ›¿ã€‚\n:memo: Note å‰©ä½™å‚æ•°...theArgs å’Œ arguments ä¸€èµ·ä½¿ç”¨åŒæ ·ä¼šæŠ¥é”™ã€‚\nç»‘å®š DOM ç±»ä¼¼\nUsable Arrow functions shine best with anything that requires this to be bound to the context, and not the function itself.\nDespite the fact that they are anonymous, I also like using them with methods such as map and reduce, because I think it makes my code more readable. To me, the pros outweigh the cons.\né—­åŒ…å‡½æ•° é—­åŒ…æ˜¯ å‡½æ•°æœ¬èº« å’Œè¯¥å‡½æ•°å£°æ˜æ—¶æ‰€å¤„çš„ ç¯å¢ƒçŠ¶æ€ çš„ç»„åˆã€‚\nå‡½æ•°èƒ½å¤Ÿ ä¿å­˜ å…¶å®šä¹‰æ—¶æ‰€å¤„çš„ç¯å¢ƒï¼Œå³ä½¿å‡½æ•°ä¸åœ¨å…¶å®šä¹‰çš„ç¯å¢ƒä¸­è¢« è°ƒç”¨ ï¼Œä¹Ÿèƒ½è®¿é—®å®šä¹‰æ—¶æ‰€å¤„ç¯å¢ƒçš„å˜é‡ã€‚\n:memo: Note\nå‡½æ•° A å†…éƒ¨å£°æ˜äº†å‡½æ•° B\nå‡½æ•° B å¼•ç”¨äº†å‡½æ•° B ä¹‹å¤–çš„å˜é‡\nå‡½æ•° A çš„è¿”å›å€¼ä¸ºå‡½æ•° B çš„ å¼•ç”¨\nâ†’ å‡½æ•° B å°±æ˜¯ é—­åŒ…å‡½æ•° ã€‚\nåœ¨ JS ä¸­ï¼Œ æ¯æ¬¡ åˆ›å»ºå‡½æ•°æ—¶éƒ½ä¼šåˆ›å»ºé—­åŒ…ã€‚\nä½†æ˜¯ï¼Œé—­åŒ…ç‰¹æ€§å¾€å¾€éœ€è¦å°†å‡½æ•° æ¢ä¸€ä¸ªåœ°æ–¹ æ‰§è¡Œï¼Œæ‰èƒ½è¢«ç›´è§‚çš„ä½“ç°å‡ºæ¥ã€‚\nlet funA = function (name) { // The outer function defines a variable called \u0026#34;name\u0026#34; let funB = function () { return name; // The inner function has access to the \u0026#34;name\u0026#34; variable of the outer function } return funB; // Return the inner function, thereby exposing it to outer scopes } myPet = funA(\u0026#39;Vivie\u0026#39;); myPet(); // Returns \u0026#34;Vivie\u0026#34; myPet = funA(\u0026#39;Vivie\u0026#39;)(); console.log(myPet); // Returns \u0026#34;Vivie\u0026#34; ä¿è¯å‡½æ•° funA å†…é‡Œçš„å˜é‡å®‰å…¨ï¼Œå› ä¸ºå¤–éƒ¨ä¸èƒ½ç›´æ¥è®¿é—® funB çš„å˜é‡ã€‚\né—­åŒ…çš„åŠŸèƒ½ï¼šè®°å¿†æ€§ã€æ¨¡æ‹Ÿç§æœ‰å˜é‡ ã€‚\nè®°å¿†æ€§ å½“é—­åŒ…äº§ç”Ÿæ—¶ï¼Œå‡½æ•°æ‰€å¤„ç¯å¢ƒçš„çŠ¶æ€ä¼š å§‹ç»ˆä¿æŒ åœ¨å†…å­˜ä¸­ï¼Œ ä¸ä¼š åœ¨å¤–å±‚å‡½æ•°è°ƒç”¨å è‡ªåŠ¨æ¸…é™¤ ã€‚è¿™å°±æ˜¯é—­åŒ…çš„è®°å¿†æ€§ã€‚\n:page_with_curl: Example åˆ›å»ºä½“æ¸©æ£€æµ‹å‡½æ•° checkTemp(n)ï¼Œå¯ä»¥æ£€æŸ¥ä½“æ¸© n æ˜¯å¦æ­£å¸¸ï¼Œå‡½æ•°ä¼šè¿”å›å¸ƒå°”å€¼ã€‚\nä½†æ˜¯ï¼Œä¸åŒçš„å°åŒºæœ‰ä¸åŒçš„ä½“æ¸©æ£€æµ‹æ ‡å‡†ï¼Œæ¯”å¦‚ A å°åŒºä½“æ¸©åˆæ ¼çº¿æ˜¯ 37.1â„ƒï¼Œè€Œ B å°åŒºä½“æ¸©åˆæ ¼çº¿æ˜¯ 37.3â„ƒï¼Œåº”è¯¥æ€ä¹ˆç¼–ç¨‹å‘¢ï¼Ÿ\nfunction createCheckTemp(standardTemp) { // standardTempä½œä¸ºé—­åŒ…ç§æœ‰å˜é‡ // ä¸ä¼šåœ¨å‡½æ•°è°ƒç”¨åè‡ªåŠ¨æ¸…é™¤ // å†…å±‚å‡½æ•°ç”¨äºæ“ä½œç§æœ‰å˜é‡ // è™½ç„¶ç§æœ‰å˜é‡é€šå¸¸é€šè¿‡IIFEä¼ å…¥ // ä½†å¤–å±‚IIFE(()=\u0026gt;{})()å¹¶ä¸æ˜¯å”¯ä¸€çš„å½¢å¼ function checkTemp(n) { if (n \u0026lt;= standardTemp) { alert(\u0026#39;ä½ çš„ä½“æ¸©æ­£å¸¸\u0026#39;); } else { alert(\u0026#39;ä½ çš„ä½“æ¸©åé«˜\u0026#39;); } } return checkTemp; } // åˆ›å»ºä¸€ä¸ª checkTemp å‡½æ•°ï¼Œå®ƒä»¥ 37.1 åº¦ä¸ºæ ‡å‡†çº¿ const checkTemp_A = createCheckTemp(37.1); // å†åˆ›å»ºä¸€ä¸ª checkTemp å‡½æ•°ï¼Œ å®ƒä»¥ 37.3 åº¦ä¸ºæ ‡å‡†çº¿ const checkTemp_B = createCheckTemp(37.3); checkTemp_A(37.2);\t// \u0026#34;ä½ çš„ä½“æ¸©åé«˜\u0026#34; checkTemp_A(37.0);\t// \u0026#34;ä½ çš„ä½“æ¸©æ­£å¸¸\u0026#34; checkTemp_B(37.2);\t// \u0026#34;ä½ çš„ä½“æ¸©æ­£å¸¸\u0026#34; checkTemp_B(37.6);\t// \u0026#34;ä½ çš„ä½“æ¸©åé«˜\u0026#34; å°è£… å³ï¼šè®©å˜é‡å˜å¾—å®‰å…¨ï¼Œä»å¤–éƒ¨åªèƒ½è®¿é—®æŒ‡å®šçš„å±æ€§ã€‚\nåœ¨ Javaã€C++ ç­‰è¯­è¨€ä¸­ï¼Œæœ‰ç§æœ‰å±æ€§çš„æ¦‚å¿µï¼Œä½†æ˜¯ JS ä¸­åªèƒ½ç”¨é—­åŒ…æ¥æ¨¡æ‹Ÿã€‚\n:page_with_curl: Example é¢˜ç›®ï¼šè¯·å®šä¹‰ä¸€ä¸ªå˜é‡ aï¼Œè¦æ±‚æ˜¯èƒ½ä¿è¯è¿™ä¸ª a åªèƒ½è¢«è¿›è¡ŒæŒ‡å®šæ“ä½œï¼ˆå¦‚ï¼šåŠ 1ã€ä¹˜2ï¼‰ï¼Œè€Œä¸èƒ½è¿›è¡Œå…¶ä»–æ“ä½œï¼Œåº”è¯¥æ€ä¹ˆç¼–ç¨‹å‘¢ï¼Ÿ\n// å°è£…ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½å°±æ˜¯ç§æœ‰åŒ–å˜é‡ function fun() { var i = 0; // å®šä¹‰ä¸€ä¸ªå†…éƒ¨æˆå‘˜å˜é‡i // ç±»ä¼¼C++/Javaé‡Œçš„ç§æœ‰ private æˆå‘˜ return { // è¿”å›ä¸€ä¸ªå¯¹è±¡ -\u0026gt; C++/Java public æ“ä½œå‡½æ•° getA: function () { return i; }, add: function () { i++; }, pow: function () { i *= 2; } }; } const obj = fun(); // è¿”å›çš„æ˜¯å°è£…åå‡½æ•°åˆ—è¡¨ // å¦‚æœæƒ³åœ¨ fun å‡½æ•°å¤–é¢ä½¿ç”¨å˜é‡ aï¼Œå”¯ä¸€çš„æ–¹æ³•å°±æ˜¯è°ƒç”¨ getA() æ–¹æ³• console.log(obj.getA()); // 0 // æƒ³è®©å˜é‡ a è¿›è¡ŒåŠ  1 æ“ä½œ obj.add(); console.log(obj.getA()); // 1 obj.pow(); console.log(obj.getA()); // 2 :warning: Caution ä¸èƒ½æ»¥ç”¨é—­åŒ…ï¼å¦åˆ™ä¼šé€ æˆç½‘é¡µçš„æ€§èƒ½é—®é¢˜ï¼Œä¸¥é‡æ—¶å¯èƒ½å¯¼è‡´ å†…å­˜æ³„æ¼ ã€‚\næ‰€è°“ å†…å­˜æ³„æ¼ å°±æ˜¯æŒ‡ç¨‹åºä¸­å·²ç»åŠ¨æ€åˆ†é…çš„å†…å­˜ç”±äºæŸç§åŸå› æœªé‡Šæ”¾æˆ–æ— æ³•é‡Šæ”¾ã€‚\nç›®å‰ï¼ŒChrome ç­‰æ¯”è¾ƒå…ˆè¿›çš„æµè§ˆå™¨å¾ˆå°‘å‘ç”Ÿå†…å­˜æ³„æ¼ã€‚\n:memo: Note é—­åŒ…çš„ä¸€é“é¢è¯•é¢˜\nfunction addCount() { var count = 0; return function() { count = count + 1; console.log(count); }; } var fun1 = addCount(); var fun2 = addCount(); fun1();\t// 1 fun2();\t// 1 fun2();\t// 2 fun1();\t// 2 // å³ï¼šä¼šäº§ç”Ÿå„è‡ªçš„ç‹¬ç«‹é—­åŒ… // å‚è€ƒå‰é¢çš„ä½“æ¸©è®¡ IIFE IIFE (ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼) - Immediately Invoked Function Expression\nå³åœ¨å‡½æ•°å£°æ˜æ—¶ï¼Œåœ¨åé¢ç´§è·Ÿå‚æ•°ï¼›è§£ææ­¤å‡½æ•°æ—¶ï¼Œé‡Œé¢ä»£ç ç«‹å³æ‰§è¡Œã€‚\nthis æŒ‡å‘ window å¯¹è±¡ / undefined[ä¸¥æ ¼æ¨¡å¼]\nIIFE (function () { /* ... */ })(); // 1. å‰é¢æ‹¬å·ä½œç”¨ï¼šå°†å‡½æ•°å˜ä¸ºè¡¨è¾¾å¼ï¼Œ+-!~ç­‰è¿ç®—ç¬¦ä¹Ÿèƒ½åšåˆ° // 2. åé¢æ‹¬å·ä½œç”¨ï¼šè¿è¡Œå‡½æ•°ï¼Œå¹¶ä¼ å…¥å‚æ•° Arrow function IIFE (() =\u0026gt; { /* ... */ })(); Async IIFE (async () =\u0026gt; { /* ... */ })(); å‡½æ•°ä¸èƒ½ç›´æ¥åŠ ä¸Šåœ†æ‹¬å·è¢«è°ƒç”¨ () =\u0026gt; {}() // Error! :memo: Note ç«‹å³æ‰§è¡Œå‡½æ•°å’Œé—­åŒ…\nä½¿ç”¨å…¨å±€å˜é‡å¯èƒ½ä¼šé€ æˆä¸€äº›ä¸å¿…è¦çš„éº»çƒ¦ï¼Œå› æ­¤æˆ‘ä»¬è¦ä½¿ç”¨å±€éƒ¨å˜é‡ã€‚\nåœ¨ Java è¯­è¨€ä¸­æˆ‘ä»¬å¯ä»¥ç”¨ {} å°†ä»£ç åŒ…è£¹èµ·æ¥ï¼Œä½¿å®ƒä»¬æˆä¸ºå±€éƒ¨å˜é‡ï¼Œä½†æ˜¯è¿™åœ¨ ES5 ä¸­ä¸è¡Œï¼Œå› ä¸º var æœ‰å˜é‡æå‡ã€‚\n{ var a = 1; } // ä¸Šé¢ä»£ç ç­‰åŒäº var a { a = 1; } ES6 é‡Œé¢å¼•å…¥äº† let çš„æ¦‚å¿µï¼Œäºæ˜¯æœ‰äº† å—çº§ä½œç”¨åŸŸ è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼ŒIIFE ä¼¼ä¹å°±å˜å¾—ä¸é‚£ä¹ˆå¿…è¦äº†ã€‚\n{ let a = 1; } a // Uncaught ReferenceError: a is not defined ä½†æ˜¯äº†è§£ IIFE å¯ä»¥è®©æˆ‘ä»¬åˆå­¦è€…æ›´å¥½å¾—ç†è§£å‡½æ•°è¡¨è¾¾å¼ã€å˜é‡æå‡ç­‰çš„æ¦‚å¿µï¼Œä»¥åŠäº†è§£å‰ç«¯è¯­è¨€çš„å‘å±•è¿›ç¨‹ï¼ŒçŸ¥é“å‰äººä¸€æ­¥æ­¥å°†åŸæœ¬ä¸é‚£ä¹ˆç¾å¥½çš„ JavaScript å˜å¾—è§„èŒƒåŒ–çš„è¿‡ç¨‹ï¼Œå­¦ä¹ ä»–ä»¬çš„æ™ºæ…§ã€‚\nES5 é‡Œé¢ï¼Œæ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼Œåªæœ‰ å‡½æ•°â†“å‡½æ•°ä½œç”¨åŸŸ å¯æä¾›å±€éƒ¨å˜é‡ç¯å¢ƒã€‚\näºæ˜¯æˆ‘ä»¬å£°æ˜ä¸€ä¸ª function funï¼Œç„¶åæ‰§è¡Œ fun.call() ä¼ å‚ã€‚\nfunction fun(){ var a = 1; }.call(); // SyntaxError: Unexpected token \u0026#39;.\u0026#39; ä½†æ˜¯è¿™ä¸ªæ—¶å€™ fun() ä¹Ÿæ˜¯ å…¨å±€å‡½æ•° æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç»™è¿™ä¸ªå‡½æ•°åå­—ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ åŒ¿åå‡½æ•° ã€‚\nfunction(){ var a = 1; }.call(); // SyntaxError: Function statements require a function name è¿™æ˜¯ç”±äºè§£æå™¨è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ª å‡½æ•°å£°æ˜ ã€‚\nè§£å†³æ–¹æ³•ï¼šè®© å‡½æ•°å£°æ˜ å˜ä¸º å‡½æ•°è¡¨è¾¾å¼ å¦‚ç»™å‡½æ•°å–åï¼Œåˆ™è§£æå™¨ä¼šè‡ªåŠ¨è¿ç®—æ‹¬å·ä¸­çš„å†…å®¹ã€‚\n!function () { var a = 1; }.call(); // æˆ‘ä»¬ä¸åœ¨ä¹è¿™ä¸ªåŒ¿åå‡½æ•°çš„è¿”å›å€¼ /* ç­‰åŒäº */ // !å•ç›®è¿ç®—ç¬¦ä¼˜å…ˆçº§ä»…æ¬¡äº() !(function () { var a = 1; }.call()); ç±»ä¼¼çš„è¿˜æœ‰ï¼š\n+function(){}.call(); -function(){}.call(); ~function(){}.call(); void function(){}() new function(){}() // function(){}() === function(){}.call() //ç”¨ .call() æ›´æ¸…æ¥šï¼Œå³()å†…ä¸ºç»™å‰é¢å‡½æ•°æä¾›çš„å‚æ•° +function(){}.call(); +function(){}(); function(){}(); // SyntaxError: Function statements require a function name å¦‚æœä¸æƒ³æ”¹å˜å‡½æ•°è¿”å›å€¼ï¼Œä¹Ÿå¯ä»¥ç”¨åœ†æ‹¬å·åŒ…è£¹ã€‚\n(function(){}).call(); (function(){}.call()); ä½†æ˜¯å¦‚æœæ‹¬å·å‰ä¸€è¡Œæœ‰è¯­å¥ï¼Œè€Œè¯­å¥æœ«å°¾åˆæ²¡æœ‰åŠ ä¸Šåˆ†å· ; æ—¶ï¼Œå°±ä¼šè§£æé”™è¯¯ã€‚\na (function () { }).call() // ç­‰ä»·äº a(/*...*/).call() // è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ // åŒç† a (function () { }.call()) // ç­‰ä»·äº a(/*...*/) // ReferenceError: a is not defined æ‰€ä»¥ä¸æ¨èã€‚\nå½“ç„¶æœ€æ¨èçš„è¿˜æ˜¯åœ¨å‡½æ•°å‰ä½¿ç”¨å–å ! ï¼Œè¿™å°±å¥½åƒæ˜¯ä¸ªè­¦ç¤ºï¼šæˆ‘è¦å¼€å§‹ç”¨ IIFE äº†ã€‚\nIIFE è¾¾åˆ°äº†å±€éƒ¨å˜é‡çš„æ•ˆæœï¼Œå¤–é¢è®¿é—®ä¸åˆ°ç«‹å³æ‰§è¡Œå‡½æ•°é‡Œé¢çš„å˜é‡ï¼ˆé¿å…å˜é‡æ±¡æŸ“ï¼‰ã€‚\nä½†æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦è®¿é—® IIFE é‡Œé¢çš„å†…å®¹ï¼Œæ€ä¹ˆåŠï¼Ÿ æœ€ç®€å•çš„æ–¹æ³•æ˜¯ç›´æ¥ç”¨å…¨å±€å˜é‡ window ã€‚\n!function () { var a = window.a = { n: 1 } }.call() // å¦ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°é€šè¿‡ window.a è®¿é—® !function () { var b = window.a console.log(a) }.call() // {n: 1} äºæ˜¯å¼•å…¥äº†é—­åŒ…ï¼Œç”¨äºåœ¨ IIFE éšè— i ã€‚\n!function () { var i = { n: 1 } window.fun = function () { // å£°æ˜ä¸€ä¸ªåŒ¿åå‡½æ•°ä¿å­˜äº window.nAdd1 i.n += 1 // return æ–°çš„ i.n return i.n } }.call(); // åŒ¿åå‡½æ•°å¯ä»¥æ“ä½œå‡½æ•°å¤–é¢çš„å˜é‡ i ï¼Œè¿™å°±æ˜¯é—­åŒ… // å¦ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°é€šè¿‡ window.foo è®¿é—® !function () { var foo = window.fun() console.log(foo) }.call(); // 2 IIFE ä½¿å¾— i æˆä¸º å±€éƒ¨å˜é‡â†“å‡½æ•°çº§å˜é‡ è€Œæ— æ³•è¢«å¤–éƒ¨è®¿é—®\né—­åŒ…\u0026ldquo;å‡½æ•°å†…å‡½æ•°\u0026rdquo; ä½¿å¾—åŒ¿åå‡½æ•°å¯ä»¥æ“ä½œ i ï¼Œè€Œ window.fun ä¿å­˜äº†åŒ¿åå‡½æ•°çš„åœ°å€ï¼Œä»»ä½•åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨ï¼Œä½†ä¸èƒ½æ“ä½œå†…éƒ¨å˜é‡ï¼Œè¾¾åˆ° å˜é‡éš”ç¦» çš„æ•ˆæœã€‚\nè€Œå¦ä¸€ä¸ª IIFE ä¸­å°† window.fun çš„åœ°å€èµ‹ç»™ var fooã€‚\né—­åŒ… å°†ä¸Šé¢ä»£ç æ•´åˆåœ¨ä¸€èµ·ï¼Œå°±æ˜¯ é—­åŒ… çš„å¸¸è§å½¢å¼ã€‚\nfunction closure() { var i = 1; function fun() { // å‡½æ•°å†…å‡½æ•°ï¼Œç”¨äºæ“ä½œå¹¶éš”ç¦»å¤–å±‚å‡½æ•°å˜é‡ // ä¹Ÿå³ï¼šé—­åŒ… // åœ¨å‡½æ•°ä½œç”¨åŸŸå†…å˜é‡å’Œå¤–å±‚å˜é‡ç›¸äº’éš”ç¦» // ä½¿ç”¨ä¸åŒnamespaceï¼ˆC++æ¦‚å¿µï¼‰ i++; return i; } return fun(); } var foo = closure(); console.log(foo); // 2 // ä¸Šé¢ä»£ç å…¶å®å°±æ˜¯ /* 1. */ console.log( (function () { var i = 1 return function () { i++; return i } }() )() ); // 2 /* 2. */ console.log( (function () { var i = 1; return function () { i++; return i; } }.call()) // IIFE .call() ); // 2 ç°åœ¨æˆ‘ä»¬æ˜ç™½äº†ä¸ºä»€ä¹ˆé—­åŒ…ä¸€èˆ¬åœ¨ IIFE é‡Œå‡ºç°\nIIFE æä¾›å±€éƒ¨å˜é‡çš„ç¯å¢ƒï¼Œæ‰æœ‰é—­åŒ…çš„ç”¨æ­¦ä¹‹åœ° return çš„ä½œç”¨\nä¸Šé¢ä»£ç ä¸­çš„ return å’Œ window çš„ä½œç”¨ä¸€æ ·ï¼Œæ˜¯ä¸ºäº†è®©å¤–éƒ¨èƒ½å¤Ÿè®¿é—® å‡½æ•°ä½œç”¨åŸŸå†…éƒ¨ çš„å‡½æ•°ã€‚\nèµ‹å€¼ :page_with_curl: Example\nvar age = 12; var sex = \u0026#39;ç”·\u0026#39;; var title = (function () { if (age \u0026lt; 18) { return \u0026#39;å°æœ‹å‹\u0026#39;; } else { if (sex == \u0026#39;ç”·\u0026#39;) { return \u0026#39;å…ˆç”Ÿ\u0026#39;; } else { return \u0026#39;å¥³å£«\u0026#39;; } } })(); å±€éƒ¨åŒ– ES5 ä¸æ”¯æŒå—çº§ä½œç”¨åŸŸçš„ä¸€ç§è¯­æ³•ç³–ã€‚\n:memo: Note\nè§£é‡Šï¼šå› ä¸º arr æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ function(){console.log()} è¿™ä¸ªå‡½æ•°ï¼Œç”±äº var i ä¸ºå…¨å±€å˜é‡ï¼Œæ‰€ä»¥æ‰€æœ‰é—­åŒ…å†…å­˜éƒ½åªæœ‰ä¸€ä¸ª i ã€‚ i æœ€ç»ˆå€¼ 5ï¼Œæœªä½¿ç”¨é—­åŒ…æ—¶éƒ½è¾“å‡º 5 ã€‚\nå¦å¤–ï¼Œç›´æ¥ä½¿ç”¨ let å³å¯è§£å†³è¯¥é—®é¢˜ã€‚\nvar arr = []; for (var i = 0; i \u0026lt; 5; i++) { arr.push(function () { // ä½¿ç”¨varæ—¶ï¼Œæ²¡æœ‰ä½œç”¨åŸŸéš”ç¦»ï¼Œæ¯æ¬¡è®¿é—®éƒ½æ˜¯åŒä¸€ä¸ªå˜é‡ // Mutable variable is accessible from closure // foriä¸­å˜é‡æ”¹æˆletå³å¯è§£å†³è¿™ä¸ªé—®é¢˜ console.log(i); }); arr[i](); } // 0 1 2 3 4 for (var j = 0; j \u0026lt; arr.length; j++) { arr[j](); } // 5 5 5 5 5 è‹¥è¦åœ¨ ES5 çš„æ¡†æ¶ä¸‹è§£å†³é—®é¢˜ï¼Œå¯åˆ›å»ºé—­åŒ…ä¿å­˜ä¸Šä¸‹æ–‡ï¼š\nvar arr = []; for (var i = 0; i \u0026lt; 5; i++) { (function ($i) { // ä¼ å…¥é—­åŒ…çš„å®å‚iåœ¨é—­åŒ…å†…å‡½æ•°é‡æ–°ä¿å­˜ä¸ºå½¢å‚$i // é—­åŒ…ä½œç”¨ï¼šä¿å­˜è¿è¡Œæ—¶ä¸Šä¸‹æ–‡ã€éš”ç¦»å˜é‡ arr.push(function () { console.log($i) }); })(i); arr[i](); } // 0 1 2 3 4 for (let i = 0; i \u0026lt; arr.length; i++) { arr[i](); } // 0 1 2 3 4 è¿”å› å‡½æ•°ä½“å†…å¯ä»¥ä½¿ç”¨ return å…³é”®å­—è¡¨ç¤º å‡½æ•°çš„è¿”å›å€¼ã€‚\nfunction fun(a, b) { return a + b; // å‡½æ•°çš„è¿”å›å€¼ } foo = (a, b) =\u0026gt; a + b; // ä½¿ç”¨ES6ç®­å¤´åŒ¿åå‡½æ•° const ret1 = fun(3, 5); // å‡½æ•°çš„è¿”å›å€¼å¯ä»¥è¢«å˜é‡æ¥æ”¶ const ret2 = foo(3, 5); è°ƒç”¨ä¸€ä¸ªæœ‰è¿”å›å€¼çš„å‡½æ•°ï¼Œå¯ä»¥è¢«å½“åšä¸€ä¸ªæ™®é€šå€¼ï¼Œä»è€Œå¯ä»¥å‡ºç°åœ¨ä»»ä½•å¯ä»¥ä¹¦å†™å€¼çš„åœ°æ–¹ã€‚\nfunction sum(a, b) { return a + b; } const result = sum(3, 4) * sum(2, 6); function sum(a, b) { return a + b; } const result = sum(3, sum(4, 5)); // å‡½æ•°åµŒå¥— é‡è§ return å³é€€å‡ºå‡½æ•°ã€‚\nç»“åˆ if è¯­å¥çš„æ—¶å€™ï¼Œå¾€å¾€ä¸éœ€è¦å†™ else åˆ†æ”¯äº†ã€‚\n// åˆ¤æ–­ä¸€ä¸ªæ•°å­—æ˜¯å¦ä¸ºå¶æ•° function checkEven(n) { return n % 2 === 0; } const result = checkEven(6); console.log(result); // true This å‡½æ•°ä¸­å¯ä»¥ä½¿ç”¨ this å…³é”®å­—ï¼Œå®ƒè¡¨ç¤ºå‡½æ•°çš„ä¸Šä¸‹æ–‡ã€‚\n:link: Href [ES6](06 EcmaScript.md/#super-es6) å¯¹ this åˆè¿›è¡Œäº†æ‰©å……\nlet obj = { x: 1, y: 2, fn: function () { console.log(this.x + this.y) } // :memo: NOTE: () =\u0026gt; console.log(this.x + this.y) // ç®­å¤´åŒ¿åå‡½æ•°åœ¨è¿™é‡Œä¼šå¤±æ•ˆ // å› ä¸ºç®­å¤´å‡½æ•°çš„thisè‡ªåŠ¨æŒ‡å‘ä¸Šä¸‹æ–‡ }; obj.fn(); // \u0026gt;\u0026gt; 3 let fn = obj.fn; fn(); // \u0026gt;\u0026gt; NaN (x \u0026amp; y is not defined) let obj2 = {x: 3, y: 4, fn: obj.fn}; obj2.fn(); // \u0026gt;\u0026gt; 7 (x=3 \u0026amp; y=4) console.log(obj2.fn()) // \u0026gt;\u0026gt; Æ’ () { console.log(this.x + this.y)} :memo: Note å‡½æ•°çš„ this æŒ‡é’ˆæŒ‡å‘è°ƒç”¨å®ƒçš„ å¯¹è±¡ ã€‚äº‹ä»¶å¤„ç†å‡½æ•°çš„ä¸Šä¸‹æ–‡æ˜¯ç»‘å®šäº‹ä»¶çš„ DOM å…ƒç´ ã€‚è‹¥å¯¹è±¡ä¸å­˜åœ¨ï¼Œåˆ™è‡ªåŠ¨æŒ‡å‘ windowï¼›ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼ŒæŒ‡å‘ undefined ã€‚\n-\u0026gt; let fun = function (){ console.log(this) }; fun(); \u0026gt;\u0026gt; Window {0: Window, window: Wind... -\u0026gt; \u0026#39;use strict\u0026#39;; let fun = function (){ console.log(this) }; fun(); \u0026gt;\u0026gt; undefined -\u0026gt; let arrFun = [\u0026#39;arr\u0026#39;, function (){ console.log(this) }]; arrFun[1](); \u0026gt;\u0026gt; [\u0026#39;arr\u0026#39;, Æ’] /* 1. IIFE */ -\u0026gt; (function () { console.log(this) })(); \u0026gt;\u0026gt; Window {0: Window, window: Wind... /* 2. IIFE \u0026amp; strict */ -\u0026gt; \u0026#39;use strict\u0026#39;; (function () { console.log(this) })(); \u0026gt;\u0026gt; undefined /* 3. Array */ -\u0026gt; (() =\u0026gt; { console.log(this) })(); \u0026gt;\u0026gt; Window {0: Window, window: Wind... /* 4. Array \u0026amp; strict */ -\u0026gt; \u0026#39;use strict\u0026#39;; (() =\u0026gt; { console.log(this) })(); \u0026gt;\u0026gt; Window {0: Window, window: Wind... e.g.: ç‚¹å‡»å“ªä¸ªç›’å­ï¼Œå“ªä¸ªç›’å­åœ¨ 2000 æ¯«ç§’åå°±å˜çº¢ï¼Œè¦æ±‚ä½¿ç”¨åŒä¸€ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°å®ç°ã€‚\n\u0026lt;style\u0026gt; .container { height: 10vh; width: 50vh; margin: 0 auto; display: flex; justify-content: center; } .box { flex: 1; border: 1px dashed darkslateblue; margin: .5em; transition: all .5s; } \u0026lt;/style\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; \u0026#39;use strict\u0026#39; function setColor() { // å¤‡ä»½å½“å‰è°ƒç”¨å¯¹è±¡\u0026#34;this\u0026#34; // å‘½åä¸ºself/that/_this const self = this; setTimeout(function () { // å®šæ—¶å™¨è°ƒç”¨å¯¹è±¡ä¸ºwindow // ä½¿ç”¨selfæ§åˆ¶åŸç›’å­ console.log(self.clicked) self.clicked = !self.clicked; // JSä¸­ä¼¼ä¹æ²¡æœ‰å–åçš„å•ç›®è¿ç®—ç¬¦ self.style.backgroundImage = self.clicked ? \u0026#34;linear-gradient(37deg, #f78ca0 0%, #f9748f 19%, #fd868c 60%, #fe9a8b 100%)\u0026#34; : null; }, 200); /* //:memo: NOTE: ä½¿ç”¨ç®­å¤´åŒ¿åå‡½æ•°çš„æ—¶å€™ï¼Œç”±äºthisä¸èƒ½åŠ¨æ€ç»‘å®šè€Œæ˜¯è‡ªåŠ¨ç»‘å®šåˆ°è°ƒç”¨è¯­å¥ï¼Œå› æ­¤thiså°†è‡ªåŠ¨æŒ‡å‘windowå¯¹è±¡ setTimeout(() =\u0026gt; { this.clicked = !this.clicked; this.style.backgroundImage = this.clicked ? \u0026#34;linear-gradient(37deg, #f78ca0 0%, #f9748f 19%, #fd868c 60%, #fe9a8b 100%)\u0026#34; : null; }, 200); */ } let boxes = document.getElementsByClassName(\u0026#34;box\u0026#34;); console.log(boxes) for (let i = 0; i \u0026lt; boxes.length; i++) { boxes[i].onclick = setColor; boxes[i].clicked = false; } \u0026lt;/script\u0026gt; é‡ç»‘å®š å¯ä»¥åœ¨ä¸å˜æ›´å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œå°† this ç»‘å®šåˆ°å…¶å®ƒå¯¹è±¡ã€‚\ncall() The call() method calls a function with a given this value and arguments provided individually. apply() The apply() method calls a function with a given this value, and arguments provided as an array (or an array-like object). bind() The bind() method creates a new function that, when called, has its this keyword set to the provided value, with a given sequence of arguments preceding any provided when the new function is called. /* 1. call()æ–¹æ³•*/ function.prototype.call(thisArg, arg1, ..., argN); // è°ƒç”¨å½¢å¼ç­‰åŒäºåŸå‡½æ•°çš„ function(arg1, ..., argN) // thisArgæŒ‡å‘æ–°thisæŒ‡é’ˆ /* 2. apply()æ–¹æ³•*/ function.prototype.apply(thisArg, argsArray); // åŒºåˆ«æ˜¯å‚æ•°åˆ—è¡¨å˜æˆäº†ä¸€ä¸ªæ•°ç»„ /* 3. bind()æ–¹æ³•*/ function.prototype.bind(thisArg, arg1, ..., argN); // å’Œcall()|apply()åŒºåˆ«æ˜¯è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°å‡½æ•° å®ƒä»¬å„è‡ªçš„å®šä¹‰ï¼š\ncall()ï¼šè°ƒç”¨ä¸€ä¸ªå¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨å¦ä¸€ä¸ªå¯¹è±¡æ›¿æ¢å½“å‰å¯¹è±¡ã€‚\ne.g.: B.call(A, args1,args2);å³Aå¯¹è±¡è°ƒç”¨Bå¯¹è±¡çš„æ–¹æ³• apply() ï¼šè°ƒç”¨ä¸€ä¸ªå¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨å¦ä¸€ä¸ªå¯¹è±¡æ›¿æ¢å½“å‰å¯¹è±¡ã€‚\ne.g.: B.apply(A, arguments);å³Aå¯¹è±¡åº”ç”¨Bå¯¹è±¡çš„æ–¹æ³• bind()ï¼šè¿”å›èƒ½è°ƒç”¨ä¸€ä¸ªå¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ã€ç”¨å¦ä¸€ä¸ªå¯¹è±¡æ›¿æ¢å½“å‰å¯¹è±¡çš„å‡½æ•°ã€‚è‹¥ä¼ å…¥çš„å‚æ•°ä¸è¶³ï¼Œå¯åœ¨è°ƒç”¨æ—¶æ·»åŠ ã€‚\ne.g.:\n-\u0026gt; function fun(x, y, z) { return x + y + z; } const foo = fun.bind(fun, 10); // function.prototype.bind() console.log(foo(20, 30)); // ä¸è¶³çš„å‚æ•°ï¼Œå¯åœ¨è¿è¡Œæ—¶ä¼ å…¥ const foo2 = fun.bind(null, 10); //thisArgæ¥å—ç©ºå‚æ•° \u0026gt;\u0026gt; 60 å®ƒä»¬çš„å…±åŒä¹‹å¤„ï¼š\néƒ½â€œå¯ä»¥ç”¨æ¥ä»£æ›¿å¦ä¸€ä¸ªå¯¹è±¡è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ï¼Œå°†ä¸€ä¸ªå‡½æ•°çš„ this æŒ‡é’ˆä»åˆå§‹çš„ä¸Šä¸‹æ–‡æ”¹å˜ä¸ºç”± thisObj æŒ‡å®šçš„æ–°å¯¹è±¡â€ã€‚\nå®ƒä»¬çš„ä¸åŒä¹‹å¤„ï¼š\napply()ï¼šæœ€å¤šåªèƒ½æœ‰ä¸¤ä¸ªå‚æ•°â€”â€”æ–°thiså¯¹è±¡å’Œä¸€ä¸ªæ•°ç»„ argArray ã€‚å¦‚æœç»™è¯¥æ–¹æ³•ä¼ é€’å¤šä¸ªå‚æ•°ï¼Œåˆ™æŠŠå‚æ•°éƒ½å†™è¿›è¿™ä¸ªæ•°ç»„é‡Œé¢ï¼Œå½“ç„¶ï¼Œå³ä½¿åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿè¦å†™è¿›æ•°ç»„é‡Œã€‚å¦‚æœ argArray ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ•°ç»„æˆ– arguments å¯¹è±¡ï¼Œé‚£ä¹ˆå°†å¯¼è‡´ä¸€ä¸ª TypeError ã€‚å¦‚æœæ²¡æœ‰æä¾› argArray å’Œ thisObj ä»»ä½•ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆ Global å¯¹è±¡å°†è¢«ç”¨ä½œ thisObj ï¼Œå¹¶ä¸”æ— æ³•è¢«ä¼ é€’ä»»ä½•å‚æ•°ã€‚\ncall()ï¼šå®ƒå¯ä»¥æ¥å—å¤šä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ apply ä¸€æ ·ï¼Œåé¢åˆ™æ˜¯ä¸€ä¸²å‚æ•°åˆ—è¡¨ã€‚è¿™ä¸ªæ–¹æ³•ä¸»è¦ç”¨åœ¨ js å¯¹è±¡å„æ–¹æ³•ç›¸äº’è°ƒç”¨çš„æ—¶å€™ï¼Œä½¿å½“å‰ this å®ä¾‹æŒ‡é’ˆä¿æŒä¸€è‡´ï¼Œæˆ–è€…åœ¨ç‰¹æ®Šæƒ…å†µä¸‹éœ€è¦æ”¹å˜ this æŒ‡é’ˆã€‚å¦‚æœæ²¡æœ‰æä¾› thisObj å‚æ•°ï¼Œé‚£ä¹ˆ Global å¯¹è±¡è¢«ç”¨ä½œ thisObj ã€‚\nå®é™…ä¸Šï¼Œ apply å’Œ call çš„åŠŸèƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ä¼ å…¥çš„å‚æ•°åˆ—è¡¨å½¢å¼ä¸åŒã€‚\nbind()ï¼šåˆ›å»ºä¸€ä¸ªæ–°å‡½æ•°ï¼Œå½“è¿™ä¸ªæ–°å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå®ƒçš„ this å€¼ä¼ é€’ç»™ bind() çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè€Œå‚æ•°æ˜¯ bind() çš„å…¶ä»–å‚æ•°å’Œå…¶åŸæœ¬çš„å‚æ•°ã€‚\nfunction obj(x, y) { return this.a + this.b + this.c + x + y; } const callObj = { a: 1, b: 2, c: 3 }; let ret1 = obj.call(callObj, 4, 5); // call å¿…é¡»è¦ç”¨é€—å·ç½—åˆ—å‚æ•° let ret2 = obj.apply(callObj, [4, 5]); // apply å¿…é¡»è¦æŠŠå‚æ•°å†™åˆ°æ•°ç»„ä¸­ console.log(ret1 === ret2) //true é»˜è®¤è§„åˆ™ è§„åˆ™ this å¯¹è±¡.å‡½æ•°() å¯¹è±¡ å‡½æ•°() window/undefied[strict mode] ç®­å¤´å‡½æ•°()=\u0026gt;{} Not Suitable æ•°ç»„[ä¸‹æ ‡]() æ•°ç»„ IIFE ((function(){})()) window/undefied[strict mode] å®šæ—¶å™¨ window DOM äº‹ä»¶å¤„ç†å‡½æ•° ç»‘å®š DOM çš„å…ƒç´  call apply bind ä»»æ„æŒ‡å®š å‡½æ•°çš„ this åªæœ‰å‡½æ•°åœ¨è¢«æ‰§è¡Œçš„æ—¶å€™æ‰ä¼šçŸ¥é“ã€‚ä¸”æ‰§è¡Œæ—¶è°è°ƒç”¨çš„å‡½æ•°ï¼Œå‡½æ•°çš„ this å°±æŒ‡å‘è°ï¼Œå¦åˆ™å°±æ˜¯ window å¯¹è±¡ / undefined[ä¸¥æ ¼æ¨¡å¼]ã€‚\n:memo: Note\nç®­å¤´å‡½æ•°çš„ this æŒ‡å‘ç®­å¤´å‡½æ•°å®šä¹‰æ—¶æ‰€å¤„çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯ç®­å¤´å‡½æ•°ä½¿ç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼Œé»˜è®¤ä½¿ç”¨å¤–å±‚ä½œç”¨åŸŸä¸­çš„ this æŒ‡å‘çš„å€¼ï¼Œæ­¤å¤–ä¸èƒ½è®¾ç½®å®ƒä»¬çš„ this çš„å€¼ ç”±äºç®­å¤´å‡½æ•°æ²¡æœ‰ç‹¬ç«‹çš„ thisï¼Œcall() å’Œ apply() æ–¹æ³•åªèƒ½ä¼ é€’å‚æ•°è¿›å»ï¼Œè€Œè®¾ç½®çš„ this å‚æ•°ä¼šè¢«å¿½ç•¥ åœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œthis å…¶å®æ˜¯å…ˆè¢«å®šä¹‰ä¸º undefinedï¼Œç„¶åè¢«è‡ªåŠ¨è½¬ä¸ºäº† window :page_with_curl: Example\n// æ™®é€šå‡½æ•°this let fun = function () { console.log(this) } fun(); // window/global fun.call({foo: \u0026#34;bar\u0026#34;}); // {foo: \u0026#39;bar\u0026#39;} // ç®­å¤´å‡½æ•°this let fun = () =\u0026gt; { console.log(this) } fun(); // {} fun.call({foo: \u0026#34;bar\u0026#34;}); // {} æ— æ³•è¢«æ”¹å˜ eval new Function åå‡½æ•° åå‡½æ•°ç”¨æ³•æ˜¯æŒ‡åˆ›å»ºä¸€ä¸ªè°ƒç”¨å¦å¤–ä¸€ä¸ªéƒ¨åˆ†\u0026mdash;\u0026mdash;å‚æ•°æˆ–å˜é‡å·²ç»é¢„ç½®çš„å‡½æ•°\u0026mdash;\u0026mdash;çš„å‡½æ•°çš„ç”¨æ³•ã€‚è¿™å¥è¯ç›¸å¯¹è¾ƒä¸ºæ‹—å£ï¼Œä¸‹é¢æˆ‘ä»¬ä»¥å®ä¾‹æ¥è¯´æ˜ï¼š\nvar toString = Object.prototype.toString; var isString = function (obj) { return toString.call(obj) == \u0026#39;[object String]\u0026#39;; }; var isFunction = function (obj) { return toString.call(obj) == \u0026#39;[object Function]\u0026#39;; }; åœ¨JavaScriptä¸­è¿›è¡Œç±»å‹åˆ¤æ–­æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šè¿›è¡Œç±»ä¼¼ä¸Šè¿°ä»£ç çš„æ–¹æ³•å®šä¹‰ã€‚è¿™æ®µä»£ç å›ºç„¶ä¸å¤æ‚ï¼Œåªæœ‰ä¸¤ä¸ªå‡½æ•°çš„å®šä¹‰ï¼Œä½†æ˜¯é‡Œé¢å­˜åœ¨çš„é—®é¢˜æ˜¯æˆ‘ä»¬éœ€è¦é‡å¤å»å®šä¹‰ä¸€äº›ç›¸ä¼¼çš„å‡½æ•°ï¼Œå¦‚æœæœ‰æ›´å¤šçš„isXXX()ï¼Œå°±ä¼šå‡ºç°æ›´å¤šçš„å†—ä½™ä»£ç ã€‚ä¸ºäº†è§£å†³é‡å¤å®šä¹‰çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªæ–°å‡½æ•°ï¼Œè¿™ä¸ªæ–°å‡½æ•°å¯ä»¥å¦‚å·¥å‚ä¸€æ ·æ‰¹é‡åˆ›å»ºä¸€äº›ç±»ä¼¼çš„å‡½æ•°ã€‚åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡isType()å‡½æ•°é¢„å…ˆæŒ‡å®štypeçš„å€¼ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼š\nvar isType = function (type) { return function (obj) { return toString.call(obj) == \u0026#39;[object \u0026#39; + type + \u0026#39;]\u0026#39;; }; }; var isString = isType(\u0026#39;String\u0026#39;); var isFunction = isType(\u0026#39;Function\u0026#39;); å¯ä»¥çœ‹å‡ºï¼Œå¼•å…¥isType()å‡½æ•°åï¼Œåˆ›å»ºisString()ã€isFunction()å‡½æ•°å°±å˜å¾—ç®€å•å¤šäº†ã€‚è¿™ç§é€šè¿‡æŒ‡å®šéƒ¨åˆ†å‚æ•°æ¥äº§ç”Ÿä¸€ä¸ªæ–°çš„å®šåˆ¶å‡½æ•°çš„å½¢å¼å°±æ˜¯åå‡½æ•°ã€‚\nåå‡½æ•°åº”ç”¨åœ¨å¼‚æ­¥ç¼–ç¨‹ä¸­ä¹Ÿååˆ†å¸¸è§ï¼Œè‘—åç±»åº“Underscoreæä¾›çš„after()æ–¹æ³•å³æ˜¯åå‡½æ•°åº”ç”¨ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š\n_.after = function(times, func) { if (times \u0026lt;= 0) return func(); return function() { if (--times \u0026lt; 1) { return func.apply(this, arguments); } }; }; è¿™ä¸ªå‡½æ•°å¯ä»¥æ ¹æ®ä¼ å…¥çš„timeså‚æ•°å’Œå…·ä½“æ–¹æ³•ï¼Œç”Ÿæˆä¸€ä¸ªéœ€è¦è°ƒç”¨å¤šæ¬¡æ‰çœŸæ­£æ‰§è¡Œå®é™…å‡½æ•°çš„å‡½æ•°ã€‚\nCurrying æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰ï¼Œæ˜¯æŠŠæ¥å—å¤šä¸ªå‚æ•°çš„å‡½æ•°å˜æ¢æˆæ¥å—ä¸€ä¸ªå•ä¸€å‚æ•°ï¼ˆæœ€åˆå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼‰çš„å‡½æ•°ï¼Œå¹¶ä¸”è¿”å›æ¥å—ä½™ä¸‹çš„å‚æ•°è€Œä¸”è¿”å›ç»“æœçš„æ–°å‡½æ•°çš„æŠ€æœ¯ã€‚\nçœ‹è¿™ä¸ªè§£é‡Šæœ‰ä¸€ç‚¹æŠ½è±¡ï¼Œæˆ‘ä»¬å°±æ‹¿è¢«åšäº†æ— æ•°æ¬¡ç¤ºä¾‹çš„ add å‡½æ•°ï¼Œæ¥åšä¸€ä¸ªç®€å•çš„å®ç°ã€‚\n// æ™®é€šçš„addå‡½æ•° function add(x, y) { return x + y } // Curryingå function curryingAdd(x) { return function (y) { return x + y } } add(1, 2) // 3 curryingAdd(1)(2) // 3 å®é™…ä¸Šå°±æ˜¯æŠŠaddå‡½æ•°çš„xï¼Œyä¸¤ä¸ªå‚æ•°å˜æˆäº†å…ˆç”¨ä¸€ä¸ªå‡½æ•°æ¥æ”¶xç„¶åè¿”å›ä¸€ä¸ªå‡½æ•°å»å¤„ç†yå‚æ•°ã€‚ç°åœ¨æ€è·¯åº”è¯¥å°±æ¯”è¾ƒæ¸…æ™°äº†ï¼Œå°±æ˜¯åªä¼ é€’ç»™å‡½æ•°ä¸€éƒ¨åˆ†å‚æ•°æ¥è°ƒç”¨å®ƒï¼Œè®©å®ƒè¿”å›ä¸€ä¸ªå‡½æ•°å»å¤„ç†å‰©ä¸‹çš„å‚æ•°ã€‚\nä½†æ˜¯é—®é¢˜æ¥äº†è´¹è¿™ä¹ˆå¤§åŠ²å°è£…ä¸€å±‚ï¼Œåˆ°åº•æœ‰ä»€ä¹ˆç”¨å¤„å‘¢ï¼Ÿæ²¡æœ‰å¥½å¤„æƒ³è®©æˆ‘ä»¬ç¨‹åºå‘˜å¤šå¹²äº‹æƒ…æ˜¯ä¸å¯èƒ½æ»´ï¼Œè¿™è¾ˆå­éƒ½ä¸å¯èƒ½.\næ¥åˆ—ä¸€åˆ—Curryingæœ‰å“ªäº›å¥½å¤„å‘¢ï¼Ÿ\nå‚\u0010æ•°å¤ç”¨ // æ­£å¸¸æ­£åˆ™éªŒè¯å­—ç¬¦ä¸² reg.test(txt) // å‡½æ•°å°è£…å function check(reg, txt) { return reg.test(txt) } check(/\\d+/g, \u0026#39;test\u0026#39;) //false check(/[a-z]+/g, \u0026#39;test\u0026#39;) //true // Curryingå function curryingCheck(reg) { return function(txt) { return reg.test(txt) } } var hasNumber = curryingCheck(/\\d+/g) var hasLetter = curryingCheck(/[a-z]+/g) hasNumber(\u0026#39;test1\u0026#39;) // true hasNumber(\u0026#39;testtest\u0026#39;) // false hasLetter(\u0026#39;21212\u0026#39;) // false ä¸Šé¢çš„ç¤ºä¾‹æ˜¯ä¸€ä¸ªæ­£åˆ™çš„æ ¡éªŒï¼Œæ­£å¸¸æ¥è¯´ç›´æ¥è°ƒç”¨checkå‡½æ•°å°±å¯ä»¥äº†ï¼Œä½†æ˜¯å¦‚æœæˆ‘æœ‰å¾ˆå¤šåœ°æ–¹éƒ½è¦æ ¡éªŒæ˜¯å¦æœ‰æ•°å­—ï¼Œå…¶å®å°±æ˜¯éœ€è¦å°†ç¬¬ä¸€ä¸ªå‚æ•°regè¿›è¡Œå¤ç”¨ï¼Œè¿™æ ·åˆ«çš„åœ°æ–¹å°±èƒ½å¤Ÿç›´æ¥è°ƒç”¨hasNumberï¼ŒhasLetterç­‰å‡½æ•°ï¼Œè®©å‚æ•°èƒ½å¤Ÿå¤ç”¨ï¼Œè°ƒç”¨èµ·æ¥ä¹Ÿæ›´æ–¹ä¾¿ã€‚\næå‰ç¡®è®¤ var on = function(element, event, handler) { if (document.addEventListener) { if (element \u0026amp;\u0026amp; event \u0026amp;\u0026amp; handler) { element.addEventListener(event, handler, false); } } else { if (element \u0026amp;\u0026amp; event \u0026amp;\u0026amp; handler) { element.attachEvent(\u0026#39;on\u0026#39; + event, handler); } } } var on = (function() { if (document.addEventListener) { return function(element, event, handler) { if (element \u0026amp;\u0026amp; event \u0026amp;\u0026amp; handler) { element.addEventListener(event, handler, false); } }; } else { return function(element, event, handler) { if (element \u0026amp;\u0026amp; event \u0026amp;\u0026amp; handler) { element.attachEvent(\u0026#39;on\u0026#39; + event, handler); } }; } })(); //æ¢ä¸€ç§å†™æ³•å¯èƒ½æ¯”è¾ƒå¥½ç†è§£ä¸€ç‚¹ï¼Œä¸Šé¢å°±æ˜¯æŠŠisSupportè¿™ä¸ªå‚æ•°ç»™å…ˆç¡®å®šä¸‹æ¥äº† var on = function(isSupport, element, event, handler) { isSupport = isSupport || document.addEventListener; if (isSupport) { return element.addEventListener(event, handler, false); } else { return element.attachEvent(\u0026#39;on\u0026#39; + event, handler); } } æˆ‘ä»¬åœ¨åšé¡¹ç›®çš„è¿‡ç¨‹ä¸­ï¼Œå°è£…ä¸€äº›domæ“ä½œå¯ä»¥è¯´å†å¸¸è§ä¸è¿‡ï¼Œä¸Šé¢ç¬¬ä¸€ç§å†™æ³•ä¹Ÿæ˜¯æ¯”è¾ƒå¸¸è§ï¼Œä½†æ˜¯æˆ‘ä»¬çœ‹çœ‹ç¬¬äºŒç§å†™æ³•ï¼Œå®ƒç›¸å¯¹ä¸€ç¬¬ä¸€ç§å†™æ³•å°±æ˜¯è‡ªæ‰§è¡Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œè¿™æ ·å…¶å®å°±æ˜¯æå‰ç¡®å®šäº†ä¼šèµ°å“ªä¸€ä¸ªæ–¹æ³•ï¼Œé¿å…æ¯æ¬¡éƒ½è¿›è¡Œåˆ¤æ–­ã€‚\nå»¶è¿Ÿè¿è¡Œ Function.prototype.bind = function (context) { var _this = this var args = Array.prototype.slice.call(arguments, 1) return function() { return _this.apply(context, args) } } åƒæˆ‘ä»¬jsä¸­ç»å¸¸ä½¿ç”¨çš„bindï¼Œå®ç°çš„æœºåˆ¶å°±æ˜¯Currying.\nè¯´äº†è¿™å‡ ç‚¹å¥½å¤„ä¹‹åï¼Œå‘ç°è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œéš¾é“æ¯æ¬¡ä½¿ç”¨Curryingéƒ½è¦å¯¹åº•å±‚å‡½æ•°å»åšä¿®æ”¹ï¼Œ\næœ‰æ²¡æœ‰ä»€ä¹ˆé€šç”¨çš„å°è£…æ–¹æ³•ï¼Ÿ\n// åˆæ­¥å°è£… var currying = function(fn) { // args è·å–ç¬¬ä¸€ä¸ªæ–¹æ³•å†…çš„å…¨éƒ¨å‚æ•° var args = Array.prototype.slice.call(arguments, 1) return function() { // å°†åé¢æ–¹æ³•é‡Œçš„å…¨éƒ¨å‚æ•°å’Œargsè¿›è¡Œåˆå¹¶ var newArgs = args.concat(Array.prototype.slice.call(arguments)) // æŠŠåˆå¹¶åçš„å‚æ•°é€šè¿‡applyä½œä¸ºfnçš„å‚æ•°å¹¶æ‰§è¡Œ return fn.apply(this, newArgs) } } è¿™è¾¹é¦–å…ˆæ˜¯åˆæ­¥å°è£…,é€šè¿‡é—­åŒ…æŠŠåˆæ­¥å‚æ•°ç»™ä¿å­˜ä¸‹æ¥ï¼Œç„¶åé€šè¿‡è·å–å‰©ä¸‹çš„argumentsè¿›è¡Œæ‹¼æ¥ï¼Œæœ€åæ‰§è¡Œéœ€è¦curryingçš„å‡½æ•°ã€‚\nä½†æ˜¯å¥½åƒè¿˜æœ‰äº›ä»€ä¹ˆç¼ºé™·ï¼Œè¿™æ ·è¿”å›çš„è¯å…¶å®åªèƒ½å¤šæ‰©å±•ä¸€ä¸ªå‚æ•°ï¼Œcurrying(a)(b)(c)è¿™æ ·çš„è¯ï¼Œè²Œä¼¼å°±ä¸æ”¯æŒäº†ï¼ˆä¸æ”¯æŒå¤šå‚æ•°è°ƒç”¨ï¼‰ï¼Œä¸€èˆ¬è¿™ç§æƒ…å†µéƒ½ä¼šæƒ³åˆ°ä½¿ç”¨é€’å½’å†è¿›è¡Œå°è£…ä¸€å±‚ã€‚\n// æ”¯æŒå¤šå‚æ•°ä¼ é€’ function progressCurrying(fn, args) { var _this = this var len = fn.length; var args = args || []; return function() { var _args = Array.prototype.slice.call(arguments); Array.prototype.push.apply(args, _args); // å¦‚æœå‚æ•°ä¸ªæ•°å°äºæœ€åˆçš„fn.lengthï¼Œåˆ™é€’å½’è°ƒç”¨ï¼Œç»§ç»­æ”¶é›†å‚æ•° if (_args.length \u0026lt; len) { return progressCurrying.call(_this, fn, _args); } // å‚æ•°æ”¶é›†å®Œæ¯•ï¼Œåˆ™æ‰§è¡Œfn return fn.apply(this, _args); } } è¿™è¾¹å…¶å®æ˜¯åœ¨åˆæ­¥çš„åŸºç¡€ä¸Šï¼ŒåŠ ä¸Šäº†é€’å½’çš„è°ƒç”¨ï¼Œåªè¦å‚æ•°ä¸ªæ•°å°äºæœ€åˆçš„fn.lengthï¼Œå°±ä¼šç»§ç»­æ‰§è¡Œé€’å½’ã€‚\nå¥½å¤„è¯´å®Œäº†ï¼Œé€šç”¨æ–¹æ³•ä¹Ÿæœ‰äº†ï¼Œè®©æˆ‘ä»¬æ¥å…³æ³¨ä¸‹curryçš„æ€§èƒ½\ncurryçš„ä¸€äº›æ€§èƒ½é—®é¢˜ä½ åªè¦çŸ¥é“ä¸‹é¢å››ç‚¹å°±å·®ä¸å¤šäº†ï¼š\nå­˜å–argumentså¯¹è±¡é€šå¸¸è¦æ¯”å­˜å–å‘½åå‚æ•°è¦æ…¢ä¸€ç‚¹ ä¸€äº›è€ç‰ˆæœ¬çš„æµè§ˆå™¨åœ¨arguments.lengthçš„å®ç°ä¸Šæ˜¯ç›¸å½“æ…¢çš„ ä½¿ç”¨fn.apply( â€¦ ) å’Œ fn.call( â€¦ )é€šå¸¸æ¯”ç›´æ¥è°ƒç”¨fn( â€¦ ) ç¨å¾®æ…¢ç‚¹ åˆ›å»ºå¤§é‡åµŒå¥—ä½œç”¨åŸŸå’Œé—­åŒ…å‡½æ•°ä¼šå¸¦æ¥èŠ±é”€ï¼Œæ— è®ºæ˜¯åœ¨å†…å­˜è¿˜æ˜¯é€Ÿåº¦ä¸Š å…¶å®åœ¨å¤§éƒ¨åˆ†åº”ç”¨ä¸­ï¼Œä¸»è¦çš„æ€§èƒ½ç“¶é¢ˆæ˜¯åœ¨æ“ä½œDOMèŠ‚ç‚¹ä¸Šï¼Œè¿™jsçš„æ€§èƒ½æŸè€—åŸºæœ¬æ˜¯å¯ä»¥å¿½ç•¥ä¸è®¡çš„ï¼Œæ‰€ä»¥curryæ˜¯å¯ä»¥ç›´æ¥æ”¾å¿ƒçš„ä½¿ç”¨ã€‚\næœ€åå†æ‰©å±•ä¸€é“ç»å…¸é¢è¯•é¢˜\n// å®ç°ä¸€ä¸ªaddæ–¹æ³•ï¼Œä½¿è®¡ç®—ç»“æœèƒ½å¤Ÿæ»¡è¶³å¦‚ä¸‹é¢„æœŸï¼š add(1)(2)(3) = 6; add(1, 2, 3)(4) = 10; add(1)(2)(3)(4)(5) = 15; function add() { // ç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶ï¼Œå®šä¹‰ä¸€ä¸ªæ•°ç»„ä¸“é—¨ç”¨æ¥å­˜å‚¨æ‰€æœ‰çš„å‚æ•° var _args = Array.prototype.slice.call(arguments); // åœ¨å†…éƒ¨å£°æ˜ä¸€ä¸ªå‡½æ•°ï¼Œåˆ©ç”¨é—­åŒ…çš„ç‰¹æ€§ä¿å­˜_argså¹¶æ”¶é›†æ‰€æœ‰çš„å‚æ•°å€¼ var _adder = function() { _args.push(...arguments); return _adder; }; // åˆ©ç”¨toStringéšå¼è½¬æ¢çš„ç‰¹æ€§ï¼Œå½“æœ€åæ‰§è¡Œæ—¶éšå¼è½¬æ¢ï¼Œå¹¶è®¡ç®—æœ€ç»ˆçš„å€¼è¿”å› _adder.toString = function () { return _args.reduce(function (a, b) { return a + b; }); } return _adder; } add(1)(2)(3) // 6 add(1, 2, 3)(4) // 10 add(1)(2)(3)(4)(5) // 15 add(2, 6)(1) // 9 æ­£åˆ™ æ­£åˆ™è¡¨è¾¾å¼ RegExpObject æè¿°äº†å­—ç¬¦ä¸²çš„ æ„æˆæ¨¡å¼ï¼Œç»å¸¸è¢«ç”¨äºæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦ç¬¦åˆé¢„å®šçš„æ ¼å¼è¦æ±‚ã€‚\n:memo: Note å¯ç”¨äºéªŒè¯æ‰‹æœºå·ã€éªŒè¯é‚®ç®±ã€éªŒè¯èº«ä»½è¯ç­‰\n:link: Href [ES6](06 EcmaScript.md/#regexp-es6) æ­£åˆ™çš„æ‰©å±•\nè¡¨è¾¾å¼ä½¿ç”¨ test() æ–¹æ³•æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„è§„åˆ™ã€‚\nåˆ›å»º ä½¿ç”¨ /å†…å®¹/ çš„è¯­æ³•å½¢å¼ï¼Œå¯ä»¥å¿«é€Ÿåˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼ã€‚ ä¹Ÿå¯ä»¥ä½¿ç”¨ new RegExp('å†…å®¹')ä¼ å…¥String çš„å½¢å¼ï¼Œåˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼ã€‚ ä½¿ç”¨ typeof è¿ç®—ç¬¦æ£€æŸ¥æ­£åˆ™è¡¨è¾¾å¼çš„ç±»å‹ï¼Œç»“æœæ˜¯ object å…ƒå­—ç¬¦ å…ƒå­—ç¬¦ æ˜¯æŒ‡ä¸€ä½æŒ‡å®šç±»å‹çš„å­—ç¬¦ã€‚\nå…ƒå­—ç¬¦ åŠŸèƒ½ \\d åŒ¹é…ä¸€ä¸ªæ•°å­— \\D åŒ¹é…ä¸€ä¸ªéæ•°å­—å­—ç¬¦ \\w åŒ¹é…ä¸€ä¸ªå•å­—å­—ç¬¦ï¼ˆå­—æ¯ã€æ•°å­—æˆ–è€…ä¸‹åˆ’çº¿ï¼‰ \\W åŒ¹é…ä¸€ä¸ªéå•å­—å­—ç¬¦ \\s åŒ¹é…ä¸€ä¸ªç©ºç™½å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦å’Œæ¢è¡Œç¬¦ . ä»»æ„å­—ç¬¦ ^ åŒ¹é…å¼€å¤´ $ åŒ¹é…ç»“å°¾ :memo: Note å¦‚æœä½¿ç”¨ new RegExp() å†™æ³•ï¼Œéœ€è¦å¯¹åæ–œæ†è½¬ä¹‰\\\\ ã€‚\ne.g.: /^\\d$/ å’Œ new RegExp('^\\\\d$') æ˜¯ç›¸åŒçš„æ„æ€ã€‚\n:page_with_curl: Example\næŸå¿«é€’å…¬å¸è¿å•å·å½¢å¼æ˜¯è¿™æ ·çš„ï¼š123-4567-890ï¼Œè¯·ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ£€æŸ¥æŸå­—ç¬¦ä¸²æ˜¯å¦ç¬¦åˆæ­¤æ ¼å¼ã€‚\næŸäº§å“çš„éªŒè¯å¯†é’¥æ˜¯è¿™æ ·çš„ï¼šâ–¡â–¡â–¡-â–¡â–¡â–¡â–¡-â–¡â–¡â–¡ï¼Œå…¶ä¸­ â–¡ è¡¨ç¤ºå­—æ¯æ•°å­—æˆ–è€…ä¸‹åˆ’çº¿ï¼Œè¯·ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ£€æŸ¥æŸå­—ç¬¦ä¸²æ˜¯å¦ç¬¦åˆæ­¤æ ¼å¼ã€‚\nåœ¨ç‰¹æ®Šå­—ç¬¦ä¹‹å‰çš„åæ–œæ  \\ è¡¨ç¤ºä¸‹ä¸€ä¸ªå­—ç¬¦ä¸æ˜¯ç‰¹æ®Šå­—ç¬¦ï¼Œåº”è¯¥æŒ‰ç…§å­—é¢ç†è§£ã€‚\n/^.$/ï¼šæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯ä¸æ˜¯ä»»æ„å­—ç¬¦ /^\\.$/ï¼šæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯ä¸æ˜¯ä¸€ä¸ªç‚¹ /^\\\\$/ï¼šæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯ä¸æ˜¯ä¸€ä¸ªåæ–œæ  ä¸ç®¡ä¸€ä¸ªç¬¦å·æœ‰æ²¡æœ‰ç‰¹æ®Šæ„ä¹‰ï¼Œéƒ½å¯ä»¥åœ¨å…¶ä¹‹å‰åŠ ä¸Šä¸€ä¸ª \\ ä»¥ç¡®ä¿å®ƒè¡¨è¾¾çš„æ˜¯è¿™ä¸ªç¬¦å·æœ¬èº«ã€‚\né›†åˆ ä½¿ç”¨æ–¹æ‹¬å·ï¼Œæ¯”å¦‚ [xyz]ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ª å­—ç¬¦é›†åˆ ï¼Œè¡¨ç¤ºåŒ¹é…æ–¹æ‹¬å·ä¸­çš„ä»»æ„å­—ç¬¦ã€‚\nå¯ä»¥ä½¿ç”¨çŸ­æ¨ª - æ¥æŒ‡å®šä¸€ä¸ªå­—ç¬¦èŒƒå›´ï¼Œ^ è¡¨ç¤ºå¦å®šã€‚\nå…ƒå­—ç¬¦ ç­‰ä»·çš„æ–¹æ‹¬å·è¡¨ç¤ºæ³• \\d [0-9] \\D [^0-9] \\w [A-Za-z0-9_] \\W [^A-Za-z0-9_] :page_with_curl: Example æ¯”å¦‚æŸå­¦æ ¡çš„å­¦å·è§„å®šï¼šç¬¬1ä½æ˜¯ä¸€ä¸ªå­—æ¯ï¼Œbè¡¨ç¤ºæœ¬ç§‘ç”Ÿï¼Œyè¡¨ç¤ºç ”ç©¶ç”Ÿï¼Œåé¢æ˜¯7ä½æ•°å­—ï¼Œç”¨æ­£åˆ™è¡¨è¾¾å¼è¡¨ç¤ºä¸ºï¼š\n/^[by]\\d{7}$/\n:warning: Caution åœ¨è‹±æ–‡ä¸­ï¼Œå¤§å†™å­—æ¯çš„åºå·æ¯”å°å†™å­—æ¯æ›´å°ã€‚å› æ­¤æ­£ç¡®è¡¨è¾¾è‹±æ–‡å­—æ¯çš„æ–¹å¼æ˜¯ [A-z] ã€‚\nå¦åˆ™èŒƒå›´æŠ¥é”™ï¼šInvalid regular expression: /[a-Z]/: Range out of order in character class\né‡è¯ é‡è¯ æ„ä¹‰ * åŒ¹é…å‰ä¸€ä¸ªè¡¨è¾¾å¼ 0 æ¬¡æˆ–å¤šæ¬¡ã€‚ç­‰ä»·äº {0, } + åŒ¹é…å‰é¢ä¸€ä¸ªè¡¨è¾¾å¼ 1 æ¬¡æˆ–è€…å¤šæ¬¡ã€‚ç­‰ä»·äº {1, } ? åŒ¹é…å‰é¢ä¸€ä¸ªè¡¨è¾¾å¼ 0 æ¬¡æˆ–è€… 1 æ¬¡ã€‚ç­‰ä»·äº {0, 1} {n} n æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼ŒåŒ¹é…äº†å‰é¢ä¸€ä¸ªå­—ç¬¦åˆšå¥½å‡ºç°äº† n æ¬¡ {n, } n æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼ŒåŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦è‡³å°‘å‡ºç°äº† n æ¬¡ {n, m} n å’Œ m éƒ½æ˜¯æ•´æ•°ã€‚åŒ¹é…å‰é¢çš„å­—ç¬¦è‡³å°‘ n æ¬¡ï¼Œæœ€å¤š m æ¬¡ :page_with_curl: Example 1 è¯·éªŒè¯å­—ç¬¦ä¸²æ˜¯å¦ç¬¦åˆæ‰‹æœºå·ç çš„è§„åˆ™ï¼š11 ä½æ•°å­—ï¼Œå¹¶ä¸”è‚¯å®šä»¥ 1 å¼€å¤´ã€‚\n/^1\\d{10}/\n:page_with_curl: Example 2 è¯·éªŒè¯æŸå­—ç¬¦ä¸²æ˜¯å¦æ˜¯è¿™æ ·çš„ï¼šä»¥å­—æ¯å¼€å¤´ï¼Œä¸­é—´æ˜¯ä»»æ„ä½æ•°å­—ï¼ˆæœ€å°‘1ä½ï¼‰æ„æˆï¼Œå¹¶ä»¥å­—æ¯ç»“å°¾ã€‚\n/^[A-z]\\d{1,}[A-z]$/\n:page_with_curl: Example 3 è¯·éªŒè¯æŸå­—ç¬¦ä¸²æ˜¯å¦ç¬¦åˆç½‘å€è§„åˆ™ï¼šä»¥ www. å¼€å¤´ï¼Œä¸­é—´æ˜¯ä»»æ„ä½çš„å­—ç¬¦ï¼ˆå­—æ¯æ•°å­—ä¸‹åˆ’çº¿ï¼‰ï¼Œæœ€åä»¥ .com ç»“å°¾ï¼Œä¹Ÿå¯ä»¥ä»¥ .com.cn ç»“å°¾\n/^www\\..*(?:\\.com\\.cn|\\.com)$/\nlet RegExp = /^www\\..*(?:\\.com\\.cn|\\.com)$/; RegExp.test(\u0026#39;www.baidu.com\u0026#39;); // true RegExp.test(\u0026#39;www.apple.com.cn\u0026#39;); // true ä¿®é¥°ç¬¦ ä¿®é¥°ç¬¦ä¹Ÿå«ä½œ æ ‡å¿—flagsï¼Œç”¨äºä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å®ç°é«˜çº§æœç´¢ã€‚\nä¿®é¥°ç¬¦ æ„ä¹‰ i ä¸åŒºåˆ†å¤§å°å†™æœç´¢ g å…¨å±€æœç´¢ :page_with_curl: Example\nlet R = /m/gi; // ä¿®é¥°ç¬¦ä½ç½®åœ¨æ­£åˆ™è¡¨è¾¾å¼åé¢ï¼Œå¯å¤šä¸ªè¿å†™ let R = new RegExp(\u0026#34;m\u0026#34;, \u0026#34;gi\u0026#34;); //new RegExp()çš„å½¢å¼ä¼ å…¥æ—¶ï¼Œä»¥å­—ç¬¦ä¸²çš„å½¢å¼å†™å…¥ç¬¬äºŒä¸ªå‚æ•° :memo: Note\nç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œè¡¨å•éªŒè¯æ˜¯æ­£åˆ™è¡¨è¾¾å¼æœ€é‡è¦çš„å®é™…åº”ç”¨\nå®é™…ä¸Šï¼Œå¾ˆå¤šæ­£åˆ™è¡¨è¾¾å¼ä¸éœ€è¦æˆ‘ä»¬è‡ªå·±å†™ï¼Œå¯ä»¥é€šè¿‡æœç´¢å¼•æ“æŸ¥æ‰¾ã€æ‹¿æ¥å³ç”¨\nRegEx-Vis è¿™ä¸ªç½‘ç«™å¯ä»¥å¯è§†åŒ–ç¼–è¾‘ RegExp\nåŒ¹é… test() æ­£åˆ™è¡¨è¾¾å¼çš„ test() æ–¹æ³•ç”¨æ¥æµ‹è¯•æŸå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…æ­¤æ­£åˆ™è¡¨è¾¾å¼ï¼Œå®ƒè¿”å› true æˆ– falseã€‚\n/^[a-z]{3}[a-ln-z]$/.test(\u0026#39;abcd\u0026#39;)\t// true //[a-ln-z]è¡¨ç¤ºä»aåˆ°lå’Œä»nåˆ°zå‡å¯ exec() æ–¹æ³•åŠŸèƒ½æ˜¯ï¼šåœ¨ä¸€ä¸ªæŒ‡å®šå­—ç¬¦ä¸²ä¸­æ‰§è¡Œä¸€ä¸ªæœç´¢åŒ¹é…æŸ¥æ‰¾ï¼Œè¿”å›ä¸€ä¸ªç»“æœæ•°ç»„æˆ– nullã€‚\nvar str = \u0026#39;abc123def456ghi789\u0026#39;; var regexp = /\\d+/; var result1 = regexp.exec(str); // [ \u0026#39;123\u0026#39;, index: 3, input: \u0026#39;abc123def456ghi789\u0026#39;, groups: undefined ] :memo: Note\næ·»åŠ äº† g ä¿®é¥°ç¬¦çš„æ­£åˆ™è¡¨è¾¾å¼å¯ä»¥è‡ªåŠ¨ä¿å­˜éå†çŠ¶æ€ï¼Œè¿™æ„å‘³ç€å¯ä»¥å¯¹å•ä¸ªå­—ç¬¦ä¸²è¿›è¡Œ é€æ¡å¤šæ¬¡ çš„éå†ã€‚\nlet str = \u0026#34;abc123def456ghi789\u0026#34;; let reg = /\\d+/g; // æœ‰gä¿®é¥°ç¬¦ let res; while (res = reg.exec(str)) { console.log(res); /* [ \u0026#39;123\u0026#39;, index: 3, input: \u0026#39;abc123def456ghi789\u0026#39;, groups: undefined ] * [ \u0026#39;456\u0026#39;, index: 9, ... ] * [ \u0026#39;789\u0026#39;, index: 15, ... ] */ } console.log(res); // null å­—ç¬¦ä¸² å­—ç¬¦ä¸²æœ‰å“ªäº›æ–¹æ³•å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Ÿ\næ–¹æ³• ç®€ä»‹ search() åœ¨å­—ç¬¦ä¸²ä¸­æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒæŸ¥æ‰¾åŒ¹é…ï¼Œè¿”å›é¦–æ¬¡åŒ¹é…åˆ°çš„ä½ç½®ç´¢å¼•ï¼Œæµ‹è¯•ä¸åˆ°åˆ™è¿”å› -1 match() åœ¨å­—ç¬¦ä¸²ä¸­æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒæŸ¥æ‰¾åŒ¹é…ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ‰¾ä¸åˆ°åˆ™è¿”å› null replace() ä½¿ç”¨æ›¿æ¢å­—ç¬¦ä¸²æ›¿æ¢æ‰åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ split() åˆ†éš”å­—ç¬¦ä¸²ä¸ºæ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ å¼‚æ­¥ å‡½æ•°èŠ‚æµ ä¸€ä¸ªå‡½æ•°æ‰§è¡Œä¸€æ¬¡åï¼Œåªæœ‰å¤§äºè®¾å®šçš„æ‰§è¡Œå‘¨æœŸåæ‰å…è®¸æ‰§è¡Œç¬¬äºŒæ¬¡ã€‚\nå‡½æ•°èŠ‚æµçš„æ„ä¹‰ï¼šåœ¨è®¸å¤š JS + CSS3 å®ç°çš„åŠ¨ç”»ä¸­ï¼Œå¦‚æœæ²¡æœ‰å‡½æ•°èŠ‚æµï¼Œé‚£ä¹ˆå½“ä¸€ä¸ªåŠ¨ç”»è¿˜æ²¡æœ‰æ‰§è¡Œå®Œæ—¶ï¼Œå¦‚æœç”¨æˆ·å†æ¬¡è¦æ±‚æ‰§è¡ŒåŠ¨ç”»ï¼Œåˆ™åŠ¨ç”»ä¼šç›´æ¥ä¸­æ–­è¿˜æœªæ‰§è¡Œå®Œçš„åŠ¨ç”»ï¼Œç„¶åæ‰§è¡Œæ–°çš„åŠ¨ç”»ã€‚\næˆ‘ä»¬è¦é€šè¿‡å‡½æ•°èŠ‚æµæ¥é¿å…è¿™ç§æƒ…å†µï¼Œæ¯”å¦‚ï¼šè½®æ’­å›¾ä¸­å°±è¦é¿å…ç”¨æˆ·é«˜é¢‘åœ°ç‚¹å‡»è½®æ’­å›¾åˆ‡æ¢æŒ‰é’®æ—¶è½®æ’­å›¾é£å¿«åˆ‡æ¢çš„é—®é¢˜ï¼Œè€Œåº”è¯¥åšåˆ°æ— è®ºç”¨æˆ·ç‚¹å‡»å¤šå—ï¼Œè½®æ’­å›¾çš„åˆ‡æ¢é€Ÿåº¦å§‹ç»ˆæ˜¯å¹³ç¨³çš„ã€‚\nå‡½æ•°èŠ‚æµéå¸¸å®¹æ˜“å®ç°ï¼Œåªéœ€å€ŸåŠ© setTimeout å»¶æ—¶å™¨ã€‚\n:page_with_curl: Example å‡½æ•°èŠ‚æµæ¨¡ç‰ˆ\n// JS å±äºå•çº¿ç¨‹è¯­å¥ï¼Œå› æ­¤åªéœ€è¦ä¸€ä¸ªæ ‡å¿—å³å¯ // å£°æ˜èŠ‚æµé” let locked = false; window.throttling = null; function throttleFun(fun) { // å¦‚æœé”æ˜¯å…³é—­çŠ¶æ€ï¼Œåˆ™ä¸æ‰§è¡Œ if (locked) { return; } // å…³é” locked = true; fun(); clearTimeout(throttling); // å…ˆæ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨ window.throttling = setTimeout(function () { // æŒ‡å®šæ¯«ç§’æ•°åå°†é”æ‰“å¼€ locked = false; }, 2000); // timeoutå³ä¸ºå®šæ—¶å™¨æ—¶é—´ } let $ = 0; let fun = () =\u0026gt; { //å‡½æ•°æ ¸å¿ƒè¯­å¥ console.log($++); } throttleFun(fun); throttleFun(fun); throttleFun(fun); throttleFun(fun); throttleFun(fun); // 2så†…åªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œå…¶å®ƒéƒ½è¢«èŠ‚æµ åŠ¨ç”» 13.7 åˆæ­¥è®¤è¯†å¼‚æ­¥è¯­å¥\nsetInterval() å’Œ setTimeout() æ˜¯ä¸¤ä¸ªå¼‚æ­¥è¯­å¥ã€‚\nå¼‚æ­¥ï¼ˆasynchronousï¼‰ï¼šä¸ä¼šé˜»å¡ CPU ç»§ç»­æ‰§è¡Œå…¶ä»–è¯­å¥ï¼Œå½“å¼‚æ­¥å®Œæˆæ—¶ï¼Œä¼šæ‰§è¡Œ â€œå›è°ƒå‡½æ•°â€ï¼ˆcallbackï¼‰ã€‚\né€šè¿‡ JS çš„å¼‚æ­¥ã€å®šæ—¶å™¨å¯ä»¥å®ç°ç›¸åº”çš„åŠ¨ç”»ã€‚\n13.8 ä½¿ç”¨å®šæ—¶å™¨å®ç°åŠ¨ç”»\nåŠ¨ç”»æ˜¯ç½‘é¡µä¸Šéå¸¸å¸¸è§çš„ä¸šåŠ¡éœ€æ±‚ã€‚\nä½¿ç”¨å®šæ—¶å™¨å®ç°åŠ¨ç”»å°±æ˜¯åˆ©ç”¨ â€œè§†è§‰æš‚ç•™â€ åŸç†ã€‚\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Document\u0026lt;/title\u0026gt; \u0026lt;style\u0026gt; #box { position: absolute; top: 100px; left: 100px; width: 100px; height: 100px; background-color: orange; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;button id=\u0026#34;btn\u0026#34;\u0026gt;å¼€å§‹è¿åŠ¨\u0026lt;/button\u0026gt; \u0026lt;div id=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; // å¾—åˆ°å…ƒç´  var btn = document.getElementById(\u0026#39;btn\u0026#39;); var box = document.getElementById(\u0026#39;box\u0026#39;); // å…¨å±€å˜é‡ç›’å­çš„leftå€¼ var left = 100; // æŒ‰é’®ç›‘å¬ btn.onclick = function () { var timer = setInterval(function () { // æ”¹å˜å…¨å±€å˜é‡ left += 10; if (left \u0026gt;= 1000) { clearInterval(timer); } // è®¾ç½®leftå±æ€§ box.style.left = left + \u0026#39;px\u0026#39;; }, 20); }; \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; ä½¿ç”¨å®šæ—¶å™¨å®ç°åŠ¨ç”»è¾ƒä¸ºä¸ä¾¿ï¼š\nä¸æ–¹ä¾¿æ ¹æ®åŠ¨ç”»æ€»æ—¶é—´è®¡ç®—æ­¥é•¿ è¿åŠ¨æ–¹å‘è¦è®¾ç½®æ­£è´Ÿ å¤šç§è¿åŠ¨è¿›è¡Œå åŠ è¾ƒä¸ºå›°éš¾ æ‰€ä»¥å®é™…å¼€å‘ä¸­æ˜¯åˆ©ç”¨ï¼š\nJQuery ç­‰ JS åº“ï¼ˆç›®å‰åˆ©ç”¨å¾—è¶Šæ¥è¶Šå°‘ï¼‰\nJS + CSS3 çš„æ¨¡å¼åˆ¶ä½œåŠ¨ç”»\nåå››ã€JSå’ŒCSS3ç»“åˆå®ç°åŠ¨ç”»\n14.1 JSå’ŒCSS3ç»“åˆå®ç°åŠ¨ç”»\næˆ‘ä»¬çŸ¥é“ï¼ŒCSS3 çš„ transition è¿‡æ¸¡å±æ€§å¯ä»¥å®ç°åŠ¨ç”»ã€‚ JS å¯ä»¥åˆ©ç”¨ CSS3 çš„ transition å±æ€§è½»æ¾å®ç°å…ƒç´ åŠ¨ç”»ã€‚ JS å’Œ CSS3 ç»“åˆå®ç°åŠ¨ç”»è§„é¿äº†å®šæ—¶å™¨åˆ¶ä½œåŠ¨ç”»çš„ç¼ºç‚¹ã€‚ 14.2 å‡½æ•°èŠ‚æµ\nå‡½æ•°èŠ‚æµï¼šä¸€ä¸ªå‡½æ•°æ‰§è¡Œä¸€æ¬¡åï¼Œåªæœ‰å¤§äºè®¾å®šçš„æ‰§è¡Œå‘¨æœŸåæ‰å…è®¸æ‰§è¡Œç¬¬äºŒæ¬¡ã€‚\nå‡½æ•°èŠ‚æµçš„æ„ä¹‰ï¼šåœ¨è®¸å¤š JS + CSS3 å®ç°çš„åŠ¨ç”»ä¸­ï¼Œå¦‚æœæ²¡æœ‰å‡½æ•°èŠ‚æµï¼Œé‚£ä¹ˆå½“ä¸€ä¸ªåŠ¨ç”»è¿˜æ²¡æœ‰æ‰§è¡Œå®Œæ—¶ï¼Œå¦‚æœç”¨æˆ·å†æ¬¡è¦æ±‚æ‰§è¡ŒåŠ¨ç”»ï¼Œåˆ™åŠ¨ç”»ä¼šç›´æ¥ä¸­æ–­è¿˜æœªæ‰§è¡Œå®Œçš„åŠ¨ç”»ï¼Œç„¶åæ‰§è¡Œæ–°çš„åŠ¨ç”»ã€‚æˆ‘ä»¬è¦é€šè¿‡å‡½æ•°èŠ‚æµæ¥é¿å…è¿™ç§æƒ…å†µï¼Œæ¯”å¦‚ï¼šè½®æ’­å›¾ä¸­å°±è¦é¿å…ç”¨æˆ·é«˜é¢‘åœ°ç‚¹å‡»è½®æ’­å›¾åˆ‡æ¢æŒ‰é’®æ—¶è½®æ’­å›¾é£å¿«åˆ‡æ¢çš„é—®é¢˜ï¼Œè€Œåº”è¯¥åšåˆ°æ— è®ºç”¨æˆ·ç‚¹å‡»å¤šå—ï¼Œè½®æ’­å›¾çš„åˆ‡æ¢é€Ÿåº¦å§‹ç»ˆæ˜¯å¹³ç¨³çš„ã€‚\nå‡½æ•°èŠ‚æµéå¸¸å®¹æ˜“å®ç°ï¼Œåªéœ€å€ŸåŠ© setTimeout å»¶æ—¶å™¨ã€‚\nã€å‡½æ•°èŠ‚æµæ¨¡æ¿ã€‘\n// å£°æ˜èŠ‚æµé” var lock = true; function éœ€è¦èŠ‚æµçš„å‡½æ•°() { // å¦‚æœé”æ˜¯å…³é—­çŠ¶æ€ï¼Œåˆ™ä¸æ‰§è¡Œ if (!lock) { return; } // å‡½æ•°æ ¸å¿ƒè¯­å¥ // â€¦â€¦ // å‡½æ•°æ ¸å¿ƒè¯­å¥ // å…³é” lock = false; // æŒ‡å®šæ¯«ç§’æ•°åå°†é”æ‰“å¼€ setTimeout(function() { lock = true; }, 2000); } ã€æ¡ˆä¾‹ã€‘\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Document\u0026lt;/title\u0026gt; \u0026lt;style\u0026gt; #box { width: 100px; height: 100px; background-color: orange; position: absolute; top: 100px; left: 100px; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;button id=\u0026#34;btn\u0026#34;\u0026gt;æŒ‰æˆ‘è¿åŠ¨\u0026lt;/button\u0026gt; \u0026lt;div id=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; // å¾—åˆ°å…ƒç´  var btn = document.getElementById(\u0026#39;btn\u0026#39;); var box = document.getElementById(\u0026#39;box\u0026#39;); // æ ‡è¯†é‡ï¼ŒæŒ‡ç¤ºå½“å‰ç›’å­åœ¨å·¦è¾¹è¿˜æ˜¯å³è¾¹ var pos = 1; // 1å·¦è¾¹ï¼Œ2å³è¾¹ // å‡½æ•°èŠ‚æµé” var lock = true; // äº‹ä»¶ç›‘å¬ btn.onclick = function () { // é¦–å…ˆæ£€æŸ¥é”æ˜¯å¦æ˜¯å…³é—­ if (!lock) return; // æŠŠè¿‡æ¸¡åŠ ä¸Š box.style.transition = \u0026#39;all 2s linear 0s\u0026#39;; if (pos == 1) { // ç¬é—´ç§»åŠ¨ï¼Œä½†æ˜¯ç”±äºæœ‰è¿‡æ¸¡ï¼Œæ‰€ä»¥æ˜¯åŠ¨ç”» box.style.left = \u0026#39;1100px\u0026#39;; pos = 2; } else if (pos == 2) { // ç¬é—´ç§»åŠ¨ï¼Œä½†æ˜¯ç”±äºæœ‰è¿‡æ¸¡ï¼Œæ‰€ä»¥æ˜¯åŠ¨ç”» box.style.left = \u0026#39;100px\u0026#39;; pos = 1; } // å…³é” lock = false; // æŒ‡å®šæ—¶é—´åï¼Œå°†é”æ‰“å¼€ setTimeout(function () { lock = true; }, 2000); }; \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; åäº”ã€å¸¸è§åŠ¨ç”»åˆ¶ä½œ\n15.1 åŠ¨ç”»æ•ˆæœå¼€å‘1-æ— ç¼è¿ç»­æ»šåŠ¨ç‰¹æ•ˆ\nåŸç†:\nä»£ç ï¼š\næ­¤åŠ¨ç”»åˆ©ç”¨å®šæ—¶å™¨åè€Œæ¯” JS + CSS3 æ›´æ–¹ä¾¿ã€‚\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Document\u0026lt;/title\u0026gt; \u0026lt;style\u0026gt; * { margin: 0; padding: 0; } .box { width: 1000px; height: 130px; border: 1px solid #000; margin: 50px auto; overflow: hidden; } .box ul { list-style: none; /* è®¾ç½®å¤§ä¸€ç‚¹ï¼Œè¿™æ ·liæ‰èƒ½æµ®åŠ¨ */ width: 5000px; position: relative; } .box ul li { float: left; margin-right: 10px; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div id=\u0026#34;box\u0026#34; class=\u0026#34;box\u0026#34;\u0026gt; \u0026lt;ul id=\u0026#34;list\u0026#34;\u0026gt; \u0026lt;li\u0026gt;\u0026lt;img src=\u0026#34;images/number/0.png\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;img src=\u0026#34;images/number/1.png\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;img src=\u0026#34;images/number/2.png\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;img src=\u0026#34;images/number/3.png\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;img src=\u0026#34;images/number/4.png\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;img src=\u0026#34;images/number/5.png\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; var box = document.getElementById(\u0026#39;box\u0026#39;); var list = document.getElementById(\u0026#39;list\u0026#39;); // å¤åˆ¶å¤šä¸€éæ‰€æœ‰çš„li list.innerHTML += list.innerHTML; // å…¨å±€å˜é‡ï¼Œè¡¨ç¤ºå½“å‰listçš„leftå€¼ var left = 0; // å®šæ—¶å™¨ï¼Œå…¨å±€å˜é‡ var timer; move(); // åŠ¨ç”»å°è£…æˆå‡½æ•° function move() { // è®¾è¡¨å…ˆå…³ï¼Œé˜²æ­¢åŠ¨ç”»ç§¯ç´¯ clearInterval(timer); timer = setInterval(function () { left -= 4; // éªŒæ”¶ if (left \u0026lt;= -1260) { left = 0; } list.style.left = left + \u0026#39;px\u0026#39;; }, 20); } // é¼ æ ‡è¿›å…¥åœæ­¢å®šæ—¶å™¨ box.onmouseenter = function () { clearInterval(timer); }; // é¼ æ ‡ç¦»å¼€ç»§ç»­å®šæ—¶å™¨ box.onmouseleave = function () { move(); }; \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; 15.2 åŠ¨ç”»æ•ˆæœå¼€å‘2-è·‘é©¬ç¯è½®æ’­å›¾ç‰¹æ•ˆ\nè·‘é©¬ç¯è½®æ’­å›¾ï¼Œåˆå«ï¼šæ»‘åŠ¨è½®æ’­å›¾ã€‚æ­¤ç§è½®æ’­å›¾éœ€è¦å°†å›¾ç‰‡æ’æˆä¸€è¡Œï¼Œå¹¶åœ¨æœ€åä¸€å¼ å›¾ç‰‡åå…‹éš†ä¸€ä»½ç¬¬ä¸€å¼ å›¾ç‰‡ï¼ˆå½“åˆ°è¾¾æœ€åä¸€å¼ æ—¶ï¼Œå®ç°ç¬é—´è½®å›æ•ˆæœï¼‰ã€‚\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Document\u0026lt;/title\u0026gt; \u0026lt;style\u0026gt; * { margin: 0; padding: 0; } .carousel { width: 650px; height: 360px; border: 1px solid #000; margin: 50px auto; position: relative; overflow: hidden; } .carousel ul { list-style: none; width: 6000px; position: relative; left: 0px; transition: left .5s ease 0s; } .carousel ul li { float: left; } .carousel .leftbtn { position: absolute; left: 20px; top: 50%; margin-top: -25px; width: 50px; height: 50px; background-color: rgb(28, 180, 226); border-radius: 50%; } .carousel .rightbtn { position: absolute; right: 20px; top: 50%; margin-top: -25px; width: 50px; height: 50px; background-color: rgb(28, 180, 226); border-radius: 50%; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;carousel\u0026#34;\u0026gt; \u0026lt;ul id=\u0026#34;list\u0026#34;\u0026gt; \u0026lt;li\u0026gt;\u0026lt;img src=\u0026#34;images/beijing/0.jpg\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;img src=\u0026#34;images/beijing/1.jpg\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;img src=\u0026#34;images/beijing/2.jpg\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;img src=\u0026#34;images/beijing/3.jpg\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;img src=\u0026#34;images/beijing/4.jpg\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;a href=\u0026#34;javascript:;\u0026#34; class=\u0026#34;leftbtn\u0026#34; id=\u0026#34;leftbtn\u0026#34;\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;javascript:;\u0026#34; class=\u0026#34;rightbtn\u0026#34; id=\u0026#34;rightbtn\u0026#34;\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; // å¾—åˆ°æŒ‰é’®å’Œulï¼Œulæ•´ä½“è¿›è¡Œè¿åŠ¨ var leftbtn = document.getElementById(\u0026#39;leftbtn\u0026#39;); var rightbtn = document.getElementById(\u0026#39;rightbtn\u0026#39;); var list = document.getElementById(\u0026#39;list\u0026#39;); // å…‹éš†ç¬¬ä¸€å¼ å›¾ç‰‡ var cloneli = list.firstElementChild.cloneNode(true); // è®°å¾—è¦å†™trueï¼Œä¸ç„¶å°±åªä¼šå…‹éš†liè€Œä¸ä¼šå…‹éš†img list.appendChild(cloneli); // å½“å‰ulæ˜¾ç¤ºåˆ°ç¬¬å‡ å¼ äº†ï¼Œä»0å¼€å§‹æ•° var idx = 0; // èŠ‚æµé” var lock = true; // å³è¾¹æŒ‰é’®ç›‘å¬ rightbtn.onclick = function () { // åˆ¤æ–­é”çš„çŠ¶æ€ if (!lock) return; lock = false; // ç»™liståŠ è¿‡æ¸¡ï¼Œä¸ºä»€ä¹ˆè¦åŠ ï¼Ÿï¼Ÿcssä¸­ä¸æ˜¯å·²ç»åŠ äº†ä¹ˆï¼Ÿï¼Ÿè¿™æ˜¯å› ä¸ºæœ€åä¸€å¼ å›¾ç‰‡ä¼šæŠŠè¿‡æ¸¡å»æ‰ list.style.transition = \u0026#39;left .5s ease 0s\u0026#39;; idx++; if (idx \u0026gt; 4) { // è®¾ç½®ä¸€ä¸ªå»¶æ—¶å™¨ï¼Œå»¶æ—¶å™¨çš„åŠŸèƒ½å°±æ˜¯å°†ulç¬é—´æ‹‰å›0çš„ä½ç½®ï¼Œå»¶æ—¶å™¨çš„ç›®çš„å°±æ˜¯è®©è¿‡æ¸¡åŠ¨ç”»ç»“æŸä¹‹å setTimeout(function () { // å–æ¶ˆæ‰è¿‡æ¸¡ï¼Œå› ä¸ºè¦çš„æ˜¯ç¬é—´ç§»åŠ¨ï¼Œä¸æ˜¯â€œå’•å™œâ€å›å» list.style.transition = \u0026#39;none\u0026#39;; list.style.left = 0; idx = 0; }, 500); } list.style.left = -idx * 650 + \u0026#39;px\u0026#39;; // å‡½æ•°èŠ‚æµ setTimeout(function () { lock = true; }, 500); } // å·¦è¾¹æŒ‰é’®ç›‘å¬ leftbtn.onclick = function () { if (!lock) return; lock = false; // åˆ¤æ–­æ˜¯ä¸æ˜¯ç¬¬0å¼ ï¼Œå¦‚æœæ˜¯ï¼Œå°±è¦ç¬é—´ç”¨å‡çš„æ›¿æ¢çœŸçš„ if (idx == 0) { // å–æ¶ˆæ‰è¿‡æ¸¡ï¼Œå› ä¸ºè¦çš„æ˜¯ç¬é—´ç§»åŠ¨ï¼Œä¸æ˜¯â€œå’•å™œâ€è¿‡å» list.style.transition = \u0026#39;none\u0026#39;; // ç›´æ¥ç¬é—´ç§»åŠ¨åˆ°æœ€åçš„å‡å›¾ç‰‡ä¸Š list.style.left = -5 * 650 + \u0026#39;px\u0026#39;; // è®¾ç½®ä¸€ä¸ªå»¶æ—¶å™¨ï¼Œè¿™ä¸ªå»¶æ—¶å™¨çš„å»¶æ—¶æ—¶é—´å¯ä»¥æ˜¯0æ¯«ç§’ï¼Œè™½ç„¶æ˜¯0æ¯«ç§’ï¼Œä½†æ˜¯å¯ä»¥è®©æˆ‘ä»¬è¿‡æ¸¡å…ˆæ˜¯ç¬é—´å–æ¶ˆï¼Œç„¶åå†åŠ ä¸Š setTimeout(function () { // åŠ è¿‡æ¸¡ list.style.transition = \u0026#39;left .5s ease 0s\u0026#39;; // idxæ”¹ä¸ºçœŸæ­£çš„æœ€åä¸€å¼  idx = 4; list.style.left = -idx * 650 + \u0026#39;px\u0026#39;; }, 0); } else { idx--; list.style.left = -idx * 650 + \u0026#39;px\u0026#39;; } // å‡½æ•°èŠ‚æµ setTimeout(function () { lock = true; }, 500); } \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; åŸç†ï¼š\n15.3 åŠ¨ç”»æ•ˆæœå¼€å‘3-å‘¼å¸ç¯è½®æ’­å›¾ç‰¹æ•ˆ\nå‘¼å¸ç¯è½®æ’­å›¾ï¼Œåˆå«ï¼šæ·¡å…¥æ·¡å‡ºè½®æ’­å›¾ã€‚æ­¤ç§è½®æ’­å›¾éœ€è¦å°†å›¾ç‰‡å åˆ°ä¸€èµ·ã€‚\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Document\u0026lt;/title\u0026gt; \u0026lt;style\u0026gt; * { margin: 0; padding: 0; } .carousel { width: 650px; height: 360px; border: 1px solid #000; margin: 50px auto; position: relative; } .carousel ul { list-style: none; } .carousel ul li { position: absolute; top: 0; left: 0; /* é€æ˜åº¦éƒ½æ˜¯0 */ opacity: 0; transition: opacity 1s ease 0s; } /* åªæœ‰ç¬¬ä¸€å¼ é€æ˜åº¦æ˜¯1 */ .carousel ul li:first-child { opacity: 1; } .carousel .leftbtn { position: absolute; left: 20px; top: 50%; margin-top: -25px; width: 50px; height: 50px; background-color: rgb(28, 180, 226); border-radius: 50%; } .carousel .rightbtn { position: absolute; right: 20px; top: 50%; margin-top: -25px; width: 50px; height: 50px; background-color: rgb(28, 180, 226); border-radius: 50%; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;carousel\u0026#34;\u0026gt; \u0026lt;ul id=\u0026#34;list\u0026#34;\u0026gt; \u0026lt;li\u0026gt;\u0026lt;img src=\u0026#34;images/beijing/0.jpg\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;img src=\u0026#34;images/beijing/1.jpg\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;img src=\u0026#34;images/beijing/2.jpg\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;img src=\u0026#34;images/beijing/3.jpg\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;img src=\u0026#34;images/beijing/4.jpg\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;a href=\u0026#34;javascript:;\u0026#34; class=\u0026#34;leftbtn\u0026#34; id=\u0026#34;leftbtn\u0026#34;\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;javascript:;\u0026#34; class=\u0026#34;rightbtn\u0026#34; id=\u0026#34;rightbtn\u0026#34;\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; // å¾—åˆ°æŒ‰é’®å’Œulï¼Œulæ•´ä½“è¿›è¡Œè¿åŠ¨ var leftbtn = document.getElementById(\u0026#39;leftbtn\u0026#39;); var rightbtn = document.getElementById(\u0026#39;rightbtn\u0026#39;); var list = document.getElementById(\u0026#39;list\u0026#39;); var lis = list.getElementsByTagName(\u0026#39;li\u0026#39;); // å½“å‰æ˜¯ç¬¬å‡ å¼ å›¾æ˜¾ç¤º var idx = 0; // èŠ‚æµ var lock = true; // å³æŒ‰é’® rightbtn.onclick = function () { // åˆ¤æ–­èŠ‚æµ if (!lock) return; lock = false; // è¿˜æ²¡æœ‰æ”¹idxï¼Œæ­¤æ—¶çš„idxè¿™ä¸ªå›¾ç‰‡å°±æ˜¯è€å›¾ï¼Œè€å›¾æ·¡å‡º lis[idx].style.opacity = 0; idx++; if (idx \u0026gt; 4) idx = 0; // æ”¹äº†idxï¼Œæ­¤æ—¶çš„idxè¿™ä¸ªå›¾ç‰‡å°±æ˜¯æ–°å›¾ï¼Œæ–°å›¾æ·¡å…¥ lis[idx].style.opacity = 1; // åŠ¨ç”»ç»“æŸä¹‹åï¼Œå¼€é” setTimeout(function () { lock = true; }, 1000); } // å·¦æŒ‰é’® leftbtn.onclick = function () { // åˆ¤æ–­èŠ‚æµ if (!lock) return; lock = false; // è¿˜æ²¡æœ‰æ”¹idxï¼Œæ­¤æ—¶çš„idxè¿™ä¸ªå›¾ç‰‡å°±æ˜¯è€å›¾ï¼Œè€å›¾æ·¡å‡º lis[idx].style.opacity = 0; idx--; if (idx \u0026lt; 0) idx = 4; // æ”¹äº†idxï¼Œæ­¤æ—¶çš„idxè¿™ä¸ªå›¾ç‰‡å°±æ˜¯æ–°å›¾ï¼Œæ–°å›¾æ·¡å…¥ lis[idx].style.opacity = 1; // åŠ¨ç”»ç»“æŸä¹‹åï¼Œå¼€é” setTimeout(function () { lock = true; }, 1000); } \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; å£°æ˜ ä½œç”¨åŸŸ å‡½æ•°ä½œç”¨åŸŸ ES5 ä¸­è§„å®šï¼ŒJS æ˜¯ å‡½æ•°çº§ä½œç”¨åŸŸ ç¼–ç¨‹è¯­è¨€ï¼Œå˜é‡åªåœ¨å…¶æ‰€å®šä¹‰æ—¶æ‰€åœ¨çš„ function å†…éƒ¨æœ‰æ„ä¹‰ã€‚\n:memo: Note JS ä¸­ ifã€switchã€forã€whileâ€¦â€¦ç­‰ () åŠ {} ä¸­çš„å˜é‡éƒ½ä¸å±äº å±€éƒ¨å˜é‡ ï¼Œè€Œæ˜¯ å¤–å±‚å‡½æ•°å±€éƒ¨å˜é‡ï¼Œå¦‚æœæ²¡æœ‰å¤–å±‚å‡½æ•°ï¼Œé‚£ä¹ˆå°±æ˜¯å…¨å±€å˜é‡ã€‚\n:page_with_curl: Example 1 {} å¤§æ‹¬å·\n{ var a =3; console.log(a); // 3 } console.log(a); // 3 // ES5ä¸­ä¸å­˜åœ¨çœŸæ­£çš„å—çº§ä½œç”¨åŸŸï¼Œå†…éƒ¨æ•°æ®ç›´æ¥æ³„æ¼ :page_with_curl: Example 2 for å¾ªç¯æ³„æ¼\nvar a = []; for(var i=0;i\u0026lt;10;i++){ a.push(function(){ console.log(i); }); } a[0](); //é¢„æœŸç»“æœæ˜¯0ï¼Œå®é™…ç»“æœæ˜¯10 å‡ºç°ä¸Šè¿°ç°è±¡çš„ä¸»è¦åŸå› æ˜¯ä½¿ç”¨ var å®šä¹‰çš„å˜é‡ i æ˜¯ä¸€ä¸ª å…¨å±€å˜é‡ ï¼Œå¯¼è‡´çœŸæ­£åœ¨è°ƒç”¨çš„æ—¶å€™è™½ç„¶å¾ªç¯äº† 10 æ¬¡ï¼Œå¯æ˜¯æœ€ç»ˆåæ¬¡éƒ½æ˜¯åªä¿®æ”¹äº†å…¨å±€å˜é‡ i ï¼Œå¹¶æ²¡æœ‰åŒºåˆ†å‡ºç§æœ‰ä½œç”¨åŸŸã€‚\nè‹¥æƒ³è¦åœ¨ ES5 çš„æ¡†æ¶ä¸‹è§£å†³ä½œç”¨åŸŸçš„é—®é¢˜ï¼Œåˆ™å¯ä»¥å¼•å…¥ é—­åŒ…Closure ï¼Œé€šè¿‡ å‡½æ•°ä½œç”¨åŸŸ åˆ›é€ ä¼ª å—çº§ä½œç”¨åŸŸ ï¼š\n:page_with_curl: Example 1\nvar a = []; for(var i=0;i\u0026lt;10;i++){ a.push((function($i){ function k(){ // åˆ›å»ºå‡½æ•°é—­åŒ… // $iæ˜¯è¯¥åŒ¿åå‡½æ•°çš„å…¥å‚ï¼Œç­‰åŒä¸‹é¢çš„i // æ¯è¿è¡Œä¸€æ¬¡$iå°±ä¿å­˜äºé—­åŒ…å‡½æ•°ä½œç”¨åŸŸä¸­ä¸€æ¬¡ // å› æ­¤é—­åŒ…ä¹Ÿå®¹æ˜“äº§ç”Ÿå†…å­˜æ³„æ¼ console.log($i); } return k; // å‡½æ•°Aå†…éƒ¨å£°æ˜äº†å‡½æ•°B // å‡½æ•°Bå¼•ç”¨äº†å‡½æ•°Bä¹‹å¤–çš„å˜é‡ // å‡½æ•°Açš„è¿”å›å€¼ä¸ºå‡½æ•°Bçš„å¼•ç”¨ // é‚£ä¹ˆå‡½æ•°Bå°±æ˜¯é—­åŒ…å‡½æ•° })(i)); } a[0](); //ç»“æœä¸º0 :warning: Caution å¦‚æœES5 var é—­åŒ…ä¸é€šè¿‡ å‚æ•°ä¼ é€’ çš„æ–¹å¼åˆ›å»º ç§æœ‰ä½œç”¨åŸŸï¼Œé‚£ä¹Ÿå¯ä»¥é€šè¿‡ å†…éƒ¨å®šä¹‰å˜é‡ çš„æ–¹å¼æ¥ä»£æ›¿ã€‚\nè‹¥æ˜¯ ç›´æ¥å¼•ç”¨å¤–éƒ¨å˜é‡ åˆ›å»ºï¼Œåˆ™åªæ˜¯å¤åˆ¶äº†æŒ‡å‘å¤–éƒ¨å˜é‡çš„ æŒ‡é’ˆ ï¼Œè€Œä¸èƒ½èµ·åˆ°éš”ç¦»å˜é‡çš„ä½œç”¨ã€‚\n:page_with_curl: Example 2\nvar a = []; for (var i = 0; i \u0026lt; 10; i++) { a.push((function () { function k() { console.log(i); // é—­åŒ…ä¸­è‹¥ä¸æ˜¯é€šè¿‡ä¼ å‚èµ‹å€¼ï¼ˆå¤åˆ¶\u0026amp;ä¿å­˜ï¼‰ // è€Œæ˜¯ç›´æ¥å¼•ç”¨å¤–éƒ¨å˜é‡ï¼Œåˆ™å˜é‡å¹¶ä¸ä¼šåœ¨é—­åŒ…ä¸­ä¿å­˜ } console.log(i); // 0 1 2 3 4 5 6 7 8 9 return k; })()); } a[0](); // 10 ES5 ä¸­çš„å—çº§ä½œç”¨åŸŸæœ‰æ•ˆçš„åªæœ‰ try...catchï¼Œæ‰€ä»¥æœ‰æ—¶å€™æœ‰äº›æ¡†æ¶ä¸ºäº†åŒºåˆ† å—çº§ç§æœ‰ä½œç”¨åŸŸ å°±æ˜¯ç”¨å®ƒæ¥è§£å†³çš„ï¼Œä¾‹å¦‚ Google çš„ Traceur é¡¹ç›®ã€‚\n:page_with_curl: Example\ntry{ throw 3; }catch(e){ console.log(e); // 3 } console.log(e); // ReferenceError: e is not defined ES5 è™½ç„¶ä¸å­˜åœ¨çœŸæ­£æ„ä¹‰ä¸Šçš„å—çº§ä½œç”¨åŸŸï¼Œä½†æ˜¯å­˜åœ¨ å‡½æ•°ä½œç”¨åŸŸ ã€‚\n:page_with_curl: Example 1\nvar a = 1; function fun(){ var a = 5; console.log(a); // 5 } fun(); console.log(a); // 1 :memo: Note ä»¥ä¸Šç”Ÿæˆå‡½æ•°ä½œç”¨åŸŸçš„å†™æ³•å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ã€‚\nç”³æ˜äº†å…¨å±€çš„ å…·åå‡½æ•° fun() ï¼Œæ±¡æŸ“äº†å…¨å±€ä½œç”¨åŸŸ å¦‚æœè¦å®ç°è¿™ä¸ªç§æœ‰ä½œç”¨åŸŸï¼Œå¿…é¡»è¦å‡½æ•°è°ƒç”¨æ‰è¡Œ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¼•å…¥äº† ç«‹å³æ‰§è¡Œå‡½æ•°IIFE ã€‚å®ƒå¯ä»¥ æ— ä¼¤ åœ°åˆ›å»ºä¸€ä¸ª å—çº§ç§æœ‰ä½œç”¨åŸŸ æ›¿ä»£ ES5 çš„ ä¼ªå—çº§ä½œç”¨åŸŸ ï¼Œè¿˜æœ‰è™½ç„¶å®ƒèˆ¬ç”¨å’Œé—­åŒ…ç»“åˆä½¿ç”¨ï¼Œä½†æ³¨æ„å’Œé—­åŒ…çš„åŒºåˆ†ã€‚\n:page_with_curl: Example 2\nvar a = 1; (function (){ var a = 5; console.log(a); // 5 })(); console.log(a); // 1 ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼å¦ä¸€ä¸ªå¸¸ç”¨æŠ€å·§ï¼š\nå€’ç½®ç«‹å³æ‰§è¡Œå‡½æ•°ä»£ç çš„è¿è¡Œé¡ºåºï¼Œå°†éœ€è¦è¿è¡Œçš„å‡½æ•°æ”¾åœ¨ç¬¬äºŒä½ ()(fun(){//})ï¼Œåœ¨ç«‹å³æ‰§è¡Œå‡½æ•°æ‰§è¡Œä¹‹åå½“ä½œå‚æ•°ä¼ é€’è¿›å»ã€‚è¿™ç§æ¨¡å¼åœ¨ UMDUniversal Module Definition é¡¹ç›®ä¸­è¢«å¹¿æ³›ä½¿ç”¨ã€‚\n:page_with_curl: Example\nvar a = 2; (function IIFE(def) { def(window); })(function def(global) { var a = 3; console.log(a); // 3 console.log(global.a); //2 }); :memo: Note ä¾‹å­ä¸­å°†ä»£ç  ä¸»ä½“ æ”¾åœ¨äº† ç«‹å³æ‰§è¡Œå‡½æ•°IIFE çš„ å‚æ•° éƒ¨åˆ†ï¼Œå½“åšå‚æ•°ä¼ é€’ç»™æ‰§è¡Œå‡½æ•°ï¼Œæ‰§è¡Œå‡½æ•°çš„å†…éƒ¨åˆç«‹å³è°ƒç”¨äº†è¿™ä¸ªå‡½æ•°ï¼Œå¹¶å°†å…¨å±€çš„ window å¯¹è±¡å½“åš å®å‚ ä¼ é€’ç»™ å‚æ•°ä¸»ä½“å‡½æ•°ï¼Œå¹¶å°† å‚æ•°å†…å‡½æ•° çš„ å½¢å‚ å®šä¹‰ä¸º global æ¥è°ƒåŠ¨å…¨å±€ a å˜é‡ï¼Œè¾¾åˆ°ä¸ä¼šä¸å‚æ•°ä¸»ä½“å‡½æ•°çš„ä½œç”¨åŸŸå†²çªçš„æ•ˆæœã€‚\nå—ä½œç”¨åŸŸ ES5 ä¸­ä½œç”¨åŸŸæœ‰ï¼šå…¨å±€ä½œç”¨åŸŸã€å‡½æ•°ä½œç”¨åŸŸï¼Œæ²¡æœ‰å—ä½œç”¨åŸŸçš„æ¦‚å¿µã€‚\nES6 let æ–°å¢äº†å—çº§ä½œç”¨åŸŸã€‚ å—ä½œç”¨åŸŸ ç”± {} åŒ…æ‹¬ï¼Œif è¯­å¥å’Œ for è¯­å¥é‡Œé¢çš„ {} ä¹Ÿå±äºå—ä½œç”¨åŸŸã€‚\n{ // å¤–å±‚ä»£ç å— let n = 5; if (true) { // å†…å±‚ä»£ç å— let n = 10; } console.log(n); // 5 } ES6 å…è®¸å—çº§ä½œç”¨åŸŸçš„ä»»æ„åµŒå¥—,å†…å±‚ä½œç”¨åŸŸå¯ä»¥å®šä¹‰å¤–å±‚ä½œç”¨åŸŸçš„åŒåå˜é‡ã€‚\n{ { let insane = \u0026#39;Hello World\u0026#39;; } console.log(insane); // æŠ¥é”™; } å—çº§ä½œç”¨åŸŸçš„å‡ºç°ï¼Œå®é™…ä¸Šä½¿å¾—è·å¾—å¹¿æ³›åº”ç”¨çš„åŒ¿åç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼ï¼ˆåŒ¿å IIFEï¼‰ä¸å†å¿…è¦äº†ã€‚\n// åŒ¿åIIFEå†™æ³• (function () { var tmp = ...; ... }()); // å—çº§ä½œç”¨åŸŸå†™æ³• { let tmp = ...; ... } å‡½æ•°èƒ½ä¸èƒ½åœ¨å—çº§ä½œç”¨åŸŸä¹‹ä¸­å£°æ˜ï¼Ÿè¿™æ˜¯ä¸€ä¸ªç›¸å½“ä»¤äººæ··æ·†çš„é—®é¢˜ã€‚\nES5 è§„å®šï¼Œå‡½æ•°åªèƒ½åœ¨é¡¶å±‚ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸä¹‹ä¸­å£°æ˜ï¼Œä¸èƒ½åœ¨å—çº§ä½œç”¨åŸŸå£°æ˜ã€‚\n// æƒ…å†µä¸€ if (true) { function f() { } } // æƒ…å†µäºŒ try { function f() { } } catch (e) { // ... } ä¸Šé¢ä¸¤ç§å‡½æ•°å£°æ˜ï¼Œæ ¹æ® ES5 çš„è§„å®šéƒ½æ˜¯éæ³•çš„ã€‚\nä½†æ˜¯ï¼Œæµè§ˆå™¨æ²¡æœ‰éµå®ˆè¿™ä¸ªè§„å®šï¼Œä¸ºäº†å…¼å®¹ä»¥å‰çš„æ—§ä»£ç ï¼Œè¿˜æ˜¯æ”¯æŒåœ¨å—çº§ä½œç”¨åŸŸä¹‹ä¸­å£°æ˜å‡½æ•°ï¼Œå› æ­¤ä¸Šé¢ä¸¤ç§æƒ…å†µå®é™…éƒ½èƒ½è¿è¡Œï¼Œä¸ä¼šæŠ¥é”™ã€‚\nES6 å¼•å…¥äº†å—çº§ä½œç”¨åŸŸï¼Œæ˜ç¡®å…è®¸åœ¨å—çº§ä½œç”¨åŸŸä¹‹ä¸­å£°æ˜å‡½æ•°ã€‚ES6 è§„å®šï¼Œå—çº§ä½œç”¨åŸŸä¹‹ä¸­ï¼Œå‡½æ•°å£°æ˜è¯­å¥çš„è¡Œä¸ºç±»ä¼¼äº letï¼Œåœ¨å—çº§ä½œç”¨åŸŸä¹‹å¤–ä¸å¯å¼•ç”¨ã€‚\nfunction f() { console.log(\u0026#39;I am outside!\u0026#39;); } (function () { if (false) { // é‡å¤å£°æ˜ä¸€æ¬¡å‡½æ•°f function f() { console.log(\u0026#39;I am inside!\u0026#39;); } } f(); }()); ä¸Šé¢ä»£ç åœ¨ ES5 ä¸­è¿è¡Œï¼Œä¼šå¾—åˆ°â€œI am inside!â€ï¼Œå› ä¸ºåœ¨ if å†…å£°æ˜çš„å‡½æ•°fä¼šè¢«æå‡åˆ° å‡½æ•°å¤´éƒ¨ ï¼Œå®é™…è¿è¡Œçš„ä»£ç å¦‚ä¸‹ã€‚\n// ES5 ç¯å¢ƒ function f() { console.log(\u0026#39;I am outside!\u0026#39;); } (function () { // å‘ç”Ÿäº†å‡½æ•°æå‡ function f() { console.log(\u0026#39;I am inside!\u0026#39;); } if (false) { // ç©º } f(); }()); ES6 å°±å®Œå…¨ä¸ä¸€æ ·äº†ï¼Œç†è®ºä¸Šä¼šå¾—åˆ°â€œI am outside!â€ã€‚å› ä¸ºå—çº§ä½œç”¨åŸŸå†…å£°æ˜çš„å‡½æ•°ç±»ä¼¼äº letï¼Œå¯¹ä½œç”¨åŸŸä¹‹å¤–æ²¡æœ‰å½±å“ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ çœŸçš„åœ¨ ES6 æµè§ˆå™¨ä¸­è¿è¡Œä¸€ä¸‹ä¸Šé¢çš„ä»£ç ï¼Œæ˜¯ä¼šæŠ¥é”™çš„ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ\n// æµè§ˆå™¨çš„ ES6 ç¯å¢ƒ function f() { console.log(\u0026#39;I am outside!\u0026#39;); } (function () { if (false) { // åœ¨å†…éƒ¨å—ä½œç”¨åŸŸä¸­é‡å¤å£°æ˜ä¸€æ¬¡å‡½æ•°f function f() { console.log(\u0026#39;I am inside!\u0026#39;); } } f(); }()); // Uncaught TypeError: f is not a function ä¸Šé¢çš„ä»£ç åœ¨ ES6 æµè§ˆå™¨ä¸­ï¼Œéƒ½ä¼šæŠ¥é”™ã€‚\nåŸæ¥ï¼Œå¦‚æœæ”¹å˜äº†å—çº§ä½œç”¨åŸŸå†…å£°æ˜çš„å‡½æ•°çš„å¤„ç†è§„åˆ™ï¼Œæ˜¾ç„¶ä¼šå¯¹è€ä»£ç äº§ç”Ÿå¾ˆå¤§å½±å“ã€‚ä¸ºäº†å‡è½»å› æ­¤äº§ç”Ÿçš„ä¸å…¼å®¹é—®é¢˜ï¼ŒES6 è§„å®šï¼Œæµè§ˆå™¨çš„å®ç°å¯ä»¥ä¸éµå®ˆä¸Šé¢çš„è§„å®šï¼Œæœ‰è‡ªå·±çš„è¡Œä¸ºæ–¹å¼ã€‚\nå…è®¸åœ¨å—çº§ä½œç”¨åŸŸå†…å£°æ˜å‡½æ•°ã€‚ å‡½æ•°å£°æ˜ç±»ä¼¼äº varï¼Œå³ä¼šæå‡åˆ°å…¨å±€ä½œç”¨åŸŸæˆ–å‡½æ•°ä½œç”¨åŸŸçš„å¤´éƒ¨ã€‚ åŒæ—¶ï¼Œå‡½æ•°å£°æ˜è¿˜ä¼šæå‡åˆ°æ‰€åœ¨çš„å—çº§ä½œç”¨åŸŸçš„å¤´éƒ¨ã€‚ æ³¨æ„ï¼Œä¸Šé¢ä¸‰æ¡è§„åˆ™åªå¯¹ ES6 çš„æµè§ˆå™¨å®ç°æœ‰æ•ˆï¼Œå…¶ä»–ç¯å¢ƒçš„å®ç°ä¸ç”¨éµå®ˆï¼Œè¿˜æ˜¯å°†å—çº§ä½œç”¨åŸŸçš„å‡½æ•°å£°æ˜å½“ä½œ let å¤„ç†ã€‚\næ ¹æ®è¿™ä¸‰æ¡è§„åˆ™ï¼Œæµè§ˆå™¨çš„ ES6 ç¯å¢ƒä¸­ï¼Œå—çº§ä½œç”¨åŸŸå†…å£°æ˜çš„å‡½æ•°ï¼Œè¡Œä¸ºç±»ä¼¼äº var å£°æ˜çš„å˜é‡ã€‚ä¸Šé¢çš„ä¾‹å­å®é™…è¿è¡Œçš„ä»£ç å¦‚ä¸‹ã€‚\n// æµè§ˆå™¨çš„ ES6 ç¯å¢ƒ function f() { console.log(\u0026#39;I am outside!\u0026#39;); } (function () { var f = undefined; if (false) { function f() { console.log(\u0026#39;I am inside!\u0026#39;); } } f(); }()); // Uncaught TypeError: f is not a function è€ƒè™‘åˆ°ç¯å¢ƒå¯¼è‡´çš„è¡Œä¸ºå·®å¼‚å¤ªå¤§ï¼Œåº”è¯¥ é¿å… åœ¨å—çº§ä½œç”¨åŸŸå†…å£°æ˜å‡½æ•°ã€‚å¦‚æœç¡®å®éœ€è¦ï¼Œä¹Ÿåº”è¯¥å†™æˆ å‡½æ•°è¡¨è¾¾å¼ ï¼Œè€Œä¸æ˜¯å‡½æ•°å£°æ˜è¯­å¥ã€‚\nlet fun = () =\u0026gt; {}; // Anonymous function // å®Œå…¨éµä»letå˜é‡çš„è¡Œä¸ºï¼Œå¦åˆ™åœ¨æŸäº›æµè§ˆå™¨ä¸­ä¼šè¢«è§£æä¸ºvar // å—çº§ä½œç”¨åŸŸå†…éƒ¨çš„å‡½æ•°å£°æ˜è¯­å¥ï¼Œå»ºè®®ä¸è¦ä½¿ç”¨ { let a = \u0026#39;secret\u0026#39;; function f() { return a; } } // å—çº§ä½œç”¨åŸŸå†…éƒ¨ï¼Œä¼˜å…ˆä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼ { let a = \u0026#39;secret\u0026#39;; let f = function () { return a; }; } å¦å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ã€‚ES6 çš„å—çº§ä½œç”¨åŸŸå¿…é¡»æœ‰ å¤§æ‹¬å· ï¼Œå¦‚æœæ²¡æœ‰å¤§æ‹¬å·ï¼ŒJavaScript å¼•æ“å°±è®¤ä¸ºä¸å­˜åœ¨å—çº§ä½œç”¨åŸŸã€‚\n/* ç¬¬ä¸€ç§å†™æ³•ï¼ŒæŠ¥é”™ */ if (true) let x = 1; // SyntaxError: Lexical declaration cannot appear in a single-statement context /* ç¬¬äºŒç§å†™æ³•ï¼Œä¸æŠ¥é”™ */ if (true) { // å•ç‹¬çš„å—çº§ä½œç”¨åŸŸ let x = 1; } ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬ä¸€ç§å†™æ³•æ²¡æœ‰å¤§æ‹¬å·ï¼Œæ‰€ä»¥ä¸å­˜åœ¨å—çº§ä½œç”¨åŸŸï¼Œè€Œ let åªèƒ½å‡ºç°åœ¨å½“å‰ä½œç”¨åŸŸçš„ é¡¶å±‚ ï¼Œæ‰€ä»¥æŠ¥é”™ã€‚ç¬¬äºŒç§å†™æ³•æœ‰å¤§æ‹¬å·ï¼Œæ‰€ä»¥å—çº§ä½œç”¨åŸŸæˆç«‹ã€‚\nå‡½æ•°å£°æ˜ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå‡½æ•°åªèƒ½å£°æ˜åœ¨å½“å‰ä½œç”¨åŸŸçš„é¡¶å±‚ã€‚\n/* 1. ä½¿ç”¨å¤§æ‹¬å·åŒ…è£¹ä¸ºå—ä½œç”¨åŸŸ */ if (true) // ä¸æŠ¥é”™ \u0026#39;use strict\u0026#39;; if (true) { function f() { } } /* 2. æœªåˆ›å»ºå—ä½œç”¨åŸŸï¼ŒæŠ¥é”™ */ \u0026#39;use strict\u0026#39;; if (true) function f() { // SyntaxError: In strict mode code, functions can only be declared at top level or inside a block. } /* 3. è§£å†³æ–¹æ¡ˆï¼šå°†åŒ¿åå‡½æ•°ä¼ å¯¼ç»™letå˜é‡ */ \u0026#39;use strict\u0026#39;; if (true) { let f = function () { } } /* 4. ä¸åˆ›å»ºå—ä½œç”¨åŸŸï¼Œä»ç„¶æŠ¥é”™ */ \u0026#39;use strict\u0026#39;; if (true) let f = function () { // SyntaxError: Lexical declaration cannot appear in a single-statement context } :x: é™æ€å¸¸æ•° const å‘½ä»¤\nåŸºæœ¬ç”¨æ³• constå£°æ˜ä¸€ä¸ªåªè¯»çš„å¸¸é‡ã€‚ä¸€æ—¦å£°æ˜ï¼Œå¸¸é‡çš„å€¼å°±ä¸èƒ½æ”¹å˜ã€‚\nconst PI = 3.1415; PI // 3.1415 PI = 3; // TypeError: Assignment to constant variable. ä¸Šé¢ä»£ç è¡¨æ˜æ”¹å˜å¸¸é‡çš„å€¼ä¼šæŠ¥é”™ã€‚\nconstå£°æ˜çš„å˜é‡ä¸å¾—æ”¹å˜å€¼ï¼Œè¿™æ„å‘³ç€ï¼Œconstä¸€æ—¦å£°æ˜å˜é‡ï¼Œå°±å¿…é¡»ç«‹å³åˆå§‹åŒ–ï¼Œä¸èƒ½ç•™åˆ°ä»¥åèµ‹å€¼ã€‚\nconst foo; // SyntaxError: Missing initializer in const declaration ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¯¹äºconstæ¥è¯´ï¼Œåªå£°æ˜ä¸èµ‹å€¼ï¼Œå°±ä¼šæŠ¥é”™ã€‚\nconstçš„ä½œç”¨åŸŸä¸letå‘½ä»¤ç›¸åŒï¼šåªåœ¨å£°æ˜æ‰€åœ¨çš„å—çº§ä½œç”¨åŸŸå†…æœ‰æ•ˆã€‚\nif (true) { const MAX = 5; } MAX // Uncaught ReferenceError: MAX is not defined constå‘½ä»¤å£°æ˜çš„å¸¸é‡ä¹Ÿæ˜¯ä¸æå‡ï¼ŒåŒæ ·å­˜åœ¨æš‚æ—¶æ€§æ­»åŒºï¼Œåªèƒ½åœ¨å£°æ˜çš„ä½ç½®åé¢ä½¿ç”¨ã€‚\nif (true) { console.log(MAX); // ReferenceError const MAX = 5; } ä¸Šé¢ä»£ç åœ¨å¸¸é‡MAXå£°æ˜ä¹‹å‰å°±è°ƒç”¨ï¼Œç»“æœæŠ¥é”™ã€‚\nconstå£°æ˜çš„å¸¸é‡ï¼Œä¹Ÿä¸letä¸€æ ·ä¸å¯é‡å¤å£°æ˜ã€‚\nvar message = \u0026#34;Hello!\u0026#34;; let age = 25; // ä»¥ä¸‹ä¸¤è¡Œéƒ½ä¼šæŠ¥é”™ const message = \u0026#34;Goodbye!\u0026#34;; const age = 30; æœ¬è´¨ constå®é™…ä¸Šä¿è¯çš„ï¼Œå¹¶ä¸æ˜¯å˜é‡çš„å€¼ä¸å¾—æ”¹åŠ¨ï¼Œè€Œæ˜¯å˜é‡æŒ‡å‘çš„é‚£ä¸ªå†…å­˜åœ°å€æ‰€ä¿å­˜çš„æ•°æ®ä¸å¾—æ”¹åŠ¨ã€‚å¯¹äºç®€å•ç±»å‹çš„æ•°æ®ï¼ˆæ•°å€¼ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ï¼‰ï¼Œå€¼å°±ä¿å­˜åœ¨å˜é‡æŒ‡å‘çš„é‚£ä¸ªå†…å­˜åœ°å€ï¼Œå› æ­¤ç­‰åŒäºå¸¸é‡ã€‚ä½†å¯¹äºå¤åˆç±»å‹çš„æ•°æ®ï¼ˆä¸»è¦æ˜¯å¯¹è±¡å’Œæ•°ç»„ï¼‰ï¼Œå˜é‡æŒ‡å‘çš„å†…å­˜åœ°å€ï¼Œä¿å­˜çš„åªæ˜¯ä¸€ä¸ªæŒ‡å‘å®é™…æ•°æ®çš„æŒ‡é’ˆï¼Œconståªèƒ½ä¿è¯è¿™ä¸ªæŒ‡é’ˆæ˜¯å›ºå®šçš„ï¼ˆå³æ€»æ˜¯æŒ‡å‘å¦ä¸€ä¸ªå›ºå®šçš„åœ°å€ï¼‰ï¼Œè‡³äºå®ƒæŒ‡å‘çš„æ•°æ®ç»“æ„æ˜¯ä¸æ˜¯å¯å˜çš„ï¼Œå°±å®Œå…¨ä¸èƒ½æ§åˆ¶äº†ã€‚å› æ­¤ï¼Œå°†ä¸€ä¸ªå¯¹è±¡å£°æ˜ä¸ºå¸¸é‡å¿…é¡»éå¸¸å°å¿ƒã€‚\nconst foo = {}; // ä¸º foo æ·»åŠ ä¸€ä¸ªå±æ€§ï¼Œå¯ä»¥æˆåŠŸ foo.prop = 123; foo.prop // 123 // å°† foo æŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¼šæŠ¥é”™ foo = {}; // TypeError: \u0026#34;foo\u0026#34; is read-only ä¸Šé¢ä»£ç ä¸­ï¼Œå¸¸é‡fooå‚¨å­˜çš„æ˜¯ä¸€ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ã€‚ä¸å¯å˜çš„åªæ˜¯è¿™ä¸ªåœ°å€ï¼Œå³ä¸èƒ½æŠŠfooæŒ‡å‘å¦ä¸€ä¸ªåœ°å€ï¼Œä½†å¯¹è±¡æœ¬èº«æ˜¯å¯å˜çš„ï¼Œæ‰€ä»¥ä¾ç„¶å¯ä»¥ä¸ºå…¶æ·»åŠ æ–°å±æ€§ã€‚\nä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚\nconst a = []; a.push(\u0026#39;Hello\u0026#39;); // å¯æ‰§è¡Œ a.length = 0; // å¯æ‰§è¡Œ a = [\u0026#39;Dave\u0026#39;]; // æŠ¥é”™ ä¸Šé¢ä»£ç ä¸­ï¼Œå¸¸é‡aæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„æœ¬èº«æ˜¯å¯å†™çš„ï¼Œä½†æ˜¯å¦‚æœå°†å¦ä¸€ä¸ªæ•°ç»„èµ‹å€¼ç»™aï¼Œå°±ä¼šæŠ¥é”™ã€‚\nå¦‚æœçœŸçš„æƒ³å°†å¯¹è±¡å†»ç»“ï¼Œåº”è¯¥ä½¿ç”¨Object.freezeæ–¹æ³•ã€‚\nconst foo = Object.freeze({}); // å¸¸è§„æ¨¡å¼æ—¶ï¼Œä¸‹é¢ä¸€è¡Œä¸èµ·ä½œç”¨ï¼› // ä¸¥æ ¼æ¨¡å¼æ—¶ï¼Œè¯¥è¡Œä¼šæŠ¥é”™ foo.prop = 123; ä¸Šé¢ä»£ç ä¸­ï¼Œå¸¸é‡fooæŒ‡å‘ä¸€ä¸ªå†»ç»“çš„å¯¹è±¡ï¼Œæ‰€ä»¥æ·»åŠ æ–°å±æ€§ä¸èµ·ä½œç”¨ï¼Œä¸¥æ ¼æ¨¡å¼æ—¶è¿˜ä¼šæŠ¥é”™ã€‚\né™¤äº†å°†å¯¹è±¡æœ¬èº«å†»ç»“ï¼Œå¯¹è±¡çš„å±æ€§ä¹Ÿåº”è¯¥å†»ç»“ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå°†å¯¹è±¡å½»åº•å†»ç»“çš„å‡½æ•°ã€‚\nvar constantize = (obj) =\u0026gt; { Object.freeze(obj); Object.keys(obj).forEach( (key, i) =\u0026gt; { if ( typeof obj[key] === \u0026#39;object\u0026#39; ) { constantize( obj[key] ); } }); }; å…ˆä½¿ç”¨åå£°æ˜ å˜é‡ é ä¸¥æ ¼æ¨¡å¼ ä¸‹ï¼Œå¯ä»¥æå‰ä½¿ç”¨ä¸€ä¸ªç¨åæ‰å£°æ˜çš„å˜é‡ï¼Œè€Œä¸ä¼šå¼•å‘å¼‚å¸¸ï¼šåœ¨æ‰§è¡Œæ‰€æœ‰ä»£ç å‰ï¼ŒJS æœ‰ é¢„è§£æ é˜¶æ®µï¼Œä¼šé¢„è¯»æ‰€æœ‰å˜é‡çš„å®šä¹‰ã€‚\n/* :memo: NOTE: å˜é‡å£°æ˜æå‡çš„åªæ˜¯å®šä¹‰è€Œéå€¼ */ /* å…ˆä½¿ç”¨å˜é‡ */ console.log(a);\t// undefined var a = 10; /* åå®šä¹‰å˜é‡ */ console.log(a);\t// 10 å®é™…çš„æƒ…å†µç›¸å½“äºï¼š\n/* é¢„è§£æé˜¶æ®µæŠŠæ‰€æœ‰å˜é‡æå‰ */ var a; console.log(a); // undefined a = 10; console.log(a); // 10 ä½¿ç”¨ let åæŠ¥é”™ï¼šå¿…é¡»å…ˆå£°æ˜åä½¿ç”¨ã€‚\n-\u0026gt; console.log(a);\t// æŠ¥é”™ let a = 10; console.log(a); \u0026gt;\u0026gt; ReferenceError: Cannot access \u0026#39;a\u0026#39; before initialization //Node.js \u0026gt;\u0026gt; Uncaught ReferenceError: a is not defined //Chrome å‡½æ•° å£°æ˜ å’Œ å˜é‡å£°æ˜ æå‡ç±»ä¼¼ï¼Œå‡½æ•°å£°æ˜ ä¹Ÿå¯ä»¥è¢«æå‡ã€‚æ‰€æœ‰è¿‡ç¨‹åœ¨é¢„è§£æé˜¶æ®µè¿›è¡Œã€‚\nfun(); // åœ¨é¢„è§£æé˜¶æ®µä¼šè¢«æå‡ function fun() { console.log(\u0026#34;å‡½æ•°è¢«æ‰§è¡Œ\u0026#34;); } æ•ˆæœç›¸å½“äºï¼š\nfunction fun() { console.log(\u0026#34;å‡½æ•°è¢«æ‰§è¡Œ\u0026#34;); } fun(); å‡½æ•°è¡¨è¾¾å¼ ä¸èƒ½è¢«æå‡ã€‚\nfun();\t// æŠ¥é”™ï¼ let fun = function() { console.log(\u0026#34;å‡½æ•°ä¸èƒ½è¢«æ‰§è¡Œ\u0026#34;); }; :memo: Note å‡½æ•°è¡¨è¾¾å¼ä¸èƒ½è¢«æå‡çš„æœ¬è´¨åŸå› æ˜¯å‡½æ•°è¡¨è¾¾å¼å®šä¹‰çš„å…¶å®æ˜¯ä¸ª å˜é‡ ï¼Œåªä¸è¿‡æ˜¯æŠŠå‡½æ•°èµ‹ç»™è¿™ä¸ªå˜é‡ï¼Œè€Œå˜é‡çš„æå‡åªæå‡ å®šä¹‰ ï¼Œä¸æå‡ èµ‹å€¼ ã€‚\nä¼˜å…ˆçº§ å‡½æ•°çš„æå‡ä¼˜å…ˆçº§å¤§äºå˜é‡ã€‚å› æ­¤è‹¥åœ¨å®šä¹‰å‰é¢ä½¿ç”¨åŒåçš„å‡½æ•°ï¼Œå°†ä¼šè¿è¡Œå‡½æ•°è€Œä¸æ˜¯èµ‹å€¼ç»™å˜é‡çš„åŒ¿åå‡½æ•°ã€‚\nfun(); // B var fun = function () { alert(\u0026#39;A\u0026#39;); }; function fun() { alert(\u0026#39;B\u0026#39;); } fun(); // A æ•ˆæœç›¸å½“äºï¼š\nfunction fun() { alert(\u0026#39;B\u0026#39;); } var fun; fun(); // B fun = function () { alert(\u0026#39;A\u0026#39;); }; fun(); // A DOM DOM - Document Object Model æ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼Œæ˜¯ W3C ç»„ç»‡æ¨èçš„å¤„ç†å¯æ‰©å±•æ ‡è®°è¯­è¨€çš„ æ ‡å‡†ç¼–ç¨‹æ¥å£ ã€‚é€šè¿‡ DOM æä¾›çš„æ¥å£å¯ä»¥å¯¹é¡µé¢ä¸Šçš„å„ç§å…ƒç´ è¿›è¡Œæ“ä½œã€‚\n\u0026lt;ele name=\u0026quot;name\u0026quot;\u0026gt;\u0026lt;/ele\u0026gt; Obsolete attribute. Use the id attribute instead. window.document è¡¨ç¤ºæµè§ˆå™¨çª—å£ä¸­çš„ HTML é¡µé¢ã€‚\ndocument.write() å°†å†…å®¹å†™å…¥é¡µé¢ é¡µé¢ä¸­çš„å…ƒç´ å°±æ˜¯ document é‡Œçš„æˆå‘˜ æ•´ä¸ª HTML æ–‡æ¡£å°±å¯¹åº”ä¸€ä¸ª document å¯¹è±¡ï¼Œå¯ä»¥æ“ä½œ HTML æ–‡æ¡£é‡Œæ‰€æœ‰çš„æ ‡è®°å’Œæ–‡æœ¬ã€‚\nfor (x in document) /* the same as window.document */ document.write(x + \u0026#34;\u0026lt;br/\u0026gt;\u0026#34;); èŠ‚ç‚¹æ ‘ \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;Sample Page\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt; Hello World! \u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Document\nElement: \u0026ldquo;html\u0026rdquo; Element: \u0026ldquo;head\u0026rdquo; Element: \u0026ldquo;title\u0026rdquo; Text: \u0026ldquo;Sample Page\u0026rdquo; Element: \u0026ldquo;body\u0026rdquo; Element: \u0026ldquo;p\u0026rdquo; Text: \u0026ldquo;Hello World!\u0026rdquo; graph LR d[\u0026#34;document\u0026#34;]----\u0026gt;D[\u0026#34;!DOCTYPE\u0026#34;] d----\u0026gt;h[\u0026#34;\u0026amp;lt;html\u0026amp;gt;\u0026#34;] h----\u0026gt;he[\u0026#34;\u0026amp;lt;head\u0026amp;gt;\u0026#34;] he----\u0026gt;t[\u0026#34;\u0026amp;lt;title\u0026amp;gt;\u0026#34;] t----\u0026gt;T1((Text)) he----\u0026gt;m[\u0026#34;\u0026amp;lt;meta\u0026amp;gt;\u0026#34;] m----\u0026gt;c(charset) h----\u0026gt;b[\u0026#34;\u0026amp;lt;body\u0026amp;gt;\u0026#34;] b----\u0026gt;H0[\u0026#34;\u0026amp;lt;h1\u0026amp;gt;\u0026#34;] H0----\u0026gt;T2((Text)) b----\u0026gt;div0[\u0026#34;\u0026amp;lt;div\u0026amp;gt;\u0026#34;] div0----\u0026gt;H1[\u0026#34;\u0026amp;lt;h2\u0026amp;gt;\u0026#34;] H1----\u0026gt;T3((Text)) div0----\u0026gt;img[\u0026#34;\u0026amp;lt;img\u0026amp;gt;\u0026#34;] img--\u0026gt;src(src) div0--\u0026gt;div1[\u0026#34;\u0026amp;lt;div\u0026amp;gt;\u0026#34;] div1----\u0026gt;T4((Text)) div1----\u0026gt;cls(\u0026#34;class\u0026#34;) NodeType èŠ‚ç‚¹çš„ nodeType å±æ€§å¯ä»¥æ˜¾ç¤ºè¿™ä¸ªèŠ‚ç‚¹å…·ä½“çš„ç±»å‹ã€‚\ndocument.nodeType;\t// 9\nå€¼ NodeType e..g.: 1 Node.ELEMENT_NODE Element 2 Node.ATTRIBUTE_NODE Attribute 3 Node.TEXT_NODE Text inside an Element or Attr 4 Node.CDATA_SECTION_NODE(4) \u0026lt;!CDATA[[ â€¦ ]]\u0026gt; 5 Node.ENTITY_REFERENCE_NODE 6 Node.ENTITY_NODE 7 Node.PROCESSING_INSTRUCTION_NODE \u0026lt;?xml-stylesheet â€¦ ?\u0026gt; 8 Node.COMMENT_NODE \u0026lt;!-- â€¦ --\u0026gt; 9 Node.DOCUMENT_NODE Document 10 Node.DOCUMENT_TYPE_NODE \u0026lt;!DOCTYPE html\u0026gt; 11 Node.DOCUMENT_FRAGMENT_NODE DocumentFragment 12 Node.NOTATION_NODE Document è®¿é—®å…ƒç´ èŠ‚ç‚¹ä¸»è¦ä¾é  document å¯¹è±¡ã€‚\ndocument å¯¹è±¡æ˜¯ DOM ä¸­æœ€é‡è¦çš„ä¸œè¥¿ï¼Œå‡ ä¹æ‰€æœ‰ DOM çš„åŠŸèƒ½éƒ½å°è£…åœ¨äº† document å¯¹è±¡ä¸­ã€‚\ndocument å¯¹è±¡ä¹Ÿè¡¨ç¤ºæ•´ä¸ª HTML æ–‡æ¡£ï¼Œå®ƒæ˜¯ DOM èŠ‚ç‚¹æ ‘çš„æ ¹ã€‚\ndocument å¯¹è±¡çš„ nodeType å±æ€§å€¼æ˜¯ 9ã€‚\ntypeof document;\t// object document.nodeType;\t// 9 è®¿é—®èŠ‚ç‚¹ æ³¨æ„ï¼šä»¥ä¸‹æ–¹æ³•çš„å‚æ•°éƒ½æ˜¯å­—ç¬¦ä¸²å€¼ ''ã€‚\næ–¹æ³• åŠŸèƒ½ å…¼å®¹æ€§ document.getElementById() é€šè¿‡ id å¾—åˆ°å…ƒç´  IE 6 document.getElementsByTagName() é€šè¿‡æ ‡ç­¾åå¾—åˆ°å…ƒç´ æ•°ç»„ IE 6 document.getElementsByClassName() é€šè¿‡ç±»åå¾—åˆ°å…ƒç´ æ•°ç»„ IE 9 document.querySelector() é€šè¿‡é€‰æ‹©å™¨å¾—åˆ°ç¬¬ä¸€ä¸ªå…ƒç´  IE 8 éƒ¨åˆ†å…¼å®¹ã€IE 9 å®Œå…¨å…¼å®¹ document.querySelectorAll() é€šè¿‡é€‰æ‹©å™¨å¾—åˆ°å…ƒç´ æ•°ç»„ IE 8 éƒ¨åˆ†å…¼å®¹ã€IE 9 å®Œå…¨å…¼å®¹ è¿”å›æ•°ç»„çš„æ–¹æ³•ä¸­ï¼Œå³ä½¿è¿”å›å…ƒç´ åªæœ‰ä¸€ä¸ªï¼Œä¹Ÿå°†å¾—åˆ°åªæœ‰ä¸€ä¸ªå…ƒç´ çš„æ•°ç»„ã€‚\n:memo: Note\nquerySelector() æ–¹æ³•åªèƒ½å¾—åˆ°é¡µé¢ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœæœ‰å¤šä¸ªå…ƒç´ ç¬¦åˆæ¡ä»¶ï¼Œåˆ™åªèƒ½å¾—åˆ° ç¬¬ä¸€ä¸ª å…ƒç´ \nquerySelector() æ–¹æ³•ä» IE8 å¼€å§‹å…¼å®¹ï¼Œä½†ä» IE9 å¼€å§‹æ”¯æŒ CSS3 çš„é€‰æ‹©å™¨ï¼Œå¦‚ï¼šnth-child()ã€:[src^='dog'] ç­‰ CSS3 é€‰æ‹©å™¨å½¢å¼éƒ½æ”¯æŒè‰¯å¥½\nä¸èƒ½é€‰æ‹© ä¼ªç±»\nå»¶è¿Ÿè¿è¡Œ åœ¨æµ‹è¯• DOM ä»£ç æ—¶ï¼Œé€šå¸¸ JS ä»£ç è¦å†™åˆ° HTML èŠ‚ç‚¹çš„åé¢ï¼Œå¦åˆ™ JS æ— æ³•æ‰¾åˆ°ç›¸åº”çš„ HTML èŠ‚ç‚¹ã€‚\nå½“ç„¶ï¼Œå¯ä»¥ä½¿ç”¨ window.onload = function(){} äº‹ä»¶ï¼Œä½¿é¡µé¢ åŠ è½½å®Œæ¯• åï¼Œå†æ‰§è¡ŒæŒ‡å®šçš„ä»£ç ã€‚\nä¸€èˆ¬ script æ ‡ç­¾ä¼šè¢«æ”¾åœ¨å¤´éƒ¨æˆ–å°¾éƒ¨ã€‚å¤´éƒ¨å°±æ˜¯ \u0026lt;head\u0026gt;\u0026lt;/head\u0026gt; é‡Œé¢ï¼Œå°¾éƒ¨ä¸€èˆ¬æŒ‡ \u0026lt;body\u0026gt;\u0026lt;/body\u0026gt; é‡Œï¼Œä½†ä¹Ÿæœ‰æ”¾åœ¨ \u0026lt;/body\u0026gt; é—­åˆæ ‡ç­¾ä¹‹åçš„ï¼ˆæœ€å¥½ä¸è¦è¿™æ ·ï¼‰ã€‚\nèŠ‚ç‚¹å…³ç³» graph LR f[\u0026#34;çˆ¶èŠ‚ç‚¹\u0026#34;]--firstChild--\u0026gt;c1[\u0026#34;å­èŠ‚ç‚¹\u0026#34;] c2[\u0026#34;å­èŠ‚ç‚¹\u0026#34;]--parentNode--\u0026gt;f f--lastChild--\u0026gt;c3[\u0026#34;å­èŠ‚ç‚¹\u0026#34;] c1--nextSibling--\u0026gt;c2 c2--nextSibling--\u0026gt;c3 c3--previousSibling--\u0026gt;c2 c2--previousSibling--\u0026gt;c1 å…³ç³» è€ƒè™‘æ‰€æœ‰ç»“ç‚¹ å­èŠ‚ç‚¹ childNodes çˆ¶èŠ‚ç‚¹ parentNode ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹ firstChild æœ€åä¸€ä¸ªå­èŠ‚ç‚¹ lastChild å‰ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹ previousSibling åä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹ nextSibling :memo: Note æ–‡æœ¬èŠ‚ç‚¹ä¹Ÿå±äºèŠ‚ç‚¹\nåœ¨æ ‡å‡†çš„ W3C è§„èŒƒä¸­ï¼Œç©ºç™½æ–‡æœ¬èŠ‚ç‚¹ä¹Ÿåº”è¯¥ç®—ä½œèŠ‚ç‚¹ï¼Œä½†æ˜¯åœ¨ IE8 åŠä»¥å‰çš„æµè§ˆå™¨ä¸­ä¼šæœ‰ä¸€å®šçš„å…¼å®¹é—®é¢˜ï¼Œå®ƒä»¬ä¸æŠŠç©ºç™½æ–‡æœ¬èŠ‚ç‚¹å½“ä½œèŠ‚ç‚¹ã€‚\nä» IE9 å¼€å§‹æ”¯æŒä¸€äº› åªè€ƒè™‘å…ƒç´ èŠ‚ç‚¹ çš„å±æ€§ã€‚\nå¦‚æœè€ƒè™‘å…¼å®¹æ€§ï¼Œå¯ä»¥é€šè¿‡åé¢çš„å‡½æ•°å°è£…æ¥å®ç°ã€‚\nå…³ç³» è€ƒè™‘æ‰€æœ‰ç»“ç‚¹ åªè€ƒè™‘å…ƒç´ èŠ‚ç‚¹ å­èŠ‚ç‚¹ childNodes children çˆ¶èŠ‚ç‚¹ parentNode åŒ ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹ firstChild firstElementChild æœ€åä¸€ä¸ªå­èŠ‚ç‚¹ lastChild lastElementChild å‰ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹ previousSibling previousElementSibling åä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹ nextSibling nextElementSibling :page_with_curl: Example\nå°è£…ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥è¿”å›å…ƒç´ çš„æ‰€æœ‰å­å…ƒç´ èŠ‚ç‚¹ï¼ˆå…¼å®¹åˆ° IE6ï¼‰ï¼Œç±»ä¼¼ children çš„åŠŸèƒ½ï¼š\ngetChildren() - children function getChildren(node) { // ç»“æœæ•°ç»„ var children = []; // éå† node è¿™ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œåˆ¤æ–­æ¯ä¸€ä¸ªå­èŠ‚ç‚¹çš„ nodeType å±æ€§æ˜¯ä¸æ˜¯ 1 // å¦‚æœæ˜¯ 1ï¼Œå°±æ¨å…¥ç»“æœæ•°ç»„ for (var i = 0; i \u0026lt; node.childNodes.length; i++) { //.childNodesä¸ºDOMå°è£…æ–¹æ³• if (node.childNodes[i].nodeType === 1) { children.push(node.childNodes[i]); } } return children; } getElementPrevSibling() - previousElementSibling function getElementPrevSibling(node) { var o = node; // ä½¿ç”¨ while è¯­å¥ while (o.previousSibling != null) { if (o.previousSibling.nodeType === 1) { // ç»“æŸå¾ªç¯ï¼Œæ‰¾åˆ°äº† return o.previousSibling; } // è®© o æˆä¸ºå®ƒçš„å‰ä¸€ä¸ªèŠ‚ç‚¹ o = o.previousSibling; } return null; } getAllElementSibling() function getAllElementSibling(node) { // å‰é¢çš„å…ƒç´ å…„å¼ŸèŠ‚ç‚¹ var prevArr = []; // åé¢çš„å…ƒç´ å…„å¼ŸèŠ‚ç‚¹ var nextArr = []; var o = node; // éå† node çš„å‰é¢çš„èŠ‚ç‚¹ while (o.previousSibling != null) { if (o.previousSibling.nodeType === 1) { prevArr.unshift(o.previousSibling); } o = o.previousSibling; } o = node; // éå† node çš„åé¢çš„èŠ‚ç‚¹ while (o.nextSibling != null) { if (o.nextSibling.nodeType === 1) { nextArr.push(o.nextSibling); } o = o.nextSibling; } // å°†ä¸¤ä¸ªæ•°ç»„è¿›è¡Œåˆå¹¶ï¼Œç„¶åè¿”å› return prevArr.concat(nextArr); } NodeList èŠ‚ç‚¹ å†…å®¹ æ”¹å˜å…ƒç´ èŠ‚ç‚¹ä¸­çš„å†…å®¹å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªç›¸å…³å±æ€§ã€‚\ninnerHTML å±æ€§èƒ½ä»¥ HTML è¯­æ³•è®¾ç½®èŠ‚ç‚¹ä¸­çš„å†…å®¹ã€‚\ninnerText å±æ€§åªèƒ½ä»¥çº¯æ–‡æœ¬çš„å½¢å¼è®¾ç½®èŠ‚ç‚¹ä¸­çš„å†…å®¹ã€‚\næ ·å¼ æ”¹å˜å…ƒç´ èŠ‚ç‚¹çš„ CSS æ ·å¼éœ€è¦ä½¿ç”¨è¿™æ ·çš„è¯­å¥ï¼š\noBox.style.backgroundColor = 'red'; oBox.style.backgroundImage = 'url(images/1.jpg)'; oBox.style.fontSize = '32px'; :memo: Note\nå±æ€§åä¸ºå°é©¼å³°æ‹¼æ³• å±æ€§å€¼è¦è®¾ç½®æˆå®Œæ•´å½¢å¼ï¼ŒåŒ…æ‹¬å•ä½ ä¿®æ”¹çš„æ ·å¼å±äºè¡Œå†…å¼ï¼Œä¼˜å…ˆçº§æœ€é«˜ Attr æ ‡å‡† W3C å±æ€§ï¼Œå¦‚ srcã€hrefã€titleã€alt ç­‰ç­‰ï¼Œåªéœ€è¦ç›´æ¥æ‰“ç‚¹è¿›è¡Œæ›´æ”¹å³å¯ã€‚\noImg.src = 'images/2.jpg';\n:memo: Note å¯¹äºä¸ç¬¦åˆ W3C æ ‡å‡†çš„å±æ€§ï¼Œè¦ä½¿ç”¨ setAttribute() å’Œ getAttribute() æ¥è®¾ç½®ã€è¯»å–ã€‚\noBox.setAttribute(\u0026#39;data-n\u0026#39;, 10); var n = oBox.getAttribute(\u0026#39;data-n\u0026#39;); alert(n); åˆ›å»º document.createElement() æ–¹æ³•ç”¨äºåˆ›å»ºä¸€ä¸ªæŒ‡å®š tag name çš„ HTML å…ƒç´ ã€‚\nlet å­¤å„¿èŠ‚ç‚¹ = document.createElement(\u0026#39;div\u0026#39;); æ–°åˆ›å»ºå‡ºçš„èŠ‚ç‚¹æ˜¯ å­¤å„¿èŠ‚ç‚¹ï¼Œè¿™æ„å‘³ç€å®ƒå¹¶æ²¡æœ‰è¢«æŒ‚è½½åˆ° DOM æ ‘ä¸Šï¼Œæˆ‘ä»¬æ— æ³•çœ‹è§å®ƒã€‚\nå¿…é¡»ç»§ç»­ä½¿ç”¨ appendChild() æˆ– insertBefore() æ–¹æ³•å°†å­¤å„¿èŠ‚ç‚¹æ’å…¥åˆ° DOM æ ‘ä¸Šã€‚\nä»»ä½•å·²ç»åœ¨ DOM æ ‘ä¸Šçš„èŠ‚ç‚¹ï¼Œéƒ½å¯ä»¥è°ƒç”¨ appendChild() æ–¹æ³•ï¼Œå®ƒå¯ä»¥å°†å­¤å„¿èŠ‚ç‚¹æŒ‚è½½åˆ°å®ƒçš„ å†…éƒ¨ ï¼Œæˆä¸ºå®ƒçš„ æœ€å ä¸€ä¸ªå­èŠ‚ç‚¹ã€‚ çˆ¶èŠ‚ç‚¹.appendChild(å­¤å„¿èŠ‚ç‚¹); ä»»ä½•å·²ç»åœ¨ DOM æ ‘ä¸Šçš„èŠ‚ç‚¹ï¼Œéƒ½å¯ä»¥è°ƒç”¨ insertBefore() æ–¹æ³•ï¼Œå®ƒå¯ä»¥å°†å­¤å„¿èŠ‚ç‚¹æŒ‚è½½åˆ°å®ƒçš„ å†…éƒ¨ ï¼Œæˆä¸ºå®ƒçš„ æ ‡æ†å­èŠ‚ç‚¹ä¹‹å‰ çš„èŠ‚ç‚¹ã€‚ çˆ¶èŠ‚ç‚¹.insertBefore(å­¤å„¿èŠ‚ç‚¹, æ ‡æ†èŠ‚ç‚¹); ç§»åŠ¨ å¦‚æœå°†å·²ç»æŒ‚è½½åˆ° DOM æ ‘ä¸Šçš„èŠ‚ç‚¹æˆä¸º appendChild() æˆ–è€… insertBefore() çš„å‚æ•°ï¼Œè¿™ä¸ªèŠ‚ç‚¹å°†ä¼šè¢«è‡ªåŠ¨ ç§»åŠ¨ ã€‚\n:memo: Note ç§»åŠ¨ä¹Ÿè®¸åªéœ€è¦ä¿®æ”¹ä¸€æ¬¡é“¾è¡¨æœ«å°¾çš„æŒ‡é’ˆã€‚\næ–°çˆ¶èŠ‚ç‚¹.appendChild(å·²ç»æœ‰çˆ¶äº²çš„èŠ‚ç‚¹); æ–°çˆ¶èŠ‚ç‚¹.insertBefore(å·²ç»æœ‰çˆ¶äº²çš„èŠ‚ç‚¹, æ ‡æ†å­èŠ‚ç‚¹); è¿™æ„å‘³ç€ä¸€ä¸ªèŠ‚ç‚¹ä¸èƒ½åŒæ—¶ä½äº DOM æ ‘çš„ä¸¤ä¸ªä½ç½®ã€‚\nåˆ é™¤ removeChild() æ–¹æ³•ä» DOM ä¸­åˆ é™¤ä¸€ä¸ªå­èŠ‚ç‚¹ã€‚\nçˆ¶èŠ‚ç‚¹.removeChild(è¦åˆ é™¤å­èŠ‚ç‚¹); èŠ‚ç‚¹ ä¸èƒ½ ä¸»åŠ¨åˆ é™¤è‡ªå·±ï¼Œå¿…é¡»ç”±çˆ¶èŠ‚ç‚¹åˆ é™¤å®ƒã€‚\nå…‹éš† cloneNode() æ–¹æ³•å¯ä»¥å…‹éš†èŠ‚ç‚¹ï¼Œå…‹éš†å‡ºçš„èŠ‚ç‚¹æ˜¯ â€œå­¤å„¿èŠ‚ç‚¹â€ã€‚\nå¿…é¡»ç»§ç»­ä½¿ç”¨ appendChild() æˆ– insertBefore() æ–¹æ³•å°†å­¤å„¿èŠ‚ç‚¹æ’å…¥åˆ° DOM æ ‘ä¸Šã€‚\nlet å­¤å„¿èŠ‚ç‚¹ = è€èŠ‚ç‚¹.cloneNode(); let å­¤å„¿èŠ‚ç‚¹ = è€èŠ‚ç‚¹.cloneNode(true); æ–°çˆ¶èŠ‚ç‚¹.appendChild(å­¤å„¿èŠ‚ç‚¹); å‚æ•°æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦é‡‡ç”¨ æ·±åº¦å…‹éš† ï¼šå¦‚æœä¸º trueï¼Œåˆ™è¯¥èŠ‚ç‚¹çš„æ‰€æœ‰åä»£èŠ‚ç‚¹ä¹Ÿä¼šè¢«å…‹éš†ï¼Œå¦‚æœä¸º falseï¼Œåˆ™åªå…‹éš†è¯¥èŠ‚ç‚¹æœ¬èº«ã€‚\näº‹ä»¶ ç›‘å¬ ç›‘å¬ é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å½“æŸä¸ªäº‹ä»¶å‘ç”Ÿäº†ï¼Œä»è€Œæ‰§è¡Œç¨‹åºå‘˜é¢„å…ˆç¼–å†™å¥½çš„ä¸€äº›ç¨‹åºã€‚\nè®¾ç½®äº‹ä»¶ç›‘å¬çš„æ–¹æ³•ä¸»è¦æœ‰ on_Event_ å’Œ addEventListener() ä¸¤ç§ï¼Œ\n:memo: Note\nåŸå§‹çš„äº‹ä»¶å¤„ç†æ–¹æ³•ï¼šç›´æ¥é€šè¿‡äº‹ä»¶ç»‘å®šå‡½æ•°ï¼Œä¸æ¨èä½¿ç”¨ã€‚\n\u0026lt;!-- HTML --\u0026gt; \u0026lt;button onclick=\u0026#34;add();\u0026#34;\u0026gt;ç‚¹å‡»\u0026lt;/button\u0026gt; /* JS */ function add() { alert(\u0026#34;ç›¸åŠ \u0026#34;); } :page_with_curl: Example æœ€ç®€å•çš„ç»™å…ƒç´ è®¾ç½®äº‹ä»¶ç›‘å¬çš„æ–¹æ³•å°±æ˜¯è®¾ç½®å®ƒä»¬çš„on_Event_ å±æ€§ï¼š\noBox.onclick = function() { // ç‚¹å‡»ç›’å­æ—¶ï¼Œå°†æ‰§è¡Œè¿™é‡Œçš„è¯­å¥ } function fun() { ... } oBox.onclick = fun; é¼ æ ‡äº‹ä»¶ äº‹ä»¶å äº‹ä»¶æè¿° onclick å½“é¼ æ ‡å•å‡»æŸä¸ªå¯¹è±¡ ondblclick å½“é¼ æ ‡åŒå‡»æŸä¸ªå¯¹è±¡ onmousedown å½“æŸä¸ªé¼ æ ‡æŒ‰é”®åœ¨æŸä¸ªå¯¹è±¡ä¸Šè¢«æŒ‰ä¸‹ onmouseup å½“æŸä¸ªé¼ æ ‡æŒ‰é”®åœ¨æŸä¸ªå¯¹è±¡ä¸Šè¢«æ¾å¼€ onmousemove å½“æŸä¸ªé¼ æ ‡æŒ‰é”®åœ¨æŸä¸ªå¯¹è±¡ä¸Šè¢«ç§»åŠ¨ onmouseenterä¸å†’æ³¡ å½“é¼ æ ‡è¿›å…¥æŸä¸ªå¯¹è±¡ï¼ˆ onmouseoverå†’æ³¡ï¼‰ onmouseleaveä¸å†’æ³¡ å½“é¼ æ ‡ç¦»å¼€æŸä¸ªå¯¹è±¡ï¼ˆ onmouseoutå†’æ³¡ï¼‰ é”®ç›˜äº‹ä»¶ äº‹ä»¶å äº‹ä»¶æè¿° onkeypress å½“æŸä¸ªé”®ç›˜çš„é”®è¢«æŒ‰ä¸‹ï¼ˆç³»ç»ŸæŒ‰é’®å¦‚ç®­å¤´é”®å’ŒåŠŸèƒ½é”®æ— æ³•å¾—åˆ°è¯†åˆ«ï¼‰ onkeydown å½“æŸä¸ªé”®ç›˜çš„é”®è¢«æŒ‰ä¸‹ï¼ˆç³»ç»ŸæŒ‰é’®å¯ä»¥è¯†åˆ«ï¼Œå¹¶ä¸”ä¼šå…ˆäº onkeypress å‘ç”Ÿï¼‰ onkeyup å½“æŸä¸ªé”®ç›˜çš„é”®è¢«æ¾å¼€ è¡¨å•äº‹ä»¶ äº‹ä»¶å äº‹ä»¶æè¿° onchange å½“ç”¨æˆ·æ”¹å˜å®ŒæˆåŸŸçš„å†…å®¹ onfocus å½“æŸå…ƒç´ è·å¾—ç„¦ç‚¹ï¼ˆæ¯”å¦‚ tab é”®æˆ–é¼ æ ‡ç‚¹å‡»ï¼‰ onblur å½“æŸå…ƒç´ å¤±å»ç„¦ç‚¹ onsubmit å½“è¡¨å•è¢«æäº¤ onreset å½“è¡¨å•è¢«é‡ç½® :memo: Note è¡¨å•å¯¹è±¡å¯ä»¥é€šè¿‡ . è®¿é—® name å±æ€§ï¼Œå¾—åˆ°å†…éƒ¨å…ƒç´ ã€‚\né¡µé¢äº‹ä»¶ äº‹ä»¶å äº‹ä»¶æè¿° onload å½“é¡µé¢æˆ–å›¾åƒè¢«å®ŒæˆåŠ è½½ onunload å½“ç”¨æˆ·é€€å‡ºé¡µé¢ :memo: Note é¡µé¢å±äº BOM æ–‡æ¡£å¯¹è±¡æ¨¡å‹ã€‚\næ•è· å‘\nå†…æ–¹\nå‘å¯¼\nå¤–ä¼ \nç”± åœ¨åµŒå¥—çš„ç›’å­æ¨¡å‹ä¸­ï¼Œäº‹ä»¶çš„ä¼ æ’­åˆ†æˆä¸¤ä¸ªé˜¶æ®µï¼š\næ•è·é˜¶æ®µCapturing Phaseï¼šå¤– â†’ å†… å†’æ³¡é˜¶æ®µBubbling Phaseï¼šå†… â†’ å¤– è€Œ on_Event_ åªèƒ½ç›‘å¬å†’æ³¡é˜¶æ®µã€‚\nå› æ­¤å¼•å…¥ addEventListerner() ã€‚\noBox.addEventListener(\u0026#39;click\u0026#39;, function(){}, true); :memo: Note\nDOM0 çº§äº‹ä»¶ç›‘å¬ï¼šåªèƒ½ç›‘å¬å†’æ³¡é˜¶æ®µ oBox.onclick = () =\u0026gt; { // Statements... }; DOM2 çº§äº‹ä»¶ç›‘å¬ï¼šå¯ç›‘å¬ æ•è·é˜¶æ®µç”±å¤–å‘å†…-true å’Œ å†’æ³¡é˜¶æ®µç”±å†…è€Œå¤–-false oBox.addEventListener(\u0026#39;click\u0026#39;, // æ•è·äº‹ä»¶å‰é¢ä¸åŠ on () =\u0026gt; { // Statements... }, true // trueç›‘å¬æ•è·é˜¶æ®µï¼Œfalseç›‘å¬å†’æ³¡é˜¶æ®µ ); æ‰§è¡Œé¡ºåºï¼šæ•è·é˜¶æ®µ â†’ onclick() â†’ å†’æ³¡é˜¶æ®µï¼ˆæ–°ç‰ˆ Chromeï¼‰\nå¦‚æœç»™å…ƒç´ è®¾ç½®ç›¸åŒçš„ä¸¤ä¸ªæˆ–å¤šä¸ªåŒåäº‹ä»¶ï¼Œåˆ™ DOM0 çº§å†™æ³•åé¢å†™çš„ä¼šè¦†ç›–å…ˆå†™çš„ï¼›è€Œ DOM2 çº§ä¼šæŒ‰é¡ºåºæ‰§è¡Œã€‚\nå¯¹è±¡ äº‹ä»¶å¤„ç†å‡½æ•° æä¾›ä¸€ä¸ª å½¢å¼å‚æ•° ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå°è£…äº†æœ¬æ¬¡äº‹ä»¶çš„ç»†èŠ‚ã€‚\nè¿™ä¸ªå‚æ•°é€šå¸¸ç”¨å•è¯ event æˆ–å­—æ¯ e æ¥è¡¨ç¤ºï¼Œæ¥å—çš„å€¼ç”±æµè§ˆå™¨æˆ–æ“ä½œç³»ç»Ÿä¼ é€’ã€‚å¯¹è±¡å±æ€§é€šè¿‡ç‚¹æ“ä½œç¬¦ . è®¿é—®ã€‚\noBox.onmousemove = function (e) { // å¯¹è±¡ e å°±æ˜¯è¿™æ¬¡äº‹ä»¶çš„äº‹ä»¶å¯¹è±¡ } é¼ æ ‡ä½ç½® å±æ€§ å±æ€§æè¿° clientX é¼ æ ‡æŒ‡é’ˆç›¸å¯¹äº æµè§ˆå™¨ çš„æ°´å¹³åæ ‡ clientY é¼ æ ‡æŒ‡é’ˆç›¸å¯¹äº æµè§ˆå™¨ çš„å‚ç›´åæ ‡ pageX é¼ æ ‡æŒ‡é’ˆç›¸å¯¹äº æ•´å¼ ç½‘é¡µ çš„æ°´å¹³åæ ‡ pageY é¼ æ ‡æŒ‡é’ˆç›¸å¯¹äº æ•´å¼ ç½‘é¡µ çš„å‚ç›´åæ ‡ offsetX é¼ æ ‡æŒ‡é’ˆç›¸å¯¹äº äº‹ä»¶æºå…ƒç´  çš„æ°´å¹³åæ ‡ offsetY é¼ æ ‡æŒ‡é’ˆç›¸å¯¹äº äº‹ä»¶æºå…ƒç´  çš„å‚ç›´åæ ‡ è·å–é”®ç  ç”¨æˆ·æŒ‰ä¸‹é”®ç›˜ä¸Šçš„é”®æ—¶å‘ç”Ÿçš„äº‹ä»¶å±äº KeyboardEvent å¯¹è±¡ã€‚\nå±æ€§/æ–¹æ³• æè¿° altKey è¿”å›è§¦å‘é”®äº‹ä»¶æ—¶æ˜¯å¦æŒ‰ä¸‹ ALT é”® charCode è¿”å›è§¦å‘äº‹ä»¶çš„é”®çš„ Unicode å­—ç¬¦ä»£ç  code:star: è¿”å›è§¦å‘äº‹ä»¶çš„é”®çš„ ä»£ç  ctrlKey è¿”å›è§¦å‘é”®äº‹ä»¶æ—¶æ˜¯å¦æŒ‰ä¸‹â€œCTRLâ€é”® getModifierState() å¦‚æœæ¿€æ´»äº†æŒ‡å®šçš„é”®ï¼Œåˆ™è¿”å›true isComposing è¿”å›äº‹ä»¶çš„çŠ¶æ€æ˜¯å¦æ­£åœ¨æ’°å†™ key:star: è¿”å›äº‹ä»¶è¡¨ç¤ºçš„é”®çš„ é”®å€¼ keyCode è¿”å›è§¦å‘onkeypressäº‹ä»¶çš„é”®çš„Unicodeå­—ç¬¦ä»£ç ï¼Œæˆ–è§¦å‘onkeydownæˆ–onkeyupäº‹ä»¶çš„é”®çš„Unicodeé”®ä»£ç  location è¿”å›é”®ç›˜æˆ–è®¾å¤‡ä¸Šé”®çš„ä½ç½® metaKey è¿”å›è§¦å‘é”®äº‹ä»¶æ—¶æ˜¯å¦æŒ‰ä¸‹â€œmetaâ€é”® repeat è¿”å›æ˜¯å¦é‡å¤æŒ‰ä¸‹æŸä¸ªé”® shiftKey è¿”å›è§¦å‘é”®äº‹ä»¶æ—¶æ˜¯å¦æŒ‰ä¸‹â€œSHIFTâ€é”® which è¿”å›è§¦å‘ onkeypress äº‹ä»¶çš„é”®çš„ Unicode å­—ç¬¦ä»£ç ï¼Œæˆ–è§¦å‘ onkeydown æˆ– onkeyup äº‹ä»¶çš„é”®çš„ Unicode é”®ä»£ç  é˜»æ­¢ e.preventDefault() ç”¨æ¥é˜»æ­¢äº‹ä»¶äº§ç”Ÿçš„ é»˜è®¤åŠ¨ä½œ ã€‚\n:page_with_curl: Example 1\nåˆ¶ä½œä¸€ä¸ªæ–‡æœ¬æ¡†ï¼Œåªèƒ½è®©ç”¨æˆ·åœ¨å…¶ä¸­è¾“å…¥å°å†™å­—æ¯å’Œæ•°å­—ï¼Œå…¶ä»–å­—ç¬¦è¾“å…¥æ²¡æœ‰æ•ˆæœã€‚\n\u0026lt;p\u0026gt; åªèƒ½è¾“å…¥å°å†™å­—æ¯å’Œæ•°å­—ï¼š \u0026lt;input type=\u0026#34;text\u0026#34; id=\u0026#34;field\u0026#34;\u0026gt; \u0026lt;/p\u0026gt; \u0026lt;script\u0026gt; let oField = document.getElementById(\u0026#39;field\u0026#39;); oField.onkeydown = function (e) { // æ ¹æ®ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦çš„å­—ç¬¦ç ï¼ˆe.charCode) // èŒƒå›´ä¸ºæ•°å­— 0~9ï¼Œå†™å­—æ¯ a~z if (!(e.key \u0026gt;= \u0026#39;a\u0026#39; \u0026amp;\u0026amp; e.key \u0026lt;= \u0026#39;z\u0026#39; || e.key \u0026gt;= \u0026#39;0\u0026#39; \u0026amp;\u0026amp; e.key \u0026lt;= \u0026#39;9\u0026#39;)) { console.log(e.code); // é˜»æ­¢æµè§ˆå™¨çš„é»˜è®¤è¡Œä¸º \u0026lt;- å‘inputè¾“å…¥ e.preventDefault(); } }; \u0026lt;/script\u0026gt; :page_with_curl: Example 2\nåˆ¶ä½œé¼ æ ‡æ»šè½®äº‹ä»¶ï¼šå½“é¼ æ ‡åœ¨ç›’å­ä¸­å‘ä¸‹æ»šåŠ¨æ—¶ï¼Œæ•°å­—åŠ  1ï¼›åä¹‹ï¼Œæ•°å­—å‡ 1ã€‚\né¼ æ ‡æ»šè½®äº‹ä»¶æ˜¯ onmousewheelï¼Œå®ƒçš„äº‹ä»¶å¯¹è±¡ e æä¾› deltaY å±æ€§è¡¨ç¤ºé¼ æ ‡æ»šåŠ¨æ–¹å‘ï¼Œå‘ä¸‹æ»šåŠ¨æ˜¯è¿”å›æ­£å€¼ï¼Œå‘ä¸Šæ»šåŠ¨æ—¶è¿”å›è´Ÿå€¼ã€‚\n\u0026lt;div id=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;h1 id=\u0026#34;info\u0026#34;\u0026gt;0\u0026lt;/h1\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;style\u0026gt; #box { width: 200px; height: 200px; border: 1px dashed darkslateblue; display: flex; justify-content: center; align-items: center; } \u0026lt;/style\u0026gt; \u0026lt;script\u0026gt; const oBox = document.getElementById(\u0026#39;box\u0026#39;); const oInfo = document.getElementById(\u0026#39;info\u0026#39;); let info = 0; oBox.addEventListener(\u0026#39;mousewheel\u0026#39;, e =\u0026gt; { e.preventDefault(); e.deltaY \u0026gt; 0 \u0026amp;\u0026amp; info--; e.deltaY \u0026lt; 0 \u0026amp;\u0026amp; info++; oInfo.innerText = info; }); \u0026lt;/script\u0026gt; e.stopPropagation() ä¸ç®¡æ˜¯å†’æ³¡è¿˜æ˜¯æ•è·ï¼Œäº‹ä»¶å¯ä»¥åœ¨å„å±‚çº§çš„èŠ‚ç‚¹ä¸­ä¼ é€’ã€‚æœ‰æ—¶æˆ‘ä»¬å¸Œæœ›äº‹ä»¶åœ¨ç‰¹å®šèŠ‚ç‚¹æ‰§è¡Œå®Œåä¸å†ä¼ é€’ï¼Œå°±å¯ä»¥ä½¿ç”¨ event.stopProgation()æ¥é˜»æ­¢äº‹ä»¶ å†’æ³¡ ã€‚\n:page_with_curl: Example åˆ¶ä½œä¸€ä¸ªå¼¹å‡ºå±‚ï¼šç‚¹å‡»æŒ‰é’®æ˜¾ç¤ºå¼¹å‡ºå±‚ï¼Œç‚¹å‡»ç½‘é¡µä»»æ„åœ°æ–¹ï¼Œå¼¹å‡ºå±‚å…³é—­ã€‚\n\u0026lt;style\u0026gt; .modal { width: 400px; height: 140px; background-color: #333; position: absolute; top: 50%; left: 50%; margin-top: -70px; margin-left: -200px; display: none; } \u0026lt;/style\u0026gt; \u0026lt;button id=\u0026#34;btn\u0026#34;\u0026gt;æŒ‰æˆ‘å¼¹å‡ºå¼¹å‡ºå±‚\u0026lt;/button\u0026gt; \u0026lt;div class=\u0026#34;modal\u0026#34; id=\u0026#34;modal\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; const oBtn = document.getElementById(\u0026#39;btn\u0026#39;); const oModal = document.getElementById(\u0026#39;modal\u0026#39;); // ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™ï¼Œå¼¹å‡ºå±‚æ˜¾ç¤º oBtn.onclick = (e) =\u0026gt; { // é˜»æ­¢äº‹ä»¶ç»§ç»­ä¼ æ’­åˆ°documentèº«ä¸Š e.stopPropagation(); oModal.style.display = \u0026#39;block\u0026#39;; }; // ç‚¹å‡»é¡µé¢ä»»ä½•éƒ¨åˆ†çš„æ—¶å€™ï¼Œå¼¹å‡ºå±‚å…³é—­ document.onclick = () =\u0026gt; { oModal.style.display = \u0026#39;none\u0026#39;; }; // ç‚¹å‡»å¼¹å‡ºå±‚å†…éƒ¨çš„æ—¶å€™ï¼Œä¸èƒ½å…³é—­å¼¹å‡ºå±‚çš„ï¼Œæ‰€ä»¥åº”è¯¥é˜»æ­¢äº‹ä»¶ç»§ç»­ä¼ æ’­ oModal.onclick = (e) =\u0026gt; { // é˜»æ­¢äº‹ä»¶ç»§ç»­å†’æ³¡ä¼ æ’­åˆ°documentèº«ä¸Š e.stopPropagation(); }; \u0026lt;/script\u0026gt; return false åŒ…å«ç‰¹æœ‰é€€å‡ºæ‰§è¡Œreturn false ä¹‹åçš„æ‰€æœ‰è§¦å‘äº‹ä»¶å’ŒåŠ¨ä½œéƒ½ä¸ä¼šè¢«æ‰§è¡Œã€‚æœ‰æ—¶å€™return false å¯ä»¥æ›¿ä»£event.stopPropagation()å’Œevent.preventDefult()æ¥é˜»æ­¢é»˜è®¤è¡Œä¸ºå‘ç”Ÿå’Œå†’æ³¡ã€‚\n:page_with_curl: Example\n\u0026lt;body\u0026gt; \u0026lt;br /\u0026gt; \u0026lt;div\u0026gt; \u0026lt;a href=\u0026#34;http://www.baidu.com\u0026#34;\u0026gt;ç‚¹å‡»\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt; document.querySelector(\u0026#39;a\u0026#39;).onclick=function(){ alert(\u0026#39;è­¦å‘Š\u0026#39;); return false; } \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; ç»“æœåªæ˜¯å‡ºç°äº†è­¦å‘Šçš„å¼¹çª—ï¼Œå¹¶æ²¡æœ‰è·³è½¬åˆ°ç™¾åº¦é¡µé¢ã€‚\nå¦‚æœå°† retuen false æå‰åˆ° alert('è­¦å‘Š') çš„å‰é¢ï¼Œç»“æœå°±æ˜¯ä»€ä¹ˆéƒ½ä¸æ˜¾ç¤ºï¼ŒåŸå› æ˜¯ return false ä¼šä¸­æ­¢äº‹ä»¶ä¸é»˜è®¤è¡Œæ–‡ã€‚\nå§”æ‰˜ æ‰¹é‡æ·»åŠ  :page_with_curl: Example\né¡µé¢ä¸Šæœ‰ä¸€ä¸ªæ— åºåˆ—è¡¨ \u0026lt;ul\u0026gt;ï¼Œå®ƒå†…éƒ¨å…±æœ‰ 20 ä¸ª \u0026lt;li\u0026gt; å…ƒç´ ï¼Œè¯·æ‰¹é‡ç»™å®ƒä»¬æ·»åŠ äº‹ä»¶ç›‘å¬ï¼Œå®ç°æ•ˆæœï¼šç‚¹å‡»å“ªä¸ª \u0026lt;li\u0026gt; å…ƒç´ ï¼Œå“ªä¸ª \u0026lt;li\u0026gt; å…ƒç´ å°±å˜çº¢ã€‚\n\u0026lt;ul id=\u0026#34;list\u0026#34;\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;script\u0026gt; const oList = document.getElementById(\u0026#39;list\u0026#39;); const lis = oList.getElementsByTagName(\u0026#39;li\u0026#39;); // ä¹¦å†™å¾ªç¯è¯­å¥ï¼Œæ‰¹é‡ç»™å…ƒç´ æ·»åŠ ç›‘å¬ for (let i = 0; i \u0026lt; lis.length; i++) { lis[i].onclick = function () { // åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œthisè¡¨ç¤ºç‚¹å‡»çš„è¿™ä¸ªå…ƒç´ ï¼Œthisæ¶‰åŠå‡½æ•°ä¸Šä¸‹æ–‡çš„ç›¸å…³çŸ¥è¯†ï¼Œæˆ‘ä»¬åœ¨â€œé¢å‘å¯¹è±¡â€è¯¾ç¨‹ä¸­ä»‹ç» this.style.color = \u0026#39;red\u0026#39;; }; } \u0026lt;/script\u0026gt; ä¸Šé¢çš„ä¾‹é¢˜ä¸­ï¼Œæ¯ä¸€ä¸ªäº‹ä»¶ç›‘å¬æ³¨å†Œéƒ½ä¼šæ¶ˆè€—ä¸€å®šçš„ç³»ç»Ÿå†…å­˜ï¼Œè€Œæ‰¹é‡æ·»åŠ äº‹ä»¶ä¼šå¯¼è‡´ç›‘å¬æ•°é‡å¤ªå¤šï¼Œå†…å­˜æ¶ˆè€—ä¼šéå¸¸å¤§ã€‚\nå®é™…ä¸Šï¼Œæ¯ä¸ª \u0026lt;li\u0026gt; çš„äº‹ä»¶å¤„ç†å‡½æ•°éƒ½æ˜¯ä¸åŒçš„å‡½æ•°ï¼Œè¿™äº›å‡½æ•°æœ¬èº«ä¹Ÿä¼šå ç”¨å†…å­˜ã€‚å› æ­¤å¼•å…¥äº† åŠ¨æ€ç»‘å®š ã€‚\nåŠ¨æ€ç»‘å®š :page_with_curl: Example\né¡µé¢ä¸Šæœ‰ä¸€ä¸ªæ— åºåˆ—è¡¨ \u0026lt;ul\u0026gt;ï¼Œå®ƒå†…éƒ¨æ²¡æœ‰ \u0026lt;li\u0026gt; å…ƒç´ ï¼Œè¯·åˆ¶ä½œä¸€ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»è¿™ä¸ªæŒ‰é’®å°±èƒ½å¢åŠ ä¸€ä¸ª \u0026lt;li\u0026gt; å…ƒç´ ã€‚å¹¶ä¸”è¦æ±‚æ¯ä¸ªå¢åŠ çš„ \u0026lt;li\u0026gt; å…ƒç´ ä¹Ÿè¦æœ‰ç‚¹å‡»äº‹ä»¶ç›‘å¬ï¼Œå®ç°æ•ˆæœï¼šç‚¹å‡»å“ªä¸ª \u0026lt;li\u0026gt; å…ƒç´ ï¼Œå“ªä¸ª \u0026lt;li\u0026gt; å…ƒç´ å°±å˜çº¢ã€‚\n\u0026lt;button id=\u0026#34;btn\u0026#34;\u0026gt;æŒ‰æˆ‘æ·»åŠ æ–°çš„liåˆ—è¡¨é¡¹\u0026lt;/button\u0026gt; \u0026lt;ul id=\u0026#34;list\u0026#34;\u0026gt;\u0026lt;/ul\u0026gt; \u0026lt;script\u0026gt; const oBtn = document.getElementById(\u0026#39;btn\u0026#39;); const oList = document.getElementById(\u0026#39;list\u0026#39;); const lis = oList.getElementsByTagName(\u0026#39;li\u0026#39;); // åˆ›å»ºçš„æ—¶å€™è¿˜æ²¡æœ‰ä»»ä½•å†…å®¹ï¼š HTMLCollection [] // ä½†ä¹‹åè°ƒç”¨lisçš„æ—¶å€™å‘ç°ä¼šåŠ¨æ€æ›´æ–° console.log(lis); oBtn.onclick = function () { const oLi = document.createElement(\u0026#39;li\u0026#39;); oLi.innerHTML = \u0026#39;æˆ‘æ˜¯åˆ—è¡¨é¡¹\u0026#39;; oList.appendChild(oLi); // ä¸Šæ ‘ oLi.onclick = function () { this.style.color = \u0026#39;red\u0026#39;; }; }; \u0026lt;/script\u0026gt; æ–°å¢å…ƒç´ å¿…é¡»åˆ†åˆ«æ·»åŠ äº‹ä»¶ç›‘å¬ï¼Œè€Œä¸èƒ½è‡ªåŠ¨è·å–äº‹ä»¶ç›‘å¬ã€‚å¤§é‡äº‹ä»¶ç›‘å¬ã€å¤§é‡äº‹ä»¶å¤„ç†å‡½æ•°éƒ½ä¼šäº§ç”Ÿå¤§é‡çš„å†…å­˜æ¶ˆè€—ã€‚ä¸ºäº†å‡å°‘ç›‘å¬çš„æ¶ˆè€—ï¼Œå¯ä»¥åˆ©ç”¨äº‹ä»¶å†’æ³¡çš„æœºåˆ¶ï¼Œå°†åä»£å…ƒç´ äº‹ä»¶å§”æ‰˜ç»™ç¥–å…ˆå…ƒç´ ã€‚\näº‹ä»¶å§”æ‰˜ åˆ©ç”¨äº‹ä»¶å†’æ³¡æœºåˆ¶ï¼Œå°†åä»£å…ƒç´ äº‹ä»¶å§”æ‰˜ç»™ç¥–å…ˆå…ƒç´ ã€‚\n\u0026lt;ul id=\u0026#34;list\u0026#34;\u0026gt; \u0026lt;!-- ç›‘å¬onclickäº‹ä»¶ --\u0026gt; \u0026lt;list\u0026gt;list item\u0026lt;/list\u0026gt; \u0026lt;list\u0026gt;list item\u0026lt;/list\u0026gt; \u0026lt;list\u0026gt;list item\u0026lt;/list\u0026gt; \u0026lt;!-- ä¸ç®¡ç‚¹å‡»ä»»ä½•ä¸€ä¸ª\u0026lt;li\u0026gt;å…ƒç´ ï¼Œäº‹ä»¶éƒ½ä¼š --\u0026gt; \u0026lt;/ul\u0026gt; äº‹ä»¶å§”æ‰˜é€šå¸¸éœ€è¦ç»“åˆä½¿ç”¨ e.target å±æ€§ã€‚\nå±æ€§ å±æ€§æè¿° target è§¦å‘æ­¤äº‹ä»¶çš„æœ€æ—©å…ƒç´ ï¼Œå³ â€œäº‹ä»¶æºå…ƒç´ â€ currentTarget äº‹ä»¶å¤„ç†ç¨‹åºé™„åŠ åˆ°çš„å…ƒç´  \u0026lt;button id=\u0026#34;btn\u0026#34;\u0026gt;æŒ‰æˆ‘åˆ›å»ºä¸€ä¸ªæ–°åˆ—è¡¨é¡¹\u0026lt;/button\u0026gt; \u0026lt;ul id=\u0026#34;list\u0026#34;\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;åˆ—è¡¨é¡¹\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;script\u0026gt; const oList = document.getElementById(\u0026#39;list\u0026#39;); const oBtn = document.getElementById(\u0026#39;btn\u0026#39;); oList.onclick = function (e) { // e.targetè¡¨ç¤ºç”¨æˆ·çœŸæ­£ç‚¹å‡»çš„é‚£ä¸ªå…ƒç´  if (e.target !== e.currentTarget) { // ç‚¹å‡»çš„ä¸æ˜¯çˆ¶å…ƒç´ ï¼ˆå¤„ç†ç¨‹åºæ‰€é™„åŠ å…ƒç´ ï¼‰ if (e.target.style.color === \u0026#39;transparent\u0026#39;) { e.target.style.color = \u0026#39;inherit\u0026#39;; } else { e.target.style.color = \u0026#39;transparent\u0026#39;; } } }; oBtn.onclick = function () { const oLi = document.createElement(\u0026#39;li\u0026#39;); oLi.innerText = \u0026#39;æˆ‘æ˜¯æ–°æ¥çš„\u0026#39;; oList.appendChild(oLi); }; \u0026lt;/script\u0026gt; :memo: Note 1 å½“æœ‰å¤§é‡ç±»ä¼¼å…ƒç´ éœ€è¦æ‰¹é‡æ·»åŠ äº‹ä»¶ç›‘å¬æ—¶ï¼Œä½¿ç”¨äº‹ä»¶å§”æ‰˜å¯ä»¥å‡å°‘å†…å­˜å¼€é”€ã€‚\nå½“æœ‰åŠ¨æ€å…ƒç´ èŠ‚ç‚¹ä¸Šæ ‘æ—¶ï¼Œä½¿ç”¨äº‹ä»¶å§”æ‰˜å¯ä»¥è®©æ–°ä¸Šæ ‘çš„å…ƒç´ å…·æœ‰äº‹ä»¶ç›‘å¬ã€‚\n:memo: Note 2\nQ: onmouseenter å’Œ onmouseover éƒ½è¡¨ç¤º â€œé¼ æ ‡è¿›å…¥â€ï¼Œå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ\nA: onmouseenter ä¸å†’æ³¡ï¼Œonmouseover å†’æ³¡ã€‚\nä½¿ç”¨äº‹ä»¶å§”æ‰˜æ—¶è¦æ³¨æ„ï¼šä¸èƒ½å§”æ‰˜ä¸å†’æ³¡çš„äº‹ä»¶ç»™ç¥–å…ˆå…ƒç´ ã€‚\næ—¶é—´ å®šæ—¶å™¨ åˆ›å»º setInterval() å‡½æ•°å¯ä»¥é‡å¤è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨æ¯æ¬¡è°ƒç”¨ä¹‹é—´æœ‰ å›ºå®šçš„æ—¶é—´é—´éš” ã€‚\nsetInterval(() =\u0026gt; { // è¿™ä¸ªå‡½æ•°å°†ä»¥å›ºå®šé—´éš”è‡ªåŠ¨è¢«è°ƒç”¨ }, 2000); // ç¬¬äºŒä¸ªå‚æ•°æ˜¯é—´éš”æ—¶é—´ã€‚ä»¥æ¯«ç§’ä¸ºå•ä½ å‡½æ•°å¯ä»¥æ¥å—ç¬¬ 3 ä¸ªå‚æ•°ï¼Œå®ƒä»¬å°†æŒ‰é¡ºåºä¼ å…¥å‡½æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°é™¤äº† åŒ¿åå‡½æ•° å¤–ï¼Œè¿˜æ¥å—å…·åå‡½æ•°ã€‚\næ¸…é™¤ clearInterval() å‡½æ•°å¯ä»¥æ¸…é™¤ä¸€ä¸ªå®šæ—¶å™¨ã€‚\n// è®¾ç½®å®šæ—¶å™¨ï¼Œå¹¶ä¸”timerå˜é‡æ¥å—è¿™ä¸ªå®šæ—¶å™¨ let timer = setInterval(() =\u0026gt; {}, 2000); let oBth = document.getElementById(\u0026#39;button\u0026#39;); // ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œæ¸…é™¤å®šæ—¶å™¨ oBtn.onclick = () =\u0026gt; { clearInterval(timer) // æ¸…é™¤å®šæ—¶å™¨çš„æ—¶å€™ï¼Œè¦ä¼ å…¥å®šæ—¶å™¨å˜é‡ } ä¸ºäº†é˜²æ­¢å®šæ—¶å™¨å åŠ ï¼Œåº”è¯¥åœ¨è®¾ç½®å®šæ—¶å™¨ä¹‹å‰å…ˆæ¸…é™¤å®šæ—¶å™¨ã€‚\nå»¶æ—¶å™¨ åˆ›å»º setTimeout() å‡½æ•°å¯ä»¥è®¾ç½®ä¸€ä¸ªå»¶æ—¶å™¨ï¼Œå½“æŒ‡å®šæ—¶é—´åˆ°äº†ä¹‹åï¼Œä¼šæ‰§è¡Œå‡½æ•°ä¸€æ¬¡ï¼Œä¸å†é‡å¤æ‰§è¡Œã€‚\nsetTimeout(() =\u0026gt; { //è¿™ä¸ªå‡½æ•°ä¼šåœ¨2ç§’åæ‰§è¡Œä¸€æ¬¡ }, 2000); æ¸…é™¤ clearTimeout() å‡½æ•°å¯ä»¥æ¸…é™¤å»¶æ—¶å™¨ï¼Œå’Œ clearInterval() éå¸¸ç±»ä¼¼ã€‚åŒæ ·éœ€è¦ä¼ å…¥å»¶æ—¶å™¨å˜é‡ã€‚\n:memo: Note\nè¿™ä¸¤ä¸ªæ—¶é—´å‡½æ•°éƒ½æ˜¯ å¼‚æ­¥asynchronous è¯­å¥ã€‚\nä¸ä¼šé˜»å¡ CPU ç»§ç»­æ‰§è¡Œå…¶å®ƒè¯­å¥ï¼Œå½“å¼‚æ­¥å®Œæˆåï¼Œä¼šæ‰§è¡Œ å›è°ƒå‡½æ•°Callback ã€‚\nBOM Browser Object Model æ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼Œæ˜¯æŒ‡æµè§ˆå™¨å¯¹è±¡æ¨¡å‹ï¼Œæä¾›äº†ç‹¬ç«‹äºå†…å®¹çš„ã€å¯ä»¥ä¸æµè§ˆå™¨çª—å£è¿›è¡Œäº’åŠ¨çš„å¯¹è±¡ç»“æ„ã€‚é€šè¿‡ BOM å¯ä»¥æ“ä½œæµè§ˆå™¨å¯¹è±¡çª—å£ï¼Œæ¯”å¦‚å¼¹å‡ºæ¡†ã€æ§åˆ¶æµè§ˆå™¨è·³è½¬ã€æ»šåŠ¨æ¡ç‰¹æ•ˆã€è·å–åˆ†è¾¨ç‡ç­‰ã€‚\nWindow The Window interface represents a window containing a DOM document; the document property points to the DOM document loaded in that window.\nwindow å¯¹è±¡æ˜¯å½“å‰ JS è„šæœ¬è¿è¡Œæ‰€å¤„çš„çª—å£ï¼Œè€Œè¿™ä¸ªçª—å£ä¸­åŒ…å« DOM ç»“æ„ï¼Œwindow.document å±æ€§å°±æ˜¯ document å¯¹è±¡ï¼Œä¹Ÿå³ä¸€ä¸ªDOMå®ä¾‹ã€‚\nåœ¨æœ‰æ ‡ç­¾åŠŸèƒ½çš„æµè§ˆå™¨ä¸­ï¼Œæ¯ä¸ªæ ‡ç­¾éƒ½æ‹¥æœ‰è‡ªå·±çš„ window å¯¹è±¡ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒä¸€ä¸ªçª—å£çš„æ ‡ç­¾é¡µä¹‹é—´ä¸ä¼šå…±äº«ä¸€ä¸ª window å¯¹è±¡ã€‚\n:memo: Note æµè§ˆå™¨çš„å…¨å±€å¯¹è±¡æ˜¯ windowï¼Œæ‰€æœ‰å…¨å±€å˜é‡å®é™…ä¸Šæ˜¯ window çš„æˆå‘˜ï¼Œå¯ä»¥å… window è®¿é—®ã€‚\nBOM çš„æ ¸å¿ƒå¯¹è±¡æ˜¯ window ï¼Œå®ƒè¡¨ç¤ºæµè§ˆå™¨çš„ä¸€ä¸ªå®ä¾‹ã€‚window å¯¹è±¡æœ‰åŒé‡è§’è‰²ï¼Œå®ƒæ—¢æ˜¯é€šè¿‡ JavaScript è®¿é—®æµè§ˆå™¨çª—å£çš„ä¸€ä¸ª æ¥å£ ï¼Œåˆæ˜¯ ECMAScript è§„å®šçš„ Global å¯¹è±¡ ã€‚è¿™æ„å‘³ç€åœ¨ç½‘é¡µä¸­å®šä¹‰çš„ä»»ä½•ä¸€ä¸ªå¯¹è±¡ã€å˜é‡å’Œå‡½æ•°ï¼Œéƒ½ä»¥ window ä½œä¸ºå…¶ Global å¯¹è±¡ï¼Œå› æ­¤æœ‰æƒè®¿é—® parseInt() ç­‰æ–¹æ³•ã€‚\nå¦‚æœé¡µé¢ä¸­åŒ…å« æ¡†æ¶ ï¼Œåˆ™æ¯ä¸ªæ¡†æ¶éƒ½æ‹¥æœ‰è‡ªå·±çš„ window å¯¹è±¡ï¼Œå¹¶ä¸”ä¿å­˜åœ¨ frames é›†åˆä¸­ã€‚åœ¨ frames é›†åˆä¸­ï¼Œå¯ä»¥é€šè¿‡æ•°å€¼ç´¢å¼•ä»0å¼€å§‹ï¼Œä»å·¦è‡³å³ï¼Œä»ä¸Šåˆ°ä¸‹ æˆ–è€…æ¡†æ¶çš„ åç§° æ¥è®¿é—®ç›¸åº”çš„ window å¯¹è±¡ã€‚\nvar answer = 12; /* letä¸èƒ½æ˜¾ç¤º */ alert(window.answer); å…¨å±€å˜é‡ä¼šæˆä¸º window å¯¹è±¡çš„å±æ€§ï¼Œå¤šä¸ª JS æ–‡ä»¶ä¹‹é—´å…±äº« å…¨å±€ä½œç”¨åŸŸ ã€‚å¦‚ setInterval()ã€alert() ç­‰å†…ç½®å‡½æ•°ï¼Œæ™®éæ˜¯ window çš„æ–¹æ³•ã€‚\n:memo: Note ä¼¼ä¹åœ¨ Node.js ä¸­å¹¶ä¸èƒ½ä½¿ç”¨ window.setInterval()\nçª—å£ DOM Level 0ã€‚ä¸å±äºä»»ä½• W3C æŠ€æœ¯è§„èŒƒæˆ–æ¨èã€‚\nå±æ€§ æ„ä¹‰ innerHeight å†…å®¹åŒºåŸŸé«˜åº¦ï¼ŒåŒ…å«æ°´å¹³æ»šåŠ¨æ¡ innerWidth å†…å®¹åŒºåŸŸçš„å®½åº¦ï¼ŒåŒ…å«å‚ç›´æ»šåŠ¨æ¡ outerHeight æ•´ä¸ªçª—å£é«˜åº¦ outerWidth æ•´ä¸ªçª—å£å®½åº¦ è·å¾—ä¸åŒ…å«æ»šåŠ¨æ¡çš„çª—å£å®½åº¦ï¼Œè¦ç”¨ï¼š\ndocument.documentElement.clientWidth\n:memo: Note æµè§ˆå™¨çš„å¤–å®½æŒ‡çš„æ˜¯ æµè§ˆå™¨çª—å£è¾¹æ¡† çš„å®½åº¦ã€‚\nå½“æµè§ˆå™¨çª—å£å…¨å±æ—¶ï¼šæµè§ˆå™¨çš„å¤–å®½ == æµè§ˆå™¨å†…å®½åŒ…å«æ»šåŠ¨æ¡ å½“æµè§ˆå™¨çª—å£ä¸å…¨å±æ—¶ï¼šæµè§ˆå™¨çš„å¤–å®½ \u0026gt; æµè§ˆå™¨å†…å®½åŒ…å«æ»šåŠ¨æ¡ Resize åœ¨çª—å£å¤§å°æ”¹å˜ä¹‹åï¼Œå°±ä¼šè§¦å‘ resize äº‹ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ window.onresize æˆ–è€… window.addEventListener('resize') æ¥ç»‘å®šäº‹ä»¶å¤„ç†å‡½æ•°ã€‚\nScrool window.scrollY å±æ€§è¡¨ç¤ºåœ¨å‚ç›´æ–¹å‘å·²æ»šåŠ¨çš„åƒç´ å€¼ã€‚\ndocument.documentElement.scrollTop å±æ€§ä¹Ÿè¡¨ç¤ºçª—å£å·åŠ¨é«˜åº¦ã€‚\n// å¯ä»¥åˆ©ç”¨æ­¤ç§æ–¹å¼è·å¾—çª—å£å·åŠ¨çš„é«˜åº¦ var scrollTop = window.scrollY || document.documentElement.scrollTop; :memo: Note\ndocument.documentElement.scrollTop æ˜¯å¯ä»¥æ‰‹åŠ¨ç»™å®šå€¼çš„ï¼Œä»¥è¾¾åˆ°è·³åŠ¨åˆ°ä»»ä½•æŒ‡å®šæ»šåŠ¨é«˜åº¦å¤„ window.scrollY æ˜¯åªè¯» çš„ï¼Œä¸å¯ä»¥æ‰‹åŠ¨ç»™å€¼ åœ¨çª—å£è¢«å·åŠ¨ä¹‹åï¼Œå°±ä¼šè§¦å‘ scroll äº‹ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ï¼š\nwindow.onscroll æˆ–è€… window.addEventListener('scroll') æ¥ç»‘å®šäº‹ä»¶å¤„ç†å‡½æ•°ã€‚\n:page_with_curl: Example 1 è¿”å›é¡¶éƒ¨æŒ‰é’®åˆ¶ä½œ\nè¿”å›é¡¶éƒ¨çš„åŸç†ï¼šæ”¹å˜ document.documentElement.scrollTop å±æ€§ï¼Œé€šè¿‡å®šæ—¶å™¨é€æ­¥æ”¹å˜æ­¤å€¼ï¼Œåˆ™å°†ç”¨åŠ¨ç”»å½¢å¼è¿”å›é¡¶éƒ¨ã€‚\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Document\u0026lt;/title\u0026gt; \u0026lt;style\u0026gt; body { height: 5000px; background-image: linear-gradient(to bottom, rgb(255, 0, 149), rgb(7, 185, 255), rgb(0, 255, 76)); } .backtotop { width: 60px; height: 60px; background-color: rgba(255, 255, 255, .6); position: fixed; bottom: 100px; right: 100px; /* å°æ‰‹çŠ¶ */ cursor: pointer; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;backtotop\u0026#34; id=\u0026#34;backtotopBtn\u0026#34;\u0026gt;è¿”å›é¡¶éƒ¨\u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; var backtotopBtn = document.getElementById(\u0026#39;backtotopBtn\u0026#39;); var timer; backtotopBtn.onclick = function () { // è®¾è¡¨å…ˆå…³ clearInterval(timer); // è®¾ç½®å®šæ—¶å™¨ timer = setInterval(function () { // ä¸æ–­è®©scrollTopå‡å°‘ document.documentElement.scrollTop -= 200; // å®šæ—¶å™¨è‚¯å®šè¦åœ if (document.documentElement.scrollTop \u0026lt;= 0) { clearInterval(timer); } }, 20); }; \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; :page_with_curl: Example 2 æ¥¼å±‚å¯¼èˆªå°æ•ˆæœ\nDOM å…ƒç´ éƒ½æœ‰ offsetTop å±æ€§ï¼Œè¡¨ç¤ºæ­¤å…ƒç´ åˆ°å®šä½ç¥–å…ˆå…ƒç´ çš„å‚ç›´è·ç¦»ã€‚\nå®šä½ç¥–å…ˆå…ƒç´ ï¼šåœ¨ç¥–å…ˆä¸­ï¼Œç¦»è‡ªå·±æœ€è¿‘çš„ä¸”æ‹¥æœ‰å®šä½å±æ€§çš„å…ƒç´ ã€‚\nå³ï¼šoffsetTop å±æ€§å¯ä»¥å¾—åˆ°è¯¥å…ƒç´ ä¸ç¦»è‡ªå·±æœ€è¿‘ä¸”æ‹¥æœ‰å®šä½çš„ç¥–å…ˆå…ƒç´ é¡¶éƒ¨çš„è·ç¦»å€¼ã€‚\nå‡å¦‚ï¼Œæ²¡æœ‰ç¥–å…ˆæœ‰å®šä½ï¼Œé‚£ä¹ˆç›´æ¥å¾—åˆ°è¯¥å…ƒç´ è·ç¦»é¡µé¢é¡¶éƒ¨çš„è·ç¦»å€¼ã€‚\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Document\u0026lt;/title\u0026gt; \u0026lt;style\u0026gt; * { margin: 0; padding: 0; } .content-part { width: 1000px; margin: 0px auto; margin-bottom: 30px; background-color: #ccc; font-size: 50px; } .floornav { position: fixed; right: 40px; top: 50%; margin-top: -100px; width: 120px; height: 200px; background-color: orange; } .floornav ul { list-style: none; } .floornav ul li { width: 120px; height: 40px; line-height: 40px; text-align: center; font-size: 26px; /* å°æ‰‹æŒ‡é’ˆ */ cursor: pointer; } .floornav ul li.current { background: purple; color: white; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;nav class=\u0026#34;floornav\u0026#34;\u0026gt; \u0026lt;ul id=\u0026#34;list\u0026#34;\u0026gt; \u0026lt;li data-n=\u0026#34;ç§‘æŠ€\u0026#34; class=\u0026#34;current\u0026#34;\u0026gt;ç§‘æŠ€\u0026lt;/li\u0026gt; \u0026lt;li data-n=\u0026#34;ä½“è‚²\u0026#34;\u0026gt;ä½“è‚²\u0026lt;/li\u0026gt; \u0026lt;li data-n=\u0026#34;æ–°é—»\u0026#34;\u0026gt;æ–°é—»\u0026lt;/li\u0026gt; \u0026lt;li data-n=\u0026#34;å¨±ä¹\u0026#34;\u0026gt;å¨±ä¹\u0026lt;/li\u0026gt; \u0026lt;li data-n=\u0026#34;è§†é¢‘\u0026#34;\u0026gt;è§†é¢‘\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;/nav\u0026gt; \u0026lt;section class=\u0026#34;content-part\u0026#34; style=\u0026#34;height:674px;\u0026#34; data-n=\u0026#34;ç§‘æŠ€\u0026#34;\u0026gt; ç§‘æŠ€æ ç›® \u0026lt;/section\u0026gt; \u0026lt;section class=\u0026#34;content-part\u0026#34; style=\u0026#34;height:567px;\u0026#34; data-n=\u0026#34;ä½“è‚²\u0026#34;\u0026gt; ä½“è‚²æ ç›® \u0026lt;/section\u0026gt; \u0026lt;section class=\u0026#34;content-part\u0026#34; style=\u0026#34;height:739px;\u0026#34; data-n=\u0026#34;æ–°é—»\u0026#34;\u0026gt; æ–°é—»æ ç›® \u0026lt;/section\u0026gt; \u0026lt;section class=\u0026#34;content-part\u0026#34; style=\u0026#34;height:574px;\u0026#34; data-n=\u0026#34;å¨±ä¹\u0026#34;\u0026gt; å¨±ä¹æ ç›® \u0026lt;/section\u0026gt; \u0026lt;section class=\u0026#34;content-part\u0026#34; style=\u0026#34;height:1294px;\u0026#34; data-n=\u0026#34;è§†é¢‘\u0026#34;\u0026gt; è§†é¢‘æ ç›® \u0026lt;/section\u0026gt; \u0026lt;script\u0026gt; // ä½¿ç”¨äº‹ä»¶å§”æ‰˜ç»™liæ·»åŠ ç›‘å¬ var list = document.getElementById(\u0026#39;list\u0026#39;); var contentParts = document.querySelectorAll(\u0026#39;.content-part\u0026#39;); var lis = document.querySelectorAll(\u0026#39;#list li\u0026#39;); list.onclick = function (e) { if (e.target.tagName.toLowerCase() == \u0026#39;li\u0026#39;) { // getAttributeè¡¨ç¤ºå¾—åˆ°æ ‡ç­¾èº«ä¸Šçš„æŸä¸ªå±æ€§å€¼ var n = e.target.getAttribute(\u0026#39;data-n\u0026#39;); // å¯ä»¥ç”¨å±æ€§é€‰æ‹©å™¨(å°±æ˜¯æ–¹æ‹¬å·é€‰æ‹©å™¨)æ¥å¯»æ‰¾å¸¦æœ‰ç›¸åŒdata-nçš„content-part var contentPart = document.querySelector(\u0026#39;.content-part[data-n=\u0026#39; + n + \u0026#39;]\u0026#39;); // è®©é¡µé¢çš„å·åŠ¨è‡ªåŠ¨æˆä¸ºè¿™ä¸ªç›’å­çš„offsetTopå€¼ document.documentElement.scrollTop = contentPart.offsetTop; } } // åœ¨é¡µé¢åŠ è½½å¥½ä¹‹åï¼Œå°†æ‰€æœ‰çš„content-partç›’å­çš„offsetTopå€¼æ¨å…¥æ•°ç»„ var offsetTopArr = []; // éå†æ‰€æœ‰çš„contentPartï¼Œå°†å®ƒä»¬çš„å‡€ä½ç½®æ¨å…¥æ•°ç»„ for (var i = 0; i \u0026lt; contentParts.length; i++) { offsetTopArr.push(contentParts[i].offsetTop); } // ä¸ºäº†æœ€åä¸€é¡¹å¯ä»¥æ–¹ä¾¿æ¯”è¾ƒï¼Œæˆ‘ä»¬å¯ä»¥æ¨å…¥ä¸€ä¸ªæ— ç©·å¤§ offsetTopArr.push(Infinity); console.log(offsetTopArr); // å½“å‰æ‰€åœ¨æ¥¼å±‚ var nowfloor = -1; // çª—å£çš„å·åŠ¨ window.onscroll = function () { // å¾—åˆ°å½“å‰çš„çª—å£å·åŠ¨å€¼ var scrollTop = document.documentElement.scrollTop; // éå†offsetTopArræ•°ç»„ï¼Œçœ‹çœ‹å½“å‰çš„scrollTopå€¼åœ¨å“ªä¸¤ä¸ªæ¥¼å±‚ä¹‹é—´ for (var i = 0; i \u0026lt; offsetTopArr.length; i++) { if (scrollTop \u0026gt;= offsetTopArr[i] \u0026amp;\u0026amp; scrollTop \u0026lt; offsetTopArr[i + 1]) { break; } } // é€€å‡ºå¾ªç¯çš„æ—¶å€™ï¼Œiæ˜¯å‡ ï¼Œå°±è¡¨ç¤ºå½“å‰æ¥¼å±‚æ˜¯å‡  // å¦‚æœå½“å‰æ‰€åœ¨æ¥¼å±‚ï¼Œä¸æ˜¯iï¼Œè¡¨ç¤ºç¯æ¥¼äº† if (nowfloor != i) { console.log(i); // è®©å…¨å±€å˜é‡æ”¹å˜ä¸ºè¿™ä¸ªæ¥¼å±‚å· nowfloor = i; // è®¾ç½®ä¸‹æ ‡ä¸ºiçš„é¡¹æœ‰cur for (var j = 0; j \u0026lt; lis.length; j++) { if (j == i) { lis[j].className = \u0026#39;current\u0026#39;; } else { lis[j].className = \u0026#39;\u0026#39;; } } } }; \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Navigator\nwindow.navigator å±æ€§å¯ä»¥æ£€ç´¢ navigator å¯¹è±¡ï¼Œå®ƒå†…éƒ¨å«æœ‰ç”¨æˆ·æ­¤æ¬¡æ´»åŠ¨çš„æµè§ˆå™¨çš„ç›¸å…³å±æ€§å’Œæ ‡è¯†ã€‚\nå±æ€§ æ„ä¹‰ appName æµè§ˆå™¨å®˜æ–¹åç§° appVersion æµè§ˆå™¨ç‰ˆæœ¬ userAgent æµè§ˆå™¨ç”¨æˆ·ä»£ç†ï¼ˆå«æœ‰å†…æ ¸ä¿¡æ¯å’Œå°è£…å£³ä¿¡æ¯ï¼‰ platform ç”¨æˆ·æ“ä½œç³»ç»Ÿ :memo: Note\nè¯†åˆ«ç”¨æˆ·æµè§ˆå™¨å“ç‰Œé€šå¸¸ä½¿ç”¨ navigator.userAgent å±æ€§ã€‚\nconst sUsrAg = navigator.userAgent; if (sUsrAg.indexOf(\u0026#34;Firefox\u0026#34;) \u0026gt; -1) { } else if (sUsrAg.indexOf(\u0026#34;Opera\u0026#34;) \u0026gt; -1) { } else if (sUsrAg.indexOf(\u0026#34;Edge\u0026#34;) \u0026gt; -1) { } else if (sUsrAg.indexOf(\u0026#34;Chrome\u0026#34;) \u0026gt; -1) { } else if (sUsrAg.indexOf(\u0026#34;Safari\u0026#34;) \u0026gt; -1) { } else { } æµè§ˆ History window.history å¯¹è±¡æä¾›äº†æ“ä½œæµè§ˆå™¨ä¼šè¯å†å²çš„æ¥å£ã€‚\nå¸¸ç”¨æ“ä½œå°±æ˜¯æ¨¡æ‹Ÿæµè§ˆå™¨ å›é€€ æŒ‰é’®ã€‚\nhistory.back();\t// ç­‰åŒäºç‚¹å‡»æµè§ˆå™¨çš„å›é€€æŒ‰é’® history.go(-1);\t// ç­‰åŒäº history.back(); Location window.location æ ‡è¯†å½“å‰æ‰€åœ¨ç½‘å€ï¼Œå¯ä»¥é€šè¿‡ç»™è¿™ä¸ªå±æ€§èµ‹å€¼å‘½ä»¤æµè§ˆå™¨è¿›è¡Œé¡µé¢è·³è½¬ã€‚\nå¯ä»¥è°ƒç”¨ location çš„ reload æ–¹æ³•ä»¥é‡æ–°åŠ è½½å½“å‰é¡µé¢ï¼Œå‚æ•° true è¡¨ç¤ºå¼ºåˆ¶ä»æœåŠ¡å™¨åŠ è½½ã€‚\nwindow.location.reload(true); window.location.search å±æ€§å³ä¸ºå½“å‰æµè§ˆå™¨çš„ GET è¯·æ±‚æŸ¥è¯¢å‚æ•°ã€‚\næ¯”å¦‚ç½‘å€ï¼šhttps://www.imooc.com/?a=1\u0026amp;b=2\nconsole.log(window.location.search);\t// \u0026#34;?a=1\u0026amp;b=2\u0026#34; å…³äº GET åŠ POST çš„è¯¦ç»†å†…å®¹åœ¨ Ajax ä¸­ä»‹ç»ã€‚\nTrick è·å–å…¨å±€å¯¹è±¡ [æ¶ˆé™¤é­”æœ¯å­—ç¬¦ä¸²](06 EcmaScript.md/#magic-string) é“¾å¼å†™æ³• ä¸º Array.prototype.push() æ·»åŠ é“¾å¼å†™æ³•\nArray.prototype.Push = function (item) { this.push(item); return this; } let arr = Array().Push(\u0026#39;red\u0026#39;).Push(\u0026#39;green\u0026#39;).Push(\u0026#39;blue\u0026#39;); for (let key of arr.keys()) { console.log(key); } // 0 1 2 for (let value of arr.values()) { console.log(value); } // red green blue for (let entry of arr.entries()) { console.log(entry); } // [0, \u0026#39;red\u0026#39;] [1, \u0026#39;green\u0026#39;] [2, \u0026#39;blue\u0026#39;] [å¼‚æ­¥å¤„ç†æ³•](06 EcmaScript.md#trick-asynchronous-processing-es6) åŒ…è£…ç±»å‹ ","date":"2023-03-20","section":"techs","summary":"JavaScript å¯¼è®º æ˜¯ä¸€ç§å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„è„šæœ¬è¯­è¨€\næµè§ˆå™¨ç«¯çš„åŠ¨ä½œ ç”¨æˆ·äº¤äº’ æ•°æ®å¤„ç† å’Œ Java åŒºåˆ«ï¼š\nJava éœ€è¦ ç¼–è¯‘ JavaScript æ˜¯ è§£é‡Šæ€§ è¯­è¨€ JavaScript æºä»£ç æ”¾åœ¨ HTML é‡Œ JavaScript ç”± EcmaScript (JavaScriptè¯­æ³•)ã€DOM (é¡µé¢æ–‡æ¡£å¯¹è±¡æ¨¡å‹)ã€BOM (æµè§ˆå™¨å¯¹è±¡æ¨¡å‹) ç»„æˆã€‚\n1997 å¹´ï¼Œæ¬§æ´²è®¡ç®—æœºåˆ¶é€ å•†åä¼š ECMA è®¾ç½®äº† JavaScript çš„æ ‡å‡†ï¼Œå‘½åä¸º ECMAScriptã€‚\nJavaScript å®ç°äº† EcmaScript\nEcmaScript è§„èŒƒäº† JavaScript\nåŒºåˆ« å‰ç«¯è¯­è¨€ï¼šå¤„ç† ç•Œé¢ ï¼ˆHTMLã€CSSã€JavaScriptã€â€¦â€¦ï¼‰\nåç«¯è¯­è¨€ï¼šå¤„ç† æ•°æ® ï¼ˆJavaã€PHPã€Pythonã€Goã€â€¦â€¦ï¼‰\næµè§ˆå™¨/APPå‰ç«¯\tâ‡† HTTP åè®® â‡† æœåŠ¡å™¨åç«¯\nä¼ ç»Ÿçš„ JS æ˜¯ä¸€é—¨å‰ç«¯è¯­è¨€ï¼Œåªèƒ½è¿è¡Œåœ¨æµè§ˆå™¨ç«¯ï¼Œä¸èƒ½åœ¨æœåŠ¡å™¨ç«¯å¤„ç†æ•°æ®ã€‚\nåœ¨ 2009 å¹´ï¼Œè¯ç”Ÿäº† Node.js ï¼Œè¿™æ˜¯ä¸€ä¸ª JavaScript çš„æœåŠ¡ç«¯è¿è¡Œå¹³å°ã€‚\nNode.js å‡ºç°åï¼ŒJavaScript å¼€å§‹æ”¯æŒåç«¯ã€‚\nå¼•å…¥ è¡Œå†…å¼ JS ç›´æ¥å†™åˆ°å…ƒç´ çš„å†…éƒ¨ å¯ä»¥å°†å•è¡Œæˆ–å°‘é‡ JS ä»£ç å†™åœ¨ HTML æ ‡ç­¾çš„äº‹ä»¶å±æ€§ä¸­ï¼ˆä»¥ on å¼€å¤´çš„å±æ€§ï¼‰ï¼Œå¦‚ï¼šonclick æ³¨æ„å•åŒå¼•å·çš„ä½¿ç”¨ï¼šåœ¨HTMLä¸­æˆ‘ä»¬æ¨èä½¿ç”¨ åŒå¼•å· ï¼ŒJSä¸­æˆ‘ä»¬æ¨èä½¿ç”¨ å•å¼•å· å¯è¯»æ€§å·®ï¼Œåœ¨ HTML ä¸­ç¼–å†™å¤§é‡ä»£ç æ—¶ï¼Œä¸æ–¹ä¾¿é˜…è¯» å¼•å·æ˜“é”™ï¼Œå¼•å·å¤šå±‚åµŒå¥—åŒ¹é…æ—¶ï¼Œéå¸¸å®¹æ˜“å¼„æ·· ç‰¹æ®Šæƒ…å†µä¸‹ä½¿ç”¨ \u0026lt;input type=\u0026#34;button\u0026#34; value=\u0026#34; \u0026#34; onAction=\u0026#34; \u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;button\u0026#34; value=\u0026#34;è¿™æ˜¯ä¸€ä¸ªæŒ‰é’®\u0026#34; onclick=\u0026#34;alert(\u0026#39;Hello World!\u0026#39;);\u0026#34;\u0026gt; å†…åµŒå¼ å®šä¹‰åœ¨ head ä¸­ å¯ä»¥å°†å¤šè¡Œ JS ä»£ç å†™å…¥ script æ ‡ç­¾ä¸­ å†…åµŒ JS æ˜¯å­¦ä¹ æ—¶å¸¸ç”¨çš„æ–¹å¼ \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;zh\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Title\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body onload=\u0026#34;alert(\u0026#39;hi\u0026#39;)\u0026#34;\u0026gt; \u0026lt;!--onloadå±æ€§è½½å…¥--\u0026gt; \u0026lt;script\u0026gt; document.write(\u0026#34;\u0026lt;h1\u0026gt;hello World!\u0026lt;/h1\u0026gt;\u0026#34;); console.log(\u0026#34;hello world!\u0026#34;); //.æ˜¯ä¸€ä¸ªè¿ç®—ç¬¦ \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; // e.g.: /* 1. äº‹ä»¶å¤„ç†å™¨ */ onMouseOver=\u0026#34;alert(\u0026#39;hi\u0026#39;);\u0026#34; //-\u0026gt; bodyäº‹ä»¶ - onLoad - onUnload - etc... /* 2. ç®€å•å¯¹è¯æ¡† */ //-\u0026gt; - alert() - confirm() - prompt() /* 3. å®šæ—¶å™¨ */ //-\u0026gt; - setInterval() \u0026gt;\u0026gt; let count = 5; let update = () =\u0026gt; { if (count\u0026gt;0) count--; document.title=count; } setInterval(update, 1000); - setTimeOut() å¤–éƒ¨å¼•å…¥ script åŒæ ‡ç­¾ åˆ©äºæŠŠ HTML ç»“æ„åŒ–ï¼Œæ–¹ä¾¿æ–‡ä»¶çš„å¤ç”¨ åŒæ ‡ç­¾ï¼Œæœ‰ src å±æ€§åæ ‡ç­¾ä¸­é—´ä¸èƒ½å†™ä»£ç  \u0026lt;script src=\u0026#34;my.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;!-- Obsolete syntax - Before HTML5 --\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; I/O ç±»ä¼¼ Javaï¼Œ JavaScript æä¾›äº†ä¸€äº›å¸¸ç”¨çš„è¾“å…¥è¾“å‡ºè¯­å¥ã€‚\n","title":"05 JavaScript","url":"/techs/05-javascript/"},{"content":"EcmaScript ES6 ä¹Ÿå³ ECMAScript è¿™é—¨æ ‡å‡†çš„ç¬¬ 6 ä»£ç‰ˆæœ¬ - 2015ã€‚\nECMAï¼šæ¬§æ´²è®¡ç®—æœºåˆ¶é€ å•†åä¼š\nå…·ä½“å†…å®¹ï¼šè¯­æ³• + API\nå†å²ç‰ˆæœ¬ï¼šES1 â†’ ES3 | ES5 â†’ ES6 ï¼Œä¹‹åæ¯å¹´å‡ºä¸€ä¸ªæ–°ç‰ˆæœ¬\nç›®å‰ä½¿ç”¨ JS çš„å¤§éƒ¨åˆ†å†…å®¹æ¥è‡ª ES3\nES ä¸ JS çš„å…³ç³»ï¼š\nJavaScriptæµè§ˆå™¨ç«¯ = ESMAScriptè¯­æ³•+API + DOM + BOM\nES6 çš„å…¼å®¹æ€§ï¼š\nä¸»æµæµè§ˆå™¨çš„æœ€æ–°ç‰ˆæœ¬å‡ ä¹éƒ½å…¨éƒ¨æ”¯æŒ ES6 IE è€ç‰ˆæœ¬ç­‰ä¸æ”¯æŒçš„æµè§ˆå™¨ï¼Œå¯ä»¥ä½¿ç”¨ Babel è½¬ç  æ€»ä¹‹ï¼Œè¯·æ”¾å¿ƒå¤§èƒ†åœ°ä½¿ç”¨ ES6 ES6 æ–°å¢äº†è¿™äº›ç‰¹æ€§ï¼š\nè¡¨è¾¾å¼ï¼šå£°æ˜ã€è§£æ„èµ‹å€¼\nå†…ç½®å¯¹è±¡ï¼šå­—ç¬¦ä¸²æ‰©å±•ã€æ•°å€¼æ‰©å±•ã€å¯¹è±¡æ‰©å±•ã€æ•°ç»„æ‰©å±•ã€å‡½æ•°æ‰©å±•ã€æ­£åˆ™æ‰©å±•ã€Symbolã€Setã€Mapã€Proxyã€Reflect\nè¯­å¥ä¸è¿ç®—ï¼šClass, Module, Iterator\nå¼‚æ­¥ç¼–ç¨‹ï¼šPromise, Generator, Async\nä¸¥æ ¼æ¨¡å¼ ä» ES5 å¼€å§‹ï¼Œå‡½æ•°å†…éƒ¨å¯ä»¥è®¾å®šä¸ºä¸¥æ ¼æ¨¡å¼ã€‚\nä¸¥æ ¼æ¨¡å¼æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š\nå˜é‡å¿…é¡»å£°æ˜åå†ä½¿ç”¨\nå‡½æ•°çš„å‚æ•°ä¸èƒ½æœ‰åŒåå±æ€§ï¼Œå¦åˆ™æŠ¥é”™\nä¸èƒ½ä½¿ç”¨ with è¯­å¥\nä¸èƒ½å¯¹ åªè¯»*^readonly^* å±æ€§èµ‹å€¼ï¼Œå¦åˆ™æŠ¥é”™\nä¸èƒ½ä½¿ç”¨å‰ç¼€ 0 è¡¨ç¤ºå…«è¿›åˆ¶æ•°ï¼Œå¦åˆ™æŠ¥é”™\nä¸èƒ½åˆ é™¤ä¸å¯åˆ é™¤çš„å±æ€§ï¼Œå¦åˆ™æŠ¥é”™\nä¸èƒ½åˆ é™¤å˜é‡ delete prop ï¼Œä¼šæŠ¥é”™ï¼Œåªèƒ½åˆ é™¤å±æ€§ delete global[prop]\neval ä¸ä¼šåœ¨å®ƒçš„å¤–å±‚ä½œç”¨åŸŸå¼•å…¥å˜é‡\neval å’Œ arguments ä¸èƒ½è¢«é‡æ–°èµ‹å€¼\narguments ä¸ä¼šè‡ªåŠ¨åæ˜ å‡½æ•°å‚æ•°çš„å˜åŒ–\nä¸èƒ½ä½¿ç”¨ arguments.callee / arguments.caller\nç¦æ­¢ this æŒ‡å‘å…¨å±€å¯¹è±¡\nä¸èƒ½ä½¿ç”¨ fn.caller å’Œ fn.arguments è·å–å‡½æ•°è°ƒç”¨çš„å †æ ˆ\nå¢åŠ äº†ä¿ç•™å­—\ne.g.: protected, static, interface\nfunction doSomething(a, b) { \u0026#39;use strict\u0026#39;; // code } ES2016 åšäº†ä¸€ç‚¹ä¿®æ”¹ï¼Œè§„å®šåªè¦å‡½æ•°å‚æ•°ä½¿ç”¨äº†é»˜è®¤å€¼ã€è§£æ„èµ‹å€¼ã€æˆ–è€…æ‰©å±•è¿ç®—ç¬¦ï¼Œé‚£ä¹ˆå‡½æ•°å†…éƒ¨å°±ä¸èƒ½æ˜¾å¼è®¾å®šä¸ºä¸¥æ ¼æ¨¡å¼ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚\n// æŠ¥é”™ function doSomething(a, b = a) { \u0026#39;use strict\u0026#39;; // code } // æŠ¥é”™ const doSomething = function ({a, b}) { \u0026#39;use strict\u0026#39;; // code }; // æŠ¥é”™ const doSomething = (...a) =\u0026gt; { \u0026#39;use strict\u0026#39;; // code }; const obj = { // æŠ¥é”™ doSomething({a, b}) { \u0026#39;use strict\u0026#39;; // code } }; è¿™æ ·è§„å®šçš„åŸå› æ˜¯ï¼Œå‡½æ•°å†…éƒ¨çš„ä¸¥æ ¼æ¨¡å¼ï¼ŒåŒæ—¶é€‚ç”¨äºå‡½æ•°ä½“å’Œå‡½æ•°å‚æ•°ã€‚ä½†æ˜¯ï¼Œå‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œå…ˆæ‰§è¡Œå‡½æ•°å‚æ•°ï¼Œç„¶åå†æ‰§è¡Œå‡½æ•°ä½“ã€‚è¿™æ ·å°±æœ‰ä¸€ä¸ªä¸åˆç†çš„åœ°æ–¹ï¼Œåªæœ‰ä»å‡½æ•°ä½“ä¹‹ä¸­ï¼Œæ‰èƒ½çŸ¥é“å‚æ•°æ˜¯å¦åº”è¯¥ä»¥ä¸¥æ ¼æ¨¡å¼æ‰§è¡Œï¼Œä½†æ˜¯å‚æ•°å´åº”è¯¥å…ˆäºå‡½æ•°ä½“æ‰§è¡Œã€‚\n// æŠ¥é”™ function doSomething(value = 070) { \u0026#39;use strict\u0026#39;; return value; } ä¸Šé¢ä»£ç ä¸­ï¼Œå‚æ•°valueçš„é»˜è®¤å€¼æ˜¯å…«è¿›åˆ¶æ•°070ï¼Œä½†æ˜¯ä¸¥æ ¼æ¨¡å¼ä¸‹ä¸èƒ½ç”¨å‰ç¼€0è¡¨ç¤ºå…«è¿›åˆ¶ï¼Œæ‰€ä»¥åº”è¯¥æŠ¥é”™ã€‚ä½†æ˜¯å®é™…ä¸Šï¼ŒJavaScript å¼•æ“ä¼šå…ˆæˆåŠŸæ‰§è¡Œvalue = 070ï¼Œç„¶åè¿›å…¥å‡½æ•°ä½“å†…éƒ¨ï¼Œå‘ç°éœ€è¦ç”¨ä¸¥æ ¼æ¨¡å¼æ‰§è¡Œï¼Œè¿™æ—¶æ‰ä¼šæŠ¥é”™ã€‚\nè™½ç„¶å¯ä»¥å…ˆè§£æå‡½æ•°ä½“ä»£ç ï¼Œå†æ‰§è¡Œå‚æ•°ä»£ç ï¼Œä½†æ˜¯è¿™æ ·æ— ç–‘å°±å¢åŠ äº†å¤æ‚æ€§ã€‚å› æ­¤ï¼Œæ ‡å‡†ç´¢æ€§ç¦æ­¢äº†è¿™ç§ç”¨æ³•ï¼Œåªè¦å‚æ•°ä½¿ç”¨äº†é»˜è®¤å€¼ã€è§£æ„èµ‹å€¼ã€æˆ–è€…æ‰©å±•è¿ç®—ç¬¦ï¼Œå°±ä¸èƒ½æ˜¾å¼æŒ‡å®šä¸¥æ ¼æ¨¡å¼ã€‚\nğŸ“ Note ä¸¤ç§æ–¹æ³•å¯ä»¥è§„é¿è¿™ç§é™åˆ¶ã€‚\nè®¾å®šå…¨å±€æ€§çš„ä¸¥æ ¼æ¨¡å¼ï¼Œè¿™æ˜¯åˆæ³•çš„ã€‚ \u0026#39;use strict\u0026#39;; function doSomething(a, b = a) { // code } æŠŠå‡½æ•°åŒ…åœ¨ä¸€ä¸ªæ— å‚æ•°çš„ ç«‹å³æ‰§è¡Œå‡½æ•°IIFE é‡Œé¢ã€‚ const doSomething = (function () { \u0026#39;use strict\u0026#39;; return function(value = 42) { return value; }; }()); ç¼–ç¨‹é£æ ¼ å—çº§ä½œç”¨åŸŸ let å–ä»£ var ES6 æå‡ºäº†ä¸¤ä¸ªæ–°çš„å£°æ˜å˜é‡çš„å‘½ä»¤ï¼š let å’Œ const ã€‚å…¶ä¸­ï¼Œ let å®Œå…¨å¯ä»¥å–ä»£varï¼Œå› ä¸ºä¸¤è€…è¯­ä¹‰ç›¸åŒï¼Œè€Œä¸” let æ²¡æœ‰å‰¯ä½œç”¨ã€‚\n\u0026#39;use strict\u0026#39;; if (true) { let x = \u0026#39;hello\u0026#39;; } for (let i = 0; i \u0026lt; 10; i++) { console.log(i); } ä¸Šé¢ä»£ç å¦‚æœç”¨varæ›¿ä»£ let ï¼Œå®é™…ä¸Šå°±å£°æ˜äº†ä¸¤ä¸ªå…¨å±€å˜é‡ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯æœ¬æ„ã€‚å˜é‡åº”è¯¥åªåœ¨å…¶å£°æ˜çš„ä»£ç å—å†…æœ‰æ•ˆï¼Œvarå‘½ä»¤åšä¸åˆ°è¿™ä¸€ç‚¹ã€‚\nvarå‘½ä»¤å­˜åœ¨å˜é‡æå‡æ•ˆç”¨ï¼Œ let å‘½ä»¤æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚\n\u0026#39;use strict\u0026#39;; if (true) { console.log(x); // ReferenceError let x = \u0026#39;hello\u0026#39;; } ä¸Šé¢ä»£ç å¦‚æœä½¿ç”¨varæ›¿ä»£ let ï¼Œconsole.logé‚£ä¸€è¡Œå°±ä¸ä¼šæŠ¥é”™ï¼Œè€Œæ˜¯ä¼šè¾“å‡ºundefinedï¼Œå› ä¸ºå˜é‡å£°æ˜æå‡åˆ°ä»£ç å—çš„å¤´éƒ¨ã€‚è¿™è¿åäº†å˜é‡å…ˆå£°æ˜åä½¿ç”¨çš„åŸåˆ™ã€‚\næ‰€ä»¥ï¼Œå»ºè®®ä¸å†ä½¿ç”¨varå‘½ä»¤ï¼Œè€Œæ˜¯ä½¿ç”¨ let å‘½ä»¤å–ä»£ã€‚\nå…¨å±€å¸¸é‡å’Œçº¿ç¨‹å®‰å…¨ åœ¨ let å’Œ const ä¹‹é—´ï¼Œå»ºè®®ä¼˜å…ˆä½¿ç”¨ const ï¼Œå°¤å…¶æ˜¯åœ¨å…¨å±€ç¯å¢ƒï¼Œä¸åº”è¯¥è®¾ç½®å˜é‡ï¼Œåªåº”è®¾ç½®å¸¸é‡ã€‚\nconst ä¼˜äº let æœ‰å‡ ä¸ªåŸå› ã€‚ä¸€ä¸ªæ˜¯ const å¯ä»¥æé†’é˜…è¯»ç¨‹åºçš„äººï¼Œè¿™ä¸ªå˜é‡ä¸åº”è¯¥æ”¹å˜ï¼›å¦ä¸€ä¸ªæ˜¯ const æ¯”è¾ƒç¬¦åˆå‡½æ•°å¼ç¼–ç¨‹æ€æƒ³ï¼Œè¿ç®—ä¸æ”¹å˜å€¼ï¼Œåªæ˜¯æ–°å»ºå€¼ï¼Œè€Œä¸”è¿™æ ·ä¹Ÿæœ‰åˆ©äºå°†æ¥çš„åˆ†å¸ƒå¼è¿ç®—ï¼›æœ€åä¸€ä¸ªåŸå› æ˜¯ JavaScript ç¼–è¯‘å™¨ä¼šå¯¹ const è¿›è¡Œä¼˜åŒ–ï¼Œæ‰€ä»¥å¤šä½¿ç”¨ const ï¼Œæœ‰åˆ©äºæé«˜ç¨‹åºçš„è¿è¡Œæ•ˆç‡ï¼Œä¹Ÿå°±æ˜¯è¯´ let å’Œ const çš„æœ¬è´¨åŒºåˆ«ï¼Œå…¶å®æ˜¯ç¼–è¯‘å™¨å†…éƒ¨çš„å¤„ç†ä¸åŒã€‚\n// bad var a = 1, b = 2, c = 3; // good const a = 1; const b = 2; const c = 3; // best const [a, b, c] = [1, 2, 3]; const å£°æ˜å¸¸é‡è¿˜æœ‰ä¸¤ä¸ªå¥½å¤„ï¼Œä¸€æ˜¯é˜…è¯»ä»£ç çš„äººç«‹åˆ»ä¼šæ„è¯†åˆ°ä¸åº”è¯¥ä¿®æ”¹è¿™ä¸ªå€¼ï¼ŒäºŒæ˜¯é˜²æ­¢äº†æ— æ„é—´ä¿®æ”¹å˜é‡å€¼æ‰€å¯¼è‡´çš„é”™è¯¯ã€‚\næ‰€æœ‰çš„å‡½æ•°éƒ½åº”è¯¥è®¾ç½®ä¸ºå¸¸é‡ã€‚\né•¿è¿œæ¥çœ‹ï¼ŒJavaScript å¯èƒ½ä¼šæœ‰å¤šçº¿ç¨‹çš„å®ç°ï¼ˆæ¯”å¦‚ Intel å…¬å¸çš„ River Trail é‚£ä¸€ç±»çš„é¡¹ç›®ï¼‰ï¼Œè¿™æ—¶ let è¡¨ç¤ºçš„å˜é‡ï¼Œåªåº”å‡ºç°åœ¨å•çº¿ç¨‹è¿è¡Œçš„ä»£ç ä¸­ï¼Œä¸èƒ½æ˜¯å¤šçº¿ç¨‹å…±äº«çš„ï¼Œè¿™æ ·æœ‰åˆ©äºä¿è¯çº¿ç¨‹å®‰å…¨ã€‚\nå­—ç¬¦ä¸² é™æ€å­—ç¬¦ä¸²ä¸€å¾‹ä½¿ç”¨å•å¼•å·æˆ–åå¼•å·ï¼Œä¸ä½¿ç”¨åŒå¼•å·ã€‚åŠ¨æ€å­—ç¬¦ä¸²ä½¿ç”¨åå¼•å·ã€‚\n// bad const a = \u0026#34;foobar\u0026#34;; const b = \u0026#39;foo\u0026#39; + a + \u0026#39;bar\u0026#39;; // acceptable const c = `foobar`; // good const a = \u0026#39;foobar\u0026#39;; const b = `foo${a}bar`; ğŸ“ƒ Example ä½¿ç”¨æ¨¡ç‰ˆå­—ç¬¦ä¸²${}\nâ\nconst name = \u0026#39;å°æ˜\u0026#39;; const score = 59; let result = \u0026#39;\u0026#39;; if (score \u0026gt; 60) { result = `${name}çš„è€ƒè¯•æˆç»©åŠæ ¼`; } else { result = `${name}çš„è€ƒè¯•æˆç»©ä¸åŠæ ¼`; } âœ…\nåœ¨ æ¨¡ç‰ˆå­—ç¬¦ä¸²${} ä¸­å¯ä»¥æ”¾å…¥ä»»æ„çš„ JavaScript è¡¨è¾¾å¼ï¼Œå¯ä»¥è¿›è¡Œè¿ç®—ï¼Œä»¥åŠå¼•ç”¨å¯¹è±¡å±æ€§ã€‚\nconst name = \u0026#39;å°æ˜\u0026#39;; const score = 59; const result = `${name}${score \u0026gt; 60 ? \u0026#39;çš„è€ƒè¯•æˆç»©åŠæ ¼\u0026#39; : \u0026#39;çš„è€ƒè¯•æˆç»©ä¸åŠæ ¼\u0026#39;}`; è§£æ„èµ‹å€¼ ä½¿ç”¨æ•°ç»„æˆå‘˜å¯¹å˜é‡èµ‹å€¼æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨è§£æ„èµ‹å€¼ã€‚\nconst arr = [1, 2, 3, 4]; // bad const first = arr[0]; const second = arr[1]; // good const [first, second] = arr; å‡½æ•°çš„å‚æ•°å¦‚æœæ˜¯å¯¹è±¡çš„æˆå‘˜ï¼Œä¼˜å…ˆä½¿ç”¨è§£æ„èµ‹å€¼ã€‚\n// bad function getFullName(user) { const firstName = user.firstName; const lastName = user.lastName; } // good function getFullName(obj) { const { firstName, lastName } = obj; } // best function getFullName({ firstName, lastName }) { } å¦‚æœå‡½æ•°è¿”å›å¤šä¸ªå€¼ï¼Œä¼˜å…ˆä½¿ç”¨å¯¹è±¡çš„è§£æ„èµ‹å€¼ï¼Œè€Œä¸æ˜¯æ•°ç»„çš„è§£æ„èµ‹å€¼ã€‚è¿™æ ·ä¾¿äºä»¥åæ·»åŠ è¿”å›å€¼ï¼Œä»¥åŠæ›´æ”¹è¿”å›å€¼çš„é¡ºåºã€‚\n// bad function processInput(input) { return [left, right, top, bottom]; } // good function processInput(input) { return { left, right, top, bottom }; } const { left, right } = processInput(input); å¦‚æœæƒ³åˆ›å»ºçš„ å˜é‡å å’Œå¯¹è±¡çš„ å±æ€§å ä¸ä¸€è‡´ï¼Œå¯ä»¥è¿™ä¹ˆå†™ï¼š\nconst {a:a1} = obj; console.log(a1);// 1 å¯¹è±¡ å•è¡Œå®šä¹‰çš„å¯¹è±¡ï¼Œæœ€åä¸€ä¸ªæˆå‘˜ä¸ä»¥é€—å·ç»“å°¾ã€‚å¤šè¡Œå®šä¹‰çš„å¯¹è±¡ï¼Œæœ€åä¸€ä¸ªæˆå‘˜ä»¥é€—å·ç»“å°¾ã€‚\n// bad const a = { k1: v1, k2: v2, }; const b = { k1: v1, k2: v2 }; // good const a = { k1: v1, k2: v2 }; const b = { k1: v1, k2: v2, }; å¯¹è±¡å°½é‡é™æ€åŒ–ï¼Œä¸€æ—¦å®šä¹‰ï¼Œå°±ä¸å¾—éšæ„æ·»åŠ æ–°çš„å±æ€§ã€‚å¦‚æœæ·»åŠ å±æ€§ä¸å¯é¿å…ï¼Œè¦ä½¿ç”¨Object.assignæ–¹æ³•ã€‚\n// bad const a = {}; a.x = 3; // if reshape unavoidable const a = {}; Object.assign(a, { x: 3 }); // good const a = { x: null }; a.x = 3; å¦‚æœå¯¹è±¡çš„å±æ€§åæ˜¯åŠ¨æ€çš„ï¼Œå¯ä»¥åœ¨åˆ›é€ å¯¹è±¡çš„æ—¶å€™ï¼Œä½¿ç”¨å±æ€§è¡¨è¾¾å¼å®šä¹‰ã€‚\n// bad const obj = { id: 5, name: \u0026#39;San Francisco\u0026#39;, }; obj[getKey(\u0026#39;enabled\u0026#39;)] = true; // good const obj = { id: 5, name: \u0026#39;San Francisco\u0026#39;, [getKey(\u0026#39;enabled\u0026#39;)]: true, }; ä¸Šé¢ä»£ç ä¸­ï¼Œå¯¹è±¡ obj çš„æœ€åä¸€ä¸ªå±æ€§åï¼Œéœ€è¦è®¡ç®—å¾—åˆ°ã€‚è¿™æ—¶æœ€å¥½é‡‡ç”¨å±æ€§è¡¨è¾¾å¼ï¼Œåœ¨æ–°å»º obj çš„æ—¶å€™ï¼Œå°†è¯¥å±æ€§ä¸å…¶ä»–å±æ€§å®šä¹‰åœ¨ä¸€èµ·ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ‰€æœ‰å±æ€§å°±åœ¨ä¸€ä¸ªåœ°æ–¹å®šä¹‰äº†ã€‚\nå¦å¤–ï¼Œå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼Œå°½é‡é‡‡ç”¨ç®€æ´è¡¨è¾¾æ³•ï¼Œè¿™æ ·æ˜“äºæè¿°å’Œä¹¦å†™ã€‚\nvar ref = \u0026#39;some value\u0026#39;; // bad const atom = { ref: ref, value: 1, addValue: function (value) { return atom.value + value; }, }; // good const atom = { ref, value: 1, addValue(value) { return atom.value + value; }, }; ğŸ“ƒ Example å½“å±æ€§ååŠ¨æ€å˜åŒ–æ—¶ï¼Œç»™å¯¹è±¡æ·»åŠ æ–°å±æ€§å¤„ç†ï¼š\nâ\nlet obj = {}; let index = 1; let key = `topic${index}`; obj[key] = \u0026#39;è¯é¢˜å†…å®¹\u0026#39;; âœ…\nES6 ä¸­çš„å¯¹è±¡å±æ€§åæ˜¯å¯ä»¥ç”¨è¡¨è¾¾å¼ç›´æ¥è¿›è¡Œè®¡ç®—ã€‚\nlet obj = {}; let index = 1; obj[`topic${index}`] = \u0026#39;è¯é¢˜å†…å®¹\u0026#39;; æ•°ç»„ ä½¿ç”¨ æ‰©å±•è¿ç®—ç¬¦... æ‹·è´æ•°ç»„ã€‚\n// bad const len = items.length; const itemsCopy = []; let i; for (i = 0; i \u0026lt; len; i++) { itemsCopy[i] = items[i]; } // good const itemsCopy = [...items]; ä½¿ç”¨ Array.from æ–¹æ³•ï¼Œå°†ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡è½¬ä¸ºæ•°ç»„ã€‚\nconst foo = document.querySelectorAll(\u0026#39;.foo\u0026#39;); const nodes = Array.from(foo); ğŸ“ƒ Example åˆå¹¶ä¸¤ä¸ªæ•°ç»„æˆ–ä¸¤ä¸ªå¯¹è±¡ï¼š\nâ\n// æ•°ç»„åˆå¹¶ const a = [1,2,3]; const b = [1,5,6]; const c = a.concat(b); // [1,2,3,1,5,6] // å¯¹è±¡åˆå¹¶ const obj1 = { a:1, } const obj2 = { b:1, } const obj = Object.assign({}, obj1, obj2); // {a:1,b:1} âœ…\nä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦... + new Set() å»é‡\n// æ•°ç»„åˆå¹¶ const a = [1,2,3]; const b = [1,5,6]; const c = [...new Set([...a,...b])];//[1,2,3,5,6] // å¯¹è±¡åˆå¹¶ ä½¿ç”¨...æ‰©å±•è¿ç®—ç¬¦ const obj1 = { a:1, } const obj2 = { b:1, } const obj = {...obj1,...obj2}; // {a:1,b:1} å‡½æ•° ç«‹å³æ‰§è¡Œå‡½æ•°å¯ä»¥å†™æˆç®­å¤´å‡½æ•°çš„å½¢å¼ã€‚\n(() =\u0026gt; { console.log(\u0026#39;Welcome to the Internet.\u0026#39;); })(); é‚£äº›ä½¿ç”¨åŒ¿åå‡½æ•°å½“ä½œå‚æ•°çš„åœºåˆï¼Œå°½é‡ç”¨ç®­å¤´å‡½æ•°ä»£æ›¿ã€‚å› ä¸ºè¿™æ ·æ›´ç®€æ´ï¼Œè€Œä¸”ç»‘å®šäº† thisã€‚\n// bad [1, 2, 3].map(function (x) { return x * x; }); // good [1, 2, 3].map((x) =\u0026gt; { return x * x; }); // best [1, 2, 3].map(x =\u0026gt; x * x); ç®­å¤´å‡½æ•°å–ä»£Function.prototype.bindï¼Œä¸åº”å†ç”¨ self/_this/that ç»‘å®š thisã€‚\n// bad const self = this; const boundMethod = function(...params) { return method.apply(self, params); } // acceptable const boundMethod = method.bind(this); // best const boundMethod = (...params) =\u0026gt; method.apply(this, params); ç®€å•çš„ã€å•è¡Œçš„ã€ä¸ä¼šå¤ç”¨çš„å‡½æ•°ï¼Œå»ºè®®é‡‡ç”¨ç®­å¤´å‡½æ•°ã€‚å¦‚æœå‡½æ•°ä½“è¾ƒä¸ºå¤æ‚ï¼Œè¡Œæ•°è¾ƒå¤šï¼Œè¿˜æ˜¯åº”è¯¥é‡‡ç”¨ä¼ ç»Ÿçš„å‡½æ•°å†™æ³•ã€‚\næ‰€æœ‰é…ç½®é¡¹éƒ½åº”è¯¥é›†ä¸­åœ¨ä¸€ä¸ªå¯¹è±¡ï¼Œæ”¾åœ¨æœ€åä¸€ä¸ªå‚æ•°ï¼Œå¸ƒå°”å€¼ä¸å¯ä»¥ç›´æ¥ä½œä¸ºå‚æ•°ã€‚\n// bad function divide(a, b, option = false ) { } // good function divide(a, b, { option = false } = {}) { } ä¸è¦åœ¨å‡½æ•°ä½“å†…ä½¿ç”¨ arguments å˜é‡ï¼Œä½¿ç”¨ rest è¿ç®—ç¬¦ï¼ˆ\u0026hellip;ï¼‰ä»£æ›¿ã€‚å› ä¸º rest è¿ç®—ç¬¦æ˜¾å¼è¡¨æ˜ä½ æƒ³è¦è·å–å‚æ•°ï¼Œè€Œä¸” arguments æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œè€Œ rest è¿ç®—ç¬¦å¯ä»¥æä¾›ä¸€ä¸ªçœŸæ­£çš„æ•°ç»„ã€‚\n// bad function concatenateAll() { const args = Array.prototype.slice.call(arguments); return args.join(\u0026#39;\u0026#39;); } // good function concatenateAll(...args) { return args.join(\u0026#39;\u0026#39;); } ä½¿ç”¨é»˜è®¤å€¼è¯­æ³•è®¾ç½®å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ã€‚\n// bad function handleThings(opts) { opts = opts || {}; } // good function handleThings(opts = {}) { // ... } Map æ³¨æ„åŒºåˆ† Object å’Œ Mapï¼Œåªæœ‰æ¨¡æ‹Ÿç°å®ä¸–ç•Œçš„å®ä½“å¯¹è±¡æ—¶ï¼Œæ‰ä½¿ç”¨ Objectã€‚å¦‚æœåªæ˜¯éœ€è¦key: valueçš„æ•°æ®ç»“æ„ï¼Œä½¿ç”¨ Map ç»“æ„ã€‚å› ä¸º Map æœ‰å†…å»ºçš„éå†æœºåˆ¶ã€‚\nlet map = new Map(arr); for (let key of map.keys()) { console.log(key); } for (let value of map.values()) { console.log(value); } for (let item of map.entries()) { console.log(item[0], item[1]); } Class æ€»æ˜¯ç”¨ Classï¼Œå–ä»£éœ€è¦ prototype çš„æ“ä½œã€‚å› ä¸º Class çš„å†™æ³•æ›´ç®€æ´ï¼Œæ›´æ˜“äºç†è§£ã€‚\n// bad function Queue(contents = []) { this._queue = [...contents]; } Queue.prototype.pop = function() { const value = this._queue[0]; this._queue.splice(0, 1); return value; } // good class Queue { constructor(contents = []) { this._queue = [...contents]; } pop() { const value = this._queue[0]; this._queue.splice(0, 1); return value; } } ä½¿ç”¨extendså®ç°ç»§æ‰¿ï¼Œå› ä¸ºè¿™æ ·æ›´ç®€å•ï¼Œä¸ä¼šæœ‰ç ´åinstanceofè¿ç®—çš„å±é™©ã€‚\n// bad const inherits = require(\u0026#39;inherits\u0026#39;); function PeekableQueue(contents) { Queue.apply(this, contents); } inherits(PeekableQueue, Queue); PeekableQueue.prototype.peek = function() { return this._queue[0]; } // good class PeekableQueue extends Queue { peek() { return this._queue[0]; } } Module :link: Href Module-ES6\né¦–å…ˆï¼ŒModule è¯­æ³•æ˜¯ JavaScript æ¨¡å—çš„æ ‡å‡†å†™æ³•ï¼ŒåšæŒä½¿ç”¨è¿™ç§å†™æ³•ã€‚ä½¿ç”¨ import å–ä»£ require ã€‚\n// bad const moduleA = require(\u0026#39;moduleA\u0026#39;); const func1 = moduleA.func1; const func2 = moduleA.func2; // good import { func1, func2 } from \u0026#39;moduleA\u0026#39;; ä½¿ç”¨ export å–ä»£ module.exports ã€‚\n// commonJSçš„å†™æ³• var React = require(\u0026#39;react\u0026#39;); var Breadcrumbs = React.createClass({ render() { return \u0026lt;nav /\u0026gt;; } }); module.exports = Breadcrumbs; // ES6çš„å†™æ³• import React from \u0026#39;react\u0026#39;; class Breadcrumbs extends React.Component { render() { return \u0026lt;nav /\u0026gt;; } }; export default Breadcrumbs; å¦‚æœæ¨¡å—åªæœ‰ä¸€ä¸ªè¾“å‡ºå€¼ï¼Œå°±ä½¿ç”¨export defaultï¼Œå¦‚æœæ¨¡å—æœ‰å¤šä¸ªè¾“å‡ºå€¼ï¼Œå°±ä¸ä½¿ç”¨export defaultï¼Œexport defaultä¸æ™®é€šçš„ export ä¸è¦åŒæ—¶ä½¿ç”¨ã€‚\nä¸è¦åœ¨æ¨¡å—è¾“å…¥ä¸­ä½¿ç”¨é€šé…ç¬¦ã€‚å› ä¸ºè¿™æ ·å¯ä»¥ç¡®ä¿ä½ çš„æ¨¡å—ä¹‹ä¸­ï¼Œæœ‰ä¸€ä¸ªé»˜è®¤è¾“å‡ºï¼ˆexport defaultï¼‰ã€‚\n// bad import * as myObject from \u0026#39;./importModule\u0026#39;; // good import myObject from \u0026#39;./importModule\u0026#39;; å¦‚æœæ¨¡å—é»˜è®¤è¾“å‡ºä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°åçš„é¦–å­—æ¯åº”è¯¥å°å†™ã€‚\nfunction makeStyleGuide() { } export default makeStyleGuide; å¦‚æœæ¨¡å—é»˜è®¤è¾“å‡ºä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡åçš„é¦–å­—æ¯åº”è¯¥å¤§å†™ã€‚\nconst StyleGuide = { es6: { } }; export default StyleGuide; ESLint ESLint æ˜¯ä¸€ä¸ªè¯­æ³•è§„åˆ™å’Œä»£ç é£æ ¼çš„æ£€æŸ¥å·¥å…·ï¼Œå¯ä»¥ç”¨æ¥ä¿è¯å†™å‡ºè¯­æ³•æ­£ç¡®ã€é£æ ¼ç»Ÿä¸€çš„ä»£ç ã€‚\né¦–å…ˆï¼Œåœ¨é¡¹ç›®çš„æ ¹ç›®å½•å®‰è£… ESLintã€‚\n$ npm install --save-dev eslint ç„¶åï¼Œå®‰è£… Airbnb è¯­æ³•è§„åˆ™ï¼Œä»¥åŠ importã€a11yã€react æ’ä»¶ã€‚\n$ npm install --save-dev eslint-config-airbnb $ npm install --save-dev eslint-plugin-import eslint-plugin-jsx-a11y eslint-plugin-react æœ€åï¼Œåœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª.eslintrcæ–‡ä»¶ï¼Œé…ç½® ESLintã€‚\n{ \u0026#34;extends\u0026#34;: \u0026#34;eslint-config-airbnb\u0026#34; } ç°åœ¨å°±å¯ä»¥æ£€æŸ¥ï¼Œå½“å‰é¡¹ç›®çš„ä»£ç æ˜¯å¦ç¬¦åˆé¢„è®¾çš„è§„åˆ™ã€‚\nindex.jsæ–‡ä»¶çš„ä»£ç å¦‚ä¸‹ã€‚\nvar unused = \u0026#39;I have no purpose!\u0026#39;; function greet() { var message = \u0026#39;Hello, World!\u0026#39;; console.log(message); } greet(); ä½¿ç”¨ ESLint æ£€æŸ¥è¿™ä¸ªæ–‡ä»¶ï¼Œå°±ä¼šæŠ¥å‡ºé”™è¯¯ã€‚\n$ npx eslint index.js index.js 1:1 error Unexpected var, use let or const instead no-var 1:5 error unused is defined but never used no-unused-vars 4:5 error Expected indentation of 2 characters but found 4 indent 4:5 error Unexpected var, use let or const instead no-var 5:5 error Expected indentation of 2 characters but found 4 indent âœ– 5 problems (5 errors, 0 warnings) ä¸Šé¢ä»£ç è¯´æ˜ï¼ŒåŸæ–‡ä»¶æœ‰äº”ä¸ªé”™è¯¯ï¼Œå…¶ä¸­ä¸¤ä¸ªæ˜¯ä¸åº”è¯¥ä½¿ç”¨varå‘½ä»¤ï¼Œè€Œè¦ä½¿ç”¨ let æˆ– const ï¼›ä¸€ä¸ªæ˜¯å®šä¹‰äº†å˜é‡ï¼Œå´æ²¡æœ‰ä½¿ç”¨ï¼›å¦å¤–ä¸¤ä¸ªæ˜¯è¡Œé¦–ç¼©è¿›ä¸º 4 ä¸ªç©ºæ ¼ï¼Œè€Œä¸æ˜¯è§„å®šçš„ 2 ä¸ªç©ºæ ¼ã€‚\nå˜é‡ ES5 åªæœ‰ä¸¤ç§å£°æ˜å˜é‡çš„æ–¹æ³•ï¼švar å‘½ä»¤å’Œ function å‘½ä»¤ã€‚ES6 é™¤äº†æ·»åŠ letå’Œconstå‘½ä»¤ï¼Œåé¢ç« èŠ‚è¿˜ä¼šæåˆ°ï¼Œå¦å¤–ä¸¤ç§å£°æ˜å˜é‡çš„æ–¹æ³•ï¼šimport å‘½ä»¤å’Œ class å‘½ä»¤ã€‚æ‰€ä»¥ï¼ŒES6 ä¸€å…±æœ‰ 6 ç§å£°æ˜å˜é‡çš„æ–¹æ³•ã€‚\nlet ç”¨äºå£°æ˜å˜é‡ï¼Œå¯¹åº”ä¹‹å‰çš„ var const ç”¨äºå£°æ˜å¸¸é‡ ğŸ“ Note ES5 å¹¶æ²¡æœ‰ å¸¸é‡ çš„æ¦‚å¿µã€‚\nconst æŸäº›é‡çš„å€¼æ˜¯ä¸€ç›´å›ºå®šçš„ï¼Œä¸éœ€è¦ä¹Ÿä¸èƒ½è¢«ä¿®æ”¹ï¼Œå¦‚æœè¢«ä¿®æ”¹å°±ä¼šæŠ¥é”™ã€‚\nç‰¹æ€§ï¼š\nä¸€æ—¦å£°æ˜çš„åŒæ—¶å°±å¿…é¡»è¿›è¡Œåˆå§‹åŒ–ï¼Œä¸èƒ½åˆ†å¼€èµ‹å€¼ å¯¹äº å¼•ç”¨ç±»å‹ çš„ const ï¼ˆå®é™…ä¸Šæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼‰ï¼Œå…è®¸åœ¨ä¸é‡æ–°èµ‹å€¼çš„æƒ…å†µä¸‹ä¿®æ”¹å®ƒçš„å€¼ ğŸ“ Note ä»€ä¹ˆæ—¶å€™ç”¨ letï¼Œä»€ä¹ˆä½¿ç”¨ç”¨ const\nåŸåˆ™ï¼šå¦‚æœä¸çŸ¥é“ç”¨ä»€ä¹ˆçš„æ—¶å€™ï¼Œå°±ç”¨ const\nåŸå› ï¼šå¦‚æœåº”è¯¥æ˜¯å¸¸é‡ï¼Œé‚£ä¹ˆåˆšå¥½ç¬¦å·éœ€æ±‚ã€‚å¦‚æœåº”è¯¥æ˜¯å˜é‡ï¼Œé‚£ä¹ˆåæ¥æŠ¥é”™æ—¶ï¼Œå†æ¥æ”¹ä¸ºå˜é‡ä¹Ÿä¸ºæ—¶ä¸æ™šã€‚åŒæ—¶ï¼Œä¸€å¼€å§‹å°±è®¾ç½®ä¸ºå¸¸é‡è¿˜ä¼šé¿å…çœŸçš„éœ€è¦ä¸ºå¸¸é‡æ—¶ï¼Œè¯¥å€¼åœ¨åæ¥è¢«æ„å¤–ä¿®æ”¹çš„æƒ…å†µã€‚\nlet åªè¦ä½œç”¨åŸŸå†…å­˜åœ¨ letã€constï¼Œå®ƒä»¬æ‰€å£°æ˜çš„å˜é‡æˆ–å¸¸é‡å°±è‡ªåŠ¨ â€œç»‘å®šâ€ è¿™ä¸ªåŒºåŸŸï¼Œä¸å†å—åˆ°å¤–éƒ¨ä½œç”¨åŸŸçš„å½±å“ã€‚\n:warning: Caution åªè¦ä½œç”¨åŸŸå†…å‡ºç°äº†åŒåçš„ let æˆ– const ï¼Œé‚£ä¹ˆå°±ä¼šå» ä½œç”¨åŸŸå†… æœ¬è¯­å¥å‰ å‰æ‰¾è¿™ä¸ªé‡ï¼Œå¦‚æœæ‰¾ä¸åˆ°ä¹Ÿä¸ä¼šè·³å»å¤–éƒ¨æ‰¾ï¼Œè€Œæ˜¯ç›´æ¥æŠ¥é”™ã€‚\nè¿™ç§ç°è±¡è¢«ç§°ä¸º æš‚æ—¶æ€§æ­»åŒº ã€‚ä¹Ÿå³ï¼Œåªè¦å—çº§ä½œç”¨åŸŸå†…å­˜åœ¨ let å‘½ä»¤ï¼Œå®ƒæ‰€å£°æ˜çš„å˜é‡å°± ç»‘å®šbinding åˆ°è¿™ä¸ªåŒºåŸŸï¼Œä¸å†å—å¤–éƒ¨çš„å½±å“ã€‚\nğŸ“ƒ Example\nlet foo = 1; function fun() { console.log(foo);\t// æŠ¥é”™ Cannot access \u0026#39;foo\u0026#39; before initialization let foo = 1; // å› ä¸ºä½œç”¨åŸŸå†…å‡ºç°äº†åŒåçš„let } // è¿™è¢«ç§°ä¸ºæš‚æ—¶æ€§æ­»åŒº fun(); let foo = 1; function fun() { console.log(foo);\t// 1 } fun(); åªè¦æˆ‘ä»¬éµå®ˆ å…ˆå£°æ˜åä½¿ç”¨ ï¼Œé‚£ä¹ˆå…¶å®å°±åŸºæœ¬ä¸ä¼šé‡åˆ°å˜é‡æå‡åŠæš‚æ—¶æ€§æ­»åŒºé—®é¢˜ã€‚\n:warning: Caution letä¸å…è®¸åœ¨ç›¸åŒä½œç”¨åŸŸå†…ï¼Œé‡å¤å£°æ˜åŒä¸€ä¸ªå˜é‡ã€‚\né¡¶å±‚å¯¹è±¡ é¡¶å±‚å¯¹è±¡åœ¨æµè§ˆå™¨ç¯å¢ƒæŒ‡çš„æ˜¯ window å¯¹è±¡ï¼Œåœ¨ Node æŒ‡çš„æ˜¯ global å¯¹è±¡ã€‚ES5 ä¹‹ä¸­ï¼Œé¡¶å±‚å¯¹è±¡çš„å±æ€§ä¸å…¨å±€å˜é‡æ˜¯ç­‰ä»·çš„ã€‚\nwindow.a = 1; a // 1 a = 2; window.a // 2 ä¸Šé¢ä»£ç ä¸­ï¼Œé¡¶å±‚å¯¹è±¡çš„å±æ€§èµ‹å€¼ = å…¨å±€å˜é‡çš„èµ‹å€¼\né¡¶å±‚å¯¹è±¡çš„å±æ€§ä¸å…¨å±€å˜é‡æŒ‚é’©ï¼Œè¢«è®¤ä¸ºæ˜¯ JavaScript è¯­è¨€æœ€å¤§çš„è®¾è®¡è´¥ç¬”ä¹‹ä¸€ã€‚è¿™æ ·çš„è®¾è®¡å¸¦æ¥äº†å‡ ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼š\næ²¡æ³•åœ¨ç¼–è¯‘æ—¶æŠ¥å‡º å˜é‡æœªå£°æ˜ çš„é”™è¯¯ï¼Œåªæœ‰è¿è¡Œæ—¶æ‰èƒ½çŸ¥é“ï¼ˆå› ä¸ºå…¨å±€å˜é‡å¯èƒ½æ˜¯é¡¶å±‚å¯¹è±¡çš„å±æ€§åˆ›é€ çš„ï¼Œè€Œå±æ€§çš„åˆ›é€ æ˜¯åŠ¨æ€çš„ï¼‰ å¾ˆå®¹æ˜“ä¸çŸ¥ä¸è§‰åœ°å°±åˆ›å»ºäº†å…¨å±€å˜é‡ï¼ˆæ¯”å¦‚æ‰“å­—å‡ºé”™ï¼‰ï¼›æœ€åï¼Œé¡¶å±‚å¯¹è±¡çš„å±æ€§æ˜¯åˆ°å¤„å¯ä»¥è¯»å†™çš„ï¼Œè¿™éå¸¸ä¸åˆ©äº æ¨¡å—åŒ–ç¼–ç¨‹ ã€‚å¦ä¸€æ–¹é¢ï¼Œwindow å¯¹è±¡æœ‰ å®ä½“å«ä¹‰ ï¼ŒæŒ‡çš„æ˜¯æµè§ˆå™¨çš„çª—å£å¯¹è±¡ï¼Œé¡¶å±‚å¯¹è±¡æ˜¯ä¸€ä¸ªæœ‰å®ä½“å«ä¹‰çš„å¯¹è±¡ï¼Œä¹Ÿæ˜¯ä¸åˆé€‚çš„ã€‚ ES6 ä¸ºäº†æ”¹å˜è¿™ä¸€ç‚¹ï¼š\nä¸ºäº†ä¿æŒå…¼å®¹æ€§ï¼Œvar function å‘½ä»¤å£°æ˜çš„å…¨å±€å˜é‡ï¼Œä¾æ—§æ˜¯ é¡¶å±‚å¯¹è±¡ çš„å±æ€§\nlet const class å‘½ä»¤å£°æ˜çš„å…¨å±€å˜é‡ï¼Œ ä¸å±äº é¡¶å±‚å¯¹è±¡çš„å±æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä» ES6 å¼€å§‹ï¼Œå…¨å±€å˜é‡å°†é€æ­¥ä¸é¡¶å±‚å¯¹è±¡çš„å±æ€§è„±é’©ã€‚\nvar a = 1; // å¦‚æœåœ¨ Node çš„ REPL ç¯å¢ƒï¼Œå¯ä»¥å†™æˆ global.a // æˆ–è€…é‡‡ç”¨é€šç”¨æ–¹æ³•ï¼Œå†™æˆ this.a window.a // 1 let b = 1; window.b // undefined ä¸Šé¢ä»£ç ä¸­ï¼Œå…¨å±€å˜é‡ a ç”± var å‘½ä»¤å£°æ˜ï¼Œæ‰€ä»¥å®ƒæ˜¯ é¡¶å±‚å¯¹è±¡ çš„å±æ€§ï¼›å…¨å±€å˜é‡ b ç”± let å‘½ä»¤å£°æ˜ï¼Œæ‰€ä»¥å®ƒ ä¸æ˜¯ é¡¶å±‚å¯¹è±¡çš„å±æ€§ï¼Œå› æ­¤ window.b è¿”å› undefinedã€‚\nglobalThis JavaScript è¯­è¨€å­˜åœ¨ä¸€ä¸ªé¡¶å±‚å¯¹è±¡ï¼Œå®ƒæä¾›å…¨å±€ç¯å¢ƒï¼ˆå³å…¨å±€ä½œç”¨åŸŸï¼‰ï¼Œæ‰€æœ‰ä»£ç éƒ½æ˜¯åœ¨è¿™ä¸ªç¯å¢ƒä¸­è¿è¡Œã€‚ä½†æ˜¯ï¼Œé¡¶å±‚å¯¹è±¡åœ¨å„ç§å®ç°é‡Œé¢æ˜¯ä¸ç»Ÿä¸€çš„ã€‚\næµè§ˆå™¨é‡Œé¢ï¼Œé¡¶å±‚å¯¹è±¡æ˜¯ window ï¼Œä½† Node å’Œ Web Worker æ²¡æœ‰ window æµè§ˆå™¨å’Œ Web Worker é‡Œé¢ï¼Œself ä¹ŸæŒ‡å‘é¡¶å±‚å¯¹è±¡ï¼Œä½†æ˜¯ Node æ²¡æœ‰ self Node é‡Œé¢ï¼Œé¡¶å±‚å¯¹è±¡æ˜¯ global ï¼Œä½†å…¶ä»–ç¯å¢ƒéƒ½ä¸æ”¯æŒã€‚ åŒä¸€æ®µä»£ç ä¸ºäº†èƒ½å¤Ÿåœ¨å„ç§ç¯å¢ƒï¼Œéƒ½èƒ½å–åˆ°é¡¶å±‚å¯¹è±¡ï¼Œç°åœ¨ä¸€èˆ¬æ˜¯ä½¿ç”¨thiså˜é‡ï¼Œä½†æ˜¯æœ‰å±€é™æ€§ï¼š\nå…¨å±€ç¯å¢ƒä¸­ï¼Œthis ä¼šè¿”å› é¡¶å±‚å¯¹è±¡ ã€‚ä½†æ˜¯ï¼ŒNode.js æ¨¡å—ä¸­ this è¿”å›çš„æ˜¯å½“å‰æ¨¡å—ï¼ŒES6 æ¨¡å—ä¸­ this è¿”å›çš„æ˜¯ undefined\nå‡½æ•°é‡Œé¢çš„ this ï¼Œå¦‚æœå‡½æ•°ä¸æ˜¯ä½œä¸º å¯¹è±¡çš„æ–¹æ³• è¿è¡Œï¼Œè€Œæ˜¯å•çº¯ä½œä¸º å‡½æ•° è¿è¡Œï¼Œ this ä¼šæŒ‡å‘ é¡¶å±‚å¯¹è±¡ ã€‚ä½†æ˜¯ï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œè¿™æ—¶ this ä¼šè¿”å› undefined ã€‚\nä¸ç®¡æ˜¯ä¸¥æ ¼æ¨¡å¼ï¼Œè¿˜æ˜¯æ™®é€šæ¨¡å¼ï¼Œnew Function(\u0026quot;return this\u0026quot;)()ï¼Œæ€»æ˜¯ä¼šè¿”å›å…¨å±€å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œå¦‚æœæµè§ˆå™¨ç”¨äº† CSP - Content Security Policyå†…å®¹å®‰å…¨ç­–ç•¥ï¼Œé‚£ä¹ˆevalã€new Functionè¿™äº›æ–¹æ³•éƒ½å¯èƒ½æ— æ³•ä½¿ç”¨ã€‚\nğŸ“ƒ Example\nlet globalThis = new Function(\u0026#34;return this\u0026#34;)(); console.log(globalThis); // æµè§ˆå™¨window/Node.js Object [global] ES2020 åœ¨è¯­è¨€æ ‡å‡†çš„å±‚é¢ï¼Œå¼•å…¥globalThisä½œä¸ºé¡¶å±‚å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»»ä½•ç¯å¢ƒä¸‹ï¼ŒglobalThiséƒ½æ˜¯å­˜åœ¨çš„ï¼Œéƒ½å¯ä»¥ä»å®ƒæ‹¿åˆ°é¡¶å±‚å¯¹è±¡ï¼ŒæŒ‡å‘å…¨å±€ç¯å¢ƒä¸‹çš„thisã€‚\n:memo: Note 1 æ‰€æœ‰æµè¡Œçš„æµè§ˆå™¨ï¼ŒåŒ…æ‹¬ Chrome71+ï¼ŒFirefox65+ å’ŒSafari12.1+ ï¼Œéƒ½å·²æ”¯æŒè¯¥åŠŸèƒ½ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨ Node.js12+ ä¸­ä½¿ç”¨å®ƒã€‚\n:memo: Note 2 Chrome DevTools å›¢é˜Ÿçš„Mathias Bynens æå‡ºäº†ä¸€ç§å…¼å®¹æ–¹æ¡ˆï¼š\n(function() { if (typeof globalThis === \u0026#39;object\u0026#39;) return; Object.defineProperty(Object.prototype, \u0026#39;__magic__\u0026#39;, { get: function() { return this; }, configurable: true // This makes it possible to `delete` the getter later. }); __magic__.globalThis = __magic__; // lolwat delete Object.prototype.__magic__; }()); // Your code can use `globalThis` now. console.log(globalThis); ä¸å…¶ä»–æ–¹æ³•ç›¸æ¯”ï¼Œpolyfill æ˜¯æ›´å¯é çš„è§£å†³æ–¹æ¡ˆï¼Œä½†ä»ç„¶ä¸å¤Ÿå®Œç¾ã€‚æ­£å¦‚ Mathias æåˆ°çš„é‚£æ ·ï¼Œä¿®æ”¹ Objectã€ Object.defineProperty æˆ– Object.prototype.__defineGetter__ å¯èƒ½ä¼šç ´å polyfillã€‚\næ•°å€¼ è¿›åˆ¶è¡¨ç¤º ES6 æä¾›äº†äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶æ•°å€¼çš„æ–°çš„å†™æ³•ï¼Œåˆ†åˆ«ç”¨å‰ç¼€0bï¼ˆæˆ–0Bï¼‰å’Œ0oï¼ˆæˆ–0Oï¼‰è¡¨ç¤ºã€‚\n0b111110111 === 503 // true 0o767 === 503 // true ä» ES5 å¼€å§‹ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¹‹ä¸­ï¼Œå…«è¿›åˆ¶å°±ä¸å†å…è®¸ä½¿ç”¨å‰ç¼€0è¡¨ç¤ºï¼ŒES6 è¿›ä¸€æ­¥æ˜ç¡®ï¼Œè¦ä½¿ç”¨å‰ç¼€0oè¡¨ç¤ºã€‚\n// éä¸¥æ ¼æ¨¡å¼ (function(){ console.log(0o11 === 011); })() // true // ä¸¥æ ¼æ¨¡å¼ (function(){ \u0026#39;use strict\u0026#39;; console.log(0o11 === 011); })() // Uncaught SyntaxError: Octal literals are not allowed in strict mode. å¦‚æœè¦å°†0bå’Œ0oå‰ç¼€çš„å­—ç¬¦ä¸²æ•°å€¼è½¬ä¸ºåè¿›åˆ¶ï¼Œè¦ä½¿ç”¨Numberæ–¹æ³•ã€‚\nNumber(\u0026#39;0b111\u0026#39;) // 7 Number(\u0026#39;0o10\u0026#39;) // 8 ç±»å‹åˆ¤æ–­ Number.isFinite(), Number.isNaN() ES6 åœ¨Numberå¯¹è±¡ä¸Šï¼Œæ–°æä¾›äº†Number.isFinite()å’ŒNumber.isNaN()ä¸¤ä¸ªæ–¹æ³•ã€‚\nNumber.isFinite()ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªæ•°å€¼æ˜¯å¦ä¸ºæœ‰é™çš„ï¼ˆfiniteï¼‰ï¼Œå³ä¸æ˜¯Infinityã€‚\nNumber.isFinite(15); // true Number.isFinite(0.8); // true Number.isFinite(NaN); // false Number.isFinite(Infinity); // false Number.isFinite(-Infinity); // false Number.isFinite(\u0026#39;foo\u0026#39;); // false Number.isFinite(\u0026#39;15\u0026#39;); // false Number.isFinite(true); // false æ³¨æ„ï¼Œå¦‚æœå‚æ•°ç±»å‹ä¸æ˜¯æ•°å€¼ï¼ŒNumber.isFiniteä¸€å¾‹è¿”å›falseã€‚\nNumber.isNaN()ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦ä¸ºNaNã€‚\nNumber.isNaN(NaN) // true Number.isNaN(15) // false Number.isNaN(\u0026#39;15\u0026#39;) // false Number.isNaN(true) // false Number.isNaN(9/NaN) // true Number.isNaN(\u0026#39;true\u0026#39; / 0) // true Number.isNaN(\u0026#39;true\u0026#39; / \u0026#39;true\u0026#39;) // true å¦‚æœå‚æ•°ç±»å‹ä¸æ˜¯NaNï¼ŒNumber.isNaNä¸€å¾‹è¿”å›falseã€‚\nå®ƒä»¬ä¸ä¼ ç»Ÿçš„å…¨å±€æ–¹æ³•isFinite()å’ŒisNaN()çš„åŒºåˆ«åœ¨äºï¼Œä¼ ç»Ÿæ–¹æ³•å…ˆè°ƒç”¨Number()å°†éæ•°å€¼çš„å€¼è½¬ä¸ºæ•°å€¼ï¼Œå†è¿›è¡Œåˆ¤æ–­ï¼Œè€Œè¿™ä¸¤ä¸ªæ–°æ–¹æ³•åªå¯¹æ•°å€¼æœ‰æ•ˆï¼ŒNumber.isFinite()å¯¹äºéæ•°å€¼ä¸€å¾‹è¿”å›false, Number.isNaN()åªæœ‰å¯¹äºNaNæ‰è¿”å›trueï¼ŒéNaNä¸€å¾‹è¿”å›falseã€‚\nisFinite(25) // true isFinite(\u0026#34;25\u0026#34;) // true Number.isFinite(25) // true Number.isFinite(\u0026#34;25\u0026#34;) // false isNaN(NaN) // true isNaN(\u0026#34;NaN\u0026#34;) // true Number.isNaN(NaN) // true Number.isNaN(\u0026#34;NaN\u0026#34;) // false Number.isNaN(1) // false Number.isInteger() Number.isInteger()ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•°å€¼æ˜¯å¦ä¸ºæ•´æ•°ã€‚\nNumber.isInteger(25) // true Number.isInteger(25.1) // false JavaScript å†…éƒ¨ï¼Œæ•´æ•°å’Œæµ®ç‚¹æ•°é‡‡ç”¨çš„æ˜¯åŒæ ·çš„å‚¨å­˜æ–¹æ³•ï¼Œæ‰€ä»¥ 25 å’Œ 25.0 è¢«è§†ä¸ºåŒä¸€ä¸ªå€¼ã€‚\nNumber.isInteger(25) // true Number.isInteger(25.0) // true å¦‚æœå‚æ•°ä¸æ˜¯æ•°å€¼ï¼ŒNumber.isIntegerè¿”å›falseã€‚\nNumber.isInteger() // false Number.isInteger(null) // false Number.isInteger(\u0026#39;15\u0026#39;) // false Number.isInteger(true) // false æ³¨æ„ï¼Œç”±äº JavaScript é‡‡ç”¨ IEEE 754 æ ‡å‡†ï¼Œæ•°å€¼å­˜å‚¨ä¸º64ä½åŒç²¾åº¦æ ¼å¼ï¼Œæ•°å€¼ç²¾åº¦æœ€å¤šå¯ä»¥è¾¾åˆ° 53 ä¸ªäºŒè¿›åˆ¶ä½ï¼ˆ1 ä¸ªéšè—ä½ä¸ 52 ä¸ªæœ‰æ•ˆä½ï¼‰ã€‚å¦‚æœæ•°å€¼çš„ç²¾åº¦è¶…è¿‡è¿™ä¸ªé™åº¦ï¼Œç¬¬54ä½åŠåé¢çš„ä½å°±ä¼šè¢«ä¸¢å¼ƒï¼Œè¿™ç§æƒ…å†µä¸‹ï¼ŒNumber.isIntegerå¯èƒ½ä¼šè¯¯åˆ¤ã€‚\nNumber.isInteger(3.0000000000000002) // true ä¸Šé¢ä»£ç ä¸­ï¼ŒNumber.isIntegerçš„å‚æ•°æ˜æ˜ä¸æ˜¯æ•´æ•°ï¼Œä½†æ˜¯ä¼šè¿”å›trueã€‚åŸå› å°±æ˜¯è¿™ä¸ªå°æ•°çš„ç²¾åº¦è¾¾åˆ°äº†å°æ•°ç‚¹å16ä¸ªåè¿›åˆ¶ä½ï¼Œè½¬æˆäºŒè¿›åˆ¶ä½è¶…è¿‡äº†53ä¸ªäºŒè¿›åˆ¶ä½ï¼Œå¯¼è‡´æœ€åçš„é‚£ä¸ª2è¢«ä¸¢å¼ƒäº†ã€‚\nç±»ä¼¼çš„æƒ…å†µè¿˜æœ‰ï¼Œå¦‚æœä¸€ä¸ªæ•°å€¼çš„ç»å¯¹å€¼å°äºNumber.MIN_VALUEï¼ˆ5E-324ï¼‰ï¼Œå³å°äº JavaScript èƒ½å¤Ÿåˆ†è¾¨çš„æœ€å°å€¼ï¼Œä¼šè¢«è‡ªåŠ¨è½¬ä¸º 0ã€‚è¿™æ—¶ï¼ŒNumber.isIntegerä¹Ÿä¼šè¯¯åˆ¤ã€‚\nNumber.isInteger(5E-324) // false Number.isInteger(5E-325) // true ä¸Šé¢ä»£ç ä¸­ï¼Œ5E-325ç”±äºå€¼å¤ªå°ï¼Œä¼šè¢«è‡ªåŠ¨è½¬ä¸º0ï¼Œå› æ­¤è¿”å›trueã€‚\næ€»ä¹‹ï¼Œå¦‚æœå¯¹æ•°æ®ç²¾åº¦çš„è¦æ±‚è¾ƒé«˜ï¼Œä¸å»ºè®®ä½¿ç”¨Number.isInteger()åˆ¤æ–­ä¸€ä¸ªæ•°å€¼æ˜¯å¦ä¸ºæ•´æ•°ã€‚\nå®‰å…¨æ•´æ•°å’Œ Number.isSafeInteger() JavaScript èƒ½å¤Ÿå‡†ç¡®è¡¨ç¤ºçš„æ•´æ•°èŒƒå›´åœ¨-2^53åˆ°2^53ä¹‹é—´ï¼ˆä¸å«ä¸¤ä¸ªç«¯ç‚¹ï¼‰ï¼Œè¶…è¿‡è¿™ä¸ªèŒƒå›´ï¼Œæ— æ³•ç²¾ç¡®è¡¨ç¤ºè¿™ä¸ªå€¼ã€‚\nMath.pow(2, 53) // 9007199254740992 9007199254740992 // 9007199254740992 9007199254740993 // 9007199254740992 Math.pow(2, 53) === Math.pow(2, 53) + 1 // true ä¸Šé¢ä»£ç ä¸­ï¼Œè¶…å‡º 2 çš„ 53 æ¬¡æ–¹ä¹‹åï¼Œä¸€ä¸ªæ•°å°±ä¸ç²¾ç¡®äº†ã€‚\nES6 å¼•å…¥äº†Number.MAX_SAFE_INTEGERå’ŒNumber.MIN_SAFE_INTEGERè¿™ä¸¤ä¸ªå¸¸é‡ï¼Œç”¨æ¥è¡¨ç¤ºè¿™ä¸ªèŒƒå›´çš„ä¸Šä¸‹é™ã€‚\nNumber.MAX_SAFE_INTEGER === Math.pow(2, 53) - 1 // true Number.MAX_SAFE_INTEGER === 9007199254740991 // true Number.MIN_SAFE_INTEGER === -Number.MAX_SAFE_INTEGER // true Number.MIN_SAFE_INTEGER === -9007199254740991 // true ä¸Šé¢ä»£ç ä¸­ï¼Œå¯ä»¥çœ‹åˆ° JavaScript èƒ½å¤Ÿç²¾ç¡®è¡¨ç¤ºçš„æé™ã€‚\nNumber.isSafeInteger()åˆ™æ˜¯ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•´æ•°æ˜¯å¦è½åœ¨è¿™ä¸ªèŒƒå›´ä¹‹å†…ã€‚\nNumber.isSafeInteger(\u0026#39;a\u0026#39;) // false Number.isSafeInteger(null) // false Number.isSafeInteger(NaN) // false Number.isSafeInteger(Infinity) // false Number.isSafeInteger(-Infinity) // false Number.isSafeInteger(3) // true Number.isSafeInteger(1.2) // false Number.isSafeInteger(9007199254740990) // true Number.isSafeInteger(9007199254740992) // false Number.isSafeInteger(Number.MIN_SAFE_INTEGER - 1) // false Number.isSafeInteger(Number.MIN_SAFE_INTEGER) // true Number.isSafeInteger(Number.MAX_SAFE_INTEGER) // true Number.isSafeInteger(Number.MAX_SAFE_INTEGER + 1) // false è¿™ä¸ªå‡½æ•°çš„å®ç°å¾ˆç®€å•ï¼Œå°±æ˜¯è·Ÿå®‰å…¨æ•´æ•°çš„ä¸¤ä¸ªè¾¹ç•Œå€¼æ¯”è¾ƒä¸€ä¸‹ã€‚\nNumber.isSafeInteger = function (n) { return (typeof n === \u0026#39;number\u0026#39; \u0026amp;\u0026amp; Math.round(n) === n \u0026amp;\u0026amp; Number.MIN_SAFE_INTEGER \u0026lt;= n \u0026amp;\u0026amp; n \u0026lt;= Number.MAX_SAFE_INTEGER); } å®é™…ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼Œéœ€è¦æ³¨æ„ã€‚éªŒè¯è¿ç®—ç»“æœæ˜¯å¦è½åœ¨å®‰å…¨æ•´æ•°çš„èŒƒå›´å†…ï¼Œä¸è¦åªéªŒè¯è¿ç®—ç»“æœï¼Œè€Œè¦åŒæ—¶éªŒè¯å‚ä¸è¿ç®—çš„æ¯ä¸ªå€¼ã€‚\nNumber.isSafeInteger(9007199254740993) // false Number.isSafeInteger(990) // true Number.isSafeInteger(9007199254740993 - 990) // true 9007199254740993 - 990 // è¿”å›ç»“æœ 9007199254740002 // æ­£ç¡®ç­”æ¡ˆåº”è¯¥æ˜¯ 9007199254740003 ä¸Šé¢ä»£ç ä¸­ï¼Œ9007199254740993ä¸æ˜¯ä¸€ä¸ªå®‰å…¨æ•´æ•°ï¼Œä½†æ˜¯Number.isSafeIntegerä¼šè¿”å›ç»“æœï¼Œæ˜¾ç¤ºè®¡ç®—ç»“æœæ˜¯å®‰å…¨çš„ã€‚è¿™æ˜¯å› ä¸ºï¼Œè¿™ä¸ªæ•°è¶…å‡ºäº†ç²¾åº¦èŒƒå›´ï¼Œå¯¼è‡´åœ¨è®¡ç®—æœºå†…éƒ¨ï¼Œä»¥9007199254740992çš„å½¢å¼å‚¨å­˜ã€‚\n9007199254740993 === 9007199254740992 // true æ‰€ä»¥ï¼Œå¦‚æœåªéªŒè¯è¿ç®—ç»“æœæ˜¯å¦ä¸ºå®‰å…¨æ•´æ•°ï¼Œå¾ˆå¯èƒ½å¾—åˆ°é”™è¯¯ç»“æœã€‚ä¸‹é¢çš„å‡½æ•°å¯ä»¥åŒæ—¶éªŒè¯ä¸¤ä¸ªè¿ç®—æ•°å’Œè¿ç®—ç»“æœã€‚\nfunction trusty (left, right, result) { if ( Number.isSafeInteger(left) \u0026amp;\u0026amp; Number.isSafeInteger(right) \u0026amp;\u0026amp; Number.isSafeInteger(result) ) { return result; } throw new RangeError(\u0026#39;Operation cannot be trusted!\u0026#39;); } trusty(9007199254740993, 990, 9007199254740993 - 990) // RangeError: Operation cannot be trusted! trusty(1, 2, 3) // 3 è§£æ Number.parseInt(), Number.parseFloat()\nES6 å°†å…¨å±€æ–¹æ³•parseInt()å’ŒparseFloat()ï¼Œç§»æ¤åˆ°Numberå¯¹è±¡ä¸Šé¢ï¼Œè¡Œä¸ºå®Œå…¨ä¿æŒä¸å˜ã€‚\n// ES5çš„å†™æ³• parseInt(\u0026#39;12.34\u0026#39;) // 12 parseFloat(\u0026#39;123.45#\u0026#39;) // 123.45 // ES6çš„å†™æ³• Number.parseInt(\u0026#39;12.34\u0026#39;) // 12 Number.parseFloat(\u0026#39;123.45#\u0026#39;) // 123.45 è¿™æ ·åšçš„ç›®çš„ï¼Œæ˜¯é€æ­¥å‡å°‘å…¨å±€æ€§æ–¹æ³•ï¼Œä½¿å¾—è¯­è¨€é€æ­¥æ¨¡å—åŒ–ã€‚\nNumber.parseInt === parseInt // true Number.parseFloat === parseFloat // true æå°å€¼ :link: Href [ES5](05 JavaScript#number) Number ç±»å‹\nNumber.EPSILON\nES6 åœ¨Numberå¯¹è±¡ä¸Šé¢ï¼Œæ–°å¢ä¸€ä¸ªæå°çš„å¸¸é‡ Number.EPSILONã€‚æ ¹æ®è§„æ ¼ï¼Œå®ƒè¡¨ç¤º 1 ä¸å¤§äº 1 çš„æœ€å°æµ®ç‚¹æ•°ä¹‹é—´çš„å·®ã€‚\nå¯¹äº 64 ä½æµ®ç‚¹æ•°æ¥è¯´ï¼Œå¤§äº 1 çš„æœ€å°æµ®ç‚¹æ•°ç›¸å½“äºäºŒè¿›åˆ¶çš„1.00..001ï¼Œå°æ•°ç‚¹åé¢æœ‰è¿ç»­ 51 ä¸ªé›¶ã€‚è¿™ä¸ªå€¼å‡å» 1 ä¹‹åï¼Œå°±ç­‰äº 2 çš„ -52 æ¬¡æ–¹ã€‚\nNumber.EPSILON === Math.pow(2, -52) // true Number.EPSILON // 2.220446049250313e-16 Number.EPSILON.toFixed(20) // \u0026#34;0.00000000000000022204\u0026#34; Number.EPSILONå®é™…ä¸Šæ˜¯ JavaScript èƒ½å¤Ÿè¡¨ç¤ºçš„æœ€å°ç²¾åº¦ã€‚è¯¯å·®å¦‚æœå°äºè¿™ä¸ªå€¼ï¼Œå°±å¯ä»¥è®¤ä¸ºå·²ç»æ²¡æœ‰æ„ä¹‰äº†ï¼Œå³ä¸å­˜åœ¨è¯¯å·®äº†ã€‚\nå¼•å…¥ä¸€ä¸ªè¿™ä¹ˆå°çš„é‡çš„ç›®çš„ï¼Œåœ¨äºä¸ºæµ®ç‚¹æ•°è®¡ç®—ï¼Œè®¾ç½®ä¸€ä¸ªè¯¯å·®èŒƒå›´ã€‚æˆ‘ä»¬çŸ¥é“æµ®ç‚¹æ•°è®¡ç®—æ˜¯ä¸ç²¾ç¡®çš„ã€‚\n0.1 + 0.2 // 0.30000000000000004 0.1 + 0.2 - 0.3 // 5.551115123125783e-17 5.551115123125783e-17.toFixed(20) // \u0026#39;0.00000000000000005551\u0026#39; ä¸Šé¢ä»£ç è§£é‡Šäº†ï¼Œä¸ºä»€ä¹ˆæ¯”è¾ƒ0.1 + 0.2ä¸0.3å¾—åˆ°çš„ç»“æœæ˜¯falseã€‚\n0.1 + 0.2 === 0.3 // false Number.EPSILONå¯ä»¥ç”¨æ¥è®¾ç½®â€œèƒ½å¤Ÿæ¥å—çš„è¯¯å·®èŒƒå›´â€ã€‚æ¯”å¦‚ï¼Œè¯¯å·®èŒƒå›´è®¾ä¸º 2 çš„-50 æ¬¡æ–¹ï¼ˆå³Number.EPSILON * Math.pow(2, 2)ï¼‰ï¼Œå³å¦‚æœä¸¤ä¸ªæµ®ç‚¹æ•°çš„å·®å°äºè¿™ä¸ªå€¼ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºè¿™ä¸¤ä¸ªæµ®ç‚¹æ•°ç›¸ç­‰ã€‚\n5.551115123125783e-17 \u0026lt; Number.EPSILON * Math.pow(2, 2) // true å› æ­¤ï¼ŒNumber.EPSILONçš„å®è´¨æ˜¯ä¸€ä¸ªå¯ä»¥æ¥å—çš„æœ€å°è¯¯å·®èŒƒå›´ã€‚\nfunction withinErrorMargin (left, right) { return Math.abs(left - right) \u0026lt; Number.EPSILON * Math.pow(2, 2); } 0.1 + 0.2 === 0.3 // false withinErrorMargin(0.1 + 0.2, 0.3) // true 1.1 + 1.3 === 2.4 // false withinErrorMargin(1.1 + 1.3, 2.4) // true ä¸Šé¢çš„ä»£ç ä¸ºæµ®ç‚¹æ•°è¿ç®—ï¼Œéƒ¨ç½²äº†ä¸€ä¸ªè¯¯å·®æ£€æŸ¥å‡½æ•°ã€‚\nMath ES6 åœ¨ Math å¯¹è±¡ä¸Šæ–°å¢äº† 17 ä¸ªä¸æ•°å­¦ç›¸å…³çš„æ–¹æ³•ã€‚æ‰€æœ‰è¿™äº›æ–¹æ³•éƒ½æ˜¯é™æ€æ–¹æ³•ï¼Œåªèƒ½åœ¨ Math å¯¹è±¡ä¸Šè°ƒç”¨ã€‚\n:link: Href [ES5](05 JavaScript#math-es5) Math å¯¹è±¡\nMath.trunc() Math.truncæ–¹æ³•ç”¨äºå»é™¤ä¸€ä¸ªæ•°çš„å°æ•°éƒ¨åˆ†ï¼Œè¿”å›æ•´æ•°éƒ¨åˆ†ã€‚\nMath.trunc(4.1) // 4 Math.trunc(4.9) // 4 Math.trunc(-4.1) // -4 Math.trunc(-4.9) // -4 Math.trunc(-0.1234) // -0 å¯¹äºéæ•°å€¼ï¼ŒMath.truncå†…éƒ¨ä½¿ç”¨Numberæ–¹æ³•å°†å…¶å…ˆè½¬ä¸ºæ•°å€¼ã€‚\nMath.trunc(\u0026#39;123.456\u0026#39;) // 123 Math.trunc(true) //1 Math.trunc(false) // 0 Math.trunc(null) // 0 å¯¹äºç©ºå€¼å’Œæ— æ³•æˆªå–æ•´æ•°çš„å€¼ï¼Œè¿”å›NaNã€‚\nMath.trunc(NaN); // NaN Math.trunc(\u0026#39;foo\u0026#39;); // NaN Math.trunc(); // NaN Math.trunc(undefined) // NaN å¯¹äºæ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ–¹æ³•çš„ç¯å¢ƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿã€‚\nMath.trunc = Math.trunc || function(x) { return x \u0026lt; 0 ? Math.ceil(x) : Math.floor(x); }; Math.sign() Math.signæ–¹æ³•ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•°åˆ°åº•æ˜¯æ­£æ•°ã€è´Ÿæ•°ã€è¿˜æ˜¯é›¶ã€‚å¯¹äºéæ•°å€¼ï¼Œä¼šå…ˆå°†å…¶è½¬æ¢ä¸ºæ•°å€¼ã€‚\nå®ƒä¼šè¿”å›äº”ç§å€¼ã€‚\nå‚æ•°ä¸ºæ­£æ•°ï¼Œè¿”å›+1ï¼› å‚æ•°ä¸ºè´Ÿæ•°ï¼Œè¿”å›-1ï¼› å‚æ•°ä¸º 0ï¼Œè¿”å›0ï¼› å‚æ•°ä¸º-0ï¼Œè¿”å›-0; å…¶ä»–å€¼ï¼Œè¿”å›NaNã€‚ Math.sign(-5) // -1 Math.sign(5) // +1 Math.sign(0) // +0 Math.sign(-0) // -0 Math.sign(NaN) // NaN å¦‚æœå‚æ•°æ˜¯éæ•°å€¼ï¼Œä¼šè‡ªåŠ¨è½¬ä¸ºæ•°å€¼ã€‚å¯¹äºé‚£äº›æ— æ³•è½¬ä¸ºæ•°å€¼çš„å€¼ï¼Œä¼šè¿”å›NaNã€‚\nMath.sign(\u0026#39;\u0026#39;) // 0 Math.sign(true) // +1 Math.sign(false) // 0 Math.sign(null) // 0 Math.sign(\u0026#39;9\u0026#39;) // +1 Math.sign(\u0026#39;foo\u0026#39;) // NaN Math.sign() // NaN Math.sign(undefined) // NaN å¯¹äºæ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ–¹æ³•çš„ç¯å¢ƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿã€‚\nMath.sign = Math.sign || function(x) { x = +x; // convert to a number if (x === 0 || isNaN(x)) { return x; } return x \u0026gt; 0 ? 1 : -1; }; Math.cbrt() Math.cbrt()æ–¹æ³•ç”¨äºè®¡ç®—ä¸€ä¸ªæ•°çš„ç«‹æ–¹æ ¹ã€‚\nMath.cbrt(-1) // -1 Math.cbrt(0) // 0 Math.cbrt(1) // 1 Math.cbrt(2) // 1.2599210498948732 å¯¹äºéæ•°å€¼ï¼ŒMath.cbrt()æ–¹æ³•å†…éƒ¨ä¹Ÿæ˜¯å…ˆä½¿ç”¨Number()æ–¹æ³•å°†å…¶è½¬ä¸ºæ•°å€¼ã€‚\nMath.cbrt(\u0026#39;8\u0026#39;) // 2 Math.cbrt(\u0026#39;hello\u0026#39;) // NaN å¯¹äºæ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ–¹æ³•çš„ç¯å¢ƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿã€‚\nMath.cbrt = Math.cbrt || function(x) { var y = Math.pow(Math.abs(x), 1/3); return x \u0026lt; 0 ? -y : y; }; Math.clz32() Math.clz32()æ–¹æ³•å°†å‚æ•°è½¬ä¸º 32 ä½æ— ç¬¦å·æ•´æ•°çš„å½¢å¼ï¼Œç„¶åè¿”å›è¿™ä¸ª 32 ä½å€¼é‡Œé¢æœ‰å¤šå°‘ä¸ªå‰å¯¼ 0ã€‚\nMath.clz32(0) // 32 Math.clz32(1) // 31 Math.clz32(1000) // 22 Math.clz32(0b01000000000000000000000000000000) // 1 Math.clz32(0b00100000000000000000000000000000) // 2 ä¸Šé¢ä»£ç ä¸­ï¼Œ0 çš„äºŒè¿›åˆ¶å½¢å¼å…¨ä¸º 0ï¼Œæ‰€ä»¥æœ‰ 32 ä¸ªå‰å¯¼ 0ï¼›1 çš„äºŒè¿›åˆ¶å½¢å¼æ˜¯0b1ï¼Œåªå  1 ä½ï¼Œæ‰€ä»¥ 32 ä½ä¹‹ä¸­æœ‰ 31 ä¸ªå‰å¯¼ 0ï¼›1000 çš„äºŒè¿›åˆ¶å½¢å¼æ˜¯0b1111101000ï¼Œä¸€å…±æœ‰ 10 ä½ï¼Œæ‰€ä»¥ 32 ä½ä¹‹ä¸­æœ‰ 22 ä¸ªå‰å¯¼ 0ã€‚\nclz32è¿™ä¸ªå‡½æ•°åå°±æ¥è‡ªâ€count leading zero bits in 32-bit binary representation of a numberâ€œï¼ˆè®¡ç®—ä¸€ä¸ªæ•°çš„ 32 ä½äºŒè¿›åˆ¶å½¢å¼çš„å‰å¯¼ 0 çš„ä¸ªæ•°ï¼‰çš„ç¼©å†™ã€‚\nå·¦ç§»è¿ç®—ç¬¦ï¼ˆ\u0026lt;\u0026lt;ï¼‰ä¸Math.clz32æ–¹æ³•ç›´æ¥ç›¸å…³ã€‚\nMath.clz32(0) // 32 Math.clz32(1) // 31 Math.clz32(1 \u0026lt;\u0026lt; 1) // 30 Math.clz32(1 \u0026lt;\u0026lt; 2) // 29 Math.clz32(1 \u0026lt;\u0026lt; 29) // 2 å¯¹äºå°æ•°ï¼ŒMath.clz32æ–¹æ³•åªè€ƒè™‘æ•´æ•°éƒ¨åˆ†ã€‚\nMath.clz32(3.2) // 30 Math.clz32(3.9) // 30 å¯¹äºç©ºå€¼æˆ–å…¶ä»–ç±»å‹çš„å€¼ï¼ŒMath.clz32æ–¹æ³•ä¼šå°†å®ƒä»¬å…ˆè½¬ä¸ºæ•°å€¼ï¼Œç„¶åå†è®¡ç®—ã€‚\nMath.clz32() // 32 Math.clz32(NaN) // 32 Math.clz32(Infinity) // 32 Math.clz32(null) // 32 Math.clz32(\u0026#39;foo\u0026#39;) // 32 Math.clz32([]) // 32 Math.clz32({}) // 32 Math.clz32(true) // 31 Math.imul() Math.imulæ–¹æ³•è¿”å›ä¸¤ä¸ªæ•°ä»¥ 32 ä½å¸¦ç¬¦å·æ•´æ•°å½¢å¼ç›¸ä¹˜çš„ç»“æœï¼Œè¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ª 32 ä½çš„å¸¦ç¬¦å·æ•´æ•°ã€‚\nMath.imul(2, 4) // 8 Math.imul(-1, 8) // -8 Math.imul(-2, -2) // 4 å¦‚æœåªè€ƒè™‘æœ€å 32 ä½ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒMath.imul(a, b)ä¸a * bçš„ç»“æœæ˜¯ç›¸åŒçš„ï¼Œå³è¯¥æ–¹æ³•ç­‰åŒäº(a * b)|0çš„æ•ˆæœï¼ˆè¶…è¿‡ 32 ä½çš„éƒ¨åˆ†æº¢å‡ºï¼‰ã€‚ä¹‹æ‰€ä»¥éœ€è¦éƒ¨ç½²è¿™ä¸ªæ–¹æ³•ï¼Œæ˜¯å› ä¸º JavaScript æœ‰ç²¾åº¦é™åˆ¶ï¼Œè¶…è¿‡ 2 çš„ 53 æ¬¡æ–¹çš„å€¼æ— æ³•ç²¾ç¡®è¡¨ç¤ºã€‚è¿™å°±æ˜¯è¯´ï¼Œå¯¹äºé‚£äº›å¾ˆå¤§çš„æ•°çš„ä¹˜æ³•ï¼Œä½ä½æ•°å€¼å¾€å¾€éƒ½æ˜¯ä¸ç²¾ç¡®çš„ï¼ŒMath.imulæ–¹æ³•å¯ä»¥è¿”å›æ­£ç¡®çš„ä½ä½æ•°å€¼ã€‚\n(0x7fffffff * 0x7fffffff)|0 // 0 ä¸Šé¢è¿™ä¸ªä¹˜æ³•ç®—å¼ï¼Œè¿”å›ç»“æœä¸º 0ã€‚ä½†æ˜¯ç”±äºè¿™ä¸¤ä¸ªäºŒè¿›åˆ¶æ•°çš„æœ€ä½ä½éƒ½æ˜¯ 1ï¼Œæ‰€ä»¥è¿™ä¸ªç»“æœè‚¯å®šæ˜¯ä¸æ­£ç¡®çš„ï¼Œå› ä¸ºæ ¹æ®äºŒè¿›åˆ¶ä¹˜æ³•ï¼Œè®¡ç®—ç»“æœçš„äºŒè¿›åˆ¶æœ€ä½ä½åº”è¯¥ä¹Ÿæ˜¯ 1ã€‚è¿™ä¸ªé”™è¯¯å°±æ˜¯å› ä¸ºå®ƒä»¬çš„ä¹˜ç§¯è¶…è¿‡äº† 2 çš„ 53 æ¬¡æ–¹ï¼ŒJavaScript æ— æ³•ä¿å­˜é¢å¤–çš„ç²¾åº¦ï¼Œå°±æŠŠä½ä½çš„å€¼éƒ½å˜æˆäº† 0ã€‚Math.imulæ–¹æ³•å¯ä»¥è¿”å›æ­£ç¡®çš„å€¼ 1ã€‚\nMath.imul(0x7fffffff, 0x7fffffff) // 1 Math.fround() Math.froundæ–¹æ³•è¿”å›ä¸€ä¸ªæ•°çš„32ä½å•ç²¾åº¦æµ®ç‚¹æ•°å½¢å¼ã€‚\nå¯¹äº32ä½å•ç²¾åº¦æ ¼å¼æ¥è¯´ï¼Œæ•°å€¼ç²¾åº¦æ˜¯24ä¸ªäºŒè¿›åˆ¶ä½ï¼ˆ1 ä½éšè—ä½ä¸ 23 ä½æœ‰æ•ˆä½ï¼‰ï¼Œæ‰€ä»¥å¯¹äº -224 è‡³ 224 ä¹‹é—´çš„æ•´æ•°ï¼ˆä¸å«ä¸¤ä¸ªç«¯ç‚¹ï¼‰ï¼Œè¿”å›ç»“æœä¸å‚æ•°æœ¬èº«ä¸€è‡´ã€‚\nMath.fround(0) // 0 Math.fround(1) // 1 Math.fround(2 ** 24 - 1) // 16777215 å¦‚æœå‚æ•°çš„ç»å¯¹å€¼å¤§äº 224ï¼Œè¿”å›çš„ç»“æœä¾¿å¼€å§‹ä¸¢å¤±ç²¾åº¦ã€‚\nMath.fround(2 ** 24) // 16777216 Math.fround(2 ** 24 + 1) // 16777216 Math.froundæ–¹æ³•çš„ä¸»è¦ä½œç”¨ï¼Œæ˜¯å°†64ä½åŒç²¾åº¦æµ®ç‚¹æ•°è½¬ä¸º32ä½å•ç²¾åº¦æµ®ç‚¹æ•°ã€‚å¦‚æœå°æ•°çš„ç²¾åº¦è¶…è¿‡24ä¸ªäºŒè¿›åˆ¶ä½ï¼Œè¿”å›å€¼å°±ä¼šä¸åŒäºåŸå€¼ï¼Œå¦åˆ™è¿”å›å€¼ä¸å˜ï¼ˆå³ä¸64ä½åŒç²¾åº¦å€¼ä¸€è‡´ï¼‰ã€‚\n// æœªä¸¢å¤±æœ‰æ•ˆç²¾åº¦ Math.fround(1.125) // 1.125 Math.fround(7.25) // 7.25 // ä¸¢å¤±ç²¾åº¦ Math.fround(0.3) // 0.30000001192092896 Math.fround(0.7) // 0.699999988079071 Math.fround(1.0000000123) // 1 å¯¹äº NaN å’Œ Infinityï¼Œæ­¤æ–¹æ³•è¿”å›åŸå€¼ã€‚å¯¹äºå…¶å®ƒç±»å‹çš„éæ•°å€¼ï¼ŒMath.fround æ–¹æ³•ä¼šå…ˆå°†å…¶è½¬ä¸ºæ•°å€¼ï¼Œå†è¿”å›å•ç²¾åº¦æµ®ç‚¹æ•°ã€‚\nMath.fround(NaN) // NaN Math.fround(Infinity) // Infinity Math.fround(\u0026#39;5\u0026#39;) // 5 Math.fround(true) // 1 Math.fround(null) // 0 Math.fround([]) // 0 Math.fround({}) // NaN å¯¹äºæ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ–¹æ³•çš„ç¯å¢ƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿã€‚\nMath.fround = Math.fround || function (x) { return new Float32Array([x])[0]; }; Math.hypot() Math.hypotæ–¹æ³•è¿”å›æ‰€æœ‰å‚æ•°çš„å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹ã€‚\nMath.hypot(3, 4); // 5 Math.hypot(3, 4, 5); // 7.0710678118654755 Math.hypot(); // 0 Math.hypot(NaN); // NaN Math.hypot(3, 4, \u0026#39;foo\u0026#39;); // NaN Math.hypot(3, 4, \u0026#39;5\u0026#39;); // 7.0710678118654755 Math.hypot(-3); // 3 ä¸Šé¢ä»£ç ä¸­ï¼Œ3 çš„å¹³æ–¹åŠ ä¸Š 4 çš„å¹³æ–¹ï¼Œç­‰äº 5 çš„å¹³æ–¹ã€‚\nå¦‚æœå‚æ•°ä¸æ˜¯æ•°å€¼ï¼ŒMath.hypotæ–¹æ³•ä¼šå°†å…¶è½¬ä¸ºæ•°å€¼ã€‚åªè¦æœ‰ä¸€ä¸ªå‚æ•°æ— æ³•è½¬ä¸ºæ•°å€¼ï¼Œå°±ä¼šè¿”å› NaNã€‚\nå¯¹æ•°æ–¹æ³• ES6 æ–°å¢äº† 4 ä¸ªå¯¹æ•°ç›¸å…³æ–¹æ³•ã€‚\nï¼ˆ1ï¼‰ Math.expm1()\nMath.expm1(x)è¿”å› ex - 1ï¼Œå³Math.exp(x) - 1ã€‚\nMath.expm1(-1) // -0.6321205588285577 Math.expm1(0) // 0 Math.expm1(1) // 1.718281828459045 å¯¹äºæ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ–¹æ³•çš„ç¯å¢ƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿã€‚\nMath.expm1 = Math.expm1 || function(x) { return Math.exp(x) - 1; }; ï¼ˆ2ï¼‰Math.log1p()\nMath.log1p(x)æ–¹æ³•è¿”å›1 + xçš„è‡ªç„¶å¯¹æ•°ï¼Œå³Math.log(1 + x)ã€‚å¦‚æœxå°äº-1ï¼Œè¿”å›NaNã€‚\nMath.log1p(1) // 0.6931471805599453 Math.log1p(0) // 0 Math.log1p(-1) // -Infinity Math.log1p(-2) // NaN å¯¹äºæ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ–¹æ³•çš„ç¯å¢ƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿã€‚\nMath.log1p = Math.log1p || function(x) { return Math.log(1 + x); }; ï¼ˆ3ï¼‰Math.log10()\nMath.log10(x)è¿”å›ä»¥ 10 ä¸ºåº•çš„xçš„å¯¹æ•°ã€‚å¦‚æœxå°äº 0ï¼Œåˆ™è¿”å› NaNã€‚\nMath.log10(2) // 0.3010299956639812 Math.log10(1) // 0 Math.log10(0) // -Infinity Math.log10(-2) // NaN Math.log10(100000) // 5 å¯¹äºæ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ–¹æ³•çš„ç¯å¢ƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿã€‚\nMath.log10 = Math.log10 || function(x) { return Math.log(x) / Math.LN10; }; ï¼ˆ4ï¼‰Math.log2()\nMath.log2(x)è¿”å›ä»¥ 2 ä¸ºåº•çš„xçš„å¯¹æ•°ã€‚å¦‚æœxå°äº 0ï¼Œåˆ™è¿”å› NaNã€‚\nMath.log2(3) // 1.584962500721156 Math.log2(2) // 1 Math.log2(1) // 0 Math.log2(0) // -Infinity Math.log2(-2) // NaN Math.log2(1024) // 10 Math.log2(1 \u0026lt;\u0026lt; 29) // 29 å¯¹äºæ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ–¹æ³•çš„ç¯å¢ƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿã€‚\nMath.log2 = Math.log2 || function(x) { return Math.log(x) / Math.LN2; }; åŒæ›²å‡½æ•°æ–¹æ³• ES6 æ–°å¢äº† 6 ä¸ªåŒæ›²å‡½æ•°æ–¹æ³•ã€‚\nMath.sinh(x) è¿”å›xçš„åŒæ›²æ­£å¼¦ï¼ˆhyperbolic sineï¼‰ Math.cosh(x) è¿”å›xçš„åŒæ›²ä½™å¼¦ï¼ˆhyperbolic cosineï¼‰ Math.tanh(x) è¿”å›xçš„åŒæ›²æ­£åˆ‡ï¼ˆhyperbolic tangentï¼‰ Math.asinh(x) è¿”å›xçš„ååŒæ›²æ­£å¼¦ï¼ˆinverse hyperbolic sineï¼‰ Math.acosh(x) è¿”å›xçš„ååŒæ›²ä½™å¼¦ï¼ˆinverse hyperbolic cosineï¼‰ Math.atanh(x) è¿”å›xçš„ååŒæ›²æ­£åˆ‡ï¼ˆinverse hyperbolic tangentï¼‰ BigInt JavaScript æ‰€æœ‰æ•°å­—éƒ½ä¿å­˜æˆ 64 ä½æµ®ç‚¹æ•°ï¼Œè¿™ç»™æ•°å€¼çš„è¡¨ç¤ºå¸¦æ¥äº†ä¸¤å¤§é™åˆ¶ã€‚ä¸€æ˜¯æ•°å€¼çš„ç²¾åº¦åªèƒ½åˆ° 53 ä¸ªäºŒè¿›åˆ¶ä½ï¼ˆç›¸å½“äº 16 ä¸ªåè¿›åˆ¶ä½ï¼‰ï¼Œå¤§äºè¿™ä¸ªèŒƒå›´çš„æ•´æ•°ï¼ŒJavaScript æ˜¯æ— æ³•ç²¾ç¡®è¡¨ç¤ºçš„ï¼Œè¿™ä½¿å¾— JavaScript ä¸é€‚åˆè¿›è¡Œç§‘å­¦å’Œé‡‘èæ–¹é¢çš„ç²¾ç¡®è®¡ç®—ã€‚äºŒæ˜¯å¤§äºæˆ–ç­‰äº2çš„1024æ¬¡æ–¹çš„æ•°å€¼ï¼ŒJavaScript æ— æ³•è¡¨ç¤ºï¼Œä¼šè¿”å›Infinityã€‚\n// è¶…è¿‡ 53 ä¸ªäºŒè¿›åˆ¶ä½çš„æ•°å€¼ï¼Œæ— æ³•ä¿æŒç²¾åº¦ Math.pow(2, 53) === Math.pow(2, 53) + 1 // true // è¶…è¿‡ 2 çš„ 1024 æ¬¡æ–¹çš„æ•°å€¼ï¼Œæ— æ³•è¡¨ç¤º Math.pow(2, 1024) // Infinity ES2020 å¼•å…¥äº†ä¸€ç§æ–°çš„æ•°æ®ç±»å‹ BigIntï¼ˆå¤§æ•´æ•°ï¼‰ï¼Œæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿™æ˜¯ ECMAScript çš„ç¬¬å…«ç§æ•°æ®ç±»å‹ã€‚BigInt åªç”¨æ¥è¡¨ç¤ºæ•´æ•°ï¼Œæ²¡æœ‰ä½æ•°çš„é™åˆ¶ï¼Œä»»ä½•ä½æ•°çš„æ•´æ•°éƒ½å¯ä»¥ç²¾ç¡®è¡¨ç¤ºã€‚\nconst a = 2172141653n; const b = 15346349309n; // BigInt å¯ä»¥ä¿æŒç²¾åº¦ a * b // 33334444555566667777n // æ™®é€šæ•´æ•°æ— æ³•ä¿æŒç²¾åº¦ Number(a) * Number(b) // 33334444555566670000 ä¸ºäº†ä¸ Number ç±»å‹åŒºåˆ«ï¼ŒBigInt ç±»å‹çš„æ•°æ®å¿…é¡»æ·»åŠ åç¼€nã€‚\n1234 // æ™®é€šæ•´æ•° 1234n // BigInt // BigInt çš„è¿ç®— 1n + 2n // 3n BigInt åŒæ ·å¯ä»¥ä½¿ç”¨å„ç§è¿›åˆ¶è¡¨ç¤ºï¼Œéƒ½è¦åŠ ä¸Šåç¼€nã€‚\n0b1101n // äºŒè¿›åˆ¶ 0o777n // å…«è¿›åˆ¶ 0xFFn // åå…­è¿›åˆ¶ BigInt ä¸æ™®é€šæ•´æ•°æ˜¯ä¸¤ç§å€¼ï¼Œå®ƒä»¬ä¹‹é—´å¹¶ä¸ç›¸ç­‰ã€‚\n42n === 42 // false typeofè¿ç®—ç¬¦å¯¹äº BigInt ç±»å‹çš„æ•°æ®è¿”å›bigintã€‚\ntypeof 123n // \u0026#39;bigint\u0026#39; BigInt å¯ä»¥ä½¿ç”¨è´Ÿå·ï¼ˆ-ï¼‰ï¼Œä½†æ˜¯ä¸èƒ½ä½¿ç”¨æ­£å·ï¼ˆ+ï¼‰ï¼Œå› ä¸ºä¼šä¸ asm.js å†²çªã€‚\n-42n // æ­£ç¡® +42n // æŠ¥é”™ JavaScript ä»¥å‰ä¸èƒ½è®¡ç®—70çš„é˜¶ä¹˜ï¼ˆå³70!ï¼‰ï¼Œå› ä¸ºè¶…å‡ºäº†å¯ä»¥è¡¨ç¤ºçš„ç²¾åº¦ã€‚\nlet p = 1; for (let i = 1; i \u0026lt;= 70; i++) { p *= i; } console.log(p); // 1.197857166996989e+100 ç°åœ¨æ”¯æŒå¤§æ•´æ•°äº†ï¼Œå°±å¯ä»¥ç®—äº†ï¼Œæµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·è¿è¡Œä¸‹é¢ä»£ç ï¼Œå°±OKã€‚\nlet p = 1n; for (let i = 1n; i \u0026lt;= 70n; i++) { p *= i; } console.log(p); // 11978571...00000000n å¯¹è±¡ JavaScript åŸç”Ÿæä¾›BigIntå¯¹è±¡ï¼Œå¯ä»¥ç”¨ä½œæ„é€ å‡½æ•°ç”Ÿæˆ BigInt ç±»å‹çš„æ•°å€¼ã€‚è½¬æ¢è§„åˆ™åŸºæœ¬ä¸Number()ä¸€è‡´ï¼Œå°†å…¶ä»–ç±»å‹çš„å€¼è½¬ä¸º BigIntã€‚\nBigInt(123) // 123n BigInt(\u0026#39;123\u0026#39;) // 123n BigInt(false) // 0n BigInt(true) // 1n BigInt()æ„é€ å‡½æ•°å¿…é¡»æœ‰å‚æ•°ï¼Œè€Œä¸”å‚æ•°å¿…é¡»å¯ä»¥æ­£å¸¸è½¬ä¸ºæ•°å€¼ï¼Œä¸‹é¢çš„ç”¨æ³•éƒ½ä¼šæŠ¥é”™ã€‚\nnew BigInt() // TypeError BigInt(undefined) //TypeError BigInt(null) // TypeError BigInt(\u0026#39;123n\u0026#39;) // SyntaxError BigInt(\u0026#39;abc\u0026#39;) // SyntaxError ä¸Šé¢ä»£ç ä¸­ï¼Œå°¤å…¶å€¼å¾—æ³¨æ„å­—ç¬¦ä¸²123næ— æ³•è§£ææˆ Number ç±»å‹ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ã€‚\nå‚æ•°å¦‚æœæ˜¯å°æ•°ï¼Œä¹Ÿä¼šæŠ¥é”™ã€‚\nBigInt(1.5) // RangeError BigInt(\u0026#39;1.5\u0026#39;) // SyntaxError BigInt å¯¹è±¡ç»§æ‰¿äº† Object å¯¹è±¡çš„ä¸¤ä¸ªå®ä¾‹æ–¹æ³•ã€‚\nBigInt.prototype.toString() BigInt.prototype.valueOf() å®ƒè¿˜ç»§æ‰¿äº† Number å¯¹è±¡çš„ä¸€ä¸ªå®ä¾‹æ–¹æ³•ã€‚\nBigInt.prototype.toLocaleString() æ­¤å¤–ï¼Œè¿˜æä¾›äº†ä¸‰ä¸ªé™æ€æ–¹æ³•ã€‚\nBigInt.asUintN(width, BigInt)ï¼š ç»™å®šçš„ BigInt è½¬ä¸º 0 åˆ° 2width - 1 ä¹‹é—´å¯¹åº”çš„å€¼ã€‚ BigInt.asIntN(width, BigInt)ï¼šç»™å®šçš„ BigInt è½¬ä¸º -2width - 1 åˆ° 2width - 1 - 1 ä¹‹é—´å¯¹åº”çš„å€¼ã€‚ BigInt.parseInt(string[, radix])ï¼šè¿‘ä¼¼äºNumber.parseInt()ï¼Œå°†ä¸€ä¸ªå­—ç¬¦ä¸²è½¬æ¢æˆæŒ‡å®šè¿›åˆ¶çš„ BigIntã€‚ const max = 2n ** (64n - 1n) - 1n; BigInt.asIntN(64, max) // 9223372036854775807n BigInt.asIntN(64, max + 1n) // -9223372036854775808n BigInt.asUintN(64, max + 1n) // 9223372036854775808n ä¸Šé¢ä»£ç ä¸­ï¼Œmaxæ˜¯64ä½å¸¦ç¬¦å·çš„ BigInt æ‰€èƒ½è¡¨ç¤ºçš„æœ€å¤§å€¼ã€‚å¦‚æœå¯¹è¿™ä¸ªå€¼åŠ 1nï¼ŒBigInt.asIntN()å°†ä¼šè¿”å›ä¸€ä¸ªè´Ÿå€¼ï¼Œå› ä¸ºè¿™æ—¶æ–°å¢çš„ä¸€ä½å°†è¢«è§£é‡Šä¸ºç¬¦å·ä½ã€‚è€ŒBigInt.asUintN()æ–¹æ³•ç”±äºä¸å­˜åœ¨ç¬¦å·ä½ï¼Œæ‰€ä»¥å¯ä»¥æ­£ç¡®è¿”å›ç»“æœã€‚\nå¦‚æœBigInt.asIntN()å’ŒBigInt.asUintN()æŒ‡å®šçš„ä½æ•°ï¼Œå°äºæ•°å€¼æœ¬èº«çš„ä½æ•°ï¼Œé‚£ä¹ˆå¤´éƒ¨çš„ä½å°†è¢«èˆå¼ƒã€‚\nconst max = 2n ** (64n - 1n) - 1n; BigInt.asIntN(32, max) // -1n BigInt.asUintN(32, max) // 4294967295n ä¸Šé¢ä»£ç ä¸­ï¼Œmaxæ˜¯ä¸€ä¸ª64ä½çš„ BigIntï¼Œå¦‚æœè½¬ä¸º32ä½ï¼Œå‰é¢çš„32ä½éƒ½ä¼šè¢«èˆå¼ƒã€‚\nä¸‹é¢æ˜¯BigInt.parseInt()çš„ä¾‹å­ã€‚\n// Number.parseInt() ä¸ BigInt.parseInt() çš„å¯¹æ¯” Number.parseInt(\u0026#39;9007199254740993\u0026#39;, 10) // 9007199254740992 BigInt.parseInt(\u0026#39;9007199254740993\u0026#39;, 10) // 9007199254740993n ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äºæœ‰æ•ˆæ•°å­—è¶…å‡ºäº†æœ€å¤§é™åº¦ï¼ŒNumber.parseIntæ–¹æ³•è¿”å›çš„ç»“æœæ˜¯ä¸ç²¾ç¡®çš„ï¼Œè€ŒBigInt.parseIntæ–¹æ³•æ­£ç¡®è¿”å›äº†å¯¹åº”çš„ BigIntã€‚\nå¯¹äºäºŒè¿›åˆ¶æ•°ç»„ï¼ŒBigInt æ–°å¢äº†ä¸¤ä¸ªç±»å‹BigUint64Arrayå’ŒBigInt64Arrayï¼Œè¿™ä¸¤ç§æ•°æ®ç±»å‹è¿”å›çš„éƒ½æ˜¯64ä½ BigIntã€‚DataViewå¯¹è±¡çš„å®ä¾‹æ–¹æ³•DataView.prototype.getBigInt64()å’ŒDataView.prototype.getBigUint64()ï¼Œè¿”å›çš„ä¹Ÿæ˜¯ BigIntã€‚\nè½¬æ¢è§„åˆ™ å¯ä»¥ä½¿ç”¨Boolean()ã€Number()å’ŒString()è¿™ä¸‰ä¸ªæ–¹æ³•ï¼Œå°† BigInt å¯ä»¥è½¬ä¸ºå¸ƒå°”å€¼ã€æ•°å€¼å’Œå­—ç¬¦ä¸²ç±»å‹ã€‚\nBoolean(0n) // false Boolean(1n) // true Number(1n) // 1 String(1n) // \u0026#34;1\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼Œæ³¨æ„æœ€åä¸€ä¸ªä¾‹å­ï¼Œè½¬ä¸ºå­—ç¬¦ä¸²æ—¶åç¼€nä¼šæ¶ˆå¤±ã€‚\nå¦å¤–ï¼Œå–åè¿ç®—ç¬¦ï¼ˆ!ï¼‰ä¹Ÿå¯ä»¥å°† BigInt è½¬ä¸ºå¸ƒå°”å€¼ã€‚\n!0n // true !1n // false æ•°å­¦è¿ç®— æ•°å­¦è¿ç®—æ–¹é¢ï¼ŒBigInt ç±»å‹çš„+ã€-ã€*å’Œ**è¿™å››ä¸ªäºŒå…ƒè¿ç®—ç¬¦ï¼Œä¸ Number ç±»å‹çš„è¡Œä¸ºä¸€è‡´ã€‚é™¤æ³•è¿ç®—/ä¼šèˆå»å°æ•°éƒ¨åˆ†ï¼Œè¿”å›ä¸€ä¸ªæ•´æ•°ã€‚\n9n / 5n // 1n å‡ ä¹æ‰€æœ‰çš„æ•°å€¼è¿ç®—ç¬¦éƒ½å¯ä»¥ç”¨åœ¨ BigIntï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªä¾‹å¤–ã€‚\nä¸å¸¦ç¬¦å·çš„å³ç§»ä½è¿ç®—ç¬¦\u0026gt;\u0026gt;\u0026gt; ä¸€å…ƒçš„æ±‚æ­£è¿ç®—ç¬¦+ ä¸Šé¢ä¸¤ä¸ªè¿ç®—ç¬¦ç”¨åœ¨ BigInt ä¼šæŠ¥é”™ã€‚å‰è€…æ˜¯å› ä¸º\u0026gt;\u0026gt;\u0026gt;è¿ç®—ç¬¦æ˜¯ä¸å¸¦ç¬¦å·çš„ï¼Œä½†æ˜¯ BigInt æ€»æ˜¯å¸¦æœ‰ç¬¦å·çš„ï¼Œå¯¼è‡´è¯¥è¿ç®—æ— æ„ä¹‰ï¼Œå®Œå…¨ç­‰åŒäºå³ç§»è¿ç®—ç¬¦\u0026gt;\u0026gt;ã€‚åè€…æ˜¯å› ä¸ºä¸€å…ƒè¿ç®—ç¬¦+åœ¨ asm.js é‡Œé¢æ€»æ˜¯è¿”å› Number ç±»å‹ï¼Œä¸ºäº†ä¸ç ´å asm.js å°±è§„å®š+1nä¼šæŠ¥é”™ã€‚\nBigInt ä¸èƒ½ä¸æ™®é€šæ•°å€¼è¿›è¡Œæ··åˆè¿ç®—ã€‚\n1n + 1.3 // æŠ¥é”™ ä¸Šé¢ä»£ç æŠ¥é”™æ˜¯å› ä¸ºæ— è®ºè¿”å›çš„æ˜¯ BigInt æˆ– Numberï¼Œéƒ½ä¼šå¯¼è‡´ä¸¢å¤±ç²¾åº¦ä¿¡æ¯ã€‚æ¯”å¦‚(2n**53n + 1n) + 0.5è¿™ä¸ªè¡¨è¾¾å¼ï¼Œå¦‚æœè¿”å› BigInt ç±»å‹ï¼Œ0.5è¿™ä¸ªå°æ•°éƒ¨åˆ†ä¼šä¸¢å¤±ï¼›å¦‚æœè¿”å› Number ç±»å‹ï¼Œæœ‰æ•ˆç²¾åº¦åªèƒ½ä¿æŒ 53 ä½ï¼Œå¯¼è‡´ç²¾åº¦ä¸‹é™ã€‚\nåŒæ ·çš„åŸå› ï¼Œå¦‚æœä¸€ä¸ªæ ‡å‡†åº“å‡½æ•°çš„å‚æ•°é¢„æœŸæ˜¯ Number ç±»å‹ï¼Œä½†æ˜¯å¾—åˆ°çš„æ˜¯ä¸€ä¸ª BigIntï¼Œå°±ä¼šæŠ¥é”™ã€‚\n// é”™è¯¯çš„å†™æ³• Math.sqrt(4n) // æŠ¥é”™ // æ­£ç¡®çš„å†™æ³• Math.sqrt(Number(4n)) // 2 ä¸Šé¢ä»£ç ä¸­ï¼ŒMath.sqrtçš„å‚æ•°é¢„æœŸæ˜¯ Number ç±»å‹ï¼Œå¦‚æœæ˜¯ BigInt å°±ä¼šæŠ¥é”™ï¼Œå¿…é¡»å…ˆç”¨Numberæ–¹æ³•è½¬ä¸€ä¸‹ç±»å‹ï¼Œæ‰èƒ½è¿›è¡Œè®¡ç®—ã€‚\nasm.js é‡Œé¢ï¼Œ|0è·Ÿåœ¨ä¸€ä¸ªæ•°å€¼çš„åé¢ä¼šè¿”å›ä¸€ä¸ª32ä½æ•´æ•°ã€‚æ ¹æ®ä¸èƒ½ä¸ Number ç±»å‹æ··åˆè¿ç®—çš„è§„åˆ™ï¼ŒBigInt å¦‚æœä¸|0è¿›è¡Œè¿ç®—ä¼šæŠ¥é”™ã€‚\n1n | 0 // æŠ¥é”™ å…¶ä»–è¿ç®— BigInt å¯¹åº”çš„å¸ƒå°”å€¼ï¼Œä¸ Number ç±»å‹ä¸€è‡´ï¼Œå³0nä¼šè½¬ä¸ºfalseï¼Œå…¶ä»–å€¼è½¬ä¸ºtrueã€‚\nif (0n) { console.log(\u0026#39;if\u0026#39;); } else { console.log(\u0026#39;else\u0026#39;); } // else ä¸Šé¢ä»£ç ä¸­ï¼Œ0nå¯¹åº”falseï¼Œæ‰€ä»¥ä¼šè¿›å…¥elseå­å¥ã€‚\næ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆæ¯”å¦‚\u0026gt;ï¼‰å’Œç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ==ï¼‰å…è®¸ BigInt ä¸å…¶ä»–ç±»å‹çš„å€¼æ··åˆè®¡ç®—ï¼Œå› ä¸ºè¿™æ ·åšä¸ä¼šæŸå¤±ç²¾åº¦ã€‚\n0n \u0026lt; 1 // true 0n \u0026lt; true // true 0n == 0 // true 0n == false // true 0n === 0 // false BigInt ä¸å­—ç¬¦ä¸²æ··åˆè¿ç®—æ—¶ï¼Œä¼šå…ˆè½¬ä¸ºå­—ç¬¦ä¸²ï¼Œå†è¿›è¡Œè¿ç®—ã€‚\n\u0026#39;\u0026#39; + 123n // \u0026#34;123\u0026#34; æ•°ç»„Â :link: Href ç‚¹æ­¤æŸ¥çœ‹ [ES5](05 JavaScript/#array-es5) ç‰ˆæœ¬çš„æ•°ç»„ã€‚\næ‰©å±•è¿ç®—ç¬¦ æ‰©å±•è¿ç®—ç¬¦spread æ˜¯ä¸‰ä¸ªç‚¹ ... ã€‚å®ƒå¥½æ¯” rest...theArgs å‚æ•°çš„ é€†è¿ç®— ï¼Œå°†ä¸€ä¸ªæ•°ç»„è½¬ä¸ºç”¨é€—å·åˆ†éš”çš„å‚æ•°åºåˆ—ã€‚\n:link: Href ES2018 ä¸ºå¯¹è±¡æ·»åŠ äº† å¯¹è±¡æ‰©å±•è¿ç®—ç¬¦\u0026hellip;theArgs\nğŸ“ Note æ‰©å±•è¿ç®—ç¬¦å†…éƒ¨ä½¿ç”¨äº† [for-of](05 JavaScript#for-of) å¾ªç¯ã€‚\nconsole.log(...[1, 2, 3]) // 1 2 3 console.log(1, ...[2, 3, 4], 5) // 1 2 3 4 5 [...document.querySelectorAll(\u0026#39;div\u0026#39;)] // [\u0026lt;div\u0026gt;, \u0026lt;div\u0026gt;, \u0026lt;div\u0026gt;] è¯¥è¿ç®—ç¬¦ä¸»è¦ç”¨äºå‡½æ•°è°ƒç”¨ã€‚\nlet push = (array, ...items) =\u0026gt; array.push([...items]); let add = (x, y) =\u0026gt; x + y; const numbers = [4, 38]; add(...numbers) // 42 ä¸Šé¢ä»£ç ä¸­ï¼Œ array.push(...items) å’Œ add(...numbers) è¿™ä¸¤è¡Œï¼Œéƒ½æ˜¯å‡½æ•°çš„è°ƒç”¨ï¼Œå®ƒä»¬éƒ½ä½¿ç”¨äº† æ‰©å±•è¿ç®—ç¬¦ ã€‚è¯¥è¿ç®—ç¬¦å°†ä¸€ä¸ªæ•°ç»„ï¼Œå˜ä¸º å‚æ•°åºåˆ— ã€‚\næ‰©å±•è¿ç®—ç¬¦ä¸æ­£å¸¸çš„å‡½æ•°å‚æ•°å¯ä»¥ç»“åˆä½¿ç”¨ï¼Œéå¸¸çµæ´»ã€‚\nlet f = (v, w, x, y, z) =\u0026gt; {}; const args = [0, 1]; f(-1, ...args, 2, ...[3]); æ‰©å±•è¿ç®—ç¬¦åé¢è¿˜å¯ä»¥æ”¾ç½®è¡¨è¾¾å¼ã€‚\nlet x = 1; const arr = [ ...(x \u0026gt; 0 ? [\u0026#39;a\u0026#39;] : []), \u0026#39;b\u0026#39;, ]; å¦‚æœæ‰©å±•è¿ç®—ç¬¦åé¢æ˜¯ä¸€ä¸ª ç©ºæ•°ç»„ ï¼Œåˆ™ä¸äº§ç”Ÿä»»ä½•æ•ˆæœã€‚\nlet foo = [...[], 1]; // [1] æ³¨æ„ï¼Œåªæœ‰å‡½æ•°è°ƒç”¨æ—¶ï¼Œæ‰©å±•è¿ç®—ç¬¦æ‰å¯ä»¥æ”¾åœ¨åœ†æ‹¬å·ä¸­ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚\n(...[1, 2]) // Uncaught SyntaxError: Unexpected number console.log((...[1, 2])) // Uncaught SyntaxError: Unexpected number console.log(...[1, 2]) // 1 2 ä¸Šé¢ä¸‰ç§æƒ…å†µï¼Œæ‰©å±•è¿ç®—ç¬¦éƒ½æ”¾åœ¨åœ†æ‹¬å·é‡Œé¢ï¼Œä½†æ˜¯å‰ä¸¤ç§æƒ…å†µä¼šæŠ¥é”™ï¼Œå› ä¸ºæ‰©å±•è¿ç®—ç¬¦æ‰€åœ¨çš„æ‹¬å·ä¸æ˜¯å‡½æ•°è°ƒç”¨ã€‚\næ›¿ä»£ apply ç”±äºæ‰©å±•è¿ç®—ç¬¦å¯ä»¥å±•å¼€æ•°ç»„ï¼Œæ‰€ä»¥ä¸å†éœ€è¦applyæ–¹æ³•ï¼Œå°†æ•°ç»„è½¬ä¸ºå‡½æ•°çš„å‚æ•°äº†ã€‚\n// ES5 çš„å†™æ³• function f(x, y, z) { // ... } var args = [0, 1, 2]; f.apply(null, args); // ES6çš„å†™æ³• function f(x, y, z) { // ... } let args = [0, 1, 2]; f(...args); ä¸‹é¢æ˜¯æ‰©å±•è¿ç®—ç¬¦å–ä»£ apply() æ–¹æ³•çš„ä¸€äº›å®é™…çš„ä¾‹å­ï¼š\n:page_with_curl: Example\nåº”ç”¨ Math.max æ–¹æ³•ï¼Œç®€åŒ–æ±‚å‡ºä¸€ä¸ªæ•°ç»„æœ€å¤§å…ƒç´ çš„å†™æ³•ã€‚\n// ES5 çš„å†™æ³• Math.max.apply(null, [14, 3, 77]) // ES6 çš„å†™æ³• Math.max(...[14, 3, 77]) // ç­‰åŒäº Math.max(14, 3, 77); ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äº JavaScript ä¸æä¾›æ±‚æ•°ç»„æœ€å¤§å…ƒç´ çš„å‡½æ•°ï¼Œæ‰€ä»¥åªèƒ½å¥— ç”¨Math.max å‡½æ•°ï¼Œå°†æ•°ç»„è½¬ä¸ºä¸€ä¸ªå‚æ•°åºåˆ—ï¼Œç„¶åæ±‚æœ€å¤§å€¼ã€‚æœ‰äº†æ‰©å±•è¿ç®—ç¬¦ä»¥åï¼Œå°±å¯ä»¥ç›´æ¥ç”¨ Math.max äº†ã€‚\nğŸ“ƒ Example å¦ä¸€ä¸ªä¾‹å­æ˜¯é€šè¿‡pushå‡½æ•°ï¼Œå°†ä¸€ä¸ªæ•°ç»„æ·»åŠ åˆ°å¦ä¸€ä¸ªæ•°ç»„çš„å°¾éƒ¨ã€‚\n// ES5çš„ å†™æ³• var arr1 = [0, 1, 2]; var arr2 = [3, 4, 5]; Array.prototype.push.apply(arr1, arr2); // ES6 çš„å†™æ³• let arr1 = [0, 1, 2]; let arr2 = [3, 4, 5]; arr1.push(...arr2); ä¸Šé¢ä»£ç çš„ ES5 å†™æ³•ä¸­ï¼Œpush æ–¹æ³•çš„å‚æ•°ä¸èƒ½æ˜¯ æ•°ç»„ ï¼Œæ‰€ä»¥åªå¥½é€šè¿‡ apply æ–¹æ³•å˜é€šä½¿ç”¨ push æ–¹æ³•ã€‚æœ‰äº†æ‰©å±•è¿ç®—ç¬¦ï¼Œå°±å¯ä»¥ç›´æ¥å°†æ•°ç»„ä¼ å…¥ push æ–¹æ³•ã€‚\nğŸ“ƒ Example ä¸‹é¢æ˜¯å¦å¤–ä¸€ä¸ªä¾‹å­ã€‚\n// ES5 new (Date.bind.apply(Date, [null, 2015, 1, 1])); // ES6 new Date(...[2015, 1, 1]); åº”ç”¨ å¤åˆ¶æ•°ç»„ æ•°ç»„æ˜¯å¤åˆçš„æ•°æ®ç±»å‹ï¼Œç›´æ¥å¤åˆ¶çš„è¯ï¼Œåªæ˜¯å¤åˆ¶äº†æŒ‡å‘åº•å±‚æ•°æ®ç»“æ„çš„ æŒ‡é’ˆ ï¼Œè€Œä¸æ˜¯å…‹éš†ä¸€ä¸ªå…¨æ–°çš„æ•°ç»„ã€‚\nconst a1 = [1, 2]; const a2 = a1; a2[0] = 2; a1 // [2, 2] ä¸Šé¢ä»£ç ä¸­ï¼Œa2 å¹¶ä¸æ˜¯ a1 çš„å…‹éš†ï¼Œè€Œæ˜¯æŒ‡å‘åŒä¸€ä»½æ•°æ®çš„å¦ä¸€ä¸ª æŒ‡é’ˆ ã€‚ä¿®æ”¹ a2 ï¼Œä¼šç›´æ¥å¯¼è‡´ a1 çš„å˜åŒ–ã€‚\nğŸ“ Note ES5 åªèƒ½ç”¨å˜é€šæ–¹æ³•æ¥å¤åˆ¶æ•°ç»„ã€‚\nconst a1 = [1, 2]; const a2 = a1.concat(); a2[0] = 2; a1 // [1, 2] ä¸Šé¢ä»£ç ä¸­ï¼Œa1ä¼šè¿”å›åŸæ•°ç»„çš„ å…‹éš† ï¼Œå†ä¿®æ”¹a2å°±ä¸ä¼šå¯¹a1äº§ç”Ÿå½±å“ã€‚\næ‰©å±•è¿ç®—ç¬¦æä¾›äº†å¤åˆ¶æ•°ç»„çš„ç®€ä¾¿å†™æ³•ã€‚\nconst a1 = [1, 2]; // å†™æ³•ä¸€ const a2 = [...a1]; // å†™æ³•äºŒ const [...a2] = a1; ä¸Šé¢çš„ä¸¤ç§å†™æ³•ï¼Œa2éƒ½æ˜¯a1çš„å…‹éš†ã€‚\nğŸ§ª Experimental æµ‹è¯•æ‰©å±•æ‹·è´\nlet arr = []; for (let i = 0; i \u0026lt; Math.random() * 10; i++) { arr.push(parseInt(Math.random() * 10)); } let deepCopy = [...arr]; let [...deepCopy2] = arr; console.log([arr, deepCopy,deepCopy2]); // [ [ 3, 2 ], [ 3, 2 ], [ 3, 2 ] ] åˆå¹¶æ•°ç»„ æ‰©å±•è¿ç®—ç¬¦æä¾›äº†æ•°ç»„åˆå¹¶çš„æ–°å†™æ³•ã€‚\nconst arr1 = [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;]; const arr2 = [\u0026#39;c\u0026#39;]; const arr3 = [\u0026#39;d\u0026#39;, \u0026#39;e\u0026#39;]; // ES5 çš„åˆå¹¶æ•°ç»„ arr1.concat(arr2, arr3); // [ \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;, \u0026#39;e\u0026#39; ] // ES6 çš„åˆå¹¶æ•°ç»„ [...arr1, ...arr2, ...arr3] // [ \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;, \u0026#39;e\u0026#39; ] ä¸è¿‡ï¼Œè¿™ä¸¤ç§æ–¹æ³•éƒ½æ˜¯æµ…æ‹·è´ï¼Œä½¿ç”¨çš„æ—¶å€™éœ€è¦æ³¨æ„ã€‚\nconst a1 = [{ foo: 1 }]; const a2 = [{ bar: 2 }]; const a3 = a1.concat(a2); const a4 = [...a1, ...a2]; a3[0] === a1[0] // true a4[0] === a1[0] // true ä¸Šé¢ä»£ç ä¸­ï¼Œa3 å’Œ a4 æ˜¯ç”¨ä¸¤ç§ä¸åŒæ–¹æ³•åˆå¹¶è€Œæˆçš„æ–°æ•°ç»„ï¼Œä½†æ˜¯å®ƒä»¬çš„ æˆå‘˜ éƒ½æ˜¯å¯¹åŸæ•°ç»„æˆå‘˜çš„ å¼•ç”¨ ï¼Œè¿™å°±æ˜¯æµ…æ‹·è´ã€‚å¦‚æœä¿®æ”¹äº† å¼•ç”¨æŒ‡å‘ çš„å€¼ï¼Œä¼šåŒæ­¥åæ˜ åˆ°æ–°æ•°ç»„ã€‚\nä¸è§£æ„èµ‹å€¼ç»“åˆ æ‰©å±•è¿ç®—ç¬¦å¯ä»¥ä¸è§£æ„èµ‹å€¼ç»“åˆèµ·æ¥ï¼Œç”¨äºç”Ÿæˆæ•°ç»„ã€‚\n// ES5 a = list[0], rest = list.slice(1) // ES6 [a, ...rest] = list ğŸ“ƒ Example\nconst [first, ...rest] = [1, 2, 3, 4, 5]; first // 1 rest // [2, 3, 4, 5] const [first, ...rest] = []; first // undefined rest // [] const [first, ...rest] = [\u0026#34;foo\u0026#34;]; first // \u0026#34;foo\u0026#34; rest // [] å¦‚æœå°†æ‰©å±•è¿ç®—ç¬¦ç”¨äº æ•°ç»„èµ‹å€¼ ï¼Œåªèƒ½æ”¾åœ¨å‚æ•°çš„ æœ€åä¸€ä½ ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ç±»ä¼¼å‡½æ•°å‚æ•°ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦çš„æ•ˆæœã€‚\nconst [...butLast, last] = [1, 2, 3, 4, 5]; // æŠ¥é”™ const [first, ...middle, last] = [1, 2, 3, 4, 5]; // æŠ¥é”™ å­—ç¬¦ä¸² æ‰©å±•è¿ç®—ç¬¦è¿˜å¯ä»¥å°†å­—ç¬¦ä¸²è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚\n[...\u0026#39;hello\u0026#39;] // [ \u0026#34;h\u0026#34;, \u0026#34;e\u0026#34;, \u0026#34;l\u0026#34;, \u0026#34;l\u0026#34;, \u0026#34;o\u0026#34; ] ä¸Šé¢çš„å†™æ³•ï¼Œæœ‰ä¸€ä¸ªé‡è¦çš„å¥½å¤„ï¼Œé‚£å°±æ˜¯èƒ½å¤Ÿæ­£ç¡®è¯†åˆ«å››ä¸ªå­—èŠ‚çš„ Unicode å­—ç¬¦ã€‚\n\u0026#39;x\\uD83D\\uDE80y\u0026#39;.length // 4 [...\u0026#39;x\\uD83D\\uDE80y\u0026#39;].length // 3 ä¸Šé¢ä»£ç çš„ç¬¬ä¸€ç§å†™æ³•ï¼ŒJavaScript ä¼šå°†å››ä¸ªå­—èŠ‚çš„ Unicode å­—ç¬¦ï¼Œè¯†åˆ«ä¸º 2 ä¸ªå­—ç¬¦ï¼Œé‡‡ç”¨æ‰©å±•è¿ç®—ç¬¦å°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚å› æ­¤ï¼Œæ­£ç¡®è¿”å›å­—ç¬¦ä¸²é•¿åº¦çš„å‡½æ•°ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·å†™ã€‚\nfunction length(str) { return [...str].length; } length(\u0026#39;x\\uD83D\\uDE80y\u0026#39;) // 3 å‡¡æ˜¯æ¶‰åŠåˆ°æ“ä½œå››ä¸ªå­—èŠ‚çš„ Unicode å­—ç¬¦çš„å‡½æ•°ï¼Œéƒ½æœ‰è¿™ä¸ªé—®é¢˜ã€‚å› æ­¤ï¼Œ æœ€å¥½éƒ½ ç”¨æ‰©å±•è¿ç®—ç¬¦æ”¹å†™ã€‚\nlet str = \u0026#39;x\\uD83D\\uDE80y\u0026#39;; str.split(\u0026#39;\u0026#39;).reverse().join(\u0026#39;\u0026#39;) // \u0026#39;y\\uDE80\\uD83Dx\u0026#39; [...str].reverse().join(\u0026#39;\u0026#39;) // \u0026#39;y\\uD83D\\uDE80x\u0026#39; ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœä¸ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼Œå­—ç¬¦ä¸²çš„reverseæ“ä½œå°±ä¸æ­£ç¡®ã€‚\nå®ç°äº† Iterator æ¥å£çš„å¯¹è±¡ ä»»ä½•å®šä¹‰äº†éå†å™¨ï¼ˆIteratorï¼‰æ¥å£çš„å¯¹è±¡ï¼ˆå‚é˜… Iterator ä¸€ç« ï¼‰ï¼Œéƒ½å¯ä»¥ç”¨ æ‰©å±•è¿ç®—ç¬¦ è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚\nlet nodeList = document.querySelectorAll(\u0026#39;div\u0026#39;); let array = [...nodeList]; ä¸Šé¢ä»£ç ä¸­ï¼ŒquerySelectorAllæ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ª NodeList å¯¹è±¡ã€‚å®ƒä¸æ˜¯ æ•°ç»„ ï¼Œè€Œæ˜¯ä¸€ä¸ª ç±»ä¼¼æ•°ç»„ çš„å¯¹è±¡ã€‚è¿™æ—¶ï¼Œæ‰©å±•è¿ç®—ç¬¦å¯ä»¥å°†å…¶è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ï¼ŒåŸå› å°±åœ¨äº NodeList å¯¹è±¡å®ç°äº† Iterator ã€‚\nNumber.prototype[Symbol.iterator] = function*() { let i = 0; let num = this.valueOf(); while (i \u0026lt; num) { yield i++; } } console.log([...5]) // [0, 1, 2, 3, 4] ä¸Šé¢ä»£ç ä¸­ï¼Œå…ˆå®šä¹‰äº† Number å¯¹è±¡çš„éå†å™¨æ¥å£ï¼Œæ‰©å±•è¿ç®—ç¬¦å°† 5 è‡ªåŠ¨è½¬æˆ Number å®ä¾‹ä»¥åï¼Œå°±ä¼šè°ƒç”¨è¿™ä¸ªæ¥å£ï¼Œå°±ä¼šè¿”å›è‡ªå®šä¹‰çš„ç»“æœã€‚\nå¯¹äºé‚£äº›æ²¡æœ‰éƒ¨ç½² Iterator æ¥å£çš„ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæ‰©å±•è¿ç®—ç¬¦å°±æ— æ³•å°†å…¶è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚\nlet arrayLike = { \u0026#39;0\u0026#39;: \u0026#39;a\u0026#39;, \u0026#39;1\u0026#39;: \u0026#39;b\u0026#39;, \u0026#39;2\u0026#39;: \u0026#39;c\u0026#39;, \u0026#39;foo\u0026#39;:\u0026#39;bar\u0026#39;, length: 3 }; let arr = [...arrayLike]; // TypeError: Cannot spread non-iterable object. Array.from(arrayLike); // [ \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39; ] ä¸Šé¢ä»£ç ä¸­ï¼ŒarrayLike æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œä½†æ˜¯æ²¡æœ‰éƒ¨ç½² Iterator æ¥å£ï¼Œæ‰©å±•è¿ç®—ç¬¦å°±ä¼šæŠ¥é”™ã€‚è¿™æ—¶ï¼Œå¯ä»¥æ”¹ä¸ºä½¿ç”¨ Array.from æ–¹æ³•å°† arrayLike è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚\nMap å’Œ Set ç»“æ„ï¼ŒGenerator å‡½æ•° æ‰©å±•è¿ç®—ç¬¦å†…éƒ¨è°ƒç”¨çš„æ˜¯æ•°æ®ç»“æ„çš„ Iterator æ¥å£ï¼Œå› æ­¤åªè¦å…·æœ‰ Iterator æ¥å£çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼Œæ¯”å¦‚ Map ç»“æ„ã€‚\nlet map = new Map([ [1, \u0026#39;one\u0026#39;], [2, \u0026#39;two\u0026#39;], [3, \u0026#39;three\u0026#39;], ]); let arr = [...map.keys()]; // [1, 2, 3] Generator å‡½æ•°è¿è¡Œåï¼Œè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œå› æ­¤ä¹Ÿå¯ä»¥ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ã€‚\nconst go = function*(){ yield 1; yield 2; yield 3; }; [...go()] // [1, 2, 3] ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡ go æ˜¯ä¸€ä¸ª Generator å‡½æ•°ï¼Œæ‰§è¡Œåè¿”å›çš„æ˜¯ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œå¯¹è¿™ä¸ªéå†å™¨å¯¹è±¡æ‰§è¡Œæ‰©å±•è¿ç®—ç¬¦ï¼Œå°±ä¼šå°†å†…éƒ¨éå†å¾—åˆ°çš„å€¼ï¼Œè½¬ä¸ºä¸€ä¸ªæ•°ç»„ã€‚\n:warning: Caution\nå¦‚æœå¯¹æ²¡æœ‰ Iterator æ¥å£ çš„å¯¹è±¡ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼Œå°†ä¼šæŠ¥é”™ã€‚\nconst obj = {a: 1, b: 2}; let arr = [...obj]; // TypeError: Cannot spread non-iterable object è½¬æ¢ Array. from(), of()\nfrom()Â Array.from() æ–¹æ³•ç”¨äºå°†ä¸¤ç±»å¯¹è±¡è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ï¼šç±»ä¼¼æ•°ç»„çš„å¯¹è±¡array-like object å’Œå¯éå†iterable çš„å¯¹è±¡ï¼ˆåŒ…æ‹¬ ES6 æ–°å¢çš„æ•°æ®ç»“æ„ Set å’Œ Mapï¼‰ã€‚\nğŸ“ƒ Example\nä¸‹é¢æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œ Array.from å°†å®ƒè½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚\nlet arrayLike = { \u0026#39;0\u0026#39;: \u0026#39;a\u0026#39;, \u0026#39;1\u0026#39;: \u0026#39;b\u0026#39;, \u0026#39;2\u0026#39;: \u0026#39;c\u0026#39;, length: 3 }; // ES5çš„å†™æ³• var arr1 = [].slice.call(arrayLike); // [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;] // ES6çš„å†™æ³• let arr2 = Array.from(arrayLike); // [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;] let arr3 = [...[][Symbol.iterator].call(arrayLike)] // [ \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39; ] console.log(arr1, arr2, arr3); :link: Href [Array.protytype.slice()](05 JavaScript#array-slice-es5)\nå®é™…åº”ç”¨ä¸­ï¼Œå¸¸è§çš„ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡æ˜¯ DOM æ“ä½œè¿”å›çš„ NodeList é›†åˆï¼Œä»¥åŠå‡½æ•°å†…éƒ¨çš„ arguments å¯¹è±¡ã€‚Array.from éƒ½å¯ä»¥å°†å®ƒä»¬è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚\nğŸ“ƒ Example\n// NodeListå¯¹è±¡ let ps = document.querySelectorAll(\u0026#39;p\u0026#39;); Array.from(ps).filter(p =\u0026gt; { return p.textContent.length \u0026gt; 100; }); // argumentså¯¹è±¡ function foo() { var args = Array.from(arguments); // ... } ä¸Šé¢ä»£ç ä¸­ï¼ŒquerySelectorAll æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œå¯ä»¥å°†è¿™ä¸ªå¯¹è±¡è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ï¼Œå†ä½¿ç”¨ filter æ–¹æ³•ã€‚\n:link: Href [Array.prototype.filter()](05 JavaScript#array-filter-es5)\nåªè¦æ˜¯éƒ¨ç½²äº† Iterator æ¥å£çš„æ•°æ®ç»“æ„ï¼ŒArray.from éƒ½èƒ½å°†å…¶è½¬ä¸ºæ•°ç»„ã€‚\nğŸ“ƒ Example\nArray.from(\u0026#39;hello\u0026#39;) // [\u0026#39;h\u0026#39;, \u0026#39;e\u0026#39;, \u0026#39;l\u0026#39;, \u0026#39;l\u0026#39;, \u0026#39;o\u0026#39;] let namesSet = new Set([\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;]) Array.from(namesSet) // [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;] ä¸Šé¢ä»£ç ä¸­ï¼Œå­—ç¬¦ä¸²å’Œ Set ç»“æ„éƒ½å…·æœ‰ Iterator æ¥å£ï¼Œå› æ­¤å¯ä»¥è¢«Array.from è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚\nå¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ•°ç»„ï¼ŒArray.from ä¼šè¿”å›ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„æ–°æ•°ç»„ã€‚\nArray.from([1, 2, 3]) // [1, 2, 3] å€¼å¾—æé†’çš„æ˜¯ï¼Œæ‰©å±•è¿ç®—ç¬¦...theArgs ä¹Ÿå¯ä»¥å°†æŸäº›æ•°æ®ç»“æ„è½¬ä¸ºæ•°ç»„ã€‚\nğŸ“ƒ Example\n// argumentså¯¹è±¡ function foo() { const args = [...arguments]; } // NodeListå¯¹è±¡ [...document.querySelectorAll(\u0026#39;div\u0026#39;)] æ‰©å±•è¿ç®—ç¬¦èƒŒåè°ƒç”¨çš„æ˜¯ éå†å™¨æ¥å£Symbol.iterator ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡æ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ¥å£ï¼Œå°±æ— æ³•è½¬æ¢ã€‚Array.from æ–¹æ³•è¿˜æ”¯æŒç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€‚æ‰€è°“ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæœ¬è´¨ç‰¹å¾åªæœ‰ä¸€ç‚¹ï¼Œå³å¿…é¡»æœ‰ length å±æ€§ã€‚å› æ­¤ï¼Œä»»ä½•æœ‰ length å±æ€§çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥é€šè¿‡ Array.from æ–¹æ³•è½¬ä¸ºæ•°ç»„ï¼Œè€Œæ­¤æ—¶æ‰©å±•è¿ç®—ç¬¦å°±æ— æ³•è½¬æ¢ã€‚\nArray.from({ length: 3 }); // [ undefined, undefined, undefined ] ä¸Šé¢ä»£ç ä¸­ï¼ŒArray.from è¿”å›äº†ä¸€ä¸ªå…·æœ‰ä¸‰ä¸ªæˆå‘˜çš„æ•°ç»„ï¼Œæ¯ä¸ªä½ç½®çš„å€¼éƒ½æ˜¯ undefined ã€‚æ‰©å±•è¿ç®—ç¬¦è½¬æ¢ä¸äº†è¿™ä¸ªå¯¹è±¡ã€‚\nğŸ§ª Experimental\nlet foo = { 0: \u0026#39;a\u0026#39;, 1: \u0026#39;b\u0026#39;, 2: \u0026#39;c\u0026#39;, foo: \u0026#39;bar\u0026#39;, 4: \u0026#39;bbb\u0026#39;, length: 5 } Array.from(foo); // [ \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, undefined, \u0026#39;bbb\u0026#39; ] ğŸ“ Note å¯¹äºè¿˜æ²¡æœ‰éƒ¨ç½²è¯¥æ–¹æ³•çš„æµè§ˆå™¨ï¼Œå¯ä»¥ç”¨ Array.prototype.slice æ–¹æ³•æ›¿ä»£ã€‚\nconst toArray = ( function () { return Array.from ? Array.from : function (obj) { // IIFEï¼Œæ‰§è¡Œå®Œåè¿”å›è¿™ä¸ªç»“æ„ï¼š /* 1. æŒ‡å‘Array.fromå‡½æ•°çš„æŒ‡é’ˆ ** 2. æˆ–æ˜¯è‡ªå®šä¹‰åŒ¿åå‡½æ•°function ** æ¥æ”¶objä½œä¸ºå‚æ•° */ return [].slice.call(obj) } } )(); // ç®­å¤´å‡½æ•°ç²¾ç®€å†™æ³• const toArray = ( () =\u0026gt; Array.from ? Array.from : obj =\u0026gt; [].slice.call(obj) )(); console.log(toArray({0: \u0026#39;foo\u0026#39;, length: 3})); // [\u0026#39;foo\u0026#39;, undefined, undefined] console.log(toArray) Array.from è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œä½œç”¨ç±»ä¼¼äºæ•°ç»„çš„ map() æ–¹æ³•ï¼Œç”¨æ¥å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œå¤„ç†ï¼Œå°†å¤„ç†åçš„å€¼æ”¾å…¥è¿”å›çš„æ•°ç»„ã€‚\nArray.from(arrayLike, x =\u0026gt; x * x); // ç­‰åŒäº Array.from(arrayLike).map(x =\u0026gt; x * x); Array.from([1, 2, 3], x =\u0026gt; x * x); // [1, 4, 9] ä¸‹é¢çš„ä¾‹å­æ˜¯å–å‡ºä¸€ç»„ DOM èŠ‚ç‚¹çš„æ–‡æœ¬å†…å®¹ã€‚\nğŸ“ƒ Example\nlet spans = document.querySelectorAll(\u0026#39;span.name\u0026#39;); // map() let names1 = Array.prototype.map.call(spans, s =\u0026gt; s.textContent); // Array.from() let names2 = Array.from(spans, s =\u0026gt; s.textContent) ä¸‹é¢çš„ä¾‹å­å°†æ•°ç»„ä¸­å¸ƒå°”å€¼ä¸º false çš„æˆå‘˜è½¬ä¸º 0 ã€‚\nğŸ“ƒ Example\nArray.from([1, , 2, , 3], (n) =\u0026gt; n || 0) // [1, 0, 2, 0, 3] å¦ä¸€ä¸ªä¾‹å­æ˜¯è¿”å›å„ç§æ•°æ®çš„ç±»å‹ã€‚\nğŸ“ƒ Example\nfunction typesOf () { return Array.from(arguments, value =\u0026gt; typeof value) } typesOf(null, [], NaN) // [\u0026#39;object\u0026#39;, \u0026#39;object\u0026#39;, \u0026#39;number\u0026#39;] å¦‚æœ map å‡½æ•°é‡Œé¢ç”¨åˆ°äº† this å…³é”®å­—ï¼Œè¿˜å¯ä»¥ä¼ å…¥ Array.from() çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œç”¨æ¥ç»‘å®š this ã€‚\nArray.from() å¯ä»¥å°†å„ç§å€¼è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ï¼Œå¹¶ä¸”è¿˜æä¾› map åŠŸèƒ½ã€‚è¿™å®é™…ä¸Šæ„å‘³ç€ï¼Œåªè¦æœ‰ä¸€ä¸ªåŸå§‹çš„æ•°æ®ç»“æ„ï¼Œä½ å°±å¯ä»¥å…ˆå¯¹å®ƒçš„å€¼è¿›è¡Œå¤„ç†ï¼Œç„¶åè½¬æˆè§„èŒƒçš„æ•°ç»„ç»“æ„ï¼Œè¿›è€Œå°±å¯ä»¥ä½¿ç”¨æ•°é‡ä¼—å¤šçš„æ•°ç»„æ–¹æ³•ã€‚\nğŸ“ƒ Example\nArray.from({ length: 2 }, () =\u0026gt; \u0026#39;jack\u0026#39;) // [\u0026#39;jack\u0026#39;, \u0026#39;jack\u0026#39;] ä¸Šé¢ä»£ç ä¸­ï¼ŒArray.from çš„ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šäº†ç¬¬äºŒä¸ªå‚æ•°è¿è¡Œçš„æ¬¡æ•°ã€‚è¿™ç§ç‰¹æ€§å¯ä»¥è®©è¯¥æ–¹æ³•çš„ç”¨æ³•å˜å¾—éå¸¸çµæ´»ã€‚\nArray.from() çš„å¦ä¸€ä¸ªåº”ç”¨æ˜¯ï¼Œå°†å­—ç¬¦ä¸²è½¬ä¸ºæ•°ç»„ï¼Œç„¶åè¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚å› ä¸ºå®ƒèƒ½æ­£ç¡®å¤„ç†å„ç§ Unicode å­—ç¬¦ï¼Œå¯ä»¥é¿å… JavaScript å°†å¤§äº \\uFFFF çš„ [Unicode](01 W3C.md#unicode) å­—ç¬¦ï¼Œç®—ä½œä¸¤ä¸ªå­—ç¬¦çš„ bugã€‚\nfunction countSymbols(string) { return Array.from(string).length; } ğŸ“ Note [for-of](05 JavaScript#for-of) ä¹Ÿå¯ä»¥éå†å¤§äº \\uFFFF çš„ Unicode å­—ç¬¦\nof()Â Array.of æ–¹æ³•ç”¨äºå°†ä¸€ç»„å€¼ï¼Œè½¬æ¢ä¸ºæ•°ç»„ã€‚\nArray.of(3, 11, 8) // [3,11,8] Array.of(3) // [3] Array.of(3).length // 1 è¿™ä¸ªæ–¹æ³•çš„ä¸»è¦ç›®çš„ï¼Œæ˜¯å¼¥è¡¥æ•°ç»„æ„é€ å‡½æ•° Array() çš„ä¸è¶³ã€‚å› ä¸ºå‚æ•°ä¸ªæ•°çš„ä¸åŒï¼Œä¼šå¯¼è‡´ Array() çš„è¡Œä¸ºæœ‰å·®å¼‚ã€‚\nArray() // [] Array(3) // [, , ,] Array(3, 11, 8) // [3, 11, 8] ä¸Šé¢ä»£ç ä¸­ï¼ŒArray æ–¹æ³•æ²¡æœ‰å‚æ•°ã€ä¸€ä¸ªå‚æ•°ã€ä¸‰ä¸ªå‚æ•°æ—¶ï¼Œè¿”å›ç»“æœéƒ½ä¸ä¸€æ ·ã€‚åªæœ‰å½“å‚æ•°ä¸ªæ•°ä¸å°‘äº 2 ä¸ªæ—¶ï¼ŒArray() æ‰ä¼šè¿”å›ç”±å‚æ•°ç»„æˆçš„æ–°æ•°ç»„ã€‚å‚æ•°ä¸ªæ•°åªæœ‰ä¸€ä¸ªæ—¶ï¼Œå®é™…ä¸Šæ˜¯æŒ‡å®šæ•°ç»„çš„é•¿åº¦ã€‚\nArray.ofåŸºæœ¬ä¸Šå¯ä»¥ç”¨æ¥æ›¿ä»£ Array() æˆ– new Array() ï¼Œå¹¶ä¸”ä¸å­˜åœ¨ç”±äºå‚æ•°ä¸åŒè€Œå¯¼è‡´çš„é‡è½½ã€‚å®ƒçš„è¡Œä¸ºéå¸¸ç»Ÿä¸€ã€‚\nArray.of() // [] Array.of(undefined) // [undefined] Array.of(1) // [1] Array.of(1, 2) // [1, 2] Array.of æ€»æ˜¯è¿”å›å‚æ•°å€¼ç»„æˆçš„æ•°ç»„ã€‚å¦‚æœæ²¡æœ‰å‚æ•°ï¼Œå°±è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ã€‚\nğŸ“ Note Array.ofæ–¹æ³•å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿå®ç°ã€‚\nfunction arrayOf() { return [].slice.call(arguments); } console.log(arrayOf(1, 2, 3)); // [1, 2, 3] æ–¹æ³• Array. copyWithin, find() findIndex(), fill(), entries() keys() values(), includes(), flat(), flatMap()\ncopyWithin() æ•°ç»„å®ä¾‹çš„ copyWithin() æ–¹æ³•ï¼Œåœ¨å½“å‰æ•°ç»„å†…éƒ¨ï¼Œå°†æŒ‡å®šä½ç½®çš„æˆå‘˜å¤åˆ¶åˆ°å…¶ä»–ä½ç½®ï¼ˆä¼šè¦†ç›–åŸæœ‰æˆå‘˜ï¼‰ï¼Œç„¶åè¿”å›å½“å‰æ•°ç»„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¼šä¿®æ”¹å½“å‰æ•°ç»„ã€‚è¡Œä¸ºæœ‰ç‚¹ç±»ä¼¼ [Array.prototype.splice()](05 JavaScript#array-splice) ã€‚\nArray.prototype.copyWithin( target = 0, start = 0, end = this.length ); å®ƒæ¥å—ä¸‰ä¸ªå‚æ•°ã€‚\næ–¹æ³• çŠ¶æ€ è¯´æ˜ target å¿…éœ€ ä»è¯¥ä½ç½®å¼€å§‹æ›¿æ¢æ•°æ®ã€‚å¦‚æœä¸ºè´Ÿå€¼ï¼Œè¡¨ç¤ºå€’æ•°ã€‚ start å¯é€‰ ä»è¯¥ä½ç½®å¼€å§‹è¯»å–æ•°æ®ï¼Œé»˜è®¤ä¸º 0ã€‚å¦‚æœä¸ºè´Ÿå€¼ï¼Œè¡¨ç¤ºä»æœ«å°¾å¼€å§‹è®¡ç®—ã€‚\næ³¨ï¼šä¸‹æ ‡ä» 0 å¼€å§‹ end å¯é€‰ åˆ°è¯¥ä½ç½® å‰ åœæ­¢è¯»å–æ•°æ®ï¼Œé»˜è®¤ç­‰äºæ•°ç»„é•¿åº¦ã€‚å¦‚æœä¸ºè´Ÿå€¼ï¼Œè¡¨ç¤ºä»æœ«å°¾å¼€å§‹è®¡ç®—ã€‚ è¿™ä¸‰ä¸ªå‚æ•°éƒ½åº”è¯¥æ˜¯ æ•°å€¼number ï¼Œå¦‚æœä¸æ˜¯ï¼Œä¼šè‡ªåŠ¨è½¬ä¸ºæ•°å€¼ã€‚\nğŸ“ƒ Example\n[1, 2, 3, 4, 5].copyWithin(0, 3) // [4, 5, 3, 4, 5] ä¸Šé¢ä»£ç è¡¨ç¤ºå°†ä» 3 å·ä½ç›´åˆ° æ•°ç»„ç»“æŸArray.length çš„æˆå‘˜ï¼ˆ4 å’Œ 5ï¼‰ï¼Œå¤åˆ¶åˆ°ä» 0 å·ä½å¼€å§‹çš„ä½ç½®ï¼Œç»“æœè¦†ç›–äº†åŸæ¥çš„ 1 å’Œ 2 ã€‚\nğŸ“ƒ Example\nconsole.log( // å°†3å·ä½å¤åˆ¶åˆ°0å·ä½ [1, 2, 3, 4, 5].copyWithin(0, 3, 4), // [4, 2, 3, 4, 5] // -2ç›¸å½“äº3å·ä½ï¼Œ-1ç›¸å½“äº4å·ä½ [1, 2, 3, 4, 5].copyWithin(0, -2, -1), // [4, 2, 3, 4, 5] // å°†3å·ä½å¤åˆ¶åˆ°0å·ä½ [].copyWithin.call({length: 5, 3: 1}, 0, 3), // {0: 1, 3: 1, length: 5} // å°†2å·ä½åˆ°æ•°ç»„ç»“æŸï¼Œå¤åˆ¶åˆ°0å·ä½ new Int32Array([1, 2, 3, 4, 5]) .copyWithin(0, 2), // Int32Array [3, 4, 5, 4, 5] // å¯¹äºæ²¡æœ‰éƒ¨ç½² TypedArray çš„ copyWithin æ–¹æ³•çš„å¹³å° // éœ€è¦é‡‡ç”¨ä¸‹é¢çš„å†™æ³• [].copyWithin.call(new Int32Array([1, 2, 3, 4, 5]), 0, 3, 4) // Int32Array [4, 2, 3, 4, 5]*/ ) find() findIndex()Â æ•°ç»„å®ä¾‹çš„ find() æ–¹æ³•ï¼Œç”¨äºæ‰¾å‡ºç¬¬ä¸€ä¸ª ç¬¦åˆæ¡ä»¶ çš„æ•°ç»„æˆå‘˜ã€‚å®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ‰€æœ‰æ•°ç»„æˆå‘˜ä¾æ¬¡æ‰§è¡Œè¯¥å›è°ƒå‡½æ•°ï¼Œç›´åˆ°æ‰¾å‡ºç¬¬ä¸€ä¸ªè¿”å›å€¼ä¸º true çš„æˆå‘˜ï¼Œç„¶åè¿”å›è¯¥ æˆå‘˜item ã€‚å¦‚æœæ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„æˆå‘˜ï¼Œåˆ™è¿”å› undefined ã€‚\nè¯¥æ–¹æ³•ä¸€æ—¦æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„é¡¹ï¼Œå°±ä¸ä¼šç»§ç»­éå†æ•°ç»„ï¼Œé€‚åˆæ€§èƒ½ä¼˜åŒ–ã€‚\nğŸ“ Note å¯ä»¥ç”¨ä¸Š æ­£åˆ™è¡¨è¾¾å¼RegExp ã€‚\n:link: Href [Array.protytype.indexOf()](05 JavaScript#array-index-of-es5)\nğŸ“ƒ Example\n[1, 4, -5, 10].find(n =\u0026gt; n \u0026lt; 0); // -5 ä¸Šé¢ä»£ç æ‰¾å‡ºæ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå°äº 0 çš„æˆå‘˜ã€‚\nğŸ“ƒ Example\n[1, 5, 10, 15].find( (item, index, arr) =\u0026gt; item \u0026gt; 9 ); // 10 ä¸Šé¢ä»£ç ä¸­ï¼Œfind() æ–¹æ³•çš„å›è°ƒå‡½æ•°å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸ºå½“å‰çš„å€¼ã€å½“å‰çš„ä½ç½®å’ŒåŸæ•°ç»„ã€‚\næ•°ç»„å®ä¾‹çš„ findIndex æ–¹æ³•çš„ç”¨æ³•ä¸ find() æ–¹æ³•éå¸¸ç±»ä¼¼ï¼Œè¿”å›ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ•°ç»„æˆå‘˜çš„ ä½ç½®index ï¼Œå¦‚æœæ‰€æœ‰æˆå‘˜éƒ½ä¸ç¬¦åˆæ¡ä»¶ï¼Œåˆ™è¿”å› -1 ã€‚\n[1, 5, 10, 15].findIndex( (value, index, arr) =\u0026gt; value \u0026gt; 9 ) // 2 è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œç”¨æ¥ç»‘å®šå›è°ƒå‡½æ•°çš„ this å¯¹è±¡ã€‚\nfunction f(v) {return v \u0026gt; this.age;} // const f = (v) =\u0026gt; v \u0026gt; this.age; /* ä½¿ç”¨ç®­å¤´å‡½æ•°ä¼šå¯¼è‡´æ— æ³•æ¥æ”¶åˆ°this */ let person = {name: \u0026#39;John\u0026#39;, age: 20}; [10, 12, 26, 15].find(f, person); // 26 ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ find() å‡½æ•°æ¥æ”¶äº†ç¬¬äºŒä¸ªå‚æ•° person å¯¹è±¡ï¼Œå›è°ƒå‡½æ•°ä¸­çš„ this å¯¹è±¡æŒ‡å‘personå¯¹è±¡ã€‚\nå¦å¤–ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½å¯ä»¥å‘ç° NaN ï¼Œå¼¥è¡¥äº†æ•°ç»„çš„ indexOf æ–¹æ³•çš„ä¸è¶³ã€‚\n[NaN].indexOf(NaN); // -1 [NaN].findIndex(y =\u0026gt; Object.is(NaN, y)) // 0 ä¸Šé¢ä»£ç ä¸­ï¼ŒindexOfæ–¹æ³•æ— æ³•è¯†åˆ«æ•°ç»„çš„ NaN æˆå‘˜ï¼Œä½†æ˜¯findIndexæ–¹æ³•å¯ä»¥å€ŸåŠ© Object.is æ–¹æ³•åšåˆ°ã€‚\nfill()Â fill æ–¹æ³•ä½¿ç”¨ç»™å®šå€¼ï¼Œå¡«å……ä¸€ä¸ªæ•°ç»„ã€‚\nğŸ“ƒ Example\n[\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;].fill(7) // [7, 7, 7] new Array(3).fill(7) // [7, 7, 7] ä¸Šé¢ä»£ç è¡¨æ˜ï¼Œ fill æ–¹æ³•ç”¨äºç©ºæ•°ç»„çš„åˆå§‹åŒ–éå¸¸æ–¹ä¾¿ã€‚æ•°ç»„ä¸­å·²æœ‰çš„å…ƒç´ ï¼Œä¼šè¢«å…¨éƒ¨æŠ¹å»ã€‚\nfill æ–¹æ³•è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œç”¨äºæŒ‡å®šå¡«å……çš„èµ·å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚\nğŸ“ƒ Example\n[\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;].fill(7, 1, 2); // [\u0026#39;a\u0026#39;, 7, \u0026#39;c\u0026#39;] ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œ fill æ–¹æ³•ä» 1 å·ä½å¼€å§‹ï¼Œå‘åŸæ•°ç»„å¡«å…… 7ï¼Œåˆ° 2 å·ä½ä¹‹å‰ç»“æŸã€‚\næ³¨æ„ï¼Œå¦‚æœå¡«å……çš„ç±»å‹ä¸ºå¯¹è±¡ï¼Œé‚£ä¹ˆè¢«èµ‹å€¼çš„æ˜¯åŒä¸€ä¸ªå†…å­˜åœ°å€çš„å¯¹è±¡ï¼ˆå¯¹è±¡æŒ‡é’ˆpointer ï¼‰ï¼Œè€Œä¸æ˜¯ æ·±æ‹·è´deepCopy å¯¹è±¡ã€‚\nâ€”â€”è¿™å¯¼è‡´ä¿®æ”¹å…¶ä¸­ä¸€ä¸ªå€¼çš„æ—¶å€™ï¼Œå…¶å®ƒä½ä¸Šçš„å†…å®¹ä¹Ÿä¼šç›¸åº”æ”¹å˜ã€‚\nlet arr = new Array(3).fill({name: \u0026#34;Mike\u0026#34;}); arr[0].name = \u0026#34;Ben\u0026#34;; console.log(arr); // [{name: \u0026#34;Ben\u0026#34;}, {name: \u0026#34;Ben\u0026#34;}, {name: \u0026#34;Ben\u0026#34;}] let arr2 = new Array(3).fill([]); arr2[0].push(5); console.log(arr2); // [[5], [5], [5]] keys() values() entries()Â ç”¨äºéå†æ•°ç»„ã€‚å®ƒä»¬éƒ½è¿”å›ä¸€ä¸ª éå†å™¨Iterator å¯¹è±¡ï¼Œå¯ä»¥ç”¨ for-of å¾ªç¯è¿›è¡Œéå†ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯ keys() æ˜¯å¯¹é”®åçš„éå†ã€values() æ˜¯å¯¹é”®å€¼çš„éå†ï¼Œentries() æ˜¯å¯¹é”®å€¼å¯¹çš„éå†ã€‚\n:link: Href Iterator.methods\nfor (let index of [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;].keys()) { console.log(index); } // 0 1 for (let elem of [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;].values()) { console.log(elem); } // \u0026#39;a\u0026#39; \u0026#39;b\u0026#39; for (let [index, elem] of [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;].entries()) { console.log([index, elem]); } // [0, \u0026#39;a\u0026#39;] [1, \u0026#39;b\u0026#39;] å¦‚æœä¸ä½¿ç”¨ for-of å¾ªç¯ï¼Œå¯ä»¥æ‰‹åŠ¨è°ƒç”¨éå†å™¨å¯¹è±¡çš„ next æ–¹æ³•ï¼Œè¿›è¡Œéå†ã€‚\nlet letter = [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;]; let entries = letter.entries(); console.log( entries.next().value, // [0, \u0026#39;a\u0026#39;] entries.next().value, // [1, \u0026#39;b\u0026#39;] entries.next().value // [2, \u0026#39;c\u0026#39;] ) includes()Â Array.prototype.includes æ–¹æ³•è¿”å›ä¸€ä¸ª boolean ï¼Œè¡¨ç¤ºæŸä¸ªæ•°ç»„æ˜¯å¦åŒ…å«ç»™å®šçš„å€¼ï¼Œä¸å­—ç¬¦ä¸²çš„ includes æ–¹æ³•ç±»ä¼¼ã€‚ES2016 å¼•å…¥äº†è¯¥æ–¹æ³•ã€‚\næ”¯æŒ NaN ã€‚(Array.prototype.includes() ä¸æ”¯æŒ)\nconsole.log( [1, 2, 3].includes(2), // true [1, 2, 3].includes(4), // false [1, 2, NaN].includes(NaN) // true ) è¯¥æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæœç´¢çš„èµ·å§‹ä½ç½®ï¼Œé»˜è®¤ä¸º 0 ã€‚å¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¸ºè´Ÿæ•°ï¼Œåˆ™è¡¨ç¤ºå€’æ•°çš„ä½ç½®ï¼Œå¦‚æœè¿™æ—¶å®ƒå¤§äºæ•°ç»„é•¿åº¦ï¼ˆæ¯”å¦‚ç¬¬äºŒä¸ªå‚æ•°ä¸º -4 ï¼Œä½†æ•°ç»„é•¿åº¦ä¸º 3 ï¼‰ï¼Œåˆ™ä¼šé‡ç½®ä¸ºä» 0 å¼€å§‹ã€‚\nconsole.log( [1, 2, 3].includes(3, 3), // false [1, 2, 3].includes(3, -1) // true ) æ²¡æœ‰è¯¥æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨æ•°ç»„çš„ indexOf æ–¹æ³•ï¼Œæ£€æŸ¥æ˜¯å¦åŒ…å«æŸä¸ªå€¼ã€‚\nif (arr.indexOf(el) !== -1) { // ... } indexOf æ–¹æ³•æœ‰ä¸¤ä¸ªç¼ºç‚¹ï¼Œä¸€æ˜¯ä¸å¤Ÿè¯­ä¹‰åŒ–ï¼Œå®ƒçš„å«ä¹‰æ˜¯æ‰¾åˆ°å‚æ•°å€¼çš„ç¬¬ä¸€ä¸ªå‡ºç°ä½ç½®ï¼Œæ‰€ä»¥è¦å»æ¯”è¾ƒæ˜¯å¦ä¸ç­‰äº -1 ï¼Œè¡¨è¾¾èµ·æ¥ä¸å¤Ÿç›´è§‚ã€‚äºŒæ˜¯ï¼Œå®ƒå†…éƒ¨ä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ===ï¼‰è¿›è¡Œåˆ¤æ–­ï¼Œè¿™ä¼šå¯¼è‡´å¯¹ NaN çš„è¯¯åˆ¤ã€‚\n[NaN].indexOf(NaN) // -1 includesä½¿ç”¨çš„æ˜¯ä¸ä¸€æ ·çš„åˆ¤æ–­ç®—æ³•ï¼Œå°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚\n[NaN].includes(NaN) // true ä¸‹é¢ä»£ç ç”¨æ¥æ£€æŸ¥å½“å‰ç¯å¢ƒæ˜¯å¦æ”¯æŒè¯¥æ–¹æ³•ï¼Œå¦‚æœä¸æ”¯æŒï¼Œéƒ¨ç½²ä¸€ä¸ªç®€æ˜“çš„æ›¿ä»£ç‰ˆæœ¬ã€‚\nconst contains = (() =\u0026gt; Array.prototype.includes ? (arr, value) =\u0026gt; arr.includes(value) : (arr, value) =\u0026gt; arr.some(item =\u0026gt; item === value) )(); contains([\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;], \u0026#39;baz\u0026#39;); // =\u0026gt; false /** * some() æ–¹æ³•æµ‹è¯•æ•°ç»„ä¸­æ˜¯ä¸æ˜¯è‡³å°‘æœ‰1ä¸ªå…ƒç´ é€šè¿‡äº†è¢«æä¾›çš„å‡½æ•°æµ‹è¯• * å®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªBooleanç±»å‹çš„å€¼ * ES6/ES2015 */ å¦å¤–ï¼ŒMap å’Œ Set æ•°æ®ç»“æ„æœ‰ä¸€ä¸ªhasæ–¹æ³•ï¼Œéœ€è¦æ³¨æ„ä¸includesåŒºåˆ†ã€‚\nMap ç»“æ„çš„ has æ–¹æ³•ï¼Œæ˜¯ç”¨æ¥æŸ¥æ‰¾é”®åçš„ï¼Œæ¯”å¦‚Map.prototype.has(key), WeakMap.prototype.has(key), Reflect.has(target, propertyKey) Set ç»“æ„çš„ has æ–¹æ³•ï¼Œæ˜¯ç”¨æ¥æŸ¥æ‰¾å€¼çš„ï¼Œæ¯”å¦‚Set.prototype.has(value), WeakSet.prototype.has(value) ğŸ“ƒ Example\nconst condition = [1,2,3,4]; if( condition.includes(element) ){ //... } flat() flatMap()Â æ•°ç»„çš„æˆå‘˜æœ‰æ—¶è¿˜æ˜¯æ•°ç»„ï¼ŒArray.prototype.flat() ç”¨äºå°†åµŒå¥—çš„æ•°ç»„â€œæ‹‰å¹³â€ï¼Œå˜æˆä¸€ç»´çš„æ•°ç»„ã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œå¯¹åŸæ•°æ®æ²¡æœ‰å½±å“ã€‚\nğŸ§ª Experimental æ·±åº¦ä¼˜å…ˆéå†ï¼Ÿ\nğŸ“ƒ Example\n[1, 2, [3, 4]].flat(); // [1, 2, 3, 4] ä¸Šé¢ä»£ç ä¸­ï¼ŒåŸæ•°ç»„çš„æˆå‘˜é‡Œé¢æœ‰ä¸€ä¸ªæ•°ç»„ï¼Œ flat() æ–¹æ³•å°†å­æ•°ç»„çš„æˆå‘˜å–å‡ºæ¥ï¼Œæ·»åŠ åœ¨åŸæ¥çš„ä½ç½®ã€‚\nflat() é»˜è®¤åªä¼šâ€œæ‹‰å¹³â€ä¸€å±‚ï¼Œå¦‚æœæƒ³è¦â€œæ‹‰å¹³â€å¤šå±‚çš„åµŒå¥—æ•°ç»„ï¼Œå¯ä»¥å°† flat() æ–¹æ³•çš„å‚æ•°å†™æˆä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæƒ³è¦æ‹‰å¹³çš„å±‚æ•°ï¼Œé»˜è®¤ä¸º 1 ã€‚\nğŸ“ƒ Example\n[1, 2, [3, [4, 5]]].flat() // [1, 2, 3, [4, 5]] [1, 2, [3, [4, 5]]].flat(2) // [1, 2, 3, 4, 5] ä¸Šé¢ä»£ç ä¸­ï¼Œflat() çš„å‚æ•°ä¸º 2 ï¼Œè¡¨ç¤ºè¦â€œæ‹‰å¹³â€ä¸¤å±‚çš„åµŒå¥—æ•°ç»„ã€‚\nå¦‚æœä¸ç®¡æœ‰å¤šå°‘å±‚åµŒå¥—ï¼Œéƒ½è¦è½¬æˆä¸€ç»´æ•°ç»„ï¼Œå¯ä»¥ç”¨ Infinity å…³é”®å­—ä½œä¸ºå‚æ•°ã€‚\n[1, [2, [3]]].flat(Infinity) // [1, 2, 3] å¦‚æœåŸæ•°ç»„æœ‰ç©ºä½ï¼Œ flat() æ–¹æ³•ä¼šè·³è¿‡ç©ºä½ã€‚\n[1, 2, , 4, 5].flat() // [1, 2, 4, 5] flatMap() æ–¹æ³•å¯¹åŸæ•°ç»„çš„æ¯ä¸ªæˆå‘˜æ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼ˆç›¸å½“äºæ‰§è¡Œ Array.prototype.map() ï¼‰ï¼Œç„¶åå¯¹è¿”å›å€¼ç»„æˆçš„æ•°ç»„æ‰§è¡Œ flat() æ–¹æ³•ã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œä¸æ”¹å˜åŸæ•°ç»„ã€‚\n// ç›¸å½“äº [[2, 4], [3, 6], [4, 8]].flat() [2, 3, 4].flatMap((x) =\u0026gt; [x, x * 2]) // [2, 4, 3, 6, 4, 8] flatMap()åªèƒ½å±•å¼€ä¸€å±‚æ•°ç»„ã€‚\nğŸ“ƒ Example\n// ç›¸å½“äº [[[2]], [[4]], [[6]], [[8]]].flat() [1, 2, 3, 4].flatMap(x =\u0026gt; [[x * 2]]) // [[2], [4], [6], [8]] ä¸Šé¢ä»£ç ä¸­ï¼Œéå†å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªåŒå±‚çš„æ•°ç»„ï¼Œä½†æ˜¯é»˜è®¤åªèƒ½å±•å¼€ä¸€å±‚ï¼Œå› æ­¤ flatMap() è¿”å›çš„è¿˜æ˜¯ä¸€ä¸ªåµŒå¥—æ•°ç»„ã€‚\nflatMap() æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªéå†å‡½æ•°ï¼Œè¯¥å‡½æ•°å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯å½“å‰æ•°ç»„æˆå‘˜ã€å½“å‰æ•°ç»„æˆå‘˜çš„ä½ç½®ï¼ˆä»é›¶å¼€å§‹ï¼‰ã€åŸæ•°ç»„ã€‚\narr.flatMap(function callback(currentValue[, index[, array]]) { // ... }[, thisArg]) flatMap() æ–¹æ³•è¿˜å¯ä»¥æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œç”¨æ¥ç»‘å®šéå†å‡½æ•°é‡Œé¢çš„ this ã€‚\nğŸ“ƒ Example\nä¸€ä¸ªéƒ¨é—¨ JSON æ•°æ®ä¸­ï¼Œå±æ€§åæ˜¯éƒ¨é—¨ id ï¼Œå±æ€§å€¼æ˜¯ä¸ªéƒ¨é—¨æˆå‘˜ id æ•°ç»„é›†åˆï¼Œç°åœ¨è¦æŠŠæœ‰éƒ¨é—¨çš„æˆå‘˜ id éƒ½æå–åˆ°ä¸€ä¸ªæ•°ç»„é›†åˆä¸­ã€‚\nâ ES5\nconst deps = { \u0026#39;é‡‡è´­éƒ¨\u0026#39;: [1, 2, 3], \u0026#39;äººäº‹éƒ¨\u0026#39;: [5, 8, 12], \u0026#39;è¡Œæ”¿éƒ¨\u0026#39;: [5, 14, 79], \u0026#39;è¿è¾“éƒ¨\u0026#39;: [3, 64, 105], } let member = []; for (let item in deps) { const value = deps[item]; if (Array.isArray(value)) member = [...member, ...value]; } member = [...new Set(member)]; console.log(member); // [ // 1, 2, 3, 5, 8, // 12, 14, 79, 64, 105 // âœ… ES6\nObject.values è¿”å›æ‹¥æœ‰å¯¹è±¡çš„å…¨éƒ¨å±æ€§å€¼çš„ æ•°ç»„*^array^* ES6 æ–°å¢ flat æ–¹æ³•ç”¨Infinity ä½œä¸ºflatçš„å‚æ•°ï¼Œä½¿å¾—æ— éœ€çŸ¥é“è¢«æ‰å¹³åŒ–çš„æ•°ç»„çš„ç»´åº¦ æœ€åä½¿ç”¨ new Set() ä¸æ‹“å±•æ“ä½œç¬¦^\u0026hellip;^ å»é™¤é‡å¤å…ƒç´ å¹¶è¿›è¡Œæ’åº const deps = { \u0026#39;é‡‡è´­éƒ¨\u0026#39;:[1,2,3], \u0026#39;äººäº‹éƒ¨\u0026#39;:[5,8,12], \u0026#39;è¡Œæ”¿éƒ¨\u0026#39;:[5,14,79], \u0026#39;è¿è¾“éƒ¨\u0026#39;:[3,64,105], } const member = [...new Set(Object.values(deps).flat(Infinity))]; console.log(member); ğŸ“ Note flat æ–¹æ³•ä¸æ”¯æŒ IE æµè§ˆå™¨ã€‚\nç©ºä½ æ•°ç»„çš„ç©ºä½æŒ‡ï¼Œæ•°ç»„çš„æŸä¸€ä¸ªä½ç½®æ²¡æœ‰ä»»ä½•å€¼ã€‚æ¯”å¦‚ï¼ŒArrayæ„é€ å‡½æ•°è¿”å›çš„æ•°ç»„éƒ½æ˜¯ç©ºä½ã€‚\nArray(3) // [, , ,] // [ \u0026lt;3 empty items\u0026gt; ] ä¸Šé¢ä»£ç ä¸­ï¼ŒArray(3) è¿”å›ä¸€ä¸ªå…·æœ‰ 3 ä¸ª ç©ºä½ çš„æ•°ç»„ã€‚\næ³¨æ„ï¼Œç©ºä½ä¸æ˜¯ undefinedï¼Œä¸€ä¸ªä½ç½®çš„å€¼ç­‰äº undefined ï¼Œä¾ç„¶æ˜¯ æœ‰å€¼ çš„ã€‚ç©ºä½æ˜¯æ²¡æœ‰ä»»ä½•å€¼ï¼Œinè¿ç®—ç¬¦å¯ä»¥è¯´æ˜è¿™ä¸€ç‚¹ã€‚\n0 in [undefined, undefined, undefined] // true 0 in [, , ,] // false ä¸Šé¢ä»£ç è¯´æ˜ï¼Œç¬¬ä¸€ä¸ªæ•°ç»„çš„ 0 å·ä½ç½®æ˜¯æœ‰å€¼çš„ï¼Œç¬¬äºŒä¸ªæ•°ç»„çš„ 0 å·ä½ç½®æ²¡æœ‰å€¼ã€‚\nES5 å¯¹ç©ºä½çš„å¤„ç†ï¼Œå·²ç»å¾ˆä¸ä¸€è‡´äº†ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ä¼šå¿½ç•¥ç©ºä½ã€‚\nforEach(), filter(), reduce(), every() å’Œsome()éƒ½ä¼šè·³è¿‡ç©ºä½ map()ä¼šè·³è¿‡ç©ºä½ï¼Œä½†ä¼šä¿ç•™è¿™ä¸ªå€¼ join() å’Œ toString() ä¼šå°†ç©ºä½è§†ä¸º undefined ï¼Œè€Œ undefined å’Œ null ä¼šè¢«å¤„ç†æˆç©ºå­—ç¬¦ä¸²ã€‚ // forEachæ–¹æ³• [,\u0026#39;a\u0026#39;].forEach((x,i) =\u0026gt; console.log(i)); // 1 // filteræ–¹æ³• [\u0026#39;a\u0026#39;,,\u0026#39;b\u0026#39;].filter(x =\u0026gt; true) // [\u0026#39;a\u0026#39;,\u0026#39;b\u0026#39;] // everyæ–¹æ³• [,\u0026#39;a\u0026#39;].every(x =\u0026gt; x===\u0026#39;a\u0026#39;) // true // reduceæ–¹æ³• [1,,2].reduce((x,y) =\u0026gt; x+y) // 3 // someæ–¹æ³• [,\u0026#39;a\u0026#39;].some(x =\u0026gt; x !== \u0026#39;a\u0026#39;) // false // mapæ–¹æ³• [,\u0026#39;a\u0026#39;].map(x =\u0026gt; 1) // [,1] // joinæ–¹æ³• [,\u0026#39;a\u0026#39;,undefined,null].join(\u0026#39;#\u0026#39;) // \u0026#34;#a##\u0026#34; // toStringæ–¹æ³• [,\u0026#39;a\u0026#39;,undefined,null].toString() // \u0026#34;,a,,\u0026#34; ES6 åˆ™æ˜¯æ˜ç¡®å°†ç©ºä½è½¬ä¸º undefined\nArray.fromæ–¹æ³•ä¼šå°†æ•°ç»„çš„ç©ºä½ï¼Œè½¬ä¸ºundefinedï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªæ–¹æ³•ä¸ä¼šå¿½ç•¥ç©ºä½ã€‚\nArray.from([\u0026#39;a\u0026#39;,,\u0026#39;b\u0026#39;]) // [ \u0026#34;a\u0026#34;, undefined, \u0026#34;b\u0026#34; ] æ‰©å±•è¿ç®—ç¬¦ï¼ˆ...ï¼‰ä¹Ÿä¼šå°†ç©ºä½è½¬ä¸ºundefinedã€‚\n[...[\u0026#39;a\u0026#39;,,\u0026#39;b\u0026#39;]] // [ \u0026#34;a\u0026#34;, undefined, \u0026#34;b\u0026#34; ] copyWithin()ä¼šè¿ç©ºä½ä¸€èµ·æ‹·è´ã€‚\n[,\u0026#39;a\u0026#39;,\u0026#39;b\u0026#39;,,].copyWithin(2,0) // [,\u0026#34;a\u0026#34;,,\u0026#34;a\u0026#34;] fill()ä¼šå°†ç©ºä½è§†ä¸ºæ­£å¸¸çš„æ•°ç»„ä½ç½®ã€‚\nnew Array(3).fill(\u0026#39;a\u0026#39;) // [\u0026#34;a\u0026#34;,\u0026#34;a\u0026#34;,\u0026#34;a\u0026#34;] for...ofå¾ªç¯ä¹Ÿä¼šéå†ç©ºä½ã€‚\nlet arr = [, ,]; for (let i of arr) { console.log(1); } // 1 // 1 ä¸Šé¢ä»£ç ä¸­ï¼Œæ•°ç»„arræœ‰ä¸¤ä¸ªç©ºä½ï¼Œfor...of å¹¶æ²¡æœ‰å¿½ç•¥å®ƒä»¬ã€‚å¦‚æœæ”¹æˆ Map æ–¹æ³•éå†ï¼Œç©ºä½æ˜¯ä¼šè·³è¿‡çš„ã€‚\nentries()ã€keys()ã€values()ã€find()å’ŒfindIndex()ä¼šå°†ç©ºä½å¤„ç†æˆundefinedã€‚\n// entries() [...[,\u0026#39;a\u0026#39;].entries()] // [[0,undefined], [1,\u0026#34;a\u0026#34;]] // keys() [...[,\u0026#39;a\u0026#39;].keys()] // [0,1] // values() [...[,\u0026#39;a\u0026#39;].values()] // [undefined,\u0026#34;a\u0026#34;] // find() [,\u0026#39;a\u0026#39;].find(x =\u0026gt; true) // undefined // findIndex() [,\u0026#39;a\u0026#39;].findIndex(x =\u0026gt; true) // 0 ç”±äºç©ºä½çš„å¤„ç†è§„åˆ™éå¸¸ä¸ç»Ÿä¸€ï¼Œæ‰€ä»¥å»ºè®®é¿å…å‡ºç°ç©ºä½ã€‚\næ’åº Array.prototype.sort() çš„æ’åºç¨³å®šæ€§\næ’åºç¨³å®šæ€§stable sorting æ˜¯æ’åºç®—æ³• [sort()](05 JavaScript#array-sort) çš„é‡è¦å±æ€§ï¼ŒæŒ‡çš„æ˜¯æ’åºå…³é”®å­—ç›¸åŒçš„é¡¹ç›®ï¼Œæ’åºå‰åçš„é¡ºåºä¸å˜ã€‚\nconst arr = [\u0026#39;peach\u0026#39;, \u0026#39;straw\u0026#39;, \u0026#39;apple\u0026#39;, \u0026#39;spork\u0026#39;]; const stableSorting = (s1, s2) =\u0026gt; s1[0] \u0026lt; s2[0] ? -1 : 1; console.log(arr.sort(stableSorting)); // [\u0026#34;apple\u0026#34;, \u0026#34;peach\u0026#34;, \u0026#34;straw\u0026#34;, \u0026#34;spork\u0026#34;] ä¸Šé¢ä»£ç å¯¹æ•°ç»„ arr æŒ‰ç…§é¦–å­—æ¯è¿›è¡Œæ’åºã€‚æ’åºç»“æœä¸­ï¼Œstrawåœ¨sporkçš„å‰é¢ï¼Œè·ŸåŸå§‹é¡ºåºä¸€è‡´ï¼Œæ‰€ä»¥æ’åºç®—æ³• stableSorting æ˜¯ç¨³å®šæ’åºã€‚\nğŸ“ Note [String](05 JavaScript#string) ç±»å‹ä¸èƒ½ç›´æ¥åŠ å‡ï¼Œä½†å¯ä»¥æ¯”è¾ƒå¤§å°\nconst arr = [\u0026#39;peach\u0026#39;, \u0026#39;straw\u0026#39;, \u0026#39;apple\u0026#39;, \u0026#39;spork\u0026#39;]; const stableSorting = (s1, s2) =\u0026gt; s1[0] \u0026lt;= s2[0] ? -1 : 1; console.log(arr.sort(stableSorting)); // [\u0026#34;apple\u0026#34;, \u0026#34;peach\u0026#34;, \u0026#34;spork\u0026#34;, \u0026#34;straw\u0026#34;] ä¸Šé¢ä»£ç ä¸­ï¼Œæ’åºç»“æœæ˜¯ spork åœ¨ straw å‰é¢ï¼Œè·ŸåŸå§‹é¡ºåº ç›¸å ï¼Œæ‰€ä»¥æ’åºç®—æ³•unstableSortingæ˜¯ ä¸ç¨³å®š çš„ã€‚\nğŸ“ Note æ ¹æ®æ’åºç®—æ³•ï¼ŒArray.sort(compareFn) çš„æ¯”è¾ƒå‡½æ•°åœ¨å‰åç›¸ç­‰aå‰ bå çš„æ—¶å€™è¿”å› -1 ï¼Œä¼šå‘ç”Ÿå‰åäº¤æ¢é¡ºåºï¼Œè¿›è€Œå¯¼è‡´ æ’åºä¸ç¨³å®š ã€‚\nå¸¸è§çš„æ’åºç®—æ³•ä¹‹ä¸­ï¼Œæ’å…¥æ’åºã€åˆå¹¶æ’åºã€å†’æ³¡æ’åºç­‰éƒ½æ˜¯ç¨³å®šçš„ï¼Œå †æ’åºã€å¿«é€Ÿæ’åºç­‰æ˜¯ä¸ç¨³å®šçš„ã€‚ä¸ç¨³å®šæ’åºçš„ä¸»è¦ç¼ºç‚¹æ˜¯ï¼Œå¤šé‡æ’åºæ—¶å¯èƒ½ä¼šäº§ç”Ÿé—®é¢˜ã€‚å‡è®¾æœ‰ä¸€ä¸ªå§“å’Œåçš„åˆ—è¡¨ï¼Œè¦æ±‚æŒ‰ç…§â€œå§“æ°ä¸ºä¸»è¦å…³é”®å­—ï¼Œåå­—ä¸ºæ¬¡è¦å…³é”®å­—â€è¿›è¡Œæ’åºã€‚å¼€å‘è€…å¯èƒ½ä¼šå…ˆæŒ‰åå­—æ’åºï¼Œå†æŒ‰å§“æ°è¿›è¡Œæ’åºã€‚å¦‚æœæ’åºç®—æ³•æ˜¯ç¨³å®šçš„ï¼Œè¿™æ ·å°±å¯ä»¥è¾¾åˆ°â€œå…ˆå§“æ°ï¼Œååå­—â€çš„æ’åºæ•ˆæœã€‚å¦‚æœæ˜¯ä¸ç¨³å®šçš„ï¼Œå°±ä¸è¡Œã€‚\næ—©å…ˆçš„ ECMAScript æ²¡æœ‰è§„å®šï¼ŒArray.prototype.sort()çš„é»˜è®¤æ’åºç®—æ³•æ˜¯å¦ç¨³å®šï¼Œç•™ç»™æµè§ˆå™¨è‡ªå·±å†³å®šï¼Œè¿™å¯¼è‡´æŸäº›å®ç°æ˜¯ä¸ç¨³å®šçš„ã€‚ES2019 æ˜ç¡®è§„å®šï¼ŒArray.prototype.sort()çš„é»˜è®¤æ’åºç®—æ³•å¿…é¡»ç¨³å®šã€‚è¿™ä¸ªè§„å®šå·²ç»åšåˆ°äº†ï¼Œç°åœ¨ JavaScript å„ä¸ªä¸»è¦å®ç°çš„é»˜è®¤æ’åºç®—æ³•éƒ½æ˜¯ç¨³å®šçš„ã€‚\nå¯¹è±¡ :link: Href ç‚¹æ­¤æŸ¥çœ‹ [ES5](05 JavaScript/#object-es5) ç‰ˆæœ¬çš„å¯¹è±¡\nå¯æšä¸¾æ€§ å¯¹è±¡çš„æ¯ä¸ªå±æ€§éƒ½æœ‰ä¸€ä¸ªæè¿°å¯¹è±¡ï¼ˆDescriptorï¼‰ï¼Œç”¨æ¥æ§åˆ¶è¯¥å±æ€§çš„è¡Œä¸ºã€‚Object.getOwnPropertyDescriptoræ–¹æ³•å¯ä»¥è·å–è¯¥å±æ€§çš„æè¿°å¯¹è±¡ã€‚\nlet obj = { foo: 123 }; Object.getOwnPropertyDescriptor(obj, \u0026#39;foo\u0026#39;) // { // value: 123, // writable: true, // enumerable: true, // configurable: true // } æè¿°å¯¹è±¡çš„ enumerable å±æ€§ï¼Œç§°ä¸ºâ€œå¯æšä¸¾æ€§â€ï¼Œå¦‚æœè¯¥å±æ€§ä¸ºfalseï¼Œå°±è¡¨ç¤ºæŸäº›æ“ä½œä¼šå¿½ç•¥å½“å‰å±æ€§ã€‚\nç›®å‰ï¼Œæœ‰å››ä¸ªæ“ä½œä¼šå¿½ç•¥enumerableä¸ºfalseçš„å±æ€§ã€‚\nfor...inå¾ªç¯ï¼šåªéå†å¯¹è±¡è‡ªèº«çš„å’Œç»§æ‰¿çš„å¯æšä¸¾çš„å±æ€§ã€‚ Object.keys()ï¼šè¿”å›å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å¯æšä¸¾çš„å±æ€§çš„é”®åã€‚ JSON.stringify()ï¼šåªä¸²è¡ŒåŒ–å¯¹è±¡è‡ªèº«çš„å¯æšä¸¾çš„å±æ€§ã€‚ Object.assign()ï¼š å¿½ç•¥enumerableä¸ºfalseçš„å±æ€§ï¼Œåªæ‹·è´å¯¹è±¡è‡ªèº«çš„å¯æšä¸¾çš„å±æ€§ã€‚ è¿™å››ä¸ªæ“ä½œä¹‹ä¸­ï¼Œå‰ä¸‰ä¸ªæ˜¯ ES5 å°±æœ‰çš„ï¼Œæœ€åä¸€ä¸ªObject.assign()æ˜¯ ES6 æ–°å¢çš„ã€‚å…¶ä¸­ï¼Œåªæœ‰for...inä¼šè¿”å›ç»§æ‰¿çš„å±æ€§ï¼Œå…¶ä»–ä¸‰ä¸ªæ–¹æ³•éƒ½ä¼šå¿½ç•¥ç»§æ‰¿çš„å±æ€§ï¼Œåªå¤„ç†å¯¹è±¡è‡ªèº«çš„å±æ€§ã€‚å®é™…ä¸Šï¼Œå¼•å…¥â€œå¯æšä¸¾â€ï¼ˆenumerableï¼‰è¿™ä¸ªæ¦‚å¿µçš„æœ€åˆç›®çš„ï¼Œå°±æ˜¯è®©æŸäº›å±æ€§å¯ä»¥è§„é¿æ‰for...inæ“ä½œï¼Œä¸ç„¶æ‰€æœ‰å†…éƒ¨å±æ€§å’Œæ–¹æ³•éƒ½ä¼šè¢«éå†åˆ°ã€‚æ¯”å¦‚ï¼Œå¯¹è±¡åŸå‹çš„toStringæ–¹æ³•ï¼Œä»¥åŠæ•°ç»„çš„lengthå±æ€§ï¼Œå°±é€šè¿‡â€œå¯æšä¸¾æ€§â€ï¼Œä»è€Œé¿å…è¢«for...inéå†åˆ°ã€‚\nObject.getOwnPropertyDescriptor(Object.prototype, \u0026#39;toString\u0026#39;).enumerable // false Object.getOwnPropertyDescriptor([], \u0026#39;length\u0026#39;).enumerable // false ä¸Šé¢ä»£ç ä¸­ï¼ŒtoString å’Œ length å±æ€§çš„ enumerable éƒ½æ˜¯ falseï¼Œå› æ­¤ for...in ä¸ä¼šéå†åˆ°è¿™ä¸¤ä¸ªç»§æ‰¿è‡ªåŸå‹çš„å±æ€§ã€‚\nå¦å¤–ï¼ŒES6 è§„å®šï¼Œæ‰€æœ‰ Class çš„åŸå‹çš„æ–¹æ³•éƒ½æ˜¯ä¸å¯æšä¸¾çš„ã€‚\nObject.getOwnPropertyDescriptor(class {foo() {}}.prototype, \u0026#39;foo\u0026#39;).enumerable // false æ€»çš„æ¥è¯´ï¼Œæ“ä½œä¸­å¼•å…¥ç»§æ‰¿çš„å±æ€§ä¼šè®©é—®é¢˜å¤æ‚åŒ–ï¼Œå¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬åªå…³å¿ƒå¯¹è±¡è‡ªèº«çš„å±æ€§ã€‚æ‰€ä»¥ï¼Œå°½é‡ä¸è¦ç”¨ for...in å¾ªç¯ï¼Œè€Œç”¨ Object.keys() ä»£æ›¿ã€‚\néå† ES6 ä¸€å…±æœ‰ 5 ç§æ–¹æ³•å¯ä»¥éå†å¯¹è±¡çš„å±æ€§ã€‚\nfor-in\nfor...in å¾ªç¯éå†å¯¹è±¡è‡ªèº«çš„å’Œç»§æ‰¿çš„å¯æšä¸¾å±æ€§ï¼ˆä¸å« Symbol å±æ€§ï¼‰ã€‚\nObject.keys(obj)\nObject.keysè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…æ‹¬å¯¹è±¡è‡ªèº«çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰å¯æšä¸¾å±æ€§ï¼ˆä¸å« Symbol å±æ€§ï¼‰çš„é”®åã€‚\nObject.getOwnPropertyNames(obj)\nObject.getOwnPropertyNamesè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å±æ€§ï¼ˆä¸å« Symbol å±æ€§ï¼Œä½†æ˜¯åŒ…æ‹¬ä¸å¯æšä¸¾å±æ€§ï¼‰çš„é”®åã€‚\nObject.getOwnPropertySymbols(obj)\nObject.getOwnPropertySymbolsè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰ Symbol å±æ€§çš„é”®åã€‚\nReflect.ownKeys(obj)\nReflect.ownKeysè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¯¹è±¡è‡ªèº«çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰é”®åï¼Œä¸ç®¡é”®åæ˜¯ Symbol æˆ–å­—ç¬¦ä¸²ï¼Œä¹Ÿä¸ç®¡æ˜¯å¦å¯æšä¸¾ã€‚\nä»¥ä¸Šçš„ 5 ç§æ–¹æ³•éå†å¯¹è±¡çš„é”®åï¼Œéƒ½éµå®ˆåŒæ ·çš„å±æ€§éå†çš„æ¬¡åºè§„åˆ™ï¼š\né¦–å…ˆéå†æ‰€æœ‰æ•°å€¼é”®ï¼ŒæŒ‰ç…§æ•°å€¼å‡åºæ’åˆ— å…¶æ¬¡éå†æ‰€æœ‰å­—ç¬¦ä¸²é”®ï¼ŒæŒ‰ç…§åŠ å…¥æ—¶é—´å‡åºæ’åˆ— æœ€åéå†æ‰€æœ‰ Symbol é”®ï¼ŒæŒ‰ç…§åŠ å…¥æ—¶é—´å‡åºæ’åˆ— Reflect.ownKeys({ [Symbol()]:0, b:0, 10:0, 2:0, a:0 }) // [\u0026#39;2\u0026#39;, \u0026#39;10\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;a\u0026#39;, Symbol()] ä¸Šé¢ä»£ç ä¸­ï¼ŒReflect.ownKeysæ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†å‚æ•°å¯¹è±¡çš„æ‰€æœ‰å±æ€§ã€‚è¿™ä¸ªæ•°ç»„çš„å±æ€§æ¬¡åºæ˜¯è¿™æ ·çš„ï¼Œé¦–å…ˆæ˜¯æ•°å€¼å±æ€§2å’Œ10ï¼Œå…¶æ¬¡æ˜¯å­—ç¬¦ä¸²å±æ€§bå’Œaï¼Œæœ€åæ˜¯ Symbol å±æ€§ã€‚\nsuper [ES5](05 JavaScript#this-es5) this å…³é”®å­—æ€»æ˜¯æŒ‡å‘å‡½æ•°æ‰€åœ¨çš„ å½“å‰å¯¹è±¡ ï¼ŒES6 åˆæ–°å¢äº†å¦ä¸€ä¸ªç±»ä¼¼çš„å…³é”®å­— super ï¼ŒæŒ‡å‘å½“å‰å¯¹è±¡çš„ åŸå‹å¯¹è±¡ ã€‚\n:link: Href [ES5](05 JavaScript#this-es5) this å…³é”®å­—çš„éƒ¨åˆ†è¡¥å……\nconst proto = { foo: \u0026#39;hello\u0026#39; }; const obj = { foo: \u0026#39;world\u0026#39;, find() { return super.foo; } }; Object.setPrototypeOf(obj, proto); obj.find() // \u0026#34;hello\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼Œå¯¹è±¡obj.find()æ–¹æ³•ä¹‹ä¸­ï¼Œé€šè¿‡super.fooå¼•ç”¨äº†åŸå‹å¯¹è±¡protoçš„fooå±æ€§ã€‚\næ³¨æ„ï¼Œsuperå…³é”®å­—è¡¨ç¤ºåŸå‹å¯¹è±¡æ—¶ï¼Œåªèƒ½ç”¨åœ¨å¯¹è±¡çš„æ–¹æ³•ä¹‹ä¸­ï¼Œç”¨åœ¨å…¶ä»–åœ°æ–¹éƒ½ä¼šæŠ¥é”™ã€‚\n// æŠ¥é”™ const obj = { foo: super.foo } // æŠ¥é”™ const obj = { foo: () =\u0026gt; super.foo } // æŠ¥é”™ const obj = { foo: function () { return super.foo } } ä¸Šé¢ä¸‰ç§superçš„ç”¨æ³•éƒ½ä¼šæŠ¥é”™ï¼Œå› ä¸ºå¯¹äº JavaScript å¼•æ“æ¥è¯´ï¼Œè¿™é‡Œçš„superéƒ½æ²¡æœ‰ç”¨åœ¨å¯¹è±¡çš„æ–¹æ³•ä¹‹ä¸­ã€‚ç¬¬ä¸€ç§å†™æ³•æ˜¯superç”¨åœ¨å±æ€§é‡Œé¢ï¼Œç¬¬äºŒç§å’Œç¬¬ä¸‰ç§å†™æ³•æ˜¯superç”¨åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œç„¶åèµ‹å€¼ç»™fooå±æ€§ã€‚ç›®å‰ï¼Œåªæœ‰å¯¹è±¡æ–¹æ³•çš„ç®€å†™æ³•å¯ä»¥è®© JavaScript å¼•æ“ç¡®è®¤ï¼Œå®šä¹‰çš„æ˜¯å¯¹è±¡çš„æ–¹æ³•ã€‚\nJavaScript å¼•æ“å†…éƒ¨ï¼Œsuper.fooç­‰åŒäºObject.getPrototypeOf(this).fooï¼ˆå±æ€§ï¼‰æˆ–Object.getPrototypeOf(this).foo.call(this)ï¼ˆæ–¹æ³•ï¼‰ã€‚\nconst proto = { x: \u0026#39;hello\u0026#39;, foo() { console.log(this.x); }, }; const obj = { x: \u0026#39;world\u0026#39;, foo() { super.foo(); } } Object.setPrototypeOf(obj, proto); obj.foo() // \u0026#34;world\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼Œsuper.fooæŒ‡å‘åŸå‹å¯¹è±¡protoçš„fooæ–¹æ³•ï¼Œä½†æ˜¯ç»‘å®šçš„thiså´è¿˜æ˜¯å½“å‰å¯¹è±¡objï¼Œå› æ­¤è¾“å‡ºçš„å°±æ˜¯worldã€‚\nè¿ç®—ç¬¦ æ‰©å±• ES6 ä¸ºæ•°ç»„æ·»åŠ äº† æ•°ç»„æ‰©å±•è¿ç®—ç¬¦\u0026hellip;theArgs ï¼Œè€Œ ES2018 å°†è¿™ä¸ªè¿ç®—ç¬¦å¼•å…¥äº†å¯¹è±¡ã€‚\nå¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦... ç”¨äºå–å‡ºå‚æ•°å¯¹è±¡çš„æ‰€æœ‰ å¯éå†å±æ€§ ï¼Œæ‹·è´åˆ°å½“å‰å¯¹è±¡ä¹‹ä¸­ã€‚\nlet z = { a: 3, b: 4 }; let n = { ...z }; n // { a: 3, b: 4 } ç”±äºæ•°ç»„æ˜¯ç‰¹æ®Šçš„å¯¹è±¡ï¼Œæ‰€ä»¥å¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦ä¹Ÿå¯ä»¥ç”¨äºæ•°ç»„ã€‚\nlet foo = { ...[\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;] }; console.log(foo); // {0: \u0026#39;a\u0026#39;, 1: \u0026#39;b\u0026#39;, 2: \u0026#39;c\u0026#39;} å¦‚æœæ‰©å±•è¿ç®—ç¬¦åé¢æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œåˆ™ä¼šè¢«è‡ªåŠ¨å¿½ç•¥ã€‚\n{...{}, a: 1} // {a: 1} å¦‚æœæ‰©å±•è¿ç®—ç¬¦åé¢ä¸æ˜¯å¯¹è±¡ï¼Œåˆ™ä¼šè‡ªåŠ¨å°†å…¶ è½¬ä¸ºå¯¹è±¡ ã€‚\n// ç­‰åŒäº {...Object(1)} {...1} // {} ä¸Šé¢ä»£ç ä¸­ï¼Œæ‰©å±•è¿ç®—ç¬¦åé¢æ˜¯æ•´æ•°1ï¼Œä¼šè‡ªåŠ¨è½¬ä¸ºæ•°å€¼çš„åŒ…è£…å¯¹è±¡Number{1}ã€‚ç”±äºè¯¥å¯¹è±¡æ²¡æœ‰è‡ªèº«å±æ€§ï¼Œæ‰€ä»¥è¿”å›ä¸€ä¸ªç©ºå¯¹è±¡ã€‚\nğŸ“ƒ Example ä¸‹é¢çš„ä¾‹å­éƒ½æ˜¯ç±»ä¼¼çš„é“ç†ã€‚\n// ç­‰åŒäº {...Object(true)} {...true} // {} // ç­‰åŒäº {...Object(undefined)} {...undefined} // {} // ç­‰åŒäº {...Object(null)} {...null} // {} ä½†æ˜¯ï¼Œå¦‚æœæ‰©å±•è¿ç®—ç¬¦åé¢æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒä¼šè‡ªåŠ¨è½¬æˆä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œå› æ­¤è¿”å›çš„ä¸æ˜¯ç©ºå¯¹è±¡ã€‚\n// ç­‰åŒäº {...String(\u0026#34;foo\u0026#34;)} {...\u0026#39;foo\u0026#39;} // {0: \u0026#39;f\u0026#39;, 1: \u0026#39;o\u0026#39;, 2: \u0026#39;o\u0026#39;} å¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦ç­‰åŒäºä½¿ç”¨ Object.assign() æ–¹æ³•ã€‚\nlet aClone = { ...a }; // ç­‰åŒäº let aClone = Object.assign({}, a); ä¸Šé¢çš„ä¾‹å­åªæ˜¯æ‹·è´äº†å¯¹è±¡å®ä¾‹çš„å±æ€§ï¼Œå¦‚æœæƒ³å®Œæ•´å…‹éš†ä¸€ä¸ªå¯¹è±¡ï¼Œè¿˜æ‹·è´å¯¹è±¡åŸå‹çš„å±æ€§ï¼Œå¯ä»¥é‡‡ç”¨ä¸‹é¢çš„å†™æ³•ã€‚\n// å†™æ³•ä¸€ const clone1 = { __proto__: Object.getPrototypeOf(obj), ...obj }; // å†™æ³•äºŒ const clone2 = Object.assign( Object.create(Object.getPrototypeOf(obj)), obj ); // å†™æ³•ä¸‰ const clone3 = Object.create( Object.getPrototypeOf(obj), Object.getOwnPropertyDescriptors(obj) ) ä¸Šé¢ä»£ç ä¸­ï¼Œå†™æ³•ä¸€çš„__proto__å±æ€§åœ¨éæµè§ˆå™¨çš„ç¯å¢ƒä¸ä¸€å®šéƒ¨ç½²ï¼Œå› æ­¤æ¨èä½¿ç”¨å†™æ³•äºŒå’Œå†™æ³•ä¸‰ã€‚\næ‰©å±•è¿ç®—ç¬¦å¯ä»¥ç”¨äºåˆå¹¶ä¸¤ä¸ªå¯¹è±¡ã€‚\nlet ab = { ...a, ...b }; // ç­‰åŒäº let ab = Object.assign({}, a, b); å¦‚æœç”¨æˆ·è‡ªå®šä¹‰çš„å±æ€§ï¼Œæ”¾åœ¨æ‰©å±•è¿ç®—ç¬¦åé¢ï¼Œåˆ™æ‰©å±•è¿ç®—ç¬¦å†…éƒ¨çš„åŒåå±æ€§ä¼šè¢«è¦†ç›–æ‰ã€‚\nlet aWithOverrides = { ...a, x: 1, y: 2 }; // ç­‰åŒäº let aWithOverrides = { ...a, ...{ x: 1, y: 2 } }; // ç­‰åŒäº let x = 1, y = 2, aWithOverrides = { ...a, x, y }; // ç­‰åŒäº let aWithOverrides = Object.assign({}, a, { x: 1, y: 2 }); ä¸Šé¢ä»£ç ä¸­ï¼Œaå¯¹è±¡çš„xå±æ€§å’Œyå±æ€§ï¼Œæ‹·è´åˆ°æ–°å¯¹è±¡åä¼šè¢«è¦†ç›–æ‰ã€‚\nè¿™ç”¨æ¥ä¿®æ”¹ç°æœ‰å¯¹è±¡éƒ¨åˆ†çš„å±æ€§å°±å¾ˆæ–¹ä¾¿äº†ã€‚\nlet newVersion = { ...previousVersion, name: \u0026#39;New Name\u0026#39; // Override the name property }; ä¸Šé¢ä»£ç ä¸­ï¼ŒnewVersionå¯¹è±¡è‡ªå®šä¹‰äº†nameå±æ€§ï¼Œå…¶ä»–å±æ€§å…¨éƒ¨å¤åˆ¶è‡ªpreviousVersionå¯¹è±¡ã€‚\nå¦‚æœæŠŠè‡ªå®šä¹‰å±æ€§æ”¾åœ¨æ‰©å±•è¿ç®—ç¬¦å‰é¢ï¼Œå°±å˜æˆäº†è®¾ç½®æ–°å¯¹è±¡çš„é»˜è®¤å±æ€§å€¼ã€‚\nlet aWithDefaults = { x: 1, y: 2, ...a }; // ç­‰åŒäº let aWithDefaults = Object.assign({}, { x: 1, y: 2 }, a); // ç­‰åŒäº let aWithDefaults = Object.assign({ x: 1, y: 2 }, a); ä¸æ•°ç»„çš„æ‰©å±•è¿ç®—ç¬¦ä¸€æ ·ï¼Œå¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦åé¢å¯ä»¥è·Ÿè¡¨è¾¾å¼ã€‚\nconst obj = { ...(x \u0026gt; 1 ? {a: 1} : {}), b: 2, }; æ‰©å±•è¿ç®—ç¬¦çš„å‚æ•°å¯¹è±¡ä¹‹ä¸­ï¼Œå¦‚æœæœ‰å–å€¼å‡½æ•°getï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ä¼šæ‰§è¡Œçš„ã€‚\nlet a = { get x() { throw new Error(\u0026#39;not throw yet\u0026#39;); } } let aWithXGetter = { ...a }; // æŠ¥é”™ ä¸Šé¢ä¾‹å­ä¸­ï¼Œå–å€¼å‡½æ•°getåœ¨æ‰©å±•aå¯¹è±¡æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œå¯¼è‡´æŠ¥é”™ã€‚\né“¾åˆ¤æ–­ ç¼–ç¨‹å®åŠ¡ä¸­ï¼Œå¦‚æœè¯»å–å¯¹è±¡å†…éƒ¨çš„æŸä¸ªå±æ€§ï¼Œå¾€å¾€éœ€è¦åˆ¤æ–­ä¸€ä¸‹è¯¥å¯¹è±¡æ˜¯å¦å­˜åœ¨ã€‚æ¯”å¦‚ï¼Œè¦è¯»å–message.body.user.firstNameï¼Œå®‰å…¨çš„å†™æ³•æ˜¯å†™æˆä¸‹é¢è¿™æ ·ã€‚\n// é”™è¯¯çš„å†™æ³• const firstName = message.body.user.firstName; // æ­£ç¡®çš„å†™æ³• const firstName = (message \u0026amp;\u0026amp; message.body \u0026amp;\u0026amp; message.body.user \u0026amp;\u0026amp; message.body.user.firstName) || \u0026#39;default\u0026#39;; ä¸Šé¢ä¾‹å­ä¸­ï¼ŒfirstName å±æ€§åœ¨å¯¹è±¡çš„ç¬¬å››å±‚ï¼Œæ‰€ä»¥éœ€è¦åˆ¤æ–­å››æ¬¡ï¼Œæ¯ä¸€å±‚æ˜¯å¦æœ‰å€¼ã€‚\nä¸‰å…ƒè¿ç®—ç¬¦ ?: ä¹Ÿå¸¸ç”¨äºåˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜åœ¨ã€‚\nğŸ“ƒ Example\nconst fooInput = myForm.querySelector(\u0026#39;input[name=foo]\u0026#39;) const fooValue = fooInput ? fooInput.value : undefined ä¸Šé¢ä¾‹å­ä¸­ï¼Œå¿…é¡»å…ˆåˆ¤æ–­ fooInput æ˜¯å¦å­˜åœ¨ï¼Œæ‰èƒ½è¯»å–fooInput.valueã€‚\nè¿™æ ·çš„å±‚å±‚åˆ¤æ–­éå¸¸éº»çƒ¦ï¼Œå› æ­¤ ES2020 å¼•å…¥äº† é“¾åˆ¤æ–­è¿ç®—ç¬¦optional chaining operator ?.ï¼Œç®€åŒ–ä¸Šé¢çš„å†™æ³•ã€‚\nconst firstName = message?.body?.user?.firstName || \u0026#39;default\u0026#39;; const fooValue = myForm.querySelector(\u0026#39;input[name=foo]\u0026#39;)?.value ä¸Šé¢ä»£ç ä½¿ç”¨äº†?.è¿ç®—ç¬¦ï¼Œç›´æ¥åœ¨é“¾å¼è°ƒç”¨çš„æ—¶å€™åˆ¤æ–­ï¼Œå·¦ä¾§çš„å¯¹è±¡æ˜¯å¦ä¸ºnullæˆ–undefinedã€‚å¦‚æœæ˜¯çš„ï¼Œå°±ä¸å†å¾€ä¸‹è¿ç®—ï¼Œè€Œæ˜¯è¿”å›undefinedã€‚\nğŸ“ƒ Example\nä¸‹é¢æ˜¯åˆ¤æ–­å¯¹è±¡æ–¹æ³•æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨å°±ç«‹å³æ‰§è¡Œçš„ä¾‹å­ã€‚\niterator.return?.(/*ä¼ å…¥å‚æ•°*/); ä¸Šé¢ä»£ç ä¸­ï¼Œiterator.return å¦‚æœæœ‰å®šä¹‰ï¼Œå°±ä¼šè°ƒç”¨è¯¥æ–¹æ³•ï¼Œå¦åˆ™ iterator.return ç›´æ¥è¿”å› undefined ï¼Œä¸å†æ‰§è¡Œ ?. åé¢çš„éƒ¨åˆ†ã€‚\nå¯¹äºé‚£äº›å¯èƒ½æ²¡æœ‰å®ç°çš„æ–¹æ³•ï¼Œè¿™ä¸ªè¿ç®—ç¬¦å°¤å…¶æœ‰ç”¨ã€‚\nif (myForm.checkValidity?.() === false) { // è¡¨å•æ ¡éªŒå¤±è´¥ return; } ä¸Šé¢ä»£ç ä¸­ï¼Œè€å¼æµè§ˆå™¨çš„è¡¨å•å¯èƒ½æ²¡æœ‰ checkValidity è¿™ä¸ªæ–¹æ³•ï¼Œè¿™æ—¶ ?. è¿ç®—ç¬¦å°±ä¼šè¿”å›undefinedï¼Œåˆ¤æ–­è¯­å¥å°±å˜æˆäº† undefined === false ï¼Œæ‰€ä»¥å°±ä¼šè·³è¿‡ä¸‹é¢çš„ä»£ç ã€‚\né“¾åˆ¤æ–­è¿ç®—ç¬¦æœ‰ä¸‰ç§ç”¨æ³•ã€‚\nobj?.prop // å¯¹è±¡å±æ€§ obj?.[expr] // åŒä¸Š func?.(...args) // å‡½æ•°æˆ–å¯¹è±¡æ–¹æ³•çš„è°ƒç”¨ ä¸‹é¢æ˜¯obj?.[expr]ç”¨æ³•çš„ä¸€ä¸ªä¾‹å­ã€‚\nlet hex = \u0026#34;#C0FFEE\u0026#34;.match(/#([A-Z]+)/i)?.[1]; ä¸Šé¢ä¾‹å­ä¸­ï¼Œå­—ç¬¦ä¸²çš„ match() æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰å‘ç°åŒ¹é…ä¼šè¿”å› null ï¼Œå¦‚æœå‘ç°åŒ¹é…ä¼šè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œ?. è¿ç®—ç¬¦èµ·åˆ°äº†åˆ¤æ–­ä½œç”¨ã€‚\nä¸‹é¢æ˜¯ ?. è¿ç®—ç¬¦å¸¸è§å½¢å¼ï¼Œä»¥åŠä¸ä½¿ç”¨è¯¥è¿ç®—ç¬¦æ—¶çš„ç­‰ä»·å½¢å¼ã€‚\na?.b; // ç­‰åŒäº a == null ? undefined : a.b; a?.[x]; // ç­‰åŒäº a == null ? undefined : a[x]; a?.b(); // ç­‰åŒäº a == null ? undefined : a.b(); a?.(); // ç­‰åŒäº a == null ? undefined : a(); ä¸Šé¢ä»£ç ä¸­ï¼Œç‰¹åˆ«æ³¨æ„åä¸¤ç§å½¢å¼ï¼Œå¦‚æœa?.b()é‡Œé¢çš„a.bä¸æ˜¯å‡½æ•°ï¼Œä¸å¯è°ƒç”¨ï¼Œé‚£ä¹ˆa?.b()æ˜¯ä¼šæŠ¥é”™çš„ã€‚a?.()ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå¦‚æœaä¸æ˜¯nullæˆ–undefinedï¼Œä½†ä¹Ÿä¸æ˜¯å‡½æ•°ï¼Œé‚£ä¹ˆa?.()ä¼šæŠ¥é”™ã€‚\nğŸ§ª Experimental\nlet a = () =\u0026gt; { console.log(1) } a?.(); // 1 // è‹¥aå­˜åœ¨ï¼Œåˆ™æ‰§è¡Œa()ï¼Œå¦åˆ™è¿”å›undefined ä½¿ç”¨è¿™ä¸ªè¿ç®—ç¬¦ï¼Œæœ‰å‡ ä¸ªæ³¨æ„ç‚¹ã€‚\nçŸ­è·¯æœºåˆ¶ ?.è¿ç®—ç¬¦ç›¸å½“äºä¸€ç§çŸ­è·¯æœºåˆ¶ï¼Œåªè¦ä¸æ»¡è¶³æ¡ä»¶ï¼Œå°±ä¸å†å¾€ä¸‹æ‰§è¡Œã€‚\na?.[++x] // ç­‰åŒäº a == null ? undefined : a[++x] ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœ a æ˜¯ undefined æˆ– null ï¼Œé‚£ä¹ˆxä¸ä¼šè¿›è¡Œé€’å¢è¿ç®—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé“¾åˆ¤æ–­è¿ç®—ç¬¦ä¸€æ—¦ä¸ºçœŸï¼Œå³ä¾§çš„è¡¨è¾¾å¼å°±ä¸å†æ±‚å€¼ã€‚\ndelete è¿ç®—ç¬¦\n:link: Href [Object.delete](05 JavaScript#delete-es5)\ndelete a?.b // ç­‰åŒäº a == null ? undefined : delete a.b ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœaæ˜¯undefinedæˆ–nullï¼Œä¼šç›´æ¥è¿”å›undefinedï¼Œè€Œä¸ä¼šè¿›è¡Œdeleteè¿ç®—ã€‚\næ‹¬å·çš„å½±å“\nå¦‚æœå±æ€§é“¾æœ‰åœ†æ‹¬å·ï¼Œé“¾åˆ¤æ–­è¿ç®—ç¬¦å¯¹åœ†æ‹¬å·å¤–éƒ¨æ²¡æœ‰å½±å“ï¼Œåªå¯¹åœ†æ‹¬å·å†…éƒ¨æœ‰å½±å“ã€‚\n(a?.b).c // ç­‰ä»·äº (a == null ? undefined : a.b).c ä¸Šé¢ä»£ç ä¸­ï¼Œ?.å¯¹åœ†æ‹¬å·å¤–éƒ¨æ²¡æœ‰å½±å“ï¼Œä¸ç®¡aå¯¹è±¡æ˜¯å¦å­˜åœ¨ï¼Œåœ†æ‹¬å·åé¢çš„.cæ€»æ˜¯ä¼šæ‰§è¡Œã€‚\nä¸€èˆ¬æ¥è¯´ï¼Œä½¿ç”¨?.è¿ç®—ç¬¦çš„åœºåˆï¼Œä¸åº”è¯¥ä½¿ç”¨åœ†æ‹¬å·ã€‚\næŠ¥é”™åœºåˆ\nä»¥ä¸‹å†™æ³•æ˜¯ç¦æ­¢çš„ï¼Œä¼šæŠ¥é”™ã€‚\n// æ„é€ å‡½æ•° new a?.() new a?.b() // é“¾åˆ¤æ–­è¿ç®—ç¬¦çš„å³ä¾§æœ‰æ¨¡æ¿å­—ç¬¦ä¸² a?.`{b}` a?.b`{c}` // é“¾åˆ¤æ–­è¿ç®—ç¬¦çš„å·¦ä¾§æ˜¯ super super?.() super?.foo // é“¾è¿ç®—ç¬¦ç”¨äºèµ‹å€¼è¿ç®—ç¬¦å·¦ä¾§ a?.b = c å³ä¾§ä¸å¾—ä¸º åè¿›åˆ¶æ•°å€¼\nä¸ºäº†ä¿è¯å…¼å®¹ä»¥å‰çš„ä»£ç ï¼Œå…è®¸ foo?.3:0 è¢«è§£ææˆ foo ? .3 : 0 ï¼Œå› æ­¤è§„å®šå¦‚æœ ?. åé¢ç´§è·Ÿä¸€ä¸ªåè¿›åˆ¶æ•°å­—ï¼Œé‚£ä¹ˆ ?. ä¸å†è¢«çœ‹æˆæ˜¯ä¸€ä¸ªå®Œæ•´çš„è¿ç®—ç¬¦ï¼Œè€Œä¼šæŒ‰ç…§ä¸‰å…ƒè¿ç®—ç¬¦è¿›è¡Œå¤„ç†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé‚£ä¸ªå°æ•°ç‚¹ä¼šå½’å±äºåé¢çš„åè¿›åˆ¶æ•°å­—ï¼Œå½¢æˆä¸€ä¸ªå°æ•°ã€‚\nNull åˆ¤æ–­*^??^* è¯»å–å¯¹è±¡å±æ€§çš„æ—¶å€™ï¼Œå¦‚æœæŸä¸ªå±æ€§çš„å€¼æ˜¯ null æˆ– undefined ï¼Œæœ‰æ—¶å€™éœ€è¦ä¸ºå®ƒä»¬æŒ‡å®šé»˜è®¤å€¼ã€‚å¸¸è§åšæ³•æ˜¯é€šè¿‡ || è¿ç®—ç¬¦æŒ‡å®šé»˜è®¤å€¼ã€‚\nconst headerText = response.settings.headerText || \u0026#39;Hello, world!\u0026#39;; const animationDuration = response.settings.animationDuration || 300; const showSplashScreen = response.settings.showSplashScreen || true; ä¸Šé¢çš„ä¸‰è¡Œä»£ç éƒ½é€šè¿‡||è¿ç®—ç¬¦æŒ‡å®šé»˜è®¤å€¼ï¼Œä½†æ˜¯è¿™æ ·å†™æ˜¯é”™çš„ã€‚å¼€å‘è€…çš„åŸæ„æ˜¯ï¼Œåªè¦å±æ€§çš„å€¼ä¸ºnull æˆ– undefined ï¼Œé»˜è®¤å€¼å°±ä¼šç”Ÿæ•ˆï¼Œä½†æ˜¯å±æ€§çš„å€¼å¦‚æœä¸ºç©ºå­—ç¬¦ä¸²æˆ– false æˆ– 0 ï¼Œé»˜è®¤å€¼ä¹Ÿä¼šç”Ÿæ•ˆã€‚\nä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼ŒES2020 å¼•å…¥äº†ä¸€ä¸ªæ–°çš„ Null åˆ¤æ–­è¿ç®—ç¬¦ ?? ã€‚å®ƒçš„è¡Œä¸ºç±»ä¼¼ || ï¼Œä½†æ˜¯åªæœ‰è¿ç®—ç¬¦å·¦ä¾§çš„å€¼ä¸ºnull æˆ– undefined æ—¶ï¼Œæ‰ä¼šè¿”å›å³ä¾§çš„å€¼ã€‚\nconst headerText = response.settings.headerText ?? \u0026#39;Hello, world!\u0026#39;; const animationDuration = response.settings.animationDuration ?? 300; const showSplashScreen = response.settings.showSplashScreen ?? true; ä¸Šé¢ä»£ç ä¸­ï¼Œé»˜è®¤å€¼åªæœ‰åœ¨å·¦ä¾§å±æ€§å€¼ä¸º null æˆ– undefined æ—¶ï¼Œæ‰ä¼šç”Ÿæ•ˆã€‚\nè¿™ä¸ªè¿ç®—ç¬¦çš„ä¸€ä¸ªç›®çš„ï¼Œå°±æ˜¯è·Ÿé“¾åˆ¤æ–­è¿ç®—ç¬¦ ?. é…åˆä½¿ç”¨ï¼Œä¸º nullæˆ–undefinedçš„å€¼è®¾ç½®é»˜è®¤å€¼ã€‚\nconst animationDuration = response.settings?.animationDuration ?? 300; ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœresponse.settingsæ˜¯ null æˆ– undefined ï¼Œæˆ–è€…response.settings.animationDurationæ˜¯ null æˆ– undefined ï¼Œå°±ä¼šè¿”å›é»˜è®¤å€¼300ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸€è¡Œä»£ç åŒ…æ‹¬äº†ä¸¤çº§å±æ€§çš„åˆ¤æ–­ã€‚\nè¿™ä¸ªè¿ç®—ç¬¦å¾ˆé€‚åˆåˆ¤æ–­å‡½æ•°å‚æ•°æ˜¯å¦èµ‹å€¼ã€‚\nfunction Component(props) { const enable = props.enabled ?? true; // â€¦ } ä¸Šé¢ä»£ç åˆ¤æ–­propså‚æ•°çš„enabledå±æ€§æ˜¯å¦èµ‹å€¼ï¼ŒåŸºæœ¬ç­‰åŒäºä¸‹é¢çš„å†™æ³•ã€‚\nfunction Component(props) { const { enabled: enable = true, } = props; // â€¦ } ??æœ‰ä¸€ä¸ªè¿ç®—ä¼˜å…ˆçº§é—®é¢˜ï¼Œå®ƒä¸\u0026amp;\u0026amp;å’Œ||çš„ä¼˜å…ˆçº§å­°é«˜å­°ä½ã€‚ç°åœ¨çš„è§„åˆ™æ˜¯ï¼Œå¦‚æœå¤šä¸ªé€»è¾‘è¿ç®—ç¬¦ä¸€èµ·ä½¿ç”¨ï¼Œå¿…é¡»ç”¨æ‹¬å·è¡¨æ˜ä¼˜å…ˆçº§ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚\n// æŠ¥é”™ lhs \u0026amp;\u0026amp; middle ?? rhs lhs ?? middle \u0026amp;\u0026amp; rhs lhs || middle ?? rhs lhs ?? middle || rhs ä¸Šé¢å››ä¸ªè¡¨è¾¾å¼éƒ½ä¼šæŠ¥é”™ï¼Œå¿…é¡»åŠ å…¥è¡¨æ˜ä¼˜å…ˆçº§çš„æ‹¬å·ã€‚\n(lhs \u0026amp;\u0026amp; middle) ?? rhs; lhs \u0026amp;\u0026amp; (middle ?? rhs); (lhs ?? middle) \u0026amp;\u0026amp; rhs; lhs ?? (middle \u0026amp;\u0026amp; rhs); (lhs || middle) ?? rhs; lhs || (middle ?? rhs); (lhs ?? middle) || rhs; lhs ?? (middle || rhs); ğŸ“ƒ Example\nåœ¨å¤„ç†è¾“å…¥æ¡†ç›¸å…³ä¸šåŠ¡æ—¶ï¼Œå¾€å¾€ä¼šåˆ¤æ–­è¾“å…¥æ¡†æœªè¾“å…¥å€¼çš„åœºæ™¯ã€‚\nâ\nif (value !== null \u0026amp;\u0026amp; value !== undefined \u0026amp;\u0026amp; value !== \u0026#39;\u0026#39;) { //... } âœ…\nä½¿ç”¨ ç©ºå€¼åˆå¹¶è¿ç®—ç¬¦?? åˆ¤æ–­éç©ºçŠ¶æ€\nif ((value ?? \u0026#39;\u0026#39;) !== \u0026#39;\u0026#39;) { //... } æ–¹æ³• Object. is(), assign(), getOwnPropertyDescriptors(), __proto__, setPrototypeOf(), getPrototypeOf(), keys(), values(), entries(), fromEntries()\nis() [ES5](05 JavaScript#compare-es5) ä¸­ï¼Œæ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼Œåªæœ‰ä¸¤ä¸ªè¿ç®—ç¬¦ï¼šç›¸ç­‰è¿ç®—ç¬¦ == å’Œä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ === ã€‚å®ƒä»¬éƒ½æœ‰ç¼ºç‚¹ï¼Œå‰è€…ä¼šè‡ªåŠ¨è½¬æ¢æ•°æ®ç±»å‹ï¼Œåè€…çš„NaN ä¸ç­‰äºè‡ªèº«ï¼Œä»¥åŠ +0 ç­‰äº -0 ã€‚JavaScript ç¼ºä¹ä¸€ç§è¿ç®—ï¼Œåœ¨æ‰€æœ‰ç¯å¢ƒä¸­ï¼Œåªè¦ä¸¤ä¸ªå€¼æ˜¯ä¸€æ ·çš„ï¼Œå®ƒä»¬å°±åº”è¯¥ç›¸ç­‰ã€‚\nES6 æå‡ºâ€œSame-value equalityâ€ï¼ˆåŒå€¼ç›¸ç­‰ï¼‰ç®—æ³•ï¼Œç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚Object.is å°±æ˜¯éƒ¨ç½²è¿™ä¸ªç®—æ³•çš„æ–°æ–¹æ³•ã€‚å®ƒç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ä¸¥æ ¼ç›¸ç­‰ï¼Œä¸ä¸¥æ ¼æ¯”è¾ƒè¿ç®—ç¬¦ === çš„è¡Œä¸ºåŸºæœ¬ä¸€è‡´ã€‚\nObject.is(\u0026#39;foo\u0026#39;, \u0026#39;foo\u0026#39;) // true Object.is({}, {}) // false ä¸åŒä¹‹å¤„åªæœ‰ä¸¤ä¸ªï¼šä¸€æ˜¯ +0 ä¸ç­‰äº -0 ï¼ŒäºŒæ˜¯ NaN ç­‰äºè‡ªèº«ã€‚\n+0 === -0 //true NaN === NaN // false Object.is(+0, -0) // false Object.is(NaN, NaN) // true ES5 å¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œéƒ¨ç½² Object.isã€‚\nğŸ“ Note Object.is() ä¸åœ¨ åŸå‹é“¾prototype ä¸­\nObject.is = null; // å¼ºè¡Œæ¸…é™¤Object.is // Note: is()æ–¹æ³•ä¸åœ¨åŸå‹é“¾ä¸­ ( function () { console.log(Object.is); // null if (!Object.is) Object.defineProperty(Object, \u0026#39;is\u0026#39;, { value: function (x, y) { console.log(\u0026#39;customized is() called\u0026#39;) if (x === y) { // é’ˆå¯¹+0 ä¸ç­‰äº -0 çš„æƒ…å†µ return x !== 0 || 1 / x === 1 / y; } // é’ˆå¯¹NaNçš„æƒ…å†µ return x !== x \u0026amp;\u0026amp; y !== y; }, configurable: true, enumerable: false, writable: true }); })(); Object.is(1, 2); // customized is() called // false assign() åŸºæœ¬ç”¨æ³• Object.assign() æ–¹æ³•ç”¨äºå¯¹è±¡çš„ åˆå¹¶ ï¼Œå°†æºå¯¹è±¡source çš„æ‰€æœ‰ å¯æšä¸¾iterable å±æ€§ï¼Œå¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡target ã€‚\n:link: Href [Array.concat()](05 JavaScript#array-concat) ç”¨äºæ•°ç»„çš„åˆå¹¶\nconst target = {a: 1}, source1 = {b: 2}, source2 = {c: 3}; console.log( Object.assign(target, source1, source2) ); // { a: 1, b: 2, c: 3 } Object.assign() æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ ç›®æ ‡å¯¹è±¡ ï¼Œåé¢çš„å‚æ•°éƒ½æ˜¯ æºå¯¹è±¡ ã€‚\nğŸ“ Note å¦‚æœç›®æ ‡å¯¹è±¡ä¸æºå¯¹è±¡æœ‰åŒåå±æ€§ï¼Œæˆ–å¤šä¸ªæºå¯¹è±¡æœ‰åŒåå±æ€§ï¼Œåˆ™åé¢çš„å±æ€§ä¼š è¦†ç›–overwrite å‰é¢çš„å±æ€§ã€‚\nconst target = {a: 1, b: 1}, source1 = {b: 2, c: 2}, source2 = {c: 3}; console.log( Object.assign(target, source1, source2) ); // { a: 1, b: 2, c: 3 } å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼ŒObject.assign() ä¼šç›´æ¥è¿”å›è¯¥å‚æ•°thisã€‚\nconst obj = {a: 1}; Object.assign(obj) === obj // true å¦‚æœè¯¥å‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œåˆ™ä¼šå…ˆè½¬æˆ å¯¹è±¡object ï¼Œç„¶åè¿”å›ã€‚\ne.g.: number ç±»å‹å°±è¢«è½¬æ¢ä¸º Number åŒ…è£¹ç±»\nconsole.log( Object.assign(2), // [Number: 2] typeof Object.assign(2) // \u0026#34;object\u0026#34; ); ç”±äº undefined å’Œ null æ— æ³•è½¬æˆå¯¹è±¡ï¼Œæ‰€ä»¥å¦‚æœå®ƒä»¬ä½œä¸ºå‚æ•°ï¼Œå°±ä¼šæŠ¥é”™ã€‚\nObject.assign(undefined) // æŠ¥é”™ Object.assign(null) // æŠ¥é”™ // Uncaught TypeError: Cannot convert undefined or null to object ğŸ“ Note å¦‚æœ éå¯¹è±¡å‚æ•° å‡ºç°åœ¨ æºå¯¹è±¡ çš„ä½ç½®ï¼ˆå³éé¦–å‚æ•°ï¼‰ï¼Œé‚£ä¹ˆå¤„ç†è§„åˆ™æœ‰æ‰€ä¸åŒã€‚é¦–å…ˆï¼Œè¿™äº›å‚æ•°éƒ½ä¼šè½¬æˆå¯¹è±¡ï¼Œå¦‚æœæ— æ³•è½¬æˆå¯¹è±¡ï¼Œå°±ä¼š è·³è¿‡ ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœ undefined å’Œ null ä¸åœ¨é¦–å‚æ•°ï¼Œå°±ä¸ä¼šæŠ¥é”™ã€‚\nlet obj = {a: 1}; Object.assign(obj, undefined) === obj // true Object.assign(obj, null) === obj // true å…¶ä»–ç±»å‹çš„å€¼ï¼ˆå³æ•°å€¼ã€å­—ç¬¦ä¸²å’Œå¸ƒå°”å€¼ï¼‰ä¸åœ¨é¦–å‚æ•°ï¼Œä¹Ÿä¸ä¼šæŠ¥é”™ã€‚ä½†æ˜¯ï¼Œé™¤äº† å­—ç¬¦ä¸² ä¼šä»¥ æ•°ç»„ å½¢å¼ï¼Œæ‹·è´å…¥ç›®æ ‡å¯¹è±¡ï¼Œå…¶ä»–å€¼éƒ½ä¸ä¼šäº§ç”Ÿæ•ˆæœã€‚\nğŸ“ƒ Example\nconst v1 = \u0026#39;abc\u0026#39;; const v2 = true; const v3 = 10; const obj = Object.assign({}, v1, v2, v3); console.log(obj); // { \u0026#34;0\u0026#34;: \u0026#34;a\u0026#34;, \u0026#34;1\u0026#34;: \u0026#34;b\u0026#34;, \u0026#34;2\u0026#34;: \u0026#34;c\u0026#34; } ä¸Šé¢ä»£ç ä¸­ï¼Œv1ã€v2ã€v3åˆ†åˆ«æ˜¯å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼å’Œæ•°å€¼ï¼Œç»“æœåªæœ‰å­—ç¬¦ä¸²åˆå…¥ç›®æ ‡å¯¹è±¡ï¼ˆä»¥å­—ç¬¦æ•°ç»„çš„å½¢å¼ï¼‰ï¼Œæ•°å€¼å’Œå¸ƒå°”å€¼éƒ½ä¼šè¢«å¿½ç•¥ã€‚\nğŸ“ Note åªæœ‰å­—ç¬¦ä¸²çš„ [åŒ…è£…å¯¹è±¡ ](05 JavaScript#trick-primitive-wrapper-type) ï¼Œä¼šäº§ç”Ÿ å¯æšä¸¾å±æ€§ ã€‚\nğŸ“ƒ Example\nconsole.log( // [[PrimitiveValue]] Object(true), // {Boolean: true} Object(10), // {Number: 10} Object(\u0026#39;abc\u0026#39;) // {String: \u0026#39;abc\u0026#39;} ); ä¸Šé¢ä»£ç ä¸­ï¼Œå¸ƒå°”å€¼ã€æ•°å€¼ã€å­—ç¬¦ä¸²åˆ†åˆ«è½¬æˆå¯¹åº”çš„åŒ…è£…å¯¹è±¡ï¼Œå¯ä»¥çœ‹åˆ°å®ƒä»¬çš„åŸå§‹å€¼éƒ½åœ¨åŒ…è£…å¯¹è±¡çš„å†…éƒ¨å±æ€§ [[PrimitiveValue]] ä¸Šé¢ï¼Œè¿™ä¸ªå±æ€§æ˜¯ä¸ä¼šè¢« Object.assign() æ‹·è´çš„ã€‚åªæœ‰å­—ç¬¦ä¸²çš„åŒ…è£…å¯¹è±¡ï¼Œä¼šäº§ç”Ÿå¯æšä¸¾çš„å®ä¹‰å±æ€§ï¼Œé‚£äº›å±æ€§åˆ™ä¼šè¢«æ‹·è´ã€‚\nObject.assign() æ‹·è´çš„å±æ€§æ˜¯æœ‰é™åˆ¶çš„ï¼Œåªæ‹·è´æºå¯¹è±¡çš„è‡ªèº«å±æ€§ï¼ˆä¸æ‹·è´ç»§æ‰¿å±æ€§ï¼‰ï¼Œä¹Ÿä¸æ‹·è´ ä¸å¯æšä¸¾enumerable: false çš„å±æ€§ã€‚\n:link: Href [Object.defineProperty()](05 JavaScript#object-defineProperty-es5)\nObject.assign({b: \u0026#39;c\u0026#39;}, Object.defineProperty({}, \u0026#39;invisible\u0026#39;, { enumerable: false, value: \u0026#39;hello\u0026#39; }) ) // {b: \u0026#39;c\u0026#39;} ä¸Šé¢ä»£ç ä¸­ï¼ŒObject.assign() è¦æ‹·è´çš„å¯¹è±¡åªæœ‰ä¸€ä¸ªä¸å¯æšä¸¾å±æ€§ invisibleenumerable: false ï¼Œè¿™ä¸ªå±æ€§å¹¶æ²¡æœ‰è¢«æ‹·è´è¿›å»ã€‚\nSymbol ç±»å‹ä¹Ÿèƒ½è¢« Object.assign() æ‹·è´ã€‚\nObject.assign( {a: \u0026#39;b\u0026#39;}, {[Symbol(\u0026#39;c\u0026#39;)]: \u0026#39;d\u0026#39;} ); // { a: \u0026#39;b\u0026#39;, Symbol(c): \u0026#39;d\u0026#39; } æ³¨æ„ç‚¹ :link: Href Object çš„æ·±æ‹·è´å’Œæµ…æ‹·è´\næµ…æ‹·è´ Object.assign() æ–¹æ³•å®è¡Œçš„æ˜¯ æµ…æ‹·è´ ï¼Œè€Œä¸æ˜¯ æ·±æ‹·è´ ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæºå¯¹è±¡æŸä¸ªå±æ€§çš„å€¼æ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆç›®æ ‡å¯¹è±¡æ‹·è´å¾—åˆ°çš„æ˜¯è¿™ä¸ªå¯¹è±¡çš„ å¼•ç”¨pointer ã€‚\nğŸ“ƒ Example\nconst obj1 = {a: {b: 1}}; const obj2 = Object.assign({}, obj1); obj1.a.b = 2; obj2.a.b // 2 ä¸Šé¢ä»£ç ä¸­ï¼Œæºå¯¹è±¡ obj1 çš„ a å±æ€§çš„å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒObject.assign() æ‹·è´å¾—åˆ°çš„æ˜¯è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚è¿™ä¸ªå¯¹è±¡çš„ä»»ä½•å˜åŒ–ï¼Œéƒ½ä¼šåæ˜ åˆ°ç›®æ ‡å¯¹è±¡ä¸Šé¢ã€‚\nåŒåæ›¿æ¢ å¯¹äºè¿™ç§åµŒå¥—çš„å¯¹è±¡ï¼Œä¸€æ—¦é‡åˆ°åŒåå±æ€§ï¼ŒObject.assign() çš„å¤„ç†æ–¹æ³•æ˜¯ æ›¿æ¢ ï¼Œè€Œä¸æ˜¯ æ·»åŠ  ã€‚\nconst target = { a: { b: \u0026#39;c\u0026#39;, d: \u0026#39;e\u0026#39; } } const source = { a: { b: \u0026#39;hello\u0026#39; } } Object.assign(target, source) // { a: { b: \u0026#39;hello\u0026#39; } } ä¸Šé¢ä»£ç ä¸­ï¼Œtarget å¯¹è±¡çš„ a å±æ€§è¢« source å¯¹è±¡çš„ a å±æ€§æ•´ä¸ªæ›¿æ¢æ‰äº†ï¼Œè€Œä¸ä¼šå¾—åˆ° {a: {b: 'hello', d: 'e'}} çš„ç»“æœã€‚è¿™é€šå¸¸ä¸æ˜¯å¼€å‘è€…æƒ³è¦çš„ï¼Œéœ€è¦ç‰¹åˆ«å°å¿ƒã€‚\nğŸ“ Note ä¸€äº›å‡½æ•°åº“æä¾› Object.assign() çš„å®šåˆ¶ç‰ˆæœ¬ï¼ˆæ¯”å¦‚ Lodash çš„_.defaultsDeep() æ–¹æ³•ï¼‰ï¼Œå¯ä»¥å¾—åˆ°æ·±æ‹·è´çš„åˆå¹¶ã€‚\næ•°ç»„ä¸ºå¯¹è±¡ Object.assign() å¯ä»¥ç”¨æ¥å¤„ç† æ•°ç»„ ï¼Œä½†æ˜¯ä¼šæŠŠæ•°ç»„è§†ä¸º å¯¹è±¡ ã€‚\nlet obj1 = Object.assign([1, 2, 3], [4, 5]); // ç­‰åŒ let obj2 = Object.assign([1, 2, 3], {0: 4, 1: 5}); let same = true; for (const [key, value] of obj1.entries()) if (value !== obj2[key]) same = false; console.log(same); // true ä¸Šé¢ä»£ç ä¸­ï¼ŒObject.assign() æŠŠæ•°ç»„è§†ä¸ºå±æ€§åä¸º 0ã€1ã€2 çš„å¯¹è±¡ï¼Œå› æ­¤æºæ•°ç»„çš„ 0 å·å±æ€§ 4 è¦†ç›–äº†ç›®æ ‡æ•°ç»„çš„ 0 å·å±æ€§ 1 ã€‚\nå–å€¼å‡½æ•° Object.assign() åªèƒ½è¿›è¡Œå€¼çš„ å¤åˆ¶ ï¼Œå¦‚æœè¦å¤åˆ¶çš„å€¼æ˜¯ä¸€ä¸ªå–å€¼å‡½æ•°ï¼Œé‚£ä¹ˆå°† æ±‚å€¼ åå†å¤åˆ¶ã€‚\nconst source = { get foo() { return \u0026#39;bar\u0026#39;; } }; const target = {foo2: \u0026#39;bar\u0026#39;}; console.log(Object.assign(target, source)); // { foo2: \u0026#39;bar\u0026#39;, foo: \u0026#39;bar\u0026#39; } ä¸Šé¢ä»£ç ä¸­ï¼Œsource å¯¹è±¡çš„ foo å±æ€§æ˜¯ä¸€ä¸ªå–å€¼å‡½æ•°ï¼ŒObject.assign() ä¸ä¼šå¤åˆ¶è¿™ä¸ªå–å€¼å‡½æ•°ï¼Œåªä¼šæ‹¿åˆ°å€¼ä»¥åï¼Œå°†è¿™ä¸ªå€¼å¤åˆ¶è¿‡å»ã€‚\nå¸¸è§ç”¨é€” æ·»åŠ å±æ€§ class Point { constructor(x, y) { Object.assign(this, {x, y}); } } let point = new Point(\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;); console.log(point); // Point { x: \u0026#39;foo\u0026#39;, y: \u0026#39;bar\u0026#39; } ä¸Šé¢æ–¹æ³•é€šè¿‡ Object.assign() æ–¹æ³•ï¼Œå°† x å±æ€§å’Œ y å±æ€§æ·»åŠ åˆ° Point ç±»çš„å¯¹è±¡å®ä¾‹ã€‚\nğŸ“ Note ä¸Šé¢çš„æ•ˆæœç­‰åŒäº\nthis.x = x; this.y = y; æ·»åŠ æ–¹æ³• class Point {} Object.assign(Point.prototype, { someMethod(arg1, arg2) { // Â·Â·Â· }, anotherMethod() { // Â·Â·Â· } }); // ç­‰åŒäºä¸‹é¢çš„å†™æ³• Point.prototype.someMethod = function (arg1, arg2) { // Â·Â·Â· }; Point.prototype.anotherMethod = function () { // Â·Â·Â· }; console.log(new Point().__proto__); // NOTE:è¿™é‡Œä½¿ç”¨çš„æ˜¯å†…éƒ¨æ–¹æ³•ï¼Œä»¥åå†æ”¹ // { // someMethod: [Function: someMethod], // anotherMethod: [Function: anotherMethod] // } ä¸Šé¢ä»£ç ä½¿ç”¨äº†å¯¹è±¡å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•ï¼Œç›´æ¥å°†ä¸¤ä¸ªå‡½æ•°æ”¾åœ¨å¤§æ‹¬å·ä¸­ï¼Œå†ä½¿ç”¨ assign() æ–¹æ³•æ·»åŠ åˆ° SomeClass.prototype ä¹‹ä¸­ã€‚\nå…‹éš†å¯¹è±¡ ğŸ“ƒ Example\nfunction clone(origin) { return Object.assign({}, origin); } ä¸Šé¢ä»£ç å°†åŸå§‹å¯¹è±¡æ‹·è´åˆ°ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå°±å¾—åˆ°äº†åŸå§‹å¯¹è±¡çš„å…‹éš†ã€‚å¦å¤–ï¼Œè¿™ä¹Ÿæ˜¯å•å±‚çš„æµ…å…‹éš†ã€‚\nä¸è¿‡ï¼Œé‡‡ç”¨è¿™ç§æ–¹æ³•å…‹éš†ï¼Œåªèƒ½å…‹éš†åŸå§‹å¯¹è±¡ è‡ªèº« çš„å€¼ï¼Œä¸èƒ½å…‹éš†å®ƒ ç»§æ‰¿ çš„å€¼ã€‚å¦‚æœæƒ³è¦ä¿æŒç»§æ‰¿é“¾ï¼Œå¯ä»¥é‡‡ç”¨ä¸‹é¢çš„ä»£ç ã€‚\nconst clone = origin =\u0026gt; Object.assign( Object.create(Object.getPrototypeOf(origin)), origin ); åˆå¹¶å¤šä¸ªå¯¹è±¡ å°†å¤šä¸ªå¯¹è±¡åˆå¹¶åˆ°æŸä¸ªå¯¹è±¡ã€‚\nconst merge = (target, ...sources) =\u0026gt; Object.assign( target, ...sources ); å¦‚æœå¸Œæœ›åˆå¹¶åè¿”å›ä¸€ä¸ª æ–°å¯¹è±¡ ï¼Œå¯ä»¥æ”¹å†™ä¸Šé¢å‡½æ•°ï¼Œå¯¹ä¸€ä¸ª ç©ºå¯¹è±¡ åˆå¹¶ã€‚\nconst merge = (...sources) =\u0026gt; Object.assign( {}, ...sources ); æŒ‡å®šé»˜è®¤å€¼ const DEFAULTS = { logLevel: 0, outputFormat: \u0026#39;html\u0026#39; }; function processContent(options) { options = Object.assign({}, DEFAULTS, options); console.log(options); // ... } processContent(DEFAULTS); // { logLevel: 0, outputFormat: \u0026#39;html\u0026#39; } processContent(\u0026#39;DEFAULTS\u0026#39;); // {0:\u0026#39;D\u0026#39;, 1:\u0026#39;E\u0026#39;, 2:\u0026#39;F\u0026#39;, 3:\u0026#39;A\u0026#39;, 4:\u0026#39;U\u0026#39;, 5:\u0026#39;L\u0026#39;, 6:\u0026#39;T\u0026#39;, 7:\u0026#39;S\u0026#39;,logLevel: 0, outputFormat: \u0026#39;html\u0026#39;} ä¸Šé¢ä»£ç ä¸­ï¼ŒDEFAULTS å¯¹è±¡æ˜¯é»˜è®¤å€¼ï¼Œoptions å¯¹è±¡æ˜¯ç”¨æˆ·æä¾›çš„å‚æ•°ã€‚Object.assign() æ–¹æ³•å°† DEFAULTS å’Œ options åˆå¹¶æˆä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¦‚æœä¸¤è€…æœ‰åŒåå±æ€§ï¼Œåˆ™ options çš„å±æ€§å€¼ä¼šè¦†ç›– DEFAULTS çš„å±æ€§å€¼ã€‚\næ³¨æ„ï¼Œç”±äºå­˜åœ¨æµ…æ‹·è´çš„é—®é¢˜ï¼ŒDEFAULTS å¯¹è±¡å’Œ options å¯¹è±¡çš„æ‰€æœ‰å±æ€§çš„å€¼ï¼Œæœ€å¥½éƒ½æ˜¯ç®€å•ç±»å‹ï¼Œä¸è¦æŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ã€‚å¦åˆ™ï¼ŒDEFAULTS å¯¹è±¡çš„è¯¥å±æ€§å¾ˆå¯èƒ½ä¸èµ·ä½œç”¨ã€‚\nğŸ“ƒ Example\nconst DEFAULTS = { url: { host: \u0026#39;example.com\u0026#39;, port: 7070 }, }; processContent({ url: {port: 8000} }) // { // url: {port: 8000} // } ä¸Šé¢ä»£ç çš„åŸæ„æ˜¯å°† url.port æ”¹æˆ 8000ï¼Œå¹¶ä¿æŒurl.host ä¸å˜ã€‚å®é™…ç»“æœå´æ˜¯ options.url è¦†ç›–æ‰ DEFAULTS.url ï¼Œæ‰€ä»¥ url.host å°±ä¸å­˜åœ¨äº†ã€‚\n:link: Href ES6 å¼•å…¥äº† å‡½æ•°çš„é»˜è®¤å€¼ ï¼Œç®€å•æ˜“ç”¨çš„åŒæ—¶é²æ£’æ€§ä¹Ÿæ›´å¼ºã€‚\nğŸ“ƒ Example\nconst defaultValue = ({ logLevel = 0, outputFormat = \u0026#34;html\u0026#34; } = {}) =\u0026gt; { // å‡½æ•°é»˜è®¤å€¼ + è§£æ„èµ‹å€¼ + è§£æ„èµ‹å€¼é»˜è®¤å€¼ let options = { logLevel, outputFormat }; console.log(options); }; defaultValue(DEFAULTS); // { logLevel: 0, outputFormat: \u0026#39;html\u0026#39; } defaultValue(\u0026#34;DEFAULTS\u0026#34;); // { logLevel: 0, outputFormat: \u0026#39;html\u0026#39; } getOwnPropertyDescriptors() ES5 çš„ Object.getOwnPropertyDescriptor() æ–¹æ³•ä¼šè¿”å›æŸä¸ªå¯¹è±¡å±æ€§çš„æè¿°å¯¹è±¡descriptor ã€‚ES2017 å¼•å…¥äº†Object.getOwnPropertyDescriptors()æ–¹æ³•ï¼Œè¿”å›æŒ‡å®šå¯¹è±¡æ‰€æœ‰è‡ªèº«å±æ€§ï¼ˆéç»§æ‰¿å±æ€§ï¼‰çš„æè¿°å¯¹è±¡ã€‚\nğŸ“ƒ Example\nconst obj = { foo: 123, get bar() { return \u0026#39;abc\u0026#39; } }; Object.getOwnPropertyDescriptors(obj); // { foo: // { value: 123, // writable: true, // enumerable: true, // configurable: true }, // bar: // { get: [Function: get bar], // set: undefined, // enumerable: true, // configurable: true } } ä¸Šé¢ä»£ç ä¸­ï¼ŒObject.getOwnPropertyDescriptors()æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€æœ‰åŸå¯¹è±¡çš„å±æ€§åéƒ½æ˜¯è¯¥å¯¹è±¡çš„å±æ€§åï¼Œå¯¹åº”çš„å±æ€§å€¼å°±æ˜¯è¯¥å±æ€§çš„æè¿°å¯¹è±¡ã€‚\nè¯¥æ–¹æ³•çš„å®ç°éå¸¸å®¹æ˜“ã€‚\nfunction getOwnPropertyDescriptors(obj) { const result = {}; for (let key of Reflect.ownKeys(obj)) { result[key] = Object.getOwnPropertyDescriptor(obj, key); } return result; } è¯¥æ–¹æ³•çš„å¼•å…¥ç›®çš„ï¼Œä¸»è¦æ˜¯ä¸ºäº†è§£å†³ Object.assign() æ— æ³•æ­£ç¡®æ‹·è´ get å±æ€§å’Œ set å±æ€§çš„é—®é¢˜ã€‚\nconst source = { set foo(value) { console.log(value); } }; const target1 = {}; Object.assign(target1, source); Object.getOwnPropertyDescriptor(target1, \u0026#39;foo\u0026#39;) // { value: undefined, // writable: true, // enumerable: true, // configurable: true } ä¸Šé¢ä»£ç ä¸­ï¼Œsource å¯¹è±¡çš„ foo å±æ€§çš„å€¼æ˜¯ä¸€ä¸ªèµ‹å€¼å‡½æ•°ï¼ŒObject.assign æ–¹æ³•å°†è¿™ä¸ªå±æ€§æ‹·è´ç»™ target1 å¯¹è±¡ï¼Œç»“æœè¯¥å±æ€§çš„å€¼å˜æˆäº† undefined ã€‚è¿™æ˜¯å› ä¸º Object.assign æ–¹æ³•æ€»æ˜¯æ‹·è´ä¸€ä¸ªå±æ€§çš„å€¼ï¼Œè€Œä¸ä¼šæ‹·è´å®ƒèƒŒåçš„èµ‹å€¼æ–¹æ³•æˆ–å–å€¼æ–¹æ³•ã€‚\nè¿™æ—¶ï¼ŒObject.getOwnPropertyDescriptors()æ–¹æ³•é…åˆObject.defineProperties()æ–¹æ³•ï¼Œå°±å¯ä»¥å®ç°æ­£ç¡®æ‹·è´ã€‚\nconst source = { set foo(value) { console.log(value); } }; const target2 = {}; Object.defineProperties(target2, Object.getOwnPropertyDescriptors(source)); Object.getOwnPropertyDescriptor(target2, \u0026#39;foo\u0026#39;) // { get: undefined, // set: [Function: set foo], // enumerable: true, // configurable: true } ä¸Šé¢ä»£ç ä¸­ï¼Œä¸¤ä¸ªå¯¹è±¡åˆå¹¶çš„é€»è¾‘å¯ä»¥å†™æˆä¸€ä¸ªå‡½æ•°ã€‚\nconst shallowMerge = (target, source) =\u0026gt; Object.defineProperties( target, Object.getOwnPropertyDescriptors(source) ); Object.getOwnPropertyDescriptors()æ–¹æ³•çš„å¦ä¸€ä¸ªç”¨å¤„ï¼Œæ˜¯é…åˆObject.create()æ–¹æ³•ï¼Œå°†å¯¹è±¡å±æ€§å…‹éš†åˆ°ä¸€ä¸ªæ–°å¯¹è±¡ã€‚è¿™å±äº æµ…æ‹·è´ ã€‚\nconst clone = Object.create(Object.getPrototypeOf(obj), Object.getOwnPropertyDescriptors(obj)); // æˆ–è€… const shallowClone = (obj) =\u0026gt; Object.create( Object.getPrototypeOf(obj), Object.getOwnPropertyDescriptors(obj) ); ä¸Šé¢ä»£ç ä¼šå…‹éš†å¯¹è±¡ objã€‚\nå¦å¤–ï¼ŒObject.getOwnPropertyDescriptors()æ–¹æ³•å¯ä»¥å®ç°ä¸€ä¸ªå¯¹è±¡ç»§æ‰¿å¦ä¸€ä¸ªå¯¹è±¡ã€‚ä»¥å‰ï¼Œç»§æ‰¿å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå¸¸å¸¸å†™æˆä¸‹é¢è¿™æ ·ã€‚\nconst obj = { __proto__: prot, foo: 123, }; ES6 è§„å®š__proto__åªæœ‰æµè§ˆå™¨è¦éƒ¨ç½²ï¼Œå…¶ä»–ç¯å¢ƒä¸ç”¨éƒ¨ç½²ã€‚å¦‚æœå»é™¤__proto__ï¼Œä¸Šé¢ä»£ç å°±è¦æ”¹æˆä¸‹é¢è¿™æ ·ã€‚\nconst obj = Object.create(prot); obj.foo = 123; // æˆ–è€… const obj = Object.assign( Object.create(prot), { foo: 123, } ); æœ‰äº†Object.getOwnPropertyDescriptors()ï¼Œæˆ‘ä»¬å°±æœ‰äº†å¦ä¸€ç§å†™æ³•ã€‚\nconst obj = Object.create( prot, Object.getOwnPropertyDescriptors({ foo: 123, }) ); Object.getOwnPropertyDescriptors()ä¹Ÿå¯ä»¥ç”¨æ¥å®ç° Mixinï¼ˆæ··å…¥ï¼‰æ¨¡å¼ã€‚\nlet mix = (object) =\u0026gt; ({ with: (...mixins) =\u0026gt; mixins.reduce( (c, mixin) =\u0026gt; Object.create( c, Object.getOwnPropertyDescriptors(mixin) ), object) }); // multiple mixins example let a = {a: \u0026#39;a\u0026#39;}; let b = {b: \u0026#39;b\u0026#39;}; let c = {c: \u0026#39;c\u0026#39;}; let d = mix(c).with(a, b); d.c // \u0026#34;c\u0026#34; d.b // \u0026#34;b\u0026#34; d.a // \u0026#34;a\u0026#34; ä¸Šé¢ä»£ç è¿”å›ä¸€ä¸ªæ–°çš„å¯¹è±¡dï¼Œä»£è¡¨äº†å¯¹è±¡aå’Œbè¢«æ··å…¥äº†å¯¹è±¡cçš„æ“ä½œã€‚\nå‡ºäºå®Œæ•´æ€§çš„è€ƒè™‘ï¼ŒObject.getOwnPropertyDescriptors()è¿›å…¥æ ‡å‡†ä»¥åï¼Œä»¥åè¿˜ä¼šæ–°å¢Reflect.getOwnPropertyDescriptors()æ–¹æ³•ã€‚\nåŸå‹é“¾ JavaScript è¯­è¨€çš„å¯¹è±¡ç»§æ‰¿æ˜¯é€šè¿‡ åŸå‹é“¾ å®ç°çš„ã€‚ES6 æä¾›äº†æ›´å¤šåŸå‹å¯¹è±¡çš„æ“ä½œæ–¹æ³•ã€‚\n__proto__ :link: Href [ES5](05 JavaScript#1) prototype åŸå‹å¯¹è±¡\n__proto__ å±æ€§ï¼ˆå‰åå„ä¸¤ä¸ªä¸‹åˆ’çº¿ï¼‰ï¼Œç”¨æ¥è¯»å–æˆ–è®¾ç½®å½“å‰å¯¹è±¡çš„åŸå‹å¯¹è±¡prototype ã€‚ç›®å‰ï¼Œæ‰€æœ‰æµè§ˆå™¨ï¼ˆåŒ…æ‹¬ IE11ï¼‰éƒ½éƒ¨ç½²äº†è¿™ä¸ªå±æ€§ã€‚\n// es5 çš„å†™æ³• const obj = { method: function() { ... } }; obj.__proto__ = someOtherObj; // es6 çš„å†™æ³• var obj = Object.create(someOtherObj); obj.method = function() { ... }; è¯¥å±æ€§æ²¡æœ‰å†™å…¥ ES6 çš„æ­£æ–‡ï¼Œè€Œæ˜¯å†™å…¥äº† é™„å½• ï¼ŒåŸå› æ˜¯ __proto__ å‰åçš„åŒä¸‹åˆ’çº¿ï¼Œè¯´æ˜å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª å†…éƒ¨å±æ€§ ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ­£å¼çš„å¯¹å¤–çš„ API ï¼Œåªæ˜¯ç”±äºæµè§ˆå™¨å¹¿æ³›æ”¯æŒï¼Œæ‰è¢«åŠ å…¥äº† ES6ã€‚æ ‡å‡†æ˜ç¡®è§„å®šï¼Œåªæœ‰æµè§ˆå™¨å¿…é¡»éƒ¨ç½²è¿™ä¸ªå±æ€§ï¼Œå…¶ä»–è¿è¡Œç¯å¢ƒä¸ä¸€å®šéœ€è¦éƒ¨ç½²ï¼Œè€Œä¸”æ–°çš„ä»£ç æœ€å¥½è®¤ä¸ºè¿™ä¸ªå±æ€§æ˜¯ä¸å­˜åœ¨çš„ã€‚å› æ­¤ï¼Œæ— è®ºä»è¯­ä¹‰çš„è§’åº¦ï¼Œè¿˜æ˜¯ä»å…¼å®¹æ€§çš„è§’åº¦ï¼Œéƒ½ä¸è¦ä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸‹é¢çš„ Object.setPrototypeOf()ï¼ˆå†™æ“ä½œï¼‰ã€Object.getPrototypeOf()ï¼ˆè¯»æ“ä½œï¼‰ã€Object.create()ï¼ˆç”Ÿæˆæ“ä½œï¼‰ä»£æ›¿ã€‚\nå®ç°ä¸Šï¼Œ__proto__ è°ƒç”¨çš„æ˜¯ Object.prototype.__proto__ ï¼Œå…·ä½“å®ç°å¦‚ä¸‹ã€‚\nObject.defineProperty(Object.prototype, \u0026#39;__proto__\u0026#39;, { get() { let _thisObj = Object(this); return Object.getPrototypeOf(_thisObj); }, set(proto) { if (this === undefined || this === null) { throw new TypeError(); } if (!isObject(this)) { return undefined; } if (!isObject(proto)) { return undefined; } let status = Reflect.setPrototypeOf(this, proto); if (!status) { throw new TypeError(); } }, }); function isObject(value) { return Object(value) === value; } å¦‚æœä¸€ä¸ªå¯¹è±¡æœ¬èº«éƒ¨ç½²äº† __proto__ å±æ€§ï¼Œè¯¥å±æ€§çš„å€¼å°±æ˜¯å¯¹è±¡çš„ åŸå‹ ã€‚\nğŸ“ƒ Example\nconsole.log( Object.getPrototypeOf({ __proto__: { set() {}, get() {} } } ) ); // { set: [Function: set], get: [Function: get] } setPrototypeOf() Object.setPrototypeOf æ–¹æ³•çš„ä½œç”¨ä¸ __proto__ ç›¸åŒï¼Œç”¨æ¥è®¾ç½®ä¸€ä¸ªå¯¹è±¡çš„åŸå‹å¯¹è±¡prototype {} ï¼Œè¿”å›å‚æ•°å¯¹è±¡æœ¬èº«ã€‚å®ƒæ˜¯ ES6 æ­£å¼æ¨è çš„è®¾ç½®åŸå‹å¯¹è±¡çš„æ–¹æ³•ã€‚\n// æ ¼å¼ Object.setPrototypeOf(object, prototype) // ç”¨æ³• const o = Object.setPrototypeOf({}, null); è¯¥æ–¹æ³•ç­‰åŒäºä¸‹é¢çš„å‡½æ•°ã€‚\nfunction setPrototypeOf(obj, proto) { obj.__proto__ = proto; return obj; } ğŸ“ƒ Example ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚\nlet proto = {x: 10, y: 20}; console.log() let obj = {z: 40}; Object.setPrototypeOf(obj, proto); console.log( obj.x, // 10 obj.y, // 20 obj.z // 40 ); ä¸Šé¢ä»£ç å°† proto å¯¹è±¡è®¾ä¸º obj å¯¹è±¡çš„åŸå‹ï¼Œæ‰€ä»¥ä» obj å¯¹è±¡å¯ä»¥è¯»å– proto å¯¹è±¡çš„å±æ€§ã€‚\nå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œä¼šè‡ªåŠ¨è½¬ä¸ºå¯¹è±¡ã€‚ä½†æ˜¯ç”±äºè¿”å›çš„è¿˜æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ‰€ä»¥è¿™ä¸ªæ“ä½œä¸ä¼šäº§ç”Ÿä»»ä½•æ•ˆæœã€‚\nlet str = String(\u0026#39;foo\u0026#39;); // ä½¿ç”¨åŸå§‹ç±»ï¼Œæ²¡æœ‰æ•ˆæœ // è½¬æ¢ä¸­äº§ç”Ÿä¸€ä¸ªä¸´æ—¶åŒ…è£¹ç±»ï¼Œå¹¶è‡ªåŠ¨æ¶ˆé™¤ console.log( typeof str, // string Object.setPrototypeOf(str, {foo: \u0026#39;bar\u0026#39;}), // foo Object.getPrototypeOf(str) // {} ); let strWrapper = new String(\u0026#39;foo\u0026#39;); // ä½¿ç”¨åŒ…è£¹ç±» console.log( typeof strWrapper, // object Object.setPrototypeOf(strWrapper, {foo: \u0026#39;bar\u0026#39;}), // {\u0026#39;0\u0026#39;:\u0026#39;f\u0026#39;, \u0026#39;1\u0026#39;:\u0026#39;o\u0026#39;, \u0026#39;2\u0026#39;:\u0026#39;o\u0026#39;} Object.getPrototypeOf(strWrapper) // { foo: \u0026#39;bar\u0026#39; } ); ç”±äº undefined æˆ– null æ— æ³•è½¬ä¸ºå¯¹è±¡ï¼Œæ‰€ä»¥å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ undefined æˆ– null ï¼Œå°±ä¼šæŠ¥é”™ã€‚\nObject.setPrototypeOf(undefined, {}); Object.setPrototypeOf(null, {}); // TypeError: Object.setPrototypeOf called on null or undefined getPrototypeOf() è¯¥æ–¹æ³•ä¸ Object.setPrototypeOf æ–¹æ³•é…å¥—ï¼Œç”¨äºè¯»å–ä¸€ä¸ªå¯¹è±¡çš„ åŸå‹å¯¹è±¡ ã€‚\nObject.getPrototypeOf(obj); ğŸ“ƒ Example ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚\nfunction Rectangle() { // ... } const rec = new Rectangle(); console.log( Object.getPrototypeOf(rec) === Rectangle.prototype, Object.setPrototypeOf(rec, Object.prototype), Object.getPrototypeOf(rec) === Rectangle.prototype, ) // true {} false :link: Href [Object.prototype](05 JavaScript#object-prototype-es5)\nå¦‚æœå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œä¼šè¢«è‡ªåŠ¨è½¬ä¸ºå¯¹è±¡ã€‚\n// è‡ªåŠ¨è¢«è½¬æ¢ä¸ºç›¸åº”çš„åŒ…è£¹ç±» console.log( Object.getPrototypeOf(1), // Number {[[PrimitiveValue]]: 0} Object.getPrototypeOf(\u0026#39;foo\u0026#39;), // String {length: 0, [[PrimitiveValue]]: \u0026#34;\u0026#34;} Object.getPrototypeOf(true), // Boolean {[[PrimitiveValue]]: false} Object.getPrototypeOf(1) === Number.prototype, // true Object.getPrototypeOf(\u0026#39;foo\u0026#39;) === String.prototype, // true Object.getPrototypeOf(true) === Boolean.prototype, // true ); åŒæ ·ï¼Œå¦‚æœå‚æ•°æ˜¯undefinedæˆ–nullï¼Œå®ƒä»¬æ— æ³•è½¬ä¸ºå¯¹è±¡ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ã€‚\nObject.getPrototypeOf(null); Object.getPrototypeOf(undefined); // TypeError: Cannot convert undefined or null to object éå† ES6 è§„èŒƒä¹‹åï¼Œå¯¹è±¡ä¿ç•™ String å’Œ Symbol é”®çš„åˆ›å»ºé¡ºåºï¼Œè€Œ Number ç±»å‹ä»ç„¶ç”±å°åˆ°å¤§æ’åºã€‚\nlet obj = { a: 1, c: 2, b: 3, // å­—ç¬¦ä¸² 1: \u0026#39;a\u0026#39;, 3: \u0026#39;b\u0026#39;, 2: \u0026#39;c\u0026#39;, // æ•°å­— [Symbol()]: \u0026#39;foo\u0026#39; // Symbol } for (const value of Object.values(obj)) { console.log(value); // 1 2 3 å­—ç¬¦ä¸²æ ¹æ®åˆ›å»ºé¡ºåºè¿­ä»£ // a c b æ•°å­—ä»å°åˆ°å¤§è¿­ä»£ // Symbol ç±»å‹ä¸æ˜¾ç¤º } keys() ES5 å¼•å…¥äº† Object.keys æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å‚æ•°å¯¹è±¡ è‡ªèº« çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰ å¯éå†enumerable å±æ€§çš„é”®åã€‚\nconst obj = {foo: \u0026#39;bar\u0026#39;, baz: 42}; const keys = Object.keys(obj); // [\u0026#34;foo\u0026#34;, \u0026#34;baz\u0026#34;] for (const key of keys) { console.log(typeof key, key); // string \u0026#39;foo\u0026#39; string \u0026#39;baz\u0026#39; } ES2017 å¼•å…¥äº†è·Ÿ Object.keys é…å¥—çš„ Object.values å’Œ Object.entries ï¼Œä½œä¸ºéå†ä¸€ä¸ªå¯¹è±¡çš„è¡¥å……æ‰‹æ®µï¼Œä¾› [for-of](05 JavaScript#for-of) å¾ªç¯ä½¿ç”¨ã€‚\nğŸ“ƒ Example\nlet {keys, values, entries} = Object; let obj = {a: 1, b: 2, c: 3}; for (let key of keys(obj)) { console.log(key); // \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39; } for (let value of values(obj)) { console.log(value); // 1, 2, 3 } for (let [key, value] of entries(obj)) { console.log([key, value]); // [\u0026#39;a\u0026#39;, 1], [\u0026#39;b\u0026#39;, 2], [\u0026#39;c\u0026#39;, 3] } values() Object.values æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å‚æ•°å¯¹è±¡è‡ªèº«çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰å¯éå† enumerable å±æ€§çš„é”®å€¼ã€‚\nconst obj = { foo: \u0026#39;bar\u0026#39;, baz: 42 }; Object.values(obj) // [\u0026#34;bar\u0026#34;, 42] è¿”å›æ•°ç»„çš„æˆå‘˜é¡ºåºï¼Œå±æ€§åä¸ºæ•°å€¼çš„å±æ€§ï¼Œæ˜¯æŒ‰ç…§æ•°å€¼å¤§å°ï¼Œä»å°åˆ°å¤§éå†çš„ï¼Œå› æ­¤è¿”å›çš„é¡ºåºæ˜¯ bã€cã€aã€‚\nconst obj = { 100: \u0026#39;a\u0026#39;, 2: \u0026#39;b\u0026#39;, 7: \u0026#39;c\u0026#39; }; Object.values(obj) // [\u0026#34;b\u0026#34;, \u0026#34;c\u0026#34;, \u0026#34;a\u0026#34;] ğŸ“ Note\nObject.values åªè¿”å›å¯¹è±¡ è‡ªèº« çš„å¯éå†å±æ€§ï¼ˆä¸åŒ…æ‹¬ç»§æ‰¿ï¼‰\nObject.valuesä¼šè¿‡æ»¤å±æ€§åä¸º Symbol å€¼çš„å±æ€§ã€‚\nlet o = {[Symbol()]: 123, foo: \u0026#39;abc\u0026#39;}; console.log( Object.keys(o), // [ \u0026#39;foo\u0026#39; ] Object.values(o), // [ \u0026#39;abc\u0026#39; ] Object.entries(o) // [ [ \u0026#39;foo\u0026#39;, \u0026#39;abc\u0026#39; ] ] ); å¦‚æœ Object.values æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¼šè¿”å›å„ä¸ªå­—ç¬¦ç»„æˆçš„ä¸€ä¸ªæ•°ç»„ã€‚\nObject.values(\u0026#39;foo\u0026#39;) // [\u0026#39;f\u0026#39;, \u0026#39;o\u0026#39;, \u0026#39;o\u0026#39;] ä¸Šé¢ä»£ç ä¸­ï¼Œå­—ç¬¦ä¸²ä¼šå…ˆè½¬æˆä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€‚å­—ç¬¦ä¸²çš„æ¯ä¸ªå­—ç¬¦ï¼Œå°±æ˜¯è¯¥å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ã€‚å› æ­¤ï¼ŒObject.values è¿”å›æ¯ä¸ªå±æ€§çš„é”®å€¼ï¼Œå°±æ˜¯å„ä¸ªå­—ç¬¦ç»„æˆçš„ä¸€ä¸ªæ•°ç»„ã€‚\nå¦‚æœå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼ŒObject.values ä¼šå…ˆå°†å…¶è½¬ä¸ºå¯¹è±¡ã€‚ç”±äºæ•°å€¼å’Œå¸ƒå°”å€¼çš„åŒ…è£…å¯¹è±¡ï¼Œéƒ½ä¸ä¼šä¸ºå®ä¾‹æ·»åŠ éç»§æ‰¿çš„å±æ€§ã€‚æ‰€ä»¥ï¼ŒObject.values ä¼šè¿”å›ç©ºæ•°ç»„ã€‚\nObject.values(42) // [] Object.values(true) // [] entries() Object.entries()æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å‚æ•°å¯¹è±¡è‡ªèº«çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰å¯éå†enumerable å±æ€§çš„é”®å€¼å¯¹æ•°ç»„ã€‚\nconst obj = { foo: \u0026#39;bar\u0026#39;, baz: 42 }; Object.entries(obj) // [ [\u0026#34;foo\u0026#34;, \u0026#34;bar\u0026#34;], [\u0026#34;baz\u0026#34;, 42] ] é™¤äº†è¿”å›å€¼ä¸ä¸€æ ·ï¼Œè¯¥æ–¹æ³•çš„è¡Œä¸ºä¸Object.valuesåŸºæœ¬ä¸€è‡´ã€‚\nå¦‚æœåŸå¯¹è±¡çš„å±æ€§åæ˜¯ä¸€ä¸ª Symbol å€¼ï¼Œè¯¥å±æ€§ä¼šè¢«å¿½ç•¥ã€‚\nğŸ“ƒ Example\nObject.entries({ [Symbol()]: 123, foo: \u0026#39;abc\u0026#39; }); // [ [ \u0026#39;foo\u0026#39;, \u0026#39;abc\u0026#39; ] ] ä¸Šé¢ä»£ç ä¸­ï¼ŒåŸå¯¹è±¡æœ‰ä¸¤ä¸ªå±æ€§ï¼ŒObject.entriesåªè¾“å‡ºå±æ€§åé Symbol å€¼çš„å±æ€§ã€‚å°†æ¥å¯èƒ½ä¼šæœ‰ Reflect.ownEntries() æ–¹æ³•ï¼Œè¿”å›å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å±æ€§ã€‚\nObject.entries çš„åŸºæœ¬ç”¨é€”æ˜¯éå†å¯¹è±¡çš„å±æ€§ã€‚\nlet obj = { one: 1, two: 2 }; for (let [k, v] of Object.entries(obj)) { console.log( `${JSON.stringify(k)}: ${JSON.stringify(v)}` ); } // \u0026#34;one\u0026#34;: 1 // \u0026#34;two\u0026#34;: 2 Object.entries æ–¹æ³•çš„å¦ä¸€ä¸ªç”¨å¤„æ˜¯ï¼Œå°†å¯¹è±¡è½¬ä¸ºçœŸæ­£çš„ Map ç»“æ„ã€‚\nconst obj = { foo: \u0026#39;bar\u0026#39;, baz: 42 }; const map = new Map(Object.entries(obj)); map // Map { foo: \u0026#34;bar\u0026#34;, baz: 42 } è‡ªå·±å®ç° Object.entries æ–¹æ³•ï¼Œéå¸¸ç®€å•ã€‚\n// Generatorå‡½æ•°çš„ç‰ˆæœ¬ function* entries(obj) { for (let key of Object.keys(obj)) { yield [key, obj[key]]; } } // éGeneratorå‡½æ•°çš„ç‰ˆæœ¬ function entries(obj) { let arr = []; for (let key of Object.keys(obj)) { arr.push([key, obj[key]]); } return arr; } fromEntries() Object.fromEntries() æ–¹æ³•æ˜¯ Object.entries() çš„é€†æ“ä½œï¼Œç”¨äºå°†ä¸€ä¸ª é”®å€¼å¯¹æ•°ç»„ è½¬ä¸º å¯¹è±¡ ã€‚\nObject.fromEntries([ [\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;], [\u0026#39;baz\u0026#39;, 42] ]) // { foo: \u0026#34;bar\u0026#34;, baz: 42 } è¯¥æ–¹æ³•çš„ä¸»è¦ç›®çš„ï¼Œæ˜¯å°†é”®å€¼å¯¹çš„æ•°æ®ç»“æ„è¿˜åŸä¸ºå¯¹è±¡ï¼Œå› æ­¤ç‰¹åˆ«é€‚åˆå°† Map ç»“æ„è½¬ä¸ºå¯¹è±¡ã€‚\n// ä¾‹ä¸€ const map = new Map([ [\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;], [\u0026#39;baz\u0026#39;, 42] ]); Object.fromEntries(map); // { foo: \u0026#34;bar\u0026#34;, baz: 42 } è¯¥æ–¹æ³•çš„ä¸€ä¸ªç”¨å¤„æ˜¯é…åˆ URLSearchParams å¯¹è±¡ï¼Œå°†æŸ¥è¯¢å­—ç¬¦ä¸²è½¬ä¸ºå¯¹è±¡ã€‚\nObject.fromEntries( new URLSearchParams(\u0026#39;foo=bar\u0026amp;baz=42\u0026#39;) ); // { foo: \u0026#39;bar\u0026#39;, baz: 42 } å­—ç¬¦ä¸² :link: Href ç‚¹æ­¤æŸ¥çœ‹ [ES5](05 JavaScript/#string-es5) ç‰ˆæœ¬çš„å­—ç¬¦ä¸²\næ–¹æ³• ES6 æ–°å¢äº†ä¸€äº›å­—ç¬¦ä¸²æ–¹æ³•ã€‚\nè¾“å‡ºå­—ç¬¦ ES5 æä¾›String.fromCharCode()æ–¹æ³•ï¼Œç”¨äºä» Unicode ç ç‚¹è¿”å›å¯¹åº”å­—ç¬¦ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•ä¸èƒ½è¯†åˆ«ç ç‚¹å¤§äº0xFFFFçš„å­—ç¬¦ã€‚\nString.fromCharCode(0x20BB7) // \u0026#34;à®·\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼ŒString.fromCharCode()ä¸èƒ½è¯†åˆ«å¤§äº0xFFFFçš„ç ç‚¹ï¼Œæ‰€ä»¥0x20BB7å°±å‘ç”Ÿäº†æº¢å‡ºï¼Œæœ€é«˜ä½2è¢«èˆå¼ƒäº†ï¼Œæœ€åè¿”å›ç ç‚¹U+0BB7å¯¹åº”çš„å­—ç¬¦ï¼Œè€Œä¸æ˜¯ç ç‚¹U+20BB7å¯¹åº”çš„å­—ç¬¦ã€‚\nES6 æä¾›äº†String.fromCodePoint()æ–¹æ³•ï¼Œå¯ä»¥è¯†åˆ«å¤§äº0xFFFFçš„å­—ç¬¦ï¼Œå¼¥è¡¥äº†String.fromCharCode()æ–¹æ³•çš„ä¸è¶³ã€‚åœ¨ä½œç”¨ä¸Šï¼Œæ­£å¥½ä¸ä¸‹é¢çš„codePointAt()æ–¹æ³•ç›¸åã€‚\nString.fromCodePoint(0x20BB7) // \u0026#34;ğ ®·\u0026#34; String.fromCodePoint(0x78, 0x1f680, 0x79) === \u0026#39;x\\uD83D\\uDE80y\u0026#39; // true ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœString.fromCodePointæ–¹æ³•æœ‰å¤šä¸ªå‚æ•°ï¼Œåˆ™å®ƒä»¬ä¼šè¢«åˆå¹¶æˆä¸€ä¸ªå­—ç¬¦ä¸²è¿”å›ã€‚\næ³¨æ„ï¼ŒfromCodePointæ–¹æ³•å®šä¹‰åœ¨Stringå¯¹è±¡ä¸Šï¼Œè€ŒcodePointAtæ–¹æ³•å®šä¹‰åœ¨å­—ç¬¦ä¸²çš„å®ä¾‹å¯¹è±¡ä¸Šã€‚\nå­—ç¬¦è½¬ä¹‰ ES6 è¿˜ä¸ºåŸç”Ÿçš„ String å¯¹è±¡ï¼Œæä¾›äº†ä¸€ä¸ªraw()æ–¹æ³•ã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªæ–œæ éƒ½è¢«è½¬ä¹‰ï¼ˆå³æ–œæ å‰é¢å†åŠ ä¸€ä¸ªæ–œæ ï¼‰çš„å­—ç¬¦ä¸²ï¼Œå¾€å¾€ç”¨äºæ¨¡æ¿å­—ç¬¦ä¸²çš„å¤„ç†æ–¹æ³•ã€‚\nString.raw`Hi ${2+3}!` // å®é™…è¿”å› \u0026#34;Hi\\ 5!\u0026#34;ï¼Œæ˜¾ç¤ºçš„æ˜¯è½¬ä¹‰åçš„ç»“æœ \u0026#34;Hi 5!\u0026#34; String.raw`Hi\\u000A!`; // å®é™…è¿”å› \u0026#34;Hi\\\\u000A!\u0026#34;ï¼Œæ˜¾ç¤ºçš„æ˜¯è½¬ä¹‰åçš„ç»“æœ \u0026#34;Hi\\u000A!\u0026#34; å¦‚æœåŸå­—ç¬¦ä¸²çš„æ–œæ å·²ç»è½¬ä¹‰ï¼Œé‚£ä¹ˆString.raw()ä¼šè¿›è¡Œå†æ¬¡è½¬ä¹‰ã€‚\nString.raw`Hi\\ ` // è¿”å› \u0026#34;Hi\\\\\\ \u0026#34; String.raw`Hi\\ ` === \u0026#34;Hi\\\\\\ \u0026#34; // true String.raw()æ–¹æ³•å¯ä»¥ä½œä¸ºå¤„ç†æ¨¡æ¿å­—ç¬¦ä¸²çš„åŸºæœ¬æ–¹æ³•ï¼Œå®ƒä¼šå°†æ‰€æœ‰å˜é‡æ›¿æ¢ï¼Œè€Œä¸”å¯¹æ–œæ è¿›è¡Œè½¬ä¹‰ï¼Œæ–¹ä¾¿ä¸‹ä¸€æ­¥ä½œä¸ºå­—ç¬¦ä¸²æ¥ä½¿ç”¨ã€‚\nString.raw()æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ­£å¸¸çš„å‡½æ•°ï¼Œåªæ˜¯ä¸“ç”¨äºæ¨¡æ¿å­—ç¬¦ä¸²çš„æ ‡ç­¾å‡½æ•°ã€‚å¦‚æœå†™æˆæ­£å¸¸å‡½æ•°çš„å½¢å¼ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªå…·æœ‰rawå±æ€§çš„å¯¹è±¡ï¼Œä¸”rawå±æ€§çš„å€¼åº”è¯¥æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¯¹åº”æ¨¡æ¿å­—ç¬¦ä¸²è§£æåçš„å€¼ã€‚\n// `foo${1 + 2}bar` // ç­‰åŒäº String.raw({ raw: [\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;] }, 1 + 2) // \u0026#34;foo3bar\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼ŒString.raw()æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„rawå±æ€§ç­‰åŒäºåŸå§‹çš„æ¨¡æ¿å­—ç¬¦ä¸²è§£æåå¾—åˆ°çš„æ•°ç»„ã€‚\nä½œä¸ºå‡½æ•°ï¼ŒString.raw()çš„ä»£ç å®ç°åŸºæœ¬å¦‚ä¸‹ã€‚\nString.raw = function (strings, ...values) { let output = \u0026#39;\u0026#39;; let index; for (index = 0; index \u0026lt; values.length; index++) { output += strings.raw[index] + values[index]; } output += strings.raw[index] return output; } ç¼–ç å…¼å®¹ codePointAt()\nJavaScript å†…éƒ¨ï¼Œå­—ç¬¦ä»¥ UTF-16 çš„æ ¼å¼å‚¨å­˜ï¼Œæ¯ä¸ªå­—ç¬¦å›ºå®šä¸º2ä¸ªå­—èŠ‚ã€‚å¯¹äºé‚£äº›éœ€è¦4ä¸ªå­—èŠ‚å‚¨å­˜çš„å­—ç¬¦ï¼ˆUnicode ç ç‚¹å¤§äº0xFFFFçš„å­—ç¬¦ï¼‰ï¼ŒJavaScript ä¼šè®¤ä¸ºå®ƒä»¬æ˜¯ä¸¤ä¸ªå­—ç¬¦ã€‚\nvar s = \u0026#34;ğ ®·\u0026#34;; s.length // 2 s.charAt(0) // \u0026#39;\u0026#39; s.charAt(1) // \u0026#39;\u0026#39; s.charCodeAt(0) // 55362 s.charCodeAt(1) // 57271 ä¸Šé¢ä»£ç ä¸­ï¼Œæ±‰å­—â€œğ ®·â€ï¼ˆæ³¨æ„ï¼Œè¿™ä¸ªå­—ä¸æ˜¯â€œå‰ç¥¥â€çš„â€œå‰â€ï¼‰çš„ç ç‚¹æ˜¯0x20BB7ï¼ŒUTF-16 ç¼–ç ä¸º0xD842 0xDFB7ï¼ˆåè¿›åˆ¶ä¸º55362 57271ï¼‰ï¼Œéœ€è¦4ä¸ªå­—èŠ‚å‚¨å­˜ã€‚å¯¹äºè¿™ç§4ä¸ªå­—èŠ‚çš„å­—ç¬¦ï¼ŒJavaScript ä¸èƒ½æ­£ç¡®å¤„ç†ï¼Œå­—ç¬¦ä¸²é•¿åº¦ä¼šè¯¯åˆ¤ä¸º2ï¼Œè€Œä¸”charAt()æ–¹æ³•æ— æ³•è¯»å–æ•´ä¸ªå­—ç¬¦ï¼ŒcharCodeAt()æ–¹æ³•åªèƒ½åˆ†åˆ«è¿”å›å‰ä¸¤ä¸ªå­—èŠ‚å’Œåä¸¤ä¸ªå­—èŠ‚çš„å€¼ã€‚\nES6 æä¾›äº†codePointAt()æ–¹æ³•ï¼Œèƒ½å¤Ÿæ­£ç¡®å¤„ç† 4 ä¸ªå­—èŠ‚å‚¨å­˜çš„å­—ç¬¦ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦çš„ç ç‚¹ã€‚\nlet s = \u0026#39;ğ ®·a\u0026#39;; s.codePointAt(0) // 134071 s.codePointAt(1) // 57271 s.codePointAt(2) // 97 codePointAt()æ–¹æ³•çš„å‚æ•°ï¼Œæ˜¯å­—ç¬¦åœ¨å­—ç¬¦ä¸²ä¸­çš„ä½ç½®ï¼ˆä» 0 å¼€å§‹ï¼‰ã€‚ä¸Šé¢ä»£ç ä¸­ï¼ŒJavaScript å°†â€œğ ®·aâ€è§†ä¸ºä¸‰ä¸ªå­—ç¬¦ï¼ŒcodePointAt æ–¹æ³•åœ¨ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸Šï¼Œæ­£ç¡®åœ°è¯†åˆ«äº†â€œğ ®·â€ï¼Œè¿”å›äº†å®ƒçš„åè¿›åˆ¶ç ç‚¹ 134071ï¼ˆå³åå…­è¿›åˆ¶çš„20BB7ï¼‰ã€‚åœ¨ç¬¬äºŒä¸ªå­—ç¬¦ï¼ˆå³â€œğ ®·â€çš„åä¸¤ä¸ªå­—èŠ‚ï¼‰å’Œç¬¬ä¸‰ä¸ªå­—ç¬¦â€œaâ€ä¸Šï¼ŒcodePointAt()æ–¹æ³•çš„ç»“æœä¸charCodeAt()æ–¹æ³•ç›¸åŒã€‚\næ€»ä¹‹ï¼ŒcodePointAt()æ–¹æ³•ä¼šæ­£ç¡®è¿”å› 32 ä½çš„ UTF-16 å­—ç¬¦çš„ç ç‚¹ã€‚å¯¹äºé‚£äº›ä¸¤ä¸ªå­—èŠ‚å‚¨å­˜çš„å¸¸è§„å­—ç¬¦ï¼Œå®ƒçš„è¿”å›ç»“æœä¸charCodeAt()æ–¹æ³•ç›¸åŒã€‚\ncodePointAt()æ–¹æ³•è¿”å›çš„æ˜¯ç ç‚¹çš„åè¿›åˆ¶å€¼ï¼Œå¦‚æœæƒ³è¦åå…­è¿›åˆ¶çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨toString()æ–¹æ³•è½¬æ¢ä¸€ä¸‹ã€‚\nlet s = \u0026#39;ğ ®·a\u0026#39;; s.codePointAt(0).toString(16) // \u0026#34;20bb7\u0026#34; s.codePointAt(2).toString(16) // \u0026#34;61\u0026#34; ä½ å¯èƒ½æ³¨æ„åˆ°äº†ï¼ŒcodePointAt()æ–¹æ³•çš„å‚æ•°ï¼Œä»ç„¶æ˜¯ä¸æ­£ç¡®çš„ã€‚æ¯”å¦‚ï¼Œä¸Šé¢ä»£ç ä¸­ï¼Œå­—ç¬¦aåœ¨å­—ç¬¦ä¸²sçš„æ­£ç¡®ä½ç½®åºå·åº”è¯¥æ˜¯ 1ï¼Œä½†æ˜¯å¿…é¡»å‘codePointAt()æ–¹æ³•ä¼ å…¥ 2ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªåŠæ³•æ˜¯ä½¿ç”¨for...ofå¾ªç¯ï¼Œå› ä¸ºå®ƒä¼šæ­£ç¡®è¯†åˆ« 32 ä½çš„ UTF-16 å­—ç¬¦ã€‚\nlet s = \u0026#39;ğ ®·a\u0026#39;; for (let ch of s) { console.log(ch.codePointAt(0).toString(16)); } // 20bb7 // 61 å¦ä¸€ç§æ–¹æ³•ä¹Ÿå¯ä»¥ï¼Œä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼ˆ...ï¼‰è¿›è¡Œå±•å¼€è¿ç®—ã€‚\nlet arr = [...\u0026#39;ğ ®·a\u0026#39;]; // arr.length === 2 arr.forEach( ch =\u0026gt; console.log(ch.codePointAt(0).toString(16)) ); // 20bb7 // 61 codePointAt()æ–¹æ³•æ˜¯æµ‹è¯•ä¸€ä¸ªå­—ç¬¦ç”±ä¸¤ä¸ªå­—èŠ‚è¿˜æ˜¯ç”±å››ä¸ªå­—èŠ‚ç»„æˆçš„æœ€ç®€å•æ–¹æ³•ã€‚\nfunction is32Bit(c) { return c.codePointAt(0) \u0026gt; 0xFFFF; } is32Bit(\u0026#34;ğ ®·\u0026#34;) // true is32Bit(\u0026#34;a\u0026#34;) // false å½¢å¼ç»Ÿä¸€ è®¸å¤šæ¬§æ´²è¯­è¨€æœ‰è¯­è°ƒç¬¦å·å’Œé‡éŸ³ç¬¦å·ã€‚ä¸ºäº†è¡¨ç¤ºå®ƒä»¬ï¼ŒUnicode æä¾›äº†ä¸¤ç§æ–¹æ³•ã€‚ä¸€ç§æ˜¯ç›´æ¥æä¾›å¸¦é‡éŸ³ç¬¦å·çš„å­—ç¬¦ï¼Œæ¯”å¦‚Ç‘ï¼ˆ\\u01D1ï¼‰ã€‚å¦ä¸€ç§æ˜¯æä¾›åˆæˆç¬¦å·ï¼ˆcombining characterï¼‰ï¼Œå³åŸå­—ç¬¦ä¸é‡éŸ³ç¬¦å·çš„åˆæˆï¼Œä¸¤ä¸ªå­—ç¬¦åˆæˆä¸€ä¸ªå­—ç¬¦ï¼Œæ¯”å¦‚Oï¼ˆ\\u004Fï¼‰å’ŒË‡ï¼ˆ\\u030Cï¼‰åˆæˆÇ‘ï¼ˆ\\u004F\\u030Cï¼‰ã€‚\nè¿™ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ï¼Œåœ¨è§†è§‰å’Œè¯­ä¹‰ä¸Šéƒ½ç­‰ä»·ï¼Œä½†æ˜¯ JavaScript ä¸èƒ½è¯†åˆ«ã€‚\n\u0026#39;\\u01D1\u0026#39;===\u0026#39;\\u004F\\u030C\u0026#39; //false \u0026#39;\\u01D1\u0026#39;.length // 1 \u0026#39;\\u004F\\u030C\u0026#39;.length // 2 ä¸Šé¢ä»£ç è¡¨ç¤ºï¼ŒJavaScript å°†åˆæˆå­—ç¬¦è§†ä¸ºä¸¤ä¸ªå­—ç¬¦ï¼Œå¯¼è‡´ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ä¸ç›¸ç­‰ã€‚\nES6 æä¾›å­—ç¬¦ä¸²å®ä¾‹çš„normalize()æ–¹æ³•ï¼Œç”¨æ¥å°†å­—ç¬¦çš„ä¸åŒè¡¨ç¤ºæ–¹æ³•ç»Ÿä¸€ä¸ºåŒæ ·çš„å½¢å¼ï¼Œè¿™ç§°ä¸º Unicode æ­£è§„åŒ–ã€‚\n\u0026#39;\\u01D1\u0026#39;.normalize() === \u0026#39;\\u004F\\u030C\u0026#39;.normalize() // true normalizeæ–¹æ³•å¯ä»¥æ¥å—ä¸€ä¸ªå‚æ•°æ¥æŒ‡å®šnormalizeçš„æ–¹å¼ï¼Œå‚æ•°çš„å››ä¸ªå¯é€‰å€¼å¦‚ä¸‹ã€‚\nNFCï¼Œé»˜è®¤å‚æ•°ï¼Œè¡¨ç¤ºâ€œæ ‡å‡†ç­‰ä»·åˆæˆâ€ï¼ˆNormalization Form Canonical Compositionï¼‰ï¼Œè¿”å›å¤šä¸ªç®€å•å­—ç¬¦çš„åˆæˆå­—ç¬¦ã€‚æ‰€è°“â€œæ ‡å‡†ç­‰ä»·â€æŒ‡çš„æ˜¯è§†è§‰å’Œè¯­ä¹‰ä¸Šçš„ç­‰ä»·ã€‚ NFDï¼Œè¡¨ç¤ºâ€œæ ‡å‡†ç­‰ä»·åˆ†è§£â€ï¼ˆNormalization Form Canonical Decompositionï¼‰ï¼Œå³åœ¨æ ‡å‡†ç­‰ä»·çš„å‰æä¸‹ï¼Œè¿”å›åˆæˆå­—ç¬¦åˆ†è§£çš„å¤šä¸ªç®€å•å­—ç¬¦ã€‚ NFKCï¼Œè¡¨ç¤ºâ€œå…¼å®¹ç­‰ä»·åˆæˆâ€ï¼ˆNormalization Form Compatibility Compositionï¼‰ï¼Œè¿”å›åˆæˆå­—ç¬¦ã€‚æ‰€è°“â€œå…¼å®¹ç­‰ä»·â€æŒ‡çš„æ˜¯è¯­ä¹‰ä¸Šå­˜åœ¨ç­‰ä»·ï¼Œä½†è§†è§‰ä¸Šä¸ç­‰ä»·ï¼Œæ¯”å¦‚â€œå›â€å’Œâ€œå–œå–œâ€ã€‚ï¼ˆè¿™åªæ˜¯ç”¨æ¥ä¸¾ä¾‹ï¼Œnormalizeæ–¹æ³•ä¸èƒ½è¯†åˆ«ä¸­æ–‡ã€‚ï¼‰ NFKDï¼Œè¡¨ç¤ºâ€œå…¼å®¹ç­‰ä»·åˆ†è§£â€ï¼ˆNormalization Form Compatibility Decompositionï¼‰ï¼Œå³åœ¨å…¼å®¹ç­‰ä»·çš„å‰æä¸‹ï¼Œè¿”å›åˆæˆå­—ç¬¦åˆ†è§£çš„å¤šä¸ªç®€å•å­—ç¬¦ã€‚ \u0026#39;\\u004F\\u030C\u0026#39;.normalize(\u0026#39;NFC\u0026#39;).length // 1 \u0026#39;\\u004F\\u030C\u0026#39;.normalize(\u0026#39;NFD\u0026#39;).length // 2 ä¸Šé¢ä»£ç è¡¨ç¤ºï¼ŒNFCå‚æ•°è¿”å›å­—ç¬¦çš„åˆæˆå½¢å¼ï¼ŒNFDå‚æ•°è¿”å›å­—ç¬¦çš„åˆ†è§£å½¢å¼ã€‚\nä¸è¿‡ï¼Œnormalizeæ–¹æ³•ç›®å‰ä¸èƒ½è¯†åˆ«ä¸‰ä¸ªæˆ–ä¸‰ä¸ªä»¥ä¸Šå­—ç¬¦çš„åˆæˆã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯åªèƒ½ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œé€šè¿‡ Unicode ç¼–å·åŒºé—´åˆ¤æ–­ã€‚\nä½ç½®å¯»æ‰¾ includes(), startsWith(), endsWith()\nä¼ ç»Ÿä¸Šï¼ŒJavaScript åªæœ‰indexOfæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥ç¡®å®šä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ…å«åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚ES6 åˆæä¾›äº†ä¸‰ç§æ–°æ–¹æ³•ã€‚\nincludes()ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æ‰¾åˆ°äº†å‚æ•°å­—ç¬¦ä¸²ã€‚ startsWith()ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå‚æ•°å­—ç¬¦ä¸²æ˜¯å¦åœ¨åŸå­—ç¬¦ä¸²çš„å¤´éƒ¨ã€‚ endsWith()ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå‚æ•°å­—ç¬¦ä¸²æ˜¯å¦åœ¨åŸå­—ç¬¦ä¸²çš„å°¾éƒ¨ã€‚ let s = \u0026#39;Hello world!\u0026#39;; s.startsWith(\u0026#39;Hello\u0026#39;) // true s.endsWith(\u0026#39;!\u0026#39;) // true s.includes(\u0026#39;o\u0026#39;) // true è¿™ä¸‰ä¸ªæ–¹æ³•éƒ½æ”¯æŒç¬¬äºŒä¸ªå‚æ•°ï¼Œè¡¨ç¤ºå¼€å§‹æœç´¢çš„ä½ç½®ã€‚\nlet s = \u0026#39;Hello world!\u0026#39;; s.startsWith(\u0026#39;world\u0026#39;, 6) // true s.endsWith(\u0026#39;Hello\u0026#39;, 5) // true s.includes(\u0026#39;Hello\u0026#39;, 6) // false ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°næ—¶ï¼ŒendsWithçš„è¡Œä¸ºä¸å…¶ä»–ä¸¤ä¸ªæ–¹æ³•æœ‰æ‰€ä¸åŒã€‚å®ƒé’ˆå¯¹å‰nä¸ªå­—ç¬¦ï¼Œè€Œå…¶ä»–ä¸¤ä¸ªæ–¹æ³•é’ˆå¯¹ä»ç¬¬nä¸ªä½ç½®ç›´åˆ°å­—ç¬¦ä¸²ç»“æŸã€‚\né‡å¤å åŠ  repeatæ–¹æ³•è¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå°†åŸå­—ç¬¦ä¸²é‡å¤næ¬¡ã€‚\n\u0026#39;x\u0026#39;.repeat(3) // \u0026#34;xxx\u0026#34; \u0026#39;hello\u0026#39;.repeat(2) // \u0026#34;hellohello\u0026#34; \u0026#39;na\u0026#39;.repeat(0) // \u0026#34;\u0026#34; å‚æ•°å¦‚æœæ˜¯å°æ•°ï¼Œä¼šè¢«å–æ•´ã€‚\n\u0026#39;na\u0026#39;.repeat(2.9) // \u0026#34;nana\u0026#34; å¦‚æœrepeatçš„å‚æ•°æ˜¯è´Ÿæ•°æˆ–è€…Infinityï¼Œä¼šæŠ¥é”™ã€‚\n\u0026#39;na\u0026#39;.repeat(Infinity) // RangeError \u0026#39;na\u0026#39;.repeat(-1) // RangeError ä½†æ˜¯ï¼Œå¦‚æœå‚æ•°æ˜¯ 0 åˆ°-1 ä¹‹é—´çš„å°æ•°ï¼Œåˆ™ç­‰åŒäº 0ï¼Œè¿™æ˜¯å› ä¸ºä¼šå…ˆè¿›è¡Œå–æ•´è¿ç®—ã€‚0 åˆ°-1 ä¹‹é—´çš„å°æ•°ï¼Œå–æ•´ä»¥åç­‰äº-0ï¼Œrepeatè§†åŒä¸º 0ã€‚\n\u0026#39;na\u0026#39;.repeat(-0.9) // \u0026#34;\u0026#34; å‚æ•°NaNç­‰åŒäº 0ã€‚\n\u0026#39;na\u0026#39;.repeat(NaN) // \u0026#34;\u0026#34; å¦‚æœrepeatçš„å‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™ä¼šå…ˆè½¬æ¢æˆæ•°å­—ã€‚\n\u0026#39;na\u0026#39;.repeat(\u0026#39;na\u0026#39;) // \u0026#34;\u0026#34; \u0026#39;na\u0026#39;.repeat(\u0026#39;3\u0026#39;) // \u0026#34;nanana\u0026#34; é•¿åº¦è¡¥å…¨ padStart(), padEnd()\nES2017 å¼•å…¥äº†å­—ç¬¦ä¸²è¡¥å…¨é•¿åº¦çš„åŠŸèƒ½ã€‚å¦‚æœæŸä¸ªå­—ç¬¦ä¸²ä¸å¤ŸæŒ‡å®šé•¿åº¦ï¼Œä¼šåœ¨å¤´éƒ¨æˆ–å°¾éƒ¨è¡¥å…¨ã€‚padStart()ç”¨äºå¤´éƒ¨è¡¥å…¨ï¼ŒpadEnd()ç”¨äºå°¾éƒ¨è¡¥å…¨ã€‚\n\u0026#39;x\u0026#39;.padStart(5, \u0026#39;ab\u0026#39;) // \u0026#39;ababx\u0026#39; \u0026#39;x\u0026#39;.padStart(4, \u0026#39;ab\u0026#39;) // \u0026#39;abax\u0026#39; \u0026#39;x\u0026#39;.padEnd(5, \u0026#39;ab\u0026#39;) // \u0026#39;xabab\u0026#39; \u0026#39;x\u0026#39;.padEnd(4, \u0026#39;ab\u0026#39;) // \u0026#39;xaba\u0026#39; ä¸Šé¢ä»£ç ä¸­ï¼ŒpadStart()å’ŒpadEnd()ä¸€å…±æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²è¡¥å…¨ç”Ÿæ•ˆçš„æœ€å¤§é•¿åº¦ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨æ¥è¡¥å…¨çš„å­—ç¬¦ä¸²ã€‚\nå¦‚æœåŸå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œç­‰äºæˆ–å¤§äºæœ€å¤§é•¿åº¦ï¼Œåˆ™å­—ç¬¦ä¸²è¡¥å…¨ä¸ç”Ÿæ•ˆï¼Œè¿”å›åŸå­—ç¬¦ä¸²ã€‚\n\u0026#39;xxx\u0026#39;.padStart(2, \u0026#39;ab\u0026#39;) // \u0026#39;xxx\u0026#39; \u0026#39;xxx\u0026#39;.padEnd(2, \u0026#39;ab\u0026#39;) // \u0026#39;xxx\u0026#39; å¦‚æœç”¨æ¥è¡¥å…¨çš„å­—ç¬¦ä¸²ä¸åŸå­—ç¬¦ä¸²ï¼Œä¸¤è€…çš„é•¿åº¦ä¹‹å’Œè¶…è¿‡äº†æœ€å¤§é•¿åº¦ï¼Œåˆ™ä¼šæˆªå»è¶…å‡ºä½æ•°çš„è¡¥å…¨å­—ç¬¦ä¸²ã€‚\n\u0026#39;abc\u0026#39;.padStart(10, \u0026#39;0123456789\u0026#39;) // \u0026#39;0123456abc\u0026#39; å¦‚æœçœç•¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œé»˜è®¤ä½¿ç”¨ç©ºæ ¼è¡¥å…¨é•¿åº¦ã€‚\n\u0026#39;x\u0026#39;.padStart(4) // \u0026#39; x\u0026#39; \u0026#39;x\u0026#39;.padEnd(4) // \u0026#39;x \u0026#39; padStart()çš„å¸¸è§ç”¨é€”æ˜¯ä¸ºæ•°å€¼è¡¥å…¨æŒ‡å®šä½æ•°ã€‚ä¸‹é¢ä»£ç ç”Ÿæˆ 10 ä½çš„æ•°å€¼å­—ç¬¦ä¸²ã€‚\n\u0026#39;1\u0026#39;.padStart(10, \u0026#39;0\u0026#39;) // \u0026#34;0000000001\u0026#34; \u0026#39;12\u0026#39;.padStart(10, \u0026#39;0\u0026#39;) // \u0026#34;0000000012\u0026#34; \u0026#39;123456\u0026#39;.padStart(10, \u0026#39;0\u0026#39;) // \u0026#34;0000123456\u0026#34; å¦ä¸€ä¸ªç”¨é€”æ˜¯æç¤ºå­—ç¬¦ä¸²æ ¼å¼ã€‚\n\u0026#39;12\u0026#39;.padStart(10, \u0026#39;YYYY-MM-DD\u0026#39;) // \u0026#34;YYYY-MM-12\u0026#34; \u0026#39;09-12\u0026#39;.padStart(10, \u0026#39;YYYY-MM-DD\u0026#39;) // \u0026#34;YYYY-09-12\u0026#34; ç©ºæ ¼æ¶ˆé™¤ trimStart(), trimEnd()\nES2019 å¯¹å­—ç¬¦ä¸²å®ä¾‹æ–°å¢äº†trimStart()å’ŒtrimEnd()è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚å®ƒä»¬çš„è¡Œä¸ºä¸trim()ä¸€è‡´ï¼ŒtrimStart()æ¶ˆé™¤å­—ç¬¦ä¸²å¤´éƒ¨çš„ç©ºæ ¼ï¼ŒtrimEnd()æ¶ˆé™¤å°¾éƒ¨çš„ç©ºæ ¼ã€‚å®ƒä»¬è¿”å›çš„éƒ½æ˜¯æ–°å­—ç¬¦ä¸²ï¼Œä¸ä¼šä¿®æ”¹åŸå§‹å­—ç¬¦ä¸²ã€‚\nconst s = \u0026#39; abc \u0026#39;; s.trim() // \u0026#34;abc\u0026#34; s.trimStart() // \u0026#34;abc \u0026#34; s.trimEnd() // \u0026#34; abc\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼ŒtrimStart()åªæ¶ˆé™¤å¤´éƒ¨çš„ç©ºæ ¼ï¼Œä¿ç•™å°¾éƒ¨çš„ç©ºæ ¼ã€‚trimEnd()ä¹Ÿæ˜¯ç±»ä¼¼è¡Œä¸ºã€‚\né™¤äº†ç©ºæ ¼é”®ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•å¯¹å­—ç¬¦ä¸²å¤´éƒ¨ï¼ˆæˆ–å°¾éƒ¨ï¼‰çš„ tab é”®ã€æ¢è¡Œç¬¦ç­‰ä¸å¯è§çš„ç©ºç™½ç¬¦å·ä¹Ÿæœ‰æ•ˆã€‚\næµè§ˆå™¨è¿˜éƒ¨ç½²äº†é¢å¤–çš„ä¸¤ä¸ªæ–¹æ³•ï¼ŒtrimLeft()æ˜¯trimStart()çš„åˆ«åï¼ŒtrimRight()æ˜¯trimEnd()çš„åˆ«åã€‚\næ­£åˆ™åŒ¹é… matchAll() matchAll() æ–¹æ³•è¿”å›ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åœ¨å½“å‰å­—ç¬¦ä¸²çš„æ‰€æœ‰åŒ¹é…ï¼Œè¯¦è§ã€Šæ­£åˆ™çš„æ‰©å±•ã€‹çš„ä¸€ç« ã€‚\nreplaceAll() å†å²ä¸Šï¼Œå­—ç¬¦ä¸²çš„å®ä¾‹æ–¹æ³•replace()åªèƒ½æ›¿æ¢ç¬¬ä¸€ä¸ªåŒ¹é…ã€‚\n\u0026#39;aabbcc\u0026#39;.replace(\u0026#39;b\u0026#39;, \u0026#39;_\u0026#39;) // \u0026#39;aa_bcc\u0026#39; ä¸Šé¢ä¾‹å­ä¸­ï¼Œreplace()åªå°†ç¬¬ä¸€ä¸ªbæ›¿æ¢æˆäº†ä¸‹åˆ’çº¿ã€‚\nå¦‚æœè¦æ›¿æ¢æ‰€æœ‰çš„åŒ¹é…ï¼Œä¸å¾—ä¸ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„gä¿®é¥°ç¬¦ã€‚\n\u0026#39;aabbcc\u0026#39;.replace(/b/g, \u0026#39;_\u0026#39;) // \u0026#39;aa__cc\u0026#39; æ­£åˆ™è¡¨è¾¾å¼æ¯•ç«Ÿä¸æ˜¯é‚£ä¹ˆæ–¹ä¾¿å’Œç›´è§‚ï¼ŒES2021 å¼•å…¥äº†replaceAll()æ–¹æ³•ï¼Œå¯ä»¥ä¸€æ¬¡æ€§æ›¿æ¢æ‰€æœ‰åŒ¹é…ã€‚\n\u0026#39;aabbcc\u0026#39;.replaceAll(\u0026#39;b\u0026#39;, \u0026#39;_\u0026#39;) // \u0026#39;aa__cc\u0026#39; å®ƒçš„ç”¨æ³•ä¸replace()ç›¸åŒï¼Œè¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œä¸ä¼šæ”¹å˜åŸå­—ç¬¦ä¸²ã€‚\nString.prototype.replaceAll(searchValue, replacement) ä¸Šé¢ä»£ç ä¸­ï¼ŒsearchValueæ˜¯æœç´¢æ¨¡å¼ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå…¨å±€çš„æ­£åˆ™è¡¨è¾¾å¼ï¼ˆå¸¦æœ‰gä¿®é¥°ç¬¦ï¼‰ã€‚\nå¦‚æœsearchValueæ˜¯ä¸€ä¸ªä¸å¸¦æœ‰gä¿®é¥°ç¬¦çš„æ­£åˆ™è¡¨è¾¾å¼ï¼ŒreplaceAll()ä¼šæŠ¥é”™ã€‚è¿™ä¸€ç‚¹è·Ÿreplace()ä¸åŒã€‚\n// ä¸æŠ¥é”™ \u0026#39;aabbcc\u0026#39;.replace(/b/, \u0026#39;_\u0026#39;) // æŠ¥é”™ \u0026#39;aabbcc\u0026#39;.replaceAll(/b/, \u0026#39;_\u0026#39;) ä¸Šé¢ä¾‹å­ä¸­ï¼Œ/b/ä¸å¸¦æœ‰gä¿®é¥°ç¬¦ï¼Œä¼šå¯¼è‡´replaceAll()æŠ¥é”™ã€‚\nreplaceAll()çš„ç¬¬äºŒä¸ªå‚æ•°replacementæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ›¿æ¢çš„æ–‡æœ¬ï¼Œå…¶ä¸­å¯ä»¥ä½¿ç”¨ä¸€äº›ç‰¹æ®Šå­—ç¬¦ä¸²ã€‚\n$\u0026amp;ï¼šåŒ¹é…çš„å­å­—ç¬¦ä¸²ã€‚ $ `ï¼šåŒ¹é…ç»“æœå‰é¢çš„æ–‡æœ¬ã€‚ $'ï¼šåŒ¹é…ç»“æœåé¢çš„æ–‡æœ¬ã€‚ $nï¼šåŒ¹é…æˆåŠŸçš„ç¬¬nç»„å†…å®¹ï¼Œnæ˜¯ä»1å¼€å§‹çš„è‡ªç„¶æ•°ã€‚è¿™ä¸ªå‚æ•°ç”Ÿæ•ˆçš„å‰ææ˜¯ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚ $$ï¼šæŒ‡ä»£ç¾å…ƒç¬¦å·$ã€‚ ä¸‹é¢æ˜¯ä¸€äº›ä¾‹å­ã€‚\n// $\u0026amp; è¡¨ç¤ºåŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œå³`b`æœ¬èº« // æ‰€ä»¥è¿”å›ç»“æœä¸åŸå­—ç¬¦ä¸²ä¸€è‡´ \u0026#39;abbc\u0026#39;.replaceAll(\u0026#39;b\u0026#39;, \u0026#39;$\u0026amp;\u0026#39;) // \u0026#39;abbc\u0026#39; // $` è¡¨ç¤ºåŒ¹é…ç»“æœä¹‹å‰çš„å­—ç¬¦ä¸² // å¯¹äºç¬¬ä¸€ä¸ª`b`ï¼Œ$` æŒ‡ä»£`a` // å¯¹äºç¬¬äºŒä¸ª`b`ï¼Œ$` æŒ‡ä»£`ab` \u0026#39;abbc\u0026#39;.replaceAll(\u0026#39;b\u0026#39;, \u0026#39;$`\u0026#39;) // \u0026#39;aaabc\u0026#39; // $\u0026#39; è¡¨ç¤ºåŒ¹é…ç»“æœä¹‹åçš„å­—ç¬¦ä¸² // å¯¹äºç¬¬ä¸€ä¸ª`b`ï¼Œ$\u0026#39; æŒ‡ä»£`bc` // å¯¹äºç¬¬äºŒä¸ª`b`ï¼Œ$\u0026#39; æŒ‡ä»£`c` \u0026#39;abbc\u0026#39;.replaceAll(\u0026#39;b\u0026#39;, `$\u0026#39;`) // \u0026#39;abccc\u0026#39; // $1 è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼çš„ç¬¬ä¸€ä¸ªç»„åŒ¹é…ï¼ŒæŒ‡ä»£`ab` // $2 è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼çš„ç¬¬äºŒä¸ªç»„åŒ¹é…ï¼ŒæŒ‡ä»£`bc` \u0026#39;abbc\u0026#39;.replaceAll(/(ab)(bc)/g, \u0026#39;$2$1\u0026#39;) // \u0026#39;bcab\u0026#39; // $$ æŒ‡ä»£ $ \u0026#39;abc\u0026#39;.replaceAll(\u0026#39;b\u0026#39;, \u0026#39;$$\u0026#39;) // \u0026#39;a$c\u0026#39; replaceAll()çš„ç¬¬äºŒä¸ªå‚æ•°replacementé™¤äº†ä¸ºå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°çš„è¿”å›å€¼å°†æ›¿æ¢æ‰ç¬¬ä¸€ä¸ªå‚æ•°searchValueåŒ¹é…çš„æ–‡æœ¬ã€‚\n\u0026#39;aabbcc\u0026#39;.replaceAll(\u0026#39;b\u0026#39;, () =\u0026gt; \u0026#39;_\u0026#39;) // \u0026#39;aa__cc\u0026#39; ä¸Šé¢ä¾‹å­ä¸­ï¼ŒreplaceAll()çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°çš„è¿”å›å€¼ä¼šæ›¿æ¢æ‰æ‰€æœ‰bçš„åŒ¹é…ã€‚\nè¿™ä¸ªæ›¿æ¢å‡½æ•°å¯ä»¥æ¥å—å¤šä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•æ‰åˆ°çš„åŒ¹é…å†…å®¹ï¼Œç¬¬äºŒä¸ªå‚æ•°æ•æ‰åˆ°æ˜¯ç»„åŒ¹é…ï¼ˆæœ‰å¤šå°‘ä¸ªç»„åŒ¹é…ï¼Œå°±æœ‰å¤šå°‘ä¸ªå¯¹åº”çš„å‚æ•°ï¼‰ã€‚æ­¤å¤–ï¼Œæœ€åè¿˜å¯ä»¥æ·»åŠ ä¸¤ä¸ªå‚æ•°ï¼Œå€’æ•°ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ•æ‰åˆ°çš„å†…å®¹åœ¨æ•´ä¸ªå­—ç¬¦ä¸²ä¸­çš„ä½ç½®ï¼Œæœ€åä¸€ä¸ªå‚æ•°æ˜¯åŸå­—ç¬¦ä¸²ã€‚\nconst str = \u0026#39;123abc456\u0026#39;; const regex = /(\\d+)([a-z]+)(\\d+)/g; function replacer(match, p1, p2, p3, offset, string) { return [p1, p2, p3].join(\u0026#39; - \u0026#39;); } str.replaceAll(regex, replacer) // 123 - abc - 456 ä¸Šé¢ä¾‹å­ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼æœ‰ä¸‰ä¸ªç»„åŒ¹é…ï¼Œæ‰€ä»¥replacer()å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°matchæ˜¯æ•æ‰åˆ°çš„åŒ¹é…å†…å®¹ï¼ˆå³å­—ç¬¦ä¸²123abc456ï¼‰ï¼Œåé¢ä¸‰ä¸ªå‚æ•°p1ã€p2ã€p3åˆ™ä¾æ¬¡ä¸ºä¸‰ä¸ªç»„åŒ¹é…ã€‚\nUnicode :link: Href [W3C](01 W3C.md#unicode) Unicode è§„èŒƒ\nè¡¨ç¤º ES6 åŠ å¼ºäº†å¯¹ Unicode çš„æ”¯æŒï¼Œå…è®¸é‡‡ç”¨ \\uxxxx å½¢å¼è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­ xxxx è¡¨ç¤ºå­—ç¬¦çš„ Unicode ç ç‚¹ï¼Œå•ä½ä¸º 16 è¿›åˆ¶ã€‚\nä½†æ˜¯ï¼Œè¿™ç§è¡¨ç¤ºæ³•åªé™äºç ç‚¹åœ¨ \\u0000~\\uFFFF ä¹‹é—´çš„å­—ç¬¦ã€‚è¶…å‡ºè¿™ä¸ªèŒƒå›´çš„å­—ç¬¦ï¼Œå¿…é¡»ç”¨ ä¸¤ä¸ªåŒå­—èŠ‚ çš„å½¢å¼è¡¨ç¤ºã€‚\n:page_with_curl: Example\n\u0026#34;\\uD842\\uDFB7\u0026#34; // \u0026#34;ğ ®·\u0026#34; \u0026#34;\\u20BB7\u0026#34; // \u0026#34; 7\u0026#34; ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœç›´æ¥åœ¨ \\u åé¢è·Ÿä¸Šè¶…è¿‡ 0xFFFF çš„æ•°å€¼ï¼ˆæ¯” å¦‚\\u20BB7 ï¼‰ï¼ŒJavaScript ä¼šç†è§£æˆ \\u20BB+7 ã€‚ç”±äº \\u20BB æ˜¯ä¸€ä¸ªä¸å¯æ‰“å°å­—ç¬¦ï¼Œæ‰€ä»¥åªä¼šæ˜¾ç¤ºä¸€ä¸ªç©ºæ ¼ï¼Œåé¢è·Ÿç€ä¸€ä¸ª 7 ã€‚\nES6 å¯¹è¿™ä¸€ç‚¹åšå‡ºäº†æ”¹è¿›ï¼Œåªè¦å°†ç ç‚¹æ”¾å…¥ å¤§æ‹¬å·{} ï¼Œå°±èƒ½æ­£ç¡®è§£è¯»è¯¥å­—ç¬¦ã€‚\n\u0026#34;\\u{20BB7}\u0026#34; // \u0026#34;ğ ®·\u0026#34; \u0026#34;\\u{41}\\u{42}\\u{43}\u0026#34; // \u0026#34;ABC\u0026#34; let hello = 123; hell\\u{6F} // 123 \u0026#39;\\u{1F680}\u0026#39; === \u0026#39;\\uD83D\\uDE80\u0026#39; // true ä¸Šé¢ä»£ç ä¸­ï¼Œæœ€åä¸€ä¸ªä¾‹å­è¡¨æ˜ï¼Œå¤§æ‹¬å·è¡¨ç¤ºæ³•ä¸å››å­—èŠ‚çš„ UTF-16 ç¼–ç æ˜¯ç­‰ä»·çš„ã€‚\næœ‰äº†è¿™ç§è¡¨ç¤ºæ³•ä¹‹åï¼ŒJavaScript å…±æœ‰ 6 ç§æ–¹æ³•å¯ä»¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ã€‚\n\u0026#39;\\z\u0026#39; === \u0026#39;z\u0026#39; // true \u0026#39;\\172\u0026#39; === \u0026#39;z\u0026#39; // true \u0026#39;\\x7A\u0026#39; === \u0026#39;z\u0026#39; // true \u0026#39;\\u007A\u0026#39; === \u0026#39;z\u0026#39; // true \u0026#39;\\u{7A}\u0026#39; === \u0026#39;z\u0026#39; // true :memo: Note JavaScript å­—ç¬¦ä¸²å…è®¸ç›´æ¥è¾“å…¥å­—ç¬¦ï¼Œä»¥åŠè¾“å…¥å­—ç¬¦çš„è½¬ä¹‰å½¢å¼ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œä¸­ çš„ Unicode ç ç‚¹æ˜¯ U+4e2dï¼Œä½ å¯ä»¥ç›´æ¥åœ¨å­—ç¬¦ä¸²é‡Œé¢è¾“å…¥è¿™ä¸ªæ±‰å­—ï¼Œä¹Ÿå¯ä»¥è¾“å…¥å®ƒçš„è½¬ä¹‰å½¢å¼\\u4e2dï¼Œä¸¤è€…æ˜¯ç­‰ä»·çš„ã€‚\n\u0026#39;ä¸­\u0026#39; === \u0026#39;\\u4e2d\u0026#39; // true ä½†æ˜¯ï¼ŒJavaScript è§„å®šæœ‰5ä¸ªå­—ç¬¦ï¼Œä¸èƒ½åœ¨å­—ç¬¦ä¸²é‡Œé¢ç›´æ¥ä½¿ç”¨ï¼Œåªèƒ½ä½¿ç”¨è½¬ä¹‰å½¢å¼ã€‚\nU+005Cï¼šåæ–œæ ï¼ˆreverse solidus) U+000Dï¼šå›è½¦ï¼ˆcarriage returnï¼‰ U+2028ï¼šè¡Œåˆ†éš”ç¬¦ï¼ˆline separatorï¼‰ U+2029ï¼šæ®µåˆ†éš”ç¬¦ï¼ˆparagraph separatorï¼‰ U+000Aï¼šæ¢è¡Œç¬¦ï¼ˆline feedï¼‰ ä¸¾ä¾‹æ¥è¯´ï¼Œå­—ç¬¦ä¸²é‡Œé¢ä¸èƒ½ç›´æ¥åŒ…å«åæ–œæ ï¼Œä¸€å®šè¦ è½¬ä¹‰ å†™æˆ\\\\æˆ–è€…\\u005cã€‚\nè¿™ä¸ªè§„å®šæœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œéº»çƒ¦åœ¨äº JSON æ ¼å¼å…è®¸å­—ç¬¦ä¸²é‡Œé¢ç›´æ¥ä½¿ç”¨ U+2028ï¼ˆè¡Œåˆ†éš”ç¬¦ï¼‰å’Œ U+2029ï¼ˆæ®µåˆ†éš”ç¬¦ï¼‰ã€‚è¿™æ ·ä¸€æ¥ï¼ŒæœåŠ¡å™¨è¾“å‡ºçš„ JSON è¢«JSON.parseè§£æï¼Œå°±æœ‰å¯èƒ½ç›´æ¥æŠ¥é”™ã€‚\nconst json = \u0026#39;\u0026#34;\\u2028\u0026#34;\u0026#39;; JSON.parse(json); // å¯èƒ½æŠ¥é”™ JSON æ ¼å¼å·²ç»å†»ç»“ï¼ˆRFC 7159ï¼‰ï¼Œæ²¡æ³•ä¿®æ”¹äº†ã€‚ä¸ºäº†æ¶ˆé™¤è¿™ä¸ªæŠ¥é”™ï¼ŒES2019 å…è®¸ JavaScript å­—ç¬¦ä¸²ç›´æ¥è¾“å…¥ U+2028ï¼ˆè¡Œåˆ†éš”ç¬¦ï¼‰å’Œ U+2029ï¼ˆæ®µåˆ†éš”ç¬¦ï¼‰ã€‚\nconst PS = eval(\u0026#34;\u0026#39;\\u2029\u0026#39;\u0026#34;); æ ¹æ®è¿™ä¸ªææ¡ˆï¼Œä¸Šé¢çš„ä»£ç ä¸ä¼šæŠ¥é”™ã€‚\næ³¨æ„ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²ç°åœ¨å°±å…è®¸ ç›´æ¥è¾“å…¥ è¿™ä¸¤ä¸ªå­—ç¬¦ã€‚å¦å¤–ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¾ç„¶ä¸å…è®¸ç›´æ¥è¾“å…¥è¿™ä¸¤ä¸ªå­—ç¬¦ï¼Œè¿™æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå› ä¸º JSON æœ¬æ¥å°±ä¸å…è®¸ç›´æ¥åŒ…å«æ­£åˆ™è¡¨è¾¾å¼ã€‚\n:memo: Note JSON.stringify() çš„æ”¹é€ \næ ¹æ®æ ‡å‡†ï¼ŒJSON æ•°æ®å¿…é¡»æ˜¯ UTF-8 ç¼–ç ã€‚ä½†æ˜¯ï¼Œç°åœ¨çš„JSON.stringify()æ–¹æ³•æœ‰å¯èƒ½è¿”å›ä¸ç¬¦åˆ UTF-8 æ ‡å‡†çš„å­—ç¬¦ä¸²ã€‚\nå…·ä½“æ¥è¯´ï¼ŒUTF-8 æ ‡å‡†è§„å®šï¼Œ0xD800 åˆ° 0xDFFF ä¹‹é—´çš„ç ç‚¹ï¼Œä¸èƒ½å•ç‹¬ä½¿ç”¨ï¼Œå¿…é¡»é…å¯¹ä½¿ç”¨ã€‚æ¯”å¦‚ï¼Œ\\uD834\\uDF06 æ˜¯ä¸¤ä¸ªç ç‚¹ï¼Œä½†æ˜¯å¿…é¡»æ”¾åœ¨ä¸€èµ·é…å¯¹ä½¿ç”¨ï¼Œä»£è¡¨å­—ç¬¦ ğŒ† ã€‚è¿™æ˜¯ä¸ºäº†è¡¨ç¤ºç ç‚¹å¤§äº 0xFFFF çš„å­—ç¬¦çš„ä¸€ç§å˜é€šæ–¹æ³•ã€‚å•ç‹¬ä½¿ç”¨\\uD834å’Œ\\uDFO6è¿™ä¸¤ä¸ªç ç‚¹æ˜¯ä¸åˆæ³•çš„ï¼Œæˆ–è€…é¢ å€’é¡ºåºä¹Ÿä¸è¡Œï¼Œå› ä¸º\\uDF06\\uD834å¹¶æ²¡æœ‰å¯¹åº”çš„å­—ç¬¦ã€‚\nJSON.stringify()çš„é—®é¢˜åœ¨äºï¼Œå®ƒå¯èƒ½è¿”å› 0xD800 åˆ° 0xDFFF ä¹‹é—´çš„å•ä¸ªç ç‚¹ã€‚\nJSON.stringify(\u0026#39;\\u{D834}\u0026#39;) // \u0026#34;\\u{D834}\u0026#34; ä¸ºäº†ç¡®ä¿è¿”å›çš„æ˜¯åˆæ³•çš„ UTF-8 å­—ç¬¦ï¼ŒES2019 æ”¹å˜äº†JSON.stringify()çš„è¡Œä¸ºã€‚å¦‚æœé‡åˆ° 0xD800 åˆ° 0xDFFF ä¹‹é—´çš„å•ä¸ªç ç‚¹ï¼Œæˆ–è€…ä¸å­˜åœ¨çš„é…å¯¹å½¢å¼ï¼Œå®ƒä¼šè¿”å›è½¬ä¹‰å­—ç¬¦ä¸²ï¼Œç•™ç»™åº”ç”¨è‡ªå·±å†³å®šä¸‹ä¸€æ­¥çš„å¤„ç†ã€‚\nJSON.stringify(\u0026#39;\\u{D834}\u0026#39;) // \u0026#34;\u0026#34;\\\\uD834\u0026#34;\u0026#34; JSON.stringify(\u0026#39;\\uDF06\\uD834\u0026#39;) // \u0026#34;\u0026#34;\\\\udf06\\\\ud834\u0026#34;\u0026#34; éå† ES6 ä¸ºå­—ç¬¦ä¸²æ·»åŠ äº† éå†å™¨ æ¥å£ï¼Œä½¿å¾—å­—ç¬¦ä¸²å¯ä»¥è¢« for...of å¾ªç¯éå†ã€‚\nfor (let codePoint of \u0026#39;foo\u0026#39;) { console.log(codePoint) } // \u0026#34;f\u0026#34; // \u0026#34;o\u0026#34; // \u0026#34;o\u0026#34; é™¤äº†éå†å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªéå†å™¨æœ€å¤§çš„ä¼˜ç‚¹æ˜¯å¯ä»¥è¯†åˆ«å¤§äº 0xFFFF çš„ç ç‚¹ï¼Œä¼ ç»Ÿçš„ for å¾ªç¯æ— æ³•è¯†åˆ«è¿™æ ·çš„ç ç‚¹ã€‚\nlet text = String.fromCodePoint(0x20BB7); for (let i = 0; i \u0026lt; text.length; i++) { console.log(text[i]); } // \u0026#34;ï¿½\u0026#34; ä»¥0xFFFFä¸ºå•ä½è¢«æ‹†åˆ† // \u0026#34;ï¿½\u0026#34; for (let i of text) { console.log(i); } // \u0026#34;ğ ®·\u0026#34; æ¨¡ç‰ˆå­—ç¬¦ä¸² è¢«ä¸€å¯¹åå¼•å·åŒ…è£¹ï¼š\næ™®é€šå­—ç¬¦ä¸²ï¼š\n\u0026#39;å­—ç¬¦ä¸²\u0026#39; \u0026#34;å­—ç¬¦ä¸²\u0026#34; æ¨¡æ¿å­—ç¬¦ä¸²ï¼š\n`å­—ç¬¦ä¸²` æ–¹ä¾¿æ³¨å…¥ï¼Œä¸å†éœ€è¦ + è¿æ¥å­—ç¬¦ä¸²ï¼š\nconst info = `æˆ‘çš„åå­—æ˜¯ï¼š${person.name}ï¼Œæ€§åˆ«æ˜¯ï¼š${person.sex}ï¼Œä»Šå¹´ï¼š${person.age}å²`; æ¨¡æ¿å­—ç¬¦ä¸²ç”šè‡³è¿˜èƒ½åµŒå¥—ã€‚\nconst tmpl = addresses =\u0026gt; ` \u0026lt;table\u0026gt; ${addres.map(address =\u0026gt; ` \u0026lt;tr\u0026gt;\u0026lt;td\u0026gt;${address.first}\u0026lt;/td\u0026gt;\u0026lt;/tr\u0026gt; \u0026lt;tr\u0026gt;\u0026lt;td\u0026gt;${address.last}\u0026lt;/td\u0026gt;\u0026lt;/tr\u0026gt; `).join(\u0026#39;\u0026#39;)} \u0026lt;/table\u0026gt; `; ä¸Šé¢ä»£ç ä¸­ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²çš„å˜é‡ä¹‹ä¸­ï¼ŒåˆåµŒå…¥äº†å¦ä¸€ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ã€‚\nconst data = [ { first: \u0026#39;\u0026lt;Jane\u0026gt;\u0026#39;, last: \u0026#39;Bond\u0026#39; }, { first: \u0026#39;Lars\u0026#39;, last: \u0026#39;\u0026lt;Croft\u0026gt;\u0026#39; }, ]; console.log(tmpl(data)); // \u0026lt;table\u0026gt; // // \u0026lt;tr\u0026gt;\u0026lt;td\u0026gt;\u0026lt;Jane\u0026gt;\u0026lt;/td\u0026gt;\u0026lt;/tr\u0026gt; // \u0026lt;tr\u0026gt;\u0026lt;td\u0026gt;Bond\u0026lt;/td\u0026gt;\u0026lt;/tr\u0026gt; // // \u0026lt;tr\u0026gt;\u0026lt;td\u0026gt;Lars\u0026lt;/td\u0026gt;\u0026lt;/tr\u0026gt; // \u0026lt;tr\u0026gt;\u0026lt;td\u0026gt;\u0026lt;Croft\u0026gt;\u0026lt;/td\u0026gt;\u0026lt;/tr\u0026gt; // // \u0026lt;/table\u0026gt; ğŸ“ Note map() æ˜¯ JS çš„ä¸€ç§è‡ªå¸¦æ–¹æ³•ã€‚\nå¦‚æœéœ€è¦å¼•ç”¨æ¨¡æ¿å­—ç¬¦ä¸²æœ¬èº«ï¼Œåœ¨éœ€è¦æ—¶æ‰§è¡Œï¼Œå¯ä»¥å†™æˆå‡½æ•°ã€‚\nlet func = (name) =\u0026gt; `Hello ${name}!`; func(\u0026#39;Jack\u0026#39;) // \u0026#34;Hello Jack!\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²å†™æˆäº†ä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼ã€‚æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œå°±ç›¸å½“äºæ‰§è¡Œè¿™ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²äº†ã€‚\nğŸ“ Note\næ¨¡ç‰ˆå­—ç¬¦ä¸²ä¸­ï¼Œæ‰€æœ‰çš„ç©ºæ ¼ã€æ¢è¡Œå’Œç¼©è¿›éƒ½ä¼šè¢«ä¿å­˜\nåŒæ ·ä½¿ç”¨ \\ å¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰\næ¨¡æ¿å­—ç¬¦ä¸²çš„ ${} æ³¨å…¥å¯ä»¥å…¼å®¹å‡ ä¹æ‰€æœ‰çš„ å€¼ ï¼ŒåŒ…æ‹¬\næ¨¡æ¿å­—ç¬¦ä¸²ã€å­—ç¬¦ä¸²ã€æ•°å€¼ã€å¸ƒå°”å€¼ã€è¡¨è¾¾å¼ã€å‡½æ•°â€¦â€¦ï¼ˆåªè¦ç»“æœæ˜¯ä¸ª å€¼ å³å¯ï¼‰\nğŸ“ƒ Example æ¨¡æ¿ç¼–è¯‘\nä¸‹é¢ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªé€šè¿‡æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œç”Ÿæˆæ­£å¼æ¨¡æ¿çš„å®ä¾‹ã€‚\nlet template = ` \u0026lt;ul\u0026gt; \u0026lt;% for(let i=0; i \u0026lt; data.supplies.length; i++) { %\u0026gt; \u0026lt;li\u0026gt;\u0026lt;%= data.supplies[i] %\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;% } %\u0026gt; \u0026lt;/ul\u0026gt; `; ä¸Šé¢ä»£ç åœ¨æ¨¡æ¿å­—ç¬¦ä¸²ä¹‹ä¸­ï¼Œæ”¾ç½®äº†ä¸€ä¸ªå¸¸è§„æ¨¡æ¿ã€‚è¯¥æ¨¡æ¿ä½¿ç”¨ \u0026lt;%...%\u0026gt; æ”¾ç½® JavaScript ä»£ç ï¼Œä½¿ç”¨ \u0026lt;%= ... %\u0026gt; è¾“å‡º JavaScript è¡¨è¾¾å¼ã€‚\næ€ä¹ˆç¼–è¯‘è¿™ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²å‘¢ï¼Ÿ\nä¸€ç§æ€è·¯æ˜¯å°†å…¶è½¬æ¢ä¸º JavaScript è¡¨è¾¾å¼å­—ç¬¦ä¸²ã€‚\necho(\u0026#39;\u0026lt;ul\u0026gt;\u0026#39;); for(let i=0; i \u0026lt; data.supplies.length; i++) { echo(\u0026#39;\u0026lt;li\u0026gt;\u0026#39;); echo(data.supplies[i]); echo(\u0026#39;\u0026lt;/li\u0026gt;\u0026#39;); }; echo(\u0026#39;\u0026lt;/ul\u0026gt;\u0026#39;); è¿™ä¸ªè½¬æ¢ä½¿ç”¨ æ­£åˆ™è¡¨è¾¾å¼ å°±è¡Œäº†ã€‚\nlet evalExpr = /\u0026lt;%=(.+?)%\u0026gt;/g; let expr = /\u0026lt;%([\\s\\S]+?)%\u0026gt;/g; template = template .replace(evalExpr, \u0026#39;`); echo( $1 ); echo(`\u0026#39;) .replace(expr, \u0026#39;`); $1 echo(`\u0026#39;); template = \u0026#39;echo(`\u0026#39; + template + \u0026#39;`);\u0026#39;; ç„¶åï¼Œå°† template å°è£…åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢è¿”å›ï¼Œå°±å¯ä»¥äº†ã€‚\nlet script = `(function parse(data){ let output = \u0026#34;\u0026#34;; function echo(html){ output += html; } ${ template } return output; })`; return script; å°†ä¸Šé¢çš„å†…å®¹æ‹¼è£…æˆä¸€ä¸ªæ¨¡æ¿ç¼–è¯‘å‡½æ•°compileã€‚\nfunction compile(template) { const evalExpr = /\u0026lt;%=(.+?)%\u0026gt;/g; const expr = /\u0026lt;%([\\s\\S]+?)%\u0026gt;/g; template = template .replace(evalExpr, \u0026#39;`); echo( $1 ); echo(`\u0026#39;) .replace(expr, \u0026#39;`); $1 echo(`\u0026#39;); template = \u0026#39;echo(`\u0026#39; + template + \u0026#39;`);\u0026#39;; let script = `(function parse(data){ let output = \u0026#34;\u0026#34;; function echo(html){ output += html; } ${template} return output; })`; return script; } compile å‡½æ•°çš„ç”¨æ³•å¦‚ä¸‹ã€‚\nlet parse = eval(compile(template)); div.innerHTML = parse({supplies: [\u0026#34;broom\u0026#34;, \u0026#34;mop\u0026#34;, \u0026#34;cleaner\u0026#34;]}); // \u0026lt;ul\u0026gt; // \u0026lt;li\u0026gt;broom\u0026lt;/li\u0026gt; // \u0026lt;li\u0026gt;mop\u0026lt;/li\u0026gt; // \u0026lt;li\u0026gt;cleaner\u0026lt;/li\u0026gt; // \u0026lt;/ul\u0026gt; ğŸ“ Note eval() æ˜¯ JS çš„ä¸€ç§è‡ªå¸¦æ–¹æ³•ã€‚\næ ‡ç­¾æ¨¡ç‰ˆ æ¨¡æ¿å­—ç¬¦ä¸²çš„åŠŸèƒ½ï¼Œä¸ä»…ä»…æ˜¯ä¸Šé¢è¿™äº›ã€‚å®ƒå¯ä»¥ç´§è·Ÿåœ¨ä¸€ä¸ªå‡½æ•°ååé¢ï¼Œè¯¥å‡½æ•°å°†è¢«è°ƒç”¨æ¥å¤„ç†è¿™ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²ã€‚è¿™è¢«ç§°ä¸º æ ‡ç­¾æ¨¡æ¿ åŠŸèƒ½ï¼ˆtagged templateï¼‰ã€‚\nconsole.log`hello`; // ç­‰åŒäº console.log([\u0026#34;hello\u0026#34;]); æ ‡ç­¾æ¨¡æ¿å…¶å®ä¸æ˜¯æ¨¡æ¿ï¼Œè€Œæ˜¯å‡½æ•°è°ƒç”¨çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ã€‚æ ‡ç­¾ æŒ‡çš„å°±æ˜¯ å‡½æ•° ï¼Œç´§è·Ÿåœ¨åé¢çš„æ¨¡æ¿å­—ç¬¦ä¸²å°±æ˜¯å®ƒçš„ å‚æ•° ã€‚\nä½†æ˜¯ï¼Œå¦‚æœæ¨¡æ¿å­—ç¬¦é‡Œé¢æœ‰å˜é‡ï¼Œå°±ä¸æ˜¯ç®€å•çš„è°ƒç”¨äº†ï¼Œè€Œæ˜¯ä¼šå°†æ¨¡æ¿å­—ç¬¦ä¸²å…ˆå¤„ç†æˆ å¤šä¸ªå‚æ•° ï¼Œå†è°ƒç”¨å‡½æ•°ã€‚\nğŸ“ƒ Example\nlet a = 5; let b = 10; let tag = (..._) =\u0026gt; _; // å†™æˆ_=\u0026gt;_å°±åªèƒ½æ¥å—ç¬¬ä¸€ä¸ªå‚æ•° let res = tag`Hello ${a + b} world ${a * b}`; console.log( res); //[ [ \u0026#39;Hello \u0026#39;, \u0026#39; world \u0026#39;, \u0026#39;\u0026#39; ], 15, 50 ] // ç­‰åŒäº tag([\u0026#39;Hello \u0026#39;, \u0026#39; world \u0026#39;, \u0026#39;\u0026#39;], 15, 50); ä¸Šé¢ä»£ç ä¸­ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²å‰é¢æœ‰ä¸€ä¸ªæ ‡è¯†å tag ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚æ•´ä¸ªè¡¨è¾¾å¼çš„è¿”å›å€¼ï¼Œå°±æ˜¯ tag å‡½æ•°å¤„ç†æ¨¡æ¿å­—ç¬¦ä¸²åçš„è¿”å›å€¼ã€‚\nå‡½æ•° tag ä¾æ¬¡ä¼šæ¥æ”¶åˆ°å¤šä¸ªå‚æ•°ã€‚\nğŸ§ª Experimental ä¸€ä¸ªæ‹¼æ¥æ ‡ç­¾æ¨¡ç‰ˆçš„å‡½æ•°\nlet a = 5; let b = 10; let tag = (stringArgs, ...paramArgs) =\u0026gt; { let str = \u0026#34;\u0026#34;; stringArgs[0] \u0026amp;\u0026amp; (str += stringArgs[0]); for (let i = 0; i \u0026lt; paramArgs.length; i++) { str += paramArgs[i] + stringArgs[i+1]; } return str; }; let res = tag`Hello ${a + b} world ${a * b}`; console.log(res); // Hello 15 world 50 ğŸ“ƒ Example\nä¸‹é¢æ˜¯ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­ã€‚\nlet total = 30; let msg = passthru`The total is ${total} (${total*1.05} with tax)`; function passthru(literals) { let result = \u0026#39;\u0026#39;; let i = 0; while (i \u0026lt; literals.length) { result += literals[i++]; if (i \u0026lt; arguments.length) { result += arguments[i]; } } return result; } msg // \u0026#34;The total is 30 (31.5 with tax)\u0026#34; ä¸Šé¢è¿™ä¸ªä¾‹å­å±•ç¤ºäº†ï¼Œå¦‚ä½•å°†å„ä¸ªå‚æ•°æŒ‰ç…§åŸæ¥çš„ä½ç½®æ‹¼åˆå›å»ã€‚\npassthru å‡½æ•°é‡‡ç”¨ rest å‚æ•°...theArgs çš„å†™æ³•å¦‚ä¸‹ã€‚\nfunction passthru(literals, ...values) { let output = \u0026#34;\u0026#34;; let index; for (index = 0; index \u0026lt; values.length; index++) { output += literals[index] + values[index]; } output += literals[index]; return output; } æ ‡ç­¾æ¨¡ç‰ˆæœ‰å¤šç§åº”ç”¨æ–¹å¼ï¼š\nè¿‡æ»¤ HTML å­—ç¬¦ä¸² // è¿‡æ»¤ HTML å­—ç¬¦ä¸²ï¼Œé˜²æ­¢ç”¨æˆ·è¾“å…¥æ¶æ„å†…å®¹ let message = SaferHTML`\u0026lt;p\u0026gt;${sender} has sent you a message.\u0026lt;/p\u0026gt;`; function SaferHTML(templateData) { let s = templateData[0]; for (let i = 1; i \u0026lt; arguments.length; i++) { let arg = String(arguments[i]); // Escape special characters in the substitution. s += arg.replace(/\u0026amp;/g, \u0026#34;\u0026amp;amp;\u0026#34;) .replace(/\u0026lt;/g, \u0026#34;\u0026amp;lt;\u0026#34;) .replace(/\u0026gt;/g, \u0026#34;\u0026amp;gt;\u0026#34;); // Don\u0026#39;t escape special characters in the template. s += templateData[i]; } return s; } ä¸Šé¢ä»£ç ä¸­ï¼Œsender å˜é‡å¾€å¾€æ˜¯ç”¨æˆ·æä¾›çš„ï¼Œç»è¿‡ SaferHTML å‡½æ•°å¤„ç†ï¼Œé‡Œé¢çš„ç‰¹æ®Šå­—ç¬¦éƒ½ä¼šè¢«è½¬ä¹‰ã€‚\nlet sender = \u0026#39;\u0026lt;script\u0026gt;alert(\u0026#34;abc\u0026#34;)\u0026lt;/script\u0026gt;\u0026#39;; // æ¶æ„ä»£ç  let message = SaferHTML`\u0026lt;p\u0026gt;${sender} has sent you a message.\u0026lt;/p\u0026gt;`; console.log(message); // \u0026lt;p\u0026gt;\u0026amp;lt;script\u0026amp;gt;alert(\u0026#34;abc\u0026#34;)\u0026amp;lt;/script\u0026amp;gt; has sent you a message.\u0026lt;/p\u0026gt; å¤šè¯­è¨€è½¬æ¢ï¼ˆå›½é™…åŒ–å¤„ç†ï¼‰ã€‚\ni18n`Welcome to ${siteName}, you are visitor number ${visitorNumber}!` // \u0026#34;æ¬¢è¿è®¿é—®xxxï¼Œæ‚¨æ˜¯ç¬¬xxxxä½è®¿é—®è€…ï¼\u0026#34; æ¨¡æ¿å­—ç¬¦ä¸²æœ¬èº«å¹¶ä¸èƒ½å–ä»£ Mustache ä¹‹ç±»çš„æ¨¡æ¿åº“ï¼Œå› ä¸ºæ²¡æœ‰æ¡ä»¶åˆ¤æ–­å’Œå¾ªç¯å¤„ç†åŠŸèƒ½ï¼Œä½†æ˜¯é€šè¿‡æ ‡ç­¾å‡½æ•°ï¼Œä½ å¯ä»¥è‡ªå·±æ·»åŠ è¿™äº›åŠŸèƒ½ã€‚\n// ä¸‹é¢çš„hashTemplateå‡½æ•° // æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„æ¨¡æ¿å¤„ç†å‡½æ•° let libraryHtml = hashTemplate` \u0026lt;ul\u0026gt; #for book in ${myBooks} \u0026lt;li\u0026gt;\u0026lt;i\u0026gt;#{book.title}\u0026lt;/i\u0026gt; by #{book.author}\u0026lt;/li\u0026gt; #end \u0026lt;/ul\u0026gt; `; åµŒå…¥å…¶å®ƒè¯­è¨€ jsx` \u0026lt;div\u0026gt; \u0026lt;input ref=\u0026#39;input\u0026#39; onChange=\u0026#39;${this.handleChange}\u0026#39; defaultValue=\u0026#39;${this.state.value}\u0026#39; /\u0026gt; ${this.state.value} \u0026lt;/div\u0026gt; ` ä¸Šé¢çš„ä»£ç é€šè¿‡ jsx å‡½æ•°ï¼Œå°†ä¸€ä¸ª DOM å­—ç¬¦ä¸²è½¬ä¸º React å¯¹è±¡ã€‚ä½ å¯ä»¥åœ¨ GitHub æ‰¾åˆ° jsx å‡½æ•°çš„å…·ä½“å®ç°ã€‚\nä¸‹é¢åˆ™æ˜¯ä¸€ä¸ªå‡æƒ³çš„ä¾‹å­ï¼Œé€šè¿‡javaå‡½æ•°ï¼Œåœ¨ JavaScript ä»£ç ä¹‹ä¸­è¿è¡Œ Java ä»£ç ã€‚\njava` class HelloWorldApp { public static void main(String[] args) { System.out.println(\u0026#34;Hello World!\u0026#34;); // Display the string. } } ` HelloWorldApp.main(); æ¨¡æ¿å¤„ç†å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆæ¨¡æ¿å­—ç¬¦ä¸²æ•°ç»„ï¼‰ï¼Œè¿˜æœ‰ä¸€ä¸ªrawå±æ€§ã€‚\nconsole.log`123` // [\u0026#34;123\u0026#34;, raw: Array[1]] ä¸Šé¢ä»£ç ä¸­ï¼Œconsole.logæ¥å—çš„å‚æ•°ï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ªæ•°ç»„ã€‚è¯¥æ•°ç»„æœ‰ä¸€ä¸ªrawå±æ€§ï¼Œä¿å­˜çš„æ˜¯è½¬ä¹‰åçš„åŸå­—ç¬¦ä¸²ã€‚\nè¯·çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚\ntag`First line Second line` function tag(strings) { console.log(strings.raw[0]); // strings.raw[0] ä¸º \u0026#34;First line\\ Second line\u0026#34; // æ‰“å°è¾“å‡º \u0026#34;First line Second line\u0026#34; } ä¸Šé¢ä»£ç ä¸­ï¼Œtag å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•° stringsï¼Œæœ‰ä¸€ä¸ª raw å±æ€§ï¼Œä¹ŸæŒ‡å‘ä¸€ä¸ªæ•°ç»„ã€‚è¯¥æ•°ç»„çš„æˆå‘˜ä¸ strings æ•°ç»„å®Œå…¨ä¸€è‡´ã€‚æ¯”å¦‚ï¼Œstrings æ•°ç»„æ˜¯ [\u0026quot;First line Second line\u0026quot;] ï¼Œé‚£ä¹ˆ strings.raw æ•°ç»„å°±æ˜¯ [\u0026quot;First line\\ Second line\u0026quot;] ã€‚ä¸¤è€…å”¯ä¸€çš„åŒºåˆ«ï¼Œå°±æ˜¯å­—ç¬¦ä¸²é‡Œé¢çš„æ–œæ éƒ½è¢«è½¬ä¹‰äº†ã€‚æ¯”å¦‚ï¼Œstrings.raw æ•°ç»„ä¼šå°† è§†ä¸º \\\\ å’Œ n ä¸¤ä¸ªå­—ç¬¦ï¼Œè€Œä¸æ˜¯æ¢è¡Œç¬¦ã€‚è¿™æ˜¯ä¸ºäº†æ–¹ä¾¿å–å¾—è½¬ä¹‰ä¹‹å‰çš„åŸå§‹æ¨¡æ¿è€Œè®¾è®¡çš„ã€‚\né™åˆ¶ å‰é¢æåˆ°æ ‡ç­¾æ¨¡æ¿é‡Œé¢ï¼Œå¯ä»¥å†…åµŒå…¶ä»–è¯­è¨€ã€‚ä½†æ˜¯ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²é»˜è®¤ä¼šå°†å­—ç¬¦ä¸²è½¬ä¹‰ï¼Œå¯¼è‡´æ— æ³•åµŒå…¥å…¶ä»–è¯­è¨€ã€‚\nä¸¾ä¾‹æ¥è¯´ï¼Œæ ‡ç­¾æ¨¡æ¿é‡Œé¢å¯ä»¥åµŒå…¥ LaTEX è¯­è¨€ã€‚\nfunction latex(strings) { // ... } let document = latex` ewcommand{\\fun}{\\textbf{Fun!}} // æ­£å¸¸å·¥ä½œ ewcommand{\\unicode}{\\textbf{Unicode!}} // æŠ¥é”™ ewcommand{\\xerxes}{\\textbf{King!}} // æŠ¥é”™ Breve over the h goes \\u{h}ere // æŠ¥é”™ ` ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡ document å†…åµŒçš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œå¯¹äº LaTEX è¯­è¨€æ¥è¯´å®Œå…¨æ˜¯åˆæ³•çš„ï¼Œä½†æ˜¯ JavaScript å¼•æ“ä¼šæŠ¥é”™ã€‚åŸå› å°±åœ¨äºå­—ç¬¦ä¸²çš„è½¬ä¹‰ã€‚\næ¨¡æ¿å­—ç¬¦ä¸²ä¼šå°† \\u00FF å’Œ \\u{42} å½“ä½œ Unicode å­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼Œæ‰€ä»¥\\unicode è§£ææ—¶æŠ¥é”™ï¼›è€Œ \\x56 ä¼šè¢«å½“ä½œåå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬ä¹‰ï¼Œæ‰€ä»¥\\xerxesä¼šæŠ¥é”™ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ\\u å’Œ \\x åœ¨ LaTEX é‡Œé¢æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œä½†æ˜¯ JavaScript å°†å®ƒä»¬è½¬ä¹‰äº†ã€‚\nä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒES2018 æ”¾æ¾äº†å¯¹æ ‡ç­¾æ¨¡æ¿é‡Œé¢çš„å­—ç¬¦ä¸²è½¬ä¹‰çš„é™åˆ¶ã€‚å¦‚æœé‡åˆ°ä¸åˆæ³•çš„å­—ç¬¦ä¸²è½¬ä¹‰ï¼Œå°±è¿”å› undefined ï¼Œè€Œä¸æ˜¯æŠ¥é”™ï¼Œå¹¶ä¸”ä» raw å±æ€§ä¸Šé¢å¯ä»¥å¾—åˆ°åŸå§‹å­—ç¬¦ä¸²ã€‚\nfunction tag(strs) { strs[0] === undefined strs.raw[0] === \u0026#34;\\\\unicode and \\\\u{55}\u0026#34;; } tag`\\unicode and \\u{55}` ä¸Šé¢ä»£ç ä¸­ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²åŸæœ¬æ˜¯åº”è¯¥æŠ¥é”™çš„ï¼Œä½†æ˜¯ç”±äºæ”¾æ¾äº†å¯¹å­—ç¬¦ä¸²è½¬ä¹‰çš„é™åˆ¶ï¼Œæ‰€ä»¥ä¸æŠ¥é”™äº†ï¼ŒJavaScript å¼•æ“å°†ç¬¬ä¸€ä¸ªå­—ç¬¦è®¾ç½®ä¸º undefined ï¼Œä½†æ˜¯rawå±æ€§ä¾ç„¶å¯ä»¥å¾—åˆ°åŸå§‹å­—ç¬¦ä¸²ï¼Œå› æ­¤ tag å‡½æ•°è¿˜æ˜¯å¯ä»¥å¯¹åŸå­—ç¬¦ä¸²è¿›è¡Œå¤„ç†ã€‚\næ³¨æ„ï¼Œè¿™ç§å¯¹å­—ç¬¦ä¸²è½¬ä¹‰çš„æ”¾æ¾ï¼Œåªåœ¨æ ‡ç­¾æ¨¡æ¿è§£æå­—ç¬¦ä¸²æ—¶ç”Ÿæ•ˆï¼Œä¸æ˜¯æ ‡ç­¾æ¨¡æ¿çš„åœºåˆï¼Œä¾ç„¶ä¼šæŠ¥é”™ã€‚\nlet bad = `bad escape sequence: \\unicode`; // æŠ¥é”™ æ­£åˆ™ :link: Href [ES5](05 JavaScript/#regexp-es5) æ­£åˆ™è¡¨è¾¾å¼\nåœ¨ ES5 ä¸­ï¼ŒRegExpæ„é€ å‡½æ•°çš„å‚æ•°æœ‰ä¸¤ç§æƒ…å†µã€‚\nç¬¬ä¸€ç§æƒ…å†µæ˜¯ï¼Œå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™æ—¶ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ï¼ˆflagï¼‰ã€‚\nvar regex = new RegExp(\u0026#39;xyz\u0026#39;, \u0026#39;i\u0026#39;); // ç­‰ä»·äº var regex = /xyz/i; ç¬¬äºŒç§æƒ…å†µæ˜¯ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨ç¤ºå¼ï¼Œè¿™æ—¶ä¼šè¿”å›ä¸€ä¸ªåŸæœ‰æ­£åˆ™è¡¨è¾¾å¼çš„æ‹·è´ã€‚\nvar regex = new RegExp(/xyz/i); // ç­‰ä»·äº var regex = /xyz/i; ä½†æ˜¯ï¼Œåœ¨ ES5 ä¸‹ä¸å…è®¸ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„æ—¶å€™ï¼Œä¸ºç¬¬äºŒä¸ªå‚æ•°æ·»åŠ ä¿®é¥°ç¬¦ã€‚\nvar regex = new RegExp(/xyz/, \u0026#39;i\u0026#39;); // Uncaught TypeError: Cannot supply flags when constructing one RegExp from another ES6 æ”¹å˜äº†è¿™ç§è¡Œä¸ºã€‚å¦‚æœRegExpæ„é€ å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ­£åˆ™å¯¹è±¡ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šä¿®é¥°ç¬¦ã€‚è€Œä¸”ï¼Œè¿”å›çš„æ­£åˆ™è¡¨è¾¾å¼ä¼šå¿½ç•¥åŸæœ‰çš„æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ï¼Œåªä½¿ç”¨æ–°æŒ‡å®šçš„ä¿®é¥°ç¬¦ã€‚\nnew RegExp(/abc/ig, \u0026#39;i\u0026#39;).flags // \u0026#34;i\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼ŒåŸæœ‰æ­£åˆ™å¯¹è±¡çš„ä¿®é¥°ç¬¦æ˜¯igï¼Œå®ƒä¼šè¢«ç¬¬äºŒä¸ªå‚æ•°iè¦†ç›–ã€‚\nå­—ç¬¦ä¸² å­—ç¬¦ä¸²å¯¹è±¡å…±æœ‰ 4 ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼šmatch()ã€replace()ã€search()å’Œsplit()ã€‚\nES6 å°†è¿™ 4 ä¸ªæ–¹æ³•ï¼Œåœ¨è¯­è¨€å†…éƒ¨å…¨éƒ¨è°ƒç”¨RegExpçš„å®ä¾‹æ–¹æ³•ï¼Œä»è€Œåšåˆ°æ‰€æœ‰ä¸æ­£åˆ™ç›¸å…³çš„æ–¹æ³•ï¼Œå…¨éƒ½å®šä¹‰åœ¨RegExpå¯¹è±¡ä¸Šã€‚\nString.prototype.match è°ƒç”¨ RegExp.prototype[Symbol.match] ``String.prototype.replaceè°ƒç”¨RegExp.prototype[Symbol.replace]` String.prototype.search è°ƒç”¨ RegExp.prototype[Symbol.search] String.prototype.split è°ƒç”¨ RegExp.prototype[Symbol.split] ä¿®é¥°ç¬¦ RegExp.prototype.flags å±æ€§\nES6 ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ–°å¢äº† flags å±æ€§ï¼Œä¼šè¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ã€‚\n// ES5 çš„ source å±æ€§ // è¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„æ­£æ–‡ /abc/ig.source // \u0026#34;abc\u0026#34; // ES6 çš„ flags å±æ€§ // è¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ /abc/ig.flags // \u0026#39;gi\u0026#39; u ä¿®é¥°ç¬¦ ES6 å¯¹æ­£åˆ™è¡¨è¾¾å¼æ·»åŠ äº†uä¿®é¥°ç¬¦ï¼Œå«ä¹‰ä¸ºâ€œUnicode æ¨¡å¼â€ï¼Œç”¨æ¥æ­£ç¡®å¤„ç†å¤§äº\\uFFFFçš„ Unicode å­—ç¬¦ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¼šæ­£ç¡®å¤„ç†å››ä¸ªå­—èŠ‚çš„ UTF-16 ç¼–ç ã€‚\n/^\\uD83D/u.test(\u0026#39;\\uD83D\\uDC2A\u0026#39;) // false /^\\uD83D/.test(\u0026#39;\\uD83D\\uDC2A\u0026#39;) // true ä¸Šé¢ä»£ç ä¸­ï¼Œ\\uD83D\\uDC2Aæ˜¯ä¸€ä¸ªå››ä¸ªå­—èŠ‚çš„ UTF-16 ç¼–ç ï¼Œä»£è¡¨ä¸€ä¸ªå­—ç¬¦ã€‚ä½†æ˜¯ï¼ŒES5 ä¸æ”¯æŒå››ä¸ªå­—èŠ‚çš„ UTF-16 ç¼–ç ï¼Œä¼šå°†å…¶è¯†åˆ«ä¸ºä¸¤ä¸ªå­—ç¬¦ï¼Œå¯¼è‡´ç¬¬äºŒè¡Œä»£ç ç»“æœä¸ºtrueã€‚åŠ äº†uä¿®é¥°ç¬¦ä»¥åï¼ŒES6 å°±ä¼šè¯†åˆ«å…¶ä¸ºä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ç¬¬ä¸€è¡Œä»£ç ç»“æœä¸ºfalseã€‚\nä¸€æ—¦åŠ ä¸Šuä¿®é¥°ç¬¦å·ï¼Œå°±ä¼šä¿®æ”¹ä¸‹é¢è¿™äº›æ­£åˆ™è¡¨è¾¾å¼çš„è¡Œä¸ºã€‚\nç‚¹å­—ç¬¦. ç‚¹ï¼ˆ.ï¼‰å­—ç¬¦åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œå«ä¹‰æ˜¯é™¤äº†æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦ã€‚å¯¹äºç ç‚¹å¤§äº0xFFFFçš„ Unicode å­—ç¬¦ï¼Œç‚¹å­—ç¬¦ä¸èƒ½è¯†åˆ«ï¼Œå¿…é¡»åŠ ä¸Šuä¿®é¥°ç¬¦ã€‚\nvar s = \u0026#39;ğ ®·\u0026#39;; /^.$/.test(s) // false /^.$/u.test(s) // true ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœä¸æ·»åŠ uä¿®é¥°ç¬¦ï¼Œæ­£åˆ™è¡¨è¾¾å¼å°±ä¼šè®¤ä¸ºå­—ç¬¦ä¸²ä¸ºä¸¤ä¸ªå­—ç¬¦ï¼Œä»è€ŒåŒ¹é…å¤±è´¥ã€‚\nUnicode å­—ç¬¦è¡¨ç¤ºæ³• ES6 æ–°å¢äº†ä½¿ç”¨å¤§æ‹¬å·è¡¨ç¤º Unicode å­—ç¬¦ï¼Œè¿™ç§è¡¨ç¤ºæ³•åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­å¿…é¡»åŠ ä¸Šuä¿®é¥°ç¬¦ï¼Œæ‰èƒ½è¯†åˆ«å½“ä¸­çš„å¤§æ‹¬å·ï¼Œå¦åˆ™ä¼šè¢«è§£è¯»ä¸ºé‡è¯ã€‚\n/\\u{61}/.test(\u0026#39;a\u0026#39;) // false /\\u{61}/u.test(\u0026#39;a\u0026#39;) // true /\\u{20BB7}/u.test(\u0026#39;ğ ®·\u0026#39;) // true ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœä¸åŠ uä¿®é¥°ç¬¦ï¼Œæ­£åˆ™è¡¨è¾¾å¼æ— æ³•è¯†åˆ«\\u{61}è¿™ç§è¡¨ç¤ºæ³•ï¼Œåªä¼šè®¤ä¸ºè¿™åŒ¹é… 61 ä¸ªè¿ç»­çš„uã€‚\né‡è¯ ä½¿ç”¨uä¿®é¥°ç¬¦åï¼Œæ‰€æœ‰é‡è¯éƒ½ä¼šæ­£ç¡®è¯†åˆ«ç ç‚¹å¤§äº0xFFFFçš„ Unicode å­—ç¬¦ã€‚\n/a{2}/.test(\u0026#39;aa\u0026#39;) // true /a{2}/u.test(\u0026#39;aa\u0026#39;) // true /ğ ®·{2}/.test(\u0026#39;ğ ®·ğ ®·\u0026#39;) // false /ğ ®·{2}/u.test(\u0026#39;ğ ®·ğ ®·\u0026#39;) // true é¢„å®šä¹‰æ¨¡å¼ uä¿®é¥°ç¬¦ä¹Ÿå½±å“åˆ°é¢„å®šä¹‰æ¨¡å¼ï¼Œèƒ½å¦æ­£ç¡®è¯†åˆ«ç ç‚¹å¤§äº0xFFFFçš„ Unicode å­—ç¬¦ã€‚\n/^\\S$/.test(\u0026#39;ğ ®·\u0026#39;) // false /^\\S$/u.test(\u0026#39;ğ ®·\u0026#39;) // true ä¸Šé¢ä»£ç çš„\\Sæ˜¯é¢„å®šä¹‰æ¨¡å¼ï¼ŒåŒ¹é…æ‰€æœ‰éç©ºç™½å­—ç¬¦ã€‚åªæœ‰åŠ äº†uä¿®é¥°ç¬¦ï¼Œå®ƒæ‰èƒ½æ­£ç¡®åŒ¹é…ç ç‚¹å¤§äº0xFFFFçš„ Unicode å­—ç¬¦ã€‚\nåˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œå¯ä»¥å†™å‡ºä¸€ä¸ªæ­£ç¡®è¿”å›å­—ç¬¦ä¸²é•¿åº¦çš„å‡½æ•°ã€‚\nfunction codePointLength(text) { var result = text.match(/[\\s\\S]/gu); return result ? result.length : 0; } var s = \u0026#39;ğ ®·ğ ®·\u0026#39;; s.length // 4 codePointLength(s) // 2 i ä¿®é¥°ç¬¦ æœ‰äº› Unicode å­—ç¬¦çš„ç¼–ç ä¸åŒï¼Œä½†æ˜¯å­—å‹å¾ˆç›¸è¿‘ï¼Œæ¯”å¦‚ï¼Œ\\u004Bä¸\\u212Aéƒ½æ˜¯å¤§å†™çš„Kã€‚\n/[a-z]/i.test(\u0026#39;\\u212A\u0026#39;) // false /[a-z]/iu.test(\u0026#39;\\u212A\u0026#39;) // true ä¸Šé¢ä»£ç ä¸­ï¼Œä¸åŠ uä¿®é¥°ç¬¦ï¼Œå°±æ— æ³•è¯†åˆ«éè§„èŒƒçš„Kå­—ç¬¦ã€‚\nè½¬ä¹‰ æ²¡æœ‰uä¿®é¥°ç¬¦çš„æƒ…å†µä¸‹ï¼Œæ­£åˆ™ä¸­æ²¡æœ‰å®šä¹‰çš„è½¬ä¹‰ï¼ˆå¦‚é€—å·çš„è½¬ä¹‰\\,ï¼‰æ— æ•ˆï¼Œè€Œåœ¨uæ¨¡å¼ä¼šæŠ¥é”™ã€‚\n/\\,/ // /\\,/ /\\,/u // æŠ¥é”™ ä¸Šé¢ä»£ç ä¸­ï¼Œæ²¡æœ‰uä¿®é¥°ç¬¦æ—¶ï¼Œé€—å·å‰é¢çš„åæ–œæ æ˜¯æ— æ•ˆçš„ï¼ŒåŠ äº†uä¿®é¥°ç¬¦å°±æŠ¥é”™ã€‚\nğŸ“ Note RegExp.prototype.unicode å±æ€§\næ­£åˆ™å®ä¾‹å¯¹è±¡æ–°å¢unicodeå±æ€§ï¼Œè¡¨ç¤ºæ˜¯å¦è®¾ç½®äº†uä¿®é¥°ç¬¦ã€‚\nconst r1 = /hello/; const r2 = /hello/u; r1.unicode // false r2.unicode // true ä¸Šé¢ä»£ç ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼æ˜¯å¦è®¾ç½®äº† u ä¿®é¥°ç¬¦ï¼Œå¯ä»¥ä» unicode å±æ€§çœ‹å‡ºæ¥ã€‚\ny ä¿®é¥°ç¬¦ é™¤äº†uä¿®é¥°ç¬¦ï¼ŒES6 è¿˜ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ·»åŠ äº†yä¿®é¥°ç¬¦ï¼Œå«åš ç²˜è¿sticky ä¿®é¥°ç¬¦ã€‚\ny ä¿®é¥°ç¬¦çš„ä½œç”¨ä¸ g ä¿®é¥°ç¬¦ç±»ä¼¼ï¼Œä¹Ÿæ˜¯å…¨å±€åŒ¹é…ï¼Œåä¸€æ¬¡åŒ¹é…éƒ½ä»ä¸Šä¸€æ¬¡åŒ¹é…æˆåŠŸçš„ä¸‹ä¸€ä¸ªä½ç½®å¼€å§‹ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œg ä¿®é¥°ç¬¦åªè¦å‰©ä½™ä½ç½®ä¸­å­˜åœ¨åŒ¹é…å°±å¯ï¼Œè€Œ y ä¿®é¥°ç¬¦ç¡®ä¿åŒ¹é…å¿…é¡»ä» å‰©ä½™çš„ç¬¬ä¸€ä¸ª ä½ç½®å¼€å§‹ï¼Œç±»ä¼¼äº ^ è¿ç®—ç¬¦çš„æ•ˆæœï¼Œè¿™ä¹Ÿå°±æ˜¯ç²˜è¿çš„å«ä¹‰ã€‚\nvar s = \u0026#39;aaa_aa_a\u0026#39;; var r1 = /a+/g; var r2 = /a+/y; r1.exec(s) // [\u0026#34;aaa\u0026#34;] r2.exec(s) // [\u0026#34;aaa\u0026#34;] r1.exec(s) // [\u0026#34;aa\u0026#34;] r2.exec(s) // null ä¸Šé¢ä»£ç æœ‰ä¸¤ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œä¸€ä¸ªä½¿ç”¨ g ä¿®é¥°ç¬¦ï¼Œå¦ä¸€ä¸ªä½¿ç”¨ y ä¿®é¥°ç¬¦ã€‚è¿™ä¸¤ä¸ªæ­£åˆ™è¡¨è¾¾å¼å„æ‰§è¡Œäº†ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸¤è€…è¡Œä¸ºç›¸åŒï¼Œå‰©ä½™å­—ç¬¦ä¸²éƒ½æ˜¯ _aa_a ã€‚ç”±äºgä¿®é¥°æ²¡æœ‰ä½ç½®è¦æ±‚ï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡æ‰§è¡Œä¼šè¿”å›ç»“æœï¼Œè€Œyä¿®é¥°ç¬¦è¦æ±‚åŒ¹é…å¿…é¡»ä»å¤´éƒ¨å¼€å§‹ï¼Œæ‰€ä»¥è¿”å› null ã€‚\nå¦‚æœæ”¹ä¸€ä¸‹æ­£åˆ™è¡¨è¾¾å¼ï¼Œä¿è¯æ¯æ¬¡éƒ½èƒ½å¤´éƒ¨åŒ¹é…ï¼Œyä¿®é¥°ç¬¦å°±ä¼šè¿”å›ç»“æœäº†ã€‚\nvar s = \u0026#39;aaa_aa_a\u0026#39;; var r = /a+_/y; r.exec(s) // [\u0026#34;aaa_\u0026#34;] r.exec(s) // [\u0026#34;aa_\u0026#34;] ä¸Šé¢ä»£ç æ¯æ¬¡åŒ¹é…ï¼Œéƒ½æ˜¯ä»å‰©ä½™å­—ç¬¦ä¸²çš„å¤´éƒ¨å¼€å§‹ã€‚\nä½¿ç”¨ lastIndex å±æ€§ï¼Œå¯ä»¥æ›´å¥½åœ°è¯´æ˜ y ä¿®é¥°ç¬¦ã€‚\nconst REGEX = /a/g; // æŒ‡å®šä»2å·ä½ç½®ï¼ˆyï¼‰å¼€å§‹åŒ¹é… REGEX.lastIndex = 2; // åŒ¹é…æˆåŠŸ const match = REGEX.exec(\u0026#39;xaya\u0026#39;); // åœ¨3å·ä½ç½®åŒ¹é…æˆåŠŸ match.index // 3 // ä¸‹ä¸€æ¬¡åŒ¹é…ä»4å·ä½å¼€å§‹ REGEX.lastIndex // 4 // 4å·ä½å¼€å§‹åŒ¹é…å¤±è´¥ REGEX.exec(\u0026#39;xaya\u0026#39;) // null ä¸Šé¢ä»£ç ä¸­ï¼ŒlastIndexå±æ€§æŒ‡å®šæ¯æ¬¡æœç´¢çš„å¼€å§‹ä½ç½®ï¼Œgä¿®é¥°ç¬¦ä»è¿™ä¸ªä½ç½®å¼€å§‹å‘åæœç´¢ï¼Œç›´åˆ°å‘ç°åŒ¹é…ä¸ºæ­¢ã€‚\nyä¿®é¥°ç¬¦åŒæ ·éµå®ˆ lastIndex å±æ€§ï¼Œä½†æ˜¯è¦æ±‚å¿…é¡»åœ¨ lastIndex æŒ‡å®šçš„ä½ç½®å‘ç°åŒ¹é…ã€‚\nconst REGEX = /a/y; // æŒ‡å®šä»2å·ä½ç½®å¼€å§‹åŒ¹é… REGEX.lastIndex = 2; // ä¸æ˜¯ç²˜è¿ï¼ŒåŒ¹é…å¤±è´¥ REGEX.exec(\u0026#39;xaya\u0026#39;) // null // æŒ‡å®šä»3å·ä½ç½®å¼€å§‹åŒ¹é… REGEX.lastIndex = 3; // 3å·ä½ç½®æ˜¯ç²˜è¿ï¼ŒåŒ¹é…æˆåŠŸ const match = REGEX.exec(\u0026#39;xaya\u0026#39;); match.index // 3 REGEX.lastIndex // 4 å®é™…ä¸Šï¼Œy ä¿®é¥°ç¬¦å·éšå«äº†å¤´éƒ¨åŒ¹é…çš„æ ‡å¿— ^ã€‚\n/b/y.exec(\u0026#39;aba\u0026#39;) // null ä¸Šé¢ä»£ç ç”±äºä¸èƒ½ä¿è¯å¤´éƒ¨åŒ¹é…ï¼Œæ‰€ä»¥è¿”å›nullã€‚yä¿®é¥°ç¬¦çš„è®¾è®¡æœ¬æ„ï¼Œå°±æ˜¯è®©å¤´éƒ¨åŒ¹é…çš„æ ‡å¿— ^ åœ¨å…¨å±€åŒ¹é…ä¸­éƒ½æœ‰æ•ˆã€‚\nä¸‹é¢æ˜¯å­—ç¬¦ä¸²å¯¹è±¡çš„replaceæ–¹æ³•çš„ä¾‹å­ã€‚\nconst REGEX = /a/gy; \u0026#39;aaxa\u0026#39;.replace(REGEX, \u0026#39;-\u0026#39;) // \u0026#39;--xa\u0026#39; ä¸Šé¢ä»£ç ä¸­ï¼Œæœ€åä¸€ä¸ªaå› ä¸ºä¸æ˜¯å‡ºç°åœ¨ä¸‹ä¸€æ¬¡åŒ¹é…çš„å¤´éƒ¨ï¼Œæ‰€ä»¥ä¸ä¼šè¢«æ›¿æ¢ã€‚\nå•å•ä¸€ä¸ªyä¿®é¥°ç¬¦å¯¹matchæ–¹æ³•ï¼Œåªèƒ½è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…ï¼Œå¿…é¡»ä¸gä¿®é¥°ç¬¦è”ç”¨ï¼Œæ‰èƒ½è¿”å›æ‰€æœ‰åŒ¹é…ã€‚\n\u0026#39;a1a2a3\u0026#39;.match(/a\\d/y) // [\u0026#34;a1\u0026#34;] \u0026#39;a1a2a3\u0026#39;.match(/a\\d/gy) // [\u0026#34;a1\u0026#34;, \u0026#34;a2\u0026#34;, \u0026#34;a3\u0026#34;] yä¿®é¥°ç¬¦çš„ä¸€ä¸ªåº”ç”¨ï¼Œæ˜¯ä»å­—ç¬¦ä¸²æå– tokenï¼ˆè¯å…ƒï¼‰ï¼Œyä¿®é¥°ç¬¦ç¡®ä¿äº†åŒ¹é…ä¹‹é—´ä¸ä¼šæœ‰æ¼æ‰çš„å­—ç¬¦ã€‚\nconst TOKEN_Y = /\\s*(\\+|[0-9]+)\\s*/y; const TOKEN_G = /\\s*(\\+|[0-9]+)\\s*/g; tokenize(TOKEN_Y, \u0026#39;3 + 4\u0026#39;) // [ \u0026#39;3\u0026#39;, \u0026#39;+\u0026#39;, \u0026#39;4\u0026#39; ] tokenize(TOKEN_G, \u0026#39;3 + 4\u0026#39;) // [ \u0026#39;3\u0026#39;, \u0026#39;+\u0026#39;, \u0026#39;4\u0026#39; ] function tokenize(TOKEN_REGEX, str) { let result = []; let match; while (match = TOKEN_REGEX.exec(str)) { result.push(match[1]); } return result; } ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœå­—ç¬¦ä¸²é‡Œé¢æ²¡æœ‰éæ³•å­—ç¬¦ï¼Œyä¿®é¥°ç¬¦ä¸gä¿®é¥°ç¬¦çš„æå–ç»“æœæ˜¯ä¸€æ ·çš„ã€‚ä½†æ˜¯ï¼Œä¸€æ—¦å‡ºç°éæ³•å­—ç¬¦ï¼Œä¸¤è€…çš„è¡Œä¸ºå°±ä¸ä¸€æ ·äº†ã€‚\ntokenize(TOKEN_Y, \u0026#39;3x + 4\u0026#39;) // [ \u0026#39;3\u0026#39; ] tokenize(TOKEN_G, \u0026#39;3x + 4\u0026#39;) // [ \u0026#39;3\u0026#39;, \u0026#39;+\u0026#39;, \u0026#39;4\u0026#39; ] ä¸Šé¢ä»£ç ä¸­ï¼Œg ä¿®é¥°ç¬¦ä¼šå¿½ç•¥éæ³•å­—ç¬¦ï¼Œè€Œ y ä¿®é¥°ç¬¦ä¸ä¼šï¼Œè¿™æ ·å°±å¾ˆå®¹æ˜“å‘ç°é”™è¯¯ã€‚\nğŸ“ Note RegExp.prototype.sticky å±æ€§\nä¸yä¿®é¥°ç¬¦ç›¸åŒ¹é…ï¼ŒES6 çš„æ­£åˆ™å®ä¾‹å¯¹è±¡å¤šäº†stickyå±æ€§ï¼Œè¡¨ç¤ºæ˜¯å¦è®¾ç½®äº†yä¿®é¥°ç¬¦ã€‚\nvar r = /hello\\d/y; r.sticky // true s ä¿®é¥°ç¬¦ dotAll æ¨¡å¼\næ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œç‚¹ .æ˜¯ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ï¼Œä»£è¡¨ä»»æ„çš„å•ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªä¾‹å¤–ã€‚ä¸€ä¸ªæ˜¯å››ä¸ªå­—èŠ‚çš„ UTF-16 å­—ç¬¦ï¼Œè¿™ä¸ªå¯ä»¥ç”¨uä¿®é¥°ç¬¦è§£å†³ï¼›å¦ä¸€ä¸ªæ˜¯è¡Œç»ˆæ­¢ç¬¦ï¼ˆline terminator characterï¼‰ã€‚\næ‰€è°“è¡Œç»ˆæ­¢ç¬¦ï¼Œå°±æ˜¯è¯¥å­—ç¬¦è¡¨ç¤ºä¸€è¡Œçš„ç»ˆç»“ã€‚ä»¥ä¸‹å››ä¸ªå­—ç¬¦å±äº è¡Œç»ˆæ­¢ç¬¦ ã€‚\nU+000A æ¢è¡Œç¬¦ U+000D å›è½¦ç¬¦\\r U+2028 è¡Œåˆ†éš”ç¬¦line separator U+2029 æ®µåˆ†éš”ç¬¦paragraph separator /foo.bar/.test(\u0026#39;foo bar\u0026#39;) // false ä¸Šé¢ä»£ç ä¸­ï¼Œå› ä¸º.ä¸åŒ¹é… ï¼Œæ‰€ä»¥æ­£åˆ™è¡¨è¾¾å¼è¿”å›falseã€‚\nä½†æ˜¯ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¸Œæœ›åŒ¹é…çš„æ˜¯ä»»æ„å•ä¸ªå­—ç¬¦ï¼Œè¿™æ—¶æœ‰ä¸€ç§å˜é€šçš„å†™æ³•ã€‚\n/foo[^]bar/.test(\u0026#39;foo bar\u0026#39;) // true è¿™ç§è§£å†³æ–¹æ¡ˆæ¯•ç«Ÿä¸å¤ªç¬¦åˆç›´è§‰ï¼ŒES2018 å¼•å…¥sä¿®é¥°ç¬¦ï¼Œä½¿å¾—.å¯ä»¥åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ã€‚\n/foo.bar/s.test(\u0026#39;foo bar\u0026#39;) // true è¿™è¢«ç§°ä¸ºdotAllæ¨¡å¼ï¼Œå³ç‚¹ï¼ˆdotï¼‰ä»£è¡¨ä¸€åˆ‡å­—ç¬¦ã€‚æ‰€ä»¥ï¼Œæ­£åˆ™è¡¨è¾¾å¼è¿˜å¼•å…¥äº†ä¸€ä¸ªdotAllå±æ€§ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¦å¤„åœ¨dotAllæ¨¡å¼ã€‚\nconst re = /foo.bar/s; // å¦ä¸€ç§å†™æ³• // const re = new RegExp(\u0026#39;foo.bar\u0026#39;, \u0026#39;s\u0026#39;); re.test(\u0026#39;foo bar\u0026#39;) // true re.dotAll // true re.flags // \u0026#39;s\u0026#39; /s ä¿®é¥°ç¬¦å’Œå¤šè¡Œä¿®é¥°ç¬¦ /m ä¸å†²çªï¼Œä¸¤è€…ä¸€èµ·ä½¿ç”¨çš„æƒ…å†µä¸‹ï¼Œ . åŒ¹é…æ‰€æœ‰å­—ç¬¦ï¼Œè€Œ ^ å’Œ $ åŒ¹é…æ¯ä¸€è¡Œçš„è¡Œé¦–å’Œè¡Œå°¾ã€‚\nåè¡Œæ–­è¨€ JavaScript è¯­è¨€çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œåªæ”¯æŒå…ˆè¡Œæ–­è¨€ï¼ˆlookaheadï¼‰å’Œå…ˆè¡Œå¦å®šæ–­è¨€ï¼ˆnegative lookaheadï¼‰ï¼Œä¸æ”¯æŒåè¡Œæ–­è¨€ï¼ˆlookbehindï¼‰å’Œåè¡Œå¦å®šæ–­è¨€ï¼ˆnegative lookbehindï¼‰ã€‚ES2018 å¼•å…¥åè¡Œæ–­è¨€ï¼ŒV8 å¼•æ“ 4.9 ç‰ˆï¼ˆChrome 62ï¼‰å·²ç»æ”¯æŒã€‚\nâ€œå…ˆè¡Œæ–­è¨€â€æŒ‡çš„æ˜¯ï¼Œxåªæœ‰åœ¨yå‰é¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ/x(?=y)/ã€‚æ¯”å¦‚ï¼ŒåªåŒ¹é…ç™¾åˆ†å·ä¹‹å‰çš„æ•°å­—ï¼Œè¦å†™æˆ/\\d+(?=%)/ã€‚â€œå…ˆè¡Œå¦å®šæ–­è¨€â€æŒ‡çš„æ˜¯ï¼Œxåªæœ‰ä¸åœ¨yå‰é¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ/x(?!y)/ã€‚æ¯”å¦‚ï¼ŒåªåŒ¹é…ä¸åœ¨ç™¾åˆ†å·ä¹‹å‰çš„æ•°å­—ï¼Œè¦å†™æˆ/\\d+(?!%)/ã€‚\n/\\d+(?=%)/.exec(\u0026#39;100% of US presidents have been male\u0026#39;) // [\u0026#34;100\u0026#34;] /\\d+(?!%)/.exec(\u0026#39;thatâ€™s all 44 of them\u0026#39;) // [\u0026#34;44\u0026#34;] ä¸Šé¢ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœäº’æ¢æ­£åˆ™è¡¨è¾¾å¼ï¼Œå°±ä¸ä¼šå¾—åˆ°ç›¸åŒç»“æœã€‚å¦å¤–ï¼Œè¿˜å¯ä»¥çœ‹åˆ°ï¼Œâ€œå…ˆè¡Œæ–­è¨€â€æ‹¬å·ä¹‹ä¸­çš„éƒ¨åˆ†ï¼ˆ(?=%)ï¼‰ï¼Œæ˜¯ä¸è®¡å…¥è¿”å›ç»“æœçš„ã€‚\nâ€œåè¡Œæ–­è¨€â€æ­£å¥½ä¸â€œå…ˆè¡Œæ–­è¨€â€ç›¸åï¼Œxåªæœ‰åœ¨yåé¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ/(?\u0026lt;=y)x/ã€‚æ¯”å¦‚ï¼ŒåªåŒ¹é…ç¾å…ƒç¬¦å·ä¹‹åçš„æ•°å­—ï¼Œè¦å†™æˆ/(?\u0026lt;=\\$)\\d+/ã€‚â€œåè¡Œå¦å®šæ–­è¨€â€åˆ™ä¸â€œå…ˆè¡Œå¦å®šæ–­è¨€â€ç›¸åï¼Œxåªæœ‰ä¸åœ¨yåé¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ/(?\u0026lt;!y)x/ã€‚æ¯”å¦‚ï¼ŒåªåŒ¹é…ä¸åœ¨ç¾å…ƒç¬¦å·åé¢çš„æ•°å­—ï¼Œè¦å†™æˆ/(?\u0026lt;!\\$)\\d+/ã€‚\n/(?\u0026lt;=\\$)\\d+/.exec(\u0026#39;Benjamin Franklin is on the $100 bill\u0026#39;) // [\u0026#34;100\u0026#34;] /(?\u0026lt;!\\$)\\d+/.exec(\u0026#39;itâ€™s is worth about â‚¬90\u0026#39;) // [\u0026#34;90\u0026#34;] ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œâ€œåè¡Œæ–­è¨€â€çš„æ‹¬å·ä¹‹ä¸­çš„éƒ¨åˆ†ï¼ˆ(?\u0026lt;=\\$)ï¼‰ï¼Œä¹Ÿæ˜¯ä¸è®¡å…¥è¿”å›ç»“æœã€‚\nä¸‹é¢çš„ä¾‹å­æ˜¯ä½¿ç”¨åè¡Œæ–­è¨€è¿›è¡Œå­—ç¬¦ä¸²æ›¿æ¢ã€‚\nconst RE_DOLLAR_PREFIX = /(?\u0026lt;=\\$)foo/g; \u0026#39;$foo %foo foo\u0026#39;.replace(RE_DOLLAR_PREFIX, \u0026#39;bar\u0026#39;); // \u0026#39;$bar %foo foo\u0026#39; ä¸Šé¢ä»£ç ä¸­ï¼Œåªæœ‰åœ¨ç¾å…ƒç¬¦å·åé¢çš„fooæ‰ä¼šè¢«æ›¿æ¢ã€‚\nâ€œåè¡Œæ–­è¨€â€çš„å®ç°ï¼Œéœ€è¦å…ˆåŒ¹é…/(?\u0026lt;=y)x/çš„xï¼Œç„¶åå†å›åˆ°å·¦è¾¹ï¼ŒåŒ¹é…yçš„éƒ¨åˆ†ã€‚è¿™ç§â€œå…ˆå³åå·¦â€çš„æ‰§è¡Œé¡ºåºï¼Œä¸æ‰€æœ‰å…¶ä»–æ­£åˆ™æ“ä½œç›¸åï¼Œå¯¼è‡´äº†ä¸€äº›ä¸ç¬¦åˆé¢„æœŸçš„è¡Œä¸ºã€‚\né¦–å…ˆï¼Œåè¡Œæ–­è¨€çš„ç»„åŒ¹é…ï¼Œä¸æ­£å¸¸æƒ…å†µä¸‹ç»“æœæ˜¯ä¸ä¸€æ ·çš„ã€‚\n/(?\u0026lt;=(\\d+)(\\d+))$/.exec(\u0026#39;1053\u0026#39;) // [\u0026#34;\u0026#34;, \u0026#34;1\u0026#34;, \u0026#34;053\u0026#34;] /^(\\d+)(\\d+)$/.exec(\u0026#39;1053\u0026#39;) // [\u0026#34;1053\u0026#34;, \u0026#34;105\u0026#34;, \u0026#34;3\u0026#34;] ä¸Šé¢ä»£ç ä¸­ï¼Œéœ€è¦æ•æ‰ä¸¤ä¸ªç»„åŒ¹é…ã€‚æ²¡æœ‰â€œåè¡Œæ–­è¨€â€æ—¶ï¼Œç¬¬ä¸€ä¸ªæ‹¬å·æ˜¯è´ªå©ªæ¨¡å¼ï¼Œç¬¬äºŒä¸ªæ‹¬å·åªèƒ½æ•è·ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ç»“æœæ˜¯105å’Œ3ã€‚è€Œâ€œåè¡Œæ–­è¨€â€æ—¶ï¼Œç”±äºæ‰§è¡Œé¡ºåºæ˜¯ä»å³åˆ°å·¦ï¼Œç¬¬äºŒä¸ªæ‹¬å·æ˜¯è´ªå©ªæ¨¡å¼ï¼Œç¬¬ä¸€ä¸ªæ‹¬å·åªèƒ½æ•è·ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ç»“æœæ˜¯1å’Œ053ã€‚\nå…¶æ¬¡ï¼Œâ€œåè¡Œæ–­è¨€â€çš„åæ–œæ å¼•ç”¨ï¼Œä¹Ÿä¸é€šå¸¸çš„é¡ºåºç›¸åï¼Œå¿…é¡»æ”¾åœ¨å¯¹åº”çš„é‚£ä¸ªæ‹¬å·ä¹‹å‰ã€‚\n/(?\u0026lt;=(o)d\\1)r/.exec(\u0026#39;hodor\u0026#39;) // null /(?\u0026lt;=\\1d(o))r/.exec(\u0026#39;hodor\u0026#39;) // [\u0026#34;r\u0026#34;, \u0026#34;o\u0026#34;] ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœåè¡Œæ–­è¨€çš„åæ–œæ å¼•ç”¨ï¼ˆ\\1ï¼‰æ”¾åœ¨æ‹¬å·çš„åé¢ï¼Œå°±ä¸ä¼šå¾—åˆ°åŒ¹é…ç»“æœï¼Œå¿…é¡»æ”¾åœ¨å‰é¢æ‰å¯ä»¥ã€‚å› ä¸ºåè¡Œæ–­è¨€æ˜¯å…ˆä»å·¦åˆ°å³æ‰«æï¼Œå‘ç°åŒ¹é…ä»¥åå†å›è¿‡å¤´ï¼Œä»å³åˆ°å·¦å®Œæˆåæ–œæ å¼•ç”¨ã€‚\nUnicode ES2018 å¼•å…¥äº†ä¸€ç§æ–°çš„ç±»çš„å†™æ³• \\p{...} å’Œ \\P{...}ï¼Œå…è®¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç¬¦åˆ Unicode æŸç§å±æ€§çš„æ‰€æœ‰å­—ç¬¦ã€‚\nconst regexGreekSymbol = /\\p{Script=Greek}/u; regexGreekSymbol.test(\u0026#39;Ï€\u0026#39;) // true ä¸Šé¢ä»£ç ä¸­ï¼Œ\\p{Script=Greek}æŒ‡å®šåŒ¹é…ä¸€ä¸ªå¸Œè…Šæ–‡å­—æ¯ï¼Œæ‰€ä»¥åŒ¹é…Ï€æˆåŠŸã€‚\nUnicode å±æ€§ç±»è¦æŒ‡å®šå±æ€§åå’Œå±æ€§å€¼ã€‚\n\\p{UnicodePropertyName=UnicodePropertyValue} å¯¹äºæŸäº›å±æ€§ï¼Œå¯ä»¥åªå†™å±æ€§åï¼Œæˆ–è€…åªå†™å±æ€§å€¼ã€‚\n\\p{UnicodePropertyName} \\p{UnicodePropertyValue} \\P{â€¦} æ˜¯ \\p{â€¦}çš„åå‘åŒ¹é…ï¼Œå³åŒ¹é…ä¸æ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ã€‚\næ³¨æ„ï¼Œè¿™ä¸¤ç§ç±»åªå¯¹ Unicode æœ‰æ•ˆï¼Œæ‰€ä»¥ä½¿ç”¨çš„æ—¶å€™ä¸€å®šè¦åŠ ä¸Šuä¿®é¥°ç¬¦ã€‚å¦‚æœä¸åŠ  u ä¿®é¥°ç¬¦ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨\\på’Œ\\Pä¼šæŠ¥é”™ï¼ŒECMAScript é¢„ç•™äº†è¿™ä¸¤ä¸ªç±»ã€‚\nç”±äº Unicode çš„å„ç§å±æ€§éå¸¸å¤šï¼Œæ‰€ä»¥è¿™ç§æ–°çš„ç±»çš„è¡¨è¾¾èƒ½åŠ›éå¸¸å¼ºã€‚\nconst regex = /^\\p{Decimal_Number}+$/u; regex.test(\u0026#39;ğŸğŸğŸ‘ğŸœğŸğŸğŸ©ğŸªğŸ«ğŸ¬ğŸ­ğŸ®ğŸ¯ğŸºğŸ»ğŸ¼\u0026#39;) // true ä¸Šé¢ä»£ç ä¸­ï¼Œå±æ€§ç±»æŒ‡å®šåŒ¹é…æ‰€æœ‰åè¿›åˆ¶å­—ç¬¦ï¼Œå¯ä»¥çœ‹åˆ°å„ç§å­—å‹çš„åè¿›åˆ¶å­—ç¬¦éƒ½ä¼šåŒ¹é…æˆåŠŸã€‚\n\\p{Number}ç”šè‡³èƒ½åŒ¹é…ç½—é©¬æ•°å­—ã€‚\n// åŒ¹é…æ‰€æœ‰æ•°å­— const regex = /^\\p{Number}+$/u; regex.test(\u0026#39;Â²Â³Â¹Â¼Â½Â¾\u0026#39;) // true regex.test(\u0026#39;ã‰›ã‰œã‰\u0026#39;) // true regex.test(\u0026#39;â… â…¡â…¢â…£â…¤â…¥â…¦â…§â…¨â…©â…ªâ…«\u0026#39;) // true ä¸‹é¢æ˜¯å…¶ä»–ä¸€äº›ä¾‹å­ã€‚\n// åŒ¹é…æ‰€æœ‰ç©ºæ ¼ \\p{White_Space} // åŒ¹é…å„ç§æ–‡å­—çš„æ‰€æœ‰å­—æ¯ï¼Œç­‰åŒäº Unicode ç‰ˆçš„ \\w [\\p{Alphabetic}\\p{Mark}\\p{Decimal_Number}\\p{Connector_Punctuation}\\p{Join_Control}] // åŒ¹é…å„ç§æ–‡å­—çš„æ‰€æœ‰éå­—æ¯çš„å­—ç¬¦ï¼Œç­‰åŒäº Unicode ç‰ˆçš„ \\W [^\\p{Alphabetic}\\p{Mark}\\p{Decimal_Number}\\p{Connector_Punctuation}\\p{Join_Control}] // åŒ¹é… Emoji /\\p{Emoji_Modifier_Base}\\p{Emoji_Modifier}?|\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F/gu // åŒ¹é…æ‰€æœ‰çš„ç®­å¤´å­—ç¬¦ const regexArrows = /^\\p{Block=Arrows}+$/u; regexArrows.test(\u0026#39;â†â†‘â†’â†“â†”â†•â†–â†—â†˜â†™â‡â‡â‡‘â‡’â‡“â‡”â‡•â‡–â‡—â‡˜â‡™â‡§â‡©\u0026#39;) // true å…·åç»„åŒ¹é… ç®€ä»‹ æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨åœ†æ‹¬å·è¿›è¡Œç»„åŒ¹é…ã€‚\nconst RE_DATE = /(\\d{4})-(\\d{2})-(\\d{2})/; ä¸Šé¢ä»£ç ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼é‡Œé¢æœ‰ä¸‰ç»„åœ†æ‹¬å·ã€‚ä½¿ç”¨execæ–¹æ³•ï¼Œå°±å¯ä»¥å°†è¿™ä¸‰ç»„åŒ¹é…ç»“æœæå–å‡ºæ¥ã€‚\nconst RE_DATE = /(\\d{4})-(\\d{2})-(\\d{2})/; const matchObj = RE_DATE.exec(\u0026#39;1999-12-31\u0026#39;); const year = matchObj[1]; // 1999 const month = matchObj[2]; // 12 const day = matchObj[3]; // 31 ç»„åŒ¹é…çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œæ¯ä¸€ç»„çš„åŒ¹é…å«ä¹‰ä¸å®¹æ˜“çœ‹å‡ºæ¥ï¼Œè€Œä¸”åªèƒ½ç”¨æ•°å­—åºå·ï¼ˆæ¯”å¦‚matchObj[1]ï¼‰å¼•ç”¨ï¼Œè¦æ˜¯ç»„çš„é¡ºåºå˜äº†ï¼Œå¼•ç”¨çš„æ—¶å€™å°±å¿…é¡»ä¿®æ”¹åºå·ã€‚\nES2018 å¼•å…¥äº†å…·åç»„åŒ¹é…ï¼ˆNamed Capture Groupsï¼‰ï¼Œå…è®¸ä¸ºæ¯ä¸€ä¸ªç»„åŒ¹é…æŒ‡å®šä¸€ä¸ªåå­—ï¼Œæ—¢ä¾¿äºé˜…è¯»ä»£ç ï¼Œåˆä¾¿äºå¼•ç”¨ã€‚\nconst RE_DATE = /(?\u0026lt;year\u0026gt;\\d{4})-(?\u0026lt;month\u0026gt;\\d{2})-(?\u0026lt;day\u0026gt;\\d{2})/; const matchObj = RE_DATE.exec(\u0026#39;1999-12-31\u0026#39;); const year = matchObj.groups.year; // 1999 const month = matchObj.groups.month; // 12 const day = matchObj.groups.day; // 31 ä¸Šé¢ä»£ç ä¸­ï¼Œâ€œå…·åç»„åŒ¹é…â€åœ¨åœ†æ‹¬å·å†…éƒ¨ï¼Œæ¨¡å¼çš„å¤´éƒ¨æ·»åŠ â€œé—®å· + å°–æ‹¬å· + ç»„åâ€ï¼ˆ?\u0026lt;year\u0026gt;ï¼‰ï¼Œç„¶åå°±å¯ä»¥åœ¨execæ–¹æ³•è¿”å›ç»“æœçš„groupså±æ€§ä¸Šå¼•ç”¨è¯¥ç»„åã€‚åŒæ—¶ï¼Œæ•°å­—åºå·ï¼ˆmatchObj[1]ï¼‰ä¾ç„¶æœ‰æ•ˆã€‚\nå…·åç»„åŒ¹é…ç­‰äºä¸ºæ¯ä¸€ç»„åŒ¹é…åŠ ä¸Šäº† IDï¼Œä¾¿äºæè¿°åŒ¹é…çš„ç›®çš„ã€‚å¦‚æœç»„çš„é¡ºåºå˜äº†ï¼Œä¹Ÿä¸ç”¨æ”¹å˜åŒ¹é…åçš„å¤„ç†ä»£ç ã€‚\nå¦‚æœå…·åç»„æ²¡æœ‰åŒ¹é…ï¼Œé‚£ä¹ˆå¯¹åº”çš„groupså¯¹è±¡å±æ€§ä¼šæ˜¯undefinedã€‚\nconst RE_OPT_A = /^(?\u0026lt;as\u0026gt;a+)?$/; const matchObj = RE_OPT_A.exec(\u0026#39;\u0026#39;); matchObj.groups.as // undefined \u0026#39;as\u0026#39; in matchObj.groups // true ä¸Šé¢ä»£ç ä¸­ï¼Œå…·åç»„asæ²¡æœ‰æ‰¾åˆ°åŒ¹é…ï¼Œé‚£ä¹ˆmatchObj.groups.aså±æ€§å€¼å°±æ˜¯undefinedï¼Œå¹¶ä¸”asè¿™ä¸ªé”®ååœ¨groupsæ˜¯å§‹ç»ˆå­˜åœ¨çš„ã€‚\nè§£æ„èµ‹å€¼å’Œæ›¿æ¢ æœ‰äº†å…·åç»„åŒ¹é…ä»¥åï¼Œå¯ä»¥ä½¿ç”¨è§£æ„èµ‹å€¼ç›´æ¥ä»åŒ¹é…ç»“æœä¸Šä¸ºå˜é‡èµ‹å€¼ã€‚\nlet {groups: {one, two}} = /^(?\u0026lt;one\u0026gt;.*):(?\u0026lt;two\u0026gt;.*)$/u.exec(\u0026#39;foo:bar\u0026#39;); one // foo two // bar å­—ç¬¦ä¸²æ›¿æ¢æ—¶ï¼Œä½¿ç”¨$\u0026lt;ç»„å\u0026gt;å¼•ç”¨å…·åç»„ã€‚\nlet re = /(?\u0026lt;year\u0026gt;\\d{4})-(?\u0026lt;month\u0026gt;\\d{2})-(?\u0026lt;day\u0026gt;\\d{2})/u; \u0026#39;2015-01-02\u0026#39;.replace(re, \u0026#39;$\u0026lt;day\u0026gt;/$\u0026lt;month\u0026gt;/$\u0026lt;year\u0026gt;\u0026#39;) // \u0026#39;02/01/2015\u0026#39; ä¸Šé¢ä»£ç ä¸­ï¼Œreplaceæ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚\nreplaceæ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ä¹Ÿå¯ä»¥æ˜¯å‡½æ•°ï¼Œè¯¥å‡½æ•°çš„å‚æ•°åºåˆ—å¦‚ä¸‹ã€‚\n\u0026#39;2015-01-02\u0026#39;.replace(re, ( matched, // æ•´ä¸ªåŒ¹é…ç»“æœ 2015-01-02 capture1, // ç¬¬ä¸€ä¸ªç»„åŒ¹é… 2015 capture2, // ç¬¬äºŒä¸ªç»„åŒ¹é… 01 capture3, // ç¬¬ä¸‰ä¸ªç»„åŒ¹é… 02 position, // åŒ¹é…å¼€å§‹çš„ä½ç½® 0 S, // åŸå­—ç¬¦ä¸² 2015-01-02 groups // å…·åç»„æ„æˆçš„ä¸€ä¸ªå¯¹è±¡ {year, month, day} ) =\u0026gt; { let {day, month, year} = groups; return `${day}/${month}/${year}`; }); å…·åç»„åŒ¹é…åœ¨åŸæ¥çš„åŸºç¡€ä¸Šï¼Œæ–°å¢äº†æœ€åä¸€ä¸ªå‡½æ•°å‚æ•°ï¼šå…·åç»„æ„æˆçš„ä¸€ä¸ªå¯¹è±¡ã€‚å‡½æ•°å†…éƒ¨å¯ä»¥ç›´æ¥å¯¹è¿™ä¸ªå¯¹è±¡è¿›è¡Œè§£æ„èµ‹å€¼ã€‚\nå¼•ç”¨ å¦‚æœè¦åœ¨æ­£åˆ™è¡¨è¾¾å¼å†…éƒ¨å¼•ç”¨æŸä¸ªâ€œå…·åç»„åŒ¹é…â€ï¼Œå¯ä»¥ä½¿ç”¨\\k\u0026lt;ç»„å\u0026gt;çš„å†™æ³•ã€‚\nconst RE_TWICE = /^(?\u0026lt;word\u0026gt;[a-z]+)!\\k\u0026lt;word\u0026gt;$/; RE_TWICE.test(\u0026#39;abc!abc\u0026#39;) // true RE_TWICE.test(\u0026#39;abc!ab\u0026#39;) // false æ•°å­—å¼•ç”¨ï¼ˆ\\1ï¼‰ä¾ç„¶æœ‰æ•ˆã€‚\nconst RE_TWICE = /^(?\u0026lt;word\u0026gt;[a-z]+)!\\1$/; RE_TWICE.test(\u0026#39;abc!abc\u0026#39;) // true RE_TWICE.test(\u0026#39;abc!ab\u0026#39;) // false è¿™ä¸¤ç§å¼•ç”¨è¯­æ³•è¿˜å¯ä»¥åŒæ—¶ä½¿ç”¨ã€‚\nconst RE_TWICE = /^(?\u0026lt;word\u0026gt;[a-z]+)!\\k\u0026lt;word\u0026gt;!\\1$/; RE_TWICE.test(\u0026#39;abc!abc!abc\u0026#39;) // true RE_TWICE.test(\u0026#39;abc!abc!ab\u0026#39;) // false æ­£åˆ™åŒ¹é…ç´¢å¼• æ­£åˆ™åŒ¹é…ç»“æœçš„å¼€å§‹ä½ç½®å’Œç»“æŸä½ç½®ï¼Œç›®å‰è·å–å¹¶ä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚æ­£åˆ™å®ä¾‹çš„exec()æ–¹æ³•ï¼Œè¿”å›ç»“æœæœ‰ä¸€ä¸ªindexå±æ€§ï¼Œå¯ä»¥è·å–æ•´ä¸ªåŒ¹é…ç»“æœçš„å¼€å§‹ä½ç½®ï¼Œä½†æ˜¯å¦‚æœåŒ…å«ç»„åŒ¹é…ï¼Œæ¯ä¸ªç»„åŒ¹é…çš„å¼€å§‹ä½ç½®ï¼Œå¾ˆéš¾æ‹¿åˆ°ã€‚\nç°åœ¨æœ‰ä¸€ä¸ªç¬¬ä¸‰é˜¶æ®µææ¡ˆï¼Œä¸ºexec()æ–¹æ³•çš„è¿”å›ç»“æœåŠ ä¸Šindiceså±æ€§ï¼Œåœ¨è¿™ä¸ªå±æ€§ä¸Šé¢å¯ä»¥æ‹¿åˆ°åŒ¹é…çš„å¼€å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚\nconst text = \u0026#39;zabbcdef\u0026#39;; const re = /ab/; const result = re.exec(text); result.index // 1 result.indices // [ [1, 3] ] ä¸Šé¢ä¾‹å­ä¸­ï¼Œexec()æ–¹æ³•çš„è¿”å›ç»“æœresultï¼Œå®ƒçš„indexå±æ€§æ˜¯æ•´ä¸ªåŒ¹é…ç»“æœï¼ˆabï¼‰çš„å¼€å§‹ä½ç½®ï¼Œè€Œå®ƒçš„indiceså±æ€§æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯æ¯ä¸ªåŒ¹é…çš„å¼€å§‹ä½ç½®å’Œç»“æŸä½ç½®çš„æ•°ç»„ã€‚ç”±äºè¯¥ä¾‹å­çš„æ­£åˆ™è¡¨è¾¾å¼æ²¡æœ‰ç»„åŒ¹é…ï¼Œæ‰€ä»¥indicesæ•°ç»„åªæœ‰ä¸€ä¸ªæˆå‘˜ï¼Œè¡¨ç¤ºæ•´ä¸ªåŒ¹é…çš„å¼€å§‹ä½ç½®æ˜¯1ï¼Œç»“æŸä½ç½®æ˜¯3ã€‚\næ³¨æ„ï¼Œå¼€å§‹ä½ç½®åŒ…å«åœ¨åŒ¹é…ç»“æœä¹‹ä¸­ï¼Œä½†æ˜¯ç»“æŸä½ç½®ä¸åŒ…å«åœ¨åŒ¹é…ç»“æœä¹‹ä¸­ã€‚æ¯”å¦‚ï¼ŒåŒ¹é…ç»“æœä¸ºabï¼Œåˆ†åˆ«æ˜¯åŸå§‹å­—ç¬¦ä¸²çš„ç¬¬1ä½å’Œç¬¬2ä½ï¼Œé‚£ä¹ˆç»“æŸä½ç½®å°±æ˜¯ç¬¬3ä½ã€‚\nå¦‚æœæ­£åˆ™è¡¨è¾¾å¼åŒ…å«ç»„åŒ¹é…ï¼Œé‚£ä¹ˆindiceså±æ€§å¯¹åº”çš„æ•°ç»„å°±ä¼šåŒ…å«å¤šä¸ªæˆå‘˜ï¼Œæä¾›æ¯ä¸ªç»„åŒ¹é…çš„å¼€å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚\nconst text = \u0026#39;zabbcdef\u0026#39;; const re = /ab+(cd)/; const result = re.exec(text); result.indices // [ [ 1, 6 ], [ 4, 6 ] ] ä¸Šé¢ä¾‹å­ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼åŒ…å«ä¸€ä¸ªç»„åŒ¹é…ï¼Œé‚£ä¹ˆindiceså±æ€§æ•°ç»„å°±æœ‰ä¸¤ä¸ªæˆå‘˜ï¼Œç¬¬ä¸€ä¸ªæˆå‘˜æ˜¯æ•´ä¸ªåŒ¹é…ç»“æœï¼ˆabbcdï¼‰çš„å¼€å§‹ä½ç½®å’Œç»“æŸä½ç½®ï¼Œç¬¬äºŒä¸ªæˆå‘˜æ˜¯ç»„åŒ¹é…ï¼ˆcdï¼‰çš„å¼€å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚\nä¸‹é¢æ˜¯å¤šä¸ªç»„åŒ¹é…çš„ä¾‹å­ã€‚\nconst text = \u0026#39;zabbcdef\u0026#39;; const re = /ab+(cd(ef))/; const result = re.exec(text); result.indices // [ [1, 8], [4, 8], [6, 8] ] ä¸Šé¢ä¾‹å­ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼åŒ…å«ä¸¤ä¸ªç»„åŒ¹é…ï¼Œæ‰€ä»¥indiceså±æ€§æ•°ç»„å°±æœ‰ä¸‰ä¸ªæˆå‘˜ã€‚\nå¦‚æœæ­£åˆ™è¡¨è¾¾å¼åŒ…å«å…·åç»„åŒ¹é…ï¼Œindiceså±æ€§æ•°ç»„è¿˜ä¼šæœ‰ä¸€ä¸ªgroupså±æ€§ã€‚è¯¥å±æ€§æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥ä»è¯¥å¯¹è±¡è·å–å…·åç»„åŒ¹é…çš„å¼€å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚\nconst text = \u0026#39;zabbcdef\u0026#39;; const re = /ab+(?\u0026lt;Z\u0026gt;cd)/; const result = re.exec(text); result.indices.groups // { Z: [ 4, 6 ] } ä¸Šé¢ä¾‹å­ä¸­ï¼Œexec()æ–¹æ³•è¿”å›ç»“æœçš„indices.groupså±æ€§æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæä¾›å…·åç»„åŒ¹é…Zçš„å¼€å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚\nå¦‚æœè·å–ç»„åŒ¹é…ä¸æˆåŠŸï¼Œindiceså±æ€§æ•°ç»„çš„å¯¹åº”æˆå‘˜åˆ™ä¸ºundefinedï¼Œindices.groupså±æ€§å¯¹è±¡çš„å¯¹åº”æˆå‘˜ä¹Ÿæ˜¯undefinedã€‚\nconst text = \u0026#39;zabbcdef\u0026#39;; const re = /ab+(?\u0026lt;Z\u0026gt;ce)?/; const result = re.exec(text); result.indices[1] // undefined result.indices.groups[\u0026#39;Z\u0026#39;] // undefined ä¸Šé¢ä¾‹å­ä¸­ï¼Œç”±äºç»„åŒ¹é…ä¸æˆåŠŸï¼Œæ‰€ä»¥indiceså±æ€§æ•°ç»„å’Œindices.groupså±æ€§å¯¹è±¡å¯¹åº”çš„ç»„åŒ¹é…æˆå‘˜éƒ½æ˜¯undefinedã€‚\nå…¨éƒ¨åŒ¹é… String.prototype.matchAll()\nå¦‚æœä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åœ¨å­—ç¬¦ä¸²é‡Œé¢æœ‰å¤šä¸ªåŒ¹é…ï¼Œç°åœ¨ä¸€èˆ¬ä½¿ç”¨gä¿®é¥°ç¬¦æˆ–yä¿®é¥°ç¬¦ï¼Œåœ¨å¾ªç¯é‡Œé¢é€ä¸€å–å‡ºã€‚\nvar regex = /t(e)(st(\\d?))/g; var string = \u0026#39;test1test2test3\u0026#39;; var matches = []; var match; while (match = regex.exec(string)) { matches.push(match); } matches // [ // [\u0026#34;test1\u0026#34;, \u0026#34;e\u0026#34;, \u0026#34;st1\u0026#34;, \u0026#34;1\u0026#34;, index: 0, input: \u0026#34;test1test2test3\u0026#34;], // [\u0026#34;test2\u0026#34;, \u0026#34;e\u0026#34;, \u0026#34;st2\u0026#34;, \u0026#34;2\u0026#34;, index: 5, input: \u0026#34;test1test2test3\u0026#34;], // [\u0026#34;test3\u0026#34;, \u0026#34;e\u0026#34;, \u0026#34;st3\u0026#34;, \u0026#34;3\u0026#34;, index: 10, input: \u0026#34;test1test2test3\u0026#34;] // ] ä¸Šé¢ä»£ç ä¸­ï¼Œwhileå¾ªç¯å–å‡ºæ¯ä¸€è½®çš„æ­£åˆ™åŒ¹é…ï¼Œä¸€å…±ä¸‰è½®ã€‚\nES2020 å¢åŠ äº†String.prototype.matchAll()æ–¹æ³•ï¼Œå¯ä»¥ä¸€æ¬¡æ€§å–å‡ºæ‰€æœ‰åŒ¹é…ã€‚ä¸è¿‡ï¼Œå®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªéå†å™¨ï¼ˆIteratorï¼‰ï¼Œè€Œä¸æ˜¯æ•°ç»„ã€‚\nconst string = \u0026#39;test1test2test3\u0026#39;; const regex = /t(e)(st(\\d?))/g; for (const match of string.matchAll(regex)) { console.log(match); } // [\u0026#34;test1\u0026#34;, \u0026#34;e\u0026#34;, \u0026#34;st1\u0026#34;, \u0026#34;1\u0026#34;, index: 0, input: \u0026#34;test1test2test3\u0026#34;] // [\u0026#34;test2\u0026#34;, \u0026#34;e\u0026#34;, \u0026#34;st2\u0026#34;, \u0026#34;2\u0026#34;, index: 5, input: \u0026#34;test1test2test3\u0026#34;] // [\u0026#34;test3\u0026#34;, \u0026#34;e\u0026#34;, \u0026#34;st3\u0026#34;, \u0026#34;3\u0026#34;, index: 10, input: \u0026#34;test1test2test3\u0026#34;] ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äºstring.matchAll(regex)è¿”å›çš„æ˜¯éå†å™¨ï¼Œæ‰€ä»¥å¯ä»¥ç”¨for...ofå¾ªç¯å–å‡ºã€‚ç›¸å¯¹äºè¿”å›æ•°ç»„ï¼Œè¿”å›éå†å™¨çš„å¥½å¤„åœ¨äºï¼Œå¦‚æœåŒ¹é…ç»“æœæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ•°ç»„ï¼Œé‚£ä¹ˆéå†å™¨æ¯”è¾ƒèŠ‚çœèµ„æºã€‚\néå†å™¨è½¬ä¸ºæ•°ç»„æ˜¯éå¸¸ç®€å•çš„ï¼Œä½¿ç”¨...è¿ç®—ç¬¦å’ŒArray.from()æ–¹æ³•å°±å¯ä»¥äº†ã€‚\n// è½¬ä¸ºæ•°ç»„çš„æ–¹æ³•ä¸€ [...string.matchAll(regex)] // è½¬ä¸ºæ•°ç»„çš„æ–¹æ³•äºŒ Array.from(string.matchAll(regex)) å‡½æ•° å‚æ•° é»˜è®¤å€¼ è®¤è¯†å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ã€‚\nè°ƒç”¨å‡½æ•°çš„æ—¶å€™ä¼ å‚äº†ï¼Œå°±ç”¨ä¼ é€’çš„å‚æ•°ï¼›å¦‚æœæ²¡ä¼ å‚ï¼Œæˆ–æ˜¯ä¼ å…¥çš„å‚æ•°ä¸º undefined ï¼Œå°±ç”¨ é»˜è®¤å€¼ ã€‚\nå¦‚æœé»˜è®¤å€¼æ˜¯è¡¨è¾¾å¼ï¼Œé‚£ä¹ˆé»˜è®¤å€¼è¡¨è¾¾å¼æ˜¯ æƒ°æ€§æ±‚å€¼ çš„ã€‚\nğŸ“ Note ä¼ å…¥ null çš„æ—¶å€™ï¼Œä¸ä¼šä½¿ç”¨é»˜è®¤å€¼ã€‚\nES5 è‹¥è¦å®ç°å‡½æ•°é»˜è®¤å€¼ï¼Œéå¸¸éº»çƒ¦ã€‚\n// ä¹‹å‰çš„é»˜è®¤å€¼å®ç°æ–¹å¼ var multiply = function (x, y) { if (typeof y === \u0026#39;undefined\u0026#39;) { y = 3; } return x * y; }; console.log(multiply(2, 2));\t// 4 console.log(multiply(2));\t// 6 è€Œåœ¨ ES6 çš„æ¡†æ¶ä¸‹ï¼Œæ–¹æ³•ç®€åŒ–äº†è®¸å¤šã€‚\n// ES6 é»˜è®¤å€¼å®ç°æ–¹å¼ const multiply = (x, y = 3) =\u0026gt; { return x * y; }; console.log(multiply(2, 2));\t// 4 console.log(multiply(2));\t// 6 :memo: Note 1 å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼æœ€å¥½ä»å‚æ•°åˆ—è¡¨çš„ å³è¾¹ å¼€å§‹è®¾ç½®ã€‚\n// ä»å·¦è¾¹å¼€å§‹è®¾ç½®é»˜è®¤å€¼çš„ç¼ºé™· const multiply = (x = 1, y) =\u0026gt; x * y; console.log(multiply(undefined, 2));\t// 2 // ä¸ºäº†é¿å…æ­§ä¹‰ï¼Œå‰é¢çš„å‚æ•°å¿…é¡»æŒ‡å®šä¸º undefined ğŸ“ƒ Example å‡½æ•°å‚æ•°é»˜è®¤å€¼çš„åº”ç”¨\nç›´æ¥ä½¿ç”¨ const logUser = (username = \u0026#39;\u0026#39;, age = NaN, sex = undefined) =\u0026gt; { console.log(username, age, sex); }; // éœ€è¦èƒ½å¤Ÿè®°ä½å‚æ•°çš„é¡ºåºï¼Œå¦‚æœå‚æ•°è¾ƒå¤šéœ€è¦é…åˆæ–‡æ¡£ï¼Œä½¿ç”¨ä¸æ–¹ä¾¿ logUser(\u0026#39;Robert Downey Jr.\u0026#39;, 57, \u0026#39;male\u0026#39;); åˆ©ç”¨å¯¹è±¡è¿›è¡Œè§£æ„èµ‹å€¼ // æ¥æ”¶ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè€Œä¸éœ€è¦è®°ä½å‚æ•°çš„é¡ºåº // ï¼ˆå‡½æ•°é»˜è®¤å€¼ + è§£æ„èµ‹å€¼ + è§£æ„èµ‹å€¼é»˜è®¤å€¼ï¼‰ const logUser = ({ username = \u0026#39;\u0026#39;, age = NaN, sex = undefined } = {}) =\u0026gt; { console.log(username, age, sex); }; logUser();// \u0026#39;\u0026#39; NaN undefined logUser({age: 57, username: \u0026#39;Robert Downey Jr.\u0026#39;, sex: \u0026#39;male\u0026#39;}); // ç»“æœä¸å—é¡ºåºçš„å½±å“ // Robert Downey Jr. 57 male è¿™æ ·çš„å¥½å¤„æ˜¯å¢åŠ å‡½æ•°çš„ å¥å£®æ€§ ã€‚\nğŸ“ Note æŒ‡å®šäº†é»˜è®¤å€¼ä»¥åï¼Œå‡½æ•°çš„lengthå±æ€§ï¼Œå°†è¿”å›æ²¡æœ‰æŒ‡å®šé»˜è®¤å€¼çš„å‚æ•°ä¸ªæ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæŒ‡å®šäº†é»˜è®¤å€¼åï¼Œlengthå±æ€§å°† å¤±çœŸ ã€‚\nconsole.log([ ((a) =\u0026gt; {}).length, // 1 ((a = 5) =\u0026gt; {}).length, // 0 ((a, b, c = 5) =\u0026gt; {}).length // 2 ]); ä¸Šé¢ä»£ç ä¸­ï¼Œlength å±æ€§çš„è¿”å›å€¼ï¼Œç­‰äºå‡½æ•°çš„å‚æ•°ä¸ªæ•°å‡å»æŒ‡å®šäº†é»˜è®¤å€¼çš„å‚æ•°ä¸ªæ•°ã€‚æ¯”å¦‚ï¼Œä¸Šé¢æœ€åä¸€ä¸ªå‡½æ•°ï¼Œå®šä¹‰äº† 3 ä¸ªå‚æ•°ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå‚æ•° c æŒ‡å®šäº†é»˜è®¤å€¼ï¼Œå› æ­¤ length å±æ€§ç­‰äº 3 å‡å» 1 ï¼Œæœ€åå¾—åˆ° 2 ã€‚\nè¿™æ˜¯å› ä¸º length å±æ€§çš„å«ä¹‰æ˜¯ï¼Œè¯¥å‡½æ•° é¢„æœŸä¼ å…¥ çš„å‚æ•°ä¸ªæ•°ã€‚æŸä¸ªå‚æ•°æŒ‡å®šé»˜è®¤å€¼ä»¥åï¼Œé¢„æœŸä¼ å…¥çš„å‚æ•°ä¸ªæ•°å°±ä¸åŒ…æ‹¬è¿™ä¸ªå‚æ•°äº†ã€‚åŒç†ï¼Œåæ–‡çš„ rest å‚æ•°ä¹Ÿä¸ä¼šè®¡å…¥ length å±æ€§ã€‚\n(function(...args) {}).length // 0 å¦‚æœè®¾ç½®äº†é»˜è®¤å€¼çš„å‚æ•°ä¸æ˜¯å°¾å‚æ•°ï¼Œé‚£ä¹ˆ length å±æ€§ä¹Ÿä¸å†è®¡å…¥åé¢çš„å‚æ•°äº†ã€‚\n(function (a = 0, b, c) {}).length // 0 (function (a, b = 1, c) {}).length // 1 ä½œç”¨åŸŸ ä¸€æ—¦è®¾ç½®äº†å‚æ•°çš„é»˜è®¤å€¼ï¼Œå‡½æ•°è¿›è¡Œå£°æ˜åˆå§‹åŒ–æ—¶ï¼Œå‚æ•°ä¼šå½¢æˆä¸€ä¸ªå•ç‹¬çš„ä½œç”¨åŸŸï¼ˆcontextï¼‰ã€‚ç­‰åˆ°åˆå§‹åŒ–ç»“æŸï¼Œè¿™ä¸ªä½œç”¨åŸŸå°±ä¼šæ¶ˆå¤±ã€‚è¿™ç§è¯­æ³•è¡Œä¸ºï¼Œåœ¨ä¸è®¾ç½®å‚æ•°é»˜è®¤å€¼æ—¶ï¼Œæ˜¯ä¸ä¼šå‡ºç°çš„ã€‚\nğŸ“ƒ Example\nvar x = 1; function f(x, y = x) { console.log(y); } f(2) // 2 ä¸Šé¢ä»£ç ä¸­ï¼Œå‚æ•°yçš„é»˜è®¤å€¼ç­‰äºå˜é‡xã€‚è°ƒç”¨å‡½æ•°fæ—¶ï¼Œå‚æ•°å½¢æˆä¸€ä¸ªå•ç‹¬çš„ä½œç”¨åŸŸã€‚åœ¨è¿™ä¸ªä½œç”¨åŸŸé‡Œé¢ï¼Œé»˜è®¤å€¼å˜é‡xæŒ‡å‘ç¬¬ä¸€ä¸ªå‚æ•°xï¼Œè€Œä¸æ˜¯å…¨å±€å˜é‡xï¼Œæ‰€ä»¥è¾“å‡ºæ˜¯2ã€‚\nğŸ“ƒ Example\nlet x = 1; function f(y = x) { let x = 2; console.log(y); } f() // 1 ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°fè°ƒç”¨æ—¶ï¼Œå‚æ•°y = xå½¢æˆä¸€ä¸ªå•ç‹¬çš„ä½œç”¨åŸŸã€‚è¿™ä¸ªä½œç”¨åŸŸé‡Œé¢ï¼Œå˜é‡xæœ¬èº«æ²¡æœ‰å®šä¹‰ï¼Œæ‰€ä»¥æŒ‡å‘å¤–å±‚çš„å…¨å±€å˜é‡xã€‚å‡½æ•°è°ƒç”¨æ—¶ï¼Œå‡½æ•°ä½“å†…éƒ¨çš„å±€éƒ¨å˜é‡xå½±å“ä¸åˆ°é»˜è®¤å€¼å˜é‡xã€‚\nå¦‚æœæ­¤æ—¶ï¼Œå…¨å±€å˜é‡xä¸å­˜åœ¨ï¼Œå°±ä¼šæŠ¥é”™ã€‚\nfunction f(y = x) { let x = 2; console.log(y); } f() // ReferenceError: x is not defined ä¸‹é¢è¿™æ ·å†™ï¼Œä¹Ÿä¼šæŠ¥é”™ã€‚\nvar x = 1; function foo(x = x) { // ... } foo() // ReferenceError: x is not defined ä¸Šé¢ä»£ç ä¸­ï¼Œå‚æ•°x = xå½¢æˆä¸€ä¸ªå•ç‹¬ä½œç”¨åŸŸã€‚å®é™…æ‰§è¡Œçš„æ˜¯let x = xï¼Œç”±äºæš‚æ—¶æ€§æ­»åŒºçš„åŸå› ï¼Œè¿™è¡Œä»£ç ä¼šæŠ¥é”™â€x æœªå®šä¹‰â€œã€‚\nå¦‚æœå‚æ•°çš„é»˜è®¤å€¼æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°çš„ä½œç”¨åŸŸä¹Ÿéµå®ˆè¿™ä¸ªè§„åˆ™ã€‚è¯·çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚\nlet foo = \u0026#39;outer\u0026#39;; function bar(func = () =\u0026gt; foo) { let foo = \u0026#39;inner\u0026#39;; console.log(func()); } bar(); // outer ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°barçš„å‚æ•°funcçš„é»˜è®¤å€¼æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œè¿”å›å€¼ä¸ºå˜é‡fooã€‚å‡½æ•°å‚æ•°å½¢æˆçš„å•ç‹¬ä½œç”¨åŸŸé‡Œé¢ï¼Œå¹¶æ²¡æœ‰å®šä¹‰å˜é‡fooï¼Œæ‰€ä»¥fooæŒ‡å‘å¤–å±‚çš„å…¨å±€å˜é‡fooï¼Œå› æ­¤è¾“å‡ºouterã€‚\nå¦‚æœå†™æˆä¸‹é¢è¿™æ ·ï¼Œå°±ä¼šæŠ¥é”™ã€‚\nfunction bar(func = () =\u0026gt; foo) { let foo = \u0026#39;inner\u0026#39;; console.log(func()); } bar() // ReferenceError: foo is not defined ä¸Šé¢ä»£ç ä¸­ï¼ŒåŒ¿åå‡½æ•°é‡Œé¢çš„fooæŒ‡å‘å‡½æ•°å¤–å±‚ï¼Œä½†æ˜¯å‡½æ•°å¤–å±‚å¹¶æ²¡æœ‰å£°æ˜å˜é‡fooï¼Œæ‰€ä»¥å°±æŠ¥é”™äº†ã€‚\nğŸ“ƒ Example\nä¸‹é¢æ˜¯ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­ã€‚\nvar x = 1; function foo(x, y = function() { x = 2; }) { var x = 3; y(); console.log(x); } åº”ç”¨ åˆ©ç”¨å‚æ•°é»˜è®¤å€¼ï¼Œå¯ä»¥æŒ‡å®šæŸä¸€ä¸ªå‚æ•°ä¸å¾—çœç•¥ï¼Œå¦‚æœçœç•¥å°±æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚\nğŸ“ƒ Example\nfunction throwIfMissing() { throw new Error(\u0026#39;Missing parameter\u0026#39;); } function foo(mustBeProvided = throwIfMissing()) { return mustBeProvided; } foo() // Error: Missing parameter ä¸Šé¢ä»£ç çš„fooå‡½æ•°ï¼Œå¦‚æœè°ƒç”¨çš„æ—¶å€™æ²¡æœ‰å‚æ•°ï¼Œå°±ä¼šè°ƒç”¨é»˜è®¤å€¼throwIfMissingå‡½æ•°ï¼Œä»è€ŒæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚\nä»ä¸Šé¢ä»£ç è¿˜å¯ä»¥çœ‹åˆ°ï¼Œå‚æ•°mustBeProvidedçš„é»˜è®¤å€¼ç­‰äºthrowIfMissingå‡½æ•°çš„è¿è¡Œç»“æœï¼ˆæ³¨æ„å‡½æ•°åthrowIfMissingä¹‹åæœ‰ä¸€å¯¹åœ†æ‹¬å·ï¼‰ï¼Œè¿™è¡¨æ˜å‚æ•°çš„é»˜è®¤å€¼ä¸æ˜¯åœ¨å®šä¹‰æ—¶æ‰§è¡Œï¼Œè€Œæ˜¯åœ¨è¿è¡Œæ—¶æ‰§è¡Œã€‚å¦‚æœå‚æ•°å·²ç»èµ‹å€¼ï¼Œé»˜è®¤å€¼ä¸­çš„å‡½æ•°å°±ä¸ä¼šè¿è¡Œã€‚\nå¦å¤–ï¼Œå¯ä»¥å°†å‚æ•°é»˜è®¤å€¼è®¾ä¸ºundefinedï¼Œè¡¨æ˜è¿™ä¸ªå‚æ•°æ˜¯å¯ä»¥çœç•¥çš„ã€‚\nfunction foo(optional = undefined) { Â·Â·Â· } Rest å‚æ•° ES6 å¼•å…¥ rest å‚æ•°ï¼ˆå½¢å¼ä¸º...å˜é‡åï¼‰ï¼Œç”¨äºè·å–å‡½æ•°çš„å¤šä½™å‚æ•°ï¼Œè¿™æ ·å°±ä¸éœ€è¦ä½¿ç”¨ arguments å¯¹è±¡äº†ã€‚rest å‚æ•°æ­é…çš„å˜é‡æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥å˜é‡å°†å¤šä½™çš„å‚æ•°æ”¾å…¥æ•°ç»„ä¸­ã€‚\nğŸ“ƒ Example\nlet add = (...values) =\u0026gt; { let sum = 0; for (let val of values) { sum += val; } return sum; } add(2, 5, 3) // 10 ä¸Šé¢ä»£ç çš„ add() å‡½æ•°æ˜¯ä¸€ä¸ªæ±‚å’Œå‡½æ•°ï¼Œåˆ©ç”¨ rest å‚æ•°ï¼Œå¯ä»¥å‘è¯¥å‡½æ•°ä¼ å…¥ä»»æ„æ•°ç›®çš„å‚æ•°ã€‚\nğŸ“ƒ Example rest å‚æ•°ä»£æ›¿ [ES5](05 JavaScript#arguments-es5) arguments å˜é‡\n// argumentså˜é‡çš„å†™æ³• function sortNumbers() { return Array.prototype.slice.call(arguments).sort(); } // restå‚æ•°çš„å†™æ³• const sortNumbers = (...numbers) =\u0026gt; numbers.sort(); ä¸Šé¢ä»£ç çš„ä¸¤ç§å†™æ³•ï¼Œæ¯”è¾ƒåå¯ä»¥å‘ç°ï¼Œrest å‚æ•°çš„å†™æ³•æ›´è‡ªç„¶ä¹Ÿæ›´ç®€æ´ã€‚\nargumentså¯¹è±¡ä¸æ˜¯æ•°ç»„ï¼Œè€Œæ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€‚æ‰€ä»¥ä¸ºäº†ä½¿ç”¨æ•°ç»„çš„æ–¹æ³•ï¼Œå¿…é¡»ä½¿ç”¨Array.prototype.slice.callå…ˆå°†å…¶è½¬ä¸ºæ•°ç»„ã€‚rest å‚æ•°å°±ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ•°ç»„ï¼Œæ•°ç»„ç‰¹æœ‰çš„æ–¹æ³•éƒ½å¯ä»¥ä½¿ç”¨ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªåˆ©ç”¨ rest å‚æ•°æ”¹å†™æ•°ç»„pushæ–¹æ³•çš„ä¾‹å­ã€‚\nfunction push(array, ...items) { items.forEach(function(item) { array.push(item); console.log(item); }); } var a = []; push(a, 1, 2, 3) æ³¨æ„ï¼Œrest å‚æ•°ä¹‹åä¸èƒ½å†æœ‰å…¶ä»–å‚æ•°ï¼ˆå³åªèƒ½æ˜¯ æœ€åä¸€ä¸ª å‚æ•°ï¼‰ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚\n// æŠ¥é”™ function f(a, ...b, c) { // ... } å‡½æ•°çš„lengthå±æ€§ï¼Œä¸åŒ…æ‹¬ rest å‚æ•°ã€‚\n(function(a) {}).length // 1 (function(...a) {}).length // 0 (function(a, ...b) {}).length // 1 å±æ€§ Name å‡½æ•°çš„nameå±æ€§ï¼Œè¿”å›è¯¥å‡½æ•°çš„å‡½æ•°åã€‚\nfunction foo() {} foo.name // \u0026#34;foo\u0026#34; è¿™ä¸ªå±æ€§æ—©å°±è¢«æµè§ˆå™¨å¹¿æ³›æ”¯æŒï¼Œä½†æ˜¯ç›´åˆ° ES6ï¼Œæ‰å°†å…¶å†™å…¥äº†æ ‡å‡†ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒES6 å¯¹è¿™ä¸ªå±æ€§çš„è¡Œä¸ºåšå‡ºäº†ä¸€äº›ä¿®æ”¹ã€‚å¦‚æœå°†ä¸€ä¸ªåŒ¿åå‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼ŒES5 çš„nameå±æ€§ï¼Œä¼šè¿”å›ç©ºå­—ç¬¦ä¸²ï¼Œè€Œ ES6 çš„nameå±æ€§ä¼šè¿”å›å®é™…çš„å‡½æ•°åã€‚\nvar f = function () {}; // ES5 f.name // \u0026#34;\u0026#34; // ES6 f.name // \u0026#34;f\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡fç­‰äºä¸€ä¸ªåŒ¿åå‡½æ•°ï¼ŒES5 å’Œ ES6 çš„nameå±æ€§è¿”å›çš„å€¼ä¸ä¸€æ ·ã€‚\nå¦‚æœå°†ä¸€ä¸ªå…·åå‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œåˆ™ ES5 å’Œ ES6 çš„nameå±æ€§éƒ½è¿”å›è¿™ä¸ªå…·åå‡½æ•°åŸæœ¬çš„åå­—ã€‚\nconst bar = function baz() {}; // ES5 bar.name // \u0026#34;baz\u0026#34; // ES6 bar.name // \u0026#34;baz\u0026#34; Functionæ„é€ å‡½æ•°è¿”å›çš„å‡½æ•°å®ä¾‹ï¼Œnameå±æ€§çš„å€¼ä¸ºanonymousã€‚\n(new Function).name // \u0026#34;anonymous\u0026#34; bindè¿”å›çš„å‡½æ•°ï¼Œnameå±æ€§å€¼ä¼šåŠ ä¸Šboundå‰ç¼€ã€‚\nfunction foo() {}; foo.bind({}).name // \u0026#34;bound foo\u0026#34; (function(){}).bind({}).name // \u0026#34;bound \u0026#34; ç®­å¤´å‡½æ•° åŸºæœ¬ç”¨æ³• ES6 å…è®¸ä½¿ç”¨â€œç®­å¤´â€ï¼ˆ=\u0026gt;ï¼‰å®šä¹‰å‡½æ•°ã€‚\nvar f = v =\u0026gt; v; // ç­‰åŒäº var f = function (v) { return v; }; å¦‚æœç®­å¤´å‡½æ•°ä¸éœ€è¦å‚æ•°æˆ–éœ€è¦å¤šä¸ªå‚æ•°ï¼Œå°±ä½¿ç”¨ä¸€ä¸ªåœ†æ‹¬å·ä»£è¡¨å‚æ•°éƒ¨åˆ†ã€‚\nvar f = () =\u0026gt; 5; // ç­‰åŒäº var f = function () { return 5 }; var sum = (num1, num2) =\u0026gt; num1 + num2; // ç­‰åŒäº var sum = function(num1, num2) { return num1 + num2; }; å¦‚æœç®­å¤´å‡½æ•°çš„ä»£ç å—éƒ¨åˆ†å¤šäºä¸€æ¡è¯­å¥ï¼Œå°±è¦ä½¿ç”¨å¤§æ‹¬å·å°†å®ƒä»¬æ‹¬èµ·æ¥ï¼Œå¹¶ä¸”ä½¿ç”¨ return è¯­å¥è¿”å›ã€‚\nvar sum = (num1, num2) =\u0026gt; { return num1 + num2; } ç”±äºå¤§æ‹¬å·è¢«è§£é‡Šä¸ºä»£ç å—ï¼Œæ‰€ä»¥å¦‚æœç®­å¤´å‡½æ•°ç›´æ¥è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¿…é¡»åœ¨å¯¹è±¡å¤–é¢åŠ ä¸Šæ‹¬å·ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚\n// æŠ¥é”™ let getTempItem = id =\u0026gt; { id: id, name: \u0026#34;Temp\u0026#34; }; // ä¸æŠ¥é”™ let getTempItem = id =\u0026gt; ({ id: id, name: \u0026#34;Temp\u0026#34; }); ä¸‹é¢æ˜¯ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œè™½ç„¶å¯ä»¥è¿è¡Œï¼Œä½†ä¼šå¾—åˆ°é”™è¯¯çš„ç»“æœã€‚\nlet foo = () =\u0026gt; { a: 1 }; foo() // undefined ä¸Šé¢ä»£ç ä¸­ï¼ŒåŸå§‹æ„å›¾æ˜¯è¿”å›ä¸€ä¸ªå¯¹è±¡{ a: 1 }ï¼Œä½†æ˜¯ç”±äºå¼•æ“è®¤ä¸ºå¤§æ‹¬å·æ˜¯ä»£ç å—ï¼Œæ‰€ä»¥æ‰§è¡Œäº†ä¸€è¡Œè¯­å¥a: 1ã€‚è¿™æ—¶ï¼Œaå¯ä»¥è¢«è§£é‡Šä¸ºè¯­å¥çš„æ ‡ç­¾ï¼Œå› æ­¤å®é™…æ‰§è¡Œçš„è¯­å¥æ˜¯1;ï¼Œç„¶åå‡½æ•°å°±ç»“æŸäº†ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚\nå¦‚æœç®­å¤´å‡½æ•°åªæœ‰ä¸€è¡Œè¯­å¥ï¼Œä¸”ä¸éœ€è¦è¿”å›å€¼ï¼Œå¯ä»¥é‡‡ç”¨ä¸‹é¢çš„å†™æ³•ï¼Œå°±ä¸ç”¨å†™å¤§æ‹¬å·äº†ã€‚\nlet fn = () =\u0026gt; void doesNotReturn(); ç®­å¤´å‡½æ•°å¯ä»¥ä¸å˜é‡è§£æ„ç»“åˆä½¿ç”¨ã€‚\nconst full = ({ first, last }) =\u0026gt; first + \u0026#39; \u0026#39; + last; // ç­‰åŒäº function full(person) { return person.first + \u0026#39; \u0026#39; + person.last; } ç®­å¤´å‡½æ•°ä½¿å¾—è¡¨è¾¾æ›´åŠ ç®€æ´ã€‚\nconst isEven = n =\u0026gt; n % 2 === 0; const square = n =\u0026gt; n * n; ä¸Šé¢ä»£ç åªç”¨äº†ä¸¤è¡Œï¼Œå°±å®šä¹‰äº†ä¸¤ä¸ªç®€å•çš„å·¥å…·å‡½æ•°ã€‚å¦‚æœä¸ç”¨ç®­å¤´å‡½æ•°ï¼Œå¯èƒ½å°±è¦å ç”¨å¤šè¡Œï¼Œè€Œä¸”è¿˜ä¸å¦‚ç°åœ¨è¿™æ ·å†™é†’ç›®ã€‚\nç®­å¤´å‡½æ•°çš„ä¸€ä¸ªç”¨å¤„æ˜¯ç®€åŒ–å›è°ƒå‡½æ•°ã€‚\n// æ­£å¸¸å‡½æ•°å†™æ³• [1,2,3].map(function (x) { return x * x; }); // ç®­å¤´å‡½æ•°å†™æ³• [1,2,3].map(x =\u0026gt; x * x); å¦ä¸€ä¸ªä¾‹å­æ˜¯\n// æ­£å¸¸å‡½æ•°å†™æ³• var result = values.sort(function (a, b) { return a - b; }); // ç®­å¤´å‡½æ•°å†™æ³• var result = values.sort((a, b) =\u0026gt; a - b); ä¸‹é¢æ˜¯ rest å‚æ•°ä¸ç®­å¤´å‡½æ•°ç»“åˆçš„ä¾‹å­ã€‚\nconst numbers = (...nums) =\u0026gt; nums; numbers(1, 2, 3, 4, 5) // [1,2,3,4,5] const headAndTail = (head, ...tail) =\u0026gt; [head, tail]; headAndTail(1, 2, 3, 4, 5) // [1,[2,3,4,5]] ä½¿ç”¨æ³¨æ„ç‚¹ ç®­å¤´å‡½æ•°æœ‰å‡ ä¸ªä½¿ç”¨æ³¨æ„ç‚¹ã€‚\nï¼ˆ1ï¼‰å‡½æ•°ä½“å†…çš„thiså¯¹è±¡ï¼Œå°±æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡ã€‚\nï¼ˆ2ï¼‰ä¸å¯ä»¥å½“ä½œæ„é€ å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¯ä»¥ä½¿ç”¨newå‘½ä»¤ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚\nï¼ˆ3ï¼‰ä¸å¯ä»¥ä½¿ç”¨argumentså¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨å‡½æ•°ä½“å†…ä¸å­˜åœ¨ã€‚å¦‚æœè¦ç”¨ï¼Œå¯ä»¥ç”¨ rest å‚æ•°ä»£æ›¿ã€‚\nï¼ˆ4ï¼‰ä¸å¯ä»¥ä½¿ç”¨yieldå‘½ä»¤ï¼Œå› æ­¤ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œ Generator å‡½æ•°ã€‚\nä¸Šé¢å››ç‚¹ä¸­ï¼Œç¬¬ä¸€ç‚¹å°¤å…¶å€¼å¾—æ³¨æ„ã€‚thiså¯¹è±¡çš„æŒ‡å‘æ˜¯å¯å˜çš„ï¼Œä½†æ˜¯åœ¨ç®­å¤´å‡½æ•°ä¸­ï¼Œå®ƒæ˜¯å›ºå®šçš„ã€‚\nfunction foo() { setTimeout(() =\u0026gt; { console.log(\u0026#39;id:\u0026#39;, this.id); }, 100); } var id = 21; foo.call({ id: 42 }); // id: 42 ä¸Šé¢ä»£ç ä¸­ï¼ŒsetTimeout()çš„å‚æ•°æ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œè¿™ä¸ªç®­å¤´å‡½æ•°çš„å®šä¹‰ç”Ÿæ•ˆæ˜¯åœ¨fooå‡½æ•°ç”Ÿæˆæ—¶ï¼Œè€Œå®ƒçš„çœŸæ­£æ‰§è¡Œè¦ç­‰åˆ° 100 æ¯«ç§’åã€‚å¦‚æœæ˜¯æ™®é€šå‡½æ•°ï¼Œæ‰§è¡Œæ—¶thisåº”è¯¥æŒ‡å‘å…¨å±€å¯¹è±¡windowï¼Œè¿™æ—¶åº”è¯¥è¾“å‡º21ã€‚ä½†æ˜¯ï¼Œç®­å¤´å‡½æ•°å¯¼è‡´thisæ€»æ˜¯æŒ‡å‘å‡½æ•°å®šä¹‰ç”Ÿæ•ˆæ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼ˆæœ¬ä¾‹æ˜¯{id: 42}ï¼‰ï¼Œæ‰€ä»¥æ‰“å°å‡ºæ¥çš„æ˜¯42ã€‚\nç®­å¤´å‡½æ•°å¯ä»¥è®©setTimeouté‡Œé¢çš„thisï¼Œç»‘å®šå®šä¹‰æ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸï¼Œè€Œä¸æ˜¯æŒ‡å‘è¿è¡Œæ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸã€‚ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚\nfunction Timer() { this.s1 = 0; this.s2 = 0; // ç®­å¤´å‡½æ•° setInterval(() =\u0026gt; this.s1++, 1000); // æ™®é€šå‡½æ•° setInterval(function () { this.s2++; }, 1000); } var timer = new Timer(); setTimeout(() =\u0026gt; console.log(\u0026#39;s1: \u0026#39;, timer.s1), 3100); setTimeout(() =\u0026gt; console.log(\u0026#39;s2: \u0026#39;, timer.s2), 3100); // s1: 3 // s2: 0 ä¸Šé¢ä»£ç ä¸­ï¼ŒTimerå‡½æ•°å†…éƒ¨è®¾ç½®äº†ä¸¤ä¸ªå®šæ—¶å™¨ï¼Œåˆ†åˆ«ä½¿ç”¨äº†ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°ã€‚å‰è€…çš„thisç»‘å®šå®šä¹‰æ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸï¼ˆå³Timerå‡½æ•°ï¼‰ï¼Œåè€…çš„thisæŒ‡å‘è¿è¡Œæ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸï¼ˆå³å…¨å±€å¯¹è±¡ï¼‰ã€‚æ‰€ä»¥ï¼Œ3100 æ¯«ç§’ä¹‹åï¼Œtimer.s1è¢«æ›´æ–°äº† 3 æ¬¡ï¼Œè€Œtimer.s2ä¸€æ¬¡éƒ½æ²¡æ›´æ–°ã€‚\nç®­å¤´å‡½æ•°å¯ä»¥è®©thisæŒ‡å‘å›ºå®šåŒ–ï¼Œè¿™ç§ç‰¹æ€§å¾ˆæœ‰åˆ©äºå°è£…å›è°ƒå‡½æ•°ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼ŒDOM äº‹ä»¶çš„å›è°ƒå‡½æ•°å°è£…åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œé¢ã€‚\nvar handler = { id: \u0026#39;123456\u0026#39;, init: function() { document.addEventListener(\u0026#39;click\u0026#39;, event =\u0026gt; this.doSomething(event.type), false); }, doSomething: function(type) { console.log(\u0026#39;Handling \u0026#39; + type + \u0026#39; for \u0026#39; + this.id); } }; ä¸Šé¢ä»£ç çš„initæ–¹æ³•ä¸­ï¼Œä½¿ç”¨äº†ç®­å¤´å‡½æ•°ï¼Œè¿™å¯¼è‡´è¿™ä¸ªç®­å¤´å‡½æ•°é‡Œé¢çš„thisï¼Œæ€»æ˜¯æŒ‡å‘handlerå¯¹è±¡ã€‚å¦åˆ™ï¼Œå›è°ƒå‡½æ•°è¿è¡Œæ—¶ï¼Œthis.doSomethingè¿™ä¸€è¡Œä¼šæŠ¥é”™ï¼Œå› ä¸ºæ­¤æ—¶thisæŒ‡å‘documentå¯¹è±¡ã€‚\nthisæŒ‡å‘çš„å›ºå®šåŒ–ï¼Œå¹¶ä¸æ˜¯å› ä¸ºç®­å¤´å‡½æ•°å†…éƒ¨æœ‰ç»‘å®šthisçš„æœºåˆ¶ï¼Œå®é™…åŸå› æ˜¯ç®­å¤´å‡½æ•°æ ¹æœ¬æ²¡æœ‰è‡ªå·±çš„thisï¼Œå¯¼è‡´å†…éƒ¨çš„thiså°±æ˜¯å¤–å±‚ä»£ç å—çš„thisã€‚æ­£æ˜¯å› ä¸ºå®ƒæ²¡æœ‰thisï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸èƒ½ç”¨ä½œæ„é€ å‡½æ•°ã€‚\næ‰€ä»¥ï¼Œç®­å¤´å‡½æ•°è½¬æˆ ES5 çš„ä»£ç å¦‚ä¸‹ã€‚\n// ES6 function foo() { setTimeout(() =\u0026gt; { console.log(\u0026#39;id:\u0026#39;, this.id); }, 100); } // ES5 function foo() { var _this = this; setTimeout(function () { console.log(\u0026#39;id:\u0026#39;, _this.id); }, 100); } ä¸Šé¢ä»£ç ä¸­ï¼Œè½¬æ¢åçš„ ES5 ç‰ˆæœ¬æ¸…æ¥šåœ°è¯´æ˜äº†ï¼Œç®­å¤´å‡½æ•°é‡Œé¢æ ¹æœ¬æ²¡æœ‰è‡ªå·±çš„thisï¼Œè€Œæ˜¯å¼•ç”¨å¤–å±‚çš„thisã€‚\nè¯·é—®ä¸‹é¢çš„ä»£ç ä¹‹ä¸­æœ‰å‡ ä¸ªthisï¼Ÿ\nfunction foo() { return () =\u0026gt; { return () =\u0026gt; { return () =\u0026gt; { console.log(\u0026#39;id:\u0026#39;, this.id); }; }; }; } var f = foo.call({id: 1}); var t1 = f.call({id: 2})()(); // id: 1 var t2 = f().call({id: 3})(); // id: 1 var t3 = f()().call({id: 4}); // id: 1 ä¸Šé¢ä»£ç ä¹‹ä¸­ï¼Œåªæœ‰ä¸€ä¸ªthisï¼Œå°±æ˜¯å‡½æ•°fooçš„thisï¼Œæ‰€ä»¥t1ã€t2ã€t3éƒ½è¾“å‡ºåŒæ ·çš„ç»“æœã€‚å› ä¸ºæ‰€æœ‰çš„å†…å±‚å‡½æ•°éƒ½æ˜¯ç®­å¤´å‡½æ•°ï¼Œéƒ½æ²¡æœ‰è‡ªå·±çš„thisï¼Œå®ƒä»¬çš„thiså…¶å®éƒ½æ˜¯æœ€å¤–å±‚fooå‡½æ•°çš„thisã€‚\né™¤äº†thisï¼Œä»¥ä¸‹ä¸‰ä¸ªå˜é‡åœ¨ç®­å¤´å‡½æ•°ä¹‹ä¸­ä¹Ÿæ˜¯ä¸å­˜åœ¨çš„ï¼ŒæŒ‡å‘å¤–å±‚å‡½æ•°çš„å¯¹åº”å˜é‡ï¼šargumentsã€superã€new.targetã€‚\nfunction foo() { setTimeout(() =\u0026gt; { console.log(\u0026#39;args:\u0026#39;, arguments); }, 100); } foo(2, 4, 6, 8) // args: [2, 4, 6, 8] ä¸Šé¢ä»£ç ä¸­ï¼Œç®­å¤´å‡½æ•°å†…éƒ¨çš„å˜é‡argumentsï¼Œå…¶å®æ˜¯å‡½æ•°fooçš„argumentså˜é‡ã€‚\nå¦å¤–ï¼Œç”±äºç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„thisï¼Œæ‰€ä»¥å½“ç„¶ä¹Ÿå°±ä¸èƒ½ç”¨call()ã€apply()ã€bind()è¿™äº›æ–¹æ³•å»æ”¹å˜thisçš„æŒ‡å‘ã€‚\n(function() { return [ (() =\u0026gt; this.x).bind({ x: \u0026#39;inner\u0026#39; })() ]; }).call({ x: \u0026#39;outer\u0026#39; }); // [\u0026#39;outer\u0026#39;] ä¸Šé¢ä»£ç ä¸­ï¼Œç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„thisï¼Œæ‰€ä»¥bindæ–¹æ³•æ— æ•ˆï¼Œå†…éƒ¨çš„thisæŒ‡å‘å¤–éƒ¨çš„thisã€‚\né•¿æœŸä»¥æ¥ï¼ŒJavaScript è¯­è¨€çš„thiså¯¹è±¡ä¸€ç›´æ˜¯ä¸€ä¸ªä»¤äººå¤´ç—›çš„é—®é¢˜ï¼Œåœ¨å¯¹è±¡æ–¹æ³•ä¸­ä½¿ç”¨thisï¼Œå¿…é¡»éå¸¸å°å¿ƒã€‚ç®­å¤´å‡½æ•°â€ç»‘å®šâ€thisï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šè§£å†³äº†è¿™ä¸ªå›°æ‰°ã€‚\nä¸é€‚ç”¨åœºåˆ ç”±äºç®­å¤´å‡½æ•°ä½¿å¾—thisä»â€œåŠ¨æ€â€å˜æˆâ€œé™æ€â€ï¼Œä¸‹é¢ä¸¤ä¸ªåœºåˆä¸åº”è¯¥ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚\nç¬¬ä¸€ä¸ªåœºåˆæ˜¯å®šä¹‰å¯¹è±¡çš„æ–¹æ³•ï¼Œä¸”è¯¥æ–¹æ³•å†…éƒ¨åŒ…æ‹¬thisã€‚\nconst cat = { lives: 9, jumps: () =\u0026gt; { this.lives--; } } ä¸Šé¢ä»£ç ä¸­ï¼Œcat.jumps()æ–¹æ³•æ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œè¿™æ˜¯é”™è¯¯çš„ã€‚è°ƒç”¨cat.jumps()æ—¶ï¼Œå¦‚æœæ˜¯æ™®é€šå‡½æ•°ï¼Œè¯¥æ–¹æ³•å†…éƒ¨çš„thisæŒ‡å‘catï¼›å¦‚æœå†™æˆä¸Šé¢é‚£æ ·çš„ç®­å¤´å‡½æ•°ï¼Œä½¿å¾—thisæŒ‡å‘å…¨å±€å¯¹è±¡ï¼Œå› æ­¤ä¸ä¼šå¾—åˆ°é¢„æœŸç»“æœã€‚è¿™æ˜¯å› ä¸ºå¯¹è±¡ä¸æ„æˆå•ç‹¬çš„ä½œç”¨åŸŸï¼Œå¯¼è‡´jumpsç®­å¤´å‡½æ•°å®šä¹‰æ—¶çš„ä½œç”¨åŸŸå°±æ˜¯å…¨å±€ä½œç”¨åŸŸã€‚\nç¬¬äºŒä¸ªåœºåˆæ˜¯éœ€è¦åŠ¨æ€thisçš„æ—¶å€™ï¼Œä¹Ÿä¸åº”ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚\nvar button = document.getElementById(\u0026#39;press\u0026#39;); button.addEventListener(\u0026#39;click\u0026#39;, () =\u0026gt; { this.classList.toggle(\u0026#39;on\u0026#39;); }); ä¸Šé¢ä»£ç è¿è¡Œæ—¶ï¼Œç‚¹å‡»æŒ‰é’®ä¼šæŠ¥é”™ï¼Œå› ä¸ºbuttonçš„ç›‘å¬å‡½æ•°æ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œå¯¼è‡´é‡Œé¢çš„thiså°±æ˜¯å…¨å±€å¯¹è±¡ã€‚å¦‚æœæ”¹æˆæ™®é€šå‡½æ•°ï¼Œthiså°±ä¼šåŠ¨æ€æŒ‡å‘è¢«ç‚¹å‡»çš„æŒ‰é’®å¯¹è±¡ã€‚\nå¦å¤–ï¼Œå¦‚æœå‡½æ•°ä½“å¾ˆå¤æ‚ï¼Œæœ‰è®¸å¤šè¡Œï¼Œæˆ–è€…å‡½æ•°å†…éƒ¨æœ‰å¤§é‡çš„è¯»å†™æ“ä½œï¼Œä¸å•çº¯æ˜¯ä¸ºäº†è®¡ç®—å€¼ï¼Œè¿™æ—¶ä¹Ÿä¸åº”è¯¥ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œè€Œæ˜¯è¦ä½¿ç”¨æ™®é€šå‡½æ•°ï¼Œè¿™æ ·å¯ä»¥æé«˜ä»£ç å¯è¯»æ€§ã€‚\nåµŒå¥—çš„ç®­å¤´å‡½æ•° ç®­å¤´å‡½æ•°å†…éƒ¨ï¼Œè¿˜å¯ä»¥å†ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ª ES5 è¯­æ³•çš„å¤šé‡åµŒå¥—å‡½æ•°ã€‚\nfunction insert(value) { return {into: function (array) { return {after: function (afterValue) { array.splice(array.indexOf(afterValue) + 1, 0, value); return array; }}; }}; } insert(2).into([1, 3]).after(1); //[1, 2, 3] ä¸Šé¢è¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ç®­å¤´å‡½æ•°æ”¹å†™ã€‚\nlet insert = (value) =\u0026gt; ({into: (array) =\u0026gt; ({after: (afterValue) =\u0026gt; { array.splice(array.indexOf(afterValue) + 1, 0, value); return array; }})}); insert(2).into([1, 3]).after(1); //[1, 2, 3] ä¸‹é¢æ˜¯ä¸€ä¸ªéƒ¨ç½²ç®¡é“æœºåˆ¶ï¼ˆpipelineï¼‰çš„ä¾‹å­ï¼Œå³å‰ä¸€ä¸ªå‡½æ•°çš„è¾“å‡ºæ˜¯åä¸€ä¸ªå‡½æ•°çš„è¾“å…¥ã€‚\nconst pipeline = (...funcs) =\u0026gt; val =\u0026gt; funcs.reduce((a, b) =\u0026gt; b(a), val); const plus1 = a =\u0026gt; a + 1; const mult2 = a =\u0026gt; a * 2; const addThenMult = pipeline(plus1, mult2); addThenMult(5) // 12 å¦‚æœè§‰å¾—ä¸Šé¢çš„å†™æ³•å¯è¯»æ€§æ¯”è¾ƒå·®ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨ä¸‹é¢çš„å†™æ³•ã€‚\nconst plus1 = a =\u0026gt; a + 1; const mult2 = a =\u0026gt; a * 2; mult2(plus1(5)) // 12 ç®­å¤´å‡½æ•°è¿˜æœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œå°±æ˜¯å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ”¹å†™ Î» æ¼”ç®—ã€‚\n// Î»æ¼”ç®—çš„å†™æ³• fix = Î»f.(Î»x.f(Î»v.x(x)(v)))(Î»x.f(Î»v.x(x)(v))) // ES6çš„å†™æ³• var fix = f =\u0026gt; (x =\u0026gt; f(v =\u0026gt; x(x)(v))) (x =\u0026gt; f(v =\u0026gt; x(x)(v))); ä¸Šé¢ä¸¤ç§å†™æ³•ï¼Œå‡ ä¹æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚ç”±äº Î» æ¼”ç®—å¯¹äºè®¡ç®—æœºç§‘å­¦éå¸¸é‡è¦ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥ç”¨ ES6 ä½œä¸ºæ›¿ä»£å·¥å…·ï¼Œæ¢ç´¢è®¡ç®—æœºç§‘å­¦ã€‚\nå°¾è°ƒç”¨ä¼˜åŒ– ä»€ä¹ˆæ˜¯å°¾è°ƒç”¨ï¼Ÿ å°¾è°ƒç”¨ï¼ˆTail Callï¼‰æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œæœ¬èº«éå¸¸ç®€å•ï¼Œä¸€å¥è¯å°±èƒ½è¯´æ¸…æ¥šï¼Œå°±æ˜¯æŒ‡æŸä¸ªå‡½æ•°çš„æœ€åä¸€æ­¥æ˜¯è°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°ã€‚\nfunction f(x){ return g(x); } ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°fçš„æœ€åä¸€æ­¥æ˜¯è°ƒç”¨å‡½æ•°gï¼Œè¿™å°±å«å°¾è°ƒç”¨ã€‚\nä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼Œéƒ½ä¸å±äºå°¾è°ƒç”¨ã€‚\n// æƒ…å†µä¸€ function f(x){ let y = g(x); return y; } // æƒ…å†µäºŒ function f(x){ return g(x) + 1; } // æƒ…å†µä¸‰ function f(x){ g(x); } ä¸Šé¢ä»£ç ä¸­ï¼Œæƒ…å†µä¸€æ˜¯è°ƒç”¨å‡½æ•°gä¹‹åï¼Œè¿˜æœ‰èµ‹å€¼æ“ä½œï¼Œæ‰€ä»¥ä¸å±äºå°¾è°ƒç”¨ï¼Œå³ä½¿è¯­ä¹‰å®Œå…¨ä¸€æ ·ã€‚æƒ…å†µäºŒä¹Ÿå±äºè°ƒç”¨åè¿˜æœ‰æ“ä½œï¼Œå³ä½¿å†™åœ¨ä¸€è¡Œå†…ã€‚æƒ…å†µä¸‰ç­‰åŒäºä¸‹é¢çš„ä»£ç ã€‚\nfunction f(x){ g(x); return undefined; } å°¾è°ƒç”¨ä¸ä¸€å®šå‡ºç°åœ¨å‡½æ•°å°¾éƒ¨ï¼Œåªè¦æ˜¯æœ€åä¸€æ­¥æ“ä½œå³å¯ã€‚\nfunction f(x) { if (x \u0026gt; 0) { return m(x) } return n(x); } ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°må’Œnéƒ½å±äºå°¾è°ƒç”¨ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ˜¯å‡½æ•°fçš„æœ€åä¸€æ­¥æ“ä½œã€‚\nå°¾è°ƒç”¨ä¼˜åŒ– å°¾è°ƒç”¨ä¹‹æ‰€ä»¥ä¸å…¶ä»–è°ƒç”¨ä¸åŒï¼Œå°±åœ¨äºå®ƒçš„ç‰¹æ®Šçš„è°ƒç”¨ä½ç½®ã€‚\næˆ‘ä»¬çŸ¥é“ï¼Œå‡½æ•°è°ƒç”¨ä¼šåœ¨å†…å­˜å½¢æˆä¸€ä¸ªâ€œè°ƒç”¨è®°å½•â€ï¼Œåˆç§°â€œè°ƒç”¨å¸§â€ï¼ˆcall frameï¼‰ï¼Œä¿å­˜è°ƒç”¨ä½ç½®å’Œå†…éƒ¨å˜é‡ç­‰ä¿¡æ¯ã€‚å¦‚æœåœ¨å‡½æ•°Açš„å†…éƒ¨è°ƒç”¨å‡½æ•°Bï¼Œé‚£ä¹ˆåœ¨Açš„è°ƒç”¨å¸§ä¸Šæ–¹ï¼Œè¿˜ä¼šå½¢æˆä¸€ä¸ªBçš„è°ƒç”¨å¸§ã€‚ç­‰åˆ°Bè¿è¡Œç»“æŸï¼Œå°†ç»“æœè¿”å›åˆ°Aï¼ŒBçš„è°ƒç”¨å¸§æ‰ä¼šæ¶ˆå¤±ã€‚å¦‚æœå‡½æ•°Bå†…éƒ¨è¿˜è°ƒç”¨å‡½æ•°Cï¼Œé‚£å°±è¿˜æœ‰ä¸€ä¸ªCçš„è°ƒç”¨å¸§ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ‰€æœ‰çš„è°ƒç”¨å¸§ï¼Œå°±å½¢æˆä¸€ä¸ªâ€œè°ƒç”¨æ ˆâ€ï¼ˆcall stackï¼‰ã€‚\nå°¾è°ƒç”¨ç”±äºæ˜¯å‡½æ•°çš„æœ€åä¸€æ­¥æ“ä½œï¼Œæ‰€ä»¥ä¸éœ€è¦ä¿ç•™å¤–å±‚å‡½æ•°çš„è°ƒç”¨å¸§ï¼Œå› ä¸ºè°ƒç”¨ä½ç½®ã€å†…éƒ¨å˜é‡ç­‰ä¿¡æ¯éƒ½ä¸ä¼šå†ç”¨åˆ°äº†ï¼Œåªè¦ç›´æ¥ç”¨å†…å±‚å‡½æ•°çš„è°ƒç”¨å¸§ï¼Œå–ä»£å¤–å±‚å‡½æ•°çš„è°ƒç”¨å¸§å°±å¯ä»¥äº†ã€‚\nfunction f() { let m = 1; let n = 2; return g(m + n); } f(); // ç­‰åŒäº function f() { return g(3); } f(); // ç­‰åŒäº g(3); ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœå‡½æ•°gä¸æ˜¯å°¾è°ƒç”¨ï¼Œå‡½æ•°få°±éœ€è¦ä¿å­˜å†…éƒ¨å˜é‡må’Œnçš„å€¼ã€gçš„è°ƒç”¨ä½ç½®ç­‰ä¿¡æ¯ã€‚ä½†ç”±äºè°ƒç”¨gä¹‹åï¼Œå‡½æ•°få°±ç»“æŸäº†ï¼Œæ‰€ä»¥æ‰§è¡Œåˆ°æœ€åä¸€æ­¥ï¼Œå®Œå…¨å¯ä»¥åˆ é™¤f(x)çš„è°ƒç”¨å¸§ï¼Œåªä¿ç•™g(3)çš„è°ƒç”¨å¸§ã€‚\nè¿™å°±å«åšâ€œå°¾è°ƒç”¨ä¼˜åŒ–â€ï¼ˆTail call optimizationï¼‰ï¼Œå³åªä¿ç•™å†…å±‚å‡½æ•°çš„è°ƒç”¨å¸§ã€‚å¦‚æœæ‰€æœ‰å‡½æ•°éƒ½æ˜¯å°¾è°ƒç”¨ï¼Œé‚£ä¹ˆå®Œå…¨å¯ä»¥åšåˆ°æ¯æ¬¡æ‰§è¡Œæ—¶ï¼Œè°ƒç”¨å¸§åªæœ‰ä¸€é¡¹ï¼Œè¿™å°†å¤§å¤§èŠ‚çœå†…å­˜ã€‚è¿™å°±æ˜¯â€œå°¾è°ƒç”¨ä¼˜åŒ–â€çš„æ„ä¹‰ã€‚\næ³¨æ„ï¼Œåªæœ‰ä¸å†ç”¨åˆ°å¤–å±‚å‡½æ•°çš„å†…éƒ¨å˜é‡ï¼Œå†…å±‚å‡½æ•°çš„è°ƒç”¨å¸§æ‰ä¼šå–ä»£å¤–å±‚å‡½æ•°çš„è°ƒç”¨å¸§ï¼Œå¦åˆ™å°±æ— æ³•è¿›è¡Œâ€œå°¾è°ƒç”¨ä¼˜åŒ–â€ã€‚\nfunction addOne(a){ var one = 1; function inner(b){ return b + one; } return inner(a); } ä¸Šé¢çš„å‡½æ•°ä¸ä¼šè¿›è¡Œå°¾è°ƒç”¨ä¼˜åŒ–ï¼Œå› ä¸ºå†…å±‚å‡½æ•°innerç”¨åˆ°äº†å¤–å±‚å‡½æ•°addOneçš„å†…éƒ¨å˜é‡oneã€‚\næ³¨æ„ï¼Œç›®å‰åªæœ‰ Safari æµè§ˆå™¨æ”¯æŒå°¾è°ƒç”¨ä¼˜åŒ–ï¼ŒChrome å’Œ Firefox éƒ½ä¸æ”¯æŒã€‚\nå°¾é€’å½’ å‡½æ•°è°ƒç”¨è‡ªèº«ï¼Œç§°ä¸ºé€’å½’ã€‚å¦‚æœå°¾è°ƒç”¨è‡ªèº«ï¼Œå°±ç§°ä¸ºå°¾é€’å½’ã€‚\né€’å½’éå¸¸è€—è´¹å†…å­˜ï¼Œå› ä¸ºéœ€è¦åŒæ—¶ä¿å­˜æˆåƒä¸Šç™¾ä¸ªè°ƒç”¨å¸§ï¼Œå¾ˆå®¹æ˜“å‘ç”Ÿâ€œæ ˆæº¢å‡ºâ€é”™è¯¯ï¼ˆstack overflowï¼‰ã€‚ä½†å¯¹äºå°¾é€’å½’æ¥è¯´ï¼Œç”±äºåªå­˜åœ¨ä¸€ä¸ªè°ƒç”¨å¸§ï¼Œæ‰€ä»¥æ°¸è¿œä¸ä¼šå‘ç”Ÿâ€œæ ˆæº¢å‡ºâ€é”™è¯¯ã€‚\nfunction factorial(n) { if (n === 1) return 1; return n * factorial(n - 1); } factorial(5) // 120 ä¸Šé¢ä»£ç æ˜¯ä¸€ä¸ªé˜¶ä¹˜å‡½æ•°ï¼Œè®¡ç®—nçš„é˜¶ä¹˜ï¼Œæœ€å¤šéœ€è¦ä¿å­˜nä¸ªè°ƒç”¨è®°å½•ï¼Œå¤æ‚åº¦ O(n) ã€‚\nå¦‚æœæ”¹å†™æˆå°¾é€’å½’ï¼Œåªä¿ç•™ä¸€ä¸ªè°ƒç”¨è®°å½•ï¼Œå¤æ‚åº¦ O(1) ã€‚\nfunction factorial(n, total) { if (n === 1) return total; return factorial(n - 1, n * total); } factorial(5, 1) // 120 è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒè‘—åçš„ä¾‹å­ï¼Œå°±æ˜¯è®¡ç®— Fibonacci æ•°åˆ—ï¼Œä¹Ÿèƒ½å……åˆ†è¯´æ˜å°¾é€’å½’ä¼˜åŒ–çš„é‡è¦æ€§ã€‚\néå°¾é€’å½’çš„ Fibonacci æ•°åˆ—å®ç°å¦‚ä¸‹ã€‚\nfunction Fibonacci (n) { if ( n \u0026lt;= 1 ) {return 1}; return Fibonacci(n - 1) + Fibonacci(n - 2); } Fibonacci(10) // 89 Fibonacci(100) // è¶…æ—¶ Fibonacci(500) // è¶…æ—¶ å°¾é€’å½’ä¼˜åŒ–è¿‡çš„ Fibonacci æ•°åˆ—å®ç°å¦‚ä¸‹ã€‚\nfunction Fibonacci2 (n , ac1 = 1 , ac2 = 1) { if( n \u0026lt;= 1 ) {return ac2}; return Fibonacci2 (n - 1, ac2, ac1 + ac2); } Fibonacci2(100) // 573147844013817200000 Fibonacci2(1000) // 7.0330367711422765e+208 Fibonacci2(10000) // Infinity ç”±æ­¤å¯è§ï¼Œâ€œå°¾è°ƒç”¨ä¼˜åŒ–â€å¯¹é€’å½’æ“ä½œæ„ä¹‰é‡å¤§ï¼Œæ‰€ä»¥ä¸€äº›å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€å°†å…¶å†™å…¥äº†è¯­è¨€è§„æ ¼ã€‚ES6 äº¦æ˜¯å¦‚æ­¤ï¼Œç¬¬ä¸€æ¬¡æ˜ç¡®è§„å®šï¼Œæ‰€æœ‰ ECMAScript çš„å®ç°ï¼Œéƒ½å¿…é¡»éƒ¨ç½²â€œå°¾è°ƒç”¨ä¼˜åŒ–â€ã€‚è¿™å°±æ˜¯è¯´ï¼ŒES6 ä¸­åªè¦ä½¿ç”¨å°¾é€’å½’ï¼Œå°±ä¸ä¼šå‘ç”Ÿæ ˆæº¢å‡ºï¼ˆæˆ–è€…å±‚å±‚é€’å½’é€ æˆçš„è¶…æ—¶ï¼‰ï¼Œç›¸å¯¹èŠ‚çœå†…å­˜ã€‚\né€’å½’å‡½æ•°çš„æ”¹å†™ å°¾é€’å½’çš„å®ç°ï¼Œå¾€å¾€éœ€è¦æ”¹å†™é€’å½’å‡½æ•°ï¼Œç¡®ä¿æœ€åä¸€æ­¥åªè°ƒç”¨è‡ªèº«ã€‚åšåˆ°è¿™ä¸€ç‚¹çš„æ–¹æ³•ï¼Œå°±æ˜¯æŠŠæ‰€æœ‰ç”¨åˆ°çš„å†…éƒ¨å˜é‡æ”¹å†™æˆå‡½æ•°çš„å‚æ•°ã€‚æ¯”å¦‚ä¸Šé¢çš„ä¾‹å­ï¼Œé˜¶ä¹˜å‡½æ•° factorial éœ€è¦ç”¨åˆ°ä¸€ä¸ªä¸­é—´å˜é‡totalï¼Œé‚£å°±æŠŠè¿™ä¸ªä¸­é—´å˜é‡æ”¹å†™æˆå‡½æ•°çš„å‚æ•°ã€‚è¿™æ ·åšçš„ç¼ºç‚¹å°±æ˜¯ä¸å¤ªç›´è§‚ï¼Œç¬¬ä¸€çœ¼å¾ˆéš¾çœ‹å‡ºæ¥ï¼Œä¸ºä»€ä¹ˆè®¡ç®—5çš„é˜¶ä¹˜ï¼Œéœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°5å’Œ1ï¼Ÿ\nä¸¤ä¸ªæ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ–¹æ³•ä¸€æ˜¯åœ¨å°¾é€’å½’å‡½æ•°ä¹‹å¤–ï¼Œå†æä¾›ä¸€ä¸ªæ­£å¸¸å½¢å¼çš„å‡½æ•°ã€‚\nfunction tailFactorial(n, total) { if (n === 1) return total; return tailFactorial(n - 1, n * total); } function factorial(n) { return tailFactorial(n, 1); } factorial(5) // 120 ä¸Šé¢ä»£ç é€šè¿‡ä¸€ä¸ªæ­£å¸¸å½¢å¼çš„é˜¶ä¹˜å‡½æ•°factorialï¼Œè°ƒç”¨å°¾é€’å½’å‡½æ•°tailFactorialï¼Œçœ‹èµ·æ¥å°±æ­£å¸¸å¤šäº†ã€‚\nå‡½æ•°å¼ç¼–ç¨‹æœ‰ä¸€ä¸ªæ¦‚å¿µï¼Œå«åšæŸ¯é‡ŒåŒ–ï¼ˆcurryingï¼‰ï¼Œæ„æ€æ˜¯å°†å¤šå‚æ•°çš„å‡½æ•°è½¬æ¢æˆå•å‚æ•°çš„å½¢å¼ã€‚è¿™é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨æŸ¯é‡ŒåŒ–ã€‚\nfunction currying(fn, n) { return function (m) { return fn.call(this, m, n); }; } function tailFactorial(n, total) { if (n === 1) return total; return tailFactorial(n - 1, n * total); } const factorial = currying(tailFactorial, 1); factorial(5) // 120 ä¸Šé¢ä»£ç é€šè¿‡æŸ¯é‡ŒåŒ–ï¼Œå°†å°¾é€’å½’å‡½æ•°tailFactorialå˜ä¸ºåªæ¥å—ä¸€ä¸ªå‚æ•°çš„factorialã€‚\nç¬¬äºŒç§æ–¹æ³•å°±ç®€å•å¤šäº†ï¼Œå°±æ˜¯é‡‡ç”¨ ES6 çš„å‡½æ•°é»˜è®¤å€¼ã€‚\nfunction factorial(n, total = 1) { if (n === 1) return total; return factorial(n - 1, n * total); } factorial(5) // 120 ä¸Šé¢ä»£ç ä¸­ï¼Œå‚æ•°totalæœ‰é»˜è®¤å€¼1ï¼Œæ‰€ä»¥è°ƒç”¨æ—¶ä¸ç”¨æä¾›è¿™ä¸ªå€¼ã€‚\næ€»ç»“ä¸€ä¸‹ï¼Œé€’å½’æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å¾ªç¯æ“ä½œã€‚çº¯ç²¹çš„å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€æ²¡æœ‰å¾ªç¯æ“ä½œå‘½ä»¤ï¼Œæ‰€æœ‰çš„å¾ªç¯éƒ½ç”¨é€’å½’å®ç°ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå°¾é€’å½’å¯¹è¿™äº›è¯­è¨€æå…¶é‡è¦ã€‚å¯¹äºå…¶ä»–æ”¯æŒâ€œå°¾è°ƒç”¨ä¼˜åŒ–â€çš„è¯­è¨€ï¼ˆæ¯”å¦‚ Luaï¼ŒES6ï¼‰ï¼Œåªéœ€è¦çŸ¥é“å¾ªç¯å¯ä»¥ç”¨é€’å½’ä»£æ›¿ï¼Œè€Œä¸€æ—¦ä½¿ç”¨é€’å½’ï¼Œå°±æœ€å¥½ä½¿ç”¨å°¾é€’å½’ã€‚\nä¸¥æ ¼æ¨¡å¼ ES6 çš„å°¾è°ƒç”¨ä¼˜åŒ–åªåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹å¼€å¯ï¼Œæ­£å¸¸æ¨¡å¼æ˜¯æ— æ•ˆçš„ã€‚\nè¿™æ˜¯å› ä¸ºåœ¨æ­£å¸¸æ¨¡å¼ä¸‹ï¼Œå‡½æ•°å†…éƒ¨æœ‰ä¸¤ä¸ªå˜é‡ï¼Œå¯ä»¥è·Ÿè¸ªå‡½æ•°çš„è°ƒç”¨æ ˆã€‚\nfunc.argumentsï¼šè¿”å›è°ƒç”¨æ—¶å‡½æ•°çš„å‚æ•°ã€‚ func.callerï¼šè¿”å›è°ƒç”¨å½“å‰å‡½æ•°çš„é‚£ä¸ªå‡½æ•°ã€‚ å°¾è°ƒç”¨ä¼˜åŒ–å‘ç”Ÿæ—¶ï¼Œå‡½æ•°çš„è°ƒç”¨æ ˆä¼šæ”¹å†™ï¼Œå› æ­¤ä¸Šé¢ä¸¤ä¸ªå˜é‡å°±ä¼šå¤±çœŸã€‚ä¸¥æ ¼æ¨¡å¼ç¦ç”¨è¿™ä¸¤ä¸ªå˜é‡ï¼Œæ‰€ä»¥å°¾è°ƒç”¨æ¨¡å¼ä»…åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ç”Ÿæ•ˆã€‚\nfunction restricted() { \u0026#39;use strict\u0026#39;; restricted.caller; // æŠ¥é”™ restricted.arguments; // æŠ¥é”™ } restricted(); å°¾é€’å½’ä¼˜åŒ–çš„å®ç° å°¾é€’å½’ä¼˜åŒ–åªåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ç”Ÿæ•ˆï¼Œé‚£ä¹ˆæ­£å¸¸æ¨¡å¼ä¸‹ï¼Œæˆ–è€…é‚£äº›ä¸æ”¯æŒè¯¥åŠŸèƒ½çš„ç¯å¢ƒä¸­ï¼Œæœ‰æ²¡æœ‰åŠæ³•ä¹Ÿä½¿ç”¨å°¾é€’å½’ä¼˜åŒ–å‘¢ï¼Ÿå›ç­”æ˜¯å¯ä»¥çš„ï¼Œå°±æ˜¯è‡ªå·±å®ç°å°¾é€’å½’ä¼˜åŒ–ã€‚\nå®ƒçš„åŸç†éå¸¸ç®€å•ã€‚å°¾é€’å½’ä¹‹æ‰€ä»¥éœ€è¦ä¼˜åŒ–ï¼ŒåŸå› æ˜¯è°ƒç”¨æ ˆå¤ªå¤šï¼Œé€ æˆæº¢å‡ºï¼Œé‚£ä¹ˆåªè¦å‡å°‘è°ƒç”¨æ ˆï¼Œå°±ä¸ä¼šæº¢å‡ºã€‚æ€ä¹ˆåšå¯ä»¥å‡å°‘è°ƒç”¨æ ˆå‘¢ï¼Ÿå°±æ˜¯é‡‡ç”¨â€œå¾ªç¯â€æ¢æ‰â€œé€’å½’â€ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªæ­£å¸¸çš„é€’å½’å‡½æ•°ã€‚\nfunction sum(x, y) { if (y \u0026gt; 0) { return sum(x + 1, y - 1); } else { return x; } } sum(1, 100000) // Uncaught RangeError: Maximum call stack size exceeded(â€¦) ä¸Šé¢ä»£ç ä¸­ï¼Œsumæ˜¯ä¸€ä¸ªé€’å½’å‡½æ•°ï¼Œå‚æ•°xæ˜¯éœ€è¦ç´¯åŠ çš„å€¼ï¼Œå‚æ•°yæ§åˆ¶é€’å½’æ¬¡æ•°ã€‚ä¸€æ—¦æŒ‡å®šsumé€’å½’ 100000 æ¬¡ï¼Œå°±ä¼šæŠ¥é”™ï¼Œæç¤ºè¶…å‡ºè°ƒç”¨æ ˆçš„æœ€å¤§æ¬¡æ•°ã€‚\nè¹¦åºŠå‡½æ•°ï¼ˆtrampolineï¼‰å¯ä»¥å°†é€’å½’æ‰§è¡Œè½¬ä¸ºå¾ªç¯æ‰§è¡Œã€‚\nfunction trampoline(f) { while (f \u0026amp;\u0026amp; f instanceof Function) { f = f(); } return f; } ä¸Šé¢å°±æ˜¯è¹¦åºŠå‡½æ•°çš„ä¸€ä¸ªå®ç°ï¼Œå®ƒæ¥å—ä¸€ä¸ªå‡½æ•°fä½œä¸ºå‚æ•°ã€‚åªè¦fæ‰§è¡Œåè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå°±ç»§ç»­æ‰§è¡Œã€‚æ³¨æ„ï¼Œè¿™é‡Œæ˜¯è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åæ‰§è¡Œè¯¥å‡½æ•°ï¼Œè€Œä¸æ˜¯å‡½æ•°é‡Œé¢è°ƒç”¨å‡½æ•°ï¼Œè¿™æ ·å°±é¿å…äº†é€’å½’æ‰§è¡Œï¼Œä»è€Œå°±æ¶ˆé™¤äº†è°ƒç”¨æ ˆè¿‡å¤§çš„é—®é¢˜ã€‚\nç„¶åï¼Œè¦åšçš„å°±æ˜¯å°†åŸæ¥çš„é€’å½’å‡½æ•°ï¼Œæ”¹å†™ä¸ºæ¯ä¸€æ­¥è¿”å›å¦ä¸€ä¸ªå‡½æ•°ã€‚\nfunction sum(x, y) { if (y \u0026gt; 0) { return sum.bind(null, x + 1, y - 1); } else { return x; } } ä¸Šé¢ä»£ç ä¸­ï¼Œsumå‡½æ•°çš„æ¯æ¬¡æ‰§è¡Œï¼Œéƒ½ä¼šè¿”å›è‡ªèº«çš„å¦ä¸€ä¸ªç‰ˆæœ¬ã€‚\nç°åœ¨ï¼Œä½¿ç”¨è¹¦åºŠå‡½æ•°æ‰§è¡Œsumï¼Œå°±ä¸ä¼šå‘ç”Ÿè°ƒç”¨æ ˆæº¢å‡ºã€‚\ntrampoline(sum(1, 100000)) // 100001 è¹¦åºŠå‡½æ•°å¹¶ä¸æ˜¯çœŸæ­£çš„å°¾é€’å½’ä¼˜åŒ–ï¼Œä¸‹é¢çš„å®ç°æ‰æ˜¯ã€‚\nfunction tco(f) { var value; var active = false; var accumulated = []; return function accumulator() { accumulated.push(arguments); if (!active) { active = true; while (accumulated.length) { value = f.apply(this, accumulated.shift()); } active = false; return value; } }; } var sum = tco(function(x, y) { if (y \u0026gt; 0) { return sum(x + 1, y - 1) } else { return x } }); sum(1, 100000) // 100001 ä¸Šé¢ä»£ç ä¸­ï¼Œtcoå‡½æ•°æ˜¯å°¾é€’å½’ä¼˜åŒ–çš„å®ç°ï¼Œå®ƒçš„å¥¥å¦™å°±åœ¨äºçŠ¶æ€å˜é‡activeã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå˜é‡æ˜¯ä¸æ¿€æ´»çš„ã€‚ä¸€æ—¦è¿›å…¥å°¾é€’å½’ä¼˜åŒ–çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªå˜é‡å°±æ¿€æ´»äº†ã€‚ç„¶åï¼Œæ¯ä¸€è½®é€’å½’sumè¿”å›çš„éƒ½æ˜¯undefinedï¼Œæ‰€ä»¥å°±é¿å…äº†é€’å½’æ‰§è¡Œï¼›è€Œaccumulatedæ•°ç»„å­˜æ”¾æ¯ä¸€è½®sumæ‰§è¡Œçš„å‚æ•°ï¼Œæ€»æ˜¯æœ‰å€¼çš„ï¼Œè¿™å°±ä¿è¯äº†accumulatorå‡½æ•°å†…éƒ¨çš„whileå¾ªç¯æ€»æ˜¯ä¼šæ‰§è¡Œã€‚è¿™æ ·å°±å¾ˆå·§å¦™åœ°å°†â€œé€’å½’â€æ”¹æˆäº†â€œå¾ªç¯â€ï¼Œè€Œåä¸€è½®çš„å‚æ•°ä¼šå–ä»£å‰ä¸€è½®çš„å‚æ•°ï¼Œä¿è¯äº†è°ƒç”¨æ ˆåªæœ‰ä¸€å±‚ã€‚\nå‡½æ•°å‚æ•°çš„å°¾é€—å· ES2017 å…è®¸å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°æœ‰å°¾é€—å·ï¼ˆtrailing commaï¼‰ã€‚\næ­¤å‰ï¼Œå‡½æ•°å®šä¹‰å’Œè°ƒç”¨æ—¶ï¼Œéƒ½ä¸å…è®¸æœ€åä¸€ä¸ªå‚æ•°åé¢å‡ºç°é€—å·ã€‚\nfunction clownsEverywhere( param1, param2 ) { /* ... */ } clownsEverywhere( \u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39; ); ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœåœ¨param2æˆ–baråé¢åŠ ä¸€ä¸ªé€—å·ï¼Œå°±ä¼šæŠ¥é”™ã€‚\nå¦‚æœåƒä¸Šé¢è¿™æ ·ï¼Œå°†å‚æ•°å†™æˆå¤šè¡Œï¼ˆå³æ¯ä¸ªå‚æ•°å æ®ä¸€è¡Œï¼‰ï¼Œä»¥åä¿®æ”¹ä»£ç çš„æ—¶å€™ï¼Œæƒ³ä¸ºå‡½æ•°clownsEverywhereæ·»åŠ ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œæˆ–è€…è°ƒæ•´å‚æ•°çš„æ¬¡åºï¼Œå°±åŠ¿å¿…è¦åœ¨åŸæ¥æœ€åä¸€ä¸ªå‚æ•°åé¢æ·»åŠ ä¸€ä¸ªé€—å·ã€‚è¿™å¯¹äºç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿæ¥è¯´ï¼Œå°±ä¼šæ˜¾ç¤ºæ·»åŠ é€—å·çš„é‚£ä¸€è¡Œä¹Ÿå‘ç”Ÿäº†å˜åŠ¨ã€‚è¿™çœ‹ä¸Šå»æœ‰ç‚¹å†—ä½™ï¼Œå› æ­¤æ–°çš„è¯­æ³•å…è®¸å®šä¹‰å’Œè°ƒç”¨æ—¶ï¼Œå°¾éƒ¨ç›´æ¥æœ‰ä¸€ä¸ªé€—å·ã€‚\nfunction clownsEverywhere( param1, param2, ) { /* ... */ } clownsEverywhere( \u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;, ); è¿™æ ·çš„è§„å®šä¹Ÿä½¿å¾—ï¼Œå‡½æ•°å‚æ•°ä¸æ•°ç»„å’Œå¯¹è±¡çš„å°¾é€—å·è§„åˆ™ï¼Œä¿æŒä¸€è‡´äº†ã€‚\nè¿”å›ä»£ç  Function.prototype.toString()\nES2019 å¯¹å‡½æ•°å®ä¾‹çš„toString()æ–¹æ³•åšå‡ºäº†ä¿®æ”¹ã€‚\ntoString()æ–¹æ³•è¿”å›å‡½æ•°ä»£ç æœ¬èº«ï¼Œä»¥å‰ä¼šçœç•¥æ³¨é‡Šå’Œç©ºæ ¼ã€‚\nfunction /* foo comment */ foo () {} foo.toString() // function foo() {} ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°fooçš„åŸå§‹ä»£ç åŒ…å«æ³¨é‡Šï¼Œå‡½æ•°åfooå’Œåœ†æ‹¬å·ä¹‹é—´æœ‰ç©ºæ ¼ï¼Œä½†æ˜¯toString()æ–¹æ³•éƒ½æŠŠå®ƒä»¬çœç•¥äº†ã€‚\nä¿®æ”¹åçš„toString()æ–¹æ³•ï¼Œæ˜ç¡®è¦æ±‚è¿”å›ä¸€æ¨¡ä¸€æ ·çš„åŸå§‹ä»£ç ã€‚\nfunction /* foo comment */ foo () {} foo.toString() // \u0026#34;function /* foo comment */ foo () {}\u0026#34; Symbol ES5 çš„å¯¹è±¡å±æ€§åéƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™å®¹æ˜“é€ æˆå±æ€§åçš„å†²çªã€‚ ES6 å¼•å…¥ Symbol ï¼Œè¡¨ç¤ºç‹¬ä¸€æ— äºŒçš„å€¼ã€‚\nSymbol å€¼é€šè¿‡ Symbol() å‡½æ•°ç”Ÿæˆã€‚è¿™å°±æ˜¯è¯´ï¼Œå¯¹è±¡çš„å±æ€§åç°åœ¨å¯ä»¥æœ‰ä¸¤ç§ç±»å‹ï¼Œä¸€ç§æ˜¯åŸæ¥å°±æœ‰çš„å­—ç¬¦ä¸²ï¼Œå¦ä¸€ç§å°±æ˜¯æ–°å¢çš„ Symbol ç±»å‹ã€‚å‡¡æ˜¯å±æ€§åå±äº Symbol ç±»å‹ï¼Œå°±éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œå¯ä»¥ä¿è¯ä¸ä¼šä¸å…¶ä»–å±æ€§åäº§ç”Ÿå†²çªã€‚\nğŸ“ Note Symbol æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå®ƒå¹¶ä¸æ˜¯æ„é€ å‡½æ•°ï¼Œå› ä¸ºå®ƒä¸æ”¯æŒ new Symbol() è¯­æ³•ã€‚æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ Symbol() å³å¯ã€‚\nlet s = Symbol(); typeof s // \u0026#34;symbol\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡ s å°±æ˜¯ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„å€¼ã€‚typeof è¿ç®—ç¬¦çš„ç»“æœï¼Œè¡¨æ˜å˜é‡ s æ˜¯ Symbol æ•°æ®ç±»å‹ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²ä¹‹ç±»çš„å…¶ä»–ç±»å‹ã€‚\nâš ï¸ Caution æ³¨æ„ï¼ŒSymbol å‡½æ•°å‰ä¸èƒ½ä½¿ç”¨ new å‘½ä»¤ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºç”Ÿæˆçš„ Symbol æ˜¯ä¸€ä¸ª åŸå§‹ç±»å‹ çš„å€¼ï¼Œä¸æ˜¯ å¯¹è±¡ ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç”±äº Symbol å€¼ ä¸æ˜¯ å¯¹è±¡ ï¼Œæ‰€ä»¥ä¸èƒ½æ·»åŠ å±æ€§ã€‚åŸºæœ¬ä¸Šï¼Œå®ƒæ˜¯ä¸€ç§ç±»ä¼¼äº å­— ç¬¦ä¸² çš„æ•°æ®ç±»å‹ã€‚\nSymbol å‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œè¡¨ç¤ºå¯¹ Symbol å®ä¾‹çš„æè¿°ï¼Œä¸»è¦æ˜¯ä¸ºäº†åœ¨æ§åˆ¶å°æ˜¾ç¤ºï¼Œæˆ–è€…è½¬ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œæ¯”è¾ƒå®¹æ˜“åŒºåˆ†ã€‚\nlet s1 = Symbol(\u0026#39;foo\u0026#39;); let s2 = Symbol(\u0026#39;bar\u0026#39;); s1 // Symbol(foo) s2 // Symbol(bar) s1.toString() // \u0026#34;Symbol(foo)\u0026#34; s2.toString() // \u0026#34;Symbol(bar)\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼Œs1 å’Œ s2 æ˜¯ä¸¤ä¸ª Symbol å€¼ã€‚å¦‚æœä¸åŠ å‚æ•°ï¼Œå®ƒä»¬åœ¨æ§åˆ¶å°çš„è¾“å‡ºéƒ½æ˜¯ Symbol() ï¼Œä¸åˆ©äºåŒºåˆ†ã€‚æœ‰äº†å‚æ•°ä»¥åï¼Œå°±ç­‰äºä¸ºå®ƒä»¬åŠ ä¸Šäº†æè¿°ï¼Œè¾“å‡ºçš„æ—¶å€™å°±èƒ½å¤Ÿåˆ†æ¸…ï¼Œåˆ°åº•æ˜¯å“ªä¸€ä¸ªå€¼ã€‚\nå¦‚æœ Symbol çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¼šè°ƒç”¨è¯¥å¯¹è±¡çš„ toString æ–¹æ³•ï¼Œå°†å…¶è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åæ‰ç”Ÿæˆä¸€ä¸ª Symbol å€¼ã€‚\nconst obj = { toString() { return \u0026#39;abc\u0026#39;; } }; const sym = Symbol(obj); console.log(sym); // Symbol(abc) æ³¨æ„ï¼ŒSymbol å‡½æ•°çš„å‚æ•°åªæ˜¯è¡¨ç¤ºå¯¹å½“å‰ Symbol å€¼çš„ æè¿° ï¼Œå› æ­¤ç›¸åŒå‚æ•°çš„ Symbol å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸ç›¸ç­‰çš„ã€‚\n// æ²¡æœ‰å‚æ•°çš„æƒ…å†µ let s1 = Symbol(); let s2 = Symbol(); s1 === s2 // false // æœ‰å‚æ•°çš„æƒ…å†µ let s1 = Symbol(\u0026#39;foo\u0026#39;); let s2 = Symbol(\u0026#39;foo\u0026#39;); s1 === s2 // false ä¸Šé¢ä»£ç ä¸­ï¼Œs1 å’Œ s2 éƒ½æ˜¯ Symbol å‡½æ•°çš„è¿”å›å€¼ï¼Œè€Œä¸”å‚æ•°ç›¸åŒï¼Œä½†æ˜¯å®ƒä»¬æ˜¯ä¸ç›¸ç­‰çš„ã€‚\nSymbol å€¼ä¸èƒ½ä¸å…¶ä»–ç±»å‹çš„å€¼è¿›è¡Œè¿ç®—ï¼Œä¼šæŠ¥é”™ã€‚\nlet sym = Symbol(\u0026#39;My symbol\u0026#39;); console.log(\u0026#34;your symbol is \u0026#34; + sym); // TypeError: can\u0026#39;t convert symbol to string console.log(`your symbol is ${sym}`); // TypeError: can\u0026#39;t convert symbol to string ä½†æ˜¯ï¼ŒSymbol å€¼å¯ä»¥æ˜¾å¼è½¬ä¸ºå­—ç¬¦ä¸²ã€‚\nlet sym = Symbol(\u0026#39;My symbol\u0026#39;); String(sym) // \u0026#39;Symbol(My symbol)\u0026#39; sym.toString() // \u0026#39;Symbol(My symbol)\u0026#39; å¦å¤–ï¼ŒSymbol å€¼ä¹Ÿå¯ä»¥è½¬ä¸º å¸ƒå°”å€¼ ï¼Œä½†æ˜¯ä¸èƒ½è½¬ä¸º æ•°å€¼ ã€‚\nğŸ“ Note ä¸€èˆ¬æ¥è¯´ï¼Œå¸ƒå°”å€¼çš„åˆ¤æ–­æ˜¯æœ‰å€¼å°±ä¸º true ã€‚\nlet sym = Symbol(); Boolean(sym) // true !sym // false if (sym) { // ... } Number(sym) // TypeError sym + 2 // TypeError ğŸ“ Note Symbol.prototype.description\nåˆ›å»º Symbol çš„æ—¶å€™ï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ªæè¿°ã€‚\nconst sym = Symbol(\u0026#39;foo\u0026#39;); ä¸Šé¢ä»£ç ä¸­ï¼Œsymçš„æè¿°å°±æ˜¯å­—ç¬¦ä¸²fooã€‚\nä½†æ˜¯ï¼Œè¯»å–è¿™ä¸ªæè¿°éœ€è¦å°† Symbol æ˜¾å¼ è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œå³ä¸‹é¢çš„å†™æ³•ã€‚\nconst sym = Symbol(\u0026#39;foo\u0026#39;); String(sym) // \u0026#34;Symbol(foo)\u0026#34; sym.toString() // \u0026#34;Symbol(foo)\u0026#34; ä¸Šé¢çš„ç”¨æ³•ä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚ES2019 æä¾›äº†ä¸€ä¸ªå®ä¾‹å±æ€§descriptionï¼Œç›´æ¥è¿”å› Symbol çš„æè¿°ã€‚\nconst sym = Symbol(\u0026#39;foo\u0026#39;); sym.description // \u0026#34;foo\u0026#34; ç”¨é€” ç”±äºæ¯ä¸€ä¸ª Symbol å€¼éƒ½æ˜¯ä¸ç›¸ç­‰çš„ï¼Œè¿™æ„å‘³ç€ Symbol å€¼å¯ä»¥ä½œä¸º æ ‡è¯†ç¬¦ ï¼Œç”¨äº å¯¹è±¡çš„å±æ€§å ï¼Œå°±èƒ½ä¿è¯ä¸ä¼šå‡ºç°åŒåçš„å±æ€§ã€‚è¿™å¯¹äºä¸€ä¸ªå¯¹è±¡ç”± å¤šä¸ªæ¨¡å— æ„æˆçš„æƒ…å†µéå¸¸æœ‰ç”¨ï¼Œèƒ½é˜²æ­¢æŸä¸€ä¸ªé”®è¢«ä¸å°å¿ƒæ”¹å†™æˆ–è¦†ç›–ã€‚\nlet mySymbol = Symbol(); // ç¬¬ä¸€ç§å†™æ³• let a = {}; a[mySymbol] = \u0026#39;Hello!\u0026#39;; // ç¬¬äºŒç§å†™æ³• let a = { [mySymbol]: \u0026#39;Hello!\u0026#39; }; // ç¬¬ä¸‰ç§å†™æ³• let a = {}; Object.defineProperty(a, mySymbol, { value: \u0026#39;Hello!\u0026#39; }); // ä»¥ä¸Šå†™æ³•éƒ½å¾—åˆ°åŒæ ·ç»“æœ a[mySymbol] // \u0026#34;Hello!\u0026#34; ä¸Šé¢ä»£ç é€šè¿‡æ–¹æ‹¬å·ç»“æ„å’Œ Object.defineProperty ï¼Œå°†å¯¹è±¡çš„å±æ€§åæŒ‡å®šä¸ºä¸€ä¸ª Symbol å€¼ã€‚\nâš ï¸ Caution Symbol å€¼ä½œä¸ºå¯¹è±¡å±æ€§åæ—¶ï¼Œä¸èƒ½ç”¨ ç‚¹è¿ç®—ç¬¦. ã€‚\nconst mySymbol = Symbol(); const a = {}; a.mySymbol = \u0026#39;Hello!\u0026#39;; a[mySymbol] // undefined a[\u0026#39;mySymbol\u0026#39;] // \u0026#34;Hello!\u0026#34; ğŸ“ Note ä¸Šé¢ä»£ç ä¸­ï¼Œå› ä¸ºç‚¹è¿ç®—ç¬¦åé¢æ€»æ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¸ä¼šè¯»å– mySymbol ä½œä¸ºæ ‡è¯†åæ‰€æŒ‡ä»£çš„é‚£ä¸ªå€¼ï¼Œå¯¼è‡´açš„å±æ€§åå®é™…ä¸Šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯ä¸€ä¸ª Symbol å€¼ã€‚\nåŒç†ï¼Œåœ¨å¯¹è±¡çš„å†…éƒ¨ï¼Œä½¿ç”¨ Symbol å€¼å®šä¹‰å±æ€§æ—¶ï¼ŒSymbol å€¼å¿…é¡»æ”¾åœ¨æ–¹æ‹¬å·ä¹‹ä¸­ã€‚\nlet s = Symbol(); let obj = { [s]: function (arg) { ... } }; obj[s](123); ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœ s ä¸æ”¾åœ¨æ–¹æ‹¬å·ä¸­ï¼Œè¯¥å±æ€§çš„é”®åå°±æ˜¯å­—ç¬¦ä¸² s ï¼Œè€Œä¸æ˜¯ s æ‰€ä»£è¡¨çš„é‚£ä¸ª Symbol å€¼ã€‚\né‡‡ç”¨å¢å¼ºçš„å¯¹è±¡å†™æ³•ï¼Œä¸Šé¢ä»£ç çš„ obj å¯¹è±¡å¯ä»¥å†™å¾—æ›´ç®€æ´ä¸€äº›ã€‚\nlet obj = { [s](arg) { ... } }; ğŸ“ƒ Example Symbol ç±»å‹è¿˜å¯ä»¥ç”¨äºå®šä¹‰ä¸€ç»„ å¸¸é‡ ï¼Œä¿è¯è¿™ç»„å¸¸é‡çš„å€¼éƒ½æ˜¯ä¸ç›¸ç­‰çš„ã€‚\nconst log = {}; log.levels = { DEBUG: Symbol(\u0026#39;debug\u0026#39;), INFO: Symbol(\u0026#39;info\u0026#39;), WARN: Symbol(\u0026#39;warn\u0026#39;) }; console.log(log.levels.DEBUG, \u0026#39;debug message\u0026#39;); console.log(log.levels.INFO, \u0026#39;info message\u0026#39;); ğŸ“ƒ Example ä¸‹é¢æ˜¯å¦å¤–ä¸€ä¸ªä¾‹å­ã€‚\nconst COLOR_RED = Symbol(); const COLOR_GREEN = Symbol(); function getComplement(color) { switch (color) { case COLOR_RED: return COLOR_GREEN; case COLOR_GREEN: return COLOR_RED; default: throw new Error(\u0026#39;Undefined color\u0026#39;); } } ğŸ“ Note å¸¸é‡ä½¿ç”¨ Symbol å€¼æœ€å¤§çš„å¥½å¤„ï¼Œå°±æ˜¯å…¶ä»–ä»»ä½•å€¼éƒ½ä¸å¯èƒ½æœ‰ç›¸åŒçš„å€¼äº†ï¼Œå› æ­¤å¯ä»¥ä¿è¯ä¸Šé¢çš„ switch è¯­å¥ä¼šæŒ‰è®¾è®¡çš„æ–¹å¼å·¥ä½œã€‚\nè¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼ŒSymbol å€¼ä½œä¸º å±æ€§å æ—¶ï¼Œè¯¥å±æ€§è¿˜æ˜¯ å…¬å¼€å±æ€§ ï¼Œä¸æ˜¯ç§æœ‰å±æ€§ã€‚\nğŸ“ƒ Example å®ä¾‹ï¼šæ¶ˆé™¤é­”æœ¯å­—ç¬¦ä¸² é­”æœ¯å­—ç¬¦ä¸²æŒ‡çš„æ˜¯ï¼Œåœ¨ä»£ç ä¹‹ä¸­ å¤šæ¬¡å‡ºç° ã€ä¸ä»£ç å½¢æˆå¼ºè€¦åˆçš„æŸä¸€ä¸ªå…·ä½“çš„å­—ç¬¦ä¸²æˆ–è€…æ•°å€¼ã€‚é£æ ¼è‰¯å¥½çš„ä»£ç ï¼Œåº”è¯¥å°½é‡æ¶ˆé™¤é­”æœ¯å­—ç¬¦ä¸²ï¼Œæ”¹ç”±å«ä¹‰æ¸…æ™°çš„å˜é‡ä»£æ›¿ã€‚\nğŸ“ƒ Example\nfunction getArea(shape, options) { let area = 0; switch (shape) { case \u0026#39;Triangle\u0026#39;: // é­”æœ¯å­—ç¬¦ä¸² area = .5 * options.width * options.height; break; /* ... more code ... */ } return area; } getArea(\u0026#39;Triangle\u0026#39;, { width: 100, height: 100 }); // é­”æœ¯å­—ç¬¦ä¸² ä¸Šé¢ä»£ç ä¸­ï¼Œå­—ç¬¦ä¸²Triangleå°±æ˜¯ä¸€ä¸ªé­”æœ¯å­—ç¬¦ä¸²ã€‚å®ƒå¤šæ¬¡å‡ºç°ï¼Œä¸ä»£ç å½¢æˆâ€œå¼ºè€¦åˆâ€ï¼Œä¸åˆ©äºå°†æ¥çš„ä¿®æ”¹å’Œç»´æŠ¤ã€‚\nå¸¸ç”¨çš„æ¶ˆé™¤é­”æœ¯å­—ç¬¦ä¸²çš„æ–¹æ³•ï¼Œå°±æ˜¯æŠŠå®ƒå†™æˆä¸€ä¸ª å˜é‡ ã€‚\nğŸ“ƒ Example\nconst shapeType = { triangle: \u0026#39;Triangle\u0026#39; }; function getArea(shape, options) { let area = 0; switch (shape) { case shapeType.triangle: area = .5 * options.width * options.height; break; } return area; } getArea(shapeType.triangle, { width: 100, height: 100 }); ğŸ“ Note ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬æŠŠ Triangle å†™æˆ shapeType å¯¹è±¡çš„triangle å±æ€§ï¼Œè¿™æ ·å°±æ¶ˆé™¤äº†å¼ºè€¦åˆã€‚\nå¦‚æœä»”ç»†åˆ†æï¼Œå¯ä»¥å‘ç° shapeType.triangle ç­‰äºå“ªä¸ªå€¼å¹¶ä¸é‡è¦ï¼Œåªè¦ç¡®ä¿ä¸ä¼šè·Ÿå…¶ä»– shapeType å±æ€§çš„å€¼å†²çªå³å¯ã€‚å› æ­¤ï¼Œè¿™é‡Œå°±å¾ˆé€‚åˆæ”¹ç”¨ Symbol å€¼ã€‚\nconst shapeType = { triangle: Symbol() }; ä¸Šé¢ä»£ç ä¸­ï¼Œé™¤äº†å°† shapeType.triangle çš„å€¼è®¾ä¸ºä¸€ä¸ª Symbolï¼Œå…¶ä»–åœ°æ–¹éƒ½ä¸ç”¨ä¿®æ”¹ã€‚\néå† Symbol ä½œä¸ºå±æ€§åï¼Œéå†å¯¹è±¡çš„æ—¶å€™ï¼Œè¯¥å±æ€§ä¸ä¼šå‡ºç°åœ¨ [for-in](05 JavaScript#for-in), [for-of](05 JavaScript#for-of) å¾ªç¯ä¸­ï¼Œä¹Ÿä¸ä¼šè¢«Object.keys()ã€Object.getOwnPropertyNames()ã€JSON.stringify() è¿”å›ã€‚\nä½†æ˜¯ï¼Œå®ƒä¹Ÿä¸æ˜¯ ç§æœ‰å±æ€§ ï¼Œæœ‰ä¸€ä¸ª Object.getOwnPropertySymbols() æ–¹æ³•ï¼Œå¯ä»¥è·å–æŒ‡å®šå¯¹è±¡çš„æ‰€æœ‰ Symbol å±æ€§åã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å½“å‰å¯¹è±¡çš„æ‰€æœ‰ç”¨ä½œå±æ€§åçš„ Symbol å€¼ã€‚\nconst obj = {}; let a = Symbol(\u0026#39;a\u0026#39;); let b = Symbol(\u0026#39;b\u0026#39;); obj[a] = \u0026#39;Hello\u0026#39;; obj[b] = \u0026#39;World\u0026#39;; const objectSymbols = Object.getOwnPropertySymbols(obj); objectSymbols // [Symbol(a), Symbol(b)] ä¸Šé¢ä»£ç æ˜¯ Object.getOwnPropertySymbols() æ–¹æ³•çš„ç¤ºä¾‹ï¼Œå¯ä»¥è·å–æ‰€æœ‰ Symbol å±æ€§åã€‚\nä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ï¼ŒObject.getOwnPropertySymbols() æ–¹æ³•ä¸ for...in å¾ªç¯ã€Object.getOwnPropertyNames æ–¹æ³•è¿›è¡Œå¯¹æ¯”çš„ä¾‹å­ã€‚\nconst obj = {}; const foo = Symbol(\u0026#39;foo\u0026#39;); obj[foo] = \u0026#39;bar\u0026#39;; for (let i in obj) { console.log(i); // æ— è¾“å‡º } Object.getOwnPropertyNames(obj) // [] Object.getOwnPropertySymbols(obj) // [Symbol(foo)] ä¸Šé¢ä»£ç ä¸­ï¼Œä½¿ç”¨ for...in å¾ªç¯å’Œ Object.getOwnPropertyNames() æ–¹æ³•éƒ½å¾—ä¸åˆ° Symbol é”®åï¼Œéœ€è¦ä½¿ç”¨ Object.getOwnPropertySymbols() æ–¹æ³•ã€‚\nå¦ä¸€ä¸ªæ–°çš„ APIï¼ŒReflect.ownKeys() æ–¹æ³•å¯ä»¥è¿”å›æ‰€æœ‰ç±»å‹çš„é”®åï¼ŒåŒ…æ‹¬å¸¸è§„é”®åå’Œ Symbol é”®åã€‚\nlet obj = { [Symbol(\u0026#39;my_key\u0026#39;)]: 1, enum: 2, nonEnum: 3 }; Reflect.ownKeys(obj) // [\u0026#34;enum\u0026#34;, \u0026#34;nonEnum\u0026#34;, Symbol(my_key)] ç”±äºä»¥ Symbol å€¼ä½œä¸ºé”®åï¼Œä¸ä¼šè¢«å¸¸è§„æ–¹æ³•éå†å¾—åˆ°ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œä¸ºå¯¹è±¡å®šä¹‰ä¸€äº›éç§æœ‰çš„ã€ä½†åˆå¸Œæœ›åªç”¨äºå†…éƒ¨çš„æ–¹æ³•ã€‚\nlet size = Symbol(\u0026#39;size\u0026#39;); class Collection { constructor() { this[size] = 0; } add(item) { this[this[size]] = item; this[size]++; } static sizeOf(instance) { return instance[size]; } } let x = new Collection(); Collection.sizeOf(x) // 0 x.add(\u0026#39;foo\u0026#39;); Collection.sizeOf(x) // 1 Object.keys(x) // [\u0026#39;0\u0026#39;] Object.getOwnPropertyNames(x) // [\u0026#39;0\u0026#39;] Object.getOwnPropertySymbols(x) // [Symbol(size)] ä¸Šé¢ä»£ç ä¸­ï¼Œå¯¹è±¡xçš„sizeå±æ€§æ˜¯ä¸€ä¸ª Symbol å€¼ï¼Œæ‰€ä»¥Object.keys(x)ã€Object.getOwnPropertyNames(x)éƒ½æ— æ³•è·å–å®ƒã€‚è¿™å°±é€ æˆäº†ä¸€ç§éç§æœ‰çš„å†…éƒ¨æ–¹æ³•çš„æ•ˆæœã€‚\næ–¹æ³• Symbol.for(), Symbol.keyFor() æœ‰æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›é‡æ–°ä½¿ç”¨åŒä¸€ä¸ª Symbol å€¼ï¼ŒSymbol.for() æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚å®ƒæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œç„¶åæœç´¢æœ‰æ²¡æœ‰ä»¥è¯¥å‚æ•°ä½œä¸ºåç§°çš„ Symbol å€¼ã€‚å¦‚æœæœ‰ï¼Œå°±è¿”å›è¿™ä¸ª Symbol å€¼ï¼Œå¦åˆ™å°±æ–°å»ºä¸€ä¸ªä»¥è¯¥å­—ç¬¦ä¸²ä¸ºåç§°çš„ Symbol å€¼ï¼Œå¹¶å°†å…¶æ³¨å†Œåˆ°å…¨å±€ã€‚\nlet s1 = Symbol.for(\u0026#39;foo\u0026#39;); let s2 = Symbol.for(\u0026#39;foo\u0026#39;); s1 === s2 // true ä¸Šé¢ä»£ç ä¸­ï¼Œs1å’Œs2éƒ½æ˜¯ Symbol å€¼ï¼Œä½†æ˜¯å®ƒä»¬éƒ½æ˜¯ç”±åŒæ ·å‚æ•°çš„Symbol.foræ–¹æ³•ç”Ÿæˆçš„ï¼Œæ‰€ä»¥å®é™…ä¸Šæ˜¯åŒä¸€ä¸ªå€¼ã€‚\nSymbol.for()ä¸Symbol()è¿™ä¸¤ç§å†™æ³•ï¼Œéƒ½ä¼šç”Ÿæˆæ–°çš„ Symbolã€‚å®ƒä»¬çš„åŒºåˆ«æ˜¯ï¼Œå‰è€…ä¼šè¢«ç™»è®°åœ¨å…¨å±€ç¯å¢ƒä¸­ä¾›æœç´¢ï¼Œåè€…ä¸ä¼šã€‚Symbol.for()ä¸ä¼šæ¯æ¬¡è°ƒç”¨å°±è¿”å›ä¸€ä¸ªæ–°çš„ Symbol ç±»å‹çš„å€¼ï¼Œè€Œæ˜¯ä¼šå…ˆæ£€æŸ¥ç»™å®šçš„keyæ˜¯å¦å·²ç»å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨æ‰ä¼šæ–°å»ºä¸€ä¸ªå€¼ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ è°ƒç”¨Symbol.for(\u0026quot;cat\u0026quot;)30 æ¬¡ï¼Œæ¯æ¬¡éƒ½ä¼šè¿”å›åŒä¸€ä¸ª Symbol å€¼ï¼Œä½†æ˜¯è°ƒç”¨Symbol(\u0026quot;cat\u0026quot;)30 æ¬¡ï¼Œä¼šè¿”å› 30 ä¸ªä¸åŒçš„ Symbol å€¼ã€‚\nSymbol.for(\u0026#34;bar\u0026#34;) === Symbol.for(\u0026#34;bar\u0026#34;) // true Symbol(\u0026#34;bar\u0026#34;) === Symbol(\u0026#34;bar\u0026#34;) // false ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äºSymbol()å†™æ³•æ²¡æœ‰ç™»è®°æœºåˆ¶ï¼Œæ‰€ä»¥æ¯æ¬¡è°ƒç”¨éƒ½ä¼šè¿”å›ä¸€ä¸ªä¸åŒçš„å€¼ã€‚\nSymbol.keyFor()æ–¹æ³•è¿”å›ä¸€ä¸ªå·²ç™»è®°çš„ Symbol ç±»å‹å€¼çš„keyã€‚\nğŸ“ƒ Example\nlet s1 = Symbol.for(\u0026#34;foo\u0026#34;); Symbol.keyFor(s1) // \u0026#34;foo\u0026#34; let s2 = Symbol(\u0026#34;foo\u0026#34;); Symbol.keyFor(s2) // undefined ğŸ“ Note ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡s2å±äºæœªç™»è®°çš„ Symbol å€¼ï¼Œæ‰€ä»¥è¿”å›undefinedã€‚\næ³¨æ„ï¼ŒSymbol.for() ä¸º Symbol å€¼ç™»è®°çš„åå­—ï¼Œæ˜¯å…¨å±€ç¯å¢ƒçš„ï¼Œä¸ç®¡æœ‰æ²¡æœ‰åœ¨å…¨å±€ç¯å¢ƒè¿è¡Œã€‚\nfunction foo() { return Symbol.for(\u0026#39;bar\u0026#39;); } const x = foo(); const y = Symbol.for(\u0026#39;bar\u0026#39;); console.log(x === y); // true ä¸Šé¢ä»£ç ä¸­ï¼ŒSymbol.for('bar') æ˜¯å‡½æ•°å†…éƒ¨è¿è¡Œçš„ï¼Œä½†æ˜¯ç”Ÿæˆçš„ Symbol å€¼æ˜¯ç™»è®°åœ¨å…¨å±€ç¯å¢ƒçš„ã€‚æ‰€ä»¥ï¼Œç¬¬äºŒæ¬¡è¿è¡Œ Symbol.for('bar') å¯ä»¥å–åˆ°è¿™ä¸ª Symbol å€¼ã€‚\nSymbol.for() çš„è¿™ä¸ªå…¨å±€ç™»è®°ç‰¹æ€§ï¼Œå¯ä»¥ç”¨åœ¨ä¸åŒçš„ iframe æˆ– service worker ä¸­å–åˆ°åŒä¸€ä¸ªå€¼ã€‚\niframe = document.createElement(\u0026#39;iframe\u0026#39;); iframe.src = String(window.location); document.body.appendChild(iframe); iframe.contentWindow.Symbol.for(\u0026#39;foo\u0026#39;) === Symbol.for(\u0026#39;foo\u0026#39;) // true ä¸Šé¢ä»£ç ä¸­ï¼Œiframe çª—å£ç”Ÿæˆçš„ Symbol å€¼ï¼Œå¯ä»¥åœ¨ä¸»é¡µé¢å¾—åˆ°ã€‚\nğŸ“ƒ Example æ¨¡å—çš„ Singleton æ¨¡å¼\nSingleton æ¨¡å¼æŒ‡çš„æ˜¯è°ƒç”¨ä¸€ä¸ªç±»ï¼Œä»»ä½•æ—¶å€™è¿”å›çš„éƒ½æ˜¯åŒä¸€ä¸ªå®ä¾‹ã€‚\nå¯¹äº Node.js æ¥è¯´ï¼Œæ¨¡å—æ–‡ä»¶å¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªç±»ã€‚æ€ä¹ˆä¿è¯æ¯æ¬¡æ‰§è¡Œè¿™ä¸ªæ¨¡å—æ–‡ä»¶ï¼Œè¿”å›çš„éƒ½æ˜¯åŒä¸€ä¸ªå®ä¾‹å‘¢ï¼Ÿ\nå¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œå¯ä»¥æŠŠå®ä¾‹æ”¾åˆ°é¡¶å±‚å¯¹è±¡ globalã€‚\n// mod.js function A() { this.foo = \u0026#39;hello\u0026#39;; } if (!global._foo) { global._foo = new A(); } module.exports = global._foo; ç„¶åï¼ŒåŠ è½½ä¸Šé¢çš„mod.jsã€‚\nconst a = require(\u0026#39;./mod.js\u0026#39;); console.log(a.foo); ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡aä»»ä½•æ—¶å€™åŠ è½½çš„éƒ½æ˜¯Açš„åŒä¸€ä¸ªå®ä¾‹ã€‚\nä½†æ˜¯ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå…¨å±€å˜é‡global._fooæ˜¯å¯å†™çš„ï¼Œä»»ä½•æ–‡ä»¶éƒ½å¯ä»¥ä¿®æ”¹ã€‚\nglobal._foo = { foo: \u0026#39;world\u0026#39; }; const a = require(\u0026#39;./mod.js\u0026#39;); console.log(a.foo); ä¸Šé¢çš„ä»£ç ï¼Œä¼šä½¿å¾—åŠ è½½mod.jsçš„è„šæœ¬éƒ½å¤±çœŸã€‚\nä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µå‡ºç°ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ Symbolã€‚\n// mod.js const FOO_KEY = Symbol.for(\u0026#39;foo\u0026#39;); function A() { this.foo = \u0026#39;hello\u0026#39;; } if (!global[FOO_KEY]) { global[FOO_KEY] = new A(); } module.exports = global[FOO_KEY]; ä¸Šé¢ä»£ç ä¸­ï¼Œå¯ä»¥ä¿è¯global[FOO_KEY]ä¸ä¼šè¢«æ— æ„é—´è¦†ç›–ï¼Œä½†è¿˜æ˜¯å¯ä»¥è¢«æ”¹å†™ã€‚\nglobal[Symbol.for(\u0026#39;foo\u0026#39;)] = { foo: \u0026#39;world\u0026#39; }; const a = require(\u0026#39;./mod.js\u0026#39;); å¦‚æœé”®åä½¿ç”¨Symbolæ–¹æ³•ç”Ÿæˆï¼Œé‚£ä¹ˆå¤–éƒ¨å°†æ— æ³•å¼•ç”¨è¿™ä¸ªå€¼ï¼Œå½“ç„¶ä¹Ÿå°±æ— æ³•æ”¹å†™ã€‚\n// mod.js const FOO_KEY = Symbol(\u0026#39;foo\u0026#39;); // åé¢ä»£ç ç›¸åŒ â€¦â€¦ ä¸Šé¢ä»£ç å°†å¯¼è‡´å…¶ä»–è„šæœ¬éƒ½æ— æ³•å¼•ç”¨FOO_KEYã€‚ä½†è¿™æ ·ä¹Ÿæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¦‚æœå¤šæ¬¡æ‰§è¡Œè¿™ä¸ªè„šæœ¬ï¼Œæ¯æ¬¡å¾—åˆ°çš„FOO_KEYéƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚è™½ç„¶ Node ä¼šå°†è„šæœ¬çš„æ‰§è¡Œç»“æœç¼“å­˜ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸ä¼šå¤šæ¬¡æ‰§è¡ŒåŒä¸€ä¸ªè„šæœ¬ï¼Œä½†æ˜¯ç”¨æˆ·å¯ä»¥æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜ï¼Œæ‰€ä»¥ä¹Ÿä¸æ˜¯ç»å¯¹å¯é ã€‚\nå†…ç½® é™¤äº†å®šä¹‰è‡ªå·±ä½¿ç”¨çš„ Symbol å€¼ä»¥å¤–ï¼ŒES6 è¿˜æä¾›äº† 11 ä¸ªå†…ç½®çš„ Symbol å€¼ï¼ŒæŒ‡å‘è¯­è¨€å†…éƒ¨ä½¿ç”¨çš„æ–¹æ³•ã€‚\nSymbol. hasInstance, isConcatSpreadable, species, match, replace, search, split, iterator, toPrimitive, toStringTag, unscopables\nhasInstance å¯¹è±¡çš„Symbol.hasInstanceå±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªå†…éƒ¨æ–¹æ³•ã€‚å½“å…¶ä»–å¯¹è±¡ä½¿ç”¨instanceofè¿ç®—ç¬¦ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºè¯¥å¯¹è±¡çš„å®ä¾‹æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚\nğŸ“ƒ Example æ¯”å¦‚ï¼Œfoo instanceof Fooåœ¨è¯­è¨€å†…éƒ¨ï¼Œå®é™…è°ƒç”¨çš„æ˜¯Foo[Symbol.hasInstance](foo)ã€‚\nclass MyClass { [Symbol.hasInstance](foo) { return foo instanceof Array; } } [1, 2, 3] instanceof new MyClass() // true ä¸Šé¢ä»£ç ä¸­ï¼ŒMyClassæ˜¯ä¸€ä¸ªç±»ï¼Œnew MyClass()ä¼šè¿”å›ä¸€ä¸ªå®ä¾‹ã€‚è¯¥å®ä¾‹çš„Symbol.hasInstanceæ–¹æ³•ï¼Œä¼šåœ¨è¿›è¡Œinstanceofè¿ç®—æ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œåˆ¤æ–­å·¦ä¾§çš„è¿ç®—å­æ˜¯å¦ä¸ºArrayçš„å®ä¾‹ã€‚\nğŸ“ƒ Example ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚\nclass Even { static [Symbol.hasInstance](obj) { return Number(obj) % 2 === 0; } } // ç­‰åŒäº const Even = { [Symbol.hasInstance](obj) { return Number(obj) % 2 === 0; } }; 1 instanceof Even // false 2 instanceof Even // true 12345 instanceof Even // false isConcatSpreadable å¯¹è±¡çš„Symbol.isConcatSpreadableå±æ€§ç­‰äºä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥å¯¹è±¡ç”¨äºArray.prototype.concat()æ—¶ï¼Œæ˜¯å¦å¯ä»¥å±•å¼€ã€‚\nlet arr1 = [\u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;]; [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;].concat(arr1, \u0026#39;e\u0026#39;) // [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;, \u0026#39;e\u0026#39;] arr1[Symbol.isConcatSpreadable] // undefined let arr2 = [\u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;]; arr2[Symbol.isConcatSpreadable] = false; [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;].concat(arr2, \u0026#39;e\u0026#39;) // [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, [\u0026#39;c\u0026#39;,\u0026#39;d\u0026#39;], \u0026#39;e\u0026#39;] ä¸Šé¢ä»£ç è¯´æ˜ï¼Œæ•°ç»„çš„é»˜è®¤è¡Œä¸ºæ˜¯å¯ä»¥å±•å¼€ï¼ŒSymbol.isConcatSpreadableé»˜è®¤ç­‰äºundefinedã€‚è¯¥å±æ€§ç­‰äºtrueæ—¶ï¼Œä¹Ÿæœ‰å±•å¼€çš„æ•ˆæœã€‚\nç±»ä¼¼æ•°ç»„çš„å¯¹è±¡æ­£å¥½ç›¸åï¼Œé»˜è®¤ä¸å±•å¼€ã€‚å®ƒçš„Symbol.isConcatSpreadableå±æ€§è®¾ä¸ºtrueï¼Œæ‰å¯ä»¥å±•å¼€ã€‚\nlet obj = {length: 2, 0: \u0026#39;c\u0026#39;, 1: \u0026#39;d\u0026#39;}; [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;].concat(obj, \u0026#39;e\u0026#39;) // [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, obj, \u0026#39;e\u0026#39;] obj[Symbol.isConcatSpreadable] = true; [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;].concat(obj, \u0026#39;e\u0026#39;) // [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;, \u0026#39;e\u0026#39;] Symbol.isConcatSpreadableå±æ€§ä¹Ÿå¯ä»¥å®šä¹‰åœ¨ç±»é‡Œé¢ã€‚\nclass A1 extends Array { constructor(args) { super(args); this[Symbol.isConcatSpreadable] = true; } } class A2 extends Array { constructor(args) { super(args); } get [Symbol.isConcatSpreadable] () { return false; } } let a1 = new A1(); a1[0] = 3; a1[1] = 4; let a2 = new A2(); a2[0] = 5; a2[1] = 6; [1, 2].concat(a1).concat(a2) // [1, 2, 3, 4, [5, 6]] ä¸Šé¢ä»£ç ä¸­ï¼Œç±»A1æ˜¯å¯å±•å¼€çš„ï¼Œç±»A2æ˜¯ä¸å¯å±•å¼€çš„ï¼Œæ‰€ä»¥ä½¿ç”¨concatæ—¶æœ‰ä¸ä¸€æ ·çš„ç»“æœã€‚\nğŸ“ Note æ³¨æ„ï¼ŒSymbol.isConcatSpreadableçš„ä½ç½®å·®å¼‚ï¼ŒA1æ˜¯å®šä¹‰åœ¨å®ä¾‹ä¸Šï¼ŒA2æ˜¯å®šä¹‰åœ¨ç±»æœ¬èº«ï¼Œæ•ˆæœç›¸åŒã€‚\nspecies å¯¹è±¡çš„Symbol.specieså±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚åˆ›å»ºè¡ç”Ÿå¯¹è±¡æ—¶ï¼Œä¼šä½¿ç”¨è¯¥å±æ€§ã€‚\nclass MyArray extends Array { } const a = new MyArray(1, 2, 3); const b = a.map(x =\u0026gt; x); const c = a.filter(x =\u0026gt; x \u0026gt; 1); b instanceof MyArray // true c instanceof MyArray // true ä¸Šé¢ä»£ç ä¸­ï¼Œå­ç±»MyArrayç»§æ‰¿äº†çˆ¶ç±»Arrayï¼Œaæ˜¯MyArrayçš„å®ä¾‹ï¼Œbå’Œcæ˜¯açš„è¡ç”Ÿå¯¹è±¡ã€‚ä½ å¯èƒ½ä¼šè®¤ä¸ºï¼Œbå’Œcéƒ½æ˜¯è°ƒç”¨æ•°ç»„æ–¹æ³•ç”Ÿæˆçš„ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯æ•°ç»„ï¼ˆArrayçš„å®ä¾‹ï¼‰ï¼Œä½†å®é™…ä¸Šå®ƒä»¬ä¹Ÿæ˜¯MyArrayçš„å®ä¾‹ã€‚\nSymbol.specieså±æ€§å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œæä¾›çš„ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºMyArrayè®¾ç½®Symbol.specieså±æ€§ã€‚\nğŸ“ƒ Example\nclass MyArray extends Array { static get [Symbol.species]() { return Array; } } ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äºå®šä¹‰äº†Symbol.specieså±æ€§ï¼Œåˆ›å»ºè¡ç”Ÿå¯¹è±¡æ—¶å°±ä¼šä½¿ç”¨è¿™ä¸ªå±æ€§è¿”å›çš„å‡½æ•°ï¼Œä½œä¸ºæ„é€ å‡½æ•°ã€‚è¿™ä¸ªä¾‹å­ä¹Ÿè¯´æ˜ï¼Œå®šä¹‰Symbol.specieså±æ€§è¦é‡‡ç”¨getå–å€¼å™¨ã€‚\né»˜è®¤çš„Symbol.specieså±æ€§ç­‰åŒäºä¸‹é¢çš„å†™æ³•ã€‚\nstatic get [Symbol.species]() { return this; } ğŸ“ƒ Example\nç°åœ¨ï¼Œå†æ¥çœ‹å‰é¢çš„ä¾‹å­ã€‚\nclass MyArray extends Array { static get [Symbol.species]() { return Array; } } const a = new MyArray(); const b = a.map(x =\u0026gt; x); b instanceof MyArray // false b instanceof Array // true ä¸Šé¢ä»£ç ä¸­ï¼Œa.map(x =\u0026gt; x)ç”Ÿæˆçš„è¡ç”Ÿå¯¹è±¡ï¼Œå°±ä¸æ˜¯MyArrayçš„å®ä¾‹ï¼Œè€Œç›´æ¥å°±æ˜¯Arrayçš„å®ä¾‹ã€‚\nğŸ“ƒ Example\nå†çœ‹ä¸€ä¸ªä¾‹å­ã€‚\nclass T1 extends Promise { } class T2 extends Promise { static get [Symbol.species]() { return Promise; } } new T1(r =\u0026gt; r()).then(v =\u0026gt; v) instanceof T1 // true new T2(r =\u0026gt; r()).then(v =\u0026gt; v) instanceof T2 // false ä¸Šé¢ä»£ç ä¸­ï¼ŒT2å®šä¹‰äº†Symbol.specieså±æ€§ï¼ŒT1æ²¡æœ‰ã€‚ç»“æœå°±å¯¼è‡´äº†åˆ›å»ºè¡ç”Ÿå¯¹è±¡æ—¶ï¼ˆthenæ–¹æ³•ï¼‰ï¼ŒT1è°ƒç”¨çš„æ˜¯è‡ªèº«çš„æ„é€ æ–¹æ³•ï¼Œè€ŒT2è°ƒç”¨çš„æ˜¯Promiseçš„æ„é€ æ–¹æ³•ã€‚\næ€»ä¹‹ï¼ŒSymbol.speciesçš„ä½œç”¨åœ¨äºï¼Œå®ä¾‹å¯¹è±¡åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œéœ€è¦å†æ¬¡è°ƒç”¨è‡ªèº«çš„æ„é€ å‡½æ•°æ—¶ï¼Œä¼šè°ƒç”¨è¯¥å±æ€§æŒ‡å®šçš„æ„é€ å‡½æ•°ã€‚å®ƒä¸»è¦çš„ç”¨é€”æ˜¯ï¼Œæœ‰äº›ç±»åº“æ˜¯åœ¨åŸºç±»çš„åŸºç¡€ä¸Šä¿®æ”¹çš„ï¼Œé‚£ä¹ˆå­ç±»ä½¿ç”¨ç»§æ‰¿çš„æ–¹æ³•æ—¶ï¼Œä½œè€…å¯èƒ½å¸Œæœ›è¿”å›åŸºç±»çš„å®ä¾‹ï¼Œè€Œä¸æ˜¯å­ç±»çš„å®ä¾‹ã€‚\nmatch å¯¹è±¡çš„Symbol.matchå±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªå‡½æ•°ã€‚å½“æ‰§è¡Œstr.match(myObject)æ—¶ï¼Œå¦‚æœè¯¥å±æ€§å­˜åœ¨ï¼Œä¼šè°ƒç”¨å®ƒï¼Œè¿”å›è¯¥æ–¹æ³•çš„è¿”å›å€¼ã€‚\nString.prototype.match(regexp) // ç­‰åŒäº regexp[Symbol.match](this) class MyMatcher { [Symbol.match](string) { return \u0026#39;hello world\u0026#39;.indexOf(string); } } \u0026#39;e\u0026#39;.match(new MyMatcher()) // 1 replace å¯¹è±¡çš„Symbol.replaceå±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªæ–¹æ³•ï¼Œå½“è¯¥å¯¹è±¡è¢«String.prototype.replaceæ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼šè¿”å›è¯¥æ–¹æ³•çš„è¿”å›å€¼ã€‚\nString.prototype.replace(searchValue, replaceValue) // ç­‰åŒäº searchValue[Symbol.replace](this, replaceValue) ğŸ“ƒ Example\nä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚\nconst x = {}; x[Symbol.replace] = (...s) =\u0026gt; console.log(s); \u0026#39;Hello\u0026#39;.replace(x, \u0026#39;World\u0026#39;) // [\u0026#34;Hello\u0026#34;, \u0026#34;World\u0026#34;] Symbol.replaceæ–¹æ³•ä¼šæ”¶åˆ°ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯replaceæ–¹æ³•æ­£åœ¨ä½œç”¨çš„å¯¹è±¡ï¼Œä¸Šé¢ä¾‹å­æ˜¯Helloï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ›¿æ¢åçš„å€¼ï¼Œä¸Šé¢ä¾‹å­æ˜¯Worldã€‚\nsearch å¯¹è±¡çš„Symbol.searchå±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªæ–¹æ³•ï¼Œå½“è¯¥å¯¹è±¡è¢«String.prototype.searchæ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼šè¿”å›è¯¥æ–¹æ³•çš„è¿”å›å€¼ã€‚\nString.prototype.search(regexp) // ç­‰åŒäº regexp[Symbol.search](this) class MySearch { constructor(value) { this.value = value; } [Symbol.search](string) { return string.indexOf(this.value); } } \u0026#39;foobar\u0026#39;.search(new MySearch(\u0026#39;foo\u0026#39;)) // 0 split å¯¹è±¡çš„Symbol.splitå±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªæ–¹æ³•ï¼Œå½“è¯¥å¯¹è±¡è¢«String.prototype.splitæ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼šè¿”å›è¯¥æ–¹æ³•çš„è¿”å›å€¼ã€‚\nString.prototype.split(separator, limit) // ç­‰åŒäº separator[Symbol.split](this, limit) ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚\nclass MySplitter { constructor(value) { this.value = value; } [Symbol.split](string) { let index = string.indexOf(this.value); if (index === -1) { return string; } return [ string.substr(0, index), string.substr(index + this.value.length) ]; } } \u0026#39;foobar\u0026#39;.split(new MySplitter(\u0026#39;foo\u0026#39;)) // [\u0026#39;\u0026#39;, \u0026#39;bar\u0026#39;] \u0026#39;foobar\u0026#39;.split(new MySplitter(\u0026#39;bar\u0026#39;)) // [\u0026#39;foo\u0026#39;, \u0026#39;\u0026#39;] \u0026#39;foobar\u0026#39;.split(new MySplitter(\u0026#39;baz\u0026#39;)) // \u0026#39;foobar\u0026#39; ä¸Šé¢æ–¹æ³•ä½¿ç”¨Symbol.splitæ–¹æ³•ï¼Œé‡æ–°å®šä¹‰äº†å­—ç¬¦ä¸²å¯¹è±¡çš„splitæ–¹æ³•çš„è¡Œä¸ºï¼Œ\niterator å¯¹è±¡çš„ Symbol.iterator å±æ€§ï¼ŒæŒ‡å‘è¯¥å¯¹è±¡çš„é»˜è®¤éå†å™¨æ–¹æ³•ã€‚\nconst myIterable = {}; myIterable[Symbol.iterator] = function* () { yield 1; yield 2; yield 3; }; [...myIterable] // [1, 2, 3] å¯¹è±¡è¿›è¡Œfor...ofå¾ªç¯æ—¶ï¼Œä¼šè°ƒç”¨ Symbol.iterator æ–¹æ³•ï¼Œè¿”å›è¯¥å¯¹è±¡çš„é»˜è®¤éå†å™¨ï¼Œè¯¦ç»†ä»‹ç»å‚è§ã€ŠIterator å’Œ for\u0026hellip;of å¾ªç¯ã€‹ä¸€ç« ã€‚\nclass Collection { *[Symbol.iterator]() { let i = 0; while(this[i] !== undefined) { yield this[i]; ++i; } } } let myCollection = new Collection(); myCollection[0] = 1; myCollection[1] = 2; for(let value of myCollection) { console.log(value); } // 1 // 2 toPrimitive å¯¹è±¡çš„Symbol.toPrimitiveå±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªæ–¹æ³•ã€‚è¯¥å¯¹è±¡è¢«è½¬ä¸ºåŸå§‹ç±»å‹çš„å€¼æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè¿”å›è¯¥å¯¹è±¡å¯¹åº”çš„åŸå§‹ç±»å‹å€¼ã€‚\nSymbol.toPrimitiveè¢«è°ƒç”¨æ—¶ï¼Œä¼šæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œè¡¨ç¤ºå½“å‰è¿ç®—çš„æ¨¡å¼ï¼Œä¸€å…±æœ‰ä¸‰ç§æ¨¡å¼ã€‚\nNumberï¼šè¯¥åœºåˆéœ€è¦è½¬æˆæ•°å€¼ Stringï¼šè¯¥åœºåˆéœ€è¦è½¬æˆå­—ç¬¦ä¸² Defaultï¼šè¯¥åœºåˆå¯ä»¥è½¬æˆæ•°å€¼ï¼Œä¹Ÿå¯ä»¥è½¬æˆå­—ç¬¦ä¸² let obj = { [Symbol.toPrimitive](hint) { switch (hint) { case \u0026#39;number\u0026#39;: return 123; case \u0026#39;string\u0026#39;: return \u0026#39;str\u0026#39;; case \u0026#39;default\u0026#39;: return \u0026#39;default\u0026#39;; default: throw new Error(); } } }; 2 * obj // 246 3 + obj // \u0026#39;3default\u0026#39; obj == \u0026#39;default\u0026#39; // true String(obj) // \u0026#39;str\u0026#39; toStringTag å¯¹è±¡çš„Symbol.toStringTagå±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªæ–¹æ³•ã€‚åœ¨è¯¥å¯¹è±¡ä¸Šé¢è°ƒç”¨Object.prototype.toStringæ–¹æ³•æ—¶ï¼Œå¦‚æœè¿™ä¸ªå±æ€§å­˜åœ¨ï¼Œå®ƒçš„è¿”å›å€¼ä¼šå‡ºç°åœ¨toStringæ–¹æ³•è¿”å›çš„å­—ç¬¦ä¸²ä¹‹ä¸­ï¼Œè¡¨ç¤ºå¯¹è±¡çš„ç±»å‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªå±æ€§å¯ä»¥ç”¨æ¥å®šåˆ¶[object Object]æˆ–[object Array]ä¸­objectåé¢çš„é‚£ä¸ªå­—ç¬¦ä¸²ã€‚\n// ä¾‹ä¸€ ({[Symbol.toStringTag]: \u0026#39;Foo\u0026#39;}.toString()) // \u0026#34;[object Foo]\u0026#34; // ä¾‹äºŒ class Collection { get [Symbol.toStringTag]() { return \u0026#39;xxx\u0026#39;; } } let x = new Collection(); Object.prototype.toString.call(x) // \u0026#34;[object xxx]\u0026#34; ES6 æ–°å¢å†…ç½®å¯¹è±¡çš„Symbol.toStringTagå±æ€§å€¼å¦‚ä¸‹ã€‚\nJSON[Symbol.toStringTag]ï¼š\u0026lsquo;JSON\u0026rsquo; Math[Symbol.toStringTag]ï¼š\u0026lsquo;Math\u0026rsquo; Module å¯¹è±¡M[Symbol.toStringTag]ï¼š\u0026lsquo;Module\u0026rsquo; ArrayBuffer.prototype[Symbol.toStringTag]ï¼š\u0026lsquo;ArrayBuffer\u0026rsquo; DataView.prototype[Symbol.toStringTag]ï¼š\u0026lsquo;DataView\u0026rsquo; Map.prototype[Symbol.toStringTag]ï¼š\u0026lsquo;Map\u0026rsquo; Promise.prototype[Symbol.toStringTag]ï¼š\u0026lsquo;Promise\u0026rsquo; Set.prototype[Symbol.toStringTag]ï¼š\u0026lsquo;Set\u0026rsquo; %TypedArray%.prototype[Symbol.toStringTag]ï¼š\u0026lsquo;Uint8Array\u0026rsquo;ç­‰ WeakMap.prototype[Symbol.toStringTag]ï¼š\u0026lsquo;WeakMap\u0026rsquo; WeakSet.prototype[Symbol.toStringTag]ï¼š\u0026lsquo;WeakSet\u0026rsquo; %MapIteratorPrototype%[Symbol.toStringTag]ï¼š\u0026lsquo;Map Iterator\u0026rsquo; %SetIteratorPrototype%[Symbol.toStringTag]ï¼š\u0026lsquo;Set Iterator\u0026rsquo; %StringIteratorPrototype%[Symbol.toStringTag]ï¼š\u0026lsquo;String Iterator\u0026rsquo; Symbol.prototype[Symbol.toStringTag]ï¼š\u0026lsquo;Symbol\u0026rsquo; Generator.prototype[Symbol.toStringTag]ï¼š\u0026lsquo;Generator\u0026rsquo; GeneratorFunction.prototype[Symbol.toStringTag]ï¼š\u0026lsquo;GeneratorFunction\u0026rsquo; unscopables å¯¹è±¡çš„Symbol.unscopableså±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªå¯¹è±¡ã€‚è¯¥å¯¹è±¡æŒ‡å®šäº†ä½¿ç”¨withå…³é”®å­—æ—¶ï¼Œå“ªäº›å±æ€§ä¼šè¢«withç¯å¢ƒæ’é™¤ã€‚\nğŸ“ƒ Example\nArray.prototype[Symbol.unscopables] // { // copyWithin: true, // entries: true, // fill: true, // find: true, // findIndex: true, // includes: true, // keys: true // } Object.keys(Array.prototype[Symbol.unscopables]) // [\u0026#39;copyWithin\u0026#39;, \u0026#39;entries\u0026#39;, \u0026#39;fill\u0026#39;, \u0026#39;find\u0026#39;, \u0026#39;findIndex\u0026#39;, \u0026#39;includes\u0026#39;, \u0026#39;keys\u0026#39;] ä¸Šé¢ä»£ç è¯´æ˜ï¼Œæ•°ç»„æœ‰ 7 ä¸ªå±æ€§ï¼Œä¼šè¢« with å‘½ä»¤æ’é™¤ã€‚\nğŸ“ƒ Example\n// æ²¡æœ‰ unscopables æ—¶ class MyClass { foo() { return 1; } } var foo = function () { return 2; }; with (MyClass.prototype) { foo(); // 1 } // æœ‰ unscopables æ—¶ class MyClass { foo() { return 1; } get [Symbol.unscopables]() { return { foo: true }; } } var foo = function () { return 2; }; with (MyClass.prototype) { foo(); // 2 } ä¸Šé¢ä»£ç é€šè¿‡æŒ‡å®šSymbol.unscopableså±æ€§ï¼Œä½¿å¾—withè¯­æ³•å—ä¸ä¼šåœ¨å½“å‰ä½œç”¨åŸŸå¯»æ‰¾fooå±æ€§ï¼Œå³fooå°†æŒ‡å‘å¤–å±‚ä½œç”¨åŸŸçš„å˜é‡ã€‚\nIterator JavaScript åŸæœ‰çš„è¡¨ç¤ºâ€œé›†åˆâ€çš„æ•°æ®ç»“æ„ï¼Œä¸»è¦æ˜¯æ•°ç»„ [Array](05 JavaScript#array-es5) å’Œå¯¹è±¡ [Object](05 JavaScript#object-es5) ï¼ŒES6 åˆæ·»åŠ äº† [Map](05 EcmaScript.md/#map-es6) å’Œ [Set](05 EcmaScript.md/#set-es6) ã€‚è¿™æ ·å°±æœ‰äº†å››ç§æ•°æ®é›†åˆï¼Œç”¨æˆ·è¿˜å¯ä»¥ç»„åˆä½¿ç”¨å®ƒä»¬ï¼Œå®šä¹‰è‡ªå·±çš„æ•°æ®ç»“æ„ï¼Œæ¯”å¦‚æ•°ç»„çš„æˆå‘˜æ˜¯ Mapï¼ŒMap çš„æˆå‘˜æ˜¯å¯¹è±¡ã€‚è¿™æ ·å°±éœ€è¦ä¸€ç§ç»Ÿä¸€çš„æ¥å£æœºåˆ¶ï¼Œæ¥å¤„ç†æ‰€æœ‰ä¸åŒçš„æ•°æ®ç»“æ„ã€‚\néå†å™¨ - iterator å°±æ˜¯è¿™æ ·ä¸€ç§æœºåˆ¶ã€‚å®ƒæ˜¯ä¸€ç§æ¥å£ï¼Œä¸ºå„ç§ä¸åŒçš„æ•°æ®ç»“æ„æä¾›ç»Ÿä¸€çš„è®¿é—®æœºåˆ¶ã€‚ä»»ä½•æ•°æ®ç»“æ„åªè¦éƒ¨ç½² iterator æ¥å£ï¼Œå°±å¯ä»¥å®Œæˆéå†æ“ä½œï¼ˆå³ä¾æ¬¡å¤„ç†è¯¥æ•°æ®ç»“æ„çš„æ‰€æœ‰æˆå‘˜ï¼‰ã€‚\nå¯è¿­ä»£åè®®iterable protocol å…è®¸å¯¹è±¡å®šä¹‰æˆ–å®šåˆ¶å®ƒä»¬çš„è¿­ä»£è¡Œä¸ºï¼Œä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ª for-of ç»“æ„ä¸­ï¼Œå“ªäº›å€¼å¯ä»¥è¢«éå†åˆ°ã€‚ä¸€äº›å†…ç½®ç±»å‹åŒæ—¶æ˜¯å†…ç½®å¯è¿­ä»£å¯¹è±¡ï¼Œå¹¶ä¸”æœ‰é»˜è®¤çš„è¿­ä»£è¡Œä¸ºï¼Œæ¯”å¦‚ Array æˆ–è€… Mapï¼Œè€Œå…¶ä»–å†…ç½®ç±»å‹åˆ™ä¸æ˜¯ï¼ˆæ¯”å¦‚ Objectï¼‰ã€‚\nè¦æˆä¸ºå¯è¿­ä»£å¯¹è±¡ï¼Œ ä¸€ä¸ªå¯¹è±¡å¿…é¡»å®ç° @@iterator æ–¹æ³•ã€‚è¿™æ„å‘³ç€å¯¹è±¡/åŸå‹é“¾prototype_chain ä¸Šçš„æŸä¸ªå¯¹è±¡å¿…é¡»æœ‰ä¸€ä¸ªé”®ä¸º @@iterator çš„å±æ€§ï¼Œå¯é€šè¿‡å¸¸é‡ Symbol.iterator è®¿é—®è¯¥å±æ€§ï¼š\nå±æ€§ å€¼ [Symbol.iterator] ä¸€ä¸ª æ— å‚æ•° çš„å‡½æ•°ï¼Œå…¶è¿”å›å€¼ä¸ºä¸€ä¸ªç¬¦åˆè¿­ä»£å™¨åè®®çš„å¯¹è±¡ã€‚ å½“ä¸€ä¸ªå¯¹è±¡éœ€è¦è¢«è¿­ä»£çš„æ—¶å€™ï¼ˆæ¯”å¦‚è¢«ç½®å…¥ä¸€ä¸ª for-of å¾ªç¯æ—¶ï¼‰ï¼Œé¦–å…ˆï¼Œä¼šä¸å¸¦å‚æ•°è°ƒç”¨å®ƒçš„ @@iterator æ–¹æ³•ï¼Œç„¶åä½¿ç”¨æ­¤æ–¹æ³•è¿”å›çš„ è¿­ä»£å™¨ è·å¾—è¦è¿­ä»£çš„å€¼ã€‚\nå€¼å¾—æ³¨æ„çš„æ˜¯è°ƒç”¨æ­¤é›¶ä¸ªå‚æ•°å‡½æ•°æ—¶ï¼Œå®ƒå°†ä½œä¸ºå¯¹å¯è¿­ä»£å¯¹è±¡çš„æ–¹æ³•è¿›è¡Œè°ƒç”¨ã€‚ å› æ­¤ï¼Œåœ¨å‡½æ•°å†…éƒ¨ï¼Œthiså…³é”®å­—å¯ç”¨äºè®¿é—®å¯è¿­ä»£å¯¹è±¡çš„å±æ€§ï¼Œä»¥å†³å®šåœ¨è¿­ä»£è¿‡ç¨‹ä¸­æä¾›ä»€ä¹ˆã€‚\næ­¤å‡½æ•°å¯ä»¥æ˜¯æ™®é€šå‡½æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯ç”Ÿæˆå™¨å‡½æ•°ï¼Œä»¥ä¾¿åœ¨è°ƒç”¨æ—¶è¿”å›è¿­ä»£å™¨å¯¹è±¡ã€‚ åœ¨æ­¤ç”Ÿæˆå™¨å‡½æ•°çš„å†…éƒ¨ï¼Œå¯ä»¥ä½¿ç”¨yieldæä¾›æ¯ä¸ªæ¡ç›®ã€‚\nIterator çš„ä½œç”¨æœ‰ä¸‰ä¸ªï¼šä¸€æ˜¯ä¸ºå„ç§æ•°æ®ç»“æ„ï¼Œæä¾›ä¸€ä¸ªç»Ÿä¸€çš„ã€ç®€ä¾¿çš„è®¿é—®æ¥å£ï¼›äºŒæ˜¯ä½¿å¾—æ•°æ®ç»“æ„çš„æˆå‘˜èƒ½å¤ŸæŒ‰æŸç§æ¬¡åºæ’åˆ—ï¼›ä¸‰æ˜¯ ES6 åˆ›é€ äº†ä¸€ç§æ–°çš„éå†å‘½ä»¤ [for-of](05 JavaScript#for-of) å¾ªç¯ï¼ŒIterator æ¥å£ä¸»è¦ä¾› for-of ä½¿ç”¨ã€‚\nIterator çš„éå†è¿‡ç¨‹æ˜¯è¿™æ ·çš„ã€‚\nåˆ›å»ºä¸€ä¸ªæŒ‡é’ˆå¯¹è±¡ï¼ŒæŒ‡å‘å½“å‰æ•°æ®ç»“æ„çš„èµ·å§‹ä½ç½®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œéå†å™¨å¯¹è±¡æœ¬è´¨ä¸Šï¼Œå°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆå¯¹è±¡ ç¬¬ä¸€æ¬¡è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„ next æ–¹æ³•ï¼Œå¯ä»¥å°†æŒ‡é’ˆæŒ‡å‘æ•°æ®ç»“æ„çš„ç¬¬ä¸€ä¸ªæˆå‘˜ ç¬¬äºŒæ¬¡è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„ next æ–¹æ³•ï¼ŒæŒ‡é’ˆå°±æŒ‡å‘æ•°æ®ç»“æ„çš„ç¬¬äºŒä¸ªæˆå‘˜ ä¸æ–­è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„ next æ–¹æ³•ï¼Œç›´åˆ°å®ƒæŒ‡å‘æ•°æ®ç»“æ„çš„ç»“æŸä½ç½® graph LR A(head) -.-\u0026gt;|next| B(\u0026#34;[0]\u0026#34;) B-.-\u0026gt;|next| C(\u0026#34;[1]\u0026#34;) C-.-\u0026gt;|next| D(\u0026#34;[2]\u0026#34;) D-.-\u0026gt;|next| E(\u0026#34;[3]\u0026#34;) E-.-\u0026gt;|next| A æ¯ä¸€æ¬¡è°ƒç”¨ next æ–¹æ³•ï¼Œéƒ½ä¼šè¿”å›æ•°æ®ç»“æ„çš„å½“å‰æˆå‘˜çš„ä¿¡æ¯ã€‚å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯è¿”å›ä¸€ä¸ªåŒ…å« value å’Œ done ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡ã€‚å…¶ä¸­ï¼Œ value å±æ€§æ˜¯å½“å‰æˆå‘˜çš„å€¼ï¼Œ done å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºéå†æ˜¯å¦ç»“æŸã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿ next æ–¹æ³•è¿”å›å€¼çš„ä¾‹å­ã€‚\nğŸ“ƒ Example\nfunction makeIterator(array) { let nextIndex = 0; return { next: function () { return nextIndex \u0026lt; array.length ? {value: array[nextIndex++], done: false} : {done: true}; } }; } const it = makeIterator([\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;]); it.next() // { value: \u0026#34;a\u0026#34;, done: false } it.next() // { value: \u0026#34;b\u0026#34;, done: false } it.next() // {done: true } ğŸ“ Note ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ª makeIterator å‡½æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ªéå†å™¨ç”Ÿæˆå‡½æ•°ï¼Œä½œç”¨å°±æ˜¯è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ã€‚å¯¹æ•°ç»„ ['a', 'b'] æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œå°±ä¼šè¿”å›è¯¥æ•°ç»„çš„éå†å™¨å¯¹è±¡ï¼ˆå³ æŒ‡é’ˆå¯¹è±¡ ï¼‰itã€‚\næŒ‡é’ˆå¯¹è±¡çš„ next æ–¹æ³•ï¼Œç”¨æ¥ç§»åŠ¨æŒ‡é’ˆã€‚å¼€å§‹æ—¶ï¼ŒæŒ‡é’ˆæŒ‡å‘æ•°ç»„çš„å¼€å§‹ä½ç½®ã€‚ç„¶åï¼Œæ¯æ¬¡è°ƒç”¨ next æ–¹æ³•ï¼ŒæŒ‡é’ˆå°±ä¼šæŒ‡å‘æ•°ç»„çš„ä¸‹ä¸€ä¸ªæˆå‘˜ã€‚ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼ŒæŒ‡å‘aï¼›ç¬¬äºŒæ¬¡è°ƒç”¨ï¼ŒæŒ‡å‘bã€‚\nnext æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¡¨ç¤ºå½“å‰æ•°æ®æˆå‘˜çš„ä¿¡æ¯ã€‚è¿™ä¸ªå¯¹è±¡å…·æœ‰ value å’Œ done ä¸¤ä¸ªå±æ€§ï¼Œ value å±æ€§è¿”å›å½“å‰ä½ç½®çš„æˆå‘˜ï¼Œ done å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºéå†æ˜¯å¦ç»“æŸï¼Œå³æ˜¯å¦è¿˜æœ‰å¿…è¦å†ä¸€æ¬¡è°ƒç”¨ next æ–¹æ³•ã€‚\næ€»ä¹‹ï¼Œè°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„ next æ–¹æ³•ï¼Œå°±å¯ä»¥éå†äº‹å…ˆç»™å®šçš„æ•°æ®ç»“æ„ã€‚\nç”±äº Iterator åªæ˜¯æŠŠæ¥å£è§„æ ¼åŠ åˆ°æ•°æ®ç»“æ„ä¹‹ä¸Šï¼Œæ‰€ä»¥ï¼Œ éå†å™¨ ä¸å®ƒæ‰€éå†çš„é‚£ä¸ª æ•°æ®ç»“æ„ ï¼Œå®é™…ä¸Šæ˜¯åˆ†å¼€çš„ï¼Œå®Œå…¨å¯ä»¥å†™å‡ºæ²¡æœ‰å¯¹åº”æ•°æ®ç»“æ„çš„éå†å™¨å¯¹è±¡ï¼Œæˆ–è€…è¯´ç”¨éå†å™¨å¯¹è±¡æ¨¡æ‹Ÿå‡ºæ•°æ®ç»“æ„ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ— é™è¿è¡Œçš„éå†å™¨å¯¹è±¡çš„ä¾‹å­ã€‚\nğŸ“ƒ Example\nfunction idMaker() { let index = 0; return { // è¿”å›éå†å™¨å¯¹è±¡ {next(){}} next() { return {value: index++, done: false}; } }; } const it = idMaker(); console.log(it.next().value); // 0 console.log(it.next().value); // 1 console.log(it.next().value); // 2 // ... ğŸ“ Note ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œéå†å™¨ç”Ÿæˆå‡½æ•° idMaker ï¼Œè¿”å›ä¸€ä¸ª éå†å™¨å¯¹è±¡ï¼ˆå³æŒ‡é’ˆå¯¹è±¡ï¼‰ã€‚ä½†æ˜¯å¹¶æ²¡æœ‰å¯¹åº”çš„æ•°æ®ç»“æ„ï¼Œæˆ–è€…è¯´ï¼Œéå†å™¨å¯¹è±¡è‡ªå·±æè¿°äº†ä¸€ä¸ªæ•°æ®ç»“æ„å‡ºæ¥ã€‚\nåè®® è¿­ä»£å™¨åè®®iterator protocol å®šä¹‰äº†äº§ç”Ÿä¸€ç³»åˆ—å€¼ï¼ˆæ— è®ºæ˜¯æœ‰é™ä¸ªè¿˜æ˜¯æ— é™ä¸ªï¼‰çš„æ ‡å‡†æ–¹å¼ã€‚å½“å€¼ä¸ºæœ‰é™ä¸ªæ—¶ï¼Œæ‰€æœ‰çš„å€¼éƒ½è¢«è¿­ä»£å®Œæ¯•åï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ªé»˜è®¤è¿”å›å€¼ã€‚\nåªæœ‰å®ç°äº†ä¸€ä¸ªæ‹¥æœ‰ä»¥ä¸‹è¯­ä¹‰semantic çš„ next() æ–¹æ³•ï¼Œä¸€ä¸ªå¯¹è±¡æ‰èƒ½æˆä¸ºè¿­ä»£å™¨ï¼š\nå±æ€§ å€¼ next() ä¸€ä¸ªæ— å‚æ•°æˆ–è€…ä¸€ä¸ªå‚æ•°çš„å‡½æ•° ğŸ“ Note\nè¿”å›ä¸€ä¸ªåº”å½“æ‹¥æœ‰ä»¥ä¸‹ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡ï¼š\ndoneboolean å¦‚æœè¿­ä»£å™¨å¯ä»¥äº§ç”Ÿåºåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªå€¼ï¼Œåˆ™ä¸º falseã€‚ï¼ˆè¿™ç­‰ä»·äºæ²¡æœ‰æŒ‡å®š done è¿™ä¸ªå±æ€§ã€‚ï¼‰\nå¦‚æœè¿­ä»£å™¨å·²å°†åºåˆ—è¿­ä»£å®Œæ¯•ï¼Œåˆ™ä¸º trueã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œvalue æ˜¯å¯é€‰çš„ï¼Œå¦‚æœå®ƒä¾ç„¶å­˜åœ¨ï¼Œå³ä¸ºè¿­ä»£ç»“æŸä¹‹åçš„é»˜è®¤è¿”å›å€¼ã€‚\nvalue è¿­ä»£å™¨è¿”å›çš„ä»»ä½• JavaScript å€¼ã€‚done ä¸º true æ—¶å¯çœç•¥ã€‚next() æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åº”å½“æœ‰ä¸¤ä¸ªå±æ€§ï¼š done å’Œ valueï¼Œå¦‚æœè¿”å›äº†ä¸€ä¸ªéå¯¹è±¡å€¼ï¼ˆæ¯”å¦‚ false æˆ– undefinedï¼‰ï¼Œåˆ™ä¼šæŠ›å‡ºä¸€ä¸ª TypeError å¼‚å¸¸ï¼ˆ\u0026quot;iterator.next() returned a non-object value\u0026quot;ï¼‰ã€‚\nğŸ“ Note ä¸å¯èƒ½åˆ¤æ–­ä¸€ä¸ªç‰¹å®šçš„å¯¹è±¡æ˜¯å¦å®ç°äº†è¿­ä»£å™¨åè®®ï¼Œç„¶è€Œï¼Œåˆ›é€ ä¸€ä¸ª åŒæ—¶ æ»¡è¶³ è¿­ä»£å™¨åè®®iterator protocol å’Œ å¯è¿­ä»£åè®®iterable protocol çš„å¯¹è±¡æ˜¯å¾ˆå®¹æ˜“çš„ã€‚\nè¿™æ ·åšå…è®¸ä¸€ä¸ªè¿­ä»£å™¨èƒ½è¢«å„ç§éœ€è¦å¯è¿­ä»£å¯¹è±¡çš„è¯­æ³•æ‰€ä½¿ç”¨ã€‚å› æ­¤ï¼Œå¾ˆå°‘ä¼šåªå®ç°è¿­ä»£å™¨åè®®ï¼Œè€Œä¸å®ç°å¯è¿­ä»£åè®®ã€‚\nvar myIterator = { next: function () { //å¯è¿­ä»£åè®® //... }, [Symbol.iterator]: function () { return this; } // è¿­ä»£å™¨åè®® } å¦‚æœä½¿ç”¨ TypeScript çš„å†™æ³•ï¼Œéå†å™¨æ¥å£ - Iterableã€æŒ‡é’ˆå¯¹è±¡ - Iterator å’Œ next æ–¹æ³•è¿”å›å€¼çš„è§„æ ¼å¯ä»¥æè¿°å¦‚ä¸‹ã€‚\ninterface Iterable { [Symbol.iterator]() : Iterator, } interface Iterator { next(value?: any) : IterationResult, } interface IterationResult { value: any, done: boolean, } éå† Iterator æ¥å£çš„ç›®çš„ï¼Œå°±æ˜¯ä¸ºæ‰€æœ‰æ•°æ®ç»“æ„ï¼Œæä¾›äº†ä¸€ç§ç»Ÿä¸€çš„è®¿é—®æœºåˆ¶ï¼Œå³ [for-of](05 JavaScript#for-of) ã€‚å½“ä½¿ç”¨ for-of å¾ªç¯éå†æŸç§æ•°æ®ç»“æ„æ—¶ï¼Œè¯¥å¾ªç¯ä¼šè‡ªåŠ¨å»å¯»æ‰¾ Iterator æ¥å£ã€‚\n:link: Href iterator for-of\nä¸€ç§æ•°æ®ç»“æ„åªè¦éƒ¨ç½²äº† Iterator æ¥å£ï¼Œæˆ‘ä»¬å°±ç§°è¿™ç§æ•°æ®ç»“æ„æ˜¯å¯éå†çš„ - iterableã€‚\nES6 è§„å®šï¼Œé»˜è®¤çš„ Iterator æ¥å£éƒ¨ç½²åœ¨æ•°æ®ç»“æ„çš„ Symbol.iterator å±æ€§ï¼Œæˆ–è€…è¯´ï¼Œä¸€ä¸ªæ•°æ®ç»“æ„åªè¦å…·æœ‰ Symbol.iterator å±æ€§ï¼Œå°±å¯ä»¥è®¤ä¸ºæ˜¯ å¯éå† çš„ã€‚ Symbol.iterator å±æ€§æœ¬èº«æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå°±æ˜¯å½“å‰æ•°æ®ç»“æ„é»˜è®¤çš„ éå†å™¨ç”Ÿæˆå‡½æ•° ã€‚æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªéå†å™¨ã€‚è‡³äºå±æ€§å Symbol.iterator ï¼Œå®ƒæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¿”å› Symbol å¯¹è±¡çš„ iterator å±æ€§ï¼Œè¿™æ˜¯ä¸€ä¸ªé¢„å®šä¹‰å¥½çš„ã€ç±»å‹ä¸º Symbol çš„ç‰¹æ®Šå€¼ï¼Œæ‰€ä»¥è¦æ”¾åœ¨æ–¹æ‹¬å·å†…ã€‚\n:link: Href Symbol ç±»å‹\nğŸ“ƒ Example\nconst obj = { [Symbol.iterator]() { // for-ofä½¿ç”¨çš„iterator protocol let index = 0; return { next() { return index++ \u0026lt; 10 ? { value: index, done: false } : {done: true}; } }; } }; for (const objElement of obj) { console.log(objElement); } ä¸Šé¢ä»£ç ä¸­ï¼Œå¯¹è±¡ obj æ˜¯ å¯éå†iterable çš„ï¼Œå› ä¸ºå…·æœ‰ Symbol.iterator å±æ€§ã€‚æ‰§è¡Œè¿™ä¸ªå±æ€§ï¼Œä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ã€‚è¯¥å¯¹è±¡çš„æ ¹æœ¬ç‰¹å¾å°±æ˜¯å…·æœ‰ next æ–¹æ³•ã€‚æ¯æ¬¡è°ƒç”¨ next æ–¹æ³•ï¼Œéƒ½ä¼šè¿”å›ä¸€ä¸ªä»£è¡¨å½“å‰æˆå‘˜çš„ä¿¡æ¯å¯¹è±¡ï¼Œå…·æœ‰ value å’Œ done ä¸¤ä¸ªå±æ€§ã€‚\nES6 çš„æœ‰äº›æ•°æ®ç»“æ„åŸç”Ÿå…·å¤‡ Iterator æ¥å£ï¼ˆæ¯”å¦‚æ•°ç»„ï¼‰ï¼Œå³ä¸ç”¨ä»»ä½•å¤„ç†ï¼Œå°±å¯ä»¥è¢« for-of å¾ªç¯éå†ã€‚åŸå› åœ¨äºï¼Œè¿™äº›æ•°æ®ç»“æ„ åŸç”Ÿéƒ¨ç½² äº† Symbol.iterator å±æ€§ï¼Œå¦å¤–ä¸€äº›æ•°æ®ç»“æ„æ²¡æœ‰ï¼ˆæ¯”å¦‚å¯¹è±¡ï¼‰ã€‚å‡¡æ˜¯éƒ¨ç½²äº† Symbol.iterator å±æ€§çš„æ•°æ®ç»“æ„ï¼Œå°±ç§°ä¸ºéƒ¨ç½²äº†éå†å™¨æ¥å£ã€‚è°ƒç”¨è¿™ä¸ªæ¥å£ï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ã€‚\nåŸç”Ÿå…·å¤‡ Iterator æ¥å£çš„æ•°æ®ç»“æ„å¦‚ä¸‹ã€‚\n[Array](05 JavaScript#array-es5) Map Set [String](05 JavaScript#string-es5) TypedArray å‡½æ•°çš„ [arguments](05 JavaScript#arguments-es5) å¯¹è±¡ [NodeList](05 JavaScript#nodelist-es5) å¯¹è±¡ ä¸‹é¢çš„ä¾‹å­æ˜¯æ•°ç»„çš„ Symbol.iterator å±æ€§ã€‚\nğŸ“ƒ Example\nlet arr = [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;]; let iter = arr[Symbol.iterator](); iter.next() // { value: \u0026#39;a\u0026#39;, done: false } iter.next() // { value: \u0026#39;b\u0026#39;, done: false } iter.next() // { value: \u0026#39;c\u0026#39;, done: false } iter.next() // { value: undefined, done: true } ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡ arr æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŸç”Ÿå°±å…·æœ‰éå†å™¨æ¥å£ï¼Œéƒ¨ç½²åœ¨ arr çš„ Symbol.iterator å±æ€§ä¸Šé¢ã€‚æ‰€ä»¥ï¼Œè°ƒç”¨è¿™ä¸ªå±æ€§ï¼Œå°±å¾—åˆ°éå†å™¨å¯¹è±¡ã€‚\nå¯¹äºåŸç”Ÿéƒ¨ç½² Iterator æ¥å£çš„æ•°æ®ç»“æ„ï¼Œä¸ç”¨è‡ªå·±å†™éå†å™¨ç”Ÿæˆå‡½æ•°ï¼Œ for-of å¾ªç¯ä¼šè‡ªåŠ¨éå†å®ƒä»¬ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå…¶ä»–æ•°æ®ç»“æ„ï¼ˆä¸»è¦æ˜¯å¯¹è±¡ï¼‰çš„ Iterator æ¥å£ï¼Œéƒ½éœ€è¦è‡ªå·±åœ¨ Symbol.iterator å±æ€§ä¸Šé¢éƒ¨ç½²ï¼Œè¿™æ ·æ‰ä¼šè¢« for-of å¾ªç¯éå†ã€‚\nå¯¹è±¡ - Object ä¹‹æ‰€ä»¥æ²¡æœ‰é»˜è®¤éƒ¨ç½² Iterator æ¥å£ï¼Œæ˜¯å› ä¸ºå¯¹è±¡çš„å“ªä¸ªå±æ€§å…ˆéå†ï¼Œå“ªä¸ªå±æ€§åéå†æ˜¯ä¸ç¡®å®šçš„ï¼Œéœ€è¦å¼€å‘è€…æ‰‹åŠ¨æŒ‡å®šã€‚æœ¬è´¨ä¸Šï¼Œéå†å™¨æ˜¯ä¸€ç§çº¿æ€§å¤„ç†ï¼Œå¯¹äºä»»ä½•éçº¿æ€§çš„æ•°æ®ç»“æ„ï¼Œéƒ¨ç½²éå†å™¨æ¥å£ï¼Œå°±ç­‰äºéƒ¨ç½²ä¸€ç§ çº¿æ€§è½¬æ¢ ã€‚ä¸è¿‡ï¼Œä¸¥æ ¼åœ°è¯´ï¼Œå¯¹è±¡éƒ¨ç½²éå†å™¨æ¥å£å¹¶ä¸æ˜¯å¾ˆå¿…è¦ï¼Œå› ä¸ºè¿™æ—¶å¯¹è±¡å®é™…ä¸Šè¢«å½“ä½œ Map ç»“æ„ä½¿ç”¨ï¼ŒES5 æ²¡æœ‰ Map ç»“æ„ï¼Œè€Œ ES6 åŸç”Ÿæä¾›äº†ã€‚\nä¸€ä¸ªå¯¹è±¡å¦‚æœè¦å…·å¤‡å¯è¢« for-of å¾ªç¯è°ƒç”¨çš„ Iterator æ¥å£ï¼Œå°±å¿…é¡»åœ¨ Symbol.iterator çš„å±æ€§ä¸Šéƒ¨ç½²éå†å™¨ç”Ÿæˆæ–¹æ³•ï¼ˆåŸå‹é“¾ä¸Šçš„å¯¹è±¡å…·æœ‰è¯¥æ–¹æ³•ä¹Ÿå¯ï¼‰ã€‚\nğŸ“ƒ Example\nclass RangeIterator { constructor(start, stop) { this.value = start; this.stop = stop; }; [Symbol.iterator]() { return this; }; next() { const value = this.value; if (value \u0026lt; this.stop) { this.value++; return {done: false, value: value}; } return {done: true, value: undefined}; }; } function range(start, stop) { return new RangeIterator(start, stop); } for (const value of range(0, 3)) { console.log(value); // 0, 1, 2 } ğŸ“ Note ä¸Šé¢ä»£ç æ˜¯ä¸€ä¸ªç±»éƒ¨ç½² iterator æ¥å£çš„å†™æ³•ã€‚ Symbol.iterator å±æ€§å¯¹åº”ä¸€ä¸ªå‡½æ•°ï¼Œæ‰§è¡Œåè¿”å›å½“å‰å¯¹è±¡çš„éå†å™¨å¯¹è±¡ã€‚\nä¸‹é¢æ˜¯é€šè¿‡éå†å™¨å®ç°æŒ‡é’ˆç»“æ„çš„ä¾‹å­ã€‚\nğŸ“ƒ Example\nObj.prototype[Symbol.iterator] = function() { const iterator = {next: next}; let current = this; function next() { if (current) { const value = current.value; current = current.next; return { done: false, value: value }; } else { return { done: true }; } } return iterator; } const one = new Obj(1); const two = new Obj(2); const three = new Obj(3); one.next = two; two.next = three; for (const i of one){ console.log(i); // 1, 2, 3 } ä¸Šé¢ä»£ç é¦–å…ˆåœ¨æ„é€ å‡½æ•°çš„åŸå‹é“¾ä¸Šéƒ¨ç½² Symbol.iterator æ–¹æ³•ï¼Œè°ƒç”¨è¯¥æ–¹æ³•ä¼šè¿”å›éå†å™¨å¯¹è±¡ iterator ï¼Œè°ƒç”¨è¯¥å¯¹è±¡çš„ next æ–¹æ³•ï¼Œåœ¨è¿”å›ä¸€ä¸ªå€¼çš„åŒæ—¶ï¼Œè‡ªåŠ¨å°†å†…éƒ¨æŒ‡é’ˆç§»åˆ°ä¸‹ä¸€ä¸ªå®ä¾‹ã€‚\nä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¸ºå¯¹è±¡æ·»åŠ  Iterator æ¥å£çš„ä¾‹å­ã€‚\nğŸ“ƒ Example\nlet obj = { data: [\u0026#39;hello\u0026#39;, \u0026#39;world\u0026#39;], [Symbol.iterator]() { const self = this; // thisæŒ‡å‘obj console.log(\u0026#39;self:\u0026#39;, self); let index = 0; return { next() { if (index \u0026lt; self.data.length) { return { value: self.data[index++], done: false }; } else { return { value: undefined, done: true }; } } }; } }; for (const objElement of obj) { console.log(objElement) } å¯¹äºç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼ˆå­˜åœ¨æ•°å€¼é”®åå’Œ length å±æ€§ï¼‰ï¼Œéƒ¨ç½² Iterator æ¥å£ï¼Œæœ‰ä¸€ä¸ªç®€ä¾¿æ–¹æ³•ï¼Œå°±æ˜¯ Symbol.iterator æ–¹æ³•ç›´æ¥å¼•ç”¨æ•°ç»„çš„ Iterator æ¥å£ã€‚\nğŸ“ƒ Example NodeList.prototype[Symbol.iterator] = Array.prototype[Symbol.iterator]; // æˆ–è€… NodeList.prototype[Symbol.iterator] = [][Symbol.iterator]; [...document.querySelectorAll(\u0026#39;div\u0026#39;)] // å¯ä»¥æ‰§è¡Œäº† NodeList å¯¹è±¡æ˜¯ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæœ¬æ¥å°±å…·æœ‰éå†æ¥å£ï¼Œå¯ä»¥ç›´æ¥éå†ã€‚ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°†å®ƒçš„éå†æ¥å£æ”¹æˆæ•°ç»„çš„ Symbol.iterator å±æ€§ï¼Œå¯ä»¥çœ‹åˆ°æ²¡æœ‰ä»»ä½•å½±å“ã€‚\nä¸‹é¢æ˜¯å¦ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡è°ƒç”¨æ•°ç»„çš„ Symbol.iterator æ–¹æ³•çš„ä¾‹å­ã€‚\nğŸ“ƒ Example\nlet arrLikeObj = { 0: \u0026#39;a\u0026#39;, 1: \u0026#39;b\u0026#39;, 3: \u0026#39;c\u0026#39;, length: 3, [Symbol.iterator]: Array.prototype[Symbol.iterator] }; for (const item of arrLikeObj) { console.log(item); // \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, undefined } console.log(arrLikeObj[0]); // \u0026#39;a\u0026#39; æ³¨æ„ï¼Œ æ™®é€šå¯¹è±¡ï¼ˆæ²¡æœ‰ number-key ï¼‰ éƒ¨ç½²æ•°ç»„çš„ Symbol.iterator æ–¹æ³•ï¼Œå¹¶æ— æ•ˆæœã€‚\nlet obj = { a: \u0026#39;a\u0026#39;, b: \u0026#39;b\u0026#39;, c: \u0026#39;c\u0026#39;, length: 3, [Symbol.iterator]: Array.prototype[Symbol.iterator] }; for (let item of obj) { console.log(item); // undefined, undefined, undefined } å¦‚æœ Symbol.iterator æ–¹æ³•å¯¹åº”çš„ä¸æ˜¯éå†å™¨ç”Ÿæˆå‡½æ•°ï¼ˆå³ä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼‰ï¼Œè§£é‡Šå¼•æ“å°†ä¼šæŠ¥é”™ã€‚\nğŸ“ƒ Example\nvar obj = {}; obj[Symbol.iterator] = () =\u0026gt; 1; [...obj] // TypeError: [] is not a function ğŸ“ Note ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡ obj çš„ Symbol.iterator æ–¹æ³•å¯¹åº”çš„ä¸æ˜¯éå†å™¨ç”Ÿæˆå‡½æ•°ï¼Œå› æ­¤æŠ¥é”™ã€‚\næœ‰äº†éå†å™¨æ¥å£ï¼Œæ•°æ®ç»“æ„å°±å¯ä»¥ç”¨ for-of å¾ªç¯éå†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ while å¾ªç¯éå†ã€‚\nğŸ“ƒ Example\nconst $iterator = ITERABLE[Symbol.iterator](); let $result = $iterator.next(); while (!$result.done) { const x = $result.value; console.log(x); $result = $iterator.next(); } ğŸ“ Note ä¸Šé¢ä»£ç ä¸­ï¼ŒITERABLE ä»£è¡¨æŸç§å¯éå†çš„æ•°æ®ç»“æ„ï¼Œ$iterator æ˜¯å®ƒçš„éå†å™¨å¯¹è±¡ã€‚éå†å™¨å¯¹è±¡æ¯æ¬¡ç§»åŠ¨æŒ‡é’ˆï¼ˆ next æ–¹æ³•ï¼‰ï¼Œéƒ½æ£€æŸ¥ä¸€ä¸‹è¿”å›å€¼çš„ done å±æ€§ï¼Œå¦‚æœéå†è¿˜æ²¡ç»“æŸï¼Œå°±ç§»åŠ¨éå†å™¨å¯¹è±¡çš„æŒ‡é’ˆåˆ°ä¸‹ä¸€æ­¥ï¼ˆ next æ–¹æ³•ï¼‰ï¼Œä¸æ–­å¾ªç¯ã€‚\nåº”ç”¨ æœ‰ä¸€äº›åœºåˆä¼šé»˜è®¤è°ƒç”¨ Iterator æ¥å£ï¼ˆå³ Symbol.iterator æ–¹æ³•ï¼‰ï¼Œé™¤äº†ä¸‹æ–‡ä¼šä»‹ç»çš„ for-of å¾ªç¯ï¼Œè¿˜æœ‰å‡ ä¸ªåˆ«çš„åœºåˆã€‚\nè§£æ„èµ‹å€¼\nå¯¹æ•°ç»„å’Œ Set ç»“æ„è¿›è¡Œè§£æ„èµ‹å€¼æ—¶ï¼Œä¼šé»˜è®¤è°ƒç”¨ Symbol.iterator æ–¹æ³•ã€‚\nlet set = new Set().add(\u0026#39;a\u0026#39;).add(\u0026#39;b\u0026#39;).add(\u0026#39;c\u0026#39;); let [x,y] = set; // x=\u0026#39;a\u0026#39;; y=\u0026#39;b\u0026#39; let [first, ...rest] = set; // first=\u0026#39;a\u0026#39;; rest=[\u0026#39;b\u0026#39;,\u0026#39;c\u0026#39;]; æ‰©å±•è¿ç®—ç¬¦\næ‰©å±•è¿ç®—ç¬¦ï¼ˆ\u0026hellip;ï¼‰ä¹Ÿä¼šè°ƒç”¨é»˜è®¤çš„ Iterator æ¥å£ã€‚\n// ä¾‹ä¸€ var str = \u0026#39;hello\u0026#39;; [...str] // [\u0026#39;h\u0026#39;,\u0026#39;e\u0026#39;,\u0026#39;l\u0026#39;,\u0026#39;l\u0026#39;,\u0026#39;o\u0026#39;] // ä¾‹äºŒ let arr = [\u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;]; [\u0026#39;a\u0026#39;, ...arr, \u0026#39;d\u0026#39;] // [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;] ä¸Šé¢ä»£ç çš„æ‰©å±•è¿ç®—ç¬¦å†…éƒ¨å°±è°ƒç”¨ iterator æ¥å£ã€‚\nå®é™…ä¸Šï¼Œè¿™æä¾›äº†ä¸€ç§ç®€ä¾¿æœºåˆ¶ï¼Œå¯ä»¥å°†ä»»ä½•éƒ¨ç½²äº† iterator æ¥å£çš„æ•°æ®ç»“æ„ï¼Œè½¬ä¸ºæ•°ç»„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦æŸä¸ªæ•°æ®ç»“æ„éƒ¨ç½²äº† iterator æ¥å£ï¼Œå°±å¯ä»¥å¯¹å®ƒä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼Œå°†å…¶è½¬ä¸ºæ•°ç»„ã€‚\nlet arr = [...iterable]; yield*\nyield* åé¢è·Ÿçš„æ˜¯ä¸€ä¸ªå¯éå†çš„ç»“æ„ï¼Œå®ƒä¼šè°ƒç”¨è¯¥ç»“æ„çš„éå†å™¨æ¥å£ã€‚\nlet generator = function* () { yield 1; yield* [2,3,4]; yield 5; }; const iterator = generator(); iterator.next() // { value: 1, done: false } iterator.next() // { value: 2, done: false } iterator.next() // { value: 3, done: false } iterator.next() // { value: 4, done: false } iterator.next() // { value: 5, done: false } iterator.next() // { value: undefined, done: true } å…¶ä»–åœºåˆ\nç”±äºæ•°ç»„çš„éå†ä¼šè°ƒç”¨éå†å™¨æ¥å£ï¼Œæ‰€ä»¥ä»»ä½•æ¥å—æ•°ç»„ä½œä¸ºå‚æ•°çš„åœºåˆï¼Œå…¶å®éƒ½è°ƒç”¨äº†éå†å™¨æ¥å£ã€‚ä¸‹é¢æ˜¯ä¸€äº›ä¾‹å­ï¼š\nfor-of\nArray.from()\nMap(), Set(), WeakMap(), WeakSet()\nï¼ˆe.g.:new Map([['a',1],['b',2]])ï¼‰\nPromise.all()\nPromise.race()\nå­—ç¬¦ä¸² å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œä¹ŸåŸç”Ÿå…·æœ‰ iterator æ¥å£ã€‚\nğŸ“ƒ Example\nvar someString = \u0026#34;hi\u0026#34;; typeof someString[Symbol.iterator] // \u0026#34;function\u0026#34; var iterator = someString[Symbol.iterator](); iterator.next() // { value: \u0026#34;h\u0026#34;, done: false } iterator.next() // { value: \u0026#34;i\u0026#34;, done: false } iterator.next() // { value: undefined, done: true } ä¸Šé¢ä»£ç ä¸­ï¼Œè°ƒç”¨ Symbol.iterator æ–¹æ³•è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œåœ¨è¿™ä¸ªéå†å™¨ä¸Šå¯ä»¥è°ƒç”¨ next æ–¹æ³•ï¼Œå®ç°å¯¹äºå­—ç¬¦ä¸²çš„éå†ã€‚\nå¯ä»¥è¦†ç›–åŸç”Ÿçš„ Symbol.iterator æ–¹æ³•ï¼Œè¾¾åˆ°ä¿®æ”¹éå†å™¨è¡Œä¸ºçš„ç›®çš„ã€‚\nğŸ“ƒ Example\nconst str = String(\u0026#34;hi\u0026#34;); [...str] // [\u0026#34;h\u0026#34;, \u0026#34;i\u0026#34;] str[Symbol.iterator] = function() { return { next: function() { if (this._first) { this._first = false; return { value: \u0026#34;bye\u0026#34;, done: false }; } else { return { done: true }; } }, _first: true }; }; [...str] // [\u0026#34;bye\u0026#34;] str // \u0026#34;hi\u0026#34; Yield Symbol.iterator() æ–¹æ³•çš„æœ€ç®€å•å®ç°ï¼Œè¿˜æ˜¯ä½¿ç”¨ä¸‹ä¸€ç« è¦ä»‹ç»çš„ Generator å‡½æ•°ã€‚\nlet myIterable = { [Symbol.iterator]: function* () { yield 1; yield 2; yield 3; } }; [...myIterable] // [1, 2, 3] // æˆ–è€…é‡‡ç”¨ä¸‹é¢çš„ç®€æ´å†™æ³• let obj = { * [Symbol.iterator]() { yield \u0026#39;hello\u0026#39;; yield \u0026#39;world\u0026#39;; } }; // yield* æ”¯æŒå¯éå†ç»“æ„ let obj = { * [Symbol.iterator]() { yield* [\u0026#39;hello\u0026#39;,\u0026#39;world\u0026#39;]; } }; for (let x of obj) { console.log(x); } // \u0026#39;hello\u0026#39; \u0026#39;world\u0026#39; ä¸Šé¢ä»£ç ä¸­ï¼ŒSymbol.iterator() æ–¹æ³•å‡ ä¹ä¸ç”¨éƒ¨ç½²ä»»ä½•ä»£ç ï¼Œåªè¦ç”¨ yield å‘½ä»¤ç»™å‡ºæ¯ä¸€æ­¥çš„è¿”å›å€¼å³å¯ã€‚\nreturn() throw() éå†å™¨å¯¹è±¡é™¤äº†å…·æœ‰ next() æ–¹æ³•ï¼Œè¿˜å¯ä»¥å…·æœ‰ return() æ–¹æ³•å’Œ throw() æ–¹æ³•ã€‚å¦‚æœä½ è‡ªå·±å†™éå†å™¨å¯¹è±¡ç”Ÿæˆå‡½æ•°ï¼Œé‚£ä¹ˆnext()æ–¹æ³•æ˜¯å¿…é¡»éƒ¨ç½²çš„ï¼Œreturn() æ–¹æ³•å’Œ throw() æ–¹æ³•æ˜¯å¦éƒ¨ç½²æ˜¯å¯é€‰çš„ã€‚\nreturn() æ–¹æ³•çš„ä½¿ç”¨åœºåˆæ˜¯ï¼Œå¦‚æœ for-of å¾ªç¯æå‰é€€å‡ºï¼ˆé€šå¸¸æ˜¯å› ä¸º å‡ºé”™ ï¼Œæˆ–è€…æœ‰ break è¯­å¥ï¼‰ï¼Œå°±ä¼šè°ƒç”¨ return() æ–¹æ³•ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡åœ¨å®Œæˆéå†å‰ï¼Œéœ€è¦ æ¸…ç†æˆ–é‡Šæ”¾èµ„æº ï¼Œå°±å¯ä»¥éƒ¨ç½² return() æ–¹æ³•ã€‚\nfunction readLinesSync(file) { return { [Symbol.iterator]() { return { next() { return { done: false }; }, return() { file.close(); return { done: true }; } }; } }; } ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•° readLinesSync æ¥å—ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œå…¶ä¸­é™¤äº† next() æ–¹æ³•ï¼Œè¿˜éƒ¨ç½²äº† return() æ–¹æ³•ã€‚ä¸‹é¢çš„ä¸¤ç§æƒ…å†µï¼Œéƒ½ä¼šè§¦å‘æ‰§è¡Œ return() æ–¹æ³•ã€‚\nğŸ“ƒ Example\n// æƒ…å†µä¸€ for (let line of readLinesSync(fileName)) { console.log(line); break; } // æƒ…å†µäºŒ for (let line of readLinesSync(fileName)) { console.log(line); throw new Error(); } âš ï¸ Caution æ³¨æ„ï¼Œreturn() æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™æ˜¯ Generator è¯­æ³•å†³å®šçš„ã€‚\nthrow() æ–¹æ³•ä¸»è¦æ˜¯é…åˆ Generator å‡½æ•°ä½¿ç”¨ï¼Œä¸€èˆ¬çš„éå†å™¨å¯¹è±¡ç”¨ä¸åˆ°è¿™ä¸ªæ–¹æ³•ã€‚\nfor-of ES6 å€Ÿé‰´ C++ã€Javaã€C# å’Œ Python è¯­è¨€ï¼Œå¼•å…¥äº† for-of å¾ªç¯ï¼Œä½œä¸ºéå†æ‰€æœ‰æ•°æ®ç»“æ„çš„ç»Ÿä¸€çš„æ–¹æ³•ã€‚\nä¸€ä¸ªæ•°æ®ç»“æ„åªè¦éƒ¨ç½²äº† Symbol.iterator å±æ€§ï¼Œå°±è¢«è§†ä¸ºå…·æœ‰ iterator æ¥å£ï¼Œå°±å¯ä»¥ç”¨ for-of å¾ªç¯éå†å®ƒçš„æˆå‘˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ for-of å¾ªç¯å†…éƒ¨è°ƒç”¨çš„æ˜¯æ•°æ®ç»“æ„çš„ Symbol.iterator æ–¹æ³•ã€‚\nfor-of å¾ªç¯å¯ä»¥ä½¿ç”¨çš„èŒƒå›´åŒ…æ‹¬æ•°ç»„ã€Set å’Œ Map ç»“æ„ã€æŸäº›ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼ˆæ¯”å¦‚ arguments å¯¹è±¡ã€DOM NodeList å¯¹è±¡ï¼‰ã€åæ–‡çš„ Generator å¯¹è±¡ï¼Œä»¥åŠå­—ç¬¦ä¸²ã€‚\næ•°ç»„ æ•°ç»„åŸç”Ÿå…·å¤‡ iterator æ¥å£ï¼ˆå³é»˜è®¤éƒ¨ç½²äº† Symbol.iterator å±æ€§ï¼‰ï¼Œ for-of å¾ªç¯æœ¬è´¨ä¸Šå°±æ˜¯è°ƒç”¨è¿™ä¸ªæ¥å£äº§ç”Ÿçš„éå†å™¨ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç è¯æ˜ã€‚\nğŸ“ƒ Example\nconst arr = [\u0026#39;red\u0026#39;, \u0026#39;green\u0026#39;, \u0026#39;blue\u0026#39;]; for(let v of arr) { console.log(v); // red green blue } const obj = {}; obj[Symbol.iterator] = arr[Symbol.iterator].bind(arr); for(let v of obj) { console.log(v); // red green blue } ğŸ“ Note ä¸Šé¢ä»£ç ä¸­ï¼Œç©ºå¯¹è±¡ obj éƒ¨ç½²äº†æ•°ç»„ arr çš„ Symbol.iterator å±æ€§ï¼Œç»“æœ obj çš„ for...of å¾ªç¯ï¼Œäº§ç”Ÿäº†ä¸ arr å®Œå…¨ä¸€æ ·çš„ç»“æœã€‚\nfor-of å¾ªç¯å¯ä»¥ä»£æ›¿æ•°ç»„å®ä¾‹çš„ forEach æ–¹æ³•ã€‚\nconst arr = [\u0026#39;red\u0026#39;, \u0026#39;green\u0026#39;, \u0026#39;blue\u0026#39;]; arr.forEach(function (element, index) { console.log(element); // red green blue console.log(index); // 0 1 2 }); JavaScript åŸæœ‰çš„ for-in å¾ªç¯ï¼Œåªèƒ½è·å¾—å¯¹è±¡çš„ é”®åkey ï¼Œä¸èƒ½ç›´æ¥è·å–é”®å€¼valueã€‚ES6 æä¾› for-of å¾ªç¯ï¼Œå…è®¸éå†è·å¾—é”®å€¼ã€‚\nğŸ“ƒ Example\nconst arr = [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;]; for (let a in arr) { console.log(a); // 0 1 2 3 } for (let a of arr) { console.log(a); // a b c d } ğŸ“ Note ä¸Šé¢ä»£ç è¡¨æ˜ï¼Œ for-in å¾ªç¯è¯»å– é”®åkey ï¼Œ for-of å¾ªç¯è¯»å– é”®å€¼value ã€‚å¦‚æœè¦é€šè¿‡ for-of å¾ªç¯ï¼Œè·å–æ•°ç»„çš„ç´¢å¼•ï¼Œå¯ä»¥å€ŸåŠ©æ•°ç»„å®ä¾‹çš„ entries æ–¹æ³•å’Œ keys æ–¹æ³•ã€‚\nfor-of å¾ªç¯è°ƒç”¨éå†å™¨æ¥å£ï¼Œæ•°ç»„çš„éå†å™¨æ¥å£åªè¿”å›å…·æœ‰æ•°å­—ç´¢å¼•çš„å±æ€§ã€‚è¿™ä¸€ç‚¹è·Ÿ for-in å¾ªç¯ä¹Ÿä¸ä¸€æ ·ã€‚\nğŸ“ƒ Example\nconst arr = [3, 5, 7]; arr.foo = \u0026#39;bar\u0026#39;; for (const i in arr) { console.log(i); // \u0026#34;0\u0026#34;, \u0026#34;1\u0026#34;, \u0026#34;2\u0026#34;, \u0026#34;foo\u0026#34; } for (const i of arr) { console.log(i); // \u0026#34;3\u0026#34;, \u0026#34;5\u0026#34;, \u0026#34;7\u0026#34; } ä¸Šé¢ä»£ç ä¸­ï¼Œ for-of å¾ªç¯ä¸ä¼šè¿”å›æ•°ç»„ arr çš„ foo å±æ€§ã€‚\nSet å’Œ Map ç»“æ„ Set å’Œ Map ç»“æ„ä¹ŸåŸç”Ÿå…·æœ‰ iterator æ¥å£ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ for-of å¾ªç¯ã€‚\nğŸ“ƒ Example\nconst engines = new Set([\u0026#34;Gecko\u0026#34;, \u0026#34;Trident\u0026#34;, \u0026#34;Webkit\u0026#34;, \u0026#34;Webkit\u0026#34;]); for (const e of engines) { console.log(e); } // \u0026#39;Gecko\u0026#39;, \u0026#39;Trident\u0026#39;, \u0026#39;Webkit\u0026#39; const es6 = new Map(); es6.set(\u0026#34;edition\u0026#34;, 6); es6.set(\u0026#34;committee\u0026#34;, \u0026#34;TC39\u0026#34;); es6.set(\u0026#34;standard\u0026#34;, \u0026#34;ECMA-262\u0026#34;); for (const [name, value] of es6) { console.log(name + \u0026#34;: \u0026#34; + value); } // edition: 6 // committee: TC39 // standard: ECMA-262 ğŸ“ Note ä¸Šé¢ä»£ç æ¼”ç¤ºäº†å¦‚ä½•éå† Set ç»“æ„å’Œ Map ç»“æ„ã€‚\nå€¼å¾—æ³¨æ„çš„åœ°æ–¹æœ‰ä¸¤ä¸ªï¼Œé¦–å…ˆï¼Œéå†çš„é¡ºåºæ˜¯æŒ‰ç…§å„ä¸ªæˆå‘˜è¢« æ·»åŠ  è¿›æ•°æ®ç»“æ„çš„ é¡ºåº ã€‚å…¶æ¬¡ï¼ŒSet ç»“æ„éå†æ—¶ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ª å€¼valueï¼Œè€Œ Map ç»“æ„éå†æ—¶ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ª æ•°ç»„arrayï¼Œè¯¥æ•°ç»„çš„ä¸¤ä¸ªæˆå‘˜åˆ†åˆ«ä¸ºå½“å‰ Map æˆå‘˜çš„é”®åå’Œé”®å€¼ã€‚\nlet map = new Map().set(\u0026#39;a\u0026#39;, 1).set(\u0026#39;b\u0026#39;, 2); for (let pair of map) { console.log(pair); } // [\u0026#39;a\u0026#39;, 1] // [\u0026#39;b\u0026#39;, 2] for (let [key, value] of map) { console.log(key + \u0026#39; : \u0026#39; + value); } // a : 1 // b : 2 æœ‰äº›æ•°æ®ç»“æ„æ˜¯åœ¨ç°æœ‰æ•°æ®ç»“æ„çš„åŸºç¡€ä¸Šï¼Œè®¡ç®—ç”Ÿæˆçš„ã€‚æ¯”å¦‚ï¼ŒES6 çš„æ•°ç»„Arrayã€å¯¹è±¡Objectã€Setã€Map éƒ½éƒ¨ç½²äº†ä»¥ä¸‹ä¸‰ä¸ªæ–¹æ³•ï¼Œè°ƒç”¨åéƒ½è¿”å›éå†å™¨å¯¹è±¡ï¼š entries()ï¼š è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”¨æ¥éå† [é”®å, é”®å€¼] ç»„æˆçš„æ•°ç»„ã€‚å¯¹äºæ•°ç»„ï¼Œé”®åå°±æ˜¯ ç´¢å¼•å€¼index ï¼›å¯¹äº Setï¼Œé”®åä¸é”®å€¼ç›¸åŒã€‚Map ç»“æ„çš„ iterator æ¥å£ï¼Œé»˜è®¤å°±æ˜¯è°ƒç”¨ entries æ–¹æ³• keys()ï¼š è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”¨æ¥éå†æ‰€æœ‰çš„ é”®åkey values()ï¼š è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”¨æ¥éå†æ‰€æœ‰çš„ é”®å€¼value è¿™ä¸‰ä¸ªæ–¹æ³•è°ƒç”¨åç”Ÿæˆçš„éå†å™¨å¯¹è±¡ï¼Œæ‰€éå†çš„éƒ½æ˜¯è®¡ç®—ç”Ÿæˆçš„æ•°æ®ç»“æ„ã€‚\nlet arr = [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;]; /* arr.keys() */ for (let key of arr.keys()) { console.log(key); } // 0 1 2 /* arr.values() */ for (let value of arr.values()) { console.log(value); } // a b c /* arr.entries() */ for (let entry of arr.entries()) { console.log(entry); } // [0, \u0026#39;a\u0026#39;] [1, \u0026#39;b\u0026#39;] [2, \u0026#39;c\u0026#39;] ç±»æ•°ç»„ ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡åŒ…æ‹¬å¥½å‡ ç±»ã€‚ä¸‹é¢æ˜¯ for-of å¾ªç¯ç”¨äºå­—ç¬¦ä¸²ã€DOM NodeList å¯¹è±¡ã€arguments å¯¹è±¡çš„ä¾‹å­ã€‚\n// å­—ç¬¦ä¸² let str = \u0026#34;hello\u0026#34;; for (let s of str) { console.log(s); // h e l l o } // DOM NodeListå¯¹è±¡ let paras = document.querySelectorAll(\u0026#34;p\u0026#34;); for (let p of paras) { p.classList.add(\u0026#34;test\u0026#34;); } // argumentså¯¹è±¡ function printArgs() { for (let x of arguments) { console.log(x); } } printArgs(\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;); // \u0026#39;a\u0026#39; // \u0026#39;b\u0026#39; å¯¹äºå­—ç¬¦ä¸²æ¥è¯´ï¼Œ for-of å¾ªç¯è¿˜æœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯èƒ½æ­£ç¡®è¯†åˆ« 32 ä½ UTF-16 å­—ç¬¦ã€‚\nfor (let x of \u0026#39;a\\uD83D\\uDC0A\u0026#39;) { console.log(x); } // \u0026#39;a\u0026#39; // \u0026#39;\\uD83D\\uDC0A\u0026#39; å¹¶ä¸æ˜¯æ‰€æœ‰ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡éƒ½å…·æœ‰ iterator æ¥å£ï¼Œä¸€ä¸ªç®€ä¾¿çš„è§£å†³æ–¹æ³•ï¼Œå°±æ˜¯ä½¿ç”¨ Array.from æ–¹æ³•å°†å…¶è½¬ä¸ºæ•°ç»„ã€‚\nlet arrayLike = { length: 2, 0: \u0026#39;a\u0026#39;, 1: \u0026#39;b\u0026#39; }; // æŠ¥é”™ for (let x of arrayLike) { console.log(x); } // æ­£ç¡® for (let x of Array.from(arrayLike)) { console.log(x); } ğŸ“ Note ç±»æ•°ç»„å¯ä»¥ç›´æ¥å¥—ç”¨æ•°ç»„çš„éå†å™¨ [][Symbol.iterator]\n:link: Href NodeList ä½¿ç”¨æ•°ç»„éå†æ–¹æ³•\nå¯¹è±¡ å¯¹äºæ™®é€šçš„å¯¹è±¡ï¼Œ for-of ç»“æ„ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œä¼šæŠ¥é”™ï¼Œå¿…é¡»éƒ¨ç½²äº† iterator æ¥å£åæ‰èƒ½ä½¿ç”¨ã€‚ä½†æ˜¯ï¼Œè¿™æ ·æƒ…å†µä¸‹ï¼Œ for-in å¾ªç¯ä¾ç„¶å¯ä»¥ç”¨æ¥éå†é”®åã€‚\nğŸ“ƒ Example\nconst es6 = { edition: 6, committee: \u0026#34;TC39\u0026#34;, standard: \u0026#34;ECMA-262\u0026#34; }; for (let e in es6) { console.log(e); } // edition committee standard for (let e of es6) { console.log(e); } // TypeError: es6[Symbol.iterator] is not a function ğŸ“ Note ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¯¹äºæ™®é€šçš„å¯¹è±¡ï¼Œ for-in å¾ªç¯å¯ä»¥éå†é”®åï¼Œ for-of å¾ªç¯ä¼šæŠ¥é”™ã€‚\nä¸ºäº†è®¿é—® é”®å€¼key ï¼Œå¯ä»¥ç”¨è¿™äº›æ–¹æ³•ï¼š\nç›´æ¥é€šè¿‡æ–¹æ‹¬å·è¿ç®—ç¬¦ [] ç›´æ¥è®¿é—®\nğŸ“ƒ Example\nconst obj = [\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;]; for (const key in obj) { console.log(key + \u0026#39;: \u0026#39; + obj[key]); } // 0: foo 1: bar :link: Href for-in() ç¼ºé™·\nä½¿ç”¨ Object.keys æ–¹æ³•å°†å¯¹è±¡çš„é”®åç”Ÿæˆä¸€ä¸ªæ•°ç»„ï¼Œç„¶åéå†è¿™ä¸ªæ•°ç»„ã€‚\nğŸ“ƒ Example\nconst obj = [\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;]; for (const key of Object.keys(obj)) { console.log(key + \u0026#39;: \u0026#39; + obj[key]); } Object.keys(obj); // [ \u0026#39;0\u0026#39;, \u0026#39;1\u0026#39; ] ğŸ“ Note Object.keys() æ–¹æ³•è¿”å›å¯¹è±¡æ‰€æœ‰å¯éå†çš„é”®å\nå¦ä¸€ä¸ªæ–¹æ³•æ˜¯ä½¿ç”¨ Generator å‡½æ•°å°†å¯¹è±¡é‡æ–°åŒ…è£…ä¸€ä¸‹ã€‚\nğŸ“ƒ Example\nconst obj = [\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;]; function* wrapper(obj) { for (let key of Object.keys(obj)) { yield [key, obj[key]]; } } for (let [key, value] of wrapper(obj)) { console.log(key, \u0026#39;-\u0026gt;\u0026#39;, value); } // 0 -\u0026gt; foo 1 -\u0026gt; bar ä¸å…¶ä»–éå†è¯­æ³•çš„æ¯”è¾ƒ ä»¥æ•°ç»„ä¸ºä¾‹ï¼ŒJavaScript æä¾›å¤šç§éå†è¯­æ³•ã€‚æœ€åŸå§‹çš„å†™æ³•å°±æ˜¯ for å¾ªç¯ã€‚\nlet arr = [\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;]; for (let index = 0; index \u0026lt; arr.length; index++) { console.log(arr[index]); } // foo bar è¿™ç§å†™æ³•æ¯”è¾ƒéº»çƒ¦ï¼Œå› æ­¤æ•°ç»„æä¾›å†…ç½®çš„ forEach æ–¹æ³•ã€‚\narr.forEach((value) =\u0026gt; { console.log(value); }); // foo bar è¿™ç§å†™æ³•çš„é—®é¢˜åœ¨äºï¼Œæ— æ³•ä¸­é€”è·³å‡º forEach å¾ªç¯ï¼Œ break å‘½ä»¤æˆ– return å‘½ä»¤éƒ½ä¸èƒ½å¥æ•ˆã€‚\nfor-in å¾ªç¯å¯ä»¥éå†æ•°ç»„çš„ é”®åkey ã€‚\nfor (const index in arr) { console.log(arr[index]); } for-in å¾ªç¯æœ‰å‡ ä¸ªç¼ºç‚¹ã€‚\næ•°ç»„çš„é”®åæ˜¯ æ•°å­— ï¼Œä½†æ˜¯ for-in å¾ªç¯æ˜¯ä»¥ å­—ç¬¦ä¸²string ä½œä¸ºé”®åã€‚\nP.S: JS ä¸­å­—ç¬¦ä¸²çš„æ•ˆç‡éå¸¸ä½\nfor-in å¾ªç¯ä¸ä»…éå†æ•°å­—é”®åï¼Œè¿˜ä¼šéå†æ‰‹åŠ¨æ·»åŠ çš„å…¶ä»–é”®ï¼Œç”šè‡³åŒ…æ‹¬ åŸå‹é“¾prototype ä¸Šçš„é”®\næŸäº›æƒ…å†µä¸‹ï¼Œ for-in å¾ªç¯ä¼šä»¥ ä»»æ„é¡ºåº éå†é”®åã€‚\næ€»ä¹‹ï¼Œ for-in å¾ªç¯ä¸»è¦æ˜¯ä¸ºéå†å¯¹è±¡è€Œè®¾è®¡çš„ï¼Œä¸é€‚ç”¨äºéå†æ•°ç»„ã€‚\nfor-of å¾ªç¯ç›¸æ¯”ä¸Šé¢å‡ ç§åšæ³•ï¼Œæœ‰ä¸€äº›æ˜¾è‘—çš„ä¼˜ç‚¹ã€‚\nlet arr = [\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;]; for (const value of arr) { console.log(value); } æœ‰ç€åŒ for-in ä¸€æ ·çš„ç®€æ´è¯­æ³•ï¼Œä½†æ˜¯æ²¡æœ‰ for-in é‚£äº›ç¼ºç‚¹ ä¸åŒäº forEach æ–¹æ³•ï¼Œå®ƒå¯ä»¥ä¸ break ã€ continue å’Œ return é…åˆä½¿ç”¨ æä¾›äº†éå†æ‰€æœ‰æ•°æ®ç»“æ„çš„ç»Ÿä¸€æ“ä½œæ¥å£ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ break è¯­å¥ï¼Œè·³å‡º for-of å¾ªç¯çš„ä¾‹å­ã€‚\nğŸ“ƒ Example\nconst fibonacci = [1, 2]; for (let i = 2; i \u0026lt; 100; i++) { fibonacci.push( fibonacci[i - 2] + fibonacci[i - 1] ); } // console.log(fibonacci) for (const n of fibonacci) { if (n \u0026gt; 1000) break; console.log(n); } ä¸Šé¢çš„ä¾‹å­ï¼Œä¼šè¾“å‡ºæ–æ³¢çº³å¥‘æ•°åˆ—å°äºç­‰äº 1000 çš„é¡¹ã€‚å¦‚æœå½“å‰é¡¹å¤§äº 1000 ï¼Œå°±ä¼šä½¿ç”¨ break è¯­å¥è·³å‡º for-of å¾ªç¯ã€‚\nfor-of ä¸ for-inåŒºåˆ« for-inéå†çš„æ˜¯æ•°ç»„çš„ é”®åkeyï¼ˆå³ç´¢å¼•ï¼‰ï¼Œ\nè€Œ for-of éå†çš„æ˜¯æ•°ç»„å…ƒç´  é”®å€¼valueã€‚\nArray.prototype.method = function () { console.log(this) }; const foo = [1, 2, 4]; foo.name = \u0026#34;bar\u0026#34;; for (const index in foo)console.log(foo[index]); // 0, 1, 2, bar, prototype.method for (const value of foo)console.log(value); // 1, 2, 4 é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€äº›ç»†èŠ‚:\nfor-in çš„ä¸€äº›ç¼ºé™·ï¼š ç´¢å¼•æ˜¯ å­—ç¬¦ä¸²å‹ çš„æ•°å­— ï¼Œå› è€Œä¸èƒ½ç›´æ¥è¿›è¡Œå‡ ä½•è¿ç®— éå†é¡ºåºå¯èƒ½ä¸æ˜¯å®é™…çš„å†…éƒ¨é¡ºåº for-in ä¼šéå†æ•°ç»„æ‰€æœ‰çš„å¯æšä¸¾å±æ€§ï¼ŒåŒ…æ‹¬åŸå‹ã€‚ä¾‹å¦‚çš„åŸå‹æ–¹æ³• method å’Œ name å±æ€§ æ•…è€Œä¸€èˆ¬ç”¨ for-in éå† å¯¹è±¡Object è€Œä¸ç”¨æ¥éå† æ•°ç»„Array ã€‚\nè¿™ä¹Ÿå°±æ˜¯ for-of å­˜åœ¨çš„æ„ä¹‰äº†ï¼Œfor-of ä¸éå† method å’Œ nameï¼Œé€‚åˆç”¨æ¥éå† æ•°ç»„array ã€‚\né‚£ for-of æœ‰ç¼ºç‚¹å—? å½“ç„¶æœ‰äº†ï¼š\nfor-of ä¸æ”¯æŒ æ™®é€šå¯¹è±¡ ï¼Œæƒ³éå†å¯¹è±¡çš„å±æ€§ï¼Œå¯ä»¥ç”¨ for-in å¾ªç¯ï¼Œæˆ–æ·»åŠ  éå†å™¨iterator [Symbol.iterator] æˆ–å†…å»ºçš„ Object.keys() æ–¹æ³•ï¼š\nObject.keys(myObject) åˆ›å»ºå¯¹è±¡çš„é”®åkey ç»„æˆçš„æ•°ç»„ï¼Œä¸åŒ…æ‹¬åŸå‹æ–¹æ³•å’Œå±æ€§ã€‚\nSet \u0026amp; Map Set ES6 æä¾›äº†æ–°çš„æ•°æ®ç»“æ„ Set ã€‚å®ƒç±»ä¼¼äº æ•°ç»„array ï¼Œä½†æ˜¯æˆå‘˜çš„å€¼éƒ½æ˜¯ å”¯ä¸€ çš„ï¼Œæ²¡æœ‰é‡å¤çš„å€¼ã€‚\nSet() æœ¬èº«æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆ Set æ•°æ®ç»“æ„ï¼Œæ¥å—ä¸€ä¸ª æ•°ç»„arrayï¼ˆæˆ–è€…å…·æœ‰ iterable æ¥å£çš„å…¶ä»–æ•°æ®ç»“æ„ï¼‰ä½œä¸ºå‚æ•°ï¼Œç”¨æ¥åˆå§‹åŒ–ã€‚\nğŸ“ƒ Example\nconst set = new Set(); [2, 3, 5, 4, 5, 2, 2].forEach(x =\u0026gt; set.add(x)); console.log(set) // Set(4) { 2, 3, 5, 4 } for (const i in set) { console.log(i); } // ç©º for (const i of set) { console.log(i); } // 2 3 5 4 ğŸ“ Note ä¸Šé¢ä»£ç é€šè¿‡ add() æ–¹æ³•å‘ Set ç»“æ„åŠ å…¥æˆå‘˜ï¼Œç»“æœè¡¨æ˜ Set ç»“æ„ä¸ä¼šæ·»åŠ é‡å¤çš„å€¼ã€‚\nğŸ“ƒ Example\n// ä¾‹ä¸€ const set = new Set([1, 2, 3, 4, 4]); [...set] // [1, 2, 3, 4] // ä¾‹äºŒ const items = new Set([1, 2, 3, 4, 5, 5, 5, 5]); items.size // 5 // ä¾‹ä¸‰ const set = new Set(document.querySelectorAll(\u0026#39;div\u0026#39;)); set.size // 56 // ç±»ä¼¼äº const set = new Set(); document .querySelectorAll(\u0026#39;div\u0026#39;) .forEach(div =\u0026gt; set.add(div)); set.size // 56 ğŸ“ Note ä¸Šé¢ä»£ç ä¸­ï¼Œä¾‹ä¸€å’Œä¾‹äºŒéƒ½æ˜¯ Set å‡½æ•°æ¥å—æ•°ç»„ä½œä¸ºå‚æ•°ï¼Œä¾‹ä¸‰æ˜¯æ¥å—ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚\nä¸Šé¢ä»£ç ä¹Ÿå±•ç¤ºäº†ä¸€ç§å»é™¤æ•°ç»„é‡å¤æˆå‘˜çš„æ–¹æ³•ã€‚\nå¦ä¸€ç§åŠæ³•æ˜¯ç»„åˆ [Array.prototype.filter()](05 JavaScript#array-filter-es5) å’Œ [Array.prototype.indexOf()](05 JavaScript#array-index-of-es5)\nğŸ“ƒ Example\nconst arr = [1, 2, 3, 4, 4]; r = arr.filter( (item, index) =\u0026gt; arr.indexOf(item) === index ); console.log(r); // [ 1, 2, 3, 4 ] ğŸ“ƒ Example\n// å»é™¤æ•°ç»„çš„é‡å¤æˆå‘˜ [...new Set(array)] ğŸ“ Note ä¸Šé¢çš„æ–¹æ³•ä¹Ÿå¯ä»¥ç”¨äºï¼Œå»é™¤å­—ç¬¦ä¸²é‡Œé¢çš„é‡å¤å­—ç¬¦ã€‚\n[...new Set(\u0026#39;ababbc\u0026#39;)].join(\u0026#39;\u0026#39;) // \u0026#34;abc\u0026#34; å‘ Set åŠ å…¥å€¼çš„æ—¶å€™ï¼Œä¸ä¼šå‘ç”Ÿç±»å‹è½¬æ¢ï¼Œæ‰€ä»¥ 5 å’Œ \u0026quot;5\u0026quot; æ˜¯ä¸¤ä¸ªä¸åŒçš„å€¼ã€‚Set å†…éƒ¨åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ä¸åŒï¼Œä½¿ç”¨çš„ç®—æ³•å«åšâ€œSame-value-zero equalityâ€ï¼Œå®ƒç±»ä¼¼äºç²¾ç¡®ç›¸ç­‰è¿ç®—ç¬¦ === ï¼Œä¸»è¦çš„åŒºåˆ«æ˜¯å‘ Set åŠ å…¥å€¼æ—¶è®¤ä¸º NaN ç­‰äºè‡ªèº«ï¼Œè€Œç²¾ç¡®ç›¸ç­‰è¿ç®—ç¬¦è®¤ä¸º NaN ä¸ç­‰äºè‡ªèº«ã€‚\nğŸ“ƒ Example\nlet set = new Set(); let a = NaN; let b = NaN; set.add(a); set.add(b); set // Set {NaN} ğŸ“ Note ä¸Šé¢ä»£ç å‘ Set å®ä¾‹æ·»åŠ äº†ä¸¤æ¬¡ NaN ï¼Œä½†æ˜¯åªä¼šåŠ å…¥ä¸€ä¸ªã€‚è¿™è¡¨æ˜ï¼Œåœ¨ Set å†…éƒ¨ï¼Œä¸¤ä¸ª NaN æ˜¯ç›¸ç­‰çš„ã€‚\nå¦å¤–ï¼Œä¸¤ä¸ªå¯¹è±¡æ€»æ˜¯ ä¸ç›¸ç­‰ çš„ã€‚\nğŸ“ƒ Example\nlet set = new Set(); set.add({}); set.size // 1 set.add({}); set.size // 2 ğŸ“ Note ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œç”±äºä¸¤ä¸ªç©ºå¯¹è±¡ä¸ç›¸ç­‰ï¼ˆæŒ‡é’ˆpointer ä¸åŒï¼‰ï¼Œæ‰€ä»¥å®ƒä»¬è¢«è§†ä¸ºä¸¤ä¸ªå€¼ã€‚\nå±æ€§ Set ç»“æ„çš„å®ä¾‹æœ‰ä»¥ä¸‹å±æ€§ã€‚\nSet.prototype.constructorï¼šæ„é€ å‡½æ•°ï¼Œé»˜è®¤å°±æ˜¯ Set() Set.prototype.sizeï¼šè¿”å› Set å®ä¾‹çš„æˆå‘˜æ€»æ•° Set å®ä¾‹çš„æ–¹æ³•åˆ†ä¸ºä¸¤å¤§ç±»ï¼šæ“ä½œæ–¹æ³•ï¼ˆç”¨äºæ“ä½œæ•°æ®ï¼‰å’Œéå†æ–¹æ³•ï¼ˆç”¨äºéå†æˆå‘˜ï¼‰ã€‚\næ“ä½œ ä¸‹é¢å…ˆä»‹ç»å››ä¸ªæ“ä½œæ–¹æ³•ã€‚\nSet.prototype.add(value)ï¼šæ·»åŠ æŸä¸ªå€¼ï¼Œè¿”å› Set ç»“æ„æœ¬èº« Set.prototype.delete(value)ï¼šåˆ é™¤æŸä¸ªå€¼ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºåˆ é™¤æ˜¯å¦æˆåŠŸ Set.prototype.has(value)ï¼šè¿”å›ä¸€ä¸ª boolean ï¼Œè¡¨ç¤ºè¯¥å€¼æ˜¯å¦ä¸º Set çš„æˆå‘˜ Set.prototype.clear()ï¼šæ¸…é™¤æ‰€æœ‰æˆå‘˜ï¼Œæ²¡æœ‰è¿”å›å€¼ ä¸Šé¢è¿™äº›å±æ€§å’Œæ–¹æ³•çš„å®ä¾‹å¦‚ä¸‹ã€‚\nadd() delete() has() clear() let set = new Set(); set.add(1).add(2).add(2); // æ³¨æ„2è¢«åŠ å…¥äº†ä¸¤æ¬¡ console.log( set.size, // 2 set.has(1), // true set.has(2), // true set.has(3), // false set.delete(2), // true set.has(2), // false ); ğŸ“ƒ Example\nä¸‹é¢æ˜¯ä¸€ä¸ªå¯¹æ¯”ï¼Œçœ‹çœ‹åœ¨åˆ¤æ–­æ˜¯å¦åŒ…æ‹¬ä¸€ä¸ªé”®ä¸Šé¢ï¼ŒObject ç»“æ„å’Œ Set ç»“æ„çš„å†™æ³•ä¸åŒã€‚\nlet item = \u0026#39;foo\u0026#39;; // Object çš„å†™æ³• const obj = { [item]: \u0026#39;bar\u0026#39; }; if (obj[item]) { console.log(true); // true } // Setçš„å†™æ³• const set = new Set(item); set.add(item); if (set.has(item)) { console.log(true); // true } Array.from() æ–¹æ³•å¯ä»¥å°† Set ç»“æ„è½¬ä¸ºæ•°ç»„ã€‚\nlet arr = [12, 45, 97, 9797, 564, 134, 45642] let set = new Set(arr) // set.prototype[Symbol.iterator]=[][Symbol.iterator]; //NodeList.prototype[Symbol.iterator] = [][Symbol.iterator]; console.log( Array.from(set), // [ 12, 45, 97, 9797, 564, 134, 45642 ] [].slice.call(set), // [] // æ•°ç»„çš„@@iteratorå¯¹setæ— æ•ˆ [...set] // [ 12, 45, 97, 9797, 564, 134, 45642 ] // æœ‰æ•ˆï¼Œè°ƒç”¨äº†@@iterator ); ğŸ“ƒ Example\nè¿™å°±æä¾›äº†å»é™¤æ•°ç»„é‡å¤æˆå‘˜çš„å¦ä¸€ç§æ–¹æ³•ã€‚\nfunction dedupe(array) { return Array.from(new Set(array)); } dedupe([1, 1, 2, 3]) // [1, 2, 3] ğŸ“ Note ä¹Ÿå¯ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦... ã€‚\nlet dedupe = array =\u0026gt; [...new Set(array)]; dedupe([1, 1, 2, 3]) // [1, 2, 3] éå† Set ç»“æ„çš„å®ä¾‹æœ‰å››ä¸ªéå†æ–¹æ³•ï¼Œå¯ä»¥ç”¨äºéå†æˆå‘˜ã€‚\nSet.prototype.keys()ï¼šè¿”å›é”®åçš„éå†å™¨ Set.prototype.values()ï¼šè¿”å›é”®å€¼çš„éå†å™¨ Set.prototype.entries()ï¼šè¿”å›é”®å€¼å¯¹çš„éå†å™¨ Set.prototype.forEach()ï¼šä½¿ç”¨å›è°ƒå‡½æ•°éå†æ¯ä¸ªæˆå‘˜ éœ€è¦ç‰¹åˆ«æŒ‡å‡ºçš„æ˜¯ï¼ŒSet çš„éå†é¡ºåºå°±æ˜¯ æ’å…¥é¡ºåº ï¼ˆç±»ä¼¼ FIFOï¼‰ã€‚è¿™ä¸ªç‰¹æ€§æœ‰æ—¶éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚ä½¿ç”¨ Set ä¿å­˜ä¸€ä¸ªå›è°ƒå‡½æ•°åˆ—è¡¨ï¼Œè°ƒç”¨æ—¶å°±èƒ½ä¿è¯æŒ‰ç…§æ·»åŠ é¡ºåºè°ƒç”¨ã€‚\nSet. keys(), values(), entries(), forEach()\nkeys() values() entries() :link: Href Iterator.methods\nkeys(), values(), entries() æ–¹æ³•è¿”å›çš„éƒ½æ˜¯éå†å™¨å¯¹è±¡ - Iterator ã€‚ç”±äº Set ç»“æ„æ²¡æœ‰ é”®å ï¼Œåªæœ‰ é”®å€¼ ï¼ˆæˆ–è€…è¯´é”®åå’Œé”®å€¼æ˜¯åŒä¸€ä¸ªå€¼ï¼‰ï¼Œæ‰€ä»¥ keys æ–¹æ³•å’Œ values æ–¹æ³•çš„è¡Œä¸ºå®Œå…¨ä¸€è‡´ã€‚\nlet set = new Set().add(\u0026#39;red\u0026#39;).add(\u0026#39;green\u0026#39;).add(\u0026#39;blue\u0026#39;); // æ¯æ¬¡æ“ä½œéƒ½è¿”å›æœ¬èº«çš„æŒ‡é’ˆï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ç‚¹æ“ä½œè¯­æ³• for (let item of set.keys()) { console.log(item); } // red green blue for (let item of set.values()) { console.log(item); } // red green blue for (let item of set.entries()) { console.log(item); } // [\u0026#34;red\u0026#34;, \u0026#34;red\u0026#34;] [\u0026#34;green\u0026#34;, \u0026#34;green\u0026#34;] [\u0026#34;blue\u0026#34;, \u0026#34;blue\u0026#34;] ä¸Šé¢ä»£ç ä¸­ï¼Œentries æ–¹æ³•è¿”å›çš„ éå†å™¨ ï¼ŒåŒæ—¶åŒ…æ‹¬é”®åå’Œé”®å€¼ï¼Œæ‰€ä»¥æ¯æ¬¡è¾“å‡ºä¸€ä¸ªæ•°ç»„ï¼Œå®ƒçš„ä¸¤ä¸ªæˆå‘˜å®Œå…¨ç›¸ç­‰ã€‚\nğŸ“ Note Array å’Œ Set ä¸€æ ·åŒæ ·å…·æœ‰ FIFO çš„æ•ˆæœ\nArray.prototype.Push = function (item) { this.push(item); return this; } let arr = Array().Push(\u0026#39;red\u0026#39;).Push(\u0026#39;green\u0026#39;).Push(\u0026#39;blue\u0026#39;); for (let key of arr.keys()) { console.log(key); } // 0 1 2 for (let value of arr.values()) { console.log(value); } // red green blue for (let entry of arr.entries()) { console.log(entry); } // [0, \u0026#39;red\u0026#39;] [1, \u0026#39;green\u0026#39;] [2, \u0026#39;blue\u0026#39;] Set ç»“æ„çš„å®ä¾‹é»˜è®¤ å¯éå†iterable ï¼Œå®ƒçš„é»˜è®¤éå†å™¨ç”Ÿæˆå‡½æ•°å°±æ˜¯å®ƒçš„ values æ–¹æ³•ã€‚\nSet.prototype[Symbol.iterator] === Set.prototype.values // true è¿™æ„å‘³ç€ï¼Œå¯ä»¥çœç•¥ values æ–¹æ³•ï¼Œç›´æ¥ç”¨ [for-of](05 JavaScript#for-of) å¾ªç¯éå† Setã€‚\nlet set = new Set([\u0026#39;red\u0026#39;, \u0026#39;green\u0026#39;, \u0026#39;blue\u0026#39;]); for (let x of set) { console.log(x); } // red green blue forEach() Set ç»“æ„çš„å®ä¾‹ä¸ [æ•°ç»„](05 JavaScript#array-es5) ä¸€æ ·ï¼Œä¹Ÿæ‹¥æœ‰ forEach æ–¹æ³•ï¼Œç”¨äºå¯¹æ¯ä¸ªæˆå‘˜æ‰§è¡ŒæŸç§æ“ä½œï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚\nğŸ“ƒ Example\nlet set = new Set([1, 4, 9]); set.forEach( (value, key) =\u0026gt; console.log(`${key}:${value}`) ); // 1:1 4:4 9:9 ä¸Šé¢ä»£ç è¯´æ˜ï¼ŒforEach æ–¹æ³•çš„å‚æ•°å°±æ˜¯ä¸€ä¸ªå¤„ç†å‡½æ•°ã€‚è¯¥å‡½æ•°çš„å‚æ•°ä¸æ•°ç»„çš„ forEach ä¸€è‡´ï¼Œä¾æ¬¡ä¸ºé”®å€¼ã€é”®åã€é›†åˆæœ¬èº«ï¼ˆä¸Šä¾‹çœç•¥äº†è¯¥å‚æ•°ï¼‰ã€‚è¿™é‡Œéœ€è¦æ³¨æ„ï¼ŒSet ç»“æ„çš„é”®åå°±æ˜¯é”®å€¼ï¼Œå› æ­¤ç¬¬ä¸€ä¸ªå‚æ•°ä¸ç¬¬äºŒä¸ªå‚æ•°çš„å€¼æ°¸è¿œéƒ½æ˜¯ä¸€æ ·çš„ã€‚\nå¦å¤–ï¼ŒforEach æ–¹æ³•è¿˜å¯ä»¥æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¡¨ç¤ºç»‘å®šå¤„ç†å‡½æ•°å†…éƒ¨çš„ this å¯¹è±¡ã€‚\nåº”ç”¨ æ‰©å±•è¿ç®—ç¬¦... å†…éƒ¨ä½¿ç”¨ for-of å¾ªç¯ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç”¨äº Set ç»“æ„ã€‚\nlet set = new Set([\u0026#39;red\u0026#39;, \u0026#39;green\u0026#39;, \u0026#39;blue\u0026#39;]); let arr = [...set]; // [\u0026#39;red\u0026#39;, \u0026#39;green\u0026#39;, \u0026#39;blue\u0026#39;] [æ‰©å±•è¿ç®—ç¬¦](05 EcmaScript.md/#theargs-array) å’Œ Set ç»“æ„ç›¸ç»“åˆï¼Œå°±å¯ä»¥å»é™¤æ•°ç»„çš„é‡å¤æˆå‘˜ã€‚\nlet arr = [3, 5, 2, 2, 5, 5]; let unique = [...new Set(arr)]; // [3, 5, 2] è€Œä¸”ï¼Œæ•°ç»„çš„ Map å’Œ filter æ–¹æ³•ä¹Ÿå¯ä»¥é—´æ¥ç”¨äº Set äº†ã€‚\nlet set = new Set([1, 2, 3]); set = new Set([...set].map(x =\u0026gt; x * 2)); // è¿”å›Setç»“æ„ï¼š{2, 4, 6} let set = new Set([1, 2, 3, 4, 5]); set = new Set([...set].filter(x =\u0026gt; (x % 2) == 0)); // è¿”å›Setç»“æ„ï¼š{2, 4} å› æ­¤ä½¿ç”¨ Set å¯ä»¥å¾ˆå®¹æ˜“åœ°å®ç° å¹¶é›†$\\cup$-Unionã€äº¤é›†$\\cap$-Intersection å’Œ å·®é›†$âˆ$-Complement ã€‚\nlet a = new Set([1, 2, 3]); let b = new Set([4, 3, 2]); // å¹¶é›† let union = new Set([...a, ...b]); // Set {1, 2, 3, 4} // äº¤é›† let intersect = new Set([...a].filter(x =\u0026gt; b.has(x))); // set {2, 3} // ï¼ˆa ç›¸å¯¹äº b çš„ï¼‰å·®é›† let difference = new Set([...a].filter(x =\u0026gt; !b.has(x))); // Set {1} :link: Href [Array.prototype.filter()](05 JavaScript#array-filter-es5)\nå¦‚æœæƒ³åœ¨éå†æ“ä½œä¸­ï¼ŒåŒæ­¥æ”¹å˜åŸæ¥çš„ Set ç»“æ„ï¼Œç›®å‰æ²¡æœ‰ç›´æ¥çš„æ–¹æ³•ï¼Œä½†æœ‰ä¸¤ç§å˜é€šæ–¹æ³•ï¼š\nåˆ©ç”¨åŸ Set ç»“æ„æ˜ å°„å‡ºä¸€ä¸ªæ–°çš„ç»“æ„ï¼Œé€šè¿‡ [Array.map()](05 JavaScript#array-map-es5) ç„¶åèµ‹å€¼ç»™åŸæ¥çš„ Set ç»“æ„ åˆ©ç”¨ [Array.from()](#05 EcmaScript.md#array-from-es6) æ–¹æ³• // æ–¹æ³•ä¸€ let set = new Set([1, 2, 3]); set = new Set([...set].map(val =\u0026gt; val * 2)); // setçš„å€¼æ˜¯2, 4, 6 // æ–¹æ³•äºŒ let set = new Set([1, 2, 3]); set = new Set(Array.from(set, val =\u0026gt; val * 2)); // setçš„å€¼æ˜¯2, 4, 6 ä¸Šé¢ä»£ç æä¾›äº†ä¸¤ç§æ–¹æ³•ï¼Œç›´æ¥åœ¨éå†æ“ä½œä¸­æ”¹å˜åŸæ¥çš„ Set ç»“æ„ã€‚\nWeakSet JavaScript åƒåœ¾å›æ”¶æ˜¯ä¸€ç§å†…å­˜ç®¡ç†æŠ€æœ¯ã€‚åœ¨è¿™ç§æŠ€æœ¯ä¸­ï¼Œä¸å†è¢«å¼•ç”¨çš„å¯¹è±¡ä¼šè¢«è‡ªåŠ¨åˆ é™¤ï¼Œè€Œä¸å…¶ç›¸å…³çš„èµ„æºä¹Ÿä¼šè¢«ä¸€åŒå›æ”¶ã€‚\nMap å’Œ Set ä¸­å¯¹è±¡çš„å¼•ç”¨éƒ½æ˜¯å¼ºç±»å‹åŒ–çš„ï¼Œå¹¶ä¸ä¼šå…è®¸åƒåœ¾å›æ”¶ã€‚è¿™æ ·ä¸€æ¥ï¼Œå¦‚æœ Map å’Œ Set ä¸­å¼•ç”¨äº†ä¸å†éœ€è¦çš„å¤§å‹å¯¹è±¡ï¼Œå¦‚å·²ç»ä» DOM æ ‘ä¸­åˆ é™¤çš„ DOM å…ƒç´ ï¼Œé‚£ä¹ˆå…¶å›æ”¶ä»£ä»·æ˜¯æ˜‚è´µçš„ã€‚\nä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒES6 è¿˜å¼•å…¥äº†å¦å¤–ä¸¤ç§æ–°çš„æ•°æ®ç»“æ„ï¼Œå³ç§°ä¸º WeakMap å’Œ WeakSet çš„å¼±é›†åˆã€‚è¿™äº›é›†åˆä¹‹æ‰€ä»¥æ˜¯â€œå¼±çš„â€ï¼Œæ˜¯å› ä¸ºå®ƒä»¬å…è®¸ä»å†…å­˜ä¸­æ¸…é™¤ä¸å†éœ€è¦çš„è¢«è¿™äº›é›†åˆæ‰€å¼•ç”¨çš„å¯¹è±¡ã€‚\nWeakSet ç»“æ„ä¸ Set ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸é‡å¤çš„å€¼çš„é›†åˆï¼Œå¹¶é€šè¿‡ WeakSet() åˆå§‹åŒ–initialize ã€‚ä½†æ˜¯ï¼Œå®ƒä¸ Set æœ‰ä¸¤ä¸ªåŒºåˆ«ï¼š\nWeakSet çš„æˆå‘˜åªèƒ½æ˜¯ å¯¹è±¡ ï¼Œè€Œä¸èƒ½æ˜¯å…¶ä»–ç±»å‹çš„å€¼ã€‚\nğŸ“ƒ Example\nconst ws = new WeakSet(); ws.add(1) // TypeError: Invalid value used in weak set ws.add(Symbol()) // TypeError: invalid value used in weak set ä¸Šé¢ä»£ç è¯•å›¾å‘ WeakSet æ·»åŠ ä¸€ä¸ªæ•°å€¼å’Œ Symbol å€¼ï¼Œç»“æœæŠ¥é”™ï¼Œå› ä¸º WeakSet åªèƒ½æ”¾ç½® å¯¹è±¡ ã€‚\nå…¶æ¬¡ï¼ŒWeakSet ä¸­çš„å¯¹è±¡éƒ½æ˜¯ å¼±å¼•ç”¨ ï¼Œå³åƒåœ¾å›æ”¶æœºåˆ¶ ä¸è€ƒè™‘ WeakSet å¯¹è¯¥å¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå…¶ä»–å¯¹è±¡éƒ½ä¸å†å¼•ç”¨è¯¥å¯¹è±¡ï¼Œé‚£ä¹ˆåƒåœ¾å›æ”¶æœºåˆ¶ä¼šè‡ªåŠ¨å›æ”¶è¯¥å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ï¼Œä¸è€ƒè™‘è¯¥å¯¹è±¡æ˜¯å¦å­˜åœ¨äº WeakSet ä¹‹ä¸­ã€‚\nè¿™æ˜¯å› ä¸ºåƒåœ¾å›æ”¶æœºåˆ¶ä¾èµ– å¼•ç”¨è®¡æ•° ï¼Œå¦‚æœä¸€ä¸ªå€¼çš„å¼•ç”¨æ¬¡æ•°ä¸ä¸º 0 ï¼Œåƒåœ¾å›æ”¶æœºåˆ¶å°±ä¸ä¼šé‡Šæ”¾è¿™å—å†…å­˜ã€‚ç»“æŸä½¿ç”¨è¯¥å€¼ä¹‹åï¼Œæœ‰æ—¶ä¼šå¿˜è®°å–æ¶ˆå¼•ç”¨ï¼Œå¯¼è‡´å†…å­˜æ— æ³•é‡Šæ”¾ï¼Œè¿›è€Œå¯èƒ½ä¼šå¼•å‘å†…å­˜æ³„æ¼ã€‚WeakSet é‡Œé¢çš„å¼•ç”¨ï¼Œéƒ½ä¸è®¡å…¥åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œæ‰€ä»¥å°±ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ã€‚å› æ­¤ï¼ŒWeakSet é€‚åˆä¸´æ—¶å­˜æ”¾ä¸€ç»„å¯¹è±¡ï¼Œä»¥åŠå­˜æ”¾è·Ÿå¯¹è±¡ç»‘å®šçš„ä¿¡æ¯ã€‚åªè¦è¿™äº›å¯¹è±¡åœ¨å¤–éƒ¨æ¶ˆå¤±ï¼Œå®ƒåœ¨ WeakSet é‡Œé¢çš„å¼•ç”¨å°±ä¼šè‡ªåŠ¨æ¶ˆå¤±ã€‚\nç”±äºä¸Šé¢è¿™ä¸ªç‰¹ç‚¹ï¼ŒWeakSet çš„æˆå‘˜æ˜¯ä¸é€‚åˆ å¼•ç”¨ çš„ï¼Œå› ä¸ºå®ƒä¼šéšæ—¶æ¶ˆå¤±ã€‚å¦å¤–ï¼Œç”±äº WeakSet å†…éƒ¨æœ‰å¤šå°‘ä¸ªæˆå‘˜ï¼Œå–å†³äºåƒåœ¾å›æ”¶æœºåˆ¶æœ‰æ²¡æœ‰è¿è¡Œï¼Œè¿è¡Œå‰åå¾ˆå¯èƒ½æˆå‘˜ä¸ªæ•°æ˜¯ä¸ä¸€æ ·çš„ï¼Œè€Œåƒåœ¾å›æ”¶æœºåˆ¶ä½•æ—¶è¿è¡Œæ˜¯ä¸å¯é¢„æµ‹çš„ï¼Œå› æ­¤ ES6 è§„å®š WeakSet ä¸å¯éå† ã€‚\nè¿™äº›ç‰¹ç‚¹åŒæ ·é€‚ç”¨äºæœ¬ç« åé¢è¦ä»‹ç»çš„ WeakMap ç»“æ„ã€‚\nè¯­æ³• WeakSet æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ new å‘½ä»¤ï¼Œåˆ›å»º WeakSet æ•°æ®ç»“æ„ã€‚\nconst ws = new WeakSet(iterable); ä½œä¸ºæ„é€ å‡½æ•°ï¼ŒWeakSet å¯ä»¥æ¥å—ä¸€ä¸ªæ•°ç»„æˆ–ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚è¯¥æ•°ç»„çš„æ‰€æœ‰æˆå‘˜ï¼Œéƒ½ä¼šè‡ªåŠ¨æˆä¸º WeakSet å®ä¾‹å¯¹è±¡çš„æˆå‘˜ã€‚\nIterable å¦‚æœä¼ å…¥ä¸€ä¸ª å¯è¿­ä»£å¯¹è±¡iterable object ä½œä¸ºå‚æ•°ï¼Œåˆ™è¯¥å¯¹è±¡çš„æ‰€æœ‰è¿­ä»£å€¼éƒ½ä¼šè¢«è‡ªåŠ¨æ·»åŠ è¿›ç”Ÿæˆçš„ WeakSet å¯¹è±¡ä¸­ã€‚null è¢«è®¤ä¸ºæ˜¯ undefined ã€‚\nğŸ“ Note\nå®é™…ä¸Šï¼Œä»»ä½•å…·æœ‰ Iterable æ¥å£çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥ä½œä¸º WeakSet çš„å‚æ•°ã€‚\nğŸ“ƒ Example\nconst a = [[1, 2], [3, 4]]; const ws = new WeakSet(a); // WeakSet {[1, 2], [3, 4]} ä¸Šé¢ä»£ç ä¸­ï¼Œa æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå®ƒæœ‰ä¸¤ä¸ªæˆå‘˜ï¼Œä¹Ÿéƒ½æ˜¯æ•°ç»„ã€‚å°† a ä½œä¸º WeakSet æ„é€ å‡½æ•°çš„å‚æ•°ï¼Œa çš„æˆå‘˜ä¼šè‡ªåŠ¨æˆä¸º WeakSet çš„æˆå‘˜ã€‚\næ³¨æ„ï¼Œæ˜¯ a æ•°ç»„çš„ æˆå‘˜ æˆä¸º WeakSet çš„æˆå‘˜ï¼Œè€Œä¸æ˜¯ a æ•°ç»„æœ¬èº«ã€‚è¿™æ„å‘³ç€ï¼ŒWeakSet çš„æˆå‘˜åªèƒ½æ˜¯å¯¹è±¡ã€‚\nğŸ“ƒ Example\nconst b = [3, 4]; const ws = new WeakSet(b); // Uncaught TypeError: Invalid value used in weak set(â€¦) ä¸Šé¢ä»£ç ä¸­ï¼Œæ•°ç»„ b çš„æˆå‘˜ä¸æ˜¯ å¯¹è±¡ ï¼ŒåŠ å…¥ WeakSet å°±ä¼šæŠ¥é”™ã€‚\nWeakSet ç»“æ„æœ‰ä»¥ä¸‹ä¸‰ä¸ªæ–¹æ³•ï¼š\nWeakSet.prototype.add(value)ï¼šå‘ WeakSet å®ä¾‹æ·»åŠ ä¸€ä¸ªæ–°æˆå‘˜ WeakSet.prototype.delete(value)ï¼šæ¸…é™¤ WeakSet å®ä¾‹çš„æŒ‡å®šæˆå‘˜ WeakSet.prototype.has(value)ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸä¸ªå€¼æ˜¯å¦åœ¨ WeakSet å®ä¾‹ä¹‹ä¸­ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚\nWeakSet æ²¡æœ‰ size å±æ€§ï¼Œæ²¡æœ‰åŠæ³•éå†å®ƒçš„æˆå‘˜ã€‚\nğŸ“ƒ Example\nlet ws = new WeakSet(); ws.size // undefined ws.forEach // undefined ws.forEach(item =\u0026gt; { console.log(\u0026#39;WeakSet has \u0026#39; + item) }) // TypeError: undefined is not a function ä¸Šé¢ä»£ç è¯•å›¾è·å– size å’Œ forEach å±æ€§ï¼Œç»“æœéƒ½ä¸èƒ½æˆåŠŸã€‚\nWeakSet ä¸èƒ½éå†ï¼Œæ˜¯å› ä¸ºæˆå‘˜éƒ½æ˜¯å¼±å¼•ç”¨ï¼Œéšæ—¶å¯èƒ½æ¶ˆå¤±ï¼Œéå†æœºåˆ¶æ— æ³•ä¿è¯æˆå‘˜çš„å­˜åœ¨ï¼Œå¾ˆå¯èƒ½åˆšåˆšéå†ç»“æŸï¼Œæˆå‘˜å°±å–ä¸åˆ°äº†ã€‚WeakSet çš„ä¸€ä¸ªç”¨å¤„ï¼Œæ˜¯å‚¨å­˜ DOM èŠ‚ç‚¹ï¼Œè€Œä¸ç”¨æ‹…å¿ƒè¿™äº›èŠ‚ç‚¹ä»æ–‡æ¡£ç§»é™¤æ—¶ï¼Œä¼šå¼•å‘å†…å­˜æ³„æ¼ã€‚\nä¸‹é¢æ˜¯ WeakSet çš„å¦ä¸€ä¸ªä¾‹å­ã€‚\nğŸ“ƒ Example\nconst FooSet = new WeakSet(); class Foo { constructor() { FooSet.add(this); } method() { if (!FooSet.has(this)) { throw new TypeError(\u0026#39;Foo.prototype.method åªèƒ½åœ¨Fooçš„å®ä¾‹ä¸Šè°ƒç”¨ï¼\u0026#39;); } return \u0026#39;OK\u0026#39;; } } let foo = new Foo(); console.log(foo.method()) // OK console.log(foo.method.call([])); // TypeError: Foo.prototype.method åªèƒ½åœ¨Fooçš„å®ä¾‹ä¸Šè°ƒç”¨ï¼ ä¸Šé¢ä»£ç ä¿è¯äº† Foo çš„å®ä¾‹æ–¹æ³•ï¼Œåªèƒ½åœ¨ Foo çš„å®ä¾‹ä¸Šè°ƒç”¨ã€‚è¿™é‡Œä½¿ç”¨ WeakSet çš„å¥½å¤„æ˜¯ï¼Œfoo å¯¹å®ä¾‹çš„å¼•ç”¨ï¼Œä¸ä¼šè¢«è®¡å…¥ å†…å­˜å›æ”¶æœºåˆ¶garbage recycle,GC ï¼Œæ‰€ä»¥åˆ é™¤å®ä¾‹çš„æ—¶å€™ï¼Œä¸ç”¨è€ƒè™‘ foos ï¼Œä¹Ÿä¸ä¼šå‡ºç°å†…å­˜æ³„æ¼ã€‚\nMap JavaScript çš„å¯¹è±¡ Object ï¼Œæœ¬è´¨ä¸Šæ˜¯ é”®å€¼å¯¹key-value çš„é›†åˆ Hash ï¼Œä½†æ˜¯ä¼ ç»Ÿä¸Šåªèƒ½ç”¨å­—ç¬¦ä¸²å½“ä½œ é”®key ã€‚è¿™ç»™å®ƒçš„ä½¿ç”¨å¸¦æ¥äº†å¾ˆå¤§çš„é™åˆ¶ã€‚\nğŸ“ƒ Example\n\u0026lt;div id=\u0026#34;myDiv\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; const data = {}; const element = document.getElementById(\u0026#39;myDiv\u0026#39;); console.log(data[element] = \u0026#39;metadata\u0026#39;); console.log(data[\u0026#39;[object HTMLDivElement]\u0026#39;]); // \u0026#34;metadata\u0026#34; \u0026lt;/script\u0026gt; ä¸Šé¢ä»£ç åŸæ„æ˜¯å°†ä¸€ä¸ª DOM èŠ‚ç‚¹ä½œä¸ºå¯¹è±¡ data çš„é”®ï¼Œä½†æ˜¯ç”±äºå¯¹è±¡åªæ¥å— å­—ç¬¦ä¸²String ä½œä¸ºé”®åï¼Œæ‰€ä»¥ element è¢«è°ƒç”¨ Object.toString() æ–¹æ³•è½¬ä¸ºå­—ç¬¦ä¸² [object HTMLDivElement] ã€‚\nğŸ“ Note\nelement == \u0026#39;[object HTMLDivElement]\u0026#39;; // true ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒES6 æä¾›äº† Map æ•°æ®ç»“æ„ã€‚å®ƒç±»ä¼¼äºå¯¹è±¡ï¼Œä¹Ÿæ˜¯é”®å€¼å¯¹çš„é›†åˆï¼Œä½†æ˜¯é”®çš„èŒƒå›´ä¸é™äºå­—ç¬¦ä¸²ï¼Œå„ç§ç±»å‹çš„å€¼ï¼ˆåŒ…æ‹¬å¯¹è±¡ï¼‰éƒ½å¯ä»¥å½“ä½œé”®ã€‚Map æ˜¯ä¸€ç§ æ˜ å°„ ç»“æ„ã€‚\nä¹Ÿå°±æ˜¯è¯´ï¼ŒObject ç»“æ„æä¾›äº† string-value çš„å¯¹åº”ï¼ŒMap ç»“æ„æä¾›äº† value-value çš„å¯¹åº”ï¼Œæ˜¯ä¸€ç§æ›´å®Œå–„çš„ Hash ç»“æ„å®ç°ã€‚å¦‚æœä½ éœ€è¦ key-value çš„æ•°æ®ç»“æ„ï¼ŒMap æ¯” Object æ›´åˆé€‚ã€‚\nMap() å‚æ•°æœ¬èº«æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆ Map æ•°æ®ç»“æ„ï¼Œæ¥å—ä¸€ä¸ª æ•°ç»„arrayï¼ˆæˆ–è€…å…·æœ‰ iterable æ¥å£çš„å…¶ä»–æ•°æ®ç»“æ„ï¼‰ä½œä¸ºå‚æ•°ï¼Œå…¶å…ƒç´ ä¸ºç”±é”®å€¼å¯¹key-value ç»„æˆçš„ä¸¤ä¸ªå…ƒç´ æ•°ç»„ï¼Œç”¨æ¥åˆå§‹åŒ–ã€‚\nğŸ“ Note e.g.:\nlet map = new Map([[1, \u0026#39;one\u0026#39;], [2, \u0026#39;two\u0026#39;]]); // nullä¼šè¢«å½“æˆundefined map // Map(2) {1 =\u0026gt; \u0026#39;one\u0026#39;, 2 =\u0026gt; \u0026#39;two\u0026#39;} ğŸ“ƒ Example\nconst dom = {p: \u0026#39;Hello World\u0026#39;}; const map = new Map(); console.log( map.set(dom, \u0026#39;content\u0026#39;), // Map(1) { { p: \u0026#39;Hello World\u0026#39; } =\u0026gt; \u0026#39;content\u0026#39; } map.get(dom), // content map.has(dom) // true ); console.log( map.delete(dom), // true map.has(dom) // false ); ä¸Šé¢ä»£ç ä½¿ç”¨ Map ç»“æ„çš„ set() æ–¹æ³•ï¼Œå°†å¯¹è±¡å½“ä½œçš„ä¸€ä¸ªé”®ï¼Œç„¶ååˆä½¿ç”¨ get() æ–¹æ³•è¯»å–è¿™ä¸ªé”®ï¼Œæ¥ç€ä½¿ç”¨ delete æ–¹æ³•åˆ é™¤äº†è¿™ä¸ªé”®ã€‚\nğŸ“ Note console.log(\u0026hellip;Args) åœ¨ä¼ å…¥å¤šä¸ªå‚æ•°çš„æ—¶å€™ï¼Œä¼šä¾æ¬¡è®¡ç®—ï¼Œæœ€åè¾“å‡ºã€‚å› æ­¤åœ¨ä½¿ç”¨ delete() æ–¹æ³•åä¼šå¯¼è‡´ Map é‡Œæ²¡æœ‰æˆå‘˜æ— æ³•è¢«æ­£ç¡®è¾“å‡ºã€‚è§£å†³åŠæ³•æ˜¯åˆ†å¼€è¾“å‡ºå³å¯ã€‚\nä¸Šé¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•å‘ Map æ·»åŠ æˆå‘˜ã€‚ä½œä¸ºæ„é€ å‡½æ•°ï¼ŒMap ä¹Ÿå¯ä»¥æ¥å—ä¸€ä¸ª æ•°ç»„array ä½œä¸ºå‚æ•°ã€‚è¯¥æ•°ç»„çš„æˆå‘˜æ˜¯ä¸€ä¸ªä¸ªè¡¨ç¤ºé”®å€¼å¯¹çš„æ•°ç»„ã€‚\nğŸ“ƒ Example\nlet f = \u0026#39;f\u0026#39;, oo = \u0026#39;oo\u0026#39;, foo = \u0026#39;foo\u0026#39;; const map = new Map([ [\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;], [\u0026#39;foo2\u0026#39;, \u0026#39;bar2\u0026#39;], ]); console.log( map.size, // 2 map.has(f + oo), // true map.get(foo), // bar f + oo === foo //true ) // mapæ¯”è¾ƒä¸¤ä¸ªstringå†…å®¹æ˜¯å¦ç›¸ç­‰ ä¸Šé¢ä»£ç åœ¨æ–°å»º Map å®ä¾‹æ—¶ï¼Œå°±æŒ‡å®šäº†ä¸¤ä¸ªé”® name å’Œ titleã€‚\nMap() æ„é€ å‡½æ•°æ¥å—æ•°ç»„ä½œä¸ºå‚æ•°ï¼Œå®é™…ä¸Šæ˜¯è°ƒç”¨æ•°ç»„çš„ [Array.forEach()](05 JavaScript#array-forEach-es5) æ–¹æ³•ã€‚\nğŸ“ƒ Example\nconst items = [ [\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;], [\u0026#39;foo2\u0026#39;, \u0026#39;bar2\u0026#39;] ]; const map = new Map(); items.forEach( (key, value) =\u0026gt; map.set(key, value) ); console.log(map); // Map(2) { // [ \u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39; ] =\u0026gt; 0, // [ \u0026#39;foo2\u0026#39;, \u0026#39;bar2\u0026#39; ] =\u0026gt; 1 // } ğŸ“ Note å‹¿ç»™ forEach() å¾ªç¯æ·»åŠ è§£æ„èµ‹å€¼[]\nconst map2 = new Map(); items.forEach( (key, value) =\u0026gt; map2.set(key, value) ); console.log(map2); // Map(2) { // \u0026#39;foo\u0026#39; =\u0026gt; \u0026#39;bar\u0026#39;, \u0026#39;foo2\u0026#39; =\u0026gt; \u0026#39;bar2\u0026#39; // } äº‹å®ä¸Šï¼Œä¸ä»…ä»…æ˜¯æ•°ç»„ï¼Œä»»ä½•å…·æœ‰ Iterator æ¥å£ã€ä¸”æ¯ä¸ªæˆå‘˜éƒ½æ˜¯ä¸€ä¸ªåŒå…ƒç´ çš„æ•°ç»„çš„æ•°æ®ç»“æ„éƒ½å¯ä»¥å½“ä½œMapæ„é€ å‡½æ•°çš„å‚æ•°ã€‚è¿™å°±æ˜¯è¯´ Set å’Œ Map éƒ½å¯ä»¥ç”¨æ¥ç”Ÿæˆæ–°çš„ Mapã€‚\nğŸ“ƒ Example\n// ä½¿ç”¨Setåˆå§‹åŒ–Map const set = new Set([ [\u0026#39;foo\u0026#39;, 1], [\u0026#39;bar\u0026#39;, 2] ]); const m1 = new Map(set); // ä½¿ç”¨Mapåˆå§‹åŒ–Map const m2 = new Map([[\u0026#39;baz\u0026#39;, 3]]); const m3 = new Map(m2); console.log( m1.get(\u0026#39;foo\u0026#39;), // 1 m3.get(\u0026#39;baz\u0026#39;) // 3 ); ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«ä½¿ç”¨ Set å¯¹è±¡å’Œ Map å¯¹è±¡ï¼Œå½“ä½œ Map() çš„å‚æ•°ï¼Œç»“æœéƒ½ç”Ÿæˆäº†æ–°çš„ Map å¯¹è±¡ã€‚\nå¦‚æœå¯¹åŒä¸€ä¸ªé”®å¤šæ¬¡èµ‹å€¼ï¼Œåé¢çš„å€¼å°† è¦†ç›–overwrite å‰é¢çš„å€¼ã€‚\nğŸ“ƒ Example\nconst map = new Map(); map .set(1, \u0026#39;aaa\u0026#39;) .set(1, \u0026#39;bbb\u0026#39;); map.get(1) // \u0026#34;bbb\u0026#34; ä¸Šé¢ä»£ç å¯¹é”® 1 è¿ç»­èµ‹å€¼ä¸¤æ¬¡ï¼Œåä¸€æ¬¡çš„å€¼è¦†ç›–å‰ä¸€æ¬¡çš„å€¼ã€‚\nå¦‚æœè¯»å–ä¸€ä¸ªæœªçŸ¥çš„é”®ï¼Œåˆ™è¿”å› undefined ã€‚\nnew Map().get(\u0026#39;asfddfsasadf\u0026#39;) // undefined æ³¨æ„ï¼Œåªæœ‰å¯¹ åŒä¸€ä¸ªå¯¹è±¡ çš„å¼•ç”¨ï¼ŒMap ç»“æ„æ‰å°†å…¶è§†ä¸ºåŒä¸€ä¸ªé”®ã€‚è¿™ä¸€ç‚¹è¦éå¸¸å°å¿ƒã€‚\nconst map = new Map(); console.log( map.set([\u0026#39;a\u0026#39;], 555), // Map(1) { [\u0026#39;a\u0026#39;] =\u0026gt; 555 } map.get([\u0026#39;a\u0026#39;]) // undefined ); åŒç†ï¼ŒåŒæ ·çš„å€¼çš„ä¸¤ä¸ªå®ä¾‹ï¼Œåœ¨ Map ç»“æ„ä¸­è¢«è§†ä¸ºä¸¤ä¸ªé”®ï¼ˆæŒ‡é’ˆä¸åŒï¼‰ã€‚\nğŸ“ƒ Example\nconst map = new Map(); const k1 = [\u0026#39;a\u0026#39;]; const k2 = [\u0026#39;a\u0026#39;]; map .set(k1, 111) .set(k2, 222); console.log( map.get(k1), // 111 map.get(k2) // 222 ) ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡ k1 å’Œ k2 çš„å€¼æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å®ƒä»¬åœ¨ Map ç»“æ„ä¸­è¢«è§†ä¸ºä¸¤ä¸ªé”®ã€‚\nğŸ“ Note\nä½¿ç”¨ string ç±»å‹æ—¶ï¼Œä¸¤ä¸ªç›¸åŒçš„å­—ç¬¦ä¸²ä¼šè¢«å½“æˆåŒä¸€ä¸ªå˜é‡ã€‚\nconst map = new Map(); let k1 = \u0026#39;a1\u0026#39;; let k2 = \u0026#39;a1\u0026#39;; k1 === k2; // true map.set(k1, 111).set(k2, 222); map.get(k1); // 222 map.get(k2); // 222 ç”±ä¸Šå¯çŸ¥ï¼ŒMap çš„é”®å®é™…ä¸Šæ˜¯è·Ÿ å†…å­˜åœ°å€pointer ç»‘å®šçš„ï¼Œåªè¦å†…å­˜åœ°å€ä¸ä¸€æ ·ï¼Œå°±è§†ä¸ºä¸¤ä¸ªé”®ã€‚è¿™å°±è§£å†³äº†åŒåå±æ€§ç¢°æ’clash çš„é—®é¢˜ï¼Œæˆ‘ä»¬æ‰©å±•åˆ«äººçš„åº“çš„æ—¶å€™ï¼Œå¦‚æœä½¿ç”¨ å¯¹è±¡ ä½œä¸ºé”®åï¼Œå°±ä¸ç”¨æ‹…å¿ƒè‡ªå·±çš„å±æ€§ä¸åŸä½œè€…çš„å±æ€§åŒåã€‚\nå¦‚æœ Map çš„é”®æ˜¯ä¸€ä¸ªç®€å•ç±»å‹çš„å€¼ï¼ˆæ•°å­—numberã€å­—ç¬¦ä¸²stringã€å¸ƒå°”å€¼booleanï¼‰ï¼Œåˆ™åªè¦ä¸¤ä¸ªå€¼ ä¸¥æ ¼ç›¸ç­‰=== ï¼ŒMap å°†å…¶è§†ä¸ºä¸€ä¸ªé”®ï¼Œæ¯”å¦‚ 0 å’Œ -0 å°±æ˜¯ä¸€ä¸ªé”®ï¼Œå¸ƒå°”å€¼ true å’Œå­—ç¬¦ä¸² \u0026rsquo;true\u0026rsquo; åˆ™æ˜¯ä¸¤ä¸ªä¸åŒçš„é”®ã€‚å¦å¤–ï¼Œundefined å’Œ null ä¹Ÿæ˜¯ä¸¤ä¸ªä¸åŒçš„é”®ã€‚è™½ç„¶ NaN ä¸ä¸¥æ ¼ç›¸ç­‰äºè‡ªèº«ï¼Œä½† Map å°†å…¶è§†ä¸ºåŒä¸€ä¸ªé”®ã€‚\nğŸ“ Note\nconsole.log(NaN === NaN); //false // Equality comparison with NaN always evaluates to false console.log(isNaN(NaN) === isNaN(NaN)); //true let map = new Map(); console.log( map.set(-0, 123), map.get(+0), // 123 map.set(true, 1), map.set(\u0026#39;true\u0026#39;, 2), map.get(true), // 1 map.set(undefined, 3), map.set(null, 4), map.get(undefined), // 3 map.set(NaN, 123), map.get(NaN) // 123 ); ğŸ“ Note undefined åœ¨ Map é‡Œä¹Ÿå¯ä»¥ç»‘å®šé”®å€¼value ã€‚\nå±æ€§ Map ç»“æ„çš„å®ä¾‹æœ‰ä»¥ä¸‹å±æ€§ã€‚\nMap.prototype.constructorï¼šæ„é€ å‡½æ•°ï¼Œé»˜è®¤å°±æ˜¯ Map() Map.prototype.Mapï¼šè¿”å› Map å®ä¾‹çš„æˆå‘˜æ€»æ•° size size å±æ€§è¿”å› Map ç»“æ„çš„æˆå‘˜æ€»æ•°ã€‚\nconst map = new Map(); map.set(\u0026#39;foo\u0026#39;, true); map.set(\u0026#39;bar\u0026#39;, false); map.size // 2 æ“ä½œ Map ç»“æ„çš„å®ä¾‹æœ‰ä»¥ä¸‹æ–¹æ³•ï¼š\nMap. size, set(), get(), has(), delete(), clear()\nset() Map.prototype.set(key, value) ï¼š Set æ–¹æ³•è®¾ç½® é”®åkey å¯¹åº”çš„é”®å€¼ä¸ºvalueï¼Œç„¶åè¿”å›æ•´ä¸ª Map ç»“æ„ã€‚å¦‚æœ key å·²ç»æœ‰å€¼ï¼Œåˆ™é”®å€¼ä¼šè¢«æ›´æ–°ï¼Œå¦åˆ™å°±é‡æ–°ç”Ÿæˆè¯¥é”®ã€‚\nconst map = new Map() .set(\u0026#39;edition\u0026#39;, 6) // é”®æ˜¯å­—ç¬¦ä¸² .set(262, \u0026#39;standard\u0026#39;) // é”®æ˜¯æ•°å€¼ .set(undefined, \u0026#39;nah\u0026#39;) // é”®æ˜¯undefined Set æ–¹æ³•è¿”å›çš„æ˜¯å½“å‰çš„ Map å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥é‡‡ç”¨ [é“¾å¼å†™æ³•](05 JavaScript#trick-chain) ã€‚\nlet map = new Map() .set(1, \u0026#39;a\u0026#39;) .set(2, \u0026#39;b\u0026#39;) .set(3, \u0026#39;c\u0026#39;); get() Map.prototype.get(key)ï¼šget æ–¹æ³•è¯»å– key å¯¹åº”çš„é”®å€¼ï¼Œå¦‚æœæ‰¾ä¸åˆ° key ï¼Œè¿”å› undefined ã€‚\nconst map = new Map(); const hello = () =\u0026gt; console.log(\u0026#39;hello\u0026#39;); map.set(hello, \u0026#39;Hello ES6!\u0026#39;); // é”®æ˜¯å‡½æ•° map.get(hello); // Hello ES6! has() Map.prototype.has(key)ï¼šhas æ–¹æ³•è¿”å› boolean ï¼Œè¡¨ç¤ºæŸä¸ªé”®æ˜¯å¦åœ¨å½“å‰ Map å¯¹è±¡ä¹‹ä¸­ã€‚\nconst map = new Map(); map.set(\u0026#39;edition\u0026#39;, 6); map.set(262, \u0026#39;standard\u0026#39;); map.set(undefined, \u0026#39;nah\u0026#39;); console.log( map.has(\u0026#39;edition\u0026#39;), // true map.has(\u0026#39;years\u0026#39;), // false map.has(262), // true map.has(undefined) // true ); delete()\nMap.prototype.delete(key)ï¼šdeleteæ–¹æ³•åˆ é™¤æŸä¸ªé”®ï¼Œè¿”å› true ã€‚å¦‚æœåˆ é™¤å¤±è´¥ï¼Œè¿”å›falseã€‚\nconst map = new Map(); map.set(undefined, \u0026#39;nah\u0026#39;); map.has(undefined) // true map.delete(undefined) map.has(undefined) // false clear() Map.prototype.clear()ï¼šclearæ–¹æ³•æ¸…é™¤æ‰€æœ‰æˆå‘˜ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚\nlet map = new Map(); map.set(\u0026#39;foo\u0026#39;, true); map.set(\u0026#39;bar\u0026#39;, false); console.log( map.size, // 2 map.clear(), // void function, undefined map.size // 0 ); éå† Map ç»“æ„åŸç”Ÿæä¾›ä¸‰ä¸ªéå†å™¨ç”Ÿæˆå‡½æ•°å’Œä¸€ä¸ªéå†æ–¹æ³•ã€‚\nMap.prototype.keys()ï¼šè¿”å›é”®åçš„éå†å™¨ã€‚ Map.prototype.values()ï¼šè¿”å›é”®å€¼çš„éå†å™¨ã€‚ Map.prototype.entries()ï¼šè¿”å›æ‰€æœ‰æˆå‘˜çš„éå†å™¨ã€‚ Map.prototype.forEach()ï¼šéå† Map çš„æ‰€æœ‰æˆå‘˜ã€‚ éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼ŒMap çš„éå†é¡ºåºå°±æ˜¯ æ’å…¥é¡ºåº ã€‚\nconst map = new Map([ [\u0026#39;F\u0026#39;, \u0026#39;no\u0026#39;], [\u0026#39;T\u0026#39;, \u0026#39;yes\u0026#39;], ]); for (let key of map.keys()) { console.log(key); } // \u0026#34;F\u0026#34; \u0026#34;T\u0026#34; for (let value of map.values()) { console.log(value); } // \u0026#34;no\u0026#34; \u0026#34;yes\u0026#34; for (let item of map.entries()) { console.log(`[${item[0]}-${item[1]}]`); } // [F-no] [T-yes] // æˆ–è€… for (let [key, value] of map.entries()) { console.log(`[${key}-${value}]`); } // [F-no] [T-yes] // ç­‰åŒäºä½¿ç”¨map.entries() for (let [key, value] of map) { console.log(`[${key}-${value}]`); } // [F-no] [T-yes] ä¸Šé¢ä»£ç æœ€åçš„é‚£ä¸ªä¾‹å­ï¼Œè¡¨ç¤º Map ç»“æ„çš„é»˜è®¤éå†å™¨æ¥å£ Symbol.iterator ï¼Œå°±æ˜¯ entries æ–¹æ³•ã€‚\nmap[Symbol.iterator] === map.entries // true Map ç»“æ„è½¬ä¸ºæ•°ç»„ç»“æ„ï¼Œæ¯”è¾ƒå¿«é€Ÿçš„æ–¹æ³•æ˜¯ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦... ã€‚\nconst map = new Map([ [1, \u0026#39;one\u0026#39;], [2, \u0026#39;two\u0026#39;], [3, \u0026#39;three\u0026#39;], ]); console.log( [...map.keys()], // [1, 2, 3] [...map.values()], // [\u0026#39;one\u0026#39;, \u0026#39;two\u0026#39;, \u0026#39;three\u0026#39;] [...map.entries()], // [[1,\u0026#39;one\u0026#39;], [2, \u0026#39;two\u0026#39;], [3, \u0026#39;three\u0026#39;]] [...map], // [[1,\u0026#39;one\u0026#39;], [2, \u0026#39;two\u0026#39;], [3, \u0026#39;three\u0026#39;]] ); ğŸ“ Note Arraay.prototype.from() ä¹Ÿå¯ä»¥è¾¾åˆ°ç›¸åº”æ•ˆæœã€‚\nç»“åˆæ•°ç»„çš„ [map()](05 JavaScript#array-map-es5) æ–¹æ³•ã€[filter()](05 JavaScript#array-filter-es5) æ–¹æ³•ï¼Œå¯ä»¥å®ç° Map çš„éå†å’Œè¿‡æ»¤ï¼ˆMap æœ¬èº«æ²¡æœ‰ map() å’Œ filter() æ–¹æ³•ï¼‰ã€‚\nconst map0 = new Map() .set(1, \u0026#39;a\u0026#39;) .set(2, \u0026#39;b\u0026#39;) .set(3, \u0026#39;c\u0026#39;); const map1 = new Map( [...map0].filter(([k, v]) =\u0026gt; k \u0026lt; 3) ); // äº§ç”Ÿ Map ç»“æ„ {1 =\u0026gt; \u0026#39;a\u0026#39;, 2 =\u0026gt; \u0026#39;b\u0026#39;} const map2 = new Map( [...map0].map(([k, v]) =\u0026gt; [k * 2, \u0026#39;_\u0026#39; + v]) ); // äº§ç”Ÿ Map ç»“æ„ {2 =\u0026gt; \u0026#39;_a\u0026#39;, 4 =\u0026gt; \u0026#39;_b\u0026#39;, 6 =\u0026gt; \u0026#39;_c\u0026#39;} console.log(map1, map2); æ­¤å¤–ï¼ŒMap è¿˜æœ‰ä¸€ä¸ª forEach() æ–¹æ³•ï¼Œä¸æ•°ç»„çš„ [forEach()](05 JavaScript#array-forEach-es5) æ–¹æ³•ç±»ä¼¼ï¼Œä¹Ÿå¯ä»¥å®ç°éå†ã€‚\nnew Map([[\u0026#39;k\u0026#39;, \u0026#39;v\u0026#39;]]).forEach((value, key, map) =\u0026gt; { console.log(\u0026#34;Key: %s, Value: %s\u0026#34;, key, value); }); forEach æ–¹æ³•è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œç”¨æ¥ç»‘å®š this ã€‚\nconst reporter = { report: function(key, value) { console.log(\u0026#34;Key: %s, Value: %s\u0026#34;, key, value); } }; new Map([[\u0026#39;k\u0026#39;, \u0026#39;v\u0026#39;]]).forEach(function(value, key, map) { this.report(key, value); // Key: k, Value: v }, reporter); ä¸Šé¢ä»£ç ä¸­ï¼ŒforEach æ–¹æ³•çš„å›è°ƒå‡½æ•°çš„ this ï¼Œå°±æŒ‡å‘ reporter ã€‚\nè½¬æ¢ Map â‡’ Array å‰é¢å·²ç»æè¿‡ï¼ŒMap è½¬ä¸ºæ•°ç»„æœ€æ–¹ä¾¿çš„æ–¹æ³•ï¼Œå°±æ˜¯ä½¿ç”¨ æ‰©å±•è¿ç®—ç¬¦... ã€‚\nconst map = new Map() .set(true, 7) .set({foo: 3}, [\u0026#39;abc\u0026#39;]); console.log( [...map], // [[true, 7], [{foo: 3}, [\u0026#39;abc\u0026#39;]]] Array.from(map) // [[true, 7], [{foo: 3}, [\u0026#39;abc\u0026#39;]]] ) Array â‡’ Map å°†æ•°ç»„ä¼ å…¥ Map æ„é€ å‡½æ•°ï¼Œå°±å¯ä»¥è½¬ä¸º Mapã€‚\nnew Map([ [true, 7], [{foo: 3}, [\u0026#39;abc\u0026#39;]] ]); // Map(2) { // true =\u0026gt; 7, // Object {foo: 3} =\u0026gt; [\u0026#39;abc\u0026#39;] // } Map â‡’ Object å¦‚æœæ‰€æœ‰ Map çš„é”®éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒå¯ä»¥æ— æŸåœ°è½¬ä¸ºå¯¹è±¡ã€‚\nlet strMapToObj = strMap =\u0026gt; { let obj = Object.create(null); // æ­¤æ—¶åˆ›å»ºçš„å¯¹è±¡ä¸ç»§æ‰¿Object.prototype for (let [k, v] of strMap) { obj[k] = v; } return obj; } const map = new Map() .set(\u0026#39;yes\u0026#39;, true) .set(\u0026#39;no\u0026#39;, false); console.log(strMapToObj(map)); // [Object: null prototype] // { yes: true, no: false } å¦‚æœæœ‰éå­—ç¬¦ä¸²çš„é”®åï¼Œé‚£ä¹ˆè¿™ä¸ªé”®åä¼šè¢«è½¬æˆå­—ç¬¦ä¸²ï¼Œå†ä½œä¸ºå¯¹è±¡çš„é”®åã€‚\n:link: Href [Object.create()](05 JavaScript#object-create-es5)\nObject â‡’ Map å¯¹è±¡è½¬ä¸º Map å¯ä»¥é€šè¿‡ Object.entries()ã€‚\nlet obj = {\u0026#34;a\u0026#34;:1, \u0026#34;b\u0026#34;:2}; let map = new Map(Object.entries(obj)); æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ªè½¬æ¢å‡½æ•°ã€‚\nfunction objToStrMap(obj) { let strMap = new Map(); for (let k of Object.keys(obj)) { strMap.set(k, obj[k]); } return strMap; } objToStrMap({yes: true, no: false}) // Map {\u0026#34;yes\u0026#34; =\u0026gt; true, \u0026#34;no\u0026#34; =\u0026gt; false} Map â‡’ JSON Map è½¬ä¸º JSON è¦åŒºåˆ†ä¸¤ç§æƒ…å†µï¼š\nMap çš„é”®åéƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™æ—¶å¯ä»¥é€‰æ‹©è½¬ä¸ºå¯¹è±¡ JSON\n:link: Href [JSON](05 JavaScript#object-copy-json) å®ç°çš„æ·±æ‹·è´\nlet strMapToObj = strMap =\u0026gt; { let obj = Object.create(null); // æ­¤æ—¶åˆ›å»ºçš„å¯¹è±¡ä¸ç»§æ‰¿Object.prototype for (let [k, v] of strMap) { obj[k] = v; } return obj; } let strMapToJson = strMap =\u0026gt; JSON.stringify(strMapToObj(strMap)); // NOTEï¼šES2017å¼€å§‹å¯ä»¥ä½¿ç”¨Object.fromEntries()ç›´æ¥è½¬æ¢ let strMapToJson2 = map =\u0026gt; JSON.stringify(Object.fromEntries(map)); let map = new Map().set(\u0026#39;yes\u0026#39;, true).set(\u0026#39;no\u0026#39;, false); console.log( strMapToJson(map), strMapToJson2(map) ); // {\u0026#34;yes\u0026#34;:true,\u0026#34;no\u0026#34;:false} Map çš„é”®åæœ‰éå­—ç¬¦ä¸² ï¼Œè¿™æ—¶å¯ä»¥é€‰æ‹©è½¬ä¸ºæ•°ç»„ JSON\nfunction mapToArrayJson(map) { return JSON.stringify([...map]); } let myMap = new Map().set(true, 7).set({foo: 3}, [\u0026#39;abc\u0026#39;]); mapToArrayJson(myMap); // \u0026#39;[[true,7],[{\u0026#34;foo\u0026#34;:3},[\u0026#34;abc\u0026#34;]]]\u0026#39; JSON â‡’ Map JSON è½¬ä¸º Mapï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œæ‰€æœ‰é”®åéƒ½æ˜¯å­—ç¬¦ä¸²ã€‚\nlet jsonToStrMap = json =\u0026gt; new Map(Object.entries(JSON.parse(json))); console.log( jsonToStrMap(\u0026#39;{\u0026#34;yes\u0026#34;: true, \u0026#34;no\u0026#34;: false}\u0026#39;) ); // Map(2) {\u0026#39;yes\u0026#39; =\u0026gt; true, \u0026#39;no\u0026#39; =\u0026gt; false} ä½†æ˜¯ï¼Œæœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œæ•´ä¸ª JSON å°±æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¸”æ¯ä¸ªæ•°ç»„æˆå‘˜æœ¬èº«ï¼Œåˆæ˜¯ä¸€ä¸ªæœ‰ä¸¤ä¸ªæˆå‘˜çš„æ•°ç»„ã€‚è¿™æ—¶ï¼Œå®ƒå¯ä»¥ä¸€ä¸€å¯¹åº”åœ°è½¬ä¸º Mapã€‚è¿™å¾€å¾€æ˜¯ Map è½¬ä¸ºæ•°ç»„ JSON çš„é€†æ“ä½œã€‚\nlet jsonToMap = (jsonMap) =\u0026gt; new Map(JSON.parse(jsonMap)); jsonToMap(\u0026#39;[[true,7],[{\u0026#34;foo\u0026#34;:3},[\u0026#34;abc\u0026#34;]]]\u0026#39;) // Map(2) {true =\u0026gt; 7, Object {foo: 3} =\u0026gt; [\u0026#39;abc\u0026#39;]} æ¯”è¾ƒ Objects å’Œ Maps ç±»ä¼¼çš„æ˜¯ï¼Œå®ƒä»¬éƒ½å…è®¸ä½ æŒ‰é”®å­˜å–ä¸€ä¸ªå€¼ã€åˆ é™¤é”®ã€æ£€æµ‹ä¸€ä¸ªé”®æ˜¯å¦ç»‘å®šäº†å€¼ã€‚å› æ­¤ï¼ˆå¹¶ä¸”ä¹Ÿæ²¡æœ‰å…¶ä»–å†…å»ºçš„æ›¿ä»£æ–¹å¼äº†ï¼‰è¿‡å»æˆ‘ä»¬ä¸€ç›´éƒ½æŠŠå¯¹è±¡å½“æˆ Maps ä½¿ç”¨ã€‚ä¸è¿‡ Maps å’Œ Objects æœ‰ä¸€äº›é‡è¦çš„åŒºåˆ«ï¼Œåœ¨ä¸‹åˆ—æƒ…å†µé‡Œä½¿ç”¨ Map ä¼šæ˜¯æ›´å¥½çš„é€‰æ‹©ï¼š\n:link: Href [Object.prototype.create()](05 JavaScript#object-prototype-create)\nMap Object æ„å¤–çš„é”® Map é»˜è®¤æƒ…å†µä¸åŒ…å«ä»»ä½•é”®ã€‚åªåŒ…å«æ˜¾å¼æ’å…¥çš„é”®ã€‚ ä¸€ä¸ª Object æœ‰ä¸€ä¸ªåŸå‹prototypeï¼ŒåŸå‹é“¾ä¸Šçš„é”®åæœ‰å¯èƒ½å’Œä½ è‡ªå·±åœ¨å¯¹è±¡ä¸Šçš„è®¾ç½®çš„é”®åäº§ç”Ÿå†²çªã€‚\n:memo: Note è™½ç„¶ ES5 å¼€å§‹å¯ä»¥ç”¨ Object.create(null) æ¥åˆ›å»ºä¸€ä¸ªæ²¡æœ‰åŸå‹çš„å¯¹è±¡ï¼Œä½†æ˜¯è¿™ç§ç”¨æ³•ä¸å¤ªå¸¸è§ã€‚ é”®çš„ç±»å‹ ä¸€ä¸ª Map çš„é”®å¯ä»¥æ˜¯ ä»»æ„å€¼ ï¼ŒåŒ…æ‹¬å‡½æ•°ã€å¯¹è±¡æˆ–ä»»æ„åŸºæœ¬ç±»å‹ã€‚\nå†…éƒ¨ä½¿ç”¨ Hash è¡¨å­˜å‚¨é”®å€¼å¯¹ ä¸€ä¸ª Object çš„é”®å¿…é¡»æ˜¯ä¸€ä¸ª String æˆ–æ˜¯ Symbolã€‚ é”®çš„é¡ºåº Map ä¸­çš„ key æ˜¯æœ‰åºçš„ã€‚å› æ­¤ï¼Œå½“è¿­ä»£çš„æ—¶å€™ï¼Œä¸€ä¸ª Map å¯¹è±¡ä»¥æ’å…¥çš„é¡ºåºè¿”å›é”®å€¼ã€‚\nç±»ä¼¼FIFO ä¸€ä¸ª Object çš„é”®æ˜¯æ— åºçš„\n:memo: Noteè‡ª ES6 è§„èŒƒä»¥æ¥ï¼Œå¯¹è±¡ç¡®å®ä¿ç•™äº†å­—ç¬¦ä¸²å’Œ Symbol é”®çš„åˆ›å»ºé¡ºåºï¼› å› æ­¤ï¼Œåœ¨åªæœ‰å­—ç¬¦ä¸²é”®çš„å¯¹è±¡ä¸Šè¿›è¡Œè¿­ä»£å°†æŒ‰æ’å…¥é¡ºåºäº§ç”Ÿé”®ã€‚\nNumber ç±»å‹ä»ç„¶æŒ‰ç…§ä»å°åˆ°å¤§æ’åºã€‚ Size Map çš„é”®å€¼å¯¹ä¸ªæ•°å¯ä»¥è½»æ˜“åœ°é€šè¿‡ size å±æ€§è·å– Object çš„é”®å€¼å¯¹ä¸ªæ•°åªèƒ½æ‰‹åŠ¨è®¡ç®— è¿­ä»£ Map æ˜¯ iterable çš„ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¢«è¿­ä»£ã€‚ è¿­ä»£ä¸€ä¸ª Object éœ€è¦ä»¥æŸç§æ–¹å¼è·å–å®ƒçš„é”®ç„¶åæ‰èƒ½è¿­ä»£ã€‚ æ€§èƒ½ åœ¨é¢‘ç¹å¢åˆ é”®å€¼å¯¹çš„åœºæ™¯ä¸‹è¡¨ç°æ›´å¥½ã€‚ åœ¨é¢‘ç¹æ·»åŠ å’Œåˆ é™¤é”®å€¼å¯¹çš„åœºæ™¯ä¸‹æœªä½œå‡ºä¼˜åŒ–ã€‚ WeakMap WeakMap ç»“æ„ä¸ Map ç»“æ„ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ç”¨äºç”Ÿæˆ é”®å€¼å¯¹key-value çš„é›†åˆã€‚\n// WeakMap å¯ä»¥ä½¿ç”¨ set æ–¹æ³•æ·»åŠ æˆå‘˜ const wm1 = new WeakMap(); const key = {foo: 1}; wm1.set(key, 2); wm1.get(key) // 2 // WeakMap ä¹Ÿå¯ä»¥æ¥å—ä¸€ä¸ªæ•°ç»„ï¼Œ // ä½œä¸ºæ„é€ å‡½æ•°çš„å‚æ•° const k1 = [1, 2, 3]; const k2 = [4, 5, 6]; const wm2 = new WeakMap([[k1, \u0026#39;foo\u0026#39;], [k2, \u0026#39;bar\u0026#39;]]); wm2.get(k2) // \u0026#34;bar\u0026#34; WeakMap ä¸ Map çš„åŒºåˆ«æœ‰ä¸¤ç‚¹ï¼š\n:star: WeakMap åªæ¥å— å¯¹è±¡Object ä½œä¸ºé”®åï¼ˆnullé™¤å¤–ï¼‰ï¼Œä¸æ¥å—å…¶ä»–ç±»å‹çš„å€¼ä½œä¸ºé”®åã€‚\nconst map = new WeakMap(); map.set(1, 2) // TypeError: 1 is not an object! map.set(Symbol(), 2) map.set(null, 2) // TypeError: Invalid value used as weak map key ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœå°†æ•°å€¼ 1 å’Œ Symbolå€¼ä½œä¸º WeakMap çš„é”®åï¼Œéƒ½ä¼šæŠ¥é”™ã€‚\nWeakMap çš„ é”®åkey æ‰€æŒ‡å‘çš„å¯¹è±¡ï¼Œåƒåœ¾å›æ”¶æœºåˆ¶ä¸éœ€è¦è€ƒè™‘åœ¨å†…\nğŸ“ƒ Example\nconst e1 = document.getElementById(\u0026#39;foo\u0026#39;); const e2 = document.getElementById(\u0026#39;bar\u0026#39;); const arr = [ [e1, \u0026#39;foo å…ƒç´ \u0026#39;], [e2, \u0026#39;bar å…ƒç´ \u0026#39;], ]; ä¸Šé¢ä»£ç ä¸­ï¼Œe1 å’Œ e2 æ˜¯ä¸¤ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬é€šè¿‡ arr æ•°ç»„å¯¹è¿™ä¸¤ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›æ–‡å­—è¯´æ˜ã€‚è¿™å°±å½¢æˆäº† arr å¯¹ e1 å’Œ e2 çš„å¼•ç”¨ã€‚\nä¸€æ—¦ä¸å†éœ€è¦è¿™ä¸¤ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬å°±å¿…é¡» æ‰‹åŠ¨åˆ é™¤ è¿™ä¸ªå¼•ç”¨ï¼Œå¦åˆ™åƒåœ¾å›æ”¶æœºåˆ¶å°±ä¸ä¼šé‡Šæ”¾ e1 å’Œ e2 å ç”¨çš„å†…å­˜ã€‚\n// ä¸éœ€è¦e1å’Œe2çš„æ—¶å€™å¿…é¡»æ‰‹åŠ¨åˆ é™¤å¼•ç”¨ arr [0] = null; arr [1] = null; ä¸Šé¢è¿™æ ·çš„å†™æ³•æ˜¾ç„¶å¾ˆä¸æ–¹ä¾¿ã€‚ä¸€æ—¦å¿˜äº†å†™ï¼Œå°±ä¼šé€ æˆ å†…å­˜æ³„éœ² ã€‚\nWeakMap çš„è®¾è®¡ç›®çš„åœ¨äºï¼Œæœ‰æ—¶æˆ‘ä»¬æƒ³åœ¨æŸä¸ªå¯¹è±¡ä¸Šé¢å­˜æ”¾ä¸€äº›æ•°æ®ï¼Œä½†æ˜¯è¿™ä¼šå½¢æˆå¯¹äºè¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚WeakMap å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œè¯ç”Ÿçš„ï¼Œå®ƒçš„é”®åæ‰€å¼•ç”¨çš„å¯¹è±¡éƒ½æ˜¯ å¼±å¼•ç”¨ ï¼Œå³åƒåœ¾å›æ”¶æœºåˆ¶ä¸å°†è¯¥å¼•ç”¨è€ƒè™‘åœ¨å†…ã€‚å› æ­¤ï¼Œåªè¦æ‰€å¼•ç”¨çš„å¯¹è±¡çš„å…¶ä»–å¼•ç”¨éƒ½è¢«æ¸…é™¤ï¼Œåƒåœ¾å›æ”¶æœºåˆ¶å°±ä¼šé‡Šæ”¾è¯¥å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦ä¸å†éœ€è¦ï¼ŒWeakMap é‡Œé¢çš„é”®åå¯¹è±¡å’Œæ‰€å¯¹åº”çš„é”®å€¼å¯¹ä¼šè‡ªåŠ¨æ¶ˆå¤±ï¼Œä¸ç”¨æ‰‹åŠ¨åˆ é™¤å¼•ç”¨ã€‚\nåŸºæœ¬ä¸Šï¼Œå¦‚æœä½ è¦å¾€å¯¹è±¡ä¸Šæ·»åŠ æ•°æ®ï¼Œåˆä¸æƒ³å¹²æ‰°åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ WeakMapã€‚ä¸€ä¸ªå…¸å‹åº”ç”¨åœºæ™¯æ˜¯ï¼Œåœ¨ç½‘é¡µçš„ DOM å…ƒç´ ä¸Šæ·»åŠ æ•°æ®ï¼Œå°±å¯ä»¥ä½¿ç”¨ WeakMap ç»“æ„ã€‚å½“è¯¥ DOM å…ƒç´ è¢«æ¸…é™¤ï¼Œå…¶æ‰€å¯¹åº”çš„ WeakMap è®°å½•å°±ä¼šè‡ªåŠ¨è¢«ç§»é™¤ã€‚\nğŸ“ƒ Example\nconst wm = new WeakMap(); const e = document.getElementById(\u0026#39;example\u0026#39;); wm.set(e, \u0026#39;some information\u0026#39;); wm.get(e); // \u0026#34;some information\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼Œå…ˆæ–°å»ºä¸€ä¸ª Weakmap å®ä¾‹ã€‚ç„¶åï¼Œå°†ä¸€ä¸ª DOM èŠ‚ç‚¹ä½œä¸ºé”®åå­˜å…¥è¯¥å®ä¾‹ï¼Œå¹¶å°†ä¸€äº›é™„åŠ ä¿¡æ¯ä½œä¸ºé”®å€¼ï¼Œä¸€èµ·å­˜æ”¾åœ¨ WeakMap é‡Œé¢ã€‚è¿™æ—¶ï¼ŒWeakMap é‡Œé¢å¯¹ element çš„å¼•ç”¨å°±æ˜¯å¼±å¼•ç”¨ï¼Œä¸ä¼šè¢«è®¡å…¥åƒåœ¾å›æ”¶æœºåˆ¶ã€‚\nä¹Ÿå°±æ˜¯è¯´ï¼Œä¸Šé¢çš„ DOM èŠ‚ç‚¹å¯¹è±¡çš„ å¼•ç”¨è®¡æ•° æ˜¯ 1ï¼Œè€Œä¸æ˜¯ 2 ã€‚è¿™æ—¶ï¼Œä¸€æ—¦æ¶ˆé™¤å¯¹è¯¥èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œå®ƒå ç”¨çš„å†…å­˜å°±ä¼šè¢« åƒåœ¾å›æ”¶æœºåˆ¶garbage-recycle,GC é‡Šæ”¾ã€‚Weakmap ä¿å­˜çš„è¿™ä¸ª é”®å€¼å¯¹key-value ï¼Œä¹Ÿä¼šè‡ªåŠ¨æ¶ˆå¤± â‡’ å½“é”®å€¼value å¼•ç”¨è®¡æ•°Reference counting ä¸º 0 åï¼Œå€¼ä¹Ÿä¼šç›¸åº”è¢«æ¸…é™¤ã€‚\næ€»ä¹‹ï¼ŒWeakmap çš„ä¸“ç”¨åœºåˆå°±æ˜¯ï¼Œå®ƒçš„é”®æ‰€å¯¹åº”çš„å¯¹è±¡ï¼Œå¯èƒ½ä¼šåœ¨å°†æ¥æ¶ˆå¤±ã€‚Weakmap ç»“æ„æœ‰åŠ©äºé˜²æ­¢å†…å­˜æ³„æ¼ã€‚\næ³¨æ„ï¼ŒWeakmap å¼±å¼•ç”¨çš„åªæ˜¯ é”®åkey ï¼Œè€Œä¸æ˜¯ é”®å€¼valueã€‚é”®å€¼ä¾ç„¶æ˜¯æ­£å¸¸å¼•ç”¨ï¼ˆé‡æ–°å¤åˆ¶ä¸€ä»½æŒ‡é’ˆï¼‰ã€‚\nğŸ“ƒ Example\nconst wm = new WeakMap(); let key = {}; let obj = {foo: 1}; wm.set(key, obj); obj = null; wm.get(key); // Object {foo: 1} ä¸Šé¢ä»£ç ä¸­ï¼Œé”®å€¼ obj æ˜¯æ­£å¸¸å¼•ç”¨ã€‚æ‰€ä»¥ï¼Œå³ä½¿åœ¨ Weakmap å¤–éƒ¨æ¶ˆé™¤äº† obj çš„å¼•ç”¨ï¼ŒWeakmap å†…éƒ¨çš„å¼•ç”¨ä¾ç„¶å­˜åœ¨ã€‚\nè¯­æ³• WeakMap ä¸ Map åœ¨ API ä¸Šçš„åŒºåˆ«ä¸»è¦æ˜¯ä¸¤ä¸ªï¼Œä¸€æ˜¯æ²¡æœ‰ éå† æ“ä½œï¼ˆå³æ²¡æœ‰ keys()ã€values() å’Œ entries() æ–¹æ³•ï¼‰ï¼Œä¹Ÿæ²¡æœ‰ size å±æ€§ã€‚å› ä¸ºæ²¡æœ‰åŠæ³•åˆ—å‡ºæ‰€æœ‰é”®åï¼ŒæŸä¸ªé”®åæ˜¯å¦å­˜åœ¨å®Œå…¨ä¸å¯é¢„æµ‹ï¼Œè·Ÿåƒåœ¾å›æ”¶æœºåˆ¶æ˜¯å¦è¿è¡Œç›¸å…³ã€‚è¿™ä¸€åˆ»å¯ä»¥å–åˆ°é”®åï¼Œä¸‹ä¸€åˆ»åƒåœ¾å›æ”¶æœºåˆ¶çªç„¶è¿è¡Œäº†ï¼Œè¿™ä¸ªé”®åå°±æ²¡äº†ã€‚\nä¸ºäº†é˜²æ­¢å‡ºç°ä¸ç¡®å®šæ€§ï¼Œå°±ç»Ÿä¸€è§„å®šä¸èƒ½å–åˆ°é”®åã€‚äºŒæ˜¯æ— æ³•æ¸…ç©ºï¼Œå³ä¸æ”¯æŒ clear æ–¹æ³•ã€‚å› æ­¤ï¼ŒWeakMap åªæœ‰å››ä¸ªæ–¹æ³•å¯ç”¨ï¼š\nMap.prototype.get() Map.prototype.set() Map.prototype.has() Map.prototype.delete() const wm = new WeakMap(); // sizeã€forEachã€clear æ–¹æ³•éƒ½ä¸å­˜åœ¨ wm.size // undefined wm.forEach // undefined wm.clear // undefined ğŸ“ƒ Example WeakMap çš„ç¤ºä¾‹\nWeakMap çš„ä¾‹å­å¾ˆéš¾æ¼”ç¤ºï¼Œå› ä¸ºæ— æ³•è§‚å¯Ÿå®ƒé‡Œé¢çš„å¼•ç”¨ä¼šè‡ªåŠ¨æ¶ˆå¤±ã€‚æ­¤æ—¶ï¼Œå…¶ä»–å¼•ç”¨éƒ½è§£é™¤äº†ï¼Œå·²ç»æ²¡æœ‰å¼•ç”¨æŒ‡å‘ WeakMap çš„é”®åäº†ï¼Œå¯¼è‡´æ— æ³•è¯å®é‚£ä¸ªé”®åæ˜¯ä¸æ˜¯å­˜åœ¨ã€‚\nç”¨é€” å‰æ–‡è¯´è¿‡ï¼ŒWeakMap åº”ç”¨çš„å…¸å‹åœºåˆå°±æ˜¯ DOM èŠ‚ç‚¹ä½œä¸ºé”®åã€‚\nğŸ“ƒ Example\nä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚\nlet myWeakmap = new WeakMap(); myWeakmap.set( document.getElementById(\u0026#39;logo\u0026#39;), {timesClicked: 0}) ; document.getElementById(\u0026#39;logo\u0026#39;).addEventListener(\u0026#39;click\u0026#39;, function() { let logoData = myWeakmap.get(document.getElementById(\u0026#39;logo\u0026#39;)); logoData.timesClicked++; }, false); ä¸Šé¢ä»£ç ä¸­ï¼Œdocument.getElementById('logo')æ˜¯ä¸€ä¸ª DOM èŠ‚ç‚¹ï¼Œæ¯å½“å‘ç”Ÿclickäº‹ä»¶ï¼Œå°±æ›´æ–°ä¸€ä¸‹çŠ¶æ€ã€‚æˆ‘ä»¬å°†è¿™ä¸ªçŠ¶æ€ä½œä¸ºé”®å€¼æ”¾åœ¨ WeakMap é‡Œï¼Œå¯¹åº”çš„é”®åå°±æ˜¯è¿™ä¸ªèŠ‚ç‚¹å¯¹è±¡ã€‚ä¸€æ—¦è¿™ä¸ª DOM èŠ‚ç‚¹åˆ é™¤ï¼Œè¯¥çŠ¶æ€å°±ä¼šè‡ªåŠ¨æ¶ˆå¤±ï¼Œä¸å­˜åœ¨å†…å­˜æ³„æ¼é£é™©ã€‚\nè´ºå¸ˆä¿Šè€å¸ˆæç¤ºï¼Œå¦‚æœå¼•ç”¨æ‰€æŒ‡å‘çš„å€¼å ç”¨ç‰¹åˆ«å¤šçš„å†…å­˜ï¼Œå°±å¯ä»¥é€šè¿‡ Node.js çš„ process.memoryUsage æ–¹æ³•çœ‹å‡ºæ¥ã€‚æ ¹æ®è¿™ä¸ªæ€è·¯ï¼Œç½‘å‹vtxfè¡¥å……äº†ä¸‹é¢çš„ä¾‹å­ã€‚\né¦–å…ˆï¼Œæ‰“å¼€ Node å‘½ä»¤è¡Œã€‚\n$ node --expose-gc ä¸Šé¢ä»£ç ä¸­ï¼Œ--expose-gcå‚æ•°è¡¨ç¤ºå…è®¸æ‰‹åŠ¨æ‰§è¡Œåƒåœ¾å›æ”¶æœºåˆ¶ã€‚\nç„¶åï¼Œæ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚\n// æ‰‹åŠ¨æ‰§è¡Œä¸€æ¬¡åƒåœ¾å›æ”¶ï¼Œä¿è¯è·å–çš„å†…å­˜ä½¿ç”¨çŠ¶æ€å‡†ç¡® \u0026gt; global.gc(); undefined // æŸ¥çœ‹å†…å­˜å ç”¨çš„åˆå§‹çŠ¶æ€ï¼ŒheapUsed ä¸º 4M å·¦å³ \u0026gt; process.memoryUsage(); { rss: 21106688, heapTotal: 7376896, heapUsed: 4153936, external: 9059 } \u0026gt; let wm = new WeakMap(); undefined // æ–°å»ºä¸€ä¸ªå˜é‡ keyï¼ŒæŒ‡å‘ä¸€ä¸ª 5*1024*1024 çš„æ•°ç»„ \u0026gt; let key = new Array(5 * 1024 * 1024); undefined // è®¾ç½® WeakMap å®ä¾‹çš„é”®åï¼Œä¹ŸæŒ‡å‘ key æ•°ç»„ // è¿™æ—¶ï¼Œkey æ•°ç»„å®é™…è¢«å¼•ç”¨äº†ä¸¤æ¬¡ï¼Œ // å˜é‡ key å¼•ç”¨ä¸€æ¬¡ï¼ŒWeakMap çš„é”®åå¼•ç”¨äº†ç¬¬äºŒæ¬¡ // ä½†æ˜¯ï¼ŒWeakMap æ˜¯å¼±å¼•ç”¨ï¼Œå¯¹äºå¼•æ“æ¥è¯´ï¼Œå¼•ç”¨è®¡æ•°è¿˜æ˜¯1 \u0026gt; wm.set(key, 1); WeakMap {} \u0026gt; global.gc(); undefined // è¿™æ—¶å†…å­˜å ç”¨ heapUsed å¢åŠ åˆ° 45M äº† \u0026gt; process.memoryUsage(); { rss: 67538944, heapTotal: 7376896, heapUsed: 45782816, external: 8945 } // æ¸…é™¤å˜é‡ key å¯¹æ•°ç»„çš„å¼•ç”¨ï¼Œ // ä½†æ²¡æœ‰æ‰‹åŠ¨æ¸…é™¤ WeakMap å®ä¾‹çš„é”®åå¯¹æ•°ç»„çš„å¼•ç”¨ \u0026gt; key = null; null // å†æ¬¡æ‰§è¡Œåƒåœ¾å›æ”¶ \u0026gt; global.gc(); undefined // å†…å­˜å ç”¨ heapUsed å˜å› 4M å·¦å³ï¼Œ // å¯ä»¥çœ‹åˆ° WeakMap çš„é”®åå¼•ç”¨æ²¡æœ‰é˜»æ­¢ gc å¯¹å†…å­˜çš„å›æ”¶ \u0026gt; process.memoryUsage(); { rss: 20639744, heapTotal: 8425472, heapUsed: 3979792, external: 8956 } ä¸Šé¢ä»£ç ä¸­ï¼Œåªè¦å¤–éƒ¨çš„å¼•ç”¨æ¶ˆå¤±ï¼ŒWeakMap å†…éƒ¨çš„å¼•ç”¨ï¼Œå°±ä¼šè‡ªåŠ¨è¢«åƒåœ¾å›æ”¶æ¸…é™¤ã€‚ç”±æ­¤å¯è§ï¼Œæœ‰äº† WeakMap çš„å¸®åŠ©ï¼Œè§£å†³å†…å­˜æ³„æ¼å°±ä¼šç®€å•å¾ˆå¤šã€‚\nChrome æµè§ˆå™¨çš„ DevTools çš„ Memory é¢æ¿ï¼Œæœ‰ä¸€ä¸ªåƒåœ¾æ¡¶çš„æŒ‰é’®ï¼Œå¯ä»¥å¼ºåˆ¶åƒåœ¾å›æ”¶garbage collectã€‚è¿™ä¸ªæŒ‰é’®ä¹Ÿèƒ½ç”¨æ¥è§‚å¯Ÿ WeakMap é‡Œé¢çš„å¼•ç”¨æ˜¯å¦æ¶ˆå¤±ã€‚\nWeakMap çš„å¦ä¸€ä¸ªç”¨å¤„æ˜¯éƒ¨ç½²ç§æœ‰å±æ€§ã€‚\nğŸ“ƒ Example\nconst _counter = new WeakMap(); const _action = new WeakMap(); class Countdown { constructor(counter, action) { _counter.set(this, counter); _action.set(this, action); } dec() { let counter = _counter.get(this); if (counter \u0026lt; 1) return; counter--; _counter.set(this, counter); if (counter === 0) { _action.get(this)(); } } } const c = new Countdown(2, () =\u0026gt; console.log(\u0026#39;DONE\u0026#39;)); c.dec(); c.dec(); // DONE ä¸Šé¢ä»£ç ä¸­ï¼ŒCountdown ç±»çš„ä¸¤ä¸ªå†…éƒ¨å±æ€§ _counter å’Œ _action ï¼Œæ˜¯å®ä¾‹çš„å¼±å¼•ç”¨ï¼Œæ‰€ä»¥å¦‚æœåˆ é™¤å®ä¾‹ï¼Œå®ƒä»¬ä¹Ÿå°±éšä¹‹æ¶ˆå¤±ï¼Œä¸ä¼šé€ æˆå†…å­˜æ³„æ¼ã€‚\nProxy Proxy ç”¨äºä¿®æ”¹æŸäº›æ“ä½œçš„é»˜è®¤è¡Œä¸ºï¼Œç­‰åŒäºåœ¨è¯­è¨€å±‚é¢åšå‡ºä¿®æ”¹ï¼Œæ‰€ä»¥å±äºä¸€ç§ å…ƒç¼–ç¨‹ - meta programmingï¼Œå³å¯¹ç¼–ç¨‹è¯­è¨€è¿›è¡Œç¼–ç¨‹ã€‚\nProxy å¯ä»¥ç†è§£æˆï¼Œåœ¨ç›®æ ‡å¯¹è±¡ä¹‹å‰æ¶è®¾ä¸€å±‚â€œæ‹¦æˆªâ€ï¼Œå¤–ç•Œå¯¹è¯¥å¯¹è±¡çš„è®¿é—®ï¼Œéƒ½å¿…é¡»å…ˆé€šè¿‡è¿™å±‚æ‹¦æˆªï¼Œå› æ­¤æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥å¯¹å¤–ç•Œçš„è®¿é—®è¿›è¡Œè¿‡æ»¤å’Œæ”¹å†™ã€‚Proxy è¿™ä¸ªè¯çš„åŸæ„æ˜¯ä»£ç†ï¼Œç”¨åœ¨è¿™é‡Œè¡¨ç¤ºç”±å®ƒæ¥â€œä»£ç†â€æŸäº›æ“ä½œï¼Œå¯ä»¥è¯‘ä¸ºâ€œä»£ç†å™¨â€ï¼›åŒæ—¶ Proxy æ˜¯ä¸€ç§ç‰¹æ®Šçš„â€œå¥‡å¼‚å¯¹è±¡â€ã€‚å®ƒæ²¡æœ‰è‡ªå·±çš„å±æ€§ã€‚\nç±»ä¼¼äº C++ çš„ è¿ç®—ç¬¦é‡è½½ ã€‚\nflowchart LR O--\u0026gt;|get Proxy.text|P P--\u0026gt;|5|O[\u0026#34;operate\u0026#34;] T[\u0026#34;Target\u0026lt;br\u0026gt;test: 5\u0026#34;]-.-\u0026gt;P P[\u0026#34;Proxy\u0026#34;]-.-\u0026gt;T ä½œä¸ºæ„é€ å‡½æ•°ï¼ŒProxy æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š\nç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ‰€è¦ä»£ç†çš„ç›®æ ‡å¯¹è±¡targetï¼ˆä¸Šä¾‹æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ï¼‰ï¼Œå³å¦‚æœæ²¡æœ‰ Proxy çš„ä»‹å…¥ï¼Œæ“ä½œåŸæ¥è¦è®¿é—®çš„å°±æ˜¯è¿™ä¸ªå¯¹è±¡ï¼›\nç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ª é…ç½®å¯¹è±¡handler,{} ï¼Œå¯¹äºæ¯ä¸€ä¸ªè¢«ä»£ç†çš„æ“ä½œï¼Œéœ€è¦æä¾›ä¸€ä¸ªå¯¹åº”çš„å¤„ç†å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†æ‹¦æˆªå¯¹åº”çš„æ“ä½œã€‚\nğŸ“ƒ Example\nconst obj = new Proxy({}, { get(target, propKey, receiver) { // æ‹¦æˆªçš„å¯¹è±¡, ä¼ å…¥çš„å¯¹è±¡å±æ€§, è¢« Proxy ä»£ç†è™šæ‹ŸåŒ–çš„å¯¹è±¡ console.log(`getting ${propKey}!`); return Reflect.get( target, propKey, receiver ); // ä½¿ç”¨reflectä¼ å…¥æ•°æ® }, set(target, propKey, value, receiver) { console.log(`setting ${propKey}!`); return Reflect.set( target, propKey, value, receiver ); } }); ä¸Šé¢ä»£ç å¯¹ä¸€ä¸ªç©ºå¯¹è±¡æ¶è®¾äº†ä¸€å±‚æ‹¦æˆªï¼Œé‡å®šä¹‰äº†å±æ€§çš„è¯»å– get å’Œè®¾ç½® set è¡Œä¸ºã€‚è¿™é‡Œæš‚æ—¶å…ˆä¸è§£é‡Šå…·ä½“çš„è¯­æ³•ï¼Œåªçœ‹è¿è¡Œç»“æœã€‚å¯¹è®¾ç½®äº†æ‹¦æˆªè¡Œä¸ºçš„å¯¹è±¡ objï¼Œå»è¯»å†™å®ƒçš„å±æ€§ï¼Œå°±ä¼šå¾—åˆ°ä¸‹é¢çš„ç»“æœã€‚\nobj.count = 1 // setting count! ++obj.count // getting count! // setting count! ä¸Šé¢ä»£ç è¯´æ˜ï¼ŒProxy å®é™…ä¸Šé‡è½½overload äº†ç‚¹è¿ç®—ç¬¦ï¼Œå³ç”¨è‡ªå·±çš„å®šä¹‰è¦†ç›–äº†è¯­è¨€çš„åŸå§‹å®šä¹‰ã€‚\nES6 åŸç”Ÿæä¾› Proxy æ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆ Proxy å®ä¾‹ã€‚\nvar proxy = new Proxy(target, handler); Proxy å¯¹è±¡çš„æ‰€æœ‰ç”¨æ³•ï¼Œéƒ½æ˜¯ä¸Šé¢è¿™ç§å½¢å¼ï¼Œä¸åŒçš„åªæ˜¯ handler å‚æ•°çš„å†™æ³•ã€‚å…¶ä¸­ï¼Œnew Proxy() è¡¨ç¤ºç”Ÿæˆä¸€ä¸ª Proxy å®ä¾‹ï¼Œtarget å‚æ•°è¡¨ç¤ºæ‰€è¦æ‹¦æˆªçš„ç›®æ ‡å¯¹è±¡ï¼Œhandler å‚æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥å®šåˆ¶æ‹¦æˆªè¡Œä¸ºã€‚\nğŸ“ƒ Example\nä¸‹é¢æ˜¯å¦ä¸€ä¸ªæ‹¦æˆªè¯»å–å±æ€§è¡Œä¸ºçš„ä¾‹å­ã€‚\nconst proxy = new Proxy({}, { get: function (target, propKey) { return `proxy intercept [${propKey}]!`; } }); console.log( proxy.time, proxy.name, proxy.title // proxy intercepted [...]! ) æ³¨æ„ï¼Œè¦ä½¿å¾— Proxy èµ·ä½œç”¨ï¼Œå¿…é¡»é’ˆå¯¹ Proxy å®ä¾‹ï¼ˆä¸Šä¾‹æ˜¯Proxyå¯¹è±¡ï¼‰è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯é’ˆå¯¹ç›®æ ‡å¯¹è±¡ï¼ˆä¸Šä¾‹æ˜¯ç©ºå¯¹è±¡ï¼‰è¿›è¡Œæ“ä½œã€‚\nå¦‚æœ handler{} æ²¡æœ‰è®¾ç½®ä»»ä½•æ‹¦æˆªï¼Œé‚£å°±ç­‰åŒäºç›´æ¥é€šå‘åŸå¯¹è±¡ã€‚\nğŸ“ƒ Example\nconst target = {}; const handler = {}; const proxy = new Proxy(target, handler); proxy.a = \u0026#39;b\u0026#39;; console.log( target.a, // b target === proxy // false ) ä¸Šé¢ä»£ç ä¸­ï¼Œhandler{} æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œæ²¡æœ‰ä»»ä½•æ‹¦æˆªæ•ˆæœï¼Œè®¿é—®Proxy å°±ç­‰åŒäºè®¿é—® target ã€‚\nä¸€ä¸ªæŠ€å·§æ˜¯å°† Proxy å¯¹è±¡ï¼Œè®¾ç½®åˆ° object.proxy å±æ€§ï¼Œä»è€Œå¯ä»¥åœ¨ object å¯¹è±¡ä¸Šè°ƒç”¨ã€‚\nğŸ“ƒ Example\nconst target = Object.create(null); const handler = { get(target, propKey,receiver) { console.log(target,receiver); } }; const obj = {proxy: new Proxy(target, handler)}; obj.proxy.foo; // propKey foo visited. Proxy å®ä¾‹ä¹Ÿå¯ä»¥ä½œä¸ºå…¶ä»–å¯¹è±¡çš„ åŸå‹å¯¹è±¡prototypeï¼Œæ­¤æ—¶è‹¥ç›´æ¥è®¿é—®å¯¹è±¡çš„æ‰¾ä¸åˆ°ç›¸åº”å±æ€§æ—¶å°±å¯è¢«æ‹¦æˆªäº†ã€‚\nğŸ“ƒ Example\nconst proxy = new Proxy({}, { get(target, propKey) { if (propKey === \u0026#39;time\u0026#39;) return 35; } }); let obj = Object.create(proxy); console.log(obj.time) // 35 ä¸Šé¢ä»£ç ä¸­ï¼ŒProxy å¯¹è±¡æ˜¯ objå¯¹è±¡çš„åŸå‹ï¼Œobj å¯¹è±¡æœ¬èº«å¹¶æ²¡æœ‰ time å±æ€§ï¼Œæ‰€ä»¥æ ¹æ®åŸå‹é“¾ï¼Œä¼šåœ¨ Proxy å¯¹è±¡ä¸Šè¯»å–è¯¥å±æ€§ï¼Œå¯¼è‡´è¢«æ‹¦æˆªã€‚\nä½†ä¹Ÿæœ‰é—®é¢˜ï¼Œå½“å¯¹è±¡å­˜åœ¨ç›¸åº”å±æ€§ä¹‹åï¼ŒProxy å°±æ— æ³•è¿›è¡Œæ‹¦æˆªäº†ã€‚\nobj.time = 12; console.log(obj.time); // 12 åŒä¸€ä¸ªæ‹¦æˆªå™¨å‡½æ•°ï¼Œå¯ä»¥è®¾ç½®æ‹¦æˆªå¤šä¸ªæ“ä½œã€‚\nğŸ“ƒ Example\nconst handler = { get(target, name) { return name === \u0026#39;prototype\u0026#39; ? Object.prototype : `Hello, ${name}`; }, apply(target, thisBinding, args) { return args[0]; }, construct(target, args) { return {value: args[1]}; } }; const funProxy = new Proxy(function (x, y) { return x + y; }, handler); funProxy(1, 2) // 1 new funProxy(1, 2) // {value: 2} console.log( funProxy.prototype === Object.prototype, // true funProxy.foo === \u0026#34;Hello, foo\u0026#34;, // true ); å¯¹äºå¯ä»¥è®¾ç½®ã€ä½†æ²¡æœ‰è®¾ç½®æ‹¦æˆªçš„æ“ä½œï¼Œåˆ™ç›´æ¥è½åœ¨ç›®æ ‡å¯¹è±¡ä¸Šï¼ŒæŒ‰ç…§åŸå…ˆçš„æ–¹å¼äº§ç”Ÿç»“æœã€‚\nå¯¹äºå¯¹è±¡çš„å¤§å¤šæ•°æ“ä½œï¼ŒJavaScript è§„èŒƒä¸­éƒ½æœ‰ä¸€ä¸ª å†…éƒ¨æ–¹æ³• ï¼Œå®ƒæè¿°äº†æœ€åº•å±‚çš„å·¥ä½œæ–¹å¼ã€‚ ä¾‹å¦‚ [[Get]] ï¼Œç”¨äºè¯»å–å±æ€§çš„å†…éƒ¨æ–¹æ³•ã€ [[Set]] ï¼Œç”¨äºå†™å…¥å±æ€§çš„å†…éƒ¨æ–¹æ³•ï¼Œç­‰ç­‰ã€‚è¿™äº›æ–¹æ³•ä»…åœ¨è§„èŒƒä¸­ä½¿ç”¨ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥é€šè¿‡æ–¹æ³•åè°ƒç”¨å®ƒä»¬ã€‚\nProxy() é’©å­ä¼šæ‹¦æˆªè¿™äº›æ–¹æ³•çš„è°ƒç”¨ï¼Œå®ƒä»¬åœ¨ä¸‹è¡¨ä¸­åˆ—å‡ºã€‚\nå¯¹äºæ¯ä¸ªå†…éƒ¨æ–¹æ³•ï¼Œæ­¤è¡¨ä¸­éƒ½æœ‰ä¸€ä¸ªé’©å­ï¼šå¯ç”¨äºæ·»åŠ åˆ° new Proxy() æ—¶çš„ handler å‚æ•°ä¸­ä»¥æ‹¦æˆªæ“ä½œçš„æ–¹æ³•åç§°ï¼š\nå†…éƒ¨æ–¹æ³• Handler æ–¹æ³• [[Get]] get [[Set]] set [[HasProperty]] has [[Delete]] deleteProperty [[Call]] apply [[Construct]] construct [[GetPrototypeOf]] getPrototypeOf [[SetPrototypeOf]] setPrototypeOf [[IsExtensible]] isExtensible [[PreventExtensions]] preventExtensions [[DefineOwnProperty]] defineProperty [[GetOwnProperty]] getOwnPropertyDescriptor [[OwnPropertyKeys]] ownKeys æ–¹æ³• ä¸‹é¢æ˜¯ Proxy.handler æ”¯æŒçš„æ‹¦æˆªæ“ä½œä¸€è§ˆï¼Œä¸€å…± 13 ç§ï¼š\nProxy.handler. get(), set(), has(), deleteProperty(), ownKeys(), getOwnPropertyDescriptor(), defineProperty(), preventExtensions(), getPrototypeOf(), isExtensible(), setPrototypeOf(), apply(), construct()\nä½œä¸º Proxy.handler{} ä¼ å…¥çš„å‚æ•°ã€‚\nä¸‹é¢æ˜¯ä¸Šé¢è¿™äº›æ‹¦æˆªæ–¹æ³•çš„è¯¦ç»†ä»‹ç»ã€‚\nget() get(target, propKey, receiver)\nget æ–¹æ³•ç”¨äºæ‹¦æˆªæŸä¸ªå±æ€§çš„è¯»å–æ“ä½œï¼Œå¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œthis ä¸Šä¸‹æ–‡ç»‘å®šåœ¨ handler å¯¹è±¡ä¸Šï¼š\ntarget\nç›®æ ‡å¯¹è±¡\nproperty\nè¢«è·å–çš„å±æ€§å\nreceiver\nProxy æˆ–è€…ç»§æ‰¿ Proxy çš„å¯¹è±¡ï¼ˆä¸¥æ ¼åœ°è¯´ï¼Œæ˜¯æ“ä½œè¡Œä¸ºæ‰€é’ˆå¯¹çš„å¯¹è±¡ï¼‰ï¼Œå¯é€‰\nğŸ“ƒ Example\nconst person = {foo: \u0026#39;bar\u0026#39;}; const proxy = new Proxy(person, { get(target, propKey) { if (propKey in target) { // Object.in(), es5 return target[propKey]; } else { throw new ReferenceError(\u0026#34;Prop name \\\u0026#34;\u0026#34; + propKey + \u0026#34;\\\u0026#34; does not exist.\u0026#34;); } } }); console.log( proxy.foo, // bar proxy.bar // Prop name \u0026#34;name\u0026#34; does not exist. ) ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœè®¿é—®ç›®æ ‡å¯¹è±¡ä¸å­˜åœ¨çš„å±æ€§ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ReferenceError ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªæ‹¦æˆªå‡½æ•°ï¼Œè®¿é—®ä¸å­˜åœ¨çš„å±æ€§ï¼Œåªä¼šè¿”å› undefined ã€‚\nget æ–¹æ³•å¯ä»¥ç»§æ‰¿ã€‚\nğŸ“ƒ Example\nlet proto = new Proxy({}, { get(target, propertyKey, receiver) { console.log(\u0026#39;GET \u0026#39; + propertyKey); return target[propertyKey]; } }); let obj = Object.create(proto); console.log(obj.foo) // GET foo // undefined console.log(obj.foo); // bar ğŸ“ Note è®¾ç½®äº†å¯¹è±¡æˆå‘˜åï¼Œæˆå‘˜key ä¼šè‡ªåŠ¨è¦†ç›– åŸå‹prototype ï¼ŒProxy æ‹¦æˆªå¤±æ•ˆã€‚\nğŸ“ƒ Example\nä¸‹é¢çš„ä¾‹å­ä½¿ç”¨ get æ‹¦æˆªï¼Œå®ç°æ•°ç»„è¯»å–è´Ÿæ•°çš„ç´¢å¼•ã€‚\nlet createArray = (...elements) =\u0026gt; new Proxy(elements, { get(target, propKey, receiver) { let index = Number(propKey); if (index \u0026lt; 0) { propKey = String( target.length + index ); } return Reflect.get( target, propKey, receiver ); } }); let arr = createArray(\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;); console.log( arr[-1], // c arr[-2], // b arr[-3] // a ) ä¸Šé¢ä»£ç ä¸­ï¼Œæ•°ç»„çš„ä½ç½®å‚æ•°æ˜¯ -1 ï¼Œå°±ä¼šè¾“å‡ºæ•°ç»„çš„å€’æ•°ç¬¬ä¸€ä¸ªæˆå‘˜ã€‚\nåˆ©ç”¨ Proxy ï¼Œå¯ä»¥å°†è¯»å–å±æ€§çš„æ“ä½œ get() ï¼Œè½¬å˜ä¸ºæ‰§è¡ŒæŸä¸ªå‡½æ•°ï¼Œä»è€Œå®ç°å±æ€§çš„é“¾å¼æ“ä½œã€‚ ğŸ“ƒ Example\nconst pipe = value =\u0026gt; { const funcStack = []; const oProxy = new Proxy(method, { get(pipeObject, fnName, proxy) { if (fnName === \u0026#39;get\u0026#39;) { // é‡åˆ°è¯»å–æ“ä½œä¸€æ¬¡é€šè¿‡reduceé€’å½’è°ƒç”¨å®Œæ¯• return funcStack.reduce( function (val, fn) { // Array.prototype.reduce( // fun( // previousValue, // currentValue // ): previousValue // , previousValue // ) return fn(val); }, value); } funcStack.push(method[fnName]); return oProxy; } }); return oProxy; }; const method = { double: n =\u0026gt; n * 2, pow: n =\u0026gt; n * n, reverseInt: n =\u0026gt; n.toString().split(\u0026#34;\u0026#34;).reverse().join(\u0026#34;\u0026#34;) | 0 // | ä½è¿ç®—ç”¨äºè½¬ä¸ºint } console.log( pipe(3).double.pow.reverseInt.get // 63 ); ä¸Šé¢ä»£ç è®¾ç½® Proxy ä»¥åï¼Œè¾¾åˆ°äº†å°†å‡½æ•°åé“¾å¼ä½¿ç”¨çš„æ•ˆæœã€‚\n:link: Href [Array.prototype.reduce()](05 JavaScript#array-prototype-reduce-es5)\nä¸‹é¢çš„ä¾‹å­åˆ™æ˜¯åˆ©ç”¨ get æ‹¦æˆªï¼Œå®ç°ä¸€ä¸ªç”Ÿæˆå„ç§ DOM èŠ‚ç‚¹çš„é€šç”¨å‡½æ•° dom() ã€‚\nğŸ“ƒ Example\nconst dom = new Proxy({}, { get(target, property) { return function(attrs = {}, ...children) { const el = document.createElement(property); for (let prop of Object.keys(attrs)) { el.setAttribute(prop, attrs[prop]); } for (let child of children) { if (typeof child === \u0026#39;string\u0026#39;) { child = document.createTextNode(child); } el.appendChild(child); } return el; } } }); const el = dom.div({}, \u0026#39;Hello, my name is \u0026#39;, dom.a({href: \u0026#39;//example.com\u0026#39;}, \u0026#39;Mark\u0026#39;), \u0026#39;. I like:\u0026#39;, dom.ul({}, dom.li({}, \u0026#39;The web\u0026#39;), dom.li({}, \u0026#39;Food\u0026#39;), dom.li({}, \u0026#39;â€¦actually that\\\u0026#39;s it\u0026#39;) ) ); document.body.appendChild(el); ç”±äº WebStrom ä¼šå¯¹è°ƒç”¨å¯¹è±¡ä¸å­˜åœ¨çš„æˆå‘˜æå‡ºè­¦å‘Šï¼Œå› æ­¤è¿›è¡Œé‡å†™ï¼š\nconst dom = (tag, attrs = {}, ...children) =\u0026gt; { // console.log(\u0026#39;children\u0026#39;,children) const el = document.createElement(tag); for (let prop of Object.keys(attrs)) { el.setAttribute(prop, attrs[prop]); } for (let child of children) { // console.log(\u0026#39;child\u0026#39;,child) if (typeof child === \u0026#39;string\u0026#39;) { child = document.createTextNode(child); } el.appendChild(child); } return el; }; const el = dom(\u0026#39;div\u0026#39;, {}, \u0026#39;Hello, my name is \u0026#39;, dom(\u0026#39;a\u0026#39;, {href: \u0026#39;//example.com\u0026#39;}, \u0026#39;Mark\u0026#39;), // ä¼ å…¥çš„æ—¶å€™domå°±æ‰§è¡Œå¹¶ç”Ÿæˆäº†ç›¸åº”çš„htmlElement \u0026#39;. I like:\u0026#39;, dom(\u0026#39;ul\u0026#39;, {}, dom(\u0026#39;li\u0026#39;, {}, \u0026#39;The web\u0026#39;), dom(\u0026#39;li\u0026#39;, {}, \u0026#39;Food\u0026#39;), dom(\u0026#39;li\u0026#39;, {}, \u0026#39;â€¦actually that\\\u0026#39;s it\u0026#39;) ) ); document.body.appendChild(el); ä¸‹é¢æ˜¯ä¸€ä¸ª get æ–¹æ³•çš„ç¬¬ä¸‰ä¸ªå‚æ•°çš„ä¾‹å­ï¼Œå®ƒæ€»æ˜¯æŒ‡å‘åŸå§‹çš„è¯»æ“ä½œæ‰€åœ¨çš„é‚£ä¸ªå¯¹è±¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å°±æ˜¯ Proxy å®ä¾‹ã€‚\nğŸ“ƒ Example\nconst proxy = new Proxy({}, { get: function(target, key, receiver) { return receiver; } }); proxy.getReceiver === proxy // true ä¸Šé¢ä»£ç ä¸­ï¼ŒProxyå¯¹è±¡çš„ getReceiver å±æ€§æ˜¯ç”± Proxy å¯¹è±¡æä¾›çš„ï¼Œæ‰€ä»¥ receiver æŒ‡å‘ Proxy å¯¹è±¡ã€‚\nconst proxy = new Proxy({}, { get: function(target, key, receiver) { return receiver; } }); const d = Object.create(proxy); d.a === d // true ä¸Šé¢ä»£ç ä¸­ï¼Œd å¯¹è±¡æœ¬èº«æ²¡æœ‰ a å±æ€§ï¼Œæ‰€ä»¥è¯»å– d.açš„ æ—¶å€™ï¼Œä¼šå»d çš„åŸå‹ Proxy å¯¹è±¡æ‰¾ã€‚è¿™æ—¶ï¼Œreceiver å°±æŒ‡å‘ d ï¼Œä»£è¡¨åŸå§‹çš„è¯»æ“ä½œæ‰€åœ¨çš„é‚£ä¸ªå¯¹è±¡ã€‚\nå¦‚æœä¸€ä¸ªå±æ€§ ä¸å¯é…ç½®unconfigurable ä¸” ä¸å¯å†™unwritable ï¼Œåˆ™ Proxy ä¸èƒ½ä¿®æ”¹è¯¥å±æ€§ï¼Œå¦åˆ™é€šè¿‡ Proxy å¯¹è±¡è®¿é—®è¯¥å±æ€§ä¼šæŠ¥é”™ã€‚\n\u0026#39;use strict\u0026#39; const target = Object.defineProperties({}, { foo: { value: 123, writable: false, configurable: false }, }); const handler = { get(target, propKey) { return \u0026#39;abc\u0026#39;; } }; const proxy = new Proxy(target, handler); proxy.foo=\u0026#39;1\u0026#39;; // TypeError: Cannot assign to read only property \u0026#39;foo\u0026#39; of object \u0026#39;#\u0026lt;Object\u0026gt;\u0026#39; ğŸ“ Note åªæœ‰æ‰“å¼€ ä¸¥æ ¼æ¨¡å¼use strict æ‰ä¼šæŠ¥é”™ã€‚\nset() set(target, propKey, value, receiver)\nset æ–¹æ³•ç”¨æ¥æ‹¦æˆªæŸä¸ªå±æ€§çš„èµ‹å€¼æ“ä½œï¼Œå¯ä»¥æ¥å—å››ä¸ªå‚æ•°ï¼Œthis ç»‘å®šåœ¨ handler å¯¹è±¡ä¸Šï¼š\ntarget\nç›®æ ‡å¯¹è±¡\nproperty\nå°†è¢«è®¾ç½®çš„å±æ€§åæˆ– Symbol\nvalue\næ–°å±æ€§å€¼\nreceiver\næœ€åˆè¢«è°ƒç”¨çš„å¯¹è±¡ã€‚é€šå¸¸æ˜¯ proxy æœ¬èº«ï¼Œä½† handler çš„ set æ–¹æ³•ä¹Ÿæœ‰å¯èƒ½åœ¨ åŸå‹é“¾prototype ä¸Šï¼Œæˆ–ä»¥å…¶ä»–æ–¹å¼è¢«é—´æ¥åœ°è°ƒç”¨ï¼ˆå› æ­¤ä¸ä¸€å®šæ˜¯ proxy æœ¬èº«ï¼‰ï¼Œå¯é€‰\nğŸ“ƒ Example\nå‡å®š Person å¯¹è±¡æœ‰ä¸€ä¸ª age å±æ€§ï¼Œè¯¥å±æ€§åº”è¯¥æ˜¯ä¸€ä¸ªä¸å¤§äº 200 çš„æ•´æ•°ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ Proxy ä¿è¯ age çš„å±æ€§å€¼ç¬¦åˆè¦æ±‚ã€‚\nlet validator = { set: function (obj, prop, value) { if (prop === \u0026#39;age\u0026#39;) { if (!Number.isInteger(value)) { throw new TypeError(\u0026#39;The age is not an integer\u0026#39;); } if (value \u0026gt; 200) { throw new RangeError(\u0026#39;The age seems invalid\u0026#39;); } } // å¯¹äºæ»¡è¶³æ¡ä»¶çš„ age å±æ€§ä»¥åŠå…¶ä»–å±æ€§ï¼Œç›´æ¥ä¿å­˜ obj[prop] = value; } }; let person = new Proxy({}, validator); person.age = 100; // OK person.age = \u0026#39;young\u0026#39; // TypeError person.age = 300 // RangeError ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äºè®¾ç½®äº†å­˜å€¼å‡½æ•° set ï¼Œä»»ä½•ä¸ç¬¦åˆè¦æ±‚çš„ age å±æ€§èµ‹å€¼ï¼Œéƒ½ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¿™æ˜¯æ•°æ®éªŒè¯çš„ä¸€ç§å®ç°æ–¹æ³•ã€‚åˆ©ç”¨ set æ–¹æ³•ï¼Œè¿˜å¯ä»¥æ•°æ®ç»‘å®šï¼Œå³æ¯å½“å¯¹è±¡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè‡ªåŠ¨æ›´æ–° DOMã€‚\næœ‰æ—¶ï¼Œæˆ‘ä»¬ä¼šåœ¨å¯¹è±¡ä¸Šé¢è®¾ç½®å†…éƒ¨å±æ€§ï¼Œå±æ€§åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä½¿ç”¨ä¸‹åˆ’çº¿å¼€å¤´ï¼Œè¡¨ç¤ºè¿™äº›å±æ€§ä¸åº”è¯¥è¢«å¤–éƒ¨ä½¿ç”¨ã€‚ç»“åˆ get å’Œ set æ–¹æ³•ï¼Œå°±å¯ä»¥åšåˆ°é˜²æ­¢è¿™äº›å†…éƒ¨å±æ€§è¢«å¤–éƒ¨è¯»å†™ã€‚\nconst handler = { get (target, key) { invariant(key, \u0026#39;get\u0026#39;); return target[key]; }, set (target, key, value) { invariant(key, \u0026#39;set\u0026#39;); target[key] = value; return true; } }; function invariant (key, action) { if (key[0] === \u0026#39;_\u0026#39;) { throw new Error(`Invalid attempt to ${action} private \u0026#34;${key}\u0026#34; property`); } } const target = {}; const proxy = new Proxy(target, handler); proxy._prop // Error: Invalid attempt to get private \u0026#34;_prop\u0026#34; property proxy._prop = \u0026#39;c\u0026#39; // Error: Invalid attempt to set private \u0026#34;_prop\u0026#34; property ä¸Šé¢ä»£ç ä¸­ï¼Œåªè¦è¯»å†™çš„å±æ€§åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ä¸‹åˆ’çº¿ï¼Œä¸€å¾‹æŠ›é”™ï¼Œä»è€Œè¾¾åˆ°ç¦æ­¢è¯»å†™å†…éƒ¨å±æ€§çš„ç›®çš„ã€‚\nğŸ“ƒ Example\nä¸‹é¢æ˜¯ set æ–¹æ³•ç¬¬å››ä¸ªå‚æ•°çš„ä¾‹å­ã€‚\nconst handler = { set(obj, prop, value, receiver) { obj[prop] = receiver; } }; const proxy = new Proxy({}, handler); proxy.foo = \u0026#39;bar\u0026#39;; console.log( proxy.foo === proxy, // true proxy.foo // Proxy {foo: Proxy} ); ä¸Šé¢ä»£ç ä¸­ï¼Œset æ–¹æ³•çš„ç¬¬å››ä¸ªå‚æ•° receiver ï¼ŒæŒ‡çš„æ˜¯åŸå§‹çš„æ“ä½œè¡Œä¸ºæ‰€åœ¨çš„é‚£ä¸ªå¯¹è±¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ Proxy å®ä¾‹æœ¬èº«ï¼Œè¯·çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚\nğŸ“ƒ Example\nconst handler = { set: function (obj, prop, value, receiver) { obj[prop] = receiver; } }; const proxy = new Proxy({}, handler); const myObj = {}; Object.setPrototypeOf(myObj, proxy); myObj.foo = \u0026#39;bar\u0026#39;; console.log( myObj.foo === myObj, // true myObj.foo, // {} myObj // {} ); ä¸Šé¢ä»£ç ä¸­ï¼Œè®¾ç½® myObj.foo å±æ€§çš„å€¼æ—¶ï¼Œ myObj å¹¶æ²¡æœ‰ foo å±æ€§ï¼Œå› æ­¤å¼•æ“ä¼šåˆ° myObj çš„åŸå‹é“¾å»æ‰¾ foo å±æ€§ã€‚ myObj çš„åŸå‹å¯¹è±¡ Proxy æ˜¯ä¸€ä¸ª Proxy å®ä¾‹ï¼Œè®¾ç½®å®ƒçš„ foo å±æ€§ä¼šè§¦å‘ set æ–¹æ³•ã€‚è¿™æ—¶ï¼Œç¬¬å››ä¸ªå‚æ•° receiver å°±æŒ‡å‘ åŸå§‹èµ‹å€¼è¡Œä¸º æ‰€åœ¨çš„å¯¹è±¡ myObj ï¼Œè€Œä¸æ˜¯ åŸå‹é“¾prototype ä¸Šçš„å¯¹è±¡ã€‚\nğŸ“ Note\næ³¨æ„ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡è‡ªèº«çš„æŸä¸ªå±æ€§ï¼Œä¸å¯å†™writable:false ä¸” ä¸å¯é…ç½®configurable:false ï¼Œé‚£ä¹ˆ set æ–¹æ³•å°†ä¸èµ·ä½œç”¨ã€‚\nğŸ“ƒ Example\nconst obj = {}; Object.defineProperty(obj, \u0026#39;foo\u0026#39;, { value: \u0026#39;bar\u0026#39;, writable: false, }); const handler = { set: function (obj, prop, value, receiver) { obj[prop] = \u0026#39;baz\u0026#39;; } }; const proxy = new Proxy(obj, handler); proxy.foo = \u0026#39;baz\u0026#39;; console.log(proxy.foo); // \u0026#34;bar\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼Œobj.foo å±æ€§ä¸å¯å†™ï¼Œå› æ­¤ Proxy å¯¹è¿™ä¸ªå±æ€§çš„ set ä»£ç†å°†ä¸ä¼šç”Ÿæ•ˆã€‚\nâš ï¸ Caution ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œset ä»£ç†å¦‚æœæ²¡æœ‰è¿”å› true ï¼Œå°±ä¼šæŠ¥é”™ã€‚\nğŸ“ƒ Example\n\u0026#39;use strict\u0026#39;; const handler = { set: function (obj, prop, value, receiver) { obj[prop] = receiver; // æ— è®ºæœ‰æ²¡æœ‰ä¸‹é¢è¿™ä¸€è¡Œï¼Œéƒ½ä¼šæŠ¥é”™ return false; } }; const proxy = new Proxy({}, handler); proxy.foo = \u0026#39;bar\u0026#39;; // TypeError: \u0026#39;set\u0026#39; on proxy: trap returned falsish for property \u0026#39;foo\u0026#39; ä¸Šé¢ä»£ç ä¸­ï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œset ä»£ç†è¿”å› false æˆ–è€… undefined ï¼Œéƒ½ä¼šæŠ¥é”™ã€‚\nhas() has(target, propKey)\nhas() æ–¹æ³•ç”¨æ¥æ‹¦æˆª HasProperty æ“ä½œï¼Œå³åˆ¤æ–­å¯¹è±¡æ˜¯å¦å…·æœ‰æŸä¸ªå±æ€§æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šç”Ÿæ•ˆã€‚å…¸å‹çš„æ“ä½œå°±æ˜¯ in è¿ç®—ç¬¦ã€‚\nå¯ä»¥æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ ç›®æ ‡å¯¹è±¡target ã€éœ€æŸ¥è¯¢çš„å±æ€§åpropKeyã€‚\n:link: Href [Object in operator](05 JavaScript#object-in-operator-es5)\nğŸ“ƒ Example\nä¸‹é¢çš„ä¾‹å­ä½¿ç”¨ has() æ–¹æ³•éšè—æŸäº›å±æ€§ï¼Œä¸è¢« in è¿ç®—ç¬¦å‘ç°ã€‚\nconst handler = { has(target, key) { if (key[0] === \u0026#39;_\u0026#39;) { // jså…è®¸é€šè¿‡ä¸‹æ ‡ç›´æ¥è®¿é—®æ•°ç»„ return false; } return key in target; } }; const target = {_prop: \u0026#39;foo\u0026#39;, prop: \u0026#39;foo\u0026#39;}; const proxy = new Proxy(target, handler); console.log(\u0026#39;_prop\u0026#39; in proxy); // false ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœåŸå¯¹è±¡çš„å±æ€§åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ä¸‹åˆ’çº¿ï¼Œproxy.has() å°±ä¼šè¿”å› false ï¼Œä»è€Œä¸ä¼šè¢« in è¿ç®—ç¬¦å‘ç°ã€‚\nå¦‚æœåŸå¯¹è±¡ä¸å¯é…ç½®æˆ–è€…ç¦æ­¢æ‰©å±•ï¼Œè¿™æ—¶ has() æ‹¦æˆªä¼šæŠ¥é”™ã€‚\nğŸ“ƒ Example\nconst obj = {a: 10}; Object.preventExtensions(obj); const p = new Proxy(obj, { has: function (target, prop) { return false; } }); \u0026#39;a\u0026#39; in p // TypeError is thrown ä¸Šé¢ä»£ç ä¸­ï¼Œobj å¯¹è±¡ç¦æ­¢æ‰©å±•ï¼Œç»“æœä½¿ç”¨ has æ‹¦æˆªå°±ä¼šæŠ¥é”™ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæŸä¸ªå±æ€§ä¸å¯é…ç½®configurable:false ï¼Œåˆ™ has() æ–¹æ³•å°±ä¸å¾—â€œéšè—â€ï¼ˆå³è¿”å›falseï¼‰ç›®æ ‡å¯¹è±¡çš„è¯¥å±æ€§ã€‚\nå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œhas() æ–¹æ³•æ‹¦æˆªçš„æ˜¯ HasProperty æ“ä½œï¼Œè€Œä¸æ˜¯ HasOwnProperty æ“ä½œï¼Œå³ has() æ–¹æ³•ä¸åˆ¤æ–­ä¸€ä¸ªå±æ€§æ˜¯å¯¹è±¡è‡ªèº«çš„å±æ€§ï¼Œè¿˜æ˜¯ç»§æ‰¿çš„å±æ€§ã€‚\nå¦å¤–ï¼Œè™½ç„¶ for-in å¾ªç¯ä¹Ÿç”¨åˆ°äº† in è¿ç®—ç¬¦ï¼Œä½†æ˜¯ has() æ‹¦æˆªå¯¹ for-in å¾ªç¯ä¸ç”Ÿæ•ˆã€‚\nğŸ“ƒ Example\nlet stu1 = {name: \u0026#39;å¼ ä¸‰\u0026#39;, score: 59}; let stu2 = {name: \u0026#39;æå››\u0026#39;, score: 99}; let handler = { has(target, prop) { if (prop === \u0026#39;score\u0026#39; \u0026amp;\u0026amp; target[prop] \u0026lt; 60) { console.log(`${target.name} ä¸åŠæ ¼`); return false; } return prop in target; } } let oProxy1 = new Proxy(stu1, handler); let oProxy2 = new Proxy(stu2, handler); console.log( \u0026#39;score\u0026#39; in oProxy1, // å¼ ä¸‰ ä¸åŠæ ¼ false \u0026#39;score\u0026#39; in oProxy2 // true ); for (let a in oProxy1) { console.log(oProxy1[a]); // å¼ ä¸‰ 59 } for (let b in oProxy2) { console.log(oProxy2[b]); // æå›› 99 } ä¸Šé¢ä»£ç ä¸­ï¼Œhas() æ‹¦æˆªåªå¯¹inè¿ç®—ç¬¦ç”Ÿæ•ˆï¼Œå¯¹ for-in å¾ªç¯ä¸ç”Ÿæ•ˆï¼Œå¯¼è‡´ä¸ç¬¦åˆè¦æ±‚çš„å±æ€§æ²¡æœ‰è¢« for-in å¾ªç¯æ‰€æ’é™¤ã€‚\napply() apply(target, object, args)\napply æ–¹æ³•æ‹¦æˆªå‡½æ•°çš„è°ƒç”¨ã€call() å’Œ apply() æ“ä½œã€‚\napply æ–¹æ³•å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ ç›®æ ‡å¯¹è±¡target ã€ç›®æ ‡å¯¹è±¡çš„ ä¸Šä¸‹æ–‡å¯¹è±¡this å’Œç›®æ ‡å¯¹è±¡çš„ å‚æ•°æ•°ç»„argsã€‚\nvar handler = { apply (target, ctx, args) { return Reflect.apply(...arguments); } }; ğŸ“ƒ Example ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚\nconst target = function () { return \u0026#39;I am the target\u0026#39;; }; const handler = { apply: function (target, thisObj, theArgs) { console.log(\u0026#39;theArgs:\u0026#39;, theArgs); console.log(\u0026#39;target:\u0026#39;, target); // Æ’ target: [Function: target] console.log(\u0026#39;thisObj:\u0026#39;, thisObj); // thisObj: undefined // thisObj: { this: { foo: \u0026#39;bar\u0026#39; } } return \u0026#39;I am the proxy\u0026#39;; } }; const p = new Proxy(target, handler); console.log( p(), // theArgs: [] p.apply( {this: {foo: \u0026#39;bar\u0026#39;}}, [\u0026#39;arg0\u0026#39;, \u0026#39;arg1\u0026#39;] ), p.call( {this: {foo: \u0026#39;bar\u0026#39;}}, \u0026#39;arg0\u0026#39;, \u0026#39;arg1\u0026#39; ) // theArgs: [ \u0026#39;arg0\u0026#39;, \u0026#39;arg1\u0026#39; ] ); // \u0026#34;I am the proxy\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡ p æ˜¯ Proxy çš„å®ä¾‹ï¼Œå½“å®ƒä½œä¸ºå‡½æ•°è°ƒç”¨æ—¶ï¼ˆp()ï¼‰ï¼Œä¸€æ ·ä¼šè¢« apply() æ–¹æ³•æ‹¦æˆªï¼Œè¿”å›ä¸€ä¸ª å­—ç¬¦ä¸²stringã€‚\nğŸ“ƒ Example\nä¸‹é¢æ˜¯å¦å¤–ä¸€ä¸ªä¾‹å­ã€‚\nconst twice = { apply(target, ctx, args) { return Reflect.apply(...arguments) * 2; } }; function sum(left, right) { return left + right; } const proxy = new Proxy(sum, twice); console.log( proxy(1, 2), // 6 proxy.call(null, 5, 6), // 22 proxy.apply(null, [7, 8]) // 30 ) ä¸Šé¢ä»£ç ä¸­ï¼Œæ¯å½“æ‰§è¡ŒProxy å‡½æ•°ï¼ˆç›´æ¥è°ƒç”¨æˆ– call() å’Œ apply() è°ƒç”¨ï¼‰ï¼Œå°±ä¼šè¢« apply() æ–¹æ³•æ‹¦æˆªã€‚\nå¦å¤–ï¼Œç›´æ¥è°ƒç”¨ Reflect.apply æ–¹æ³•ï¼Œä¹Ÿä¼šè¢«æ‹¦æˆªã€‚\nReflect.apply(proxy, null, [9, 10]) // 3 construct() construct(target, args)\nç”¨äºæ‹¦æˆª new å‘½ä»¤ï¼Œä¸‹é¢æ˜¯æ‹¦æˆªå¯¹è±¡çš„å†™æ³•ã€‚\nconst handler = { construct(target, args, newTarget) { return new target(...args); } }; å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ï¼š\ntargetï¼šç›®æ ‡å¯¹è±¡\nargsï¼šæ„é€ å‡½æ•°çš„å‚æ•°æ•°ç»„\nnewTargetï¼šåˆ›é€ å®ä¾‹å¯¹è±¡æ—¶ï¼Œnew å‘½ä»¤ä½œç”¨çš„æ„é€ å‡½æ•°ï¼ˆä¸‹é¢ä¾‹å­çš„p ï¼Œå³ Proxy ä»£ç†åçš„å¯¹è±¡ï¼‰\nğŸ“ƒ Example\nconst p = new Proxy(function () { }, { construct: function (target, args) { console.log(args) console.log(`called:${args}`); return {value: args[0] * 10}; } }); console.log((new p(1, 2)).value); // called:1 10 construct() æ–¹æ³•è¿”å›çš„å¿…é¡»æ˜¯ä¸€ä¸ª å¯¹è±¡object ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚\nconst p = new Proxy(function() {}, { construct: function(target, argumentsList) { return 1; } }); new p() // æŠ¥é”™ // Uncaught TypeError: \u0026#39;construct\u0026#39; on proxy: trap returned non-object (\u0026#39;1\u0026#39;) å¦å¤–ï¼Œç”±äº construct() æ‹¦æˆªçš„æ˜¯æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥å®ƒçš„ç›®æ ‡å¯¹è±¡å¿…é¡»æ˜¯å‡½æ•°ï¼Œå¦åˆ™å°±ä¼šæŠ¥é”™ã€‚è€Œä¸”ä¸æ”¯æŒ ç®­å¤´å‡½æ•°()=\u0026gt;{} ã€‚\nğŸ“ƒ Example\nconst p = new Proxy({}, { construct: function(target, argumentsList) { return {}; } }); new p(); // æŠ¥é”™ // Uncaught TypeError: p is not a constructor ä¸Šé¢ä¾‹å­ä¸­ï¼Œæ‹¦æˆªçš„ç›®æ ‡å¯¹è±¡ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆnew Proxy()çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼‰ï¼Œå¯¼è‡´æŠ¥é”™ã€‚\næ³¨æ„ï¼Œconstruct() æ–¹æ³•ä¸­çš„ this æŒ‡å‘çš„æ˜¯ handler ï¼Œè€Œä¸æ˜¯å®ä¾‹å¯¹è±¡ã€‚\nconst handler = { construct: function(target, args) { console.log(this === handler); return new target(...args); } } let p = new Proxy(function () {}, handler); new p() // true deleteProperty() deleteProperty(target, propKey)\ndeletePropertyæ–¹æ³•ç”¨äºæ‹¦æˆª delete æ“ä½œï¼Œå¦‚æœè¿™ä¸ªæ–¹æ³•æŠ›å‡ºé”™è¯¯æˆ–è€…è¿”å› false ï¼Œå½“å‰å±æ€§å°±æ— æ³•è¢« delete å‘½ä»¤åˆ é™¤ã€‚\nconst handler = { deleteProperty(target, key) { invariant(key, \u0026#39;delete\u0026#39;); delete target[key]; return true; } }; function invariant(key, action) { if (key[0] === \u0026#39;_\u0026#39;) { throw new Error(`Invalid attempt to ${action} private \u0026#34;${key}\u0026#34; property`); } } const target = {_prop: \u0026#39;foo\u0026#39;}; const proxy = new Proxy(target, handler); delete proxy._prop // Error: Invalid attempt to delete private \u0026#34;_prop\u0026#34; property ä¸Šé¢ä»£ç ä¸­ï¼ŒdeletePropertyæ–¹æ³•æ‹¦æˆªäº† delete æ“ä½œç¬¦ï¼Œåˆ é™¤ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºä¸‹åˆ’çº¿çš„å±æ€§ä¼šæŠ¥é”™ã€‚\nâš ï¸ Caution\næ³¨æ„ï¼Œç›®æ ‡å¯¹è±¡è‡ªèº«é…ç½® ä¸å¯é…ç½®unconfigurable çš„å±æ€§åï¼Œä¸èƒ½è¢« deleteProperty æ–¹æ³•åˆ é™¤ï¼Œå¦åˆ™æŠ¥é”™ã€‚\ndefineProperty() defineProperty(target, propKey, propDesc)\ndefineProperty() æ–¹æ³•æ‹¦æˆªäº† Object.defineProperty() æ“ä½œã€‚\n:link: Href [Object.defineProperty()](05 JavaScript#object-defineProperty-es5)\nğŸ“ƒ Example\nconst handler = { defineProperty(target, key, descriptor) { return false; } }; const target = {}; const proxy = new Proxy(target, handler); proxy.foo = \u0026#39;bar\u0026#39; // ä¸ä¼šç”Ÿæ•ˆ console.log(proxy.foo); // undefined ä¸Šé¢ä»£ç ä¸­ï¼ŒdefineProperty() æ–¹æ³•å†…éƒ¨æ²¡æœ‰ä»»ä½•æ“ä½œï¼Œåªè¿”å›falseï¼Œå¯¼è‡´æ·»åŠ æ–°å±æ€§æ€»æ˜¯æ— æ•ˆã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„ false åªæ˜¯ç”¨æ¥æç¤ºæ“ä½œå¤±è´¥ï¼Œæœ¬èº«å¹¶ä¸èƒ½é˜»æ­¢æ·»åŠ æ–°å±æ€§ã€‚ï¼ˆå¯ä»¥é€šè¿‡æŠ›å‡ºå¼‚å¸¸é˜»æ­¢ï¼‰\nğŸ“ Note æ³¨æ„ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡ ä¸å¯æ‰©å±•non-extensible ï¼Œåˆ™ defineProperty() ä¸èƒ½å¢åŠ ç›®æ ‡å¯¹è±¡ä¸Šä¸å­˜åœ¨çš„å±æ€§ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚å¦å¤–ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡çš„æŸä¸ªå±æ€§ä¸å¯å†™unwritable æˆ–ä¸å¯é…ç½®unconfigurableï¼Œåˆ™ defineProperty() æ–¹æ³•ä¸å¾—æ”¹å˜è¿™ä¸¤ä¸ªè®¾ç½®ã€‚\ngetOwnPropertyDescriptor() getOwnPropertyDescriptor(target, propKey)\ngetOwnPropertyDescriptor() æ–¹æ³•æ‹¦æˆª Object.getOwnPropertyDescriptor() ï¼Œè¿”å›ä¸€ä¸ªå±æ€§æè¿°å¯¹è±¡æˆ–è€… undefined ã€‚\nvar handler = { getOwnPropertyDescriptor (target, key) { if (key[0] === \u0026#39;_\u0026#39;) { return; } return Object.getOwnPropertyDescriptor(target, key); } }; var target = { _foo: \u0026#39;bar\u0026#39;, baz: \u0026#39;tar\u0026#39; }; var proxy = new Proxy(target, handler); Object.getOwnPropertyDescriptor(proxy, \u0026#39;wat\u0026#39;) // undefined Object.getOwnPropertyDescriptor(proxy, \u0026#39;_foo\u0026#39;) // undefined Object.getOwnPropertyDescriptor(proxy, \u0026#39;baz\u0026#39;) // { value: \u0026#39;tar\u0026#39;, writable: true, enumerable: true, configurable: true } ä¸Šé¢ä»£ç ä¸­ï¼Œhandler.getOwnPropertyDescriptor() æ–¹æ³•å¯¹äºç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºä¸‹åˆ’çº¿çš„å±æ€§åä¼šè¿”å› undefined ã€‚\ngetPrototypeOf() getPrototypeOf(target)\ngetPrototypeOf() æ–¹æ³•ä¸»è¦ç”¨æ¥æ‹¦æˆªè·å–å¯¹è±¡åŸå‹ã€‚å…·ä½“æ¥è¯´ï¼Œæ‹¦æˆªä¸‹é¢è¿™äº›æ“ä½œã€‚\nObject.prototype.__proto__ Object.prototype.isPrototypeOf() Object.getPrototypeOf() Reflect.getPrototypeOf() instanceof ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚\nğŸ“ƒ Example\nconst proto = {}; const p = new Proxy({}, { getPrototypeOf(target) { return proto; } }); console.log(Object.getPrototypeOf(p) === proto); // true ä¸Šé¢ä»£ç ä¸­ï¼ŒgetPrototypeOf() æ–¹æ³•æ‹¦æˆª Object.getPrototypeOf() ï¼Œè¿”å› proto å¯¹è±¡ã€‚\nğŸ“ Note\ngetPrototypeOf() æ–¹æ³•çš„è¿”å›å€¼å¿…é¡»æ˜¯ å¯¹è±¡object æˆ– null ï¼Œå¦åˆ™æŠ¥é”™ã€‚å¦å¤–ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡ä¸å¯æ‰©å±•non-extensibleï¼Œ getPrototypeOf() æ–¹æ³•å¿…é¡»è¿”å›ç›®æ ‡å¯¹è±¡çš„åŸå‹å¯¹è±¡?ã€‚\nsetPrototypeOf() setPrototypeOf(target, proto)\nsetPrototypeOf() æ–¹æ³•ä¸»è¦ç”¨æ¥æ‹¦æˆª Object.setPrototypeOf() æ–¹æ³•ã€‚\nğŸ“ƒ Example\nconst handler = { setPrototypeOf(target, proto) { throw new Error(\u0026#39;Changing the prototype is forbidden\u0026#39;); } }; const proto = {}; const target = function () { }; const proxy = new Proxy(target, handler); Object.setPrototypeOf(proxy, proto); // Error: Changing the prototype is forbidden ä¸Šé¢ä»£ç ä¸­ï¼Œåªè¦ä¿®æ”¹ target çš„åŸå‹å¯¹è±¡prototypeï¼Œå°±ä¼šæŠ¥é”™ã€‚\nâš ï¸ Caution è¯¥æ–¹æ³•åªèƒ½è¿”å› boolean ï¼Œå¦åˆ™ä¼šè¢«è‡ªåŠ¨è½¬ä¸º boolean ã€‚å¦å¤–ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡ä¸å¯æ‰©å±•non-extensible ï¼ŒsetPrototypeOf()æ–¹æ³•ä¸å¾—æ”¹å˜ç›®æ ‡å¯¹è±¡çš„åŸå‹ã€‚\nisExtensible() isExtensible(target)\nisExtensible() æ–¹æ³•æ‹¦æˆª Object.isExtensible() æ“ä½œã€‚\nconst p = new Proxy({}, { isExtensible: function(target) { console.log(\u0026#34;called\u0026#34;); return true; } }); Object.isExtensible(p) // \u0026#34;called\u0026#34; // true ä¸Šé¢ä»£ç è®¾ç½®äº† isExtensible() æ–¹æ³•ï¼Œåœ¨è°ƒç”¨ Object.isExtensible æ—¶ä¼šè¾“å‡ºcalledã€‚\nğŸ“ Note æ³¨æ„ï¼Œè¯¥æ–¹æ³•åªèƒ½è¿”å› boolean ï¼Œå¦åˆ™è¿”å›å€¼ä¼šè¢«è‡ªåŠ¨è½¬ä¸º boolean ã€‚\nè¿™ä¸ªæ–¹æ³•æœ‰ä¸€ä¸ªå¼ºé™åˆ¶ï¼Œå®ƒçš„è¿”å›å€¼å¿…é¡»ä¸ç›®æ ‡å¯¹è±¡çš„ isExtensible å±æ€§ä¿æŒ ä¸€è‡´ ï¼Œå¦åˆ™å°±ä¼šæŠ›å‡ºé”™è¯¯ã€‚\nObject.isExtensible(proxy) === Object.isExtensible(target) ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚\nğŸ“ƒ Example\nvar p = new Proxy({}, { isExtensible: function(target) { return false; } }); Object.isExtensible(p) // Uncaught TypeError: \u0026#39;isExtensible\u0026#39; on proxy: trap result does not reflect extensibility of proxy target (which is \u0026#39;true\u0026#39;) ownKeys() ownKeys(target)\nownKeys() æ–¹æ³•ç”¨æ¥æ‹¦æˆªå¯¹è±¡è‡ªèº«å±æ€§çš„è¯»å–æ“ä½œã€‚å…·ä½“æ¥è¯´ï¼Œæ‹¦æˆªä»¥ä¸‹æ“ä½œã€‚\nObject.getOwnPropertyNames() Object.getOwnPropertySymbols() Object.keys() for\u0026hellip;in ä¸‹é¢æ˜¯æ‹¦æˆª Object.keys() çš„ä¾‹å­ã€‚\nğŸ“ƒ Example\nconst target = {a: 1, b: 2, c: 3}; const handler = { ownKeys(target) { return [\u0026#39;a\u0026#39;]; // è¿”å›æ•°ç»„ï¼Œæˆå‘˜ï¼ˆé”®åï¼‰å¿…é¡»æ˜¯å¯¹è±¡ä¸­åŸæœ¬å­˜åœ¨çš„ } }; const proxy = new Proxy(target, handler); console.log( Object.keys(proxy), // [ \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39; ] Object.entries(proxy) // [ [ \u0026#39;a\u0026#39;, 1 ], [ \u0026#39;b\u0026#39;, 2 ] ] ); ä¸Šé¢ä»£ç æ‹¦æˆªäº†å¯¹äº target å¯¹è±¡çš„ Object.keys() æ“ä½œï¼Œåªè¿”å›aã€bã€c ä¸‰ä¸ªå±æ€§ä¹‹ä¸­çš„ a å±æ€§ã€‚\nä¸‹é¢çš„ä¾‹å­æ˜¯æ‹¦æˆªç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºä¸‹åˆ’çº¿çš„å±æ€§åã€‚\nğŸ“ƒ Example\nconst target = { _bar: \u0026#39;foo\u0026#39;, _prop: \u0026#39;bar\u0026#39;, prop: \u0026#39;baz\u0026#39; }; const handler = { ownKeys(target) { return Reflect.ownKeys(target).filter( key =\u0026gt; key[0] !== \u0026#39;_\u0026#39; ); } }; const proxy = new Proxy(target, handler); for (let key of Object.keys(proxy)) { console.log(target[key]); } // \u0026#34;baz\u0026#34; ğŸ“ Note æ³¨æ„ï¼Œä½¿ç”¨ Object.keys() æ–¹æ³•æ—¶ï¼Œæœ‰ä¸‰ç±»å±æ€§ä¼šè¢« ownKeys() æ–¹æ³•è‡ªåŠ¨è¿‡æ»¤ï¼Œä¸ä¼šè¿”å›ï¼š\nç›®æ ‡å¯¹è±¡ä¸Š ä¸å­˜åœ¨not-exist çš„å±æ€§ å±æ€§åä¸º Symbol å€¼ ä¸å¯éå†not-enumerable ğŸ“ƒ Example\nlet target = { a: 1, b: 2, c: 3, [Symbol.for(\u0026#39;secret\u0026#39;)]: \u0026#39;4\u0026#39;, }; Object.defineProperty(target, \u0026#39;key\u0026#39;, { enumerable: false, configurable: true, writable: true, value: \u0026#39;static\u0026#39; }); const handler = { ownKeys(target) { return [\u0026#39;a\u0026#39;, \u0026#39;d\u0026#39;, Symbol.for(\u0026#39;secret\u0026#39;), \u0026#39;key\u0026#39;]; } }; let proxy = new Proxy(target, handler); Object.keys(proxy); // [\u0026#39;a\u0026#39;] ä¸Šé¢ä»£ç ä¸­ï¼ŒownKeys() æ–¹æ³•ä¹‹ä¸­ï¼Œæ˜¾å¼è¿”å›ä¸å­˜åœ¨çš„å±æ€§ï¼ˆdï¼‰ã€Symbol å€¼ï¼ˆSymbol.for('secret')ï¼‰ã€ä¸å¯éå†çš„å±æ€§ï¼ˆkeyï¼‰ï¼Œç»“æœéƒ½è¢«è‡ªåŠ¨è¿‡æ»¤æ‰ã€‚\nownKeys() æ–¹æ³•è¿˜å¯ä»¥æ‹¦æˆª Object.getOwnPropertyNames() ã€‚\nconst p = new Proxy({}, { ownKeys: function (target) { return [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;]; } }); Object.getOwnPropertyNames(p); // [ \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39; ] for-in å¾ªç¯ä¹Ÿå—åˆ° ownKeys() æ–¹æ³•çš„æ‹¦æˆªã€‚\nğŸ“ƒ Example\nconst obj = { hello: \u0026#39;world\u0026#39; }; const proxy = new Proxy(obj, { ownKeys: function () { return [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;]; } }); for (let key in proxy) { console.log(key); // æ²¡æœ‰ä»»ä½•è¾“å‡º } ä¸Šé¢ä»£ç ä¸­ï¼Œownkeys() æŒ‡å®šåªè¿”å› a å’Œ b å±æ€§ï¼Œç”±äº obj æ²¡æœ‰è¿™ä¸¤ä¸ªå±æ€§ï¼Œå› æ­¤ for-in å¾ªç¯ä¸ä¼šæœ‰ä»»ä½•è¾“å‡ºã€‚\nownKeys() æ–¹æ³•è¿”å›çš„æ•°ç»„æˆå‘˜ï¼Œåªèƒ½æ˜¯å­—ç¬¦ä¸²æˆ– Symbol å€¼ã€‚å¦‚æœæœ‰å…¶ä»–ç±»å‹çš„å€¼ï¼Œæˆ–è€…è¿”å›çš„æ ¹æœ¬ä¸æ˜¯æ•°ç»„ï¼Œå°±ä¼šæŠ¥é”™ã€‚\nğŸ“ƒ Example\nconst obj = {}; const p = new Proxy(obj, { ownKeys: function (target) { return [123, true, undefined, null, {}, []]; } }); Object.getOwnPropertyNames(p) // Uncaught TypeError: 123 is not a valid property name ä¸Šé¢ä»£ç ä¸­ï¼ŒownKeys() æ–¹æ³•è™½ç„¶è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œä½†æ˜¯æ¯ä¸€ä¸ªæ•°ç»„æˆå‘˜éƒ½ä¸æ˜¯å­—ç¬¦ä¸²æˆ– Symbol å€¼ï¼Œå› æ­¤å°±æŠ¥é”™äº†ã€‚\nå¦‚æœç›®æ ‡å¯¹è±¡è‡ªèº«åŒ…å« ä¸å¯é…ç½®configurable çš„å±æ€§ï¼Œåˆ™è¯¥å±æ€§å¿…é¡»è¢« ownKeys() æ–¹æ³•è¿”å›ï¼Œå¦åˆ™æŠ¥é”™ã€‚\nğŸ“ƒ Example\nconst obj = { a: 1 }; Object.preventExtensions(obj); const p = new Proxy(obj, { ownKeys: function (target) { return [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;]; } }); Object.getOwnPropertyNames(p) // Uncaught TypeError: \u0026#39;ownKeys\u0026#39; on proxy: trap returned extra keys but proxy target is non-extensible ä¸Šé¢ä»£ç ä¸­ï¼Œobj å¯¹è±¡çš„ a å±æ€§æ˜¯ä¸å¯é…ç½®çš„ï¼Œè¿™æ—¶ ownKeys() æ–¹æ³•è¿”å›çš„æ•°ç»„ä¹‹ä¸­ï¼Œå¿…é¡»åŒ…å« a ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚\nå¦å¤–ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡æ˜¯ä¸å¯æ‰©å±•çš„non-extensible ï¼Œè¿™æ—¶ ownKeys() æ–¹æ³•è¿”å›çš„æ•°ç»„ä¹‹ä¸­ï¼Œå¿…é¡»åŒ…å«åŸå¯¹è±¡çš„ æ‰€æœ‰å±æ€§ ï¼Œä¸”ä¸èƒ½åŒ…å« å¤šä½™ çš„å±æ€§ï¼Œå¦åˆ™æŠ¥é”™ã€‚ï¼ˆç­‰äº Proxy åŸºæœ¬åºŸäº†ï¼‰\nğŸ“ƒ Example\nconst obj = { a: 1 }; Object.preventExtensions(obj); const p = new Proxy(obj, { ownKeys: function (target) { return [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;]; } }); Object.getOwnPropertyNames(p) // Uncaught TypeError: \u0026#39;ownKeys\u0026#39; on proxy: trap returned *extra* keys but proxy target is non-extensible ä¸Šé¢ä»£ç ä¸­ï¼Œobj å¯¹è±¡æ˜¯ä¸å¯æ‰©å±•çš„ï¼Œè¿™æ—¶ ownKeys() æ–¹æ³•è¿”å›çš„æ•°ç»„ä¹‹ä¸­ï¼ŒåŒ…å«äº†obj å¯¹è±¡çš„å¤šä½™å±æ€§ b ï¼Œæ‰€ä»¥å¯¼è‡´äº†æŠ¥é”™ã€‚\npreventExtensions() preventExtensions(target)\npreventExtensions() æ–¹æ³•æ‹¦æˆª Object.preventExtensions() ã€‚è¯¥æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ª boolean ï¼Œå¦åˆ™ä¼šè¢«è‡ªåŠ¨è½¬ä¸º boolean ã€‚\nè¿™ä¸ªæ–¹æ³•æœ‰ä¸€ä¸ªé™åˆ¶ï¼Œåªæœ‰ç›®æ ‡å¯¹è±¡ä¸å¯æ‰©å±•æ—¶ï¼ˆå³Object.isExtensible(proxy)ä¸º false ï¼‰ï¼Œproxy.preventExtensions æ‰èƒ½è¿”å› true ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚\nğŸ“ƒ Example\nconst proxy = new Proxy({}, { preventExtensions: function (target) { return true; } }); Object.preventExtensions(proxy) // Uncaught TypeError: \u0026#39;preventExtensions\u0026#39; on proxy: trap returned truish but the proxy target is extensible ä¸Šé¢ä»£ç ä¸­ï¼Œproxy.preventExtensions() æ–¹æ³•è¿”å› true ï¼Œä½†è¿™æ—¶Object.isExtensible(proxy)ä¼šè¿”å› true ï¼Œå› æ­¤æŠ¥é”™ã€‚\nä¸ºäº†é˜²æ­¢å‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œé€šå¸¸è¦åœ¨ proxy.preventExtensions() æ–¹æ³•é‡Œé¢ï¼Œè°ƒç”¨ä¸€æ¬¡ Object.preventExtensions() ã€‚\nconst proxy = new Proxy({}, { preventExtensions: function (target) { console.log(\u0026#39;called\u0026#39;); Object.preventExtensions(target); return true; } }); Object.preventExtensions(proxy) // \u0026#34;called\u0026#34; Proxy {} å¯å–æ¶ˆå®ä¾‹ Proxy.revocable() æ–¹æ³•è¿”å›ä¸€ä¸ªå¯å–æ¶ˆçš„ Proxy å®ä¾‹ã€‚\nProxy.revocable(target, handler)\ntarget\nå°†ç”¨ Proxy å°è£…çš„ç›®æ ‡å¯¹è±¡ã€‚å¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬åŸç”Ÿæ•°ç»„ï¼Œå‡½æ•°ï¼Œç”šè‡³å¯ä»¥æ˜¯å¦å¤–ä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚\nhandler\nä¸€ä¸ªå¯¹è±¡ï¼Œå…¶å±æ€§æ˜¯ä¸€æ‰¹å¯é€‰çš„å‡½æ•°ï¼Œè¿™äº›å‡½æ•°å®šä¹‰äº†å¯¹åº”çš„æ“ä½œè¢«æ‰§è¡Œæ—¶ä»£ç†çš„è¡Œä¸ºã€‚\nè¯¥æ–¹æ³•çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ç»“æ„ä¸ºï¼š{\u0026ldquo;proxy\u0026rdquo;: proxy, \u0026ldquo;revoke\u0026rdquo;: revoke}ï¼Œå…¶ä¸­ï¼š\nproxy\nè¡¨ç¤ºæ–°ç”Ÿæˆçš„ä»£ç†å¯¹è±¡æœ¬èº«ï¼Œå’Œç”¨ä¸€èˆ¬æ–¹å¼ new Proxy(target, handler) åˆ›å»ºçš„ä»£ç†å¯¹è±¡æ²¡ä»€ä¹ˆä¸åŒï¼Œåªæ˜¯å®ƒå¯ä»¥è¢«æ’¤é”€æ‰ã€‚\nrevoke\næ’¤é”€æ–¹æ³•ï¼Œè°ƒç”¨çš„æ—¶å€™ä¸éœ€è¦åŠ ä»»ä½•å‚æ•°ï¼Œå°±å¯ä»¥æ’¤é”€æ‰å’Œå®ƒä¸€èµ·ç”Ÿæˆçš„é‚£ä¸ªä»£ç†å¯¹è±¡ã€‚\næ¥æ”¶æ–¹æ³•ï¼šlet {proxy, revoke} = Proxy.revocable(target, handler);\nğŸ“ƒ Example\nlet target = {}; let handler = {}; let {proxy, revoke} = Proxy.revocable(target, handler); proxy.foo = 123; proxy.foo // 123 revoke(); proxy.foo // TypeError: Revoked Proxy.revocable()æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„ Proxy å±æ€§æ˜¯ Proxy å®ä¾‹ï¼Œrevoke å±æ€§æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥å–æ¶ˆ Proxy å®ä¾‹ã€‚ä¸Šé¢ä»£ç ä¸­ï¼Œå½“æ‰§è¡Œ revoke å‡½æ•°ä¹‹åï¼Œå†è®¿é—® Proxy å®ä¾‹ï¼Œå°±ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚\nProxy.revocable() çš„ä¸€ä¸ªä½¿ç”¨åœºæ™¯æ˜¯ï¼Œç›®æ ‡å¯¹è±¡ä¸å…è®¸ç›´æ¥è®¿é—®ï¼Œå¿…é¡»é€šè¿‡ä»£ç†è®¿é—®ï¼Œä¸€æ—¦è®¿é—®ç»“æŸï¼Œå°±æ”¶å›ä»£ç†æƒï¼Œä¸å…è®¸å†æ¬¡è®¿é—®ã€‚\nthis è™½ç„¶ Proxy å¯ä»¥ä»£ç†é’ˆå¯¹ç›®æ ‡å¯¹è±¡çš„è®¿é—®ï¼Œä½†å®ƒä¸æ˜¯ç›®æ ‡å¯¹è±¡çš„é€æ˜ä»£ç†ï¼Œå³ä¸åšä»»ä½•æ‹¦æˆªçš„æƒ…å†µä¸‹ï¼Œä¹Ÿæ— æ³•ä¿è¯ä¸ç›®æ ‡å¯¹è±¡çš„è¡Œä¸ºä¸€è‡´ã€‚ä¸»è¦åŸå› å°±æ˜¯åœ¨ Proxy ä»£ç†çš„æƒ…å†µä¸‹ï¼Œç›®æ ‡å¯¹è±¡å†…éƒ¨çš„ this å…³é”®å­—ä¼šæŒ‡å‘ Proxy ä»£ç†ã€‚\nğŸ“ƒ Example\nconst target = { m() { console.log( `this === proxy:${this === proxy}` ); } }; const handler = {}; const proxy = new Proxy(target, handler); target.m() // false proxy.m() // true ä¸Šé¢ä»£ç ä¸­ï¼Œä¸€æ—¦ Proxy ä»£ç† target ï¼Œtarget.m() å†…éƒ¨çš„ this å°±æ˜¯æŒ‡å‘ Proxy ï¼Œè€Œä¸æ˜¯ target ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œç”±äº this æŒ‡å‘çš„å˜åŒ–ï¼Œå¯¼è‡´ Proxy æ— æ³•ä»£ç†ç›®æ ‡å¯¹è±¡ã€‚\nğŸ“ƒ Example\nconst _name = new WeakMap(); class Person { constructor(name) { _name.set(this, name); } get name() { return _name.get(this); } } const jane = new Person(\u0026#39;Jane\u0026#39;); jane.name // \u0026#39;Jane\u0026#39; const proxy = new Proxy(jane, {}); proxy.name // undefined ä¸Šé¢ä»£ç ä¸­ï¼Œç›®æ ‡å¯¹è±¡ jane çš„ name å±æ€§ï¼Œå®é™…ä¿å­˜åœ¨å¤–éƒ¨ WeakMap _name ä¸Šé¢ï¼Œé€šè¿‡ this é”®åŒºåˆ†ã€‚\nç”±äºé€šè¿‡ proxy.name è®¿é—®æ—¶ï¼Œthis æŒ‡å‘ Proxy ï¼Œå¯¼è‡´æ— æ³•å–åˆ°å€¼ï¼Œæ‰€ä»¥è¿”å› undefined ã€‚\næ­¤å¤–ï¼Œæœ‰äº›åŸç”Ÿå¯¹è±¡çš„å†…éƒ¨å±æ€§ï¼Œåªæœ‰é€šè¿‡æ­£ç¡®çš„ this æ‰èƒ½æ‹¿åˆ°ï¼Œæ‰€ä»¥ Proxy ä¹Ÿæ— æ³•ä»£ç†è¿™äº›åŸç”Ÿå¯¹è±¡çš„å±æ€§ã€‚\nğŸ“ƒ Example\nconst target = new Date(); const handler = {}; const proxy = new Proxy(target, handler); proxy.getDate(); // TypeError: this is not a Date object. ä¸Šé¢ä»£ç ä¸­ï¼ŒgetDate() æ–¹æ³•åªèƒ½åœ¨ Date å¯¹è±¡å®ä¾‹ä¸Šé¢æ‹¿åˆ°ï¼Œå¦‚æœ this ä¸æ˜¯ Date å¯¹è±¡å®ä¾‹å°±ä¼šæŠ¥é”™ã€‚\nè¿™æ—¶ï¼Œé€šè¿‡ bind() å°† this ç»‘å®šåˆ°åŸå§‹å¯¹è±¡ï¼Œå°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\nconst target = new Date(\u0026#39;2015-01-01\u0026#39;); const handler = { get(target, prop) { if (prop === \u0026#39;getDate\u0026#39;) { return target.getDate.bind(target); } return Reflect.get(target, prop); } }; const proxy = new Proxy(target, handler); proxy.getDate() // 1 å¦å¤–ï¼ŒProxy æ‹¦æˆªå‡½æ•°å†…éƒ¨çš„ thisï¼ŒæŒ‡å‘çš„æ˜¯ handler å¯¹è±¡ã€‚\nğŸ“ƒ Example\nconst handler = { get(target, key, receiver) { console.log(this === handler); return \u0026#39;Hello, \u0026#39; + key; }, set(target, key, value) { console.log(this === handler); target[key] = value; return true; } }; const proxy = new Proxy({}, handler); console.log( proxy.foo, // true Hello, foo proxy.foo = 1 // true 1 ); ä¸Šé¢ä¾‹å­ä¸­ï¼Œ get() å’Œ set() æ‹¦æˆªå‡½æ•°å†…éƒ¨çš„ thisï¼ŒæŒ‡å‘çš„éƒ½æ˜¯ handler å¯¹è±¡ã€‚\nåº”ç”¨ Web æœåŠ¡çš„å®¢æˆ·ç«¯ Proxy å¯¹è±¡å¯ä»¥æ‹¦æˆªç›®æ ‡å¯¹è±¡çš„ä»»æ„å±æ€§ï¼Œè¿™ä½¿å¾—å®ƒå¾ˆåˆé€‚ç”¨æ¥å†™ Web æœåŠ¡çš„å®¢æˆ·ç«¯ã€‚\nğŸ“ƒ Example\nconst service = createWebService(\u0026#39;http://example.com/data\u0026#39;); service.employees().then(json =\u0026gt; { const employees = JSON.parse(json); // Â·Â·Â· }); ä¸Šé¢ä»£ç æ–°å»ºäº†ä¸€ä¸ª Web æœåŠ¡çš„æ¥å£ï¼Œè¿™ä¸ªæ¥å£è¿”å›å„ç§æ•°æ®ã€‚Proxy å¯ä»¥æ‹¦æˆªè¿™ä¸ªå¯¹è±¡çš„ä»»æ„å±æ€§ï¼Œæ‰€ä»¥ä¸ç”¨ä¸ºæ¯ä¸€ç§æ•°æ®å†™ä¸€ä¸ªé€‚é…æ–¹æ³•ï¼Œåªè¦å†™ä¸€ä¸ª Proxy æ‹¦æˆªå°±å¯ä»¥äº†ã€‚\nfunction createWebService(baseUrl) { return new Proxy({}, { get(target, propKey, receiver) { return () =\u0026gt; httpGet(baseUrl + \u0026#39;/\u0026#39; + propKey); } }); } åŒç†ï¼ŒProxy ä¹Ÿå¯ä»¥ç”¨æ¥å®ç°æ•°æ®åº“çš„ ORM å±‚ã€‚\nåŒå‘ç»‘å®š Proxy å°±åƒä¸€ä¸ªä»£ç†å™¨,å½“æœ‰äººå¯¹ç›®æ ‡å¯¹è±¡è¿›è¡Œå¤„ç†ï¼ˆset(), has(), get(), etc\u0026hellip;ï¼‰çš„æ—¶å€™å®ƒä¼šé¦–å…ˆç»è¿‡å®ƒï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»£ç è¿›è¡Œå¤„ç†ï¼Œæ­¤æ—¶ Proxy ç›¸å½“äºä¸€ä¸ªä¸­ä»‹æˆ–è€…å«ä»£ç†äºº,å®ƒç»å¸¸è¢«ç”¨äºä»£ç†æ¨¡å¼ä¸­,å¯ä»¥åšå­—æ®µéªŒè¯ã€ç¼“å­˜ä»£ç†ã€è®¿é—®æ§åˆ¶ç­‰ç­‰ã€‚\nObject.defineProperty ä¼—æ‰€å‘¨çŸ¥ï¼Œvueä½¿ç”¨äº†Object.definePropertyæ¥åšæ•°æ®åŠ«æŒï¼Œå®ƒæ˜¯åˆ©ç”¨åŠ«æŒå¯¹è±¡çš„è®¿é—®å™¨,åœ¨å±æ€§å€¼å‘ç”Ÿå˜åŒ–æ—¶æˆ‘ä»¬å¯ä»¥è·å–å˜åŒ–,ä»è€Œè¿›è¡Œè¿›ä¸€æ­¥æ“ä½œ\nconst obj = { a: 1 } Object.defineProperty(obj, \u0026#39;a\u0026#39;, { get: function() { console.log(\u0026#39;get val\u0026#39;) }, set: function(newVal) { console.log(\u0026#39;set val:\u0026#39; + newVal) } }) ä¸ Object.defineProperty ç›¸æ¯”ï¼Œ Proxy çš„ä¼˜åŠ¿ æ•°ç»„ä½œä¸ºç‰¹æ®Šçš„å¯¹è±¡ï¼Œä½† Object.defineProperty æ— æ³•ç›‘å¬æ•°ç»„å˜åŒ–ã€‚ Object.defineProperty åªèƒ½åŠ«æŒå¯¹è±¡çš„å±æ€§,å› æ­¤æˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸ªå¯¹è±¡çš„æ¯ä¸ªå±æ€§è¿›è¡Œéå†ï¼Œå¦‚æœå±æ€§å€¼ä¹Ÿæ˜¯å¯¹è±¡é‚£ä¹ˆéœ€è¦æ·±åº¦éå†,æ˜¾ç„¶èƒ½åŠ«æŒä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚ Proxy æœ‰å¤šè¾¾ 13 ç§æ‹¦æˆªæ–¹æ³•,ä¸é™äº apply(), ownKeys(), deleteProperty(), has() ç­‰ç­‰æ˜¯ Object.defineProperty ä¸å…·å¤‡çš„ã€‚ Proxy è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°å¯¹è±¡,æˆ‘ä»¬å¯ä»¥åªæ“ä½œæ–°çš„å¯¹è±¡è¾¾åˆ°ç›®çš„,è€Œ Object.defineProperty åªèƒ½éå†å¯¹è±¡å±æ€§ç›´æ¥ä¿®æ”¹ Proxy ä½œä¸ºæ–°æ ‡å‡†å°†å—åˆ°æµè§ˆå™¨å‚å•†é‡ç‚¹æŒç»­çš„æ€§èƒ½ä¼˜åŒ– æ‰‹å†™åŒå‘ç»‘å®šä»£ç  ç®€å•å®ç°åŒå‘ç»‘å®š -------------------- html ---------------------------- \u0026lt;input id=\u0026#34;input_el\u0026#34; oninput=\u0026#34;inputHandle(this)\u0026#34; type=\u0026#34;text\u0026#34;\u0026gt; \u0026lt;br /\u0026gt; \u0026lt;div id=\u0026#34;show_el\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; ------------------- js ------------------------------ \u0026lt;script\u0026gt; proxy_bind = (traget) =\u0026gt; { return new Proxy(traget, { get(obj, name) { console.log(\u0026#34;è·å–\u0026#34;) //å¦‚æœä¼ å…¥çš„keyå¹¶æ²¡æœ‰,åˆ™èµ‹åˆå§‹å€¼ if (!obj[name]) obj[name] = \u0026#34;\u0026#34; //æ ¹æ®ä¼ å…¥çš„keyè¿›è¡Œç›¸åº”å±æ€§è¿”å› return obj[name] }, //æ‹¦æˆªçš„å¯¹è±¡,æ‹¦æˆªå¯¹è±¡çš„å€¼,ä¼ å…¥è¦ä¿®æ”¹çš„å€¼,(ç¬¬å››ä¸ªå‚æ•°é€šå¸¸ä¸ç”¨,è¿”å›æ•´ä¸ªProxyå¯¹è±¡) set(obj, name, val) { console.log(\u0026#34;å†™å…¥\u0026#34;) obj[name] = val //å°†è¾“å…¥ç‹‚å†…å®¹å³ä¿®æ”¹çš„proxyå¯¹è±¡å±æ€§æ¸²æŸ“åˆ°é¡µé¢èŠ‚ç‚¹ä¸Š document.querySelector(\u0026#34;#show_el\u0026#34;).innerHTML = obj[name] return; } }) } inputHandle = (e) =\u0026gt; { //å°†è¾“å…¥æ¡†çš„å€¼èµ‹å€¼ç»™proxyå¯¹è±¡çš„valueå±æ€§ä¸Šï¼Œæ­¤å¤„è§¦å‘proxyçš„`setï¼ˆï¼‰` obj_bind.value = e.value } let obj = { a: \u0026#34;2\u0026#34;, b: 3, value: \u0026#34;é»˜è®¤å€¼\u0026#34; } let obj_bind = proxy_bind(obj) //è‡ªé—­åˆï¼Œå¦‚æœå‰é¢æ²¡æœ‰åŠ åˆ†å· ä¼šå¯¼è‡´å‹ç¼©å¼åˆå¹¶åˆ°å‰é¢å»å°±ä¼šæŠ¥é”™ï¼Œä»¥é˜²ä¸‡ä¸€åŠ åˆ†å·ï¼Œæ­¤å¤„è§¦å‘proxyçš„`getï¼ˆï¼‰` ; (function () { document.querySelector(\u0026#34;#show_el\u0026#34;).innerHTML = obj_bind.value document.querySelector(\u0026#34;#input_el\u0026#34;).value = obj_bind.value })() \u0026lt;/script\u0026gt; æ¨¡æ‹Ÿ Vue å®ç°å®Œæ•´åŒå‘ç»‘å®šå®ç° -------------------- html ---------------------------- \u0026lt;div\u0026gt; \u0026lt;p\u0026gt;è¯·è¾“å…¥:\u0026lt;/p\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; id=\u0026#34;input\u0026#34;\u0026gt; \u0026lt;p id=\u0026#34;p\u0026#34;\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; ------------------- js ------------------------------ class Watcher { constructor(vm, key, callback) { this.vm = vm this.callback = callback this.key = key // è¢«è®¢é˜…çš„æ•°æ® this.val = this.get() // ç»´æŠ¤æ›´æ–°ä¹‹å‰çš„æ•°æ® vm.$data = this.createProxy(vm.$data) } update(newVal) { this.callback(newVal) } get() { const val = this.vm.$data[this.key] return val } createProxy(data) { let _this = this let handler = { get(target, property) { return Reflect.get(target, property) }, set(target, property, value) { let res = null if (target[property] != value) { const isOk = Reflect.set(target, property, value) if (_this.key === property) { // åŒä¸€å±‚çº§ res = value } else { res = _this.get() console.log(res) } _this.callback(res) return isOk } } } return toDeepProxy(data, handler) function toDeepProxy(object, handler) { if (!isPureObject(object)) addSubProxy(object, handler) return new Proxy(object, handler) function addSubProxy(object, handler) { for (let prop in object) { if (typeof object[prop] == \u0026#39;object\u0026#39;) { if (!isPureObject(object[prop])) addSubProxy(object[prop], handler) object[prop] = new Proxy(object[prop], handler) } } object = new Proxy(object, handler) } function isPureObject(object) { if (typeof object !== \u0026#39;object\u0026#39;) { return false } else { for (let prop in object) { if (typeof object[prop] == \u0026#39;object\u0026#39;) { return false } } } return true } } } } class Vue { constructor(data) { // å°†æ‰€æœ‰dataæœ€å¤–å±‚å±æ€§ä»£ç†åˆ°å®ä¾‹ä¸Š this.$data = data Object.keys(data).forEach(key =\u0026gt; this.$proxy(key)) } $watch(key, cb) { new Watcher(this, key, cb) } $proxy(key) { Reflect.defineProperty(this, key, { configurable: true, enumerable: true, get: () =\u0026gt; this.$data[key], set: val =\u0026gt; { this._data[key] = val } }) } } const p = document.getElementById(\u0026#39;p\u0026#39;) const input = document.getElementById(\u0026#39;input\u0026#39;) const data = new Vue({ text: { a: \u0026#39;\u0026#39; } }) input.addEventListener(\u0026#39;keyup\u0026#39;, function(e) { data.text.a = e.target.value }) data.$watch(\u0026#39;text\u0026#39;, content =\u0026gt; p.innerHTML = content.a) è¿™æ˜¯å¯¹ Vue åŒå‘ç»‘å®šæ¨¡å‹çš„ä¸€ä¸ªç®€å•æ¨¡ä»¿ã€‚\nReflect æ¦‚è¿° Reflect å¯¹è±¡ä¸ Proxy å¯¹è±¡ä¸€æ ·ï¼Œä¹Ÿæ˜¯ ES6 ä¸ºäº†æ“ä½œå¯¹è±¡è€Œæä¾›çš„æ–° API ã€‚ Reflect å¯¹è±¡çš„è®¾è®¡ç›®çš„æœ‰è¿™æ ·å‡ ä¸ªï¼š\nä¿®æ”¹å†…éƒ¨æ–¹æ³•\nå°† Object å¯¹è±¡çš„ä¸€äº›æ˜æ˜¾å±äºè¯­è¨€å†…éƒ¨çš„æ–¹æ³•ï¼ˆe.g.: Object.defineProperty() ï¼‰ï¼Œæ”¾åˆ° Reflect å¯¹è±¡ä¸Šã€‚ç°é˜¶æ®µï¼ŒæŸäº›æ–¹æ³•åŒæ—¶åœ¨ Object å’Œ Reflect å¯¹è±¡ä¸Šéƒ¨ç½²ï¼Œæœªæ¥çš„æ–°æ–¹æ³•å°†åªéƒ¨ç½²åœ¨ Reflect å¯¹è±¡ä¸Šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä» Reflect å¯¹è±¡ä¸Šå¯ä»¥æ‹¿åˆ°è¯­è¨€å†…éƒ¨çš„æ–¹æ³•ã€‚\næ§åˆ¶è¿”å›ç»“æœ\nä¿®æ”¹æŸäº› Object æ–¹æ³•çš„è¿”å›ç»“æœï¼Œè®©å…¶å˜å¾—æ›´åˆç†ã€‚\ne.g.: Object.defineProperty(obj, name, desc) åœ¨æ— æ³•å®šä¹‰å±æ€§æ—¶ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè€Œ Reflect.defineProperty(obj, name, desc) åˆ™ä¼šè¿”å› false ã€‚\n// è€å†™æ³• try { Object.defineProperty(target, property, attributes); // success } catch (e) { // failure } // æ–°å†™æ³• if (Reflect.defineProperty(target, property, attributes)) { // success } else { // failure } å‡½æ•°åŒ–æŠ½è±¡ è®© Object æ“ä½œéƒ½å˜æˆå‡½æ•°è¡Œä¸ºã€‚\ne.g.:æŸäº› Object æ“ä½œæ˜¯ å‘½ä»¤å¼å…³é”®å­—ï¼Œæ¯”å¦‚ name in obj å’Œ delete obj[name]ï¼Œè€Œ Reflect.has(obj, name) å’ŒReflect.deleteProperty(obj, name) è®©å®ƒä»¬å˜æˆäº†å‡½æ•°è¡Œä¸ºã€‚\n// è€å†™æ³• \u0026#39;assign\u0026#39; in Object // true // æ–°å†™æ³• Reflect.has(Object, \u0026#39;assign\u0026#39;) // true ä¸ Proxy é’©å­æ–¹æ³•å¯¹ç§° åªè¦æ˜¯ Proxy å¯¹è±¡çš„æ–¹æ³•ï¼Œå°±èƒ½åœ¨ Reflect å¯¹è±¡ä¸Šæ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•ã€‚\nè¿™å°±è®© Proxy å¯¹è±¡å¯ä»¥æ–¹ä¾¿åœ°è°ƒç”¨å¯¹åº”çš„ Reflect æ–¹æ³•ï¼Œå®Œæˆé»˜è®¤è¡Œä¸ºï¼Œä½œä¸ºä¿®æ”¹è¡Œä¸ºçš„åŸºç¡€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ç®¡ Proxy æ€ä¹ˆä¿®æ”¹é»˜è®¤è¡Œä¸ºï¼Œä½ æ€»å¯ä»¥åœ¨ Reflect ä¸Šè·å–é»˜è®¤è¡Œä¸ºã€‚\nğŸ“ƒ Example\nlet target = {}, name = \u0026#39;foo\u0026#39;, value = \u0026#39;bar\u0026#39;; let proxy = new Proxy(target, { set: function ( target, name, value, receiver) { const success = Reflect.set(target, name, value, receiver); if (success) { console.log( `property ${name} on `, target, ` set to ${value}` ); } return success; // ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼ŒProxy.reflectçš„ // setä»£ç†å¦‚æœæ²¡æœ‰è¿”å›trueï¼Œå°±ä¼šæŠ¥é”™ã€‚ } }); console.log(proxy.foo = \u0026#39;bar\u0026#39;); // property foo on { foo: \u0026#39;bar\u0026#39; } set to bar ä¸Šé¢ä»£ç ä¸­ï¼Œ Proxy æ–¹æ³•æ‹¦æˆª target å¯¹è±¡çš„å±æ€§èµ‹å€¼è¡Œä¸ºã€‚å®ƒé‡‡ç”¨ Reflect.set æ–¹æ³•å°†å€¼èµ‹å€¼ç»™å¯¹è±¡çš„å±æ€§ï¼Œç¡®ä¿å®ŒæˆåŸæœ‰çš„è¡Œä¸ºï¼Œç„¶åå†éƒ¨ç½²é¢å¤–çš„åŠŸèƒ½ã€‚\nğŸ“ƒ Example\nä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚\nconst loggedObj = new Proxy(obj, { get(target, name) { console.log(\u0026#39;get\u0026#39;, target, name); return Reflect.get(target, name); }, deleteProperty(target, name) { console.log(\u0026#39;delete\u0026#39;, name); return Reflect.deleteProperty(target, name); }, has(target, name) { console.log(\u0026#39;has\u0026#39;, name); return Reflect.has(target, name); } }); ä¸Šé¢ä»£ç ä¸­ï¼Œæ¯ä¸€ä¸ª Proxy å¯¹è±¡çš„æ‹¦æˆªæ“ä½œï¼ˆgetã€deleteã€hasï¼‰ï¼Œå†…éƒ¨éƒ½è°ƒç”¨å¯¹åº”çš„ Reflect æ–¹æ³•ï¼Œä¿è¯åŸç”Ÿè¡Œä¸ºèƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œã€‚æ·»åŠ çš„å·¥ä½œï¼Œå°±æ˜¯å°†æ¯ä¸€ä¸ªæ“ä½œè¾“å‡ºä¸€è¡Œæ—¥å¿—ã€‚\næœ‰äº† Reflect å¯¹è±¡ä»¥åï¼Œå¾ˆå¤šæ“ä½œä¼šæ›´æ˜“è¯»ã€‚\n// è€å†™æ³• Function.prototype.apply.call(Math.floor, undefined, [1.75]) // 1 // æ–°å†™æ³• Reflect.apply(Math.floor, undefined, [1.75]) // 1 æ–¹æ³• Reflect å¯¹è±¡ä¸€å…±æœ‰ 13 ä¸ªé™æ€æ–¹æ³•ã€‚\nReflect., get(), set(), has(), deleteProperty(), construct(), getPrototype(), setPrototypeOf(), apply(), defineProperty(), getOwnPropertyDescriptor(), isExtensible(), preventExtension(), ownKeys()\nä¸Šé¢è¿™äº›æ–¹æ³•çš„ä½œç”¨ï¼Œå¤§éƒ¨åˆ†ä¸ Object å¯¹è±¡çš„åŒåæ–¹æ³•çš„ä½œç”¨éƒ½æ˜¯ç›¸åŒçš„ï¼Œè€Œä¸”å®ƒä¸ Proxy å¯¹è±¡çš„æ–¹æ³•æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚ä¸‹é¢æ˜¯å¯¹å®ƒä»¬çš„è§£é‡Šã€‚\nget() Reflect.get(target, name, receiver)\nReflect.get() æ–¹æ³•æŸ¥æ‰¾å¹¶è¿”å› target å¯¹è±¡çš„ name å±æ€§ï¼Œå¦‚æœæ²¡æœ‰è¯¥å±æ€§ï¼Œåˆ™è¿”å› undefined ã€‚\nconst myObject = { foo: 1, bar: 2, get baz() { return this.foo + this.bar; }, }; console.log( Reflect.get(myObject, \u0026#39;foo\u0026#39;), // 1 Reflect.get(myObject, \u0026#39;bar\u0026#39;), // 2 Reflect.get(myObject, \u0026#39;baz\u0026#39;), // 3 Reflect.get(myObject, \u0026#39;foo\u0026#39;) === myObject.foo // true ) å¦‚æœ name å±æ€§éƒ¨ç½²äº†è¯»å–å‡½æ•° getterï¼Œåˆ™è¯»å–å‡½æ•°çš„ this ç»‘å®š receiver ã€‚\nconst obj = { foo: \u0026#39;bar\u0026#39;, get baz() { return this; }, }; const thisObj = { foo: \u0026#39;bat\u0026#39;, }; console.log( obj.baz, // { foo: \u0026#39;bar\u0026#39;, baz: [Getter] } Reflect.get(obj, \u0026#39;baz\u0026#39;, thisObj), // { foo: \u0026#39;bat\u0026#39; } obj.baz.bind(thisObj), // TypeError: obj.baz.bind is not a function // å’Œä¼ ç»Ÿä¸‹æ ‡è®¿é—®åŒºåˆ« ) å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼ŒReflect.get æ–¹æ³•ä¼šæŠ¥é”™ã€‚\nReflect.get(1, \u0026#39;foo\u0026#39;) Reflect.get(false, \u0026#39;foo\u0026#39;) // Reflect.get called on non-object 1.foo; false.foo; // SyntaxError: Invalid or unexpected token set() Reflect.set(target, name, value, receiver)\nReflect.set() æ–¹æ³•è®¾ç½® target å¯¹è±¡çš„ name å±æ€§ç­‰äº value ã€‚\nvar myObject = { foo: 1, set bar(value) { return this.foo = value; }, } myObject.foo // 1 Reflect.set(myObject, \u0026#39;foo\u0026#39;, 2); myObject.foo // 2 Reflect.set(myObject, \u0026#39;bar\u0026#39;, 3) myObject.foo // 3 å¦‚æœ name å±æ€§è®¾ç½®äº†èµ‹å€¼å‡½æ•°ï¼Œåˆ™èµ‹å€¼å‡½æ•°çš„ this ç»‘å®š receiver ã€‚\nvar myObject = { foo: 4, set bar(value) { return this.foo = value; }, }; var myReceiverObject = { foo: 0, }; Reflect.set(myObject, \u0026#39;bar\u0026#39;, 1, myReceiverObject); myObject.foo // 4 myReceiverObject.foo // 1 æ³¨æ„ï¼Œå¦‚æœ Proxy å¯¹è±¡å’Œ Reflect å¯¹è±¡è”åˆä½¿ç”¨ï¼Œå‰è€…æ‹¦æˆªèµ‹å€¼æ“ä½œï¼Œåè€…å®Œæˆèµ‹å€¼çš„é»˜è®¤è¡Œä¸ºï¼Œè€Œä¸”ä¼ å…¥äº† receiver ï¼Œé‚£ä¹ˆ Reflect.set ä¼šè§¦å‘ Proxy.defineProperty æ‹¦æˆªã€‚\nlet p = { a: \u0026#39;a\u0026#39; }; let handler = { set(target, key, value, receiver) { console.log(\u0026#39;set\u0026#39;); Reflect.set(target, key, value, receiver) }, defineProperty(target, key, attribute) { console.log(\u0026#39;defineProperty\u0026#39;); Reflect.defineProperty(target, key, attribute); } }; let obj = new Proxy(p, handler); obj.a = \u0026#39;A\u0026#39;; // set // defineProperty ä¸Šé¢ä»£ç ä¸­ï¼ŒProxy.setæ‹¦æˆªé‡Œé¢ä½¿ç”¨äº†Reflect.setï¼Œè€Œä¸”ä¼ å…¥äº† receiver ï¼Œå¯¼è‡´è§¦å‘Proxy.definePropertyæ‹¦æˆªã€‚è¿™æ˜¯å› ä¸ºProxy.setçš„receiverå‚æ•°æ€»æ˜¯æŒ‡å‘å½“å‰çš„ Proxy å®ä¾‹ï¼ˆå³ä¸Šä¾‹çš„objï¼‰ï¼Œè€ŒReflect.setä¸€æ—¦ä¼ å…¥receiverï¼Œå°±ä¼šå°†å±æ€§èµ‹å€¼åˆ°receiverä¸Šé¢ï¼ˆå³objï¼‰ï¼Œå¯¼è‡´è§¦å‘definePropertyæ‹¦æˆªã€‚å¦‚æœReflect.setæ²¡æœ‰ä¼ å…¥receiverï¼Œé‚£ä¹ˆå°±ä¸ä¼šè§¦å‘definePropertyæ‹¦æˆªã€‚\nlet p = { a: \u0026#39;a\u0026#39; }; let handler = { set(target, key, value, receiver) { console.log(\u0026#39;set\u0026#39;); Reflect.set(target, key, value) }, defineProperty(target, key, attribute) { console.log(\u0026#39;defineProperty\u0026#39;); Reflect.defineProperty(target, key, attribute); } }; let obj = new Proxy(p, handler); obj.a = \u0026#39;A\u0026#39;; // set å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼ŒReflect.setä¼šæŠ¥é”™ã€‚\nReflect.set(1, \u0026#39;foo\u0026#39;, {}) // æŠ¥é”™ Reflect.set(false, \u0026#39;foo\u0026#39;, {}) // æŠ¥é”™ has() Reflect.has(target, name)\nReflect.has() æ–¹æ³•å¯¹åº” name in obj é‡Œé¢çš„ in è¿ç®—ç¬¦ã€‚\nvar myObject = { foo: 1, }; // æ—§å†™æ³• \u0026#39;foo\u0026#39; in myObject // true // æ–°å†™æ³• Reflect.has(myObject, \u0026#39;foo\u0026#39;) // true å¦‚æœ Reflect.has() æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œä¼šæŠ¥é”™ã€‚\napply() Reflect.apply(target, thisArg, args)\nReflect.apply æ–¹æ³•ç­‰åŒäºFunction.prototype.apply.call(func, thisArg, args)ï¼Œç”¨äºç»‘å®š this å¯¹è±¡åæ‰§è¡Œç»™å®šå‡½æ•°ã€‚\nä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœè¦ç»‘å®šä¸€ä¸ªå‡½æ•°çš„ this å¯¹è±¡ï¼Œå¯ä»¥è¿™æ ·å†™ fn.apply(obj, args) ï¼Œä½†æ˜¯å¦‚æœå‡½æ•°å®šä¹‰äº†è‡ªå·±çš„ apply() æ–¹æ³•ï¼Œå°±åªèƒ½å†™æˆ Function.prototype.apply.call(fn, obj, args) ï¼Œé‡‡ç”¨ Reflect å¯¹è±¡å¯ä»¥ç®€åŒ–è¿™ç§æ“ä½œã€‚\nâš ï¸ Caution å³ä½¿æ²¡æœ‰ä¼ å…¥å‚æ•°ï¼ŒReflect.apply() ä¸­çš„ args ä¹Ÿè¦ä¼ å…¥ ç©ºæ•°ç»„[] ï¼Œå¦åˆ™æŠ¥é”™\nconst ages = [11, 33, 12, 54, 18, 96]; // æ—§å†™æ³• const youngest = Math.min.apply(Math, ages); const oldest = Math.max.apply(Math, ages); const type = Object.prototype.toString.call(youngest); // æ–°å†™æ³• const youngest = Reflect.apply(Math.min, Math, ages); const oldest = Reflect.apply(Math.max, Math, ages); const type = Reflect.apply(Object.prototype.toString, youngest, []); deleteProperty() Reflect.ownKeys(target)\nReflect.deleteProperty() æ–¹æ³•ç­‰åŒäº delete obj[name] ï¼Œç”¨äºåˆ é™¤å¯¹è±¡çš„å±æ€§ã€‚\nconst myObj = { foo: \u0026#39;bar\u0026#39; }; // æ—§å†™æ³• delete myObj.foo; // æ–°å†™æ³• Reflect.deleteProperty(myObj, \u0026#39;foo\u0026#39;); è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª boolean ã€‚å¦‚æœåˆ é™¤æˆåŠŸï¼Œæˆ–è€…è¢«åˆ é™¤çš„å±æ€§ä¸å­˜åœ¨ï¼Œè¿”å› true ï¼›åˆ é™¤å¤±è´¥ï¼Œè¢«åˆ é™¤çš„å±æ€§ä¾ç„¶å­˜åœ¨ï¼Œè¿”å› false ã€‚è€Œ delete æ“ä½œç¬¦å§‹ç»ˆè¿”å› false ã€‚\nå¦‚æœ Reflect.deleteProperty() æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œä¼šæŠ¥é”™ã€‚\nconstruct() Reflect.construct(target, args)\nReflect.construct() æ–¹æ³•ç­‰åŒäº new target(...args) ï¼Œè¿™æä¾›äº†ä¸€ç§ä¸ä½¿ç”¨ new ï¼Œæ¥è°ƒç”¨æ„é€ å‡½æ•°çš„æ–¹æ³•ã€‚\nfunction Greeting(name) { this.name = name; } // new çš„å†™æ³• const instance = new Greeting(\u0026#39;å¼ ä¸‰\u0026#39;); // Reflect.construct çš„å†™æ³• const instanceR = Reflect.construct( Greeting, [\u0026#39;å¼ ä¸‰\u0026#39;] ); console.log(instance,instanceR); å¦‚æœ Reflect.construct() æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å‡½æ•°ï¼Œä¼šæŠ¥é”™ã€‚\nğŸ“ Note Class æ˜¯ ES6 ä¸­ æ„é€ å‡½æ•°Function() çš„è¯­æ³•ç³–ã€‚\nclass Greeting { constructor(name) { this.name = name; } } console.log(Greeting instanceof Function); //true getPrototypeOf() Reflect.getPrototypeOf(target)\nReflect.getPrototypeOf() æ–¹æ³•ç”¨äºè¯»å–å¯¹è±¡çš„ __proto__ å±æ€§ï¼Œå¯¹åº” Object.getPrototypeOf(obj) ã€‚\nconst myObj = new FancyThing(); // æ—§å†™æ³• Object.getPrototypeOf(myObj) === FancyThing.prototype; // æ–°å†™æ³• Reflect.getPrototypeOf(myObj) === FancyThing.prototype; setPrototypeOf() Reflect.setPrototypeOf(target, prototype)\nReflect.setPrototypeOf() æ–¹æ³•ç”¨äºè®¾ç½®ç›®æ ‡å¯¹è±¡çš„ åŸå‹prototype ï¼Œå¯¹åº” Object.setPrototypeOf(obj, newProto) æ–¹æ³•ã€‚å®ƒè¿”å›ä¸€ä¸ª boolean ï¼Œè¡¨ç¤ºæ˜¯å¦è®¾ç½®æˆåŠŸã€‚\nconst myObj = {}; // æ—§å†™æ³• Object.setPrototypeOf(myObj, Array.prototype); // æ–°å†™æ³• Reflect.setPrototypeOf(myObj, Array.prototype); myObj.length // 0 å¦‚æœæ— æ³•è®¾ç½®ç›®æ ‡å¯¹è±¡çš„åŸå‹ï¼ˆæ¯”å¦‚ï¼Œç›®æ ‡å¯¹è±¡ç¦æ­¢æ‰©å±•ï¼‰ï¼ŒReflect.setPrototypeOf æ–¹æ³•è¿”å› false ã€‚\nReflect.setPrototypeOf({}, null) // true Reflect.setPrototypeOf(Object.freeze({}), null) // false å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼ŒObject.setPrototypeOfä¼šè¿”å›ç¬¬ä¸€ä¸ªå‚æ•°æœ¬èº«ï¼Œè€ŒReflect.setPrototypeOfä¼šæŠ¥é”™ã€‚\nObject.setPrototypeOf(1, {}) // 1 Reflect.setPrototypeOf(1, {}) // TypeError: Reflect.setPrototypeOf called on non-object å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ undefined æˆ– null ï¼ŒObject.setPrototypeOfå’ŒReflect.setPrototypeOf éƒ½ä¼šæŠ¥é”™ã€‚\nObject.setPrototypeOf(null, {}) // TypeError: Object.setPrototypeOf called on null or undefined Reflect.setPrototypeOf(null, {}) // TypeError: Reflect.setPrototypeOf called on non-object defineProperty() Reflect.defineProperty(target, name, desc)\nReflect.defineProperty() æ–¹æ³•åŸºæœ¬ç­‰åŒäº Object.defineProperty ï¼Œç”¨æ¥ä¸ºå¯¹è±¡å®šä¹‰å±æ€§ã€‚æœªæ¥ï¼Œåè€…ä¼šè¢«é€æ¸ åºŸé™¤ ï¼Œè¯·ä»ç°åœ¨å¼€å§‹å°±ä½¿ç”¨ Reflect.defineProperty ä»£æ›¿å®ƒã€‚\nå¦å¤–ï¼ŒReflect ä¸Šçš„æ–¹æ³•è¿”å›çš„æ˜¯ boolean ï¼Œè€Œ Object è¿”å› objectï¼›åŒæ—¶ï¼Œ Object å…·æœ‰ Object.defineProperties() æ‰¹é‡ä¿®æ”¹å±æ€§ï¼Œä½† Reflect ä¸èƒ½æ‰¹é‡ä¿®æ”¹ã€‚\nfunction MyDate() { /*â€¦*/ } // æ—§å†™æ³• Object.defineProperty(MyDate, \u0026#39;now\u0026#39;, { value: () =\u0026gt; Date.now() }); // æ–°å†™æ³• Reflect.defineProperty(MyDate, \u0026#39;now\u0026#39;, { value: () =\u0026gt; Date.now() }); å¦‚æœ Reflect.defineProperty çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯ å¯¹è±¡object ï¼Œå°±ä¼šæŠ›å‡ºé”™è¯¯ï¼Œæ¯”å¦‚ Reflect.defineProperty(1, \u0026lsquo;foo\u0026rsquo;) ã€‚\nè¿™ä¸ªæ–¹æ³•å¯ä»¥ä¸ Proxy.defineProperty é…åˆä½¿ç”¨ã€‚\nğŸ“ƒ Example\nconst p = new Proxy({}, { defineProperty(target, prop, descriptor) { console.log(descriptor); return Reflect.defineProperty( target, prop, descriptor ); // Reflectè¿”å›boolean } }); p.foo = \u0026#39;bar\u0026#39;; // {value: \u0026#34;bar\u0026#34;, writable: true, enumerable: true, configurable: true} console.log(p.foo) // \u0026#34;bar\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼ŒProxy.defineProperty å¯¹å±æ€§èµ‹å€¼è®¾ç½®äº†æ‹¦æˆªï¼Œç„¶åä½¿ç”¨ Reflect.defineProperty å®Œæˆäº†èµ‹å€¼ã€‚\ngetOwnPropertyDescriptor() Reflect.getOwnPropertyDescriptor(target, name)\nReflect.getOwnPropertyDescriptor() åŸºæœ¬ç­‰åŒäº Object.getOwnPropertyDescriptor() ï¼Œç”¨äºå¾—åˆ°æŒ‡å®šå±æ€§çš„æè¿°å¯¹è±¡ï¼Œå°†æ¥ä¼šæ›¿ä»£æ‰åè€…ã€‚\nconst myObject = {}; Object.defineProperty(myObject, \u0026#39;hidden\u0026#39;, { value: true, enumerable: false, }); // æ—§å†™æ³• let theDescriptor = Object.getOwnPropertyDescriptor(myObject, \u0026#39;hidden\u0026#39;); // æ–°å†™æ³• let theDescriptorR = Reflect.getOwnPropertyDescriptor(myObject, \u0026#39;hidden\u0026#39;); console.log(theDescriptor, theDescriptorR); Reflect.getOwnPropertyDescriptor å’Œ Object.getOwnPropertyDescriptor çš„ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œ Object.getOwnPropertyDescriptor(1, \u0026lsquo;foo\u0026rsquo;) ä¸æŠ¥é”™ï¼Œè¿”å› undefined ï¼Œè€Œ Reflect.getOwnPropertyDescriptor(1, \u0026lsquo;foo\u0026rsquo;) ä¼šæŠ›å‡ºé”™è¯¯ï¼Œè¡¨ç¤ºå‚æ•°éæ³•ã€‚\nisExtensible() Reflect.isExtensible(target)\nReflect.isExtensible() æ–¹æ³•å¯¹åº” Object.isExtensible() ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰å¯¹è±¡æ˜¯å¦å¯æ‰©å±•ã€‚\nconst myObject = {}; // æ—§å†™æ³• Object.isExtensible(myObject) // true // æ–°å†™æ³• Reflect.isExtensible(myObject) // true å¦‚æœå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼ŒObject.isExtensible ä¼šè¿”å› false ï¼Œå› ä¸ºéå¯¹è±¡æœ¬æ¥å°±æ˜¯ä¸å¯æ‰©å±•çš„ï¼Œè€Œ Reflect.isExtensible ä¼šæŠ¥é”™ã€‚\nObject.isExtensible(1) // false Reflect.isExtensible(1) // æŠ¥é”™ preventExtensions() Reflect.preventExtensions(target)\nReflect.preventExtensions() å¯¹åº” Object.preventExtensions() æ–¹æ³•ï¼Œç”¨äºè®©ä¸€ä¸ªå¯¹è±¡å˜ä¸ºä¸å¯æ‰©å±•ã€‚å®ƒè¿”å›ä¸€ä¸ª boolean ï¼Œè¡¨ç¤ºæ˜¯å¦æ“ä½œæˆåŠŸã€‚\nconst myObject = {}; // æ—§å†™æ³• Object.preventExtensions(myObject) // Object {} // æ–°å†™æ³• Reflect.preventExtensions(myObject) // true å¦‚æœå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼ŒObject.preventExtensions åœ¨ ES5 ç¯å¢ƒæŠ¥é”™ï¼Œåœ¨ ES6 ç¯å¢ƒè¿”å›ä¼ å…¥çš„å‚æ•°ï¼Œè€Œ Reflect.preventExtensions ä¼šæŠ¥é”™ã€‚\n// ES5 ç¯å¢ƒ Object.preventExtensions(1) // æŠ¥é”™ // ES6 ç¯å¢ƒ Object.preventExtensions(1) // 1 // æ–°å†™æ³• Reflect.preventExtensions(1) // æŠ¥é”™ ownKeys():star: Reflect.ownKeys(target)\nReflect.ownKeys() æ–¹æ³•ç”¨äºè¿”å›å¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼ŒåŸºæœ¬ç­‰åŒäº Object.getOwnPropertyNames() ä¸ Object.getOwnPropertySymbols() ä¹‹å’Œã€‚\nconst obj = { foo: 1, bar: 2, [Symbol.for(\u0026#39;baz\u0026#39;)]: 3, [Symbol.for(\u0026#39;bing\u0026#39;)]: 4, }; console.log( Object.keys(obj), // [\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;] // æ—§å†™æ³• Object.getOwnPropertyNames(obj), // [\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;] Object.getOwnPropertySymbols(obj), // [Symbol(baz), Symbol(bing)] // æ–°å†™æ³• Reflect.ownKeys(obj), // [\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;, Symbol(baz), Symbol(bing)] ); å¦‚æœ Reflect.ownKeys() æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œä¼šæŠ¥é”™ã€‚\nğŸ“ Note å’Œ Object.entities() çš„åŒºåˆ«æ˜¯ï¼Œ Reflect.ownKeys() å¯ä»¥è¿­ä»£ Symbol ç±»å‹ã€‚\n// Reflect.ownKeys() for (const value of Reflect.ownKeys(obj)) { console.log(value, obj[value]) } // foo 1 bar 2 Symbol(baz) 3 Symbol(bing) 4 // Object.entries() for (const value of Object.entries(obj)) { console.log(value) } // [ \u0026#39;foo\u0026#39;, 1 ] [ \u0026#39;bar\u0026#39;, 2 ] Getter \u0026amp; setter å¯¹è±¡æ·»åŠ  getter ä¸ setter çš„ 5 ç§æ–¹æ³•\nåˆå§‹åŒ–å™¨ ä¹Ÿå¯ç§°ä¸ºé€šè¿‡å­—é¢å€¼åˆ›å»ºå¯¹è±¡æ—¶å£°æ˜\nconst obj = { a: 7, get b() { return this.a + 1; },//é€šè¿‡ get,setçš„b,cæ–¹æ³•é—´æ¥æ€§ä¿®æ”¹aå±æ€§ set c(x) { this.a = x / 2 } }; console.log( obj.a, // 7 obj.b, // 7+1=8 obj.c = 50, obj.a // 25 ); create() Object.create(proto[, propertiesObject])\npropertiesObject æ˜¯å¯é€‰å‚æ•°ï¼ŒæŒ‡å®šè¦æ·»åŠ åˆ°æ–°å¯¹è±¡ä¸Šçš„ å¯æšä¸¾çš„å±æ€§iterable çš„æè¿°ç¬¦åŠç›¸åº”çš„å±æ€§åç§°ã€‚ let obj = Object.create(Object.prototype, //æŒ‡å®šåŸå‹ä¸º Object.prototype { bar: { get: function () { return 10; }, set: function (val) { console.log(`Setting obj.bar to ${val}`); }, configurable: true } } // ç¬¬äºŒä¸ªå‚æ•° ); console.log(obj.bar); // 10 obj.bar = 12; // Setting obj.bar to 12 defineProperty() Object.defineProperty(obj, prop, descriptor)\nobj éœ€è¦å®šä¹‰å±æ€§çš„å¯¹è±¡ prop éœ€è¢«å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§å descriptor éœ€è¢«å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§çš„æè¿°å¯¹è±¡ è¿”å›çš„æ˜¯ å¯¹è±¡object ï¼Œè€Œ Reflect.defineProprty() è¿”å›çš„æ˜¯ å¸ƒå°”å€¼boolean ã€‚\nlet obj = {a: 1};//å£°æ˜ä¸€ä¸ªå¯¹è±¡,åŒ…å«ä¸€ä¸ª a å±æ€§,å€¼ä¸º1 Object.defineProperty(obj, \u0026#34;b\u0026#34;, { get: function () { return this.a; }, set: function (val) { this.a = val * 2; }, configurable: true }); console.log( obj.b, // 1 obj.b = 2, obj.b //4 ); è¿™ä¸ªæ–¹æ³•ä¸å‰é¢ä¸¤ç§çš„åŒºåˆ«æ˜¯ï¼šä½¿ç”¨å‰é¢ä¸¤ç§åªèƒ½åœ¨å£°æ˜å®šä¹‰çš„æ—¶å€™æŒ‡å®š getter() ä¸ setter() ï¼Œä½¿ç”¨è¯¥æ–¹æ³•å¯ä»¥éšæ—¶çš„æ·»åŠ æˆ–ä¿®æ”¹ã€‚\nå¦‚æœè¯´éœ€è¦ä¸€æ¬¡æ€§æ‰¹é‡æ·»åŠ getter() ä¸ setter() ä¹Ÿæ˜¯æ²¡é—®é¢˜çš„ï¼Œä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š\ndefineProperties() Object.defineProperties(obj, prop)\nobj å°†è¦è¢«æ·»åŠ å±æ€§æˆ–ä¿®æ”¹å±æ€§çš„å¯¹è±¡ props è¯¥å¯¹è±¡çš„ä¸€ä¸ªæˆ–å¤šä¸ª é”®å€¼å¯¹key-value å®šä¹‰äº†å°†è¦ä¸ºå¯¹è±¡æ·»åŠ æˆ–ä¿®æ”¹çš„å±æ€§çš„å…·ä½“é…ç½® ä¸éš¾çœ‹å‡ºç”¨æ³•ä¸ Object.defineProperty æ–¹æ³•ç±»ä¼¼ï¼Œåªæ˜¯å¯ä»¥åŒæ—¶è®¾ç½®å¤šä¸ªå±æ€§ã€‚\nconst obj = {a: 1, b: \u0026#34;string\u0026#34;}; Object.defineProperties(obj, { A: { get () { return this.a + 1; }, set (val) { this.a = val; } }, B: { get () { return this.b + 2; }, set (val) { this.b = val } } }); console.log( obj.A, // 2 obj.B, // string2 obj.A = 3, obj.B = \u0026#34;hello\u0026#34;, obj.A, // 4 obj.B, // hello2 ); __defineGetter__ \u0026amp; __defineSetter__ Object.prototype.__defineGetter__ ä»¥åŠ Object.prototype.__defineSetter__ æ–¹æ³•\nç±»ä¼¼ __proto__ å±äºæµè§ˆå™¨å†…éƒ¨å±æ€§ï¼Œä¸å»ºè®®ä½¿ç”¨ã€‚\nPromise :link: Href ES6 Promise åº”ç”¨\nğŸ“ Note å­¦ä¹ è·¯çº¿ï¼šAJAX â†’ Promise â†’ Axios â†’ React/Vue\nPromise æ˜¯ å¼‚æ­¥ç¼–ç¨‹ çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œæ¯”ä¼ ç»Ÿçš„è§£å†³æ–¹æ¡ˆâ€”â€”å›è°ƒå‡½æ•°å’Œäº‹ä»¶â€”â€”æ›´åˆç†å’Œæ›´å¼ºå¤§ã€‚å®ƒç”±ç¤¾åŒºæœ€æ—©æå‡ºå’Œå®ç°ï¼ŒES6 å°†å…¶å†™è¿›äº†è¯­è¨€æ ‡å‡†ï¼Œç»Ÿä¸€äº†ç”¨æ³•ï¼ŒåŸç”Ÿæä¾›äº† Promise å¯¹è±¡ã€‚\næ‰€è°“ Promise ï¼Œç®€å•è¯´å°±æ˜¯ä¸€ä¸ª å®¹å™¨container ï¼Œé‡Œé¢ä¿å­˜ç€æŸä¸ªæœªæ¥æ‰ä¼šç»“æŸçš„äº‹ä»¶ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼‰çš„ç»“æœã€‚ä»è¯­æ³•ä¸Šè¯´ï¼ŒPromise æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»å®ƒå¯ä»¥è·å–å¼‚æ­¥æ“ä½œçš„æ¶ˆæ¯ã€‚\nPromise æ˜¯ç”¨æ¥è§£å†³è¿™äº›é—®é¢˜çš„ï¼š\nå›è°ƒåœ°ç‹±ï¼Œä»£ç éš¾ä»¥ç»´æŠ¤ï¼Œ å¸¸å¸¸ç¬¬ä¸€ä¸ªçš„å‡½æ•°çš„è¾“å‡ºæ˜¯ç¬¬äºŒä¸ªå‡½æ•°çš„è¾“å…¥è¿™ç§ç°è±¡ Promise å¯ä»¥æ”¯æŒå¤šä¸ªå¹¶å‘çš„è¯·æ±‚ï¼Œè·å–å¹¶å‘è¯·æ±‚ä¸­çš„æ•°æ® æä¾›ç»Ÿä¸€çš„ APIï¼Œå„ç§å¼‚æ­¥æ“ä½œéƒ½å¯ä»¥ç”¨åŒæ ·çš„æ–¹æ³•è¿›è¡Œå¤„ç† ä¸€ä¸ª Promise å¯¹è±¡ä»£è¡¨ä¸€ä¸ªåœ¨è¿™ä¸ª Promise è¢«åˆ›å»ºå‡ºæ¥æ—¶ä¸ä¸€å®šæ˜¯å·²çŸ¥çš„å€¼ã€‚å®ƒè®©æ‚¨èƒ½å¤ŸæŠŠå¼‚æ­¥æ“ä½œæœ€ç»ˆçš„æˆåŠŸè¿”å›å€¼æˆ–è€…å¤±è´¥åŸå› å’Œç›¸åº”çš„å¤„ç†ç¨‹åºå…³è”èµ·æ¥ã€‚ è¿™æ ·ä½¿å¾—å¼‚æ­¥æ–¹æ³•å¯ä»¥åƒåŒæ­¥æ–¹æ³•é‚£æ ·è¿”å›å€¼ï¼šå¼‚æ­¥æ–¹æ³•å¹¶ä¸ä¼šç«‹å³è¿”å›æœ€ç»ˆçš„å€¼ï¼Œè€Œæ˜¯ä¼šè¿”å›ä¸€ä¸ª Promiseï¼Œä»¥ä¾¿åœ¨æœªæ¥æŸä¸ªæ—¶å€™æŠŠå€¼äº¤ç»™ä½¿ç”¨è€…ã€‚Promise å¯ä»¥è§£å†³å¼‚æ­¥çš„é—®é¢˜ï¼Œä½†ä¸èƒ½è¯´ Promise æœ¬èº«æ˜¯å¼‚æ­¥çš„ã€‚\nPromise å¯¹è±¡æœ‰ä»¥ä¸‹ä¸¤ä¸ªç‰¹ç‚¹ã€‚\nå¯¹è±¡çš„çŠ¶æ€ä¸å—å¤–ç•Œå½±å“ã€‚ Promise å¯¹è±¡ä»£è¡¨ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œæœ‰ä¸‰ç§çŠ¶æ€ï¼š pending è¿›è¡Œä¸­ã€ fulfilledå·²æˆåŠŸ å’Œ rejectedå·²å¤±è´¥ ã€‚åªæœ‰å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œå¯ä»¥å†³å®šå½“å‰æ˜¯å“ªä¸€ç§çŠ¶æ€ï¼Œä»»ä½•å…¶ä»–æ“ä½œéƒ½æ— æ³•æ”¹å˜è¿™ä¸ªçŠ¶æ€ã€‚è¿™ä¹Ÿæ˜¯ Promise è¿™ä¸ªåå­—çš„ç”±æ¥ï¼Œå®ƒçš„è‹±è¯­æ„æ€å°±æ˜¯â€œæ‰¿è¯ºâ€ï¼Œè¡¨ç¤ºå…¶ä»–æ‰‹æ®µæ— æ³•æ”¹å˜\nä¸€æ—¦çŠ¶æ€æ”¹å˜ï¼Œå°±ä¸ä¼šå†å˜ï¼Œä»»ä½•æ—¶å€™éƒ½å¯ä»¥å¾—åˆ°è¿™ä¸ªç»“æœã€‚ Promise å¯¹è±¡çš„çŠ¶æ€æ”¹å˜ï¼Œåªæœ‰ä¸¤ç§å¯èƒ½ï¼šä» pending å˜ä¸º fulfilled å’Œä» pending å˜ä¸º rejected ã€‚åªè¦è¿™ä¸¤ç§æƒ…å†µå‘ç”Ÿï¼ŒçŠ¶æ€å°±å‡å›ºäº†ï¼Œä¸ä¼šå†å˜äº†ï¼Œä¼šä¸€ç›´ä¿æŒè¿™ä¸ªç»“æœï¼Œè¿™æ—¶å°±ç§°ä¸º resolvedå·²å®šå‹ ã€‚å¦‚æœæ”¹å˜å·²ç»å‘ç”Ÿäº†ï¼Œä½ å†å¯¹ Promise å¯¹è±¡æ·»åŠ å›è°ƒå‡½æ•°ï¼Œä¹Ÿä¼šç«‹å³å¾—åˆ°è¿™ä¸ªç»“æœ\nè¿™ä¸ Eventäº‹ä»¶ å®Œå…¨ä¸åŒï¼Œäº‹ä»¶çš„ç‰¹ç‚¹æ˜¯ï¼Œå¦‚æœä½ é”™è¿‡äº†å®ƒï¼Œå†å»ç›‘å¬ï¼Œæ˜¯å¾—ä¸åˆ°ç»“æœçš„\n$$ Promise: pending \\Rightarrow \\left\\{\\begin{matrix} fulfilled\\\\ rejected \\end{matrix}\\right. \\Rightarrow resolved^{å·²å®šå‹} $$ æ³¨æ„ï¼Œä¸ºäº†è¡Œæ–‡æ–¹ä¾¿ï¼Œæœ¬ç« åé¢çš„ resolved ç»Ÿä¸€åªæŒ‡çŠ¶æ€ï¼Œä¸åŒ…å« rejected çŠ¶æ€ã€‚\næœ‰äº† Promise å¯¹è±¡ï¼Œå°±å¯ä»¥å°†å¼‚æ­¥æ“ä½œä»¥åŒæ­¥æ“ä½œçš„æµç¨‹è¡¨è¾¾å‡ºæ¥ï¼Œé¿å…äº†å±‚å±‚åµŒå¥—çš„å›è°ƒå‡½æ•°ã€‚æ­¤å¤–ï¼Œ Promise å¯¹è±¡æä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œä½¿å¾—æ§åˆ¶å¼‚æ­¥æ“ä½œæ›´åŠ å®¹æ˜“ã€‚\nPromise ä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ï¼š\næ— æ³•å–æ¶ˆ Promise ï¼Œä¸€æ—¦æ–°å»ºå®ƒå°±ä¼šç«‹å³æ‰§è¡Œï¼Œæ— æ³•ä¸­é€”å–æ¶ˆ å¦‚æœä¸è®¾ç½®å›è°ƒå‡½æ•°ï¼Œ Promise å†…éƒ¨æŠ›å‡ºçš„é”™è¯¯ï¼Œä¸ä¼šååº”åˆ°å¤–éƒ¨ å½“å¤„äº pending çŠ¶æ€æ—¶ï¼Œæ— æ³•å¾—çŸ¥ç›®å‰è¿›å±•åˆ°å“ªä¸€ä¸ªé˜¶æ®µï¼ˆåˆšåˆšå¼€å§‹è¿˜æ˜¯å³å°†å®Œæˆï¼‰ã€‚ å¦‚æœæŸäº›äº‹ä»¶ä¸æ–­åœ°åå¤å‘ç”Ÿï¼Œä¸€èˆ¬æ¥è¯´ï¼Œä½¿ç”¨ Stream æ¨¡å¼æ˜¯æ¯”éƒ¨ç½² Promise æ›´å¥½çš„é€‰æ‹©ã€‚\ngraph LR A[\u0026lt;ruby\u0026gt;Promise\u0026lt;rt\u0026gt;pending\u0026lt;/rt\u0026gt;\u0026lt;/ruby\u0026gt;] --\u0026gt;|fulfill| B(\u0026#34;\u0026lt;ruby\u0026gt;.then(onFulfillment)\u0026lt;rt\u0026gt;settled\u0026lt;/rt\u0026gt;\u0026lt;/ruby\u0026gt;\u0026#34;) A --\u0026gt;|reject| C(\u0026#34;.then(..., onRejection)\u0026lt;br\u0026gt;.catch(.onRejection)\u0026#34;) B --\u0026gt; D(\u0026#34;async actions\u0026#34;) B --\u0026gt;|return| E[\u0026lt;ruby\u0026gt;Promise\u0026lt;rt\u0026gt;pending\u0026lt;/rt\u0026gt;\u0026lt;/ruby\u0026gt;] C --\u0026gt;|return| E C --\u0026gt; F(\u0026#34;error handling\u0026#34;) E --\u0026gt; G(\u0026#34;.then\u0026lt;br\u0026gt;.catch\u0026#34;) -..-\u0026gt; H(\u0026#34;...\u0026#34;) åŸºæœ¬ ES6 è§„å®šï¼Œ Promise å¯¹è±¡æ˜¯ä¸€ä¸ª æ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆ Promise å®ä¾‹ã€‚\nğŸ“ƒ Example\nä¸‹é¢ä»£ç åˆ›é€ äº†ä¸€ä¸ª Promise å®ä¾‹ã€‚\nconst promise = new Promise((resolve, reject) =\u0026gt; { /* å¼‚æ­¥æ“ä½œ */ if (/* å¼‚æ­¥æ“ä½œæˆåŠŸ */) { let value; resolve(value); // å½“å¼‚æ­¥ä»£ç æ‰§è¡ŒæˆåŠŸæ—¶ï¼Œæˆ‘ä»¬æ‰ä¼šè°ƒç”¨resolve(...); } else /* å¼‚æ­¥æ“ä½œå¤±è´¥ */ { let error; reject(error); // å½“å¼‚æ­¥ä»£ç å¤±è´¥æ—¶å°±ä¼šè°ƒç”¨reject(...); } }).then(data =\u0026gt; { /* è°ƒç”¨æˆåŠŸå¤„ç† */ }, err =\u0026gt; { /* è°ƒç”¨å¤±è´¥å¤„ç† */ }); Promise æ„é€ å‡½æ•°æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°çš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ resolve å’Œ reject ã€‚å®ƒä»¬æ˜¯ä¸¤ä¸ªå‡½æ•°ï¼Œç”± JavaScript å¼•æ“æä¾›ï¼Œä¸ç”¨è‡ªå·±éƒ¨ç½²ã€‚\nğŸ“ Note resolve() å‡½æ•°çš„ä½œç”¨æ˜¯ï¼Œå°† Promise å¯¹è±¡çš„çŠ¶æ€ä» æœªå®Œæˆpending å˜ä¸º æˆåŠŸresolved ï¼Œåœ¨å¼‚æ­¥æ“ä½œæˆåŠŸæ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»\nreject() å‡½æ•°çš„ä½œç”¨æ˜¯ï¼Œå°† Promise å¯¹è±¡çš„çŠ¶æ€ä» æœªå®Œæˆpending å˜ä¸º å¤±è´¥rejected ï¼Œåœ¨å¼‚æ­¥æ“ä½œå¤±è´¥æ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œæŠ¥å‡ºçš„é”™è¯¯ï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»ã€‚\nPromise å®ä¾‹ç”Ÿæˆä»¥åï¼Œå¯ä»¥ç”¨ then() æ–¹æ³•åˆ†åˆ«æŒ‡å®š resolved çŠ¶æ€å’Œ rejected çŠ¶æ€çš„å›è°ƒå‡½æ•°ã€‚\npromise.then(function(value) { // success }, function(error) { // failure }); then() æ–¹æ³•å¯ä»¥æ¥å—ä¸¤ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ã€‚ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°æ˜¯ Promise å¯¹è±¡çš„çŠ¶æ€å˜ä¸º resolved æ—¶è°ƒç”¨ï¼Œç¬¬äºŒä¸ªå›è°ƒå‡½æ•°æ˜¯ Promise å¯¹è±¡çš„çŠ¶æ€å˜ä¸º rejected æ—¶è°ƒç”¨ã€‚å…¶ä¸­ï¼Œç¬¬äºŒä¸ªå‡½æ•°æ˜¯å¯é€‰çš„ï¼Œä¸ä¸€å®šè¦æä¾›ã€‚è¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ¥å— Promise å¯¹è±¡ä¼ å‡ºçš„å€¼ä½œä¸ºå‚æ•°ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ª Promise å¯¹è±¡çš„ç®€å•ä¾‹å­ã€‚\nğŸ“ƒ Example\nlet timeout = ms =\u0026gt; new Promise(resolve =\u0026gt; setTimeout(resolve, ms, \u0026#39;done\u0026#39;) ); timeout(1000).then(value =\u0026gt; console.log(value) ); ä¸Šé¢ä»£ç ä¸­ï¼Œtimeout æ–¹æ³•è¿”å›ä¸€ä¸ª Promise å®ä¾‹ï¼Œè¡¨ç¤ºä¸€æ®µæ—¶é—´ä»¥åæ‰ä¼šå‘ç”Ÿçš„ç»“æœã€‚è¿‡äº†æŒ‡å®šçš„æ—¶é—´ï¼ˆ ms å‚æ•°ï¼‰ä»¥åï¼Œ Promise å®ä¾‹çš„çŠ¶æ€å˜ä¸º resolved ï¼Œå°±ä¼šè§¦å‘ then() æ–¹æ³•ç»‘å®šçš„å›è°ƒå‡½æ•°ã€‚\nPromise æ–°å»ºåå°±ä¼š ç«‹å³æ‰§è¡Œ ã€‚\nğŸ“ƒ Example\nlet promise = new Promise(resolve =\u0026gt; { console.log(\u0026#39;Promise\u0026#39;); resolve(); }); promise.then(_ =\u0026gt; console.log(\u0026#39;resolved.\u0026#39;) ); console.log(\u0026#39;Hi!\u0026#39;); // Promise Hi! resolved ä¸Šé¢ä»£ç ä¸­ï¼ŒPromise æ–°å»ºå ç«‹å³æ‰§è¡Œ ï¼Œæ‰€ä»¥é¦–å…ˆè¾“å‡ºçš„æ˜¯ Promise ã€‚ç„¶åï¼Œthen æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œå°†åœ¨å½“å‰è„šæœ¬æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ‰ä¼šæ‰§è¡Œï¼Œæ‰€ä»¥ resolved æœ€åè¾“å‡ºã€‚\nä¸‹é¢æ˜¯å¼‚æ­¥åŠ è½½å›¾ç‰‡çš„ä¾‹å­ã€‚\nğŸ“ƒ Example\nfunction loadImageAsync(url) { return new Promise(function(resolve, reject) { const image = new Image(); image.onload = function() { resolve(image); }; image.onerror = function() { reject( new Error(\u0026#39;Could not load image at \u0026#39; + url) ); }; image.src = url; }); } ä¸Šé¢ä»£ç ä¸­ï¼Œä½¿ç”¨ Promise åŒ…è£…äº†ä¸€ä¸ªå›¾ç‰‡åŠ è½½çš„å¼‚æ­¥æ“ä½œã€‚å¦‚æœåŠ è½½æˆåŠŸï¼Œå°±è°ƒç”¨ resolve æ–¹æ³•ï¼Œå¦åˆ™å°±è°ƒç”¨ reject æ–¹æ³•ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªç”¨ Promise å¯¹è±¡å®ç°çš„ Ajax æ“ä½œçš„ä¾‹å­ã€‚\nğŸ“ƒ Example\nconst getJSON = url =\u0026gt; new Promise(function (resolve, reject) { const handler = function () { if (this.readyState !== 4) { return; } if (this.status === 200) { resolve(this.response); } else { reject(new Error(this.statusText)); } }; const client = new XMLHttpRequest(); client.open(\u0026#34;GET\u0026#34;, url); client.onreadystatechange = handler; client.responseType = \u0026#34;json\u0026#34;; client.setRequestHeader(\u0026#34;Accept\u0026#34;, \u0026#34;application/json\u0026#34;); client.send(); }); getJSON(\u0026#34;/index.html\u0026#34;).then( json =\u0026gt; console.log(\u0026#39;Contents: \u0026#39; + json), error =\u0026gt; console.error(\u0026#39;å‡ºé”™äº†\u0026#39;, error) ); // Promise {\u0026lt;pending\u0026gt;} // [[Prototype]]: Promise // [[PromiseState]]: \u0026#34;fulfilled\u0026#34; // [[PromiseResult]]: undefined //-\u0026gt; Contents: null ä¸Šé¢ä»£ç ä¸­ï¼ŒgetJSON æ˜¯å¯¹ XMLHttpRequest å¯¹è±¡çš„å°è£…ï¼Œç”¨äºå‘å‡ºä¸€ä¸ªé’ˆå¯¹ JSON æ•°æ®çš„ HTTP è¯·æ±‚ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ getJSON å†…éƒ¨ï¼Œ resolve å‡½æ•°å’Œ reject å‡½æ•°è°ƒç”¨æ—¶ï¼Œéƒ½å¸¦æœ‰å‚æ•°ã€‚\nå¦‚æœè°ƒç”¨ resolve å‡½æ•°å’Œ reject å‡½æ•°æ—¶å¸¦æœ‰å‚æ•°ï¼Œé‚£ä¹ˆå®ƒä»¬çš„å‚æ•°ä¼šè¢«ä¼ é€’ç»™å›è°ƒå‡½æ•°ã€‚ reject å‡½æ•°çš„å‚æ•°é€šå¸¸æ˜¯ Error å¯¹è±¡çš„å®ä¾‹ï¼Œè¡¨ç¤ºæŠ›å‡ºçš„é”™è¯¯ï¼› resolve å‡½æ•°çš„å‚æ•°é™¤äº†æ­£å¸¸çš„å€¼ä»¥å¤–ï¼Œè¿˜å¯èƒ½æ˜¯å¦ä¸€ä¸ª Promise å®ä¾‹ï¼Œæ¯”å¦‚åƒä¸‹é¢è¿™æ ·ã€‚\nğŸ“ƒ Example\nconst p1 = new Promise(function (resolve, reject) { // ... }); const p2 = new Promise(function (resolve, reject) { // ... resolve(p1); }) ä¸Šé¢ä»£ç ä¸­ï¼Œ p1 å’Œ p2 éƒ½æ˜¯ Promise çš„å®ä¾‹ï¼Œä½†æ˜¯ p2 çš„ resolve æ–¹æ³•å°† p1 ä½œä¸ºå‚æ•°ï¼Œå³ä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„ç»“æœæ˜¯ è¿”å›å¦ä¸€ä¸ªå¼‚æ­¥æ“ä½œ ã€‚\næ³¨æ„ï¼Œè¿™æ—¶ p1 çš„çŠ¶æ€å°±ä¼šä¼ é€’ç»™ p2 ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ p1 çš„çŠ¶æ€å†³å®šäº† p2 çš„çŠ¶æ€ã€‚å¦‚æœ p1 çš„çŠ¶æ€æ˜¯ pending ï¼Œé‚£ä¹ˆ p2 çš„å›è°ƒå‡½æ•°å°±ä¼šç­‰å¾… p1 çš„çŠ¶æ€æ”¹å˜ï¼›å¦‚æœ p1 çš„çŠ¶æ€å·²ç»æ˜¯ resolved æˆ–è€… rejected ï¼Œé‚£ä¹ˆ p2 çš„å›è°ƒå‡½æ•°å°†ä¼šç«‹åˆ»æ‰§è¡Œã€‚\nğŸ“ƒ Example\nconst p1 = new Promise((resolve, reject) =\u0026gt; setTimeout(() =\u0026gt; reject(new Error(\u0026#39;fail\u0026#39;)), 3000) ); const p2 = new Promise(resolve =\u0026gt; setTimeout(() =\u0026gt; resolve(p1), 1000) ); p2.then(result =\u0026gt; console.log(result)) .catch(error =\u0026gt; console.log(error)); // Error: fail // at Timeout._onTimeout // at listOnTimeout // at processTimers ä¸Šé¢ä»£ç ä¸­ï¼Œ p1 æ˜¯ä¸€ä¸ª Promiseï¼Œ3 ç§’ä¹‹åå˜ä¸º rejected ã€‚ p2 çš„çŠ¶æ€åœ¨ 1 ç§’ä¹‹åæ”¹å˜ï¼Œ resolve æ–¹æ³•è¿”å›çš„æ˜¯ p1 ã€‚ç”±äº p2 è¿”å›çš„æ˜¯å¦ä¸€ä¸ª Promiseï¼Œå¯¼è‡´ p2 è‡ªå·±çš„çŠ¶æ€æ— æ•ˆäº†ï¼Œç”± p1 çš„çŠ¶æ€å†³å®š p2 çš„çŠ¶æ€ã€‚æ‰€ä»¥ï¼Œåé¢çš„ then() è¯­å¥éƒ½å˜æˆé’ˆå¯¹åè€…ï¼ˆ p1 ï¼‰ã€‚åˆè¿‡äº† 2 ç§’ï¼Œ p1 å˜ä¸º rejected ï¼Œå¯¼è‡´è§¦å‘ catch æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚\næ³¨æ„ï¼Œè°ƒç”¨ resolve æˆ– reject å¹¶ä¸ä¼š ç»ˆç»“ Promise çš„å‚æ•°å‡½æ•°çš„æ‰§è¡Œã€‚\nğŸ“ƒ Example\nnew Promise(resolve =\u0026gt; { resolve(1); console.log(2); }).then(r =\u0026gt; { console.log(r); }); // 2 1 ä¸Šé¢ä»£ç ä¸­ï¼Œè°ƒç”¨ resolve(1) ä»¥åï¼Œåé¢çš„ console.log(2) è¿˜æ˜¯ä¼šæ‰§è¡Œï¼Œå¹¶ä¸”ä¼šé¦–å…ˆæ‰“å°å‡ºæ¥ã€‚è¿™æ˜¯å› ä¸ºç«‹å³ resolved çš„ Promise æ˜¯åœ¨æœ¬è½®äº‹ä»¶å¾ªç¯çš„ æœ«å°¾ æ‰§è¡Œï¼Œæ€»æ˜¯ æ™šäº æœ¬è½®å¾ªç¯çš„åŒæ­¥ä»»åŠ¡ã€‚\nä¸€èˆ¬æ¥è¯´ï¼Œè°ƒç”¨ resolve æˆ– reject ä»¥åï¼ŒPromise çš„ä½¿å‘½å°±å®Œæˆäº†ï¼Œåç»§æ“ä½œåº”è¯¥æ”¾åˆ° then() æ–¹æ³•é‡Œé¢ï¼Œè€Œä¸åº”è¯¥ç›´æ¥å†™åœ¨ resolve æˆ– reject çš„åé¢ã€‚æ‰€ä»¥ï¼Œæœ€å¥½åœ¨å®ƒä»¬å‰é¢åŠ ä¸Š return() è¯­å¥ï¼Œè¿™æ ·å°±ä¸ä¼šæœ‰æ„å¤–ã€‚\nnew Promise(resolve =\u0026gt; { return resolve(1); // åé¢çš„è¯­å¥ä¸ä¼šæ‰§è¡Œ // Promise returned from Promise is ignored console.log(2); }); æ–¹æ³• Promise. prototype.then(), prototype.catch(), finally(), all(), race(), allSettled(), any(), resolve(), reject(), try()\nthen()\u0026lt;sup id =â€™promise-then\u0026rsquo;\u0026gt; Promise.prototype.then(resolve, reject)\nPromise å®ä¾‹å…·æœ‰ then() æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ then() æ–¹æ³•æ˜¯å®šä¹‰åœ¨åŸå‹å¯¹è±¡ Promise.prototype ä¸Šçš„ã€‚å®ƒçš„ä½œç”¨æ˜¯ä¸º Promise å®ä¾‹æ·»åŠ çŠ¶æ€æ”¹å˜æ—¶çš„å›è°ƒå‡½æ•°ã€‚å‰é¢è¯´è¿‡ï¼Œ then() æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ resolved çŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼ˆå¯é€‰ï¼‰æ˜¯ rejected çŠ¶æ€çš„å›è°ƒå‡½æ•°ã€‚\nthen() æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ª æ–°çš„ Promise å®ä¾‹ï¼ˆæ³¨æ„ï¼Œä¸æ˜¯åŸæ¥é‚£ä¸ª Promise å®ä¾‹ï¼‰ã€‚å› æ­¤å¯ä»¥é‡‡ç”¨é“¾å¼å†™æ³•ï¼Œå³ then() æ–¹æ³•åé¢å†è°ƒç”¨å¦ä¸€ä¸ª then() æ–¹æ³•ã€‚\nğŸ“ƒ Example\nlet getJSON = _ =\u0026gt; new Promise(resolve =\u0026gt; resolve(JSON.stringify({foo: \u0026#39;bar\u0026#39;})) ); getJSON(\u0026#34;/posts.json\u0026#34;).then(json =\u0026gt; JSON.parse(json); ).then(obj =\u0026gt; console.log(obj)); // { foo: \u0026#39;bar\u0026#39; } ä¸Šé¢çš„ä»£ç ä½¿ç”¨ then() æ–¹æ³•ï¼Œä¾æ¬¡æŒ‡å®šäº†ä¸¤ä¸ªå›è°ƒå‡½æ•°ã€‚ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°å®Œæˆä»¥åï¼Œä¼šå°† è¿”å›ç»“æœreturn ä½œä¸ºå‚æ•°ï¼Œä¼ å…¥ç¬¬äºŒä¸ªå›è°ƒå‡½æ•°ã€‚\né‡‡ç”¨ é“¾å¼ çš„ then() ï¼Œå¯ä»¥æŒ‡å®šä¸€ç»„æŒ‰ç…§æ¬¡åºè°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚è¿™æ—¶ï¼Œå‰ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæœ‰å¯èƒ½è¿”å›çš„è¿˜æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼ˆå³æœ‰å¼‚æ­¥æ“ä½œï¼‰ï¼Œè¿™æ—¶åä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå°±ä¼šç­‰å¾…è¯¥ Promise å¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œæ‰ä¼šè¢«è°ƒç”¨ã€‚\nğŸ“ƒ Example\ngetJSON(\u0026#34;/post/1.json\u0026#34;).then( post =\u0026gt; getJSON(post.commentURL) // è¿”å›Promise ).then( comments =\u0026gt; console.log(\u0026#34;resolved: \u0026#34;, comments), err =\u0026gt; console.log(\u0026#34;rejected: \u0026#34;, err) ); ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬ä¸€ä¸ª then() æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œè¿”å›çš„æ˜¯å¦ä¸€ä¸ª Promise å¯¹è±¡ã€‚è¿™æ—¶ï¼Œç¬¬äºŒä¸ª then() æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œå°±ä¼šç­‰å¾…è¿™ä¸ªæ–°çš„ Promise å¯¹è±¡çŠ¶æ€å‘ç”Ÿå˜åŒ–ã€‚å¦‚æœå˜ä¸º resolved ï¼Œå°±è°ƒç”¨ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå¦‚æœçŠ¶æ€å˜ä¸º rejected ï¼Œå°±è°ƒç”¨ç¬¬äºŒä¸ªå›è°ƒå‡½æ•°ã€‚\ncatch() Promise.prototype.catch(rejection)\næ­¤æ–¹æ³•æ˜¯ .then(null, rejection) çš„åˆ«åï¼Œç”¨äºæŒ‡å®šå‘ç”Ÿé”™è¯¯æ—¶çš„å›è°ƒå‡½æ•°ã€‚\nğŸ“ƒ Example\nnew Promise((_, reject) =\u0026gt; reject(Error(\u0026#39;err\u0026#39;)) ).then(posts =\u0026gt; posts // ... ).catch(error =\u0026gt; console.log(\u0026#39;å‘ç”Ÿé”™è¯¯ï¼\u0026#39;, error) // å‘ç”Ÿé”™è¯¯ï¼ Error: err ); // Promise {\u0026lt;fulfilled\u0026gt;: undefined} // [[Prototype]]: Promise // [[PromiseState]]: \u0026#34;fulfilled\u0026#34; // [[PromiseResult]]: undefined ä¸Šé¢ä»£ç ä¸­ï¼ŒgetJSON() æ–¹æ³•è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¦‚æœè¯¥å¯¹è±¡çŠ¶æ€å˜ä¸º resolved ï¼Œåˆ™ä¼šè°ƒç”¨ then() æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼›å¦‚æœå¼‚æ­¥æ“ä½œæŠ›å‡ºé”™è¯¯ï¼ŒçŠ¶æ€å°±ä¼šå˜ä¸º rejected ï¼Œå°±ä¼šè°ƒç”¨catch()æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œå¤„ç†è¿™ä¸ªé”™è¯¯ã€‚\nå¦å¤–ï¼Œthen() æ–¹æ³•æŒ‡å®šçš„ å›è°ƒå‡½æ•°callback ï¼Œå¦‚æœè¿è¡Œä¸­æŠ›å‡º é”™è¯¯Error ï¼Œä¹Ÿä¼šè¢« catch() æ–¹æ³•æ•è·ã€‚\np.then(val =\u0026gt; console.log(\u0026#39;fulfilled:\u0026#39;, val)) .catch(err =\u0026gt; console.log(\u0026#39;rejected\u0026#39;, err) ); // ç­‰åŒäº p.then(val =\u0026gt; console.log(\u0026#39;fulfilled:\u0026#39;, val)) .then(null, err =\u0026gt; console.log(\u0026#34;rejected:\u0026#34;, err) ); ğŸ“ƒ Example ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚\nlet p = new Promise((resolve, reject) =\u0026gt; reject(Error(\u0026#39;err\u0026#39;)) ); const promise = new Promise((resolve, reject) =\u0026gt; throw new Error(\u0026#39;test\u0026#39;) ); promise.catch(error =\u0026gt; console.log(error) ); // Error: test ä¸Šé¢ä»£ç ä¸­ï¼Œ Promise æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå°±è¢« catch() æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°æ•è·ã€‚\nç±»ä¼¼äº try\u0026hellip;catch ã€‚\næ³¨æ„ï¼Œä¸Šé¢çš„å†™æ³•ä¸ä¸‹é¢ä¸¤ç§å†™æ³•æ˜¯ç­‰ä»·çš„ã€‚\n// å†™æ³•ä¸€ const promise = new Promise(function (resolve, reject) { try { // \u0026#39;throw\u0026#39; of exception caught locally // æœ¬åœ°æŠ›å‡ºäº†ä¸€ä¸ªé”™è¯¯ï¼Œç„¶ååˆè¢«catchæ¥æ”¶ throw new Error(\u0026#39;test\u0026#39;); } catch (e) { console.log(\u0026#39;e on t-catch\u0026#39;, e) reject(e); } }); promise.catch(function (error) { console.error(\u0026#39;e on catch\u0026#39;, error) }); // å†™æ³•äºŒ const promise2 = new Promise(function (resolve, reject) { reject(new Error(\u0026#39;test\u0026#39;)); }); promise2.catch(function (error) { console.error(error); }); æ¯”è¾ƒä¸Šé¢ä¸¤ç§å†™æ³•ï¼Œå¯ä»¥å‘ç° reject() æ–¹æ³•çš„ä½œç”¨ï¼Œç­‰åŒäºæŠ›å‡ºé”™è¯¯ã€‚\nå¦‚æœ Promise çŠ¶æ€å·²ç»å˜æˆ resolved ï¼Œå†æŠ›å‡ºé”™è¯¯æ˜¯æ— æ•ˆçš„ã€‚\nğŸ“ƒ Example\nconst promise = new Promise(function (resolve, reject) { resolve(\u0026#39;ok\u0026#39;); throw new Error(\u0026#39;test\u0026#39;); }); promise .then(value =\u0026gt; console.log(value)) .catch(error =\u0026gt; console.log(error)); // ok ä¸Šé¢ä»£ç ä¸­ï¼ŒPromise åœ¨ resolve è¯­å¥åé¢ï¼Œå†æŠ›å‡ºé”™è¯¯ï¼Œä¸ä¼šè¢«æ•è·ï¼Œç­‰äºæ²¡æœ‰æŠ›å‡ºã€‚å› ä¸º Promise çš„çŠ¶æ€ä¸€æ—¦æ”¹å˜ï¼Œå°±æ°¸ä¹…ä¿æŒè¯¥çŠ¶æ€ï¼Œä¸ä¼šå†å˜äº†ã€‚\nPromise å¯¹è±¡çš„é”™è¯¯å…·æœ‰â€œå†’æ³¡â€æ€§è´¨ï¼Œä¼šä¸€ç›´å‘åä¼ é€’ï¼Œç›´åˆ° è¢«æ•è· ä¸ºæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé”™è¯¯æ€»æ˜¯ä¼šè¢«ä¸‹ä¸€ä¸ª catch è¯­å¥æ•è·ã€‚\nğŸ“ƒ Example\nconst promise = new Promise(function(resolve, reject) { resolve(\u0026#39;ok\u0026#39;); throw new Error(\u0026#39;test\u0026#39;); }); promise .then(function(value) { console.log(value) }) .catch(function(error) { console.log(error) }); // ok ä¸Šé¢ä»£ç ä¸­ï¼Œä¸€å…±æœ‰ä¸‰ä¸ª Promise å¯¹è±¡ï¼šä¸€ä¸ªç”± getJSON() äº§ç”Ÿï¼Œä¸¤ä¸ªç”± then() äº§ç”Ÿã€‚å®ƒä»¬ä¹‹ä¸­ä»»ä½•ä¸€ä¸ªæŠ›å‡ºçš„é”™è¯¯ï¼Œéƒ½ä¼šè¢«æœ€åä¸€ä¸ª catch() æ•è·ã€‚\n:star: Important ä¸€èˆ¬æ¥è¯´ï¼Œä¸è¦åœ¨ then() æ–¹æ³•é‡Œé¢å®šä¹‰ Reject çŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼ˆå³ then() çš„ç¬¬äºŒä¸ªå‚æ•°ï¼‰ï¼Œæ€»æ˜¯ä½¿ç”¨ catch() æ–¹æ³•ã€‚\nğŸ“ƒ Example\n/* bad */ new Promise() .then(function (data) { // success }, function (err) { // error }); /* good */ new Promise() .then(function (data) { // success }) .catch(function (err) { // error }); ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬äºŒç§å†™æ³•è¦å¥½äºç¬¬ä¸€ç§å†™æ³•ï¼Œç†ç”±æ˜¯ç¬¬äºŒç§å†™æ³•å¯ä»¥æ•è·å‰é¢ then() æ–¹æ³•æ‰§è¡Œä¸­çš„é”™è¯¯ï¼Œä¹Ÿæ›´æ¥è¿‘åŒæ­¥çš„å†™æ³• try-catch ã€‚å› æ­¤ï¼Œå»ºè®®æ€»æ˜¯ä½¿ç”¨ catch() æ–¹æ³•ï¼Œè€Œä¸ä½¿ç”¨ then() æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚\nè·Ÿä¼ ç»Ÿçš„ try-catch ä»£ç å—ä¸åŒçš„æ˜¯ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨ catch() æ–¹æ³•æŒ‡å®šé”™è¯¯å¤„ç†çš„å›è°ƒå‡½æ•°ï¼ŒPromise å¯¹è±¡æŠ›å‡ºçš„é”™è¯¯ä¸ä¼šä¼ é€’åˆ°å¤–å±‚ä»£ç ï¼Œå³ä¸ä¼šæœ‰ä»»ä½•ååº”ã€‚\nğŸ“ƒ Example\nconst someAsyncThing = _ =\u0026gt; new Promise(function (resolve, reject) { // ä¸‹é¢ä¸€è¡Œä¼šæŠ¥é”™ï¼Œå› ä¸ºxæ²¡æœ‰å£°æ˜ resolve(x + 2); }); someAsyncThing().then(function () { console.log(\u0026#39;everything is great\u0026#39;); }); setTimeout(() =\u0026gt; { console.log(123) }, 2000); // Uncaught (in promise) ReferenceError: x is not defined // 123 ä¸Šé¢ä»£ç ä¸­ï¼ŒsomeAsyncThing() å‡½æ•°äº§ç”Ÿçš„ Promise å¯¹è±¡ï¼Œå†…éƒ¨æœ‰è¯­æ³•é”™è¯¯ã€‚æµè§ˆå™¨è¿è¡Œåˆ°è¿™ä¸€è¡Œï¼Œä¼šæ‰“å°å‡ºé”™è¯¯æç¤º ReferenceError: x is not defined ï¼Œä½†æ˜¯ä¸ä¼šé€€å‡ºè¿›ç¨‹ã€ç»ˆæ­¢è„šæœ¬æ‰§è¡Œï¼Œ2 ç§’ä¹‹åè¿˜æ˜¯ä¼šè¾“å‡º 123 ã€‚è¿™å°±æ˜¯è¯´ï¼ŒPromise å†…éƒ¨çš„é”™è¯¯ä¸ä¼šå½±å“åˆ° Promise å¤–éƒ¨çš„ä»£ç ï¼Œé€šä¿—çš„è¯´æ³•å°±æ˜¯â€œPromise ä¼šåƒæ‰é”™è¯¯â€ã€‚\nè¿™ä¸ªè„šæœ¬æ”¾åœ¨æœåŠ¡å™¨æ‰§è¡Œï¼Œé€€å‡ºç å°±æ˜¯ 0ï¼ˆå³è¡¨ç¤ºæ‰§è¡ŒæˆåŠŸï¼‰ã€‚ä¸è¿‡ï¼ŒNode.js æœ‰ä¸€ä¸ªunhandledRejectionäº‹ä»¶ï¼Œä¸“é—¨ç›‘å¬æœªæ•è·çš„ reject é”™è¯¯ï¼Œä¸Šé¢çš„è„šæœ¬ä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶çš„ç›‘å¬å‡½æ•°ï¼Œå¯ä»¥åœ¨ç›‘å¬å‡½æ•°é‡Œé¢æŠ›å‡ºé”™è¯¯ã€‚\nprocess.on(\u0026#39;unhandledRejection\u0026#39;, function (err, p) { throw err; }); ä¸Šé¢ä»£ç ä¸­ï¼ŒunhandledRejection äº‹ä»¶çš„ç›‘å¬å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯é”™è¯¯å¯¹è±¡ï¼Œç¬¬äºŒä¸ªæ˜¯æŠ¥é”™çš„ Promise å®ä¾‹ï¼Œå®ƒå¯ä»¥ç”¨æ¥äº†è§£å‘ç”Ÿé”™è¯¯çš„ç¯å¢ƒä¿¡æ¯ã€‚\næ³¨æ„ï¼ŒNode æœ‰è®¡åˆ’åœ¨æœªæ¥åºŸé™¤ unhandledRejection äº‹ä»¶ã€‚å¦‚æœ Promise å†…éƒ¨æœ‰æœªæ•è·çš„é”™è¯¯ï¼Œä¼šç›´æ¥ ç»ˆæ­¢è¿›ç¨‹ ï¼Œå¹¶ä¸”è¿›ç¨‹çš„é€€å‡ºç ä¸ä¸º 0 ã€‚\nğŸ“ Note å®æµ‹åœ¨ WebStrom ä¸­å¼‚å¸¸ç»ˆæ­¢äº†è¿›ç¨‹ï¼Œè¿”å›ç ä¸º 1 ã€‚\nå†çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚\nğŸ“ƒ Example\nconst promise = new Promise((resolve, reject) =\u0026gt; { resolve(\u0026#39;ok\u0026#39;); setTimeout(() =\u0026gt; throw new Error(\u0026#39;test\u0026#39;), 0); }); promise.then(value =\u0026gt; console.log(value)); // ok // Uncaught Error: test ä¸Šé¢ä»£ç ä¸­ï¼ŒPromise æŒ‡å®šåœ¨ä¸‹ä¸€è½®â€œäº‹ä»¶å¾ªç¯â€å†æŠ›å‡ºé”™è¯¯ã€‚åˆ°äº†é‚£ä¸ªæ—¶å€™ï¼ŒPromise çš„è¿è¡Œå·²ç»ç»“æŸäº†ï¼Œæ‰€ä»¥è¿™ä¸ªé”™è¯¯æ˜¯åœ¨ Promise å‡½æ•°ä½“å¤–æŠ›å‡ºçš„ï¼Œä¼š å†’æ³¡ åˆ°æœ€ å¤–å±‚ ï¼Œæˆäº†æœªæ•è·çš„é”™è¯¯ã€‚\nä¸€èˆ¬æ€»æ˜¯å»ºè®®ï¼ŒPromise å¯¹è±¡åé¢è¦è·Ÿ catch() æ–¹æ³•ï¼Œè¿™æ ·å¯ä»¥å¤„ç† Promise å†…éƒ¨å‘ç”Ÿçš„é”™è¯¯ã€‚catch() æ–¹æ³•è¿”å›çš„è¿˜æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå› æ­¤åé¢è¿˜å¯ä»¥æ¥ç€è°ƒç”¨ then() æ–¹æ³•ã€‚\nğŸ“ƒ Example\nconst someAsyncThing = _ =\u0026gt; new Promise(_ =\u0026gt; _(x + 2)); // oh no [ReferenceError: x is not defined] someAsyncThing().then().catch(error =\u0026gt; { console.log(\u0026#39;oh no\u0026#39;, error); y + 2; // ReferenceError: y is not defined }).then(_ =\u0026gt; console.log(\u0026#39;carry on\u0026#39;)); ä¸Šé¢ä»£ç è¿è¡Œå®Œ catch() æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œä¼š æ¥ç€è¿è¡Œ åé¢é‚£ä¸ª then() æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚å¦‚æœæ²¡æœ‰æŠ¥é”™ï¼Œåˆ™ä¼šè·³è¿‡ catch() æ–¹æ³•ã€‚\nğŸ“ƒ Example\nPromise.resolve() .catch(error =\u0026gt; console.log(\u0026#39;oh no\u0026#39;, error)) .then(_ =\u0026gt; console.log(\u0026#39;carry on\u0026#39;)); // carry on ä¸Šé¢çš„ä»£ç å› ä¸ºæ²¡æœ‰æŠ¥é”™ï¼Œè·³è¿‡äº† catch() æ–¹æ³•ï¼Œç›´æ¥æ‰§è¡Œåé¢çš„then() æ–¹æ³•ã€‚æ­¤æ—¶ï¼Œè¦æ˜¯ then() æ–¹æ³•é‡Œé¢æŠ¥é”™ï¼Œå°±ä¸å‰é¢çš„catch() æ— å…³äº†ã€‚\ncatch() æ–¹æ³•ä¹‹ä¸­ï¼Œè¿˜èƒ½å†æŠ›å‡ºé”™è¯¯ã€‚\nğŸ“ƒ Example\nconst someAsyncThing = _ =\u0026gt; new Promise(_ =\u0026gt; _(x + 2)); // oh no [ReferenceError: x is not defined] someAsyncThing().then().catch(error =\u0026gt; { console.log(\u0026#39;oh no\u0026#39;, error); y + 2; // ReferenceError: y is not defined }).then(_ =\u0026gt; console.log(\u0026#39;carry on\u0026#39;)); ä¸Šé¢ä»£ç ä¸­ï¼Œcatch()æ–¹æ³•æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºåé¢æ²¡æœ‰åˆ«çš„catch() æ–¹æ³•äº†ï¼Œå¯¼è‡´è¿™ä¸ªé”™è¯¯ä¸ä¼šè¢«æ•è·ï¼Œä¹Ÿä¸ä¼šä¼ é€’åˆ°å¤–å±‚ã€‚\nå¦‚æœæ”¹å†™ä¸€ä¸‹ï¼Œç»“æœå°±ä¸ä¸€æ ·äº†ã€‚\n:page_with_curl: Example 11\nconst someAsyncThing = _ =\u0026gt; new Promise(_ =\u0026gt; _(x + 2)); // oh no [ReferenceError: x is not defined] someAsyncThing().then().catch(error =\u0026gt; { console.error(\u0026#39;oh no\u0026#39;, error); y + 2; // ReferenceError: y is not defined }).then(_ =\u0026gt; console.log(\u0026#39;carry on\u0026#39;)).catch( _ =\u0026gt; console.error(_) ); ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬äºŒä¸ªcatch()æ–¹æ³•ç”¨æ¥æ•è·å‰ä¸€ä¸ªcatch()æ–¹æ³•æŠ›å‡ºçš„é”™è¯¯ã€‚\nfinally() Promise.prototype.finally(onFinally)\nâš ï¸ Caution æ–¹æ³•ä¼¼ä¹æœ‰ä¸€äº›é—®é¢˜ â³\nfinally() æ–¹æ³•ç”¨äºæŒ‡å®šä¸ç®¡ Promise å¯¹è±¡æœ€åçŠ¶æ€å¦‚ä½•ï¼Œéƒ½ä¼šæ‰§è¡Œçš„æ“ä½œã€‚è¯¥æ–¹æ³•æ˜¯ ES2018 å¼•å…¥æ ‡å‡†çš„ã€‚\nğŸ“ƒ Example\npromise .then(result =\u0026gt; {...}) .catch(error =\u0026gt; {...}) .finally(() =\u0026gt; {...}); ä¸Šé¢ä»£ç ä¸­ï¼Œä¸ç®¡ Promise æœ€åçš„çŠ¶æ€ï¼Œåœ¨æ‰§è¡Œå®Œ then() æˆ– catch æŒ‡å®šçš„å›è°ƒå‡½æ•°ä»¥åï¼Œéƒ½ä¼šæ‰§è¡Œ finally æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼ŒæœåŠ¡å™¨ä½¿ç”¨ Promise å¤„ç†è¯·æ±‚ï¼Œç„¶åä½¿ç”¨ finally æ–¹æ³•å…³æ‰æœåŠ¡å™¨ã€‚\nğŸ“ƒ Example\nserver.listen(port) .then(function () { ... }) .finally(server.stop); finally æ–¹æ³•çš„å›è°ƒå‡½æ•°ä¸æ¥å—ä»»ä½•å‚æ•°ï¼Œè¿™æ„å‘³ç€æ²¡æœ‰åŠæ³•çŸ¥é“ï¼Œå‰é¢çš„ Promise çŠ¶æ€åˆ°åº•æ˜¯ fulfilled è¿˜æ˜¯ rejected ã€‚è¿™è¡¨æ˜ï¼Œfinally æ–¹æ³•é‡Œé¢çš„æ“ä½œï¼Œåº”è¯¥æ˜¯ä¸ çŠ¶æ€æ— å…³ çš„ï¼Œä¸ä¾èµ–äº Promise çš„æ‰§è¡Œç»“æœã€‚\nfinally æœ¬è´¨ä¸Šæ˜¯ then() æ–¹æ³•çš„ç‰¹ä¾‹ã€‚\nğŸ“ƒ Example\npromise .finally(() =\u0026gt; { // è¯­å¥ }); // ç­‰åŒäº promise .then( result =\u0026gt; { // è¯­å¥ return result; }, error =\u0026gt; { // è¯­å¥ throw error; } ); ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœä¸ä½¿ç”¨ finally() æ–¹æ³•ï¼ŒåŒæ ·çš„è¯­å¥éœ€è¦ä¸ºæˆåŠŸå’Œå¤±è´¥ä¸¤ç§æƒ…å†µå„å†™ä¸€æ¬¡ã€‚æœ‰äº† finally() æ–¹æ³•ï¼Œåˆ™åªéœ€è¦å†™ä¸€æ¬¡ã€‚\nå®ƒçš„å®ç°ä¹Ÿå¾ˆç®€å•ã€‚\nğŸ“ƒ Example\n// Reflect.setPrototypeOf(Promise, {finally: null}); // ä½¿ç”¨Reflectä¼¼ä¹ä¸èƒ½ä¿®æ”¹å†…éƒ¨æ–¹æ³•ï¼Ÿ Promise.prototype.finally = null if (!Promise.prototype.finally) { Promise.prototype.finally = function (callback) { let P = this.constructor; console.log(P) return this.then( value =\u0026gt; P.resolve(callback(value)) .then(() =\u0026gt; value), reason =\u0026gt; P.resolve(callback(reason)) .then(() =\u0026gt; reason) ); }; } new Promise((resolve, reject) =\u0026gt; { console.log(`Promise.start()`) reject(); }).finally(_ =\u0026gt; console.log(`Promise.finally()`) ).then(_ =\u0026gt; console.log(`Promise.then()`) ); ä¸Šé¢ä»£ç ä¸­ï¼Œä¸ç®¡å‰é¢çš„ Promise æ˜¯ fulfilled è¿˜æ˜¯ rejected ï¼Œéƒ½ä¼šæ‰§è¡Œå›è°ƒå‡½æ•° callbackã€‚\nä»ä¸Šé¢çš„å®ç°è¿˜å¯ä»¥çœ‹åˆ°ï¼Œfinally æ–¹æ³•æ€»æ˜¯ä¼šè¿”å›åŸæ¥çš„å€¼ã€‚\n// resolve çš„å€¼æ˜¯ undefined new Promise(resolve =\u0026gt; resolve(undefined)).then( () =\u0026gt; { }, _ =\u0026gt; console.log(_) ); // resolve çš„å€¼æ˜¯ 2 new Promise(resolve =\u0026gt; resolve(2)) .finally(_ =\u0026gt; console.log(_)); // undefined // reject çš„å€¼æ˜¯ undefined new Promise((resolve, reject) =\u0026gt; reject(undefined)).then(() =\u0026gt; { }, _ =\u0026gt; console.log(_)); // undefined // reject çš„å€¼æ˜¯ 3 new Promise((resolve, reject) =\u0026gt; reject(3)).then(r =\u0026gt; { }) .finally(_ =\u0026gt; console.log(_)) // Uncaught (in promise) undefined æœªçŸ¥é”™è¯¯ .catch(_ =\u0026gt; console.log(`caught error`)); // éœ€è¦æ·»åŠ catchæ•è·é”™è¯¯ all() Promise.all(iterable)\nç”¨äºå°†å¤šä¸ª Promise å®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ã€‚\nğŸ“ƒ Example\nlet p1 =new Promise(() =\u0026gt; {}); let p2 =new Promise(() =\u0026gt; {}); let p3 =new Promise(() =\u0026gt; {}); const p = Promise.all([p1, p2, p3]); ä¸Šé¢ä»£ç ä¸­ï¼ŒPromise.all() æ–¹æ³•æ¥å—ä¸€ä¸ª æ•°ç»„array ä½œä¸ºå‚æ•°ï¼Œp1ã€p2ã€p3 éƒ½æ˜¯ Promise å®ä¾‹ï¼Œå¦‚æœä¸æ˜¯ï¼Œå°±ä¼šå…ˆè°ƒç”¨ä¸‹é¢è®²åˆ°çš„ Promise.resolve æ–¹æ³•ï¼Œå°†å‚æ•°è½¬ä¸º Promise å®ä¾‹ï¼Œå†è¿›ä¸€æ­¥å¤„ç†ã€‚å¦å¤–ï¼ŒPromise.all() æ–¹æ³•çš„å‚æ•°å¯ä»¥ä¸æ˜¯æ•°ç»„ï¼Œä½†å¿…é¡»å…·æœ‰ Iterator æ¥å£ï¼Œä¸”è¿”å›çš„æ¯ä¸ªæˆå‘˜éƒ½æ˜¯ Promise å®ä¾‹ã€‚\nğŸ“ Note\np çš„çŠ¶æ€ç”± p1ã€p2ã€p3 å†³å®šï¼Œåˆ†æˆä¸¤ç§æƒ…å†µã€‚\nåªæœ‰ p1ã€p2ã€p3 çš„çŠ¶æ€éƒ½å˜æˆ fulfilled ï¼Œpçš„çŠ¶æ€æ‰ä¼šå˜æˆ fulfilled ï¼Œæ­¤æ—¶ p1ã€p2ã€p3 çš„è¿”å›å€¼ç»„æˆä¸€ä¸ª æ•°ç»„ ï¼Œä¼ é€’ç»™pçš„å›è°ƒå‡½æ•° åªè¦ p1ã€p2ã€p3 ä¹‹ä¸­æœ‰ä¸€ä¸ªè¢« rejected ï¼Œp çš„çŠ¶æ€å°±å˜æˆ rejected ï¼Œæ­¤æ—¶ç¬¬ä¸€ä¸ªè¢« reject çš„å®ä¾‹çš„è¿”å›å€¼ï¼Œä¼šä¼ é€’ç»™ p çš„å›è°ƒå‡½æ•° ä¸‹é¢æ˜¯ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ã€‚\nğŸ“ƒ Example\nlet getJSON = msg =\u0026gt; new Promise($ =\u0026gt; { let time = Math.random() * 2000 | 0; setTimeout( () =\u0026gt; $(JSON.stringify({[`${time}ms`]: msg})), time ); } ); // ç”Ÿæˆä¸€ä¸ªPromiseå¯¹è±¡çš„æ•°ç»„ const promises = [2, 3, 5, 7, 11, 13] .map(function (id) { return getJSON(\u0026#39;/post/\u0026#39; + id + \u0026#34;.json\u0026#34;); }); Promise.all(promises).then(posts =\u0026gt; console.log(posts) // [ // \u0026#39;{\u0026#34;1304ms\u0026#34;:\u0026#34;/post/2.json\u0026#34;}\u0026#39;, // \u0026#39;{\u0026#34;1756ms\u0026#34;:\u0026#34;/post/3.json\u0026#34;}\u0026#39;, // \u0026#39;{\u0026#34;1198ms\u0026#34;:\u0026#34;/post/5.json\u0026#34;}\u0026#39;, // \u0026#39;{\u0026#34;1814ms\u0026#34;:\u0026#34;/post/7.json\u0026#34;}\u0026#39;, // \u0026#39;{\u0026#34;394ms\u0026#34;:\u0026#34;/post/11.json\u0026#34;}\u0026#39;, // \u0026#39;{\u0026#34;576ms\u0026#34;:\u0026#34;/post/13.json\u0026#34;}\u0026#39; // ] ).catch(e =\u0026gt; { }); ä¸Šé¢ä»£ç ä¸­ï¼Œpromises æ˜¯åŒ…å« 6 ä¸ª Promise å®ä¾‹çš„æ•°ç»„ï¼Œåªæœ‰è¿™ 6 ä¸ªå®ä¾‹çš„çŠ¶æ€éƒ½å˜æˆ fulfilled ï¼Œæˆ–è€…å…¶ä¸­æœ‰ä¸€ä¸ªå˜ä¸º rejected ï¼Œæ‰ä¼šè°ƒç”¨ Promise.all æ–¹æ³•åé¢çš„å›è°ƒå‡½æ•°ã€‚\nåªè¦ä»»ä½•ä¸€ä¸ªè¾“å…¥çš„ Promise çš„ rejected å›è°ƒæ‰§è¡Œæˆ–è€…è¾“å…¥ä¸åˆæ³•çš„ Promise å°±ä¼šç«‹å³æŠ›å‡ºé”™è¯¯ï¼Œå¹¶ä¸” rejected çš„æ˜¯ç¬¬ä¸€ä¸ªæŠ›å‡ºçš„é”™è¯¯ä¿¡æ¯ã€‚\nä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚\nğŸ“ƒ Example\nconst databasePromise = connectDatabase(); const booksPromise = databasePromise .then(findAllBooks); const userPromise = databasePromise .then(getCurrentUser); Promise.all([ booksPromise, userPromise ]) .then(([books, user]) =\u0026gt; pickTopRecommendations(books, user)); ä¸Šé¢ä»£ç ä¸­ï¼ŒbooksPromise å’Œ userPromise æ˜¯ä¸¤ä¸ªå¼‚æ­¥æ“ä½œï¼Œåªæœ‰ç­‰åˆ°å®ƒä»¬çš„ç»“æœéƒ½è¿”å›äº†ï¼Œæ‰ä¼šè§¦å‘ pickTopRecommendations è¿™ä¸ªå›è°ƒå‡½æ•°ã€‚\næ³¨æ„ï¼Œå¦‚æœä½œä¸ºå‚æ•°çš„ Promise å®ä¾‹ï¼Œè‡ªå·±å®šä¹‰äº† catch æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒä¸€æ—¦è¢« rejected ï¼Œå¹¶ä¸ä¼šè§¦å‘ Promise.all() çš„ catch æ–¹æ³•ã€‚\nğŸ“ƒ Example\nconst p1 = new Promise((resolve, reject) =\u0026gt; { resolve(\u0026#39;hello\u0026#39;); }) .then(result =\u0026gt; result) .catch(e =\u0026gt; e); const p2 = new Promise((resolve, reject) =\u0026gt; { throw new Error(\u0026#39;æŠ¥é”™äº†\u0026#39;); }) .then(result =\u0026gt; result) .catch(e =\u0026gt; e); Promise.all([p1, p2]) .then(result =\u0026gt; console.log(result)) .catch(e =\u0026gt; console.log(e)); // [\u0026#34;hello\u0026#34;, Error: æŠ¥é”™äº†] ä¸Šé¢ä»£ç ä¸­ï¼Œp1 ä¼š resolved ï¼Œp2 é¦–å…ˆä¼š rejected ï¼Œä½†æ˜¯ p2 æœ‰è‡ªå·±çš„ catch æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ï¼Œp2æŒ‡å‘çš„å®é™…ä¸Šæ˜¯è¿™ä¸ªå®ä¾‹ã€‚è¯¥å®ä¾‹æ‰§è¡Œå®Œ catch æ–¹æ³•åï¼Œä¹Ÿä¼šå˜æˆ resolved ï¼Œå¯¼è‡´ Promise.all() æ–¹æ³•å‚æ•°é‡Œé¢çš„ä¸¤ä¸ªå®ä¾‹éƒ½ä¼š resolved ï¼Œå› æ­¤ä¼šè°ƒç”¨ then() æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œè€Œä¸ä¼šè°ƒç”¨ catch æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚\nå¦‚æœ p2 æ²¡æœ‰è‡ªå·±çš„ catch æ–¹æ³•ï¼Œå°±ä¼šè°ƒç”¨ Promise.all() çš„ catch æ–¹æ³•ã€‚\nconst p1 = new Promise((resolve, reject) =\u0026gt; { resolve(\u0026#39;hello\u0026#39;); }) .then(result =\u0026gt; result); const p2 = new Promise((resolve, reject) =\u0026gt; { throw new Error(\u0026#39;æŠ¥é”™äº†\u0026#39;); }) .then(result =\u0026gt; result); Promise.all([p1, p2]) .then(result =\u0026gt; console.log(result)) .catch(e =\u0026gt; console.log(e)); // Error: æŠ¥é”™äº† race() Promise.race(iterable)\næ–¹æ³•åŒæ ·æ˜¯å°†å¤šä¸ª Promise å®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ã€‚\nğŸ“ƒ Example\nconst p = Promise.race([p1, p2, p3]); ä¸Šé¢ä»£ç ä¸­ï¼Œåªè¦ p1ã€p2ã€p3 ä¹‹ä¸­æœ‰ä¸€ä¸ªå®ä¾‹ç‡å…ˆæ”¹å˜çŠ¶æ€ï¼Œpçš„çŠ¶æ€å°±è·Ÿç€æ”¹å˜ã€‚é‚£ä¸ªç‡å…ˆæ”¹å˜çš„ Promise å®ä¾‹çš„è¿”å›å€¼ï¼Œå°±ä¼ é€’ç»™ p çš„å›è°ƒå‡½æ•°ã€‚\nå¦‚æœä¼ çš„è¿­ä»£æ˜¯ç©ºçš„ï¼Œåˆ™è¿”å›çš„ Promise å°†æ°¸è¿œç­‰å¾…ã€‚\nPromise.race() æ–¹æ³•çš„å‚æ•°ä¸ Promise.all() æ–¹æ³•ä¸€æ ·ï¼Œå¦‚æœä¸æ˜¯ Promise å®ä¾‹ï¼Œå°±ä¼šå…ˆè°ƒç”¨ä¸‹é¢è®²åˆ°çš„ Promise.resolve() æ–¹æ³•ï¼Œå°†å‚æ•°è½¬ä¸º Promise å®ä¾‹ï¼Œå†è¿›ä¸€æ­¥å¤„ç†ã€‚\nğŸ“ƒ Example\nä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå¦‚æœæŒ‡å®šæ—¶é—´å†…æ²¡æœ‰è·å¾—ç»“æœï¼Œå°±å°† Promise çš„çŠ¶æ€å˜ä¸º reject ï¼Œå¦åˆ™å˜ä¸º resolve ã€‚\nconst p = Promise.race([ fetch(\u0026#39;/resource-that-may-take-a-while\u0026#39;), new Promise(function (resolve, reject) { setTimeout(() =\u0026gt; reject(new Error(\u0026#39;request timeout\u0026#39;)), 5000) }) ]); p.then(console.log) .catch(console.error); ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœ 5 ç§’ä¹‹å†… fetch æ–¹æ³•æ— æ³•è¿”å›ç»“æœï¼Œå˜é‡ p çš„çŠ¶æ€å°±ä¼šå˜ä¸º rejected ï¼Œä»è€Œè§¦å‘ catch æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚\nallSettled() Promise.allSettled(iterable)\næ–¹æ³•æ¥å—ä¸€ç»„ Promise å®ä¾‹ä½œä¸ºå‚æ•°ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ã€‚åªæœ‰ç­‰åˆ°æ‰€æœ‰è¿™äº›å‚æ•°å®ä¾‹éƒ½è¿”å›ç»“æœï¼Œä¸ç®¡æ˜¯ fulfilled è¿˜æ˜¯ rejected ï¼ŒåŒ…è£…å®ä¾‹æ‰ä¼šç»“æŸã€‚è¯¥æ–¹æ³•ç”± ES2020 å¼•å…¥ã€‚\nğŸ“ƒ Example\nconst promises = [ fetch(\u0026#39;/api-1\u0026#39;), fetch(\u0026#39;/api-2\u0026#39;), fetch(\u0026#39;/api-3\u0026#39;), ]; await Promise.allSettled(promises); removeLoadingIndicator(); ä¸Šé¢ä»£ç å¯¹æœåŠ¡å™¨å‘å‡ºä¸‰ä¸ªè¯·æ±‚ï¼Œç­‰åˆ°ä¸‰ä¸ªè¯·æ±‚éƒ½ç»“æŸï¼Œä¸ç®¡è¯·æ±‚æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼ŒåŠ è½½çš„æ»šåŠ¨å›¾æ ‡å°±ä¼šæ¶ˆå¤±ã€‚\nç›¸æ¯”ä¹‹ä¸‹ï¼ŒPromise.all() æ›´é€‚åˆå½¼æ­¤ç›¸äº’ä¾èµ–æˆ–è€…åœ¨å…¶ä¸­ä»»ä½•ä¸€ä¸ª reject æ—¶ç«‹å³ç»“æŸã€‚\nè¯¥æ–¹æ³•è¿”å›çš„æ–°çš„ Promise å®ä¾‹ï¼Œä¸€æ—¦ç»“æŸï¼ŒçŠ¶æ€æ€»æ˜¯ fulfilled ï¼Œä¸ä¼šå˜æˆ rejected ã€‚çŠ¶æ€å˜æˆ fulfilled åï¼ŒPromise çš„ç›‘å¬å‡½æ•°æ¥æ”¶åˆ°çš„å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªæˆå‘˜å¯¹åº”ä¸€ä¸ªä¼ å…¥ Promise.allSettled() çš„ Promise å®ä¾‹ã€‚\nğŸ“ƒ Example\nconst resolved = Promise.resolve(42); const rejected = Promise.reject(-1); const allSettledPromise = Promise.allSettled([resolved, rejected]); allSettledPromise.then(results=\u0026gt; console.log(results) ); // [ // { status: \u0026#39;fulfilled\u0026#39;, value: 42 }, // { status: \u0026#39;rejected\u0026#39;, reason: -1 } // ] ä¸Šé¢ä»£ç ä¸­ï¼ŒPromise.allSettled() çš„è¿”å›å€¼ allSettledPromise ï¼ŒçŠ¶æ€åªå¯èƒ½å˜æˆ fulfilled ã€‚å®ƒçš„ç›‘å¬å‡½æ•°æ¥æ”¶åˆ°çš„å‚æ•°æ˜¯æ•°ç»„results ã€‚è¯¥æ•°ç»„çš„æ¯ä¸ªæˆå‘˜éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹åº”ä¼ å…¥ Promise.allSettled() çš„ä¸¤ä¸ª Promise å®ä¾‹ã€‚æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ status å±æ€§ï¼Œè¯¥å±æ€§çš„å€¼åªå¯èƒ½æ˜¯å­—ç¬¦ä¸² fulfilled æˆ–å­—ç¬¦ä¸² rejected ã€‚ fulfilled æ—¶ï¼Œå¯¹è±¡æœ‰ value å±æ€§ï¼Œ rejected æ—¶æœ‰ reason å±æ€§ï¼Œå¯¹åº”ä¸¤ç§çŠ¶æ€çš„è¿”å›å€¼ã€‚\nä¸‹é¢æ˜¯è¿”å›å€¼ç”¨æ³•çš„ä¾‹å­ã€‚\nğŸ“ƒ Example\nconst promises = [ fetch(\u0026#39;index.html\u0026#39;), fetch(\u0026#39;https://does-not-exist/\u0026#39;) ]; const results = await Promise.allSettled(promises); // !SyntaxError: await is only valid in async functions and the top level bodies of modules // è¿‡æ»¤å‡ºæˆåŠŸçš„è¯·æ±‚ const successfulPromises = results.filter(p =\u0026gt; p.status === \u0026#39;fulfilled\u0026#39;); // è¿‡æ»¤å‡ºå¤±è´¥çš„è¯·æ±‚ï¼Œå¹¶è¾“å‡ºåŸå›  const errors = results .filter(p =\u0026gt; p.status === \u0026#39;rejected\u0026#39;) .map(p =\u0026gt; p.reason); âš ï¸ Caution è¯­æ³•æœ‰é”™è¯¯\næœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¸å…³å¿ƒå¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œåªå…³å¿ƒè¿™äº›æ“ä½œæœ‰æ²¡æœ‰ç»“æŸã€‚è¿™æ—¶ï¼ŒPromise.allSettled() æ–¹æ³•å°±å¾ˆæœ‰ç”¨ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œæƒ³è¦ç¡®ä¿æ‰€æœ‰æ“ä½œéƒ½ç»“æŸï¼Œå°±å¾ˆéº»çƒ¦ã€‚Promise.all() æ–¹æ³•æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ã€‚\nğŸ“ƒ Example\nconst urls = [ /* ... */ ]; const requests = urls.map(x =\u0026gt; fetch(x)); try { await Promise.all(requests); // !await is only valid in async functions and the top level bodies of modules console.log(\u0026#39;æ‰€æœ‰è¯·æ±‚éƒ½æˆåŠŸã€‚\u0026#39;); } catch { console.log(\u0026#39;è‡³å°‘ä¸€ä¸ªè¯·æ±‚å¤±è´¥ï¼Œå…¶ä»–è¯·æ±‚å¯èƒ½è¿˜æ²¡ç»“æŸã€‚\u0026#39;); } ä¸Šé¢ä»£ç ä¸­ï¼ŒPromise.all()æ— æ³•ç¡®å®šæ‰€æœ‰è¯·æ±‚éƒ½ç»“æŸã€‚æƒ³è¦è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œå†™èµ·æ¥å¾ˆéº»çƒ¦ï¼Œæœ‰äº†Promise.allSettled()ï¼Œè¿™å°±å¾ˆå®¹æ˜“äº†ã€‚\nany() âš ï¸ Caution Promise.any() æ–¹æ³•ä¾ç„¶æ˜¯å®éªŒæ€§çš„ï¼Œå°šæœªè¢«æ‰€æœ‰çš„æµè§ˆå™¨å®Œå…¨æ”¯æŒã€‚å®ƒå½“å‰å¤„äº TC39 ç¬¬å››é˜¶æ®µè‰æ¡ˆï¼ˆStage 4ï¼‰\nresolve() æœ‰æ—¶éœ€è¦å°†ç°æœ‰å¯¹è±¡è½¬ä¸º Promise å¯¹è±¡ï¼ŒPromise.resolve() æ–¹æ³•å°±èµ·åˆ°è¿™ä¸ªä½œç”¨ã€‚\nâš ï¸ Caution\nä¸è¦åœ¨è§£æä¸º è‡ªèº« çš„ thenable ä¸Šè°ƒç”¨ Promise.resolve(thenable) ã€‚è¿™å°†å¯¼è‡´æ— é™é€’å½’ï¼Œå› ä¸ºå®ƒè¯•å›¾å±•å¹³æ— é™åµŒå¥—çš„ Promise ã€‚ä¸€ä¸ªä¾‹å­æ˜¯å°†å®ƒä¸ Angular ä¸­çš„ å¼‚æ­¥ç®¡é“ ä¸€èµ·ä½¿ç”¨ã€‚\nlet thenable = { then: (resolve, reject) =\u0026gt; { resolve(thenable) } } Promise.resolve(thenable); //è¿™ä¼šé€ æˆä¸€ä¸ªæ­»å¾ªç¯ ğŸ“ƒ Example\nconst jsPromise = Promise.resolve($.ajax(\u0026#39;/whatever.json\u0026#39;)); ä¸Šé¢ä»£ç å°† jQuery ç”Ÿæˆçš„ deferred å¯¹è±¡ï¼Œè½¬ä¸ºä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡ã€‚\nPromise.resolve()ç­‰ä»·äºä¸‹é¢çš„å†™æ³•ã€‚\nPromise.resolve(\u0026#39;foo\u0026#39;) // ç­‰ä»·äº new Promise(resolve =\u0026gt; resolve(\u0026#39;foo\u0026#39;)) Promise.resolve()æ–¹æ³•çš„å‚æ•°åˆ†æˆå››ç§æƒ…å†µã€‚\nPromise å®ä¾‹\nå¦‚æœå‚æ•°æ˜¯ Promise å®ä¾‹ï¼Œé‚£ä¹ˆ Promise.resolve å°†ä¸åšä»»ä½•ä¿®æ”¹ã€åŸå°ä¸åŠ¨åœ°è¿”å›è¿™ä¸ªå®ä¾‹ã€‚\nthenable å¯¹è±¡ thenable å¯¹è±¡æŒ‡çš„æ˜¯å…·æœ‰ then() æ–¹æ³•çš„å¯¹è±¡ï¼Œæœ€å¤šéœ€è¦ä¸¤ä¸ªå‚æ•°ï¼ˆæˆåŠŸ onFulfilled å’Œ å¤±è´¥ onRejected æƒ…å†µï¼‰çš„å›è°ƒå‡½æ•°ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªå¯¹è±¡ã€‚\nlet thenable = { then: (resolve, reject) =\u0026gt; { if (success) resolve(); else reject(); } } Promise.resolve() æ–¹æ³•ä¼šå°†è¿™ä¸ªå¯¹è±¡è½¬ä¸º Promise å¯¹è±¡ï¼Œç„¶åå°±ç«‹å³æ‰§è¡Œ thenable å¯¹è±¡çš„ then() æ–¹æ³•ã€‚\nğŸ“ Note thenable æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–è€…å‡½æ•°ã€‚\nè¯†åˆ« thenable æˆ–è¡Œä¸ºç±»ä¼¼ Promise å¯¹è±¡å¯ä»¥æ ¹æ®å…¶æ˜¯å¦å…·æœ‰ then(...) æ–¹æ³•æ¥åˆ¤æ–­ï¼Œè¿™å«ç±»å‹æ£€æŸ¥ï¼ˆé¸­å¼è¾©å‹Duck Typingï¼‰ã€‚\nthenable çš„é¸­å¼ç±»å‹æ£€æµ‹ï¼š\nfunction thenableDuckTyping(p) { if (p !== null \u0026amp;\u0026amp; ( typeof p === \u0026#39;object\u0026#39; || typeof p === \u0026#39;function\u0026#39; ) \u0026amp;\u0026amp; typeof p.then === \u0026#39;function\u0026#39; ) { return true; //thenable } else { //éthenable return false; } } ğŸ“ƒ Example\n// ä¸¤ç§å†™æ³•ç­‰æ•ˆ /* 1. å¯¹è±¡å¼thenable */ let thenable = { // thenable()å†…éƒ¨å‡½æ•°å†™æ³• // å’Œnew Promise()å†…éƒ¨ç›¸åŒ then: _ =\u0026gt; _(42) }; let p1 = Promise.resolve(thenable) .then(_ =\u0026gt; console.log(\u0026#39;thenable:\u0026#39;, _)); /* 2. å‡½æ•°å¼(ç±»)thenable */ class ThenableC { then = (_) =\u0026gt; _(42) } let thenableC = new ThenableC(); // åˆ›å»ºç±»è®°å¾—åˆå§‹åŒ– /* 3. ä¼ ç»ŸPromise */ let p2 = Promise.resolve(thenableC) .then(_ =\u0026gt; console.log(\u0026#39;thenableC:\u0026#39;, _)); new Promise(_ =\u0026gt; _(42)) .then(_ =\u0026gt; console.log(\u0026#39;Promise:\u0026#39;, _)); // Promise: 42 // thenable: 42 // thenableC: 42 ä¸Šé¢ä»£ç ä¸­ï¼Œthenable å¯¹è±¡çš„ then() æ–¹æ³•æ‰§è¡Œåï¼Œå¯¹è±¡ p1 çš„çŠ¶æ€å°±å˜ä¸º resolved ï¼Œä»è€Œç«‹å³æ‰§è¡Œæœ€åé‚£ä¸ª then() æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œè¾“å‡º 42 ã€‚\nå‚æ•°ä¸æ˜¯å…·æœ‰ then() æ–¹æ³•çš„å¯¹è±¡ï¼Œæˆ–æ ¹æœ¬å°±ä¸æ˜¯å¯¹è±¡\nå¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªåŸå§‹å€¼ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªä¸å…·æœ‰ then() æ–¹æ³•çš„å¯¹è±¡ï¼Œæˆ–æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåˆ™ Promise.resolve() æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡ï¼ŒçŠ¶æ€ä¸º resolved ã€‚\nğŸ“ƒ Example\nlet p = Promise.resolve(\u0026#39;Hello\u0026#39;); p.then(s =\u0026gt; console.log(s)); function timeConsuming(rnd = 65536) { let i = 0; while (i++ \u0026lt; Math.random() * rnd) { i += Math.random() * i; } return i; } let f = Promise.resolve(timeConsuming()) .then(i =\u0026gt; console.log(i)); console.log(`Before Promise?`); // Before Promise? // Hello // 57222.89916807085 ä¸Šé¢ä»£ç ç”Ÿæˆä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡çš„å®ä¾‹ p ã€‚ç”±äºå­—ç¬¦ä¸² Hello ä¸å±äºå¼‚æ­¥æ“ä½œï¼ˆåˆ¤æ–­æ–¹æ³•æ˜¯å­—ç¬¦ä¸²å¯¹è±¡ä¸å…·æœ‰ then æ–¹æ³•ï¼‰ï¼Œè¿”å› Promise å®ä¾‹çš„çŠ¶æ€ä»ä¸€ç”Ÿæˆå°±æ˜¯ resolved ï¼Œæ‰€ä»¥å›è°ƒå‡½æ•°ä¼šç«‹å³æ‰§è¡Œã€‚\nPromise.resolve() æ–¹æ³•çš„å‚æ•°ï¼Œä¼šåŒæ—¶ä¼ ç»™å›è°ƒå‡½æ•°ã€‚\nä¸å¸¦æœ‰ä»»ä½•å‚æ•°\nPromise.resolve() æ–¹æ³•å…è®¸è°ƒç”¨æ—¶ä¸å¸¦å‚æ•°ï¼Œç›´æ¥è¿”å›ä¸€ä¸ª resolved çŠ¶æ€çš„ Promise å¯¹è±¡ã€‚\næ‰€ä»¥ï¼Œå¦‚æœå¸Œæœ›å¾—åˆ°ä¸€ä¸ª Promise å¯¹è±¡ï¼Œæ¯”è¾ƒæ–¹ä¾¿çš„æ–¹æ³•å°±æ˜¯ç›´æ¥è°ƒç”¨ Promise.resolve() æ–¹æ³•ã€‚\nğŸ“ƒ Example\nconst p = Promise.resolve(); p.then(function () { // ... }); ä¸Šé¢ä»£ç çš„å˜é‡ p å°±æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç«‹å³ resolve() çš„ Promise å¯¹è±¡ï¼Œæ˜¯åœ¨æœ¬è½® äº‹ä»¶å¾ªç¯event loop çš„ç»“æŸæ—¶æ‰§è¡Œï¼Œè€Œä¸æ˜¯åœ¨ä¸‹ä¸€è½®äº‹ä»¶å¾ªç¯çš„å¼€å§‹æ—¶ã€‚\nğŸ“ƒ Example\nsetTimeout(function () { console.log(\u0026#39;three\u0026#39;); // ä¸‹ä¸€è½®äº‹ä»¶å¾ªç¯ }, 0); Promise.resolve().then(function () { console.log(\u0026#39;two\u0026#39;); // æœ¬è½®äº‹ä»¶å¾ªç¯æœ«å°¾ }); console.log(\u0026#39;one\u0026#39;); //æœ¬è½®äº‹ä»¶å¾ªç¯ // one two three ä¸Šé¢ä»£ç ä¸­ï¼Œ\nsetTimeout(fn, 0) åœ¨ä¸‹ä¸€è½®äº‹ä»¶å¾ªç¯å¼€å§‹æ—¶æ‰§è¡Œ Promise.resolve() åœ¨æœ¬è½®äº‹ä»¶å¾ªç¯ç»“æŸæ—¶æ‰§è¡Œ console.log(\u0026lsquo;one\u0026rsquo;) åˆ™æ˜¯ç«‹å³æ‰§è¡Œï¼Œå› æ­¤æœ€å…ˆè¾“å‡ºã€‚ reject() Promise.reject(reason)\næ–¹æ³•ä¹Ÿä¼šè¿”å›ä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ï¼Œè¯¥å®ä¾‹çš„çŠ¶æ€ä¸º rejected ã€‚\nğŸ“ƒ Example\nconst p = Promise.reject(\u0026#39;å‡ºé”™äº†\u0026#39;); // ç­‰åŒäº // const p = new Promise( // (resolve, reject) =\u0026gt; reject(\u0026#39;å‡ºé”™äº†\u0026#39;)); p.then(null, s=\u0026gt; console.log(s)); // å‡ºé”™äº† ä¸Šé¢ä»£ç ç”Ÿæˆä¸€ä¸ª Promise å¯¹è±¡çš„å®ä¾‹ p ï¼ŒçŠ¶æ€ä¸º rejected ï¼Œå›è°ƒå‡½æ•°ä¼šç«‹å³æ‰§è¡Œã€‚\nPromise.reject() æ–¹æ³•çš„å‚æ•°ï¼Œä¼šåŸå°ä¸åŠ¨åœ°ä½œä¸º reject çš„ç†ç”±ï¼Œå˜æˆåç»­æ–¹æ³•çš„å‚æ•°ã€‚\nğŸ“ƒ Example\nPromise.reject(\u0026#39;å‡ºé”™äº†\u0026#39;) .catch(e =\u0026gt; console.log(e === \u0026#39;å‡ºé”™äº†\u0026#39;)); // true ä¸Šé¢ä»£ç ä¸­ï¼ŒPromise.reject() æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåé¢ catch() æ–¹æ³•çš„å‚æ•° e å°±æ˜¯è¿™ä¸ªå­—ç¬¦ä¸²ã€‚\ntry()^*^ å®é™…å¼€å‘ä¸­ï¼Œç»å¸¸é‡åˆ°ä¸€ç§æƒ…å†µï¼šä¸çŸ¥é“æˆ–è€…ä¸æƒ³åŒºåˆ†ï¼Œå‡½æ•° f() æ˜¯åŒæ­¥å‡½æ•°è¿˜æ˜¯å¼‚æ­¥æ“ä½œï¼Œä½†æ˜¯æƒ³ç”¨ Promise æ¥å¤„ç†å®ƒã€‚å› ä¸ºè¿™æ ·å°±å¯ä»¥ä¸ç®¡ f() æ˜¯å¦åŒ…å«å¼‚æ­¥æ“ä½œï¼Œéƒ½ç”¨ then() æ–¹æ³•æŒ‡å®šä¸‹ä¸€æ­¥æµç¨‹ï¼Œç”¨ catch æ–¹æ³•å¤„ç† f() æŠ›å‡ºçš„é”™è¯¯ã€‚ä¸€èˆ¬å°±ä¼šé‡‡ç”¨ä¸‹é¢çš„å†™æ³•ã€‚\nğŸ“ƒ Example\nPromise.resolve().then(f); ä¸Šé¢çš„å†™æ³•æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯å¦‚æœ f æ˜¯åŒæ­¥å‡½æ•°ï¼Œé‚£ä¹ˆå®ƒä¼šåœ¨æœ¬è½®äº‹ä»¶å¾ªç¯çš„æœ«å°¾æ‰§è¡Œ\nğŸ“ƒ Example\nconst f = () =\u0026gt; console.log(\u0026#39;now\u0026#39;); Promise.resolve().then(f); console.log(\u0026#39;next\u0026#39;); // next now ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•° f æ˜¯åŒæ­¥çš„ï¼Œä½†æ˜¯ç”¨ Promise åŒ…è£…äº†ä»¥åï¼Œå°±å˜æˆå¼‚æ­¥æ‰§è¡Œäº†ã€‚\né‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ç§æ–¹æ³•ï¼Œè®©åŒæ­¥å‡½æ•°åŒæ­¥æ‰§è¡Œï¼Œå¼‚æ­¥å‡½æ•°å¼‚æ­¥æ‰§è¡Œï¼Œå¹¶ä¸”è®©å®ƒä»¬å…·æœ‰ç»Ÿä¸€çš„ API å‘¢ï¼Ÿå›ç­”æ˜¯å¯ä»¥çš„ï¼Œå¹¶ä¸”è¿˜æœ‰ä¸¤ç§å†™æ³•ï¼š\nç¬¬ä¸€ç§å†™æ³•æ˜¯ç”¨ async å‡½æ•°æ¥å†™ã€‚\nconst f = () =\u0026gt; console.log(\u0026#39;now\u0026#39;); (async () =\u0026gt; f())(); console.log(\u0026#39;next\u0026#39;); // now next ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬äºŒè¡Œæ˜¯ä¸€ä¸ªç«‹å³æ‰§è¡Œçš„åŒ¿åå‡½æ•°ï¼Œä¼šç«‹å³æ‰§è¡Œé‡Œé¢çš„ async å‡½æ•°ï¼Œå› æ­¤å¦‚æœ f æ˜¯åŒæ­¥çš„ï¼Œå°±ä¼šå¾—åˆ°åŒæ­¥çš„ç»“æœï¼›å¦‚æœfæ˜¯å¼‚æ­¥çš„ï¼Œå°±å¯ä»¥ç”¨ then() æŒ‡å®šä¸‹ä¸€æ­¥ï¼Œå°±åƒä¸‹é¢çš„å†™æ³•ã€‚\n(async () =\u0026gt; f())() .then(...) éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œasync () =\u0026gt; f() ä¼šåƒæ‰ f() æŠ›å‡ºçš„é”™è¯¯ã€‚æ‰€ä»¥ï¼Œå¦‚æœæƒ³æ•è·é”™è¯¯ï¼Œè¦ä½¿ç”¨ promise.catch() æ–¹æ³•ã€‚\n(async () =\u0026gt; f())() .then(...) .catch(...) ç¬¬äºŒç§å†™æ³•æ˜¯ä½¿ç”¨ new Promise()ã€‚\nconst f = () =\u0026gt; console.log(\u0026#39;now\u0026#39;); ( () =\u0026gt; new Promise( resolve =\u0026gt; resolve(f()) ) )(); console.log(\u0026#39;next\u0026#39;); // now next ä¸Šé¢ä»£ç ä¹Ÿæ˜¯ä½¿ç”¨ç«‹å³æ‰§è¡Œçš„åŒ¿åå‡½æ•°ï¼Œæ‰§è¡Œ new Promise() ã€‚è¿™ç§æƒ…å†µä¸‹ï¼ŒåŒæ­¥å‡½æ•°ä¹Ÿæ˜¯åŒæ­¥æ‰§è¡Œçš„ã€‚\né‰´äºè¿™æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„éœ€æ±‚ï¼Œæ‰€ä»¥ç°åœ¨æœ‰ä¸€ä¸ªææ¡ˆï¼Œæä¾› Promise.try() æ–¹æ³•æ›¿ä»£ä¸Šé¢çš„å†™æ³•ã€‚\nconst f = () =\u0026gt; console.log(\u0026#39;now\u0026#39;); Promise.try(f); console.log(\u0026#39;next\u0026#39;); // now next äº‹å®ä¸Šï¼ŒPromise.try å­˜åœ¨å·²ä¹…ï¼ŒPromise åº“ Bluebird ã€Q å’Œ when ï¼Œæ—©å°±æä¾›äº†è¿™ä¸ªæ–¹æ³•ã€‚\nğŸ§ª Experimental æ‰‹å†™ Promise.try()\n// æ‰‹å†™Promise.try() Promise.try = null; // é—­åŒ…IIFE (() =\u0026gt; { (!Promise.try) \u0026amp;\u0026amp; (Promise.try = fn =\u0026gt; new Promise( resolve =\u0026gt; resolve(fn()) ) ) })(); // åŒæ­¥å‡½æ•° let syncFn = () =\u0026gt; { console.log(\u0026#39;S Promise.try()\u0026#39;); return \u0026#39;S syncFn ret\u0026#39;; } // å¼‚æ­¥å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªPromise let asyncFn = () =\u0026gt; new Promise(resolve =\u0026gt; { console.log(\u0026#39;A Promise.try()\u0026#39;); resolve(\u0026#39;A asyncFn ret\u0026#39;); }).then(_ =\u0026gt; { console.log(\u0026#39;A asyncFn then()\u0026#39;); return _; }); // ä½¿ç”¨ Promise.try(syncFn).then(_ =\u0026gt; console.log(`S Promise.then(): ${_}`)); console.log(\u0026#39;S\u0026#39;, Promise); // Promise.try() // [Function: Promise] { try: [Function (anonymous)] } // Promise.then(): syncFn ret Promise.try(asyncFn).then(_ =\u0026gt; console.log(`A Promise.then(): ${_}`)); console.log(\u0026#39;A\u0026#39;, Promise); // Promise.try() - æœ¬è½® // [Function: Promise] { try: [Function (anonymous)] } // asyncFn then() - æœ¬è½®æœ«å°¾ // Promise.then(): asyncFn ret - ä¸‹ä¸€è½®æœ«å°¾ ç”±äº Promise.try ä¸ºæ‰€æœ‰æ“ä½œæä¾›äº†ç»Ÿä¸€çš„å¤„ç†æœºåˆ¶ï¼Œæ‰€ä»¥å¦‚æœæƒ³ç”¨ then() æ–¹æ³•ç®¡ç†æµç¨‹ï¼Œæœ€å¥½éƒ½ç”¨ Promise.try åŒ…è£…ä¸€ä¸‹ã€‚è¿™æ ·æœ‰è®¸å¤šå¥½å¤„ï¼Œå…¶ä¸­ä¸€ç‚¹å°±æ˜¯å¯ä»¥æ›´å¥½åœ°ç®¡ç†å¼‚å¸¸ã€‚\nğŸ“ƒ Example\nfunction getUsername(userId) { return database.users.get({id: userId}) .then(function(user) { return user.name; }); } ä¸Šé¢ä»£ç ä¸­ï¼Œdatabase.users.get() è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚\nå¦‚æœæŠ›å‡ºå¼‚æ­¥é”™è¯¯ï¼Œå¯ä»¥ç”¨ catch æ–¹æ³•æ•è·ï¼Œå°±åƒä¸‹é¢è¿™æ ·å†™ã€‚\ndatabase.users.get({id: userId}) .then(...) .catch(...) ä½†æ˜¯ database.users.get() å¯èƒ½è¿˜ä¼šæŠ›å‡ºåŒæ­¥é”™è¯¯ï¼ˆæ¯”å¦‚æ•°æ®åº“è¿æ¥é”™è¯¯ï¼Œå…·ä½“è¦çœ‹å®ç°æ–¹æ³•ï¼‰ï¼Œè¿™æ—¶ä½ å°±ä¸å¾—ä¸ç”¨ try...catch å»æ•è·ã€‚\nğŸ“ƒ Example\ntry { database.users.get({id: userId}) .then(...) .catch(...) } catch (e) { // ... } ä¸Šé¢è¿™æ ·çš„å†™æ³•å°±å¾ˆç¬¨æ‹™äº†ï¼Œè¿™æ—¶å°±å¯ä»¥ç»Ÿä¸€ç”¨ promise.catch() æ•è·æ‰€æœ‰ åŒæ­¥Synchronize å’Œ å¼‚æ­¥Asynchronize çš„é”™è¯¯ã€‚\nPromise.try(() =\u0026gt; database.users.get({id: userId})) .then(...) .catch(...) äº‹å®ä¸Šï¼ŒPromise.tryå°±æ˜¯æ¨¡æ‹Ÿ try ä»£ç å—ï¼Œå°±åƒpromise.catchæ¨¡æ‹Ÿçš„æ˜¯ catch ä»£ç å—ã€‚\nåº”ç”¨ åŠ è½½å›¾ç‰‡ æˆ‘ä»¬å¯ä»¥å°†å›¾ç‰‡çš„åŠ è½½å†™æˆä¸€ä¸ª Promise ï¼Œä¸€æ—¦åŠ è½½å®Œæˆï¼Œ Promise çš„çŠ¶æ€å°±å‘ç”Ÿå˜åŒ–ã€‚\nconst preloadImage = function (path) { return new Promise(function (resolve, reject) { const image = new Image(); image.onload = resolve; image.onerror = reject; image.src = path; }); }; Generator å‡½æ•°ä¸ Promise çš„ç»“åˆ ä½¿ç”¨ Generator å‡½æ•°ç®¡ç†æµç¨‹ï¼Œé‡åˆ°å¼‚æ­¥æ“ä½œçš„æ—¶å€™ï¼Œé€šå¸¸è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚\nfunction getFoo () { return new Promise(function (resolve, reject){ resolve(\u0026#39;foo\u0026#39;); }); } const g = function* () { try { const foo = yield getFoo(); console.log(foo); } catch (e) { console.log(e); } }; function run (generator) { const it = generator(); function go(result) { if (result.done) return result.value; return result.value.then(function (value) { return go(it.next(value)); }, function (error) { return go(it.throw(error)); }); } go(it.next()); } run(g); ä¸Šé¢ä»£ç çš„ Generator å‡½æ•° g ä¹‹ä¸­ï¼Œæœ‰ä¸€ä¸ªå¼‚æ­¥æ“ä½œ getFoo ï¼Œå®ƒè¿”å›çš„å°±æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ã€‚å‡½æ•° run ç”¨æ¥å¤„ç†è¿™ä¸ª Promise å¯¹è±¡ï¼Œå¹¶è°ƒç”¨ä¸‹ä¸€ä¸ª next æ–¹æ³•ã€‚\næ‰‹å†™ Promise/A+ å›è°ƒæ–¹æ³• è¦å®ç°ä¸Šé¢ä»£ç ä¸­çš„åŠŸèƒ½ï¼Œä¹Ÿæ˜¯promiseæœ€åŸºæœ¬çš„åŠŸèƒ½ã€‚é¦–å…ˆï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°promiseï¼Œåˆ›å»ºä¸€ä¸ªpromiselç±»ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™ä¼ å…¥äº†ä¸€ä¸ªæ‰§è¡Œå™¨executorï¼Œexecutorä¼šä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼šæˆåŠŸ(resolve)å’Œå¤±è´¥(reject)ã€‚ä¹‹å‰è¯´è¿‡ï¼Œåªè¦æˆåŠŸï¼Œå°±ä¸ä¼šå¤±è´¥ï¼Œåªè¦å¤±è´¥å°±ä¸ä¼šæˆåŠŸã€‚æ‰€ä»¥ï¼Œé»˜è®¤çŠ¶æ€ä¸‹ï¼Œåœ¨è°ƒç”¨æˆåŠŸæ—¶ï¼Œå°±è¿”å›æˆåŠŸæ€ï¼Œè°ƒç”¨å¤±è´¥æ—¶ï¼Œè¿”å›å¤±è´¥æ€ã€‚ä»£ç å¦‚ä¸‹ï¼š\nclass Promise { constructor (executor){ //é»˜è®¤çŠ¶æ€æ˜¯ç­‰å¾…çŠ¶æ€ this.status = \u0026#39;panding\u0026#39;; this.value = undefined; this.reason = undefined; //å­˜æ”¾æˆåŠŸçš„å›è°ƒ this.onResolvedCallbacks = []; //å­˜æ”¾å¤±è´¥çš„å›è°ƒ this.onRejectedCallbacks = []; let resolve = (data) =\u0026gt; {//thisæŒ‡çš„æ˜¯å®ä¾‹ if(this.status === \u0026#39;pending\u0026#39;){ this.value = data; this.status = \u0026#34;resolved\u0026#34;; this.onResolvedCallbacks.forEach(fn =\u0026gt; fn()); } } let reject = (reason) =\u0026gt; { if(this.status === \u0026#39;pending\u0026#39;){ this.reason = reason; this.status = \u0026#39;rejected\u0026#39;; this.onRejectedCallbacks.forEach(fn =\u0026gt; fn()); } } try{//æ‰§è¡Œæ—¶å¯èƒ½ä¼šå‘ç”Ÿå¼‚å¸¸ executor(resolve,reject); }catch (e){ reject(e);//promiseå¤±è´¥äº† } } promise A+è§„èŒƒè§„å®šï¼Œåœ¨æœ‰å¼‚å¸¸é”™è¯¯æ—¶ï¼Œåˆ™æ‰§è¡Œå¤±è´¥å‡½æ•°ã€‚\nconstructor (executor){ ...... try{ executor(resolve,reject); }catch(e){ reject(e); } } é“¾å¼è°ƒç”¨ thenæ–¹æ³•æ˜¯promiseçš„æœ€åŸºæœ¬çš„æ–¹æ³•ï¼Œè¿”å›çš„æ˜¯ä¸¤ä¸ªå›è°ƒï¼Œä¸€ä¸ªæˆåŠŸçš„å›è°ƒï¼Œä¸€ä¸ªå¤±è´¥çš„å›è°ƒï¼Œå®ç°è¿‡ç¨‹å¦‚ä¸‹ï¼š\nthen(onFulFilled, onRejected) { if (this.status === \u0026#39;resolved\u0026#39;) { //æˆåŠŸçŠ¶æ€çš„å›è°ƒ onFulFilled(this.value); } if (this.status === \u0026#39;rejected\u0026#39;) {//å¤±è´¥çŠ¶æ€çš„å›è°ƒ onRejected(this.reason); } } let p = new Promise(function(){ resolve(\u0026#39;æˆ‘æ˜¯æˆåŠŸ\u0026#39;); }) p.then((data) =\u0026gt; {console.log(data);},(err) =\u0026gt; {}); p.then((data) =\u0026gt; {console.log(data);},(err) =\u0026gt; {}); p.then((data) =\u0026gt; {console.log(data);},(err) =\u0026gt; {}); è¿”å›çš„ç»“æœæ˜¯ï¼š\næˆ‘æ˜¯æˆåŠŸ æˆ‘æ˜¯æˆåŠŸ æˆ‘æ˜¯æˆåŠŸ ä¸ºäº†å®ç°è¿™æ ·çš„æ•ˆæœï¼Œåˆ™ä¸Šä¸€æ¬¡çš„ä»£ç å°†è¦é‡æ–°å†™è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ¯æ¬¡è°ƒç”¨resolveçš„ç»“æœå­˜å…¥ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œæ¯æ¬¡è°ƒç”¨rejectçš„ç»“æœå­˜å…¥ä¸€ä¸ªæ•°ç»„ã€‚è¿™å°±æ˜¯ä¸ºä½•ä¼šåœ¨ä¸Šé¢å®šä¹‰ä¸¤ä¸ªæ•°ç»„,ä¸”åˆ†åˆ«åœ¨resolve()å’Œreject()éå†ä¸¤ä¸ªæ•°ç»„çš„åŸå› ã€‚å› æ­¤ï¼Œåœ¨è°ƒç”¨resolve()æˆ–è€…reject()ä¹‹å‰ï¼Œæˆ‘ä»¬åœ¨pendingçŠ¶æ€æ—¶ï¼Œä¼šæŠŠå¤šæ¬¡thenä¸­çš„ç»“æœå­˜å…¥æ•°ç»„ä¸­ï¼Œåˆ™ä¸Šé¢çš„ä»£ç ä¼šæ”¹å˜ä¸ºï¼š\nthen(onFulFilled, onRejected) { if (this.status === \u0026#39;resolved\u0026#39;) { onFulFilled(this.value); } if (this.status === \u0026#39;rejected\u0026#39;) { onRejected(this.reason); } // å½“å‰æ—¢æ²¡æœ‰å®Œæˆ ä¹Ÿæ²¡æœ‰å¤±è´¥ if (this.status === \u0026#39;pending\u0026#39;) { // å­˜æ”¾æˆåŠŸçš„å›è°ƒ this.onResolvedCallbacks.push(() =\u0026gt; { onFulFilled(this.value); }); // å­˜æ”¾å¤±è´¥çš„å›è°ƒ this.onRejectedCallbacks.push(() =\u0026gt; { onRejected(this.reason); }); } } Promise A+è§„èŒƒä¸­è§„å®šthenæ–¹æ³•å¯ä»¥é“¾å¼è°ƒç”¨\nåœ¨promiseä¸­ï¼Œè¦å®ç°é“¾å¼è°ƒç”¨è¿”å›çš„ç»“æœæ˜¯è¿”å›ä¸€ä¸ªæ–°çš„promiseï¼Œç¬¬ä¸€æ¬¡thenä¸­è¿”å›çš„ç»“æœï¼Œæ— è®ºæ˜¯æˆåŠŸæˆ–å¤±è´¥ï¼Œéƒ½å°†è¿”å›åˆ°ä¸‹ä¸€æ¬¡thenä¸­çš„æˆåŠŸæ€ä¸­ï¼Œä½†åœ¨ç¬¬ä¸€æ¬¡thenä¸­å¦‚æœæŠ›å‡ºå¼‚å¸¸é”™è¯¯ï¼Œåˆ™å°†è¿”å›åˆ°ä¸‹ä¸€æ¬¡thenä¸­çš„å¤±è´¥æ€ä¸­\né“¾å¼è°ƒç”¨æˆåŠŸä¼šè¿”å›å€¼ï¼Œæœ‰å¤šç§æƒ…å†µï¼Œæ ¹æ®ä¸¾çš„ä¾‹å­ï¼Œå¤§è‡´åˆ—å‡ºå¯èƒ½ä¼šå‘ç”Ÿçš„ç»“æœã€‚å› æ­¤å°†é“¾å¼è°ƒç”¨è¿”å›çš„å€¼å•ç‹¬å†™ä¸€ä¸ªæ–¹æ³•ã€‚æ–¹æ³•ä¸­ä¼ å…¥å››ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯p2,x,resolve,reject,p2æŒ‡çš„æ˜¯ä¸Šä¸€æ¬¡è¿”å›çš„promiseï¼Œxè¡¨ç¤ºè¿è¡Œpromiseè¿”å›çš„ç»“æœï¼Œresolveå’Œrejectæ˜¯p2çš„æ–¹æ³•ã€‚åˆ™ä»£ç å†™ä¸º\nfunction resolvePromise(p2,x,resolve,reject){ .... } è¿”å›ç»“æœä¸èƒ½æ˜¯è‡ªå·± var p = new Promise((resovle,reject) =\u0026gt; { return p; //è¿”å›çš„ç»“æœä¸èƒ½æ˜¯è‡ªå·±ï¼Œ }) å½“è¿”å›ç»“æœæ˜¯è‡ªå·±æ—¶ï¼Œæ°¸è¿œä¹Ÿä¸ä¼šæˆåŠŸæˆ–å¤±è´¥ï¼Œå› æ­¤å½“è¿”å›è‡ªå·±æ—¶ï¼Œåº”æŠ›å‡ºä¸€ä¸ªé”™è¯¯\nfunction resolvePromise(p2,x,resolve,reject){ if(px===x){ return reject(new TypeError(\u0026#39;è‡ªå·±å¼•ç”¨è‡ªå·±äº†\u0026#39;)); } .... } è¿”å›ç»“æœå¯èƒ½æ˜¯promise function resolvePromise(promise2,x,resolve,reject){ //åˆ¤æ–­xæ˜¯ä¸æ˜¯promise //è§„èŒƒä¸­è§„å®šï¼šæˆ‘ä»¬å…è®¸åˆ«äººä¹±å†™ï¼Œè¿™ä¸ªä»£ç å¯ä»¥å®ç°æˆ‘ä»¬çš„promiseå’Œåˆ«äººçš„promise è¿›è¡Œäº¤äº’ if(promise2 === x){//ä¸èƒ½è‡ªå·±ç­‰å¾…è‡ªå·±å®Œæˆ return reject(new TypeError(\u0026#39;å¾ªç¯å¼•ç”¨\u0026#39;)); }; // xæ˜¯é™¤äº†nullä»¥å¤–çš„å¯¹è±¡æˆ–è€…å‡½æ•° if(x !=null \u0026amp;\u0026amp; (typeof x === \u0026#39;object\u0026#39; || typeof x === \u0026#39;function\u0026#39;)){ let called;//é˜²æ­¢æˆåŠŸåè°ƒç”¨å¤±è´¥ try{//é˜²æ­¢å–thenæ˜¯å‡ºç°å¼‚å¸¸ object.defineProperty let then = x.then;//å–xçš„thenæ–¹æ³• {then:{}} if(typeof then === \u0026#39;function\u0026#39;){//å¦‚æœthenæ˜¯å‡½æ•°å°±è®¤ä¸ºä»–æ˜¯promise //callç¬¬ä¸€ä¸ªå‚æ•°æ˜¯thisï¼Œåé¢çš„æ˜¯æˆåŠŸçš„å›è°ƒå’Œå¤±è´¥çš„å›è°ƒ then.call(x,y =\u0026gt; {//å¦‚æœYæ˜¯promiseå°±ç»§ç»­é€’å½’promise if(called) return; called = true; resolvePromise(promise2,y,resolve,reject) },r =\u0026gt; { //åªè¦å¤±è´¥äº†å°±å¤±è´¥äº† if(called) return; called = true; reject(r); }); }else{//thenæ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼Œå°±ç›´æ¥æˆåŠŸå³å¯ resolve(x); } }catch (e){ if(called) return; called = true; reject(e) } }else{//x = 123 xå°±æ˜¯ä¸€ä¸ªæ™®é€šå€¼ ä½œä¸ºä¸‹ä¸ªthenæˆåŠŸçš„å‚æ•° resolve(x) } } è¿”å›ç»“æœå¯èƒ½ä¸ºä¸€ä¸ªæ™®é€šå€¼ï¼Œåˆ™ç›´æ¥ resolve(x);\nPromiseä¸€æ¬¡åªèƒ½è°ƒç”¨æˆåŠŸæˆ–è€…å¤±è´¥\nä¹Ÿå°±æ˜¯å½“è°ƒç”¨æˆåŠŸå°±ä¸èƒ½å†è°ƒç”¨å¤±è´¥äº†ï¼Œå¦‚æœä¸¤ä¸ªéƒ½è°ƒç”¨çš„æ—¶å€™ï¼Œå“ªä¸ªå…ˆè°ƒç”¨å°±æ‰§è¡Œå“ªä¸€ä¸ªã€‚ä»£ç éƒ¨åˆ†è¿˜æ˜¯ä¸Šé¢é‚£éƒ¨åˆ†\nä¸ªäººè®¤ä¸ºï¼Œè¿™ä¸ªåœ°æ–¹æ¯”è¾ƒç»•ï¼Œéœ€è¦æ…¢æ…¢çš„ä¸€æ­¥ä¸€æ­¥çš„ç†æ¸…æ¥šã€‚\næ ¹æ®promise A+è§„èŒƒåŸç†ï¼Œpromiseåœ¨è‡ªå·±çš„æ¡†æ¶ä¸­ï¼Œå°è£…äº†ä¸€ç³»åˆ—çš„å†…ç½®çš„æ–¹æ³•ã€‚\næ•è·é”™è¯¯çš„æ–¹æ³• catch() è§£æå…¨éƒ¨æ–¹æ³• all() ç«èµ› race() ç”Ÿæˆä¸€ä¸ªæˆåŠŸçš„promise resolve() ç”Ÿæˆä¸€ä¸ªå¤±è´¥çš„promise reject() æœ€åç»™å¤§å®¶é™„ä¸Šå…¨éƒ¨æºç ï¼Œä¾›å¤§å®¶ä»”ç»†å“è¯»ã€‚\nfunction resolvePromise(promise2,x,resolve,reject){ //åˆ¤æ–­xæ˜¯ä¸æ˜¯promise //è§„èŒƒä¸­è§„å®šï¼šæˆ‘ä»¬å…è®¸åˆ«äººä¹±å†™ï¼Œè¿™ä¸ªä»£ç å¯ä»¥å®ç°æˆ‘ä»¬çš„promiseå’Œåˆ«äººçš„promise è¿›è¡Œäº¤äº’ if(promise2 === x){//ä¸èƒ½è‡ªå·±ç­‰å¾…è‡ªå·±å®Œæˆ return reject(new TypeError(\u0026#39;å¾ªç¯å¼•ç”¨\u0026#39;)); }; // xæ˜¯é™¤äº†nullä»¥å¤–çš„å¯¹è±¡æˆ–è€…å‡½æ•° if(x !=null \u0026amp;\u0026amp; (typeof x === \u0026#39;object\u0026#39; || typeof x === \u0026#39;function\u0026#39;)){ let called;//é˜²æ­¢æˆåŠŸåè°ƒç”¨å¤±è´¥ try{//é˜²æ­¢å–thenæ˜¯å‡ºç°å¼‚å¸¸ object.defineProperty let then = x.then;//å–xçš„thenæ–¹æ³• {then:{}} if(typeof then === \u0026#39;function\u0026#39;){//å¦‚æœthenæ˜¯å‡½æ•°å°±è®¤ä¸ºä»–æ˜¯promise //callç¬¬ä¸€ä¸ªå‚æ•°æ˜¯thisï¼Œåé¢çš„æ˜¯æˆåŠŸçš„å›è°ƒå’Œå¤±è´¥çš„å›è°ƒ then.call(x,y =\u0026gt; {//å¦‚æœYæ˜¯promiseå°±ç»§ç»­é€’å½’promise if(called) return; called = true; resolvePromise(promise2,y,resolve,reject) },r =\u0026gt; { //åªè¦å¤±è´¥äº†å°±å¤±è´¥äº† if(called) return; called = true; reject(r); }); }else{//thenæ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼Œå°±ç›´æ¥æˆåŠŸå³å¯ resolve(x); } }catch (e){ if(called) return; called = true; reject(e) } }else{//x = 123 xå°±æ˜¯ä¸€ä¸ªæ™®é€šå€¼ ä½œä¸ºä¸‹ä¸ªthenæˆåŠŸçš„å‚æ•° resolve(x) } } class Promise { constructor (executor){ //é»˜è®¤çŠ¶æ€æ˜¯ç­‰å¾…çŠ¶æ€ this.status = \u0026#39;panding\u0026#39;; this.value = undefined; this.reason = undefined; //å­˜æ”¾æˆåŠŸçš„å›è°ƒ this.onResolvedCallbacks = []; //å­˜æ”¾å¤±è´¥çš„å›è°ƒ this.onRejectedCallbacks = []; let resolve = (data) =\u0026gt; {//thisæŒ‡çš„æ˜¯å®ä¾‹ if(this.status === \u0026#39;pending\u0026#39;){ this.value = data; this.status = \u0026#34;resolved\u0026#34;; this.onResolvedCallbacks.forEach(fn =\u0026gt; fn()); } } let reject = (reason) =\u0026gt; { if(this.status === \u0026#39;pending\u0026#39;){ this.reason = reason; this.status = \u0026#39;rejected\u0026#39;; this.onRejectedCallbacks.forEach(fn =\u0026gt; fn()); } } try{//æ‰§è¡Œæ—¶å¯èƒ½ä¼šå‘ç”Ÿå¼‚å¸¸ executor(resolve,reject); }catch (e){ reject(e);//promiseå¤±è´¥äº† } } then(onFuiFilled,onRejected){ //é˜²æ­¢å€¼å¾—ç©¿é€ onFuiFilled = typeof onFuiFilled === \u0026#39;function\u0026#39; ? onFuiFilled : y =\u0026gt; y; onRejected = typeof onRejected === \u0026#39;function\u0026#39; ? onRejected :err =\u0026gt; {throw err;} let promise2;//ä½œä¸ºä¸‹ä¸€æ¬¡thenæ–¹æ³•çš„promise if(this.status === \u0026#39;resolved\u0026#39;){ promise2 = new Promise((resolve,reject) =\u0026gt; { setTimeout(() =\u0026gt; { try{ //æˆåŠŸçš„é€»è¾‘ å¤±è´¥çš„é€»è¾‘ let x = onFuiFilled(this.value); //çœ‹xæ˜¯ä¸æ˜¯promise å¦‚æœæ˜¯promiseå–ä»–çš„ç»“æœ ä½œä¸ºpromise2æˆåŠŸçš„çš„ç»“æœ //å¦‚æœè¿”å›ä¸€ä¸ªæ™®é€šå€¼ï¼Œä½œä¸ºpromise2æˆåŠŸçš„ç»“æœ //resolvePromiseå¯ä»¥è§£æxå’Œpromise2ä¹‹é—´çš„å…³ç³» //åœ¨resolvePromiseä¸­ä¼ å…¥å››ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯è¿”å›çš„promiseï¼Œç¬¬äºŒä¸ªæ˜¯è¿”å›çš„ç»“æœï¼Œç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªåˆ†åˆ«æ˜¯resolve()å’Œreject()çš„æ–¹æ³•ã€‚ resolvePromise(promise2,x,resolve,reject) }catch(e){ reject(e); } },0) }); } if(this.status === \u0026#39;rejected\u0026#39;){ promise2 = new Promise((resolve,reject) =\u0026gt; { setTimeout(() =\u0026gt; { try{ let x = onRejected(this.reason); //åœ¨resolvePromiseä¸­ä¼ å…¥å››ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯è¿”å›çš„promiseï¼Œç¬¬äºŒä¸ªæ˜¯è¿”å›çš„ç»“æœï¼Œç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªåˆ†åˆ«æ˜¯resolve()å’Œreject()çš„æ–¹æ³•ã€‚ resolvePromise(promise2,x,resolve,reject) }catch(e){ reject(e); } },0) }); } //å½“å‰æ—¢æ²¡æœ‰å®Œæˆä¹Ÿæ²¡æœ‰å¤±è´¥ if(this.status === \u0026#39;pending\u0026#39;){ promise2 = new Promise((resolve,reject) =\u0026gt; { //æŠŠæˆåŠŸçš„å‡½æ•°ä¸€ä¸ªä¸ªå­˜æ”¾åˆ°æˆåŠŸå›è°ƒå‡½æ•°æ•°ç»„ä¸­ this.onResolvedCallbacks.push( () =\u0026gt;{ setTimeout(() =\u0026gt; { try{ let x = onFuiFilled(this.value); resolvePromise(promise2,x,resolve,reject); }catch(e){ reject(e); } },0) }); //æŠŠå¤±è´¥çš„å‡½æ•°ä¸€ä¸ªä¸ªå­˜æ”¾åˆ°å¤±è´¥å›è°ƒå‡½æ•°æ•°ç»„ä¸­ this.onRejectedCallbacks.push( ()=\u0026gt;{ setTimeout(() =\u0026gt; { try{ let x = onRejected(this.reason); resolvePromise(promise2,x,resolve,reject) }catch(e){ reject(e) } },0) }) }) } return promise2;//è°ƒç”¨thenåè¿”å›ä¸€ä¸ªæ–°çš„promise } catch (onRejected) { // catch æ–¹æ³•å°±æ˜¯thenæ–¹æ³•æ²¡æœ‰æˆåŠŸçš„ç®€å†™ return this.then(null, onRejected); } } Promise.all = function (promises) { //promisesæ˜¯ä¸€ä¸ªpromiseçš„æ•°ç»„ return new Promise(function (resolve, reject) { let arr = []; //arræ˜¯æœ€ç»ˆè¿”å›å€¼çš„ç»“æœ let i = 0; // è¡¨ç¤ºæˆåŠŸäº†å¤šå°‘æ¬¡ function processData(index, data) { arr[index] = data; if (++i === promises.length) { resolve(arr); } } for (let i = 0; i \u0026lt; promises.length; i++) { promises[i].then(function (data) { processData(i, data) }, reject) } }) } // åªè¦æœ‰ä¸€ä¸ªpromiseæˆåŠŸäº† å°±ç®—æˆåŠŸã€‚å¦‚æœç¬¬ä¸€ä¸ªå¤±è´¥äº†å°±å¤±è´¥äº† Promise.race = function (promises) { return new Promise((resolve, reject) =\u0026gt; { for (var i = 0; i \u0026lt; promises.length; i++) { promises[i].then(resolve,reject) } }) } // ç”Ÿæˆä¸€ä¸ªæˆåŠŸçš„promise Promise.resolve = function(value){ return new Promise((resolve,reject) =\u0026gt; resolve(value); } // ç”Ÿæˆä¸€ä¸ªå¤±è´¥çš„promise Promise.reject = function(reason){ return new Promise((resolve,reject) =\u0026gt; reject(reason)); } Promise.defer = Promise.deferred = function () { let dfd = {}; dfd.promise = new Promise( (resolve, reject) =\u0026gt; { dfd.resolve = resolve; dfd.reject = reject; }); return dfd } module.exports = Promise; Generator Generator å‡½æ•°æ˜¯ ES6 æä¾›çš„ä¸€ç§å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆï¼Œè¯­æ³•è¡Œä¸ºä¸ä¼ ç»Ÿå‡½æ•°å®Œå…¨ä¸åŒã€‚\nGenerator å‡½æ•°æœ‰å¤šç§ç†è§£è§’åº¦ã€‚è¯­æ³•ä¸Šï¼Œé¦–å…ˆå¯ä»¥æŠŠå®ƒç†è§£æˆï¼šGenerator å‡½æ•°æ˜¯ä¸€ä¸ª çŠ¶æ€æœºfinite-state machine ï¼Œå°è£…äº†å¤šä¸ªå†…éƒ¨çŠ¶æ€ã€‚\ngraph LR A((\u0026#34;\u0026lt;ruby\u0026gt;\u0026lt;em\u0026gt;opened\u0026lt;/em\u0026gt;\u0026lt;rt\u0026gt;state\u0026lt;/rt\u0026gt;\u0026lt;/ruby\u0026gt;\u0026lt;hr style=\u0026#39;border-bottom: 1px solid darkblue;\u0026#39;\u0026gt;\u0026lt;div style=\u0026#39;display:flex;align-items:center;justify-content:space-between\u0026#39;\u0026gt;\u0026lt;b\u0026gt;E\u0026lt;/b\u0026gt;: \u0026lt;tt style=\u0026#39;font-size:.8em;display:inline-block\u0026#39;\u0026gt;open\u0026lt;br\u0026gt;door\u0026lt;/tt\u0026gt;\u0026lt;/div\u0026gt;\u0026#34;)) --\u0026gt; |close| B((\u0026#34;\u0026lt;ruby\u0026gt;\u0026lt;em\u0026gt;closed\u0026lt;/em\u0026gt;\u0026lt;rt\u0026gt;state\u0026lt;/rt\u0026gt;\u0026lt;/ruby\u0026gt;\u0026lt;hr style=\u0026#39;border-bottom: 1px solid darkblue;\u0026#39;\u0026gt;\u0026lt;div style=\u0026#39;display:flex;align-items:center;justify-content:space-between\u0026#39;\u0026gt;\u0026lt;b\u0026gt;E\u0026lt;/b\u0026gt;: \u0026lt;tt style=\u0026#39;font-size:.8em;display:inline-block\u0026#39;\u0026gt;close\u0026lt;br\u0026gt;door\u0026lt;/tt\u0026gt;\u0026lt;/div\u0026gt;\u0026#34;)) B--\u0026gt;|open|A æ‰§è¡Œ Generator å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒGenerator å‡½æ•°é™¤äº†çŠ¶æ€æœºï¼Œè¿˜æ˜¯ä¸€ä¸ªéå†å™¨å¯¹è±¡ç”Ÿæˆå‡½æ•°ã€‚è¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œå¯ä»¥ä¾æ¬¡éå† Generator å‡½æ•°å†…éƒ¨çš„æ¯ä¸€ä¸ªçŠ¶æ€ã€‚\nå½¢å¼ä¸Šï¼ŒGenerator å‡½æ•°æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªç‰¹å¾ã€‚ä¸€æ˜¯ï¼Œå…³é”®å­—ä¸å‡½æ•°åä¹‹é—´æœ‰ä¸€ä¸ªæ˜Ÿå·* ï¼›äºŒæ˜¯ï¼Œå‡½æ•°ä½“å†…éƒ¨ä½¿ç”¨ yield è¡¨è¾¾å¼ï¼Œå®šä¹‰ä¸åŒçš„å†…éƒ¨çŠ¶æ€ï¼ˆ yield åœ¨è‹±è¯­é‡Œçš„æ„æ€å°±æ˜¯â€œäº§å‡ºâ€ï¼‰ã€‚\nğŸ“ƒ Example\nfunction* helloWorldGenerator() { yield \u0026#39;hello\u0026#39;; yield \u0026#39;world\u0026#39;; return \u0026#39;ending\u0026#39;; } let hw = helloWorldGenerator(); console.log(...hw); // hello world ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ª Generator å‡½æ•° helloWorldGenerator ï¼Œå®ƒå†…éƒ¨æœ‰ä¸¤ä¸ª yield è¡¨è¾¾å¼ï¼ˆ hello å’Œ world ï¼‰ï¼Œå³è¯¥å‡½æ•°æœ‰ä¸‰ä¸ªçŠ¶æ€ï¼šhelloï¼Œworld å’Œ return è¯­å¥ï¼ˆç»“æŸæ‰§è¡Œï¼‰ã€‚\nç„¶åï¼ŒGenerator å‡½æ•°çš„è°ƒç”¨æ–¹æ³•ä¸æ™®é€šå‡½æ•°ä¸€æ ·ï¼Œä¹Ÿæ˜¯åœ¨å‡½æ•°ååé¢åŠ ä¸Šä¸€å¯¹åœ†æ‹¬å·ã€‚ä¸åŒçš„æ˜¯ï¼Œè°ƒç”¨ Generator å‡½æ•°åï¼Œè¯¥å‡½æ•°å¹¶ä¸æ‰§è¡Œï¼Œè¿”å›çš„ä¹Ÿä¸æ˜¯å‡½æ•°è¿è¡Œç»“æœï¼Œè€Œæ˜¯ä¸€ä¸ªæŒ‡å‘å†…éƒ¨çŠ¶æ€çš„ æŒ‡é’ˆå¯¹è±¡Pointer Object ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸€ç« ä»‹ç»çš„éå†å™¨å¯¹è±¡Iterator Object ã€‚\nä¸‹ä¸€æ­¥ï¼Œå¿…é¡»è°ƒç”¨éå†å™¨å¯¹è±¡çš„ next æ–¹æ³•ï¼Œä½¿å¾—æŒ‡é’ˆç§»å‘ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡è°ƒç”¨ next æ–¹æ³•ï¼Œå†…éƒ¨æŒ‡é’ˆå°±ä»å‡½æ•°å¤´éƒ¨æˆ–ä¸Šä¸€æ¬¡åœä¸‹æ¥çš„åœ°æ–¹å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ª yield è¡¨è¾¾å¼ï¼ˆæˆ– return è¯­å¥ï¼‰ä¸ºæ­¢ã€‚æ¢è¨€ä¹‹ï¼ŒGenerator å‡½æ•°æ˜¯åˆ†æ®µæ‰§è¡Œçš„ï¼Œ yield è¡¨è¾¾å¼æ˜¯æš‚åœæ‰§è¡Œçš„æ ‡è®°ï¼Œè€Œ next æ–¹æ³•å¯ä»¥æ¢å¤æ‰§è¡Œã€‚\nğŸ“ƒ Example\nlet next; do { next = hw.next(); console.log(next); } while (!next.done); // { value: \u0026#39;hello\u0026#39;, done: false } // { value: \u0026#39;world\u0026#39;, done: false } // { value: \u0026#39;ending\u0026#39;, done: true } ä¸Šé¢ä»£ç ä¸€å…±è°ƒç”¨äº†å››æ¬¡ next æ–¹æ³• :\nGenerator å‡½æ•°å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ª yield è¡¨è¾¾å¼ä¸ºæ­¢ã€‚ next æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„ value å±æ€§å°±æ˜¯å½“å‰ yield è¡¨è¾¾å¼çš„å€¼ helloï¼Œ done å±æ€§çš„å€¼ false ï¼Œè¡¨ç¤ºéå†è¿˜æ²¡æœ‰ç»“æŸ å‡½æ•°ä»ä¸Šæ¬¡ yield è¡¨è¾¾å¼åœä¸‹çš„åœ°æ–¹ï¼Œä¸€ç›´æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ª yield è¡¨è¾¾å¼ å‡½æ•°ç»§ç»­ä»ä¸Šæ¬¡ yield è¡¨è¾¾å¼åœä¸‹çš„åœ°æ–¹ï¼Œä¸€ç›´æ‰§è¡Œåˆ° return è¯­å¥ï¼ˆå¦‚æœæ²¡æœ‰ return è¯­å¥ï¼Œå°±æ‰§è¡Œåˆ°å‡½æ•°ç»“æŸï¼‰ã€‚ next æ–¹æ³•è¿”å›çš„å¯¹è±¡çš„ value å±æ€§ï¼Œå°±æ˜¯ç´§è·Ÿåœ¨ return è¯­å¥åé¢çš„è¡¨è¾¾å¼çš„å€¼ï¼ˆå¦‚æœæ²¡æœ‰ return è¯­å¥ï¼Œåˆ™ value å±æ€§çš„å€¼ä¸º undefined ï¼‰ï¼Œ done å±æ€§çš„å€¼ true ï¼Œè¡¨ç¤ºéå†å·²ç»ç»“æŸã€‚ å‡½æ•°å·²ç»è¿è¡Œå®Œæ¯•ï¼Œ next æ–¹æ³•è¿”å›å¯¹è±¡çš„ value å±æ€§ä¸º undefined ï¼Œ done å±æ€§ä¸º true ã€‚ä»¥åå†è°ƒç”¨ next æ–¹æ³•ï¼Œè¿”å›çš„éƒ½æ˜¯è¿™ä¸ªå€¼ã€‚ æ€»ç»“ä¸€ä¸‹ï¼Œè°ƒç”¨ Generator å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ª éå†å™¨å¯¹è±¡iterator ï¼Œä»£è¡¨ Generator å‡½æ•°çš„å†…éƒ¨æŒ‡é’ˆã€‚ä»¥åï¼Œæ¯æ¬¡è°ƒç”¨éå†å™¨å¯¹è±¡çš„ next æ–¹æ³•ï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªæœ‰ç€ value å’Œ done ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡ã€‚ value å±æ€§è¡¨ç¤ºå½“å‰çš„å†…éƒ¨çŠ¶æ€çš„å€¼ï¼Œæ˜¯ yield è¡¨è¾¾å¼åé¢é‚£ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼› done å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦éå†ç»“æŸã€‚\nES6 æ²¡æœ‰è§„å®šï¼Œfunction å…³é”®å­—ä¸å‡½æ•°åä¹‹é—´çš„æ˜Ÿå·ï¼Œå†™åœ¨å“ªä¸ªä½ç½®ã€‚è¿™å¯¼è‡´ä¸‹é¢çš„å†™æ³•éƒ½èƒ½é€šè¿‡ã€‚\nfunction * foo(x, y) {...} function *foo(x, y) {...} function* foo(x, y) {...} function*foo(x, y) {...} ç”±äº Generator å‡½æ•°ä»ç„¶æ˜¯æ™®é€šå‡½æ•°ï¼Œæ‰€ä»¥ä¸€èˆ¬çš„å†™æ³•æ˜¯ä¸Šé¢çš„ç¬¬ä¸‰ç§ï¼Œå³æ˜Ÿå·ç´§è·Ÿåœ¨ function å…³é”®å­—åé¢ã€‚\nè¯­æ³• è¡¨è¾¾å¼ ç”±äº Generator å‡½æ•°è¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œåªæœ‰è°ƒç”¨ next æ–¹æ³•æ‰ä¼šéå†ä¸‹ä¸€ä¸ªå†…éƒ¨çŠ¶æ€ï¼Œæ‰€ä»¥å…¶å®æä¾›äº†ä¸€ç§ å¯ä»¥æš‚åœæ‰§è¡Œ çš„å‡½æ•°ã€‚ yield è¡¨è¾¾å¼å°±æ˜¯æš‚åœæ ‡å¿—ã€‚\néå†å™¨å¯¹è±¡çš„ next æ–¹æ³•çš„è¿è¡Œé€»è¾‘å¦‚ä¸‹ï¼š\né‡åˆ° yield è¡¨è¾¾å¼ï¼Œå°±æš‚åœæ‰§è¡Œåé¢çš„æ“ä½œï¼Œå¹¶å°†ç´§è·Ÿåœ¨ yield åé¢çš„é‚£ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼Œä½œä¸ºè¿”å›çš„å¯¹è±¡çš„ value å±æ€§å€¼ ä¸‹ä¸€æ¬¡è°ƒç”¨ next æ–¹æ³•æ—¶ï¼Œå†ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ª yield è¡¨è¾¾å¼ å¦‚æœæ²¡æœ‰å†é‡åˆ°æ–°çš„ yield è¡¨è¾¾å¼ï¼Œå°±ä¸€ç›´è¿è¡Œåˆ°å‡½æ•°ç»“æŸï¼Œç›´åˆ° return è¯­å¥ä¸ºæ­¢ï¼Œå¹¶å°† return è¯­å¥åé¢çš„è¡¨è¾¾å¼çš„å€¼ï¼Œä½œä¸ºè¿”å›çš„å¯¹è±¡çš„ value å±æ€§å€¼ å¦‚æœè¯¥å‡½æ•°æ²¡æœ‰ return è¯­å¥ï¼Œåˆ™è¿”å›çš„å¯¹è±¡çš„ value å±æ€§å€¼ä¸º undefined éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ yield è¡¨è¾¾å¼åé¢çš„è¡¨è¾¾å¼ï¼Œåªæœ‰å½“è°ƒç”¨ next æ–¹æ³•ã€å†…éƒ¨æŒ‡é’ˆæŒ‡å‘è¯¥è¯­å¥æ—¶æ‰ä¼šæ‰§è¡Œï¼Œå› æ­¤ç­‰äºä¸º JavaScript æä¾›äº†æ‰‹åŠ¨çš„ æƒ°æ€§æ±‚å€¼Lazy Evaluation çš„è¯­æ³•åŠŸèƒ½ã€‚\nğŸ“ƒ Example\nfunction* gen() { yield 123 + 456; } ä¸Šé¢ä»£ç ä¸­ï¼Œ yield åé¢çš„è¡¨è¾¾å¼ 123 + 456 ï¼Œä¸ä¼šç«‹å³æ±‚å€¼ï¼Œåªä¼šåœ¨ next æ–¹æ³•å°†æŒ‡é’ˆç§»åˆ°è¿™ä¸€å¥æ—¶ï¼Œæ‰ä¼šæ±‚å€¼ã€‚\nyield è¡¨è¾¾å¼ä¸ return è¯­å¥æ—¢æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œä¹Ÿæœ‰åŒºåˆ«ã€‚ç›¸ä¼¼ä¹‹å¤„åœ¨äºï¼Œéƒ½èƒ½è¿”å›ç´§è·Ÿåœ¨è¯­å¥åé¢çš„é‚£ä¸ªè¡¨è¾¾å¼çš„å€¼ã€‚åŒºåˆ«åœ¨äºæ¯æ¬¡é‡åˆ° yield ï¼Œå‡½æ•°æš‚åœæ‰§è¡Œï¼Œä¸‹ä¸€æ¬¡å†ä»è¯¥ä½ç½®ç»§ç»­å‘åæ‰§è¡Œï¼Œè€Œ return è¯­å¥ä¸å…·å¤‡ä½ç½®è®°å¿†çš„åŠŸèƒ½ã€‚ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œåªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼ˆæˆ–è€…è¯´ä¸€ä¸ªï¼‰ return è¯­å¥ï¼Œä½†æ˜¯å¯ä»¥æ‰§è¡Œå¤šæ¬¡ï¼ˆæˆ–è€…è¯´å¤šä¸ªï¼‰ yield è¡¨è¾¾å¼ã€‚æ­£å¸¸å‡½æ•°åªèƒ½è¿”å›ä¸€ä¸ªå€¼ï¼Œå› ä¸ºåªèƒ½æ‰§è¡Œä¸€æ¬¡ return ï¼›Generator å‡½æ•°å¯ä»¥è¿”å›ä¸€ç³»åˆ—çš„å€¼ï¼Œå› ä¸ºå¯ä»¥æœ‰ä»»æ„å¤šä¸ª yield ã€‚ä»å¦ä¸€ä¸ªè§’åº¦çœ‹ï¼Œä¹Ÿå¯ä»¥è¯´ Generator ç”Ÿæˆäº†ä¸€ç³»åˆ—çš„å€¼ï¼Œè¿™ä¹Ÿå°±æ˜¯å®ƒçš„åç§°çš„æ¥å†ã€‚\nGenerator å‡½æ•°å¯ä»¥ä¸ç”¨ yield è¡¨è¾¾å¼ï¼Œè¿™æ—¶å°±å˜æˆäº†ä¸€ä¸ªå•çº¯çš„æš‚ç¼“æ‰§è¡Œå‡½æ•°ã€‚\nğŸ“ƒ Example\nfunction* g() { console.log(\u0026#39;æ‰§è¡Œäº†ï¼\u0026#39;) } let generator = g(); setTimeout(function () { generator.next() }, 2000); ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•° f å¦‚æœæ˜¯æ™®é€šå‡½æ•°ï¼Œåœ¨ä¸ºå˜é‡ generator èµ‹å€¼æ—¶å°±ä¼šæ‰§è¡Œã€‚ä½†æ˜¯ï¼Œå‡½æ•° f æ˜¯ä¸€ä¸ª Generator å‡½æ•°ï¼Œå°±å˜æˆåªæœ‰è°ƒç”¨ next æ–¹æ³•æ—¶ï¼Œå‡½æ•° f æ‰ä¼šæ‰§è¡Œã€‚\n:warning: Caution yield è¡¨è¾¾å¼åªèƒ½ç”¨åœ¨ Generator å‡½æ•°é‡Œé¢ï¼Œç”¨åœ¨å…¶ä»–åœ°æ–¹éƒ½ä¼šæŠ¥é”™ã€‚\nğŸ“ƒ Example\n(function (){ yield 1; })() // SyntaxError: Unexpected number ä¸Šé¢ä»£ç åœ¨ä¸€ä¸ªæ™®é€šå‡½æ•°ä¸­ä½¿ç”¨ yield è¡¨è¾¾å¼ï¼Œç»“æœäº§ç”Ÿä¸€ä¸ªå¥æ³•é”™è¯¯ã€‚\nä¸‹é¢æ˜¯å¦å¤–ä¸€ä¸ªä¾‹å­ã€‚\nğŸ“ƒ Example\nconst arr = [1, [[2, 3], 4], [5, 6]]; const flat = function* (a) { a.forEach(function (item) { Ã— if (typeof item !== \u0026#39;number\u0026#39;) { yield * flat(item); } else { yield item; } }); }; for (const f of flat(arr)) { console.log(f); } ä¸Šé¢ä»£ç ä¹Ÿä¼šäº§ç”Ÿå¥æ³•é”™è¯¯ï¼Œå› ä¸º forEach æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ª æ™®é€šå‡½æ•°function ï¼Œä½†æ˜¯åœ¨é‡Œé¢ä½¿ç”¨äº† yield è¡¨è¾¾å¼ï¼ˆè¿™ä¸ªå‡½æ•°é‡Œé¢è¿˜ä½¿ç”¨äº† yield* è¡¨è¾¾å¼ï¼‰ã€‚\nä¸€ç§ä¿®æ”¹æ–¹æ³•æ˜¯æ”¹ç”¨ for å¾ªç¯ã€‚\nğŸ“ƒ Example\nconst arr = [1, [[[2]], [3, 4]], [5, 6]]; function* flat(arr) { for (let i = 0; i \u0026lt; arr.length; i++) { let e = arr[i]; if (Array.isArray(e)) yield* flat(e); else yield e; } } console.log(...flat(arr)); console.log(...arr.flat(Infinity)); // 1 2 3 4 5 6 å¦å¤–ï¼Œ yield è¡¨è¾¾å¼å¦‚æœç”¨åœ¨å¦ä¸€ä¸ªè¡¨è¾¾å¼ä¹‹ä¸­ï¼Œå¿…é¡»æ”¾åœ¨åœ†æ‹¬å·é‡Œé¢ã€‚\nfunction* demo() { console.log(\u0026#39;Hello\u0026#39; + yield); // SyntaxError console.log(\u0026#39;Hello\u0026#39; + yield 123); // SyntaxError console.log(\u0026#39;Hello\u0026#39; + (yield)); // OK console.log(\u0026#39;Hello\u0026#39; + (yield 123)); // OK } yield è¡¨è¾¾å¼ç”¨ä½œå‡½æ•°å‚æ•°æˆ–æ”¾åœ¨èµ‹å€¼è¡¨è¾¾å¼çš„å³è¾¹ï¼Œå¯ä»¥ä¸åŠ æ‹¬å·ã€‚\nconst foo = (...$) =\u0026gt; console.log($); function* demo() { foo(yield \u0026#39;a\u0026#39;, yield \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;); // OK let input = yield; // OK } console.log(...demo()); // [ undefined, undefined, \u0026#39;c\u0026#39; ] // a b undefined æ¥å£ ä»»æ„ä¸€ä¸ªå¯¹è±¡çš„ Symbol.iterator æ–¹æ³•ï¼Œç­‰äºè¯¥å¯¹è±¡çš„ éå†å™¨ç”Ÿæˆå‡½æ•° ï¼Œè°ƒç”¨è¯¥å‡½æ•°ä¼šè¿”å›è¯¥å¯¹è±¡çš„ä¸€ä¸ªéå†å™¨å¯¹è±¡ã€‚\nç”±äº Generator å‡½æ•°å°±æ˜¯ éå†å™¨ç”Ÿæˆå‡½æ•° ï¼Œå› æ­¤å¯ä»¥æŠŠ Generator èµ‹å€¼ç»™å¯¹è±¡çš„ Symbol.iterator å±æ€§ï¼Œä»è€Œä½¿å¾—è¯¥å¯¹è±¡å…·æœ‰ Iterator æ¥å£ã€‚\nğŸ“ƒ Example\nconst myIterable = { [Symbol.iterator]: function* () { yield 1; yield 2; yield 3; } } console.log([...myIterable]); // [1, 2, 3] ä¸Šé¢ä»£ç ä¸­ï¼ŒGenerator å‡½æ•°èµ‹å€¼ç»™ @@Symbol.iterator å±æ€§ï¼Œä»è€Œä½¿å¾— myIterable å¯¹è±¡å…·æœ‰äº† Iterator æ¥å£ï¼Œå¯ä»¥è¢« ... è¿ç®—ç¬¦éå†äº†ã€‚\nGenerator å‡½æ•°æ‰§è¡Œåï¼Œè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ã€‚è¯¥å¯¹è±¡æœ¬èº«ä¹Ÿå…·æœ‰ @@Symbol.iterator å±æ€§ï¼Œæ‰§è¡Œåè¿”å›è‡ªèº«ã€‚\nğŸ“ƒ Example\nfunction* gen(){ // some code } const g = gen(); console.log(g[Symbol.iterator]() === g); // true ä¸Šé¢ä»£ç ä¸­ï¼Œ gen æ˜¯ä¸€ä¸ª Generator å‡½æ•°ï¼Œè°ƒç”¨å®ƒä¼šç”Ÿæˆä¸€ä¸ªéå†å™¨å¯¹è±¡ g ã€‚å®ƒçš„ @@Symbol.iterator å±æ€§ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªéå†å™¨å¯¹è±¡ç”Ÿæˆå‡½æ•°ï¼Œæ‰§è¡Œåè¿”å›å®ƒè‡ªå·±ã€‚\næ–¹æ³• Generator. next()ï¼Œ for-ofï¼Œ prototype.throw()ï¼Œ prototype.return()ï¼Œ next()ã€throw()ã€return() çš„å…±åŒç‚¹ï¼Œ yield*\nnext() yield è¡¨è¾¾å¼æœ¬èº«æ²¡æœ‰è¿”å›å€¼ï¼Œæˆ–è€…è¯´æ€»æ˜¯è¿”å› undefined ã€‚ next æ–¹æ³•å¯ä»¥å¸¦ä¸€ä¸ªå‚æ•°ï¼Œè¯¥å‚æ•°å°±ä¼šè¢«å½“ä½œä¸Šä¸€ä¸ª yield è¡¨è¾¾å¼çš„ è¿”å›å€¼ ã€‚\nfunction* f() { for (let i = 0; true; i++) { const reset = yield i; if (reset) { i = -1; } } } const g = f(); console.log( g.next(), // { value: 0, done: false } g.next(), // { value: 1, done: false } g.next(true) // { value: 0, done: false } ) ä¸Šé¢ä»£ç å…ˆå®šä¹‰äº†ä¸€ä¸ªå¯ä»¥æ— é™è¿è¡Œçš„ Generator å‡½æ•° fï¼Œå¦‚æœ next æ–¹æ³•æ²¡æœ‰å‚æ•°ï¼Œæ¯æ¬¡è¿è¡Œåˆ° yield è¡¨è¾¾å¼ï¼Œå˜é‡ reset çš„å€¼æ€»æ˜¯ undefined ã€‚å½“ next æ–¹æ³•å¸¦ä¸€ä¸ªå‚æ•° true æ—¶ï¼Œå˜é‡ reset å°±è¢«é‡ç½®ä¸ºè¿™ä¸ªå‚æ•°ï¼ˆå³ true ï¼‰ï¼Œå› æ­¤ i ä¼šç­‰äº -1 ï¼Œä¸‹ä¸€è½®å¾ªç¯å°±ä¼šä» -1 å¼€å§‹é€’å¢ã€‚\nè¿™ä¸ªåŠŸèƒ½æœ‰å¾ˆé‡è¦çš„è¯­æ³•æ„ä¹‰ã€‚Generator å‡½æ•°ä»æš‚åœçŠ¶æ€åˆ°æ¢å¤è¿è¡Œï¼Œå®ƒçš„ ä¸Šä¸‹æ–‡çŠ¶æ€context æ˜¯ä¸å˜çš„ã€‚é€šè¿‡ next() æ–¹æ³•çš„å‚æ•°ï¼Œå°±æœ‰åŠæ³•åœ¨ Generator å‡½æ•°å¼€å§‹è¿è¡Œä¹‹åï¼Œç»§ç»­å‘å‡½æ•°ä½“å†…éƒ¨æ³¨å…¥å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥åœ¨ Generator å‡½æ•°è¿è¡Œçš„ä¸åŒé˜¶æ®µï¼Œä»å¤–éƒ¨å‘å†…éƒ¨æ³¨å…¥ä¸åŒçš„å€¼ï¼Œä»è€Œè°ƒæ•´å‡½æ•°è¡Œä¸ºã€‚\nå†çœ‹ä¸€ä¸ªä¾‹å­ã€‚\nğŸ“ƒ Example\nfunction* foo(x) { const y = 2 * (yield (x + 1)); const z = yield (y / 3); return (x + y + z); } const a = foo(5); console.log( a.next(), // Object{value:6, done:false} a.next(), // Object{value:NaN, done:false} a.next(), // Object{value:NaN, done:true} ); const b = foo(5); console.log( b.next(), // { value:6, done:false } b.next(12), // { value:8, done:false } b.next(13), // { value:42, done:true } ); ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬äºŒæ¬¡è¿è¡Œ next æ–¹æ³•çš„æ—¶å€™ä¸å¸¦å‚æ•°ï¼Œå¯¼è‡´ y çš„å€¼ç­‰äº 2 * undefined ï¼ˆå³NaNï¼‰ï¼Œé™¤ä»¥ 3 ä»¥åè¿˜æ˜¯NaNï¼Œå› æ­¤è¿”å›å¯¹è±¡çš„ value å±æ€§ä¹Ÿç­‰äº NaN ã€‚ç¬¬ä¸‰æ¬¡è¿è¡Œ next æ–¹æ³•çš„æ—¶å€™ä¸å¸¦å‚æ•°ï¼Œæ‰€ä»¥zç­‰äº undefined ï¼Œè¿”å›å¯¹è±¡çš„ value å±æ€§ç­‰äº5 + NaN + undefinedï¼Œå³NaNã€‚\nå¦‚æœå‘ next æ–¹æ³•æä¾›å‚æ•°ï¼Œè¿”å›ç»“æœå°±å®Œå…¨ä¸ä¸€æ ·äº†ã€‚ä¸Šé¢ä»£ç ç¬¬ä¸€æ¬¡è°ƒç”¨bçš„ next æ–¹æ³•æ—¶ï¼Œè¿”å›x+1çš„å€¼6ï¼›ç¬¬äºŒæ¬¡è°ƒç”¨ next æ–¹æ³•ï¼Œå°†ä¸Šä¸€æ¬¡ yield è¡¨è¾¾å¼çš„å€¼è®¾ä¸º12ï¼Œå› æ­¤yç­‰äº24ï¼Œè¿”å›y / 3çš„å€¼8ï¼›ç¬¬ä¸‰æ¬¡è°ƒç”¨ next æ–¹æ³•ï¼Œå°†ä¸Šä¸€æ¬¡ yield è¡¨è¾¾å¼çš„å€¼è®¾ä¸º13ï¼Œå› æ­¤zç­‰äº13ï¼Œè¿™æ—¶xç­‰äº5ï¼Œyç­‰äº24ï¼Œæ‰€ä»¥ return è¯­å¥çš„å€¼ç­‰äº42ã€‚\næ³¨æ„ï¼Œç”±äº next æ–¹æ³•çš„å‚æ•°è¡¨ç¤ºä¸Šä¸€ä¸ª yield è¡¨è¾¾å¼çš„è¿”å›å€¼ï¼Œæ‰€ä»¥åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨ next æ–¹æ³•æ—¶ï¼Œä¼ é€’å‚æ•°æ˜¯æ— æ•ˆçš„ã€‚V8 å¼•æ“ç›´æ¥å¿½ç•¥ç¬¬ä¸€æ¬¡ä½¿ç”¨ next æ–¹æ³•æ—¶çš„å‚æ•°ï¼Œåªæœ‰ä»ç¬¬äºŒæ¬¡ä½¿ç”¨ next æ–¹æ³•å¼€å§‹ï¼Œå‚æ•°æ‰æ˜¯æœ‰æ•ˆçš„ã€‚ä»è¯­ä¹‰ä¸Šè®²ï¼Œç¬¬ä¸€ä¸ª next æ–¹æ³•ç”¨æ¥å¯åŠ¨éå†å™¨å¯¹è±¡ï¼Œæ‰€ä»¥ä¸ç”¨å¸¦æœ‰å‚æ•°ã€‚\nå†çœ‹ä¸€ä¸ªé€šè¿‡ next æ–¹æ³•çš„å‚æ•°ï¼Œå‘ Generator å‡½æ•°å†…éƒ¨è¾“å…¥å€¼çš„ä¾‹å­ã€‚\nğŸ“ƒ Example\nfunction* dataConsumer() { console.log(\u0026#39;Started\u0026#39;); console.log(\u0026#39;1.\u0026#39;, yield); console.log(\u0026#39;2.\u0026#39;, yield); return \u0026#39;result\u0026#39;; } let genObj = dataConsumer(); genObj.next(); genObj.next(\u0026#39;a\u0026#39;); genObj.next(\u0026#39;b\u0026#39;); // Started 1. a 2. b ä¸Šé¢ä»£ç æ˜¯ä¸€ä¸ªå¾ˆç›´è§‚çš„ä¾‹å­ï¼Œæ¯æ¬¡é€šè¿‡ next æ–¹æ³•å‘ Generator å‡½æ•°è¾“å…¥å€¼ï¼Œç„¶åæ‰“å°å‡ºæ¥ã€‚\nå¦‚æœæƒ³è¦ç¬¬ä¸€æ¬¡è°ƒç”¨ next æ–¹æ³•æ—¶ï¼Œå°±èƒ½å¤Ÿè¾“å…¥å€¼ï¼Œå¯ä»¥åœ¨ Generator å‡½æ•°å¤–é¢å†åŒ…ä¸€å±‚ã€‚\nğŸ“ƒ Example\nclass Wrapper { constructor(fn) { return (...args) =\u0026gt; { let fnIterator = fn(...args); console.log(fnIterator.next()); // { value: undefined, done: false } // æŠŠç¬¬ä¸€ä¸ªæ²¡æœ‰å‚æ•°çš„next()è¿­ä»£æ‰ return fnIterator; }; } } let wrapped = (new Wrapper(function* () { console.log(\u0026#39;First input:\u0026#39;, yield); console.log(\u0026#39;Second input:\u0026#39;, yield); return \u0026#39;DONE\u0026#39;; }))(); let ret; do { ret = wrapped.next(\u0026#39;hello!\u0026#39;); // { value: undefined, done: false } // { value: \u0026#39;DONE\u0026#39;, done: true } console.log(ret); } while (!ret.done); // First input: hello! // Second input: hello! ä¸Šé¢ä»£ç ä¸­ï¼ŒGenerator å‡½æ•°å¦‚æœä¸ç”¨ wrapper å…ˆåŒ…ä¸€å±‚ï¼Œæ˜¯æ— æ³•ç¬¬ä¸€æ¬¡è°ƒç”¨ next æ–¹æ³•ï¼Œå°±è¾“å…¥å‚æ•°çš„ã€‚\nfor...of for-of å¾ªç¯å¯ä»¥è‡ªåŠ¨éå† Generator å‡½æ•°è¿è¡Œæ—¶ç”Ÿæˆçš„ Iterator å¯¹è±¡ï¼Œä¸”æ­¤æ—¶ä¸å†éœ€è¦è°ƒç”¨ next æ–¹æ³•ã€‚\nğŸ“ƒ Example\nfunction* foo() { yield 1; yield 2; yield 3; yield 4; yield 5; return 6; } for (let v of foo()) { console.log(v); } // 1 2 3 4 5 ä¸Šé¢ä»£ç ä½¿ç”¨ for-of å¾ªç¯ï¼Œä¾æ¬¡æ˜¾ç¤º 5 ä¸ª yield è¡¨è¾¾å¼çš„å€¼ã€‚\n:memo: Note ä¸€æ—¦ next æ–¹æ³•çš„è¿”å›å¯¹è±¡çš„ done å±æ€§ä¸º true ï¼Œ for-of å¾ªç¯å°±ä¼šä¸­æ­¢ï¼Œä¸”ä¸åŒ…å«è¯¥è¿”å›å¯¹è±¡ï¼Œæ‰€ä»¥ä¸Šé¢ä»£ç çš„ return è¯­å¥è¿”å›çš„ 6ï¼Œä¸åŒ…æ‹¬åœ¨ for-of å¾ªç¯ä¹‹ä¸­ã€‚\nğŸ“ƒ Example\nä¸‹é¢æ˜¯ä¸€ä¸ªåˆ©ç”¨ Generator å‡½æ•°å’Œ for-of å¾ªç¯ï¼Œå®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ä¾‹å­ã€‚\n// Generatoré£æ ¼çš„Jsæ–æ³¢é‚£å¥‘ function* fibonacci() { let [prev, curr] = [0, 1]; while (true) { yield curr; [prev, curr] = [curr, prev + curr]; } } for (let n of fibonacci()) { if (n \u0026gt; 1000) break; console.log(n); } // Jsç‰ˆæœ¬çš„æ–æ³¢é‚£å¥‘ function fibonacciF(length) { let arr = []; let [prev, curr] = [0, 1]; while (arr.length \u0026lt; length) { arr.push(curr); [prev, curr] = [curr, prev + curr]; } return arr; } console.log(...fibonacciF(20)); // Cé£æ ¼çš„æ–æ³¢é‚£å¥‘ function fibonacciC(length) { const printf = (...args) =\u0026gt; console.log(...args); let i, f1 = 1, f2 = 2, f3; printf(f1, f2); for (i = 1; i \u0026lt; length - 1; i++) { f3 = f2 + f1; printf(f3); f1 = f2; f2 = f3; // Jsè§£æ„èµ‹å€¼ [f1, f2] = [f2, f1 + f2] } } fibonacciC(20); ä»ä¸Šé¢ä»£ç å¯è§ï¼Œä½¿ç”¨ for-of è¯­å¥æ—¶ä¸éœ€è¦ä½¿ç”¨ next æ–¹æ³•ã€‚\nåˆ©ç”¨ for-of å¾ªç¯ï¼Œå¯ä»¥å†™å‡ºéå†ä»»æ„å¯¹è±¡object çš„æ–¹æ³•ã€‚åŸç”Ÿçš„ JavaScript å¯¹è±¡æ²¡æœ‰éå†æ¥å£ï¼Œæ— æ³•ä½¿ç”¨ for-of å¾ªç¯ï¼Œé€šè¿‡ Generator å‡½æ•°ä¸ºå®ƒåŠ ä¸Šè¿™ä¸ªæ¥å£ï¼Œå°±å¯ä»¥ç”¨äº†ã€‚\nğŸ“ƒ Example\nfunction* objectEntities(obj) { let keys = Reflect.ownKeys(obj); // Reflect.ownKeys()æ–¹æ³• // å¯ä»¥å¯ä»¥åŒæ—¶è·å–æ™®é€šå’ŒSymbolæˆå‘˜ for (const key of keys) { yield [key, obj[key]]; } } const obj = {foo: \u0026#39;bar\u0026#39;,[Symbol()]:\u0026#39;baz\u0026#39;}; for (const [key, value] of objectEntities(obj)) { console.log( `{${key.toString()}: \u0026#39;${value.toString()}\u0026#39;}` ); // {foo: \u0026#39;bar\u0026#39;} // {Symbol(): \u0026#39;baz\u0026#39;} } ä¸Šé¢ä»£ç ä¸­ï¼Œå¯¹è±¡ jane åŸç”Ÿä¸å…·å¤‡ Iterator æ¥å£ï¼Œæ— æ³•ç”¨ for-of éå†ã€‚\nè¿™æ—¶ï¼Œæˆ‘ä»¬é€šè¿‡ Generator å‡½æ•° objectEntries ä¸ºå®ƒåŠ ä¸Šéå†å™¨æ¥å£ï¼Œå°±å¯ä»¥ç”¨ for-of éå†äº†ã€‚åŠ ä¸Šéå†å™¨æ¥å£çš„å¦ä¸€ç§å†™æ³•æ˜¯ï¼Œå°† Generator å‡½æ•°åŠ åˆ°å¯¹è±¡çš„ @@Symbol.iterator å±æ€§ä¸Šé¢ã€‚\nfunction* objectEntities() { let keys = Reflect.ownKeys(this); // Reflect.ownKeys()æ–¹æ³• // å¯ä»¥åŒæ—¶è·å–æ™®é€šå’ŒSymbolæˆå‘˜ for (const key of keys) { if (key === Symbol.iterator) continue; yield [key, obj[key]]; } } const obj = {foo: \u0026#39;bar\u0026#39;, [Symbol()]: \u0026#39;baz\u0026#39;}; Reflect.defineProperty(obj, Symbol.iterator, { value: objectEntities, enumerable: false // enumerableå±æ€§åªå¯¹Object.keys()ç”Ÿæ•ˆ }) // æŒ‚è½½@@Symbol.iterator for (const [key, value] of obj) { console.log( `{${key.toString()}: \u0026#39;${value.toString()}\u0026#39;}` ); // {foo: \u0026#39;bar\u0026#39;} // {Symbol(): \u0026#39;baz\u0026#39;} } é™¤äº† for-of å¾ªç¯ä»¥å¤–ï¼Œæ‰©å±•è¿ç®—ç¬¦...ã€è§£æ„èµ‹å€¼[] å’ŒArray.fromæ–¹æ³•å†…éƒ¨è°ƒç”¨çš„ï¼Œéƒ½æ˜¯éå†å™¨æ¥å£ã€‚è¿™æ„å‘³ç€ï¼Œå®ƒä»¬éƒ½å¯ä»¥å°† Generator å‡½æ•°è¿”å›çš„ Iterator å¯¹è±¡ï¼Œä½œä¸ºå‚æ•°ã€‚\nfunction* numbers() { yield 1; yield 2; return 3; yield 4; } console.log( // æ‰©å±•è¿ç®—ç¬¦ [...numbers()], // [1, 2] // Array.from æ–¹æ³• Array.from(numbers()) // [1, 2] ); // è§£æ„èµ‹å€¼ let [x, y] = numbers(); console.log( x, // 1 y, // 2 ); // for...of å¾ªç¯ for (let n of numbers()) { console.log(n) } // 1 2 throw() Generator.prototype.throw(exception)\nGenerator å‡½æ•°è¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œéƒ½æœ‰ä¸€ä¸ª throw æ–¹æ³•ï¼Œå¯ä»¥åœ¨å‡½æ•°ä½“å¤–æŠ›å‡ºé”™è¯¯ï¼Œç„¶ååœ¨ Generator å‡½æ•°ä½“å†…æ•è·ã€‚\nğŸ“ƒ Example\nconst g = function* () { try { yield; } catch (e) { console.log(\u0026#39;å†…éƒ¨æ•è·\u0026#39;, e); } }; const i = g(); i.next(); try { i.throw(\u0026#39;a\u0026#39;); i.throw(\u0026#39;b\u0026#39;); } catch (e) { console.log(\u0026#39;å¤–éƒ¨æ•è·\u0026#39;, e); } // å†…éƒ¨æ•è· a // å¤–éƒ¨æ•è· b ä¸Šé¢ä»£ç ä¸­ï¼Œéå†å™¨å¯¹è±¡ i è¿ç»­æŠ›å‡ºthrow ä¸¤ä¸ªé”™è¯¯ã€‚ç¬¬ä¸€ä¸ªé”™è¯¯è¢« Generator å‡½æ•°ä½“å†…çš„ catch è¯­å¥æ•è·ã€‚i ç¬¬äºŒæ¬¡æŠ›å‡ºé”™è¯¯ï¼Œç”±äº Generator å‡½æ•°å†…éƒ¨çš„ catch è¯­å¥å·²ç»æ‰§è¡Œè¿‡äº†ï¼Œä¸ä¼šå†æ•æ‰åˆ°è¿™ä¸ªé”™è¯¯äº†ï¼Œæ‰€ä»¥è¿™ä¸ªé”™è¯¯å°±è¢«æŠ›å‡ºäº† Generator å‡½æ•°ä½“ï¼Œè¢«å‡½æ•°ä½“å¤–çš„ catch è¯­å¥æ•è·ã€‚\nthrow æ–¹æ³•å¯ä»¥æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œè¯¥å‚æ•°ä¼šè¢« catch è¯­å¥æ¥æ”¶ï¼Œå»ºè®®æŠ›å‡ºError å¯¹è±¡çš„å®ä¾‹ã€‚\nğŸ“ƒ Example\nconst g = function* () { try { yield; } catch (e) { console.log(e); } }; const i = g(); i.next(); i.throw(new Error(\u0026#39;å‡ºé”™äº†ï¼\u0026#39;)); // Error: å‡ºé”™äº†ï¼ ä¸Šé¢ä»£ç çš„é”™è¯¯ï¼Œæ˜¯ç”¨éå†å™¨å¯¹è±¡çš„ throw æ–¹æ³•æŠ›å‡ºçš„ï¼Œè€Œä¸æ˜¯ç”¨ throw å‘½ä»¤æŠ›å‡ºçš„ã€‚åè€…åªèƒ½è¢«å‡½æ•°ä½“å¤–çš„ catch è¯­å¥æ•è·ã€‚\næ³¨æ„ï¼Œä¸è¦æ··æ·†éå†å™¨å¯¹è±¡çš„ throw æ–¹æ³•å’Œå…¨å±€çš„ throw å‘½ä»¤ã€‚\nlet g = function* () { while (true) { try { yield; } catch (e) { if (e !== \u0026#39;a\u0026#39;) throw e; console.log(\u0026#39;å†…éƒ¨æ•è·\u0026#39;, e); } } }; const i = g(); i.next(); try { throw new Error(\u0026#39;a\u0026#39;); throw new Error(\u0026#39;b\u0026#39;); } catch (e) { console.log(\u0026#39;å¤–éƒ¨æ•è·\u0026#39;, e); } // å¤–éƒ¨æ•è· Error: a å¦‚æœ Generator å‡½æ•°å†…éƒ¨æ²¡æœ‰éƒ¨ç½² try-catch ä»£ç å—ï¼Œé‚£ä¹ˆ throw æ–¹æ³•æŠ›å‡ºçš„é”™è¯¯ï¼Œå°†è¢«å¤–éƒ¨ try-catch ä»£ç å—æ•è·ã€‚\nğŸ“ƒ Example\nconst g = function* () { while (true) { yield; console.log(\u0026#39;å†…éƒ¨æ•è·\u0026#39;, e); } }; const i = g(); i.next(); try { i.throw(\u0026#39;a\u0026#39;); i.throw(\u0026#39;b\u0026#39;); } catch (e) { console.log(\u0026#39;å¤–éƒ¨æ•è·\u0026#39;, e); } // å¤–éƒ¨æ•è· a ä¸Šé¢ä»£ç ä¸­ï¼ŒGenerator å‡½æ•° g å†…éƒ¨æ²¡æœ‰éƒ¨ç½² try-catch ä»£ç å—ï¼Œæ‰€ä»¥æŠ›å‡ºçš„é”™è¯¯ç›´æ¥è¢«å¤–éƒ¨ catch ä»£ç å—æ•è·ã€‚\nå¦‚æœ Generator å‡½æ•°å†…éƒ¨å’Œå¤–éƒ¨ï¼Œéƒ½æ²¡æœ‰éƒ¨ç½² try-catch ä»£ç å—ï¼Œé‚£ä¹ˆç¨‹åºå°†æŠ¥é”™ï¼Œç›´æ¥ä¸­æ–­æ‰§è¡Œã€‚\nğŸ“ƒ Example\nconst gen = function* gen() { yield console.log(\u0026#39;hello\u0026#39;); yield console.log(\u0026#39;world\u0026#39;); }; const g = gen(); g.next(); g.throw(); // hello // Uncaught undefined ä¸Šé¢ä»£ç ä¸­ï¼Œg.throw æŠ›å‡ºé”™è¯¯ä»¥åï¼Œæ²¡æœ‰ä»»ä½• try-catch ä»£ç å—å¯ä»¥æ•è·è¿™ä¸ªé”™è¯¯ï¼Œå¯¼è‡´ç¨‹åºæŠ¥é”™ï¼Œä¸­æ–­æ‰§è¡Œã€‚\nthrow æ–¹æ³•æŠ›å‡ºçš„é”™è¯¯è¦è¢«å†…éƒ¨æ•è·ï¼Œå‰ææ˜¯å¿…é¡»è‡³å°‘æ‰§è¡Œè¿‡ä¸€æ¬¡ next æ–¹æ³•ã€‚\nğŸ“ƒ Example\nfunction* gen() { try { yield 1; } catch (e) { console.log(\u0026#39;å†…éƒ¨æ•è·\u0026#39;); } } const g = gen(); g.throw(1); // Uncaught 1 ä¸Šé¢ä»£ç ä¸­ï¼Œg.throw(1) æ‰§è¡Œæ—¶ï¼Œnext æ–¹æ³•ä¸€æ¬¡éƒ½æ²¡æœ‰æ‰§è¡Œè¿‡ã€‚è¿™æ—¶ï¼ŒæŠ›å‡ºçš„é”™è¯¯ä¸ä¼šè¢«å†…éƒ¨æ•è·ï¼Œè€Œæ˜¯ç›´æ¥åœ¨å¤–éƒ¨æŠ›å‡ºï¼Œå¯¼è‡´ç¨‹åºå‡ºé”™ã€‚è¿™ç§è¡Œä¸ºå…¶å®å¾ˆå¥½ç†è§£ï¼Œå› ä¸ºç¬¬ä¸€æ¬¡æ‰§è¡Œ next æ–¹æ³•ï¼Œç­‰åŒäºå¯åŠ¨æ‰§è¡Œ Generator å‡½æ•°çš„å†…éƒ¨ä»£ç ï¼Œå¦åˆ™ Generator å‡½æ•°è¿˜æ²¡æœ‰å¼€å§‹æ‰§è¡Œï¼Œè¿™æ—¶ throw æ–¹æ³•æŠ›é”™åªå¯èƒ½æŠ›å‡ºåœ¨å‡½æ•°å¤–éƒ¨ã€‚\nthrow æ–¹æ³•è¢«æ•è·ä»¥åï¼Œä¼šé™„å¸¦æ‰§è¡Œä¸‹ä¸€æ¡ yield è¡¨è¾¾å¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¼šé™„å¸¦æ‰§è¡Œä¸€æ¬¡ next æ–¹æ³•ã€‚\nğŸ“ƒ Example\nconst gen = function* gen() { try { yield console.log(\u0026#39;a\u0026#39;)||\u0026#39;a\u0026#39;; } catch (e) { // ... } yield console.log(\u0026#39;b\u0026#39;)||\u0026#39;b\u0026#39;; yield console.log(\u0026#39;c\u0026#39;)||\u0026#39;c\u0026#39;; }; const g = gen(); g.next() // a g.throw() // b g.next() // c ä¸Šé¢ä»£ç ä¸­ï¼Œg.throw æ–¹æ³•è¢«æ•è·ä»¥åï¼Œè‡ªåŠ¨æ‰§è¡Œäº†ä¸€æ¬¡ next æ–¹æ³•ï¼Œæ‰€ä»¥ä¼šæ‰“å° b ã€‚å¦å¤–ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œåªè¦ Generator å‡½æ•°å†…éƒ¨éƒ¨ç½²äº† try-catch ä»£ç å—ï¼Œé‚£ä¹ˆéå†å™¨çš„ throw æ–¹æ³•æŠ›å‡ºçš„é”™è¯¯ï¼Œä¸å½±å“ä¸‹ä¸€æ¬¡éå†ã€‚\nå¦å¤–ï¼Œ throw å‘½ä»¤ä¸g.throwæ–¹æ³•æ˜¯æ— å…³çš„ï¼Œä¸¤è€…äº’ä¸å½±å“ã€‚\nğŸ“ƒ Example\nconst gen = function* gen() { yield console.log(\u0026#39;hello\u0026#39;) || \u0026#39;hello\u0026#39;; yield console.log(\u0026#39;world\u0026#39;) || \u0026#39;world\u0026#39;; }; const g = gen(); g.next(); try { throw new Error(); } catch (e) { g.next(); } // hello // world ä¸Šé¢ä»£ç ä¸­ï¼Œ throw å‘½ä»¤æŠ›å‡ºçš„é”™è¯¯ä¸ä¼šå½±å“åˆ°éå†å™¨çš„çŠ¶æ€ï¼Œæ‰€ä»¥ä¸¤æ¬¡æ‰§è¡Œ next æ–¹æ³•ï¼Œéƒ½è¿›è¡Œäº†æ­£ç¡®çš„æ“ä½œã€‚\nè¿™ç§å‡½æ•°ä½“å†…æ•è·é”™è¯¯çš„æœºåˆ¶ï¼Œå¤§å¤§æ–¹ä¾¿äº†å¯¹é”™è¯¯çš„å¤„ç†ã€‚å¤šä¸ª yield è¡¨è¾¾å¼ï¼Œå¯ä»¥åªç”¨ä¸€ä¸ª try-catch ä»£ç å—æ¥æ•è·é”™è¯¯ã€‚å¦‚æœä½¿ç”¨å›è°ƒå‡½æ•°çš„å†™æ³•ï¼Œæƒ³è¦æ•è·å¤šä¸ªé”™è¯¯ï¼Œå°±ä¸å¾—ä¸ä¸ºæ¯ä¸ªå‡½æ•°å†…éƒ¨å†™ä¸€ä¸ªé”™è¯¯å¤„ç†è¯­å¥ï¼Œç°åœ¨åªåœ¨ Generator å‡½æ•°å†…éƒ¨å†™ä¸€æ¬¡ catch è¯­å¥å°±å¯ä»¥äº†ã€‚\nGenerator å‡½æ•°ä½“å¤–æŠ›å‡ºçš„é”™è¯¯ï¼Œå¯ä»¥åœ¨å‡½æ•°ä½“å†…æ•è·ï¼›åè¿‡æ¥ï¼ŒGenerator å‡½æ•°ä½“å†…æŠ›å‡ºçš„é”™è¯¯ï¼Œä¹Ÿå¯ä»¥è¢«å‡½æ•°ä½“å¤–çš„ catch æ•è·ã€‚\nğŸ“ƒ Example\nfunction* foo() { const x = yield 3; const y = x.toUpperCase(); yield y; } const it = foo(); it.next(); // { value:3, done:false } try { it.next(42); } catch (err) { console.log(err); } ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬äºŒä¸ª next æ–¹æ³•å‘å‡½æ•°ä½“å†…ä¼ å…¥ä¸€ä¸ªå‚æ•° 42ï¼Œæ•°å€¼æ˜¯æ²¡æœ‰toUpperCaseæ–¹æ³•çš„ï¼Œæ‰€ä»¥ä¼šæŠ›å‡ºä¸€ä¸ª TypeError é”™è¯¯ï¼Œè¢«å‡½æ•°ä½“å¤–çš„ catch æ•è·ã€‚\n:memo: Note\nä¸€æ—¦ Generator æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºé”™è¯¯ï¼Œä¸”æ²¡æœ‰è¢«å†…éƒ¨æ•è·ï¼Œå°±ä¸ä¼šå†æ‰§è¡Œä¸‹å»äº†ã€‚\nå¦‚æœæ­¤åè¿˜è°ƒç”¨ next() æ–¹æ³•ï¼Œå°†è¿”å›ä¸€ä¸ª value å±æ€§ç­‰äº undefined ã€ done å±æ€§ç­‰äº true çš„å¯¹è±¡ï¼Œå³ JavaScript å¼•æ“è®¤ä¸ºè¿™ä¸ª Generator å·²ç»è¿è¡Œç»“æŸäº†ã€‚\nğŸ“ƒ Example\nfunction* g() { yield 1; console.log(\u0026#39;throwing an exception\u0026#39;); throw new Error(\u0026#39;*Generator* broke!\u0026#39;); yield 2; // Unreachable code yield 3; } function log(generator) { let v; console.log(\u0026#39;starting generator\u0026#39;); try { v = generator.next(); console.log(\u0026#39;ç¬¬ä¸€æ¬¡è¿è¡Œnextæ–¹æ³•\u0026#39;, v); } catch (err) { console.log(\u0026#39;æ•æ‰é”™è¯¯\u0026#39;, v, err.toString()); } try { v = generator.next(); console.log(\u0026#39;ç¬¬äºŒæ¬¡è¿è¡Œnextæ–¹æ³•\u0026#39;, v); } catch (err) { console.log(\u0026#39;æ•æ‰é”™è¯¯\u0026#39;, v, err.toString()); // Error: *Generator* broke! } try { v = generator.next(); console.log(\u0026#39;ç¬¬ä¸‰æ¬¡è¿è¡Œnextæ–¹æ³•\u0026#39;, v); } catch (err) { console.log(\u0026#39;æ•æ‰é”™è¯¯\u0026#39;, v, err.toString()); } console.log(\u0026#39;caller done\u0026#39;); } log(g()); // starting generator // ç¬¬ä¸€æ¬¡è¿è¡Œnextæ–¹æ³• { value: 1, done: false } // throwing an exception // æ•æ‰é”™è¯¯ { value: 1, done: false } // ç¬¬ä¸‰æ¬¡è¿è¡Œnextæ–¹æ³• { value: undefined, done: true } // caller done ä¸Šé¢ä»£ç ä¸€å…±ä¸‰æ¬¡è¿è¡Œ next æ–¹æ³•ï¼Œç¬¬äºŒæ¬¡è¿è¡Œçš„æ—¶å€™ä¼šæŠ›å‡ºé”™è¯¯ï¼Œç„¶åç¬¬ä¸‰æ¬¡è¿è¡Œçš„æ—¶å€™ï¼ŒGenerator å‡½æ•°å°±å·²ç»ç»“æŸäº†ï¼Œä¸å†æ‰§è¡Œä¸‹å»äº†ã€‚\nreturn() Generator.prototype.return(value)\nGenerator å‡½æ•°è¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œè¿˜æœ‰ä¸€ä¸ª return() æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥è¿”å›ç»™å®šçš„å€¼ï¼Œå¹¶ä¸”ç»ˆç»“éå† Generator å‡½æ•°ã€‚\nğŸ“ƒ Example\nfunction* gen() { yield 1; yield 2; yield 3; } const g = gen(); console.log( g.next(), g.return(\u0026#39;foo\u0026#39;), g.next(), ); // { value: 1, done: false } // { value: \u0026#34;foo\u0026#34;, done: true } // { value: undefined, done: true } ä¸Šé¢ä»£ç ä¸­ï¼Œéå†å™¨å¯¹è±¡ g è°ƒç”¨ return() æ–¹æ³•åï¼Œè¿”å›å€¼çš„ value å±æ€§å°±æ˜¯ return() æ–¹æ³•çš„å‚æ•° foo ã€‚å¹¶ä¸”ï¼ŒGenerator å‡½æ•°çš„éå†å°±ç»ˆæ­¢äº†ï¼Œè¿”å›å€¼çš„ done å±æ€§ä¸º true ï¼Œä»¥åå†è°ƒç”¨next()æ–¹æ³•ï¼Œ done å±æ€§æ€»æ˜¯è¿”å› true ã€‚\nå¦‚æœ return() æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¸æä¾›å‚æ•°ï¼Œåˆ™è¿”å›å€¼çš„ value å±æ€§ä¸º undefined ã€‚\nğŸ“ƒ Example\nfunction* gen() { yield 1; yield 2; yield 3; } const g = gen(); console.log( g.next(), g.return() ) // { value: 1, done: false } // { value: undefined, done: true } å¦‚æœ Generator å‡½æ•°å†…éƒ¨æœ‰ try...finally ä»£ç å—ï¼Œä¸”æ­£åœ¨æ‰§è¡Œ try ä»£ç å—ï¼Œé‚£ä¹ˆ return() æ–¹æ³•ä¼šå¯¼è‡´ç«‹åˆ»è¿›å…¥finallyä»£ç å—ï¼Œæ‰§è¡Œå®Œä»¥åï¼Œæ•´ä¸ªå‡½æ•°æ‰ä¼šç»“æŸã€‚\nğŸ“ƒ Example\nfunction* numbers() { yield 1; try { yield 2; yield 3; } finally { yield 4; yield 5; } yield 6; } const g = numbers(); console.log( g.next(), // { value: 1, done: false } g.next(), // { value: 2, done: false } g.return(7), // { value: 4, done: false } // å¯¼è‡´ç«‹å³è¿›å…¥finallyä»£ç å— g.next(), // { value: 5, done: false } g.next() // { value: 7, done: true } ); ä¸Šé¢ä»£ç ä¸­ï¼Œè°ƒç”¨ return() æ–¹æ³•åï¼Œå°±å¼€å§‹æ‰§è¡Œ finally ä»£ç å—ï¼Œä¸æ‰§è¡Œ try é‡Œé¢å‰©ä¸‹çš„ä»£ç äº†ï¼Œç„¶åç­‰åˆ° finally ä»£ç å—æ‰§è¡Œå®Œï¼Œå†è¿”å› return() æ–¹æ³•æŒ‡å®šçš„è¿”å›å€¼ã€‚\nnext()ã€throw()ã€ return() çš„å…±åŒç‚¹ next()ã€throw()ã€ return() è¿™ä¸‰ä¸ªæ–¹æ³•æœ¬è´¨ä¸Šæ˜¯åŒä¸€ä»¶äº‹ï¼Œå¯ä»¥æ”¾åœ¨ä¸€èµ·ç†è§£ã€‚å®ƒä»¬çš„ä½œç”¨éƒ½æ˜¯è®© Generator å‡½æ•°æ¢å¤æ‰§è¡Œï¼Œå¹¶ä¸”ä½¿ç”¨ä¸åŒçš„è¯­å¥æ›¿æ¢ yield è¡¨è¾¾å¼ã€‚\nnext()æ˜¯å°† yield è¡¨è¾¾å¼æ›¿æ¢æˆä¸€ä¸ªå€¼ const g = function* (x, y) { return yield x + y; }; const gen = g(1, 2); console.log( gen.next(), // {value: 3, done: false} gen.next(1) // {value: 1, done: true} ) // ç›¸å½“äºå°† let result = yield x + y // æ›¿æ¢æˆ let result = 1; throw()æ˜¯å°† yield è¡¨è¾¾å¼æ›¿æ¢æˆä¸€ä¸ª throw è¯­å¥ gen.throw(new Error(\u0026#39;å‡ºé”™äº†\u0026#39;)); // Uncaught Error: å‡ºé”™äº† // ç›¸å½“äºå°† let result = yield x + y // æ›¿æ¢æˆ let result = throw(new Error(\u0026#39;å‡ºé”™äº†\u0026#39;)); return() æ˜¯å°† yield è¡¨è¾¾å¼æ›¿æ¢æˆä¸€ä¸ª return è¯­å¥ gen.return(2); // {value: 2, done: true} // ç›¸å½“äºå°† let result = yield x + y // æ›¿æ¢æˆ let result = return 2; yield* è¡¨è¾¾å¼ å¦‚æœåœ¨ Generator å‡½æ•°å†…éƒ¨ï¼Œè°ƒç”¨å¦ä¸€ä¸ª Generator å‡½æ•°ã€‚éœ€è¦åœ¨å‰è€…çš„å‡½æ•°ä½“å†…éƒ¨ï¼Œè‡ªå·±æ‰‹åŠ¨å®Œæˆéå†ã€‚\nğŸ“ƒ Example\nfunction* foo() { yield \u0026#39;a\u0026#39;; yield \u0026#39;b\u0026#39;; } function* bar() { yield \u0026#39;x\u0026#39;; // æ‰‹åŠ¨éå† foo() for (let i of foo()) { console.log(i); } yield \u0026#39;y\u0026#39;; } for (let v of bar()) { console.log(v); } // x a b y ä¸Šé¢ä»£ç ä¸­ï¼Œfoo å’Œ bar éƒ½æ˜¯ Generator å‡½æ•°ï¼Œåœ¨ bar é‡Œé¢è°ƒç”¨ foo ï¼Œå°±éœ€è¦æ‰‹åŠ¨éå† foo ã€‚å¦‚æœæœ‰å¤šä¸ª Generator å‡½æ•°åµŒå¥—ï¼Œå†™èµ·æ¥å°±éå¸¸éº»çƒ¦ã€‚\nES6 æä¾›äº† yield* è¡¨è¾¾å¼ï¼Œä½œä¸ºè§£å†³åŠæ³•ï¼Œç”¨æ¥åœ¨ä¸€ä¸ª Generator å‡½æ•°é‡Œé¢æ‰§è¡Œå¦ä¸€ä¸ª Generator å‡½æ•°ã€‚\nfunction* foo() { yield \u0026#39;a\u0026#39;; yield \u0026#39;b\u0026#39;; } function* bar() { yield \u0026#39;x\u0026#39;; yield* foo(); yield \u0026#39;y\u0026#39;; } // ç­‰åŒäº function* bar2() { yield \u0026#39;x\u0026#39;; yield \u0026#39;a\u0026#39;; yield \u0026#39;b\u0026#39;; yield \u0026#39;y\u0026#39;; } // ç­‰åŒäº function* bar3() { yield \u0026#39;x\u0026#39;; for (let v of foo()) { yield v; } yield \u0026#39;y\u0026#39;; } for (let v of bar()) { console.log(v); } // x a b y å†æ¥çœ‹ä¸€ä¸ªå¯¹æ¯”çš„ä¾‹å­ã€‚\nğŸ“ƒ Example\nfunction* inner() { yield \u0026#39;hello!\u0026#39;; } function* outer1() { yield \u0026#39;open\u0026#39;; yield inner(); yield \u0026#39;close\u0026#39;; } let gen = outer1(); console.log( gen.next().value, gen.next().value, gen.next().value ); // open Object [Generator] {} close function* outer2() { yield \u0026#39;open\u0026#39; yield* inner() yield \u0026#39;close\u0026#39; } gen = outer2(); console.log( gen.next().value, // \u0026#34;open\u0026#34; gen.next().value, // \u0026#34;hello!\u0026#34; gen.next().value // \u0026#34;close\u0026#34; ); // open hello! close ä¸Šé¢ä¾‹å­ä¸­ï¼Œouter2 ä½¿ç”¨äº† yield* ï¼Œouter1 æ²¡ä½¿ç”¨ã€‚ç»“æœå°±æ˜¯ï¼Œouter1 è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œouter2 è¿”å›è¯¥éå†å™¨å¯¹è±¡çš„ å†…éƒ¨å€¼ ã€‚\nä»è¯­æ³•è§’åº¦çœ‹ï¼Œå¦‚æœ yield è¡¨è¾¾å¼åé¢è·Ÿçš„æ˜¯ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œéœ€è¦åœ¨ yield è¡¨è¾¾å¼åé¢åŠ ä¸Šæ˜Ÿå·ï¼Œè¡¨æ˜å®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªéå†å™¨å¯¹è±¡ã€‚è¿™è¢«ç§°ä¸º yield* è¡¨è¾¾å¼ã€‚\nğŸ“ƒ Example\nlet delegatedIterator = (function* () { yield \u0026#39;Hello!\u0026#39;; yield \u0026#39;Bye!\u0026#39;; }()); let delegatingIterator = (function* () { yield \u0026#39;Greetings!\u0026#39;; yield* delegatedIterator; yield \u0026#39;Ok, bye.\u0026#39;; }()); for(let value of delegatingIterator) { console.log(value); } // \u0026#34;Greetings! // \u0026#34;Hello!\u0026#34; // \u0026#34;Bye!\u0026#34; // \u0026#34;Ok, bye.\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼ŒdelegatingIterator æ˜¯ä»£ç†è€…ï¼ŒdelegatedIterator æ˜¯è¢«ä»£ç†è€…ã€‚ç”±äº yield* delegatedIterator è¯­å¥å¾—åˆ°çš„å€¼ï¼Œæ˜¯ä¸€ä¸ªéå†å™¨ï¼Œæ‰€ä»¥è¦ç”¨æ˜Ÿå·è¡¨ç¤ºã€‚è¿è¡Œç»“æœå°±æ˜¯ä½¿ç”¨ä¸€ä¸ªéå†å™¨ï¼Œéå†äº†å¤šä¸ª Generator å‡½æ•°ï¼Œæœ‰é€’å½’çš„æ•ˆæœã€‚\nyield* åé¢çš„ Generator å‡½æ•°ï¼ˆæ²¡æœ‰ return è¯­å¥æ—¶ï¼‰ï¼Œç­‰åŒäºåœ¨ Generator å‡½æ•°å†…éƒ¨ï¼Œéƒ¨ç½²ä¸€ä¸ª for-of å¾ªç¯ã€‚\nğŸ“ƒ Example\nfunction* concat(iter1, iter2) { yield* iter1; yield* iter2; } console.log([...concat([1,2],[3,4])]); // [1, 2, 3, 4] console.log([...concat([[1,2]],[[3,4]])]); // [[ 1, 2 ], [ 3, 4 ]] // ç­‰åŒäº function* concat2(iter1, iter2) { let value; for (value of iter1) { yield value; } for (value of iter2) { yield value; } } ä¸Šé¢ä»£ç è¯´æ˜ï¼Œ yield* åé¢çš„ Generator å‡½æ•°ï¼ˆæ²¡æœ‰ return è¯­å¥æ—¶ï¼‰ï¼Œä¸è¿‡æ˜¯ for-of çš„è¯­æ³•ç³–ï¼Œå®Œå…¨å¯ä»¥ç”¨åè€…æ›¿ä»£å‰è€…ã€‚åä¹‹ï¼Œåœ¨æœ‰ return è¯­å¥æ—¶ï¼Œåˆ™éœ€è¦ç”¨ let value = yield* iterator çš„å½¢å¼è·å– return è¯­å¥çš„å€¼ã€‚\nå¦‚æœ yield* åé¢è·Ÿç€ä¸€ä¸ªæ•°ç»„ï¼Œç”±äºæ•°ç»„åŸç”Ÿæ”¯æŒéå†å™¨ï¼Œå› æ­¤å°±ä¼šéå†æ•°ç»„æˆå‘˜ã€‚\nğŸ“ƒ Example\nfunction* gen() { yield* [\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;, \u0026#34;c\u0026#34;]; } ä¸Šé¢ä»£ç ä¸­ï¼Œ yield å‘½ä»¤åé¢å¦‚æœä¸åŠ æ˜Ÿå·ï¼Œè¿”å›çš„æ˜¯æ•´ä¸ªæ•°ç»„ï¼ŒåŠ äº†æ˜Ÿå·å°±è¡¨ç¤ºè¿”å›çš„æ˜¯æ•°ç»„çš„éå†å™¨å¯¹è±¡ã€‚\nå®é™…ä¸Šï¼Œä»»ä½•æ•°æ®ç»“æ„åªè¦æœ‰ Iterator æ¥å£ï¼Œå°±å¯ä»¥è¢« yield* éå†ã€‚\nğŸ“ƒ Example\nlet read = (function* () { yield \u0026#39;hello\u0026#39;; yield* \u0026#39;hello\u0026#39;; })(); console.log( read.next().value, // \u0026#34;hello\u0026#34; read.next().value, // \u0026#34;h\u0026#34; read.next().value, // \u0026#34;e\u0026#34; [...\u0026#39;hello\u0026#39;[Symbol.iterator]()] // [ \u0026#39;h\u0026#39;, \u0026#39;e\u0026#39;, \u0026#39;l\u0026#39;, \u0026#39;l\u0026#39;, \u0026#39;o\u0026#39; ] ); ä¸Šé¢ä»£ç ä¸­ï¼Œ yield è¡¨è¾¾å¼è¿”å›æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œ yield* è¯­å¥è¿”å›å•ä¸ªå­—ç¬¦ã€‚å› ä¸ºå­—ç¬¦ä¸²å…·æœ‰ Iterator æ¥å£ï¼Œæ‰€ä»¥è¢« yield* éå†ã€‚\nå¦‚æœè¢«ä»£ç†çš„ Generator å‡½æ•°æœ‰ return è¯­å¥ï¼Œé‚£ä¹ˆå°±å¯ä»¥å‘ä»£ç†å®ƒçš„ Generator å‡½æ•°è¿”å›æ•°æ®ã€‚\nğŸ“ƒ Example\nfunction* foo() { yield 2; yield 3; return \u0026#34;foo\u0026#34;; } function* bar() { yield 1; let v = yield* foo(); console.log(\u0026#34;v: \u0026#34; + v); yield 4; return v; } let it = bar(); console.log( it.next(), it.next(), it.next(), it.next(), it.next() ); // \u0026#34;v: foo\u0026#34; // {value: 1, done: false} // {value: 2, done: false} // {value: 3, done: false} // {value: 4, done: false} // {value: \u0026#39;foo\u0026#39;, done: true} ä¸Šé¢ä»£ç åœ¨ç¬¬å››æ¬¡è°ƒç”¨ next æ–¹æ³•çš„æ—¶å€™ï¼Œå±å¹•ä¸Šä¼šæœ‰è¾“å‡ºï¼Œè¿™æ˜¯å› ä¸ºå‡½æ•° foo çš„ return è¯­å¥ï¼Œå‘å‡½æ•° bar æä¾›äº†è¿”å›å€¼ã€‚\nå†çœ‹ä¸€ä¸ªä¾‹å­ã€‚\nğŸ“ƒ Example\nfunction* genFuncWithReturn() { yield \u0026#39;a\u0026#39;; yield \u0026#39;b\u0026#39;; return \u0026#39;The result\u0026#39;; } function* logReturned(genObj) { let result = yield* genObj; // è·å–yield*çš„è¿”å›å€¼ console.log(result); } console.log([...logReturned(genFuncWithReturn())]); // The result [ \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39; ] ä¸Šé¢ä»£ç ä¸­ï¼Œå­˜åœ¨ä¸¤æ¬¡éå†ã€‚ç¬¬ä¸€æ¬¡æ˜¯æ‰©å±•è¿ç®—ç¬¦éå†å‡½æ•° logReturned è¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œç¬¬äºŒæ¬¡æ˜¯ yield* è¯­å¥éå†å‡½æ•° genFuncWithReturn è¿”å›çš„éå†å™¨å¯¹è±¡ã€‚è¿™ä¸¤æ¬¡éå†çš„æ•ˆæœæ˜¯å åŠ çš„ï¼Œæœ€ç»ˆè¡¨ç°ä¸ºæ‰©å±•è¿ç®—ç¬¦éå†å‡½æ•° genFuncWithReturn è¿”å›çš„éå†å™¨å¯¹è±¡ã€‚æ‰€ä»¥ï¼Œæœ€åçš„æ•°æ®è¡¨è¾¾å¼å¾—åˆ°çš„å€¼ç­‰äº [ 'a', 'b' ]ã€‚ä½†æ˜¯ï¼Œå‡½æ•° genFuncWithReturn çš„ return è¯­å¥çš„è¿”å›å€¼The resultï¼Œä¼šè¿”å›ç»™å‡½æ•° logReturned å†…éƒ¨çš„ result å˜é‡ï¼Œå› æ­¤ä¼šæœ‰ç»ˆç«¯è¾“å‡ºã€‚\nyield* å‘½ä»¤å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å–å‡ºåµŒå¥—æ•°ç»„çš„æ‰€æœ‰æˆå‘˜ã€‚\nfunction* iterTree(tree) { if (Array.isArray(tree)) for (const item of tree) yield* iterTree(item); else yield tree; } const tree = [\u0026#39;a\u0026#39;, [\u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;], [\u0026#39;d\u0026#39;, \u0026#39;e\u0026#39;]]; for (let x of iterTree(tree)) { console.log(x); } // a b c d e ç”±äº æ‰©å±•è¿ç®—ç¬¦... é»˜è®¤è°ƒç”¨ Iterator æ¥å£ï¼Œæ‰€ä»¥ä¸Šé¢è¿™ä¸ªå‡½æ•°ä¹Ÿå¯ä»¥ç”¨äºåµŒå¥—æ•°ç»„çš„å¹³é“ºã€‚\n[...iterTree(tree)] // [a, b, c, d, e] ğŸ“ƒ Example\nä¸‹é¢æ˜¯ä¸€ä¸ªç¨å¾®å¤æ‚çš„ä¾‹å­ï¼Œä½¿ç”¨ yield* è¯­å¥éå†å®Œå…¨äºŒå‰æ ‘ã€‚\n// ä¸‹é¢æ˜¯äºŒå‰æ ‘çš„æ„é€ å‡½æ•°ï¼Œ // ä¸‰ä¸ªå‚æ•°åˆ†åˆ«æ˜¯å·¦æ ‘ã€å½“å‰èŠ‚ç‚¹å’Œå³æ ‘ class Tree { constructor(left, curr, right) { this.left = left; this.curr = curr; this.right = right; } } // ä¸‹é¢æ˜¯ä¸­åºï¼ˆinorderï¼‰éå†å‡½æ•°ã€‚ // ç”±äºè¿”å›çš„æ˜¯ä¸€ä¸ªéå†å™¨ï¼Œæ‰€ä»¥è¦ç”¨generatorå‡½æ•°ã€‚ // å‡½æ•°ä½“å†…é‡‡ç”¨é€’å½’ç®—æ³•ï¼Œæ‰€ä»¥å·¦æ ‘å’Œå³æ ‘è¦ç”¨yield*éå† function* inorder(t) { if (t) { yield* inorder(t.left); yield t.curr; yield* inorder(t.right); } } // ä¸‹é¢ç”ŸæˆäºŒå‰æ ‘ let make = array =\u0026gt; array.length === 1 ? // åˆ¤æ–­æ˜¯å¦ä¸ºå¶èŠ‚ç‚¹ new Tree(null, array[0], null) : new Tree( make(array[0]), array[1], make(array[2]) ); let tree = make( [[ [\u0026#39;a\u0026#39;], \u0026#39;b\u0026#39;, [\u0026#39;c\u0026#39;]], \u0026#39;d\u0026#39;, [[\u0026#39;e\u0026#39;], \u0026#39;f\u0026#39;, [\u0026#39;g\u0026#39;] ]]); // éå†äºŒå‰æ ‘ let result = []; console.log([...inorder(tree)]); // [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;, \u0026#39;e\u0026#39;, \u0026#39;f\u0026#39;, \u0026#39;g\u0026#39;] æ‚é¡¹ Generator ä½œä¸ºå¯¹è±¡å±æ€§, Generator å‡½æ•°çš„ this\nä½œä¸ºå¯¹è±¡å±æ€§çš„ Generator å‡½æ•° å¦‚æœä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ˜¯ Generator å‡½æ•°ï¼Œå¯ä»¥ç®€å†™æˆä¸‹é¢çš„å½¢å¼ã€‚\nğŸ“ƒ Example\nlet obj = { * myGeneratorMethod() { Â·Â·Â· } }; ä¸Šé¢ä»£ç ä¸­ï¼ŒmyGeneratorMethod å±æ€§å‰é¢æœ‰ä¸€ä¸ªæ˜Ÿå·ï¼Œè¡¨ç¤ºè¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ª Generator å‡½æ•°ã€‚\nå®ƒçš„å®Œæ•´å½¢å¼å¦‚ä¸‹ï¼Œä¸ä¸Šé¢çš„å†™æ³•æ˜¯ç­‰ä»·çš„ã€‚\nlet obj = { myGeneratorMethod: function* () { // Â·Â·Â· } }; Generator å‡½æ•°çš„ this Generator å‡½æ•°æ€»æ˜¯è¿”å›ä¸€ä¸ªéå†å™¨ï¼ŒES6 è§„å®šè¿™ä¸ªéå†å™¨æ˜¯ Generator å‡½æ•°çš„å®ä¾‹ï¼Œä¹Ÿç»§æ‰¿äº† Generator å‡½æ•°çš„ prototype å¯¹è±¡ä¸Šçš„æ–¹æ³•ã€‚\nğŸ“ƒ Example\nfunction* G() { } G.prototype.hello = function () { return \u0026#39;hi!\u0026#39;; }; let obj = G(); console.log( obj instanceof G, // true obj.hello() // \u0026#39;hi!\u0026#39; ); // true hi! ä¸Šé¢ä»£ç è¡¨æ˜ï¼ŒGenerator å‡½æ•° g è¿”å›çš„éå†å™¨ obj ï¼Œæ˜¯ g çš„å®ä¾‹ï¼Œè€Œä¸”ç»§æ‰¿äº†g.prototypeã€‚ä½†æ˜¯ï¼Œå¦‚æœæŠŠ g å½“ä½œæ™®é€šçš„æ„é€ å‡½æ•°ï¼Œå¹¶ä¸ä¼šç”Ÿæ•ˆï¼Œå› ä¸º g è¿”å›çš„æ€»æ˜¯éå†å™¨å¯¹è±¡ï¼Œè€Œä¸æ˜¯ this å¯¹è±¡ã€‚\nğŸ“ƒ Example\nfunction* g() { this.a = 11; } let obj = g(); console.log( obj.next(), obj.a // undefined ); ä¸Šé¢ä»£ç ä¸­ï¼ŒGenerator å‡½æ•° g åœ¨thiså¯¹è±¡ä¸Šé¢æ·»åŠ äº†ä¸€ä¸ªå±æ€§aï¼Œä½†æ˜¯objå¯¹è±¡æ‹¿ä¸åˆ°è¿™ä¸ªå±æ€§ã€‚\nGenerator å‡½æ•°ä¹Ÿä¸èƒ½è·Ÿ new å‘½ä»¤ä¸€èµ·ç”¨ï¼Œä¼šæŠ¥é”™ã€‚\nğŸ“ƒ Example\nfunction* F() { yield this.x = 2; yield this.y = 3; } new F() // TypeError: F is not a constructor ä¸Šé¢ä»£ç ä¸­ï¼Œnew å‘½ä»¤è·Ÿæ„é€ å‡½æ•° F ä¸€èµ·ä½¿ç”¨ï¼Œç»“æœæŠ¥é”™ï¼Œå› ä¸º F ä¸æ˜¯æ„é€ å‡½æ•°ã€‚\né‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰åŠæ³•è®© Generator å‡½æ•°è¿”å›ä¸€ä¸ªæ­£å¸¸çš„å¯¹è±¡å®ä¾‹ï¼Œæ—¢å¯ä»¥ç”¨ next æ–¹æ³•ï¼Œåˆå¯ä»¥è·å¾—æ­£å¸¸çš„thisï¼Ÿ\nä¸‹é¢æ˜¯ä¸€ä¸ªå˜é€šæ–¹æ³•ã€‚é¦–å…ˆï¼Œç”Ÿæˆä¸€ä¸ªç©ºå¯¹è±¡ï¼Œä½¿ç”¨callæ–¹æ³•ç»‘å®š Generator å‡½æ•°å†…éƒ¨çš„thisã€‚è¿™æ ·ï¼Œæ„é€ å‡½æ•°è°ƒç”¨ä»¥åï¼Œè¿™ä¸ªç©ºå¯¹è±¡å°±æ˜¯ Generator å‡½æ•°çš„å®ä¾‹å¯¹è±¡äº†ã€‚\nğŸ“ƒ Example\nfunction* F() { this.a = 1; yield this.b = 2; yield this.c = 3; } const obj = {}; const f = Reflect.apply(F, obj, []); console.log( f.next(), // Object {value: 2, done: false} f.next(), // Object {value: 3, done: false} f.next() // Object {value: undefined, done: true} ); console.log( obj.a, // 1 obj.b, // 2 obj.c // 3 ); ä¸Šé¢ä»£ç ä¸­ï¼Œé¦–å…ˆæ˜¯ F å†…éƒ¨çš„ this å¯¹è±¡ç»‘å®š obj å¯¹è±¡ï¼Œç„¶åè°ƒç”¨å®ƒï¼Œè¿”å›ä¸€ä¸ª Iterator å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡æ‰§è¡Œä¸‰æ¬¡ next æ–¹æ³•ï¼ˆå› ä¸º F å†…éƒ¨æœ‰ä¸¤ä¸ª yield è¡¨è¾¾å¼ï¼‰ï¼Œå®Œæˆ F å†…éƒ¨æ‰€æœ‰ä»£ç çš„è¿è¡Œã€‚è¿™æ—¶ï¼Œæ‰€æœ‰å†…éƒ¨å±æ€§éƒ½ç»‘å®šåœ¨ obj å¯¹è±¡ä¸Šäº†ï¼Œå› æ­¤ obj å¯¹è±¡ä¹Ÿå°±æˆäº† F çš„å®ä¾‹ã€‚\nä¸Šé¢ä»£ç ä¸­ï¼Œæ‰§è¡Œçš„æ˜¯éå†å™¨å¯¹è±¡ f ï¼Œä½†æ˜¯ç”Ÿæˆçš„å¯¹è±¡å®ä¾‹æ˜¯objï¼Œæœ‰æ²¡æœ‰åŠæ³•å°†è¿™ä¸¤ä¸ªå¯¹è±¡ç»Ÿä¸€å‘¢ï¼Ÿ\nä¸€ä¸ªåŠæ³•å°±æ˜¯å°† obj æ¢æˆ F.prototype ã€‚\nfunction* F() { this.a = 1; yield this.b = 2; yield this.c = 3; } let f = F.call(F.prototype); f.next(); // Object {value: 2, done: false} f.next(); // Object {value: 3, done: false} f.next(); // Object {value: undefined, done: true} f.a // 1 f.b // 2 f.c // 3 å†å°† F æ”¹æˆæ„é€ å‡½æ•°ï¼Œå°±å¯ä»¥å¯¹å®ƒæ‰§è¡Œ new å‘½ä»¤äº†ã€‚\nfunction* Gen() { this.a = 1; yield this.b = 2; yield this.c = 3; } let F = _ =\u0026gt; Gen.apply(Gen.prototype); const f = new F(); console.log( f.next(), // Object {value: 2, done: false} f.next(), // Object {value: 3, done: false} f.next() // Object {value: undefined, done: true} ); console.log( f.a, // 1 f.b, // 2 f.c // 3 ); å«ä¹‰ çŠ¶æ€æœº Generator æ˜¯å®ç°çŠ¶æ€æœºçš„æœ€ä½³ç»“æ„ã€‚æ¯”å¦‚ï¼Œä¸‹é¢çš„ clock å‡½æ•°å°±æ˜¯ä¸€ä¸ªçŠ¶æ€æœºã€‚\nğŸ“ƒ Example\nlet ticking = true; const clock = function () { if (ticking) console.log(\u0026#39;Tick!\u0026#39;); else console.log(\u0026#39;Tok!\u0026#39;); ticking = !ticking; }; ä¸Šé¢ä»£ç çš„ clock å‡½æ•°ä¸€å…±æœ‰ä¸¤ç§çŠ¶æ€ï¼ˆ Tick å’Œ Tok ï¼‰ï¼Œæ¯è¿è¡Œä¸€æ¬¡ï¼Œå°±æ”¹å˜ä¸€æ¬¡çŠ¶æ€ã€‚\nè¿™ä¸ªå‡½æ•°å¦‚æœç”¨ Generator å®ç°ï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·ã€‚\nğŸ“ƒ Example\nconst clock = (function* () { while (true) { console.log(\u0026#39;Tick!\u0026#39;); yield; console.log(\u0026#39;Tok!\u0026#39;); yield; } })(); setInterval(_ =\u0026gt; clock.next(), 500); ä¸Šé¢çš„ Generator å®ç°ä¸ ES5 å®ç°å¯¹æ¯”ï¼Œå¯ä»¥çœ‹åˆ°å°‘äº†ç”¨æ¥ä¿å­˜çŠ¶æ€çš„å¤–éƒ¨å˜é‡ ticking ï¼Œè¿™æ ·å°±æ›´ç®€æ´ï¼Œæ›´å®‰å…¨ï¼ˆçŠ¶æ€ä¸ä¼šè¢«éæ³•ç¯¡æ”¹ï¼‰ã€æ›´ç¬¦åˆå‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³ï¼Œåœ¨å†™æ³•ä¸Šä¹Ÿæ›´ä¼˜é›…ã€‚\nGenerator ä¹‹æ‰€ä»¥å¯ä»¥ä¸ç”¨å¤–éƒ¨å˜é‡ä¿å­˜çŠ¶æ€ï¼Œæ˜¯å› ä¸ºå®ƒæœ¬èº«å°±åŒ…å«äº†ä¸€ä¸ªçŠ¶æ€ä¿¡æ¯ï¼Œå³ç›®å‰æ˜¯å¦å¤„äºæš‚åœæ€ã€‚\nåç¨‹ åç¨‹coroutine æ˜¯ä¸€ç§ç¨‹åºè¿è¡Œçš„æ–¹å¼ï¼Œå¯ä»¥ç†è§£æˆâ€œåä½œçš„çº¿ç¨‹â€æˆ–â€œåä½œçš„å‡½æ•°â€ã€‚åç¨‹æ—¢å¯ä»¥ç”¨å•çº¿ç¨‹å®ç°ï¼Œä¹Ÿå¯ä»¥ç”¨å¤šçº¿ç¨‹å®ç°ã€‚å‰è€…æ˜¯ä¸€ç§ç‰¹æ®Šçš„å­ä¾‹ç¨‹ï¼Œåè€…æ˜¯ä¸€ç§ç‰¹æ®Šçš„çº¿ç¨‹ã€‚\nåç¨‹ä¸å­ä¾‹ç¨‹çš„å·®å¼‚\nä¼ ç»Ÿçš„â€œå­ä¾‹ç¨‹â€subroutine é‡‡ç”¨å †æ ˆå¼â€œåè¿›å…ˆå‡ºâ€çš„æ‰§è¡Œæ–¹å¼ï¼Œåªæœ‰å½“è°ƒç”¨çš„å­å‡½æ•°å®Œå…¨æ‰§è¡Œå®Œæ¯•ï¼Œæ‰ä¼šç»“æŸæ‰§è¡Œçˆ¶å‡½æ•°ã€‚åç¨‹ä¸å…¶ä¸åŒï¼Œå¤šä¸ªçº¿ç¨‹ï¼ˆå•çº¿ç¨‹æƒ…å†µä¸‹ï¼Œå³å¤šä¸ªå‡½æ•°ï¼‰å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œä½†æ˜¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼ˆæˆ–å‡½æ•°ï¼‰å¤„äºæ­£åœ¨è¿è¡Œçš„çŠ¶æ€ï¼Œå…¶ä»–çº¿ç¨‹ï¼ˆæˆ–å‡½æ•°ï¼‰éƒ½å¤„äº æš‚åœæ€suspended ï¼Œçº¿ç¨‹ï¼ˆæˆ–å‡½æ•°ï¼‰ä¹‹é—´å¯ä»¥äº¤æ¢æ‰§è¡Œæƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªçº¿ç¨‹ï¼ˆæˆ–å‡½æ•°ï¼‰æ‰§è¡Œåˆ°ä¸€åŠï¼Œå¯ä»¥æš‚åœæ‰§è¡Œï¼Œå°†æ‰§è¡Œæƒäº¤ç»™å¦ä¸€ä¸ªçº¿ç¨‹ï¼ˆæˆ–å‡½æ•°ï¼‰ï¼Œç­‰åˆ°ç¨åæ”¶å›æ‰§è¡Œæƒçš„æ—¶å€™ï¼Œå†æ¢å¤æ‰§è¡Œã€‚è¿™ç§å¯ä»¥å¹¶è¡Œæ‰§è¡Œã€äº¤æ¢æ‰§è¡Œæƒçš„çº¿ç¨‹ï¼ˆæˆ–å‡½æ•°ï¼‰ï¼Œå°±ç§°ä¸ºåç¨‹ã€‚\nä»å®ç°ä¸Šçœ‹ï¼Œåœ¨å†…å­˜ä¸­ï¼Œå­ä¾‹ç¨‹åªä½¿ç”¨ä¸€ä¸ª æ ˆstack ï¼Œè€Œåç¨‹æ˜¯åŒæ—¶å­˜åœ¨å¤šä¸ªæ ˆï¼Œä½†åªæœ‰ä¸€ä¸ªæ ˆæ˜¯åœ¨è¿è¡ŒçŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåç¨‹æ˜¯ä»¥å¤šå ç”¨å†…å­˜ä¸ºä»£ä»·ï¼Œå®ç°å¤šä»»åŠ¡çš„å¹¶è¡Œã€‚\nåç¨‹ä¸æ™®é€šçº¿ç¨‹çš„å·®å¼‚\nä¸éš¾çœ‹å‡ºï¼Œåç¨‹é€‚åˆç”¨äºå¤šä»»åŠ¡è¿è¡Œçš„ç¯å¢ƒã€‚åœ¨è¿™ä¸ªæ„ä¹‰ä¸Šï¼Œå®ƒä¸æ™®é€šçš„çº¿ç¨‹å¾ˆç›¸ä¼¼ï¼Œéƒ½æœ‰è‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€å¯ä»¥åˆ†äº«å…¨å±€å˜é‡ã€‚å®ƒä»¬çš„ä¸åŒä¹‹å¤„åœ¨äºï¼ŒåŒä¸€æ—¶é—´å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œä½†æ˜¯è¿è¡Œçš„åç¨‹åªèƒ½æœ‰ä¸€ä¸ªï¼Œå…¶ä»–åç¨‹éƒ½å¤„äºæš‚åœçŠ¶æ€ã€‚æ­¤å¤–ï¼Œæ™®é€šçš„çº¿ç¨‹æ˜¯æŠ¢å…ˆå¼çš„ï¼Œåˆ°åº•å“ªä¸ªçº¿ç¨‹ä¼˜å…ˆå¾—åˆ°èµ„æºï¼Œå¿…é¡»ç”±è¿è¡Œç¯å¢ƒå†³å®šï¼Œä½†æ˜¯åç¨‹æ˜¯åˆä½œå¼çš„ï¼Œæ‰§è¡Œæƒç”±åç¨‹è‡ªå·±åˆ†é…ã€‚\nç”±äº JavaScript æ˜¯å•çº¿ç¨‹è¯­è¨€ï¼Œåªèƒ½ä¿æŒä¸€ä¸ªè°ƒç”¨æ ˆã€‚å¼•å…¥åç¨‹ä»¥åï¼Œæ¯ä¸ªä»»åŠ¡å¯ä»¥ä¿æŒè‡ªå·±çš„è°ƒç”¨æ ˆã€‚è¿™æ ·åšçš„æœ€å¤§å¥½å¤„ï¼Œå°±æ˜¯æŠ›å‡ºé”™è¯¯çš„æ—¶å€™ï¼Œå¯ä»¥æ‰¾åˆ°åŸå§‹çš„è°ƒç”¨æ ˆã€‚ä¸è‡³äºåƒå¼‚æ­¥æ“ä½œçš„å›è°ƒå‡½æ•°é‚£æ ·ï¼Œä¸€æ—¦å‡ºé”™ï¼ŒåŸå§‹çš„è°ƒç”¨æ ˆæ—©å°±ç»“æŸã€‚\nGenerator å‡½æ•°æ˜¯ ES6 å¯¹åç¨‹çš„å®ç°ï¼Œä½†å±äºä¸å®Œå…¨å®ç°ã€‚Generator å‡½æ•°è¢«ç§°ä¸ºâ€œåŠåç¨‹â€semi-coroutineï¼Œæ„æ€æ˜¯åªæœ‰ Generator å‡½æ•°çš„è°ƒç”¨è€…ï¼Œæ‰èƒ½å°†ç¨‹åºçš„æ‰§è¡Œæƒè¿˜ç»™ Generator å‡½æ•°ã€‚å¦‚æœæ˜¯å®Œå…¨æ‰§è¡Œçš„åç¨‹ï¼Œä»»ä½•å‡½æ•°éƒ½å¯ä»¥è®©æš‚åœçš„åç¨‹ç»§ç»­æ‰§è¡Œã€‚\nå¦‚æœå°† Generator å‡½æ•°å½“ä½œåç¨‹ï¼Œå®Œå…¨å¯ä»¥å°†å¤šä¸ªéœ€è¦äº’ç›¸åä½œçš„ä»»åŠ¡å†™æˆ Generator å‡½æ•°ï¼Œå®ƒä»¬ä¹‹é—´ä½¿ç”¨ yield è¡¨è¾¾å¼äº¤æ¢æ§åˆ¶æƒã€‚\nä¸Šä¸‹æ–‡ JavaScript ä»£ç è¿è¡Œæ—¶ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªå…¨å±€çš„ä¸Šä¸‹æ–‡ç¯å¢ƒcontextï¼ˆåˆç§°è¿è¡Œç¯å¢ƒï¼‰ï¼ŒåŒ…å«äº†å½“å‰æ‰€æœ‰çš„å˜é‡å’Œå¯¹è±¡ã€‚ç„¶åï¼Œæ‰§è¡Œå‡½æ•°ï¼ˆæˆ–å—çº§ä»£ç ï¼‰çš„æ—¶å€™ï¼Œåˆä¼šåœ¨å½“å‰ä¸Šä¸‹æ–‡ç¯å¢ƒçš„ä¸Šå±‚ï¼Œäº§ç”Ÿä¸€ä¸ªå‡½æ•°è¿è¡Œçš„ä¸Šä¸‹æ–‡ï¼Œå˜æˆå½“å‰active çš„ä¸Šä¸‹æ–‡ï¼Œç”±æ­¤å½¢æˆä¸€ä¸ªä¸Šä¸‹æ–‡ç¯å¢ƒçš„å †æ ˆcontext stackã€‚\nè¿™ä¸ªå †æ ˆæ˜¯ åè¿›å…ˆå‡ºFIFO çš„æ•°æ®ç»“æ„ï¼Œæœ€åäº§ç”Ÿçš„ä¸Šä¸‹æ–‡ç¯å¢ƒé¦–å…ˆæ‰§è¡Œå®Œæˆï¼Œé€€å‡ºå †æ ˆï¼Œç„¶åå†æ‰§è¡Œå®Œæˆå®ƒä¸‹å±‚çš„ä¸Šä¸‹æ–‡ï¼Œç›´è‡³æ‰€æœ‰ä»£ç æ‰§è¡Œå®Œæˆï¼Œå †æ ˆæ¸…ç©ºã€‚\nGenerator å‡½æ•°ä¸æ˜¯è¿™æ ·ï¼Œå®ƒæ‰§è¡Œäº§ç”Ÿçš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œä¸€æ—¦é‡åˆ° yield å‘½ä»¤ï¼Œå°±ä¼šæš‚æ—¶é€€å‡ºå †æ ˆï¼Œä½†æ˜¯å¹¶ä¸æ¶ˆå¤±ï¼Œé‡Œé¢çš„æ‰€æœ‰å˜é‡å’Œå¯¹è±¡ä¼šå†»ç»“åœ¨å½“å‰çŠ¶æ€ã€‚ç­‰åˆ°å¯¹å®ƒæ‰§è¡Œ next å‘½ä»¤æ—¶ï¼Œè¿™ä¸ªä¸Šä¸‹æ–‡ç¯å¢ƒåˆä¼šé‡æ–°åŠ å…¥è°ƒç”¨æ ˆï¼Œå†»ç»“çš„å˜é‡å’Œå¯¹è±¡æ¢å¤æ‰§è¡Œã€‚\nğŸ“ƒ Example\nfunction* gen() { yield 1; return 2; } let g = gen(); console.log( g.next().value, g.next().value ); ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œ g.next() æ—¶ï¼ŒGenerator å‡½æ•° gen çš„ä¸Šä¸‹æ–‡ä¼šåŠ å…¥å †æ ˆï¼Œå³å¼€å§‹è¿è¡Œ gen å†…éƒ¨çš„ä»£ç ã€‚ç­‰é‡åˆ° yield 1 æ—¶ï¼Œ gen ä¸Šä¸‹æ–‡é€€å‡ºå †æ ˆï¼Œå†…éƒ¨çŠ¶æ€å†»ç»“ã€‚ç¬¬äºŒæ¬¡æ‰§è¡Œ g.next() æ—¶ï¼Œ gen ä¸Šä¸‹æ–‡é‡æ–°åŠ å…¥å †æ ˆï¼Œå˜æˆå½“å‰çš„ä¸Šä¸‹æ–‡ï¼Œé‡æ–°æ¢å¤æ‰§è¡Œã€‚\nåº”ç”¨ Generator å¯ä»¥æš‚åœå‡½æ•°æ‰§è¡Œï¼Œè¿”å›ä»»æ„è¡¨è¾¾å¼çš„å€¼ã€‚è¿™ç§ç‰¹ç‚¹ä½¿å¾— Generator æœ‰å¤šç§åº”ç”¨åœºæ™¯ã€‚\nåŒæ­¥åŒ–è¡¨è¾¾ Generator å‡½æ•°çš„æš‚åœæ‰§è¡Œçš„æ•ˆæœï¼Œæ„å‘³ç€å¯ä»¥æŠŠå¼‚æ­¥æ“ä½œå†™åœ¨ yield è¡¨è¾¾å¼é‡Œé¢ï¼Œç­‰åˆ°è°ƒç”¨ next æ–¹æ³•æ—¶å†å¾€åæ‰§è¡Œã€‚è¿™å®é™…ä¸Šç­‰åŒäºä¸éœ€è¦å†™å›è°ƒå‡½æ•°äº†ï¼Œå› ä¸ºå¼‚æ­¥æ“ä½œçš„åç»­æ“ä½œå¯ä»¥æ”¾åœ¨ yield è¡¨è¾¾å¼ä¸‹é¢ï¼Œåæ­£è¦ç­‰åˆ°è°ƒç”¨ next æ–¹æ³•æ—¶å†æ‰§è¡Œã€‚æ‰€ä»¥ï¼ŒGenerator å‡½æ•°çš„ä¸€ä¸ªé‡è¦å®é™…æ„ä¹‰å°±æ˜¯ç”¨æ¥å¤„ç†å¼‚æ­¥æ“ä½œï¼Œæ”¹å†™å›è°ƒå‡½æ•°ã€‚\nğŸ“ƒ Example\nfunction* loadUI() { showLoadingScreen(); yield loadUIDataAsynchronously(); hideLoadingScreen(); } let loader = loadUI(); // åŠ è½½UI loader.next() // å¸è½½UI loader.next() ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨loadUIå‡½æ•°æ—¶ï¼Œè¯¥å‡½æ•°ä¸ä¼šæ‰§è¡Œï¼Œä»…è¿”å›ä¸€ä¸ªéå†å™¨ã€‚ä¸‹ä¸€æ¬¡å¯¹è¯¥éå†å™¨è°ƒç”¨ next æ–¹æ³•ï¼Œåˆ™ä¼šæ˜¾ç¤ºLoadingç•Œé¢ï¼ˆshowLoadingScreenï¼‰ï¼Œå¹¶ä¸” å¼‚æ­¥ åŠ è½½æ•°æ®ï¼ˆloadUIDataAsynchronouslyï¼‰ã€‚ç­‰åˆ°æ•°æ®åŠ è½½å®Œæˆï¼Œå†ä¸€æ¬¡ä½¿ç”¨ next æ–¹æ³•ï¼Œåˆ™ä¼šéšè— Loading ç•Œé¢ã€‚å¯ä»¥çœ‹åˆ°ï¼Œè¿™ç§å†™æ³•çš„å¥½å¤„æ˜¯æ‰€æœ‰ Loading ç•Œé¢çš„é€»è¾‘ï¼Œéƒ½è¢«å°è£…åœ¨ä¸€ä¸ªå‡½æ•°ï¼ŒæŒ‰éƒ¨å°±ç­éå¸¸æ¸…æ™°ã€‚\nAjax æ˜¯å…¸å‹çš„å¼‚æ­¥æ“ä½œï¼Œé€šè¿‡ Generator å‡½æ•°éƒ¨ç½² Ajax æ“ä½œï¼Œå¯ä»¥ç”¨åŒæ­¥çš„æ–¹å¼è¡¨è¾¾ã€‚\nğŸ“ƒ Example\nfunction* main() { let result = yield request(\u0026#34;http://some.url\u0026#34;); let resp = JSON.parse(result); console.log(resp.value); } function request(url) { makeAjaxCall(url, function (response) { it.next(response); }); } let it = main(); it.next(); ä¸Šé¢ä»£ç çš„ main å‡½æ•°ï¼Œå°±æ˜¯é€šè¿‡ Ajax æ“ä½œè·å–æ•°æ®ã€‚å¯ä»¥çœ‹åˆ°ï¼Œé™¤äº†å¤šäº†ä¸€ä¸ª yield ï¼Œå®ƒå‡ ä¹ä¸åŒæ­¥æ“ä½œçš„å†™æ³•å®Œå…¨ä¸€æ ·ã€‚æ³¨æ„ï¼ŒmakeAjaxCall å‡½æ•°ä¸­çš„ next æ–¹æ³•ï¼Œå¿…é¡»åŠ ä¸Š response å‚æ•°ï¼Œå› ä¸º yield è¡¨è¾¾å¼ï¼Œæœ¬èº«æ˜¯æ²¡æœ‰å€¼çš„ï¼Œæ€»æ˜¯ç­‰äº undefined ã€‚\nä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ï¼Œé€šè¿‡ Generator å‡½æ•°é€è¡Œè¯»å–æ–‡æœ¬æ–‡ä»¶ã€‚\nğŸ“ƒ Example\nfunction* numbers() { let file = new FileReader(\u0026#34;numbers.txt\u0026#34;); try { while(!file.eof) { yield parseInt(file.readLine(), 10); } } finally { file.close(); } } ä¸Šé¢ä»£ç æ‰“å¼€æ–‡æœ¬æ–‡ä»¶ï¼Œä½¿ç”¨ yield è¡¨è¾¾å¼å¯ä»¥æ‰‹åŠ¨é€è¡Œè¯»å–æ–‡ä»¶ã€‚\næ§åˆ¶æµ å¦‚æœæœ‰ä¸€ä¸ªå¤šæ­¥æ“ä½œéå¸¸è€—æ—¶ï¼Œé‡‡ç”¨å›è°ƒå‡½æ•°ï¼Œå¯èƒ½ä¼šå†™æˆä¸‹é¢è¿™æ ·ã€‚\nstep1(function (value1) { step2(value1, function(value2) { step3(value2, function(value3) { step4(value3, function(value4) { // Do something with value4 }); }); }); }); é‡‡ç”¨ Promise æ”¹å†™ä¸Šé¢çš„ä»£ç ã€‚\nğŸ“ƒ Example\nPromise.resolve(step1) .then(step2) .then(step3) .then(step4) .then(function (value4) { // Do something with value4 }, function (error) { // Handle any error from step1 through step4 }) .done(); ä¸Šé¢ä»£ç å·²ç»æŠŠå›è°ƒå‡½æ•°ï¼Œæ”¹æˆäº†ç›´çº¿æ‰§è¡Œçš„å½¢å¼ï¼Œä½†æ˜¯åŠ å…¥äº†å¤§é‡ Promise çš„è¯­æ³•ã€‚Generator å‡½æ•°å¯ä»¥è¿›ä¸€æ­¥æ”¹å–„ä»£ç è¿è¡Œæµç¨‹ã€‚\nfunction* longRunningTask(value1) { try { let value2 = yield step1(value1); let value3 = yield step2(value2); let value4 = yield step3(value3); let value5 = yield step4(value4); // Do something with value4 } catch (e) { // Handle any error from step1 through step4 } } ç„¶åï¼Œä½¿ç”¨ä¸€ä¸ªå‡½æ•°ï¼ŒæŒ‰æ¬¡åºè‡ªåŠ¨æ‰§è¡Œæ‰€æœ‰æ­¥éª¤ã€‚\nscheduler(longRunningTask(initialValue)); function scheduler(task) { let taskObj = task.next(task.value); // å¦‚æœGeneratorå‡½æ•°æœªç»“æŸï¼Œå°±ç»§ç»­è°ƒç”¨ if (!taskObj.done) { task.value = taskObj.value scheduler(task); } } æ³¨æ„ï¼Œä¸Šé¢è¿™ç§åšæ³•ï¼Œåªé€‚åˆåŒæ­¥æ“ä½œï¼Œå³æ‰€æœ‰çš„taskéƒ½å¿…é¡»æ˜¯åŒæ­¥çš„ï¼Œä¸èƒ½æœ‰å¼‚æ­¥æ“ä½œã€‚å› ä¸ºè¿™é‡Œçš„ä»£ç ä¸€å¾—åˆ°è¿”å›å€¼ï¼Œå°±ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œæ²¡æœ‰åˆ¤æ–­å¼‚æ­¥æ“ä½œä½•æ—¶å®Œæˆã€‚å¦‚æœè¦æ§åˆ¶å¼‚æ­¥çš„æ“ä½œæµç¨‹ï¼Œè¯¦è§åé¢çš„ã€Šå¼‚æ­¥æ“ä½œã€‹ä¸€ç« ã€‚\nä¸‹é¢ï¼Œåˆ©ç”¨ for-of å¾ªç¯ä¼šè‡ªåŠ¨ä¾æ¬¡æ‰§è¡Œ yield å‘½ä»¤çš„ç‰¹æ€§ï¼Œæä¾›ä¸€ç§æ›´ä¸€èˆ¬çš„æ§åˆ¶æµç®¡ç†çš„æ–¹æ³•ã€‚\nğŸ“ƒ Example\nlet steps = [step1Func, step2Func, step3Func]; function* iterateSteps(steps) { for (let i = 0; i \u0026lt; steps.length; i++) { let step = steps[i]; yield step(); } } ä¸Šé¢ä»£ç ä¸­ï¼Œæ•°ç»„ steps å°è£…äº†ä¸€ä¸ªä»»åŠ¡çš„å¤šä¸ªæ­¥éª¤ï¼ŒGenerator å‡½æ•° iterateSteps åˆ™æ˜¯ä¾æ¬¡ä¸ºè¿™äº›æ­¥éª¤åŠ ä¸Š yield å‘½ä»¤ã€‚\nå°†ä»»åŠ¡åˆ†è§£æˆæ­¥éª¤ä¹‹åï¼Œè¿˜å¯ä»¥å°†é¡¹ç›®åˆ†è§£æˆå¤šä¸ªä¾æ¬¡æ‰§è¡Œçš„ä»»åŠ¡ã€‚\nğŸ“ƒ Example\nlet jobs = [job1, job2, job3]; function* iterateJobs(jobs){ for (let i=0; i\u0026lt; jobs.length; i++){ let job = jobs[i]; yield* iterateSteps(job.steps); } } ä¸Šé¢ä»£ç ä¸­ï¼Œæ•°ç»„ jobs å°è£…äº†ä¸€ä¸ªé¡¹ç›®çš„å¤šä¸ªä»»åŠ¡ï¼ŒGenerator å‡½æ•° iterateJobs åˆ™æ˜¯ä¾æ¬¡ä¸ºè¿™äº›ä»»åŠ¡åŠ ä¸Š yield* å‘½ä»¤ã€‚\næœ€åï¼Œå°±å¯ä»¥ç”¨ for-of å¾ªç¯ä¸€æ¬¡æ€§ä¾æ¬¡æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡çš„æ‰€æœ‰æ­¥éª¤ã€‚\nfor (let step of iterateJobs(jobs)){ console.log(step.id); } å†æ¬¡æé†’ï¼Œä¸Šé¢çš„åšæ³•åªèƒ½ç”¨äºæ‰€æœ‰æ­¥éª¤éƒ½æ˜¯åŒæ­¥æ“ä½œçš„æƒ…å†µï¼Œä¸èƒ½æœ‰å¼‚æ­¥æ“ä½œçš„æ­¥éª¤ã€‚å¦‚æœæƒ³è¦ä¾æ¬¡æ‰§è¡Œå¼‚æ­¥çš„æ­¥éª¤ï¼Œå¿…é¡»ä½¿ç”¨åé¢çš„ã€Šå¼‚æ­¥æ“ä½œã€‹ä¸€ç« ä»‹ç»çš„æ–¹æ³•ã€‚\nfor-of çš„æœ¬è´¨æ˜¯ä¸€ä¸ª while å¾ªç¯ï¼Œæ‰€ä»¥ä¸Šé¢çš„ä»£ç å®è´¨ä¸Šæ‰§è¡Œçš„æ˜¯ä¸‹é¢çš„é€»è¾‘ã€‚\nlet it = iterateJobs(jobs); let res = it.next(); while (!res.done){ let result = res.value; // ... res = it.next(); } Iterator åˆ©ç”¨ Generator å‡½æ•°ï¼Œå¯ä»¥åœ¨ä»»æ„å¯¹è±¡ä¸Šéƒ¨ç½² Iterator æ¥å£ã€‚\nğŸ“ƒ Example\nfunction* iterEntries(obj) { let keys = Object.keys(obj); for (let i=0; i \u0026lt; keys.length; i++) { let key = keys[i]; yield [key, obj[key]]; } } let myObj = { foo: 3, bar: 7 }; for (let [key, value] of iterEntries(myObj)) { console.log(key, value); } // foo 3 bar 7 ä¸Šè¿°ä»£ç ä¸­ï¼ŒmyObj æ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼Œé€šè¿‡ iterEntries å‡½æ•°ï¼Œå°±æœ‰äº† Iterator æ¥å£ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥åœ¨ä»»æ„å¯¹è±¡ä¸Šéƒ¨ç½² next æ–¹æ³•ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªå¯¹æ•°ç»„éƒ¨ç½² Iterator æ¥å£çš„ä¾‹å­ï¼Œå°½ç®¡æ•°ç»„åŸç”Ÿå…·æœ‰è¿™ä¸ªæ¥å£ã€‚\nğŸ“ƒ Example\nfunction* makeSimpleGenerator(array){ let nextIndex = 0; while(nextIndex \u0026lt; array.length){ yield array[nextIndex++]; } } let gen = makeSimpleGenerator([\u0026#39;yo\u0026#39;, \u0026#39;ya\u0026#39;]); gen.next().value // \u0026#39;yo\u0026#39; gen.next().value // \u0026#39;ya\u0026#39; gen.next().done // true æ•°æ®ç»“æ„ Generator å¯ä»¥çœ‹ä½œæ˜¯æ•°æ®ç»“æ„ï¼Œæ›´ç¡®åˆ‡åœ°è¯´ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæ•°ç»„ç»“æ„ï¼Œå› ä¸º Generator å‡½æ•°å¯ä»¥è¿”å›ä¸€ç³»åˆ—çš„å€¼ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥å¯¹ä»»æ„è¡¨è¾¾å¼ï¼Œæä¾›ç±»ä¼¼æ•°ç»„çš„æ¥å£ã€‚\nğŸ“ƒ Example\nfunction* doStuff() { yield fs.readFile.bind(null, \u0026#39;hello.txt\u0026#39;); yield fs.readFile.bind(null, \u0026#39;world.txt\u0026#39;); yield fs.readFile.bind(null, \u0026#39;and-such.txt\u0026#39;); } ä¸Šé¢ä»£ç å°±æ˜¯ä¾æ¬¡è¿”å›ä¸‰ä¸ªå‡½æ•°ï¼Œä½†æ˜¯ç”±äºä½¿ç”¨äº† Generator å‡½æ•°ï¼Œå¯¼è‡´å¯ä»¥åƒå¤„ç†æ•°ç»„é‚£æ ·ï¼Œå¤„ç†è¿™ä¸‰ä¸ªè¿”å›çš„å‡½æ•°ã€‚\nfor (task of doStuff()) { // taskæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥åƒå›è°ƒå‡½æ•°é‚£æ ·ä½¿ç”¨å®ƒ } å®é™…ä¸Šï¼Œå¦‚æœç”¨ ES5 è¡¨è¾¾ï¼Œå®Œå…¨å¯ä»¥ç”¨æ•°ç»„æ¨¡æ‹Ÿ Generator çš„è¿™ç§ç”¨æ³•ã€‚\nğŸ“ƒ Example\nfunction doStuff() { return [ fs.readFile.bind(null, \u0026#39;hello.txt\u0026#39;), fs.readFile.bind(null, \u0026#39;world.txt\u0026#39;), fs.readFile.bind(null, \u0026#39;and-such.txt\u0026#39;) ]; } ä¸Šé¢çš„å‡½æ•°ï¼Œå¯ä»¥ç”¨ä¸€æ¨¡ä¸€æ ·çš„ for-of å¾ªç¯å¤„ç†ï¼ä¸¤ç›¸ä¸€æ¯”è¾ƒï¼Œå°±ä¸éš¾çœ‹å‡º Generator ä½¿å¾—æ•°æ®æˆ–è€…æ“ä½œï¼Œå…·å¤‡äº†ç±»ä¼¼æ•°ç»„çš„æ¥å£ã€‚\nå¼‚æ­¥ å¼‚æ­¥ç¼–ç¨‹å¯¹ JavaScript è¯­è¨€å¤ªé‡è¦ã€‚JavaScript è¯­è¨€çš„æ‰§è¡Œç¯å¢ƒæ˜¯â€œå•çº¿ç¨‹â€çš„ï¼Œå¦‚æœæ²¡æœ‰å¼‚æ­¥ç¼–ç¨‹ï¼Œæ ¹æœ¬æ²¡æ³•ç”¨ï¼Œéå¡æ­»ä¸å¯ã€‚æœ¬ç« ä¸»è¦ä»‹ç» Generator å‡½æ•°å¦‚ä½•å®Œæˆå¼‚æ­¥æ“ä½œã€‚\nä¼ ç»Ÿæ–¹æ³• ES6 è¯ç”Ÿä»¥å‰ï¼Œå¼‚æ­¥ç¼–ç¨‹çš„æ–¹æ³•ï¼Œå¤§æ¦‚æœ‰ä¸‹é¢å››ç§ã€‚\nå›è°ƒå‡½æ•° äº‹ä»¶ç›‘å¬ å‘å¸ƒ/è®¢é˜… Promise å¯¹è±¡ Generator å‡½æ•°å°† JavaScript å¼‚æ­¥ç¼–ç¨‹å¸¦å…¥äº†ä¸€ä¸ªå…¨æ–°çš„é˜¶æ®µã€‚\nåŸºæœ¬æ¦‚å¿µ å¼‚æ­¥ æ‰€è°“\u0026quot;å¼‚æ­¥\u0026quot;ï¼Œç®€å•è¯´å°±æ˜¯ä¸€ä¸ªä»»åŠ¡ä¸æ˜¯è¿ç»­å®Œæˆçš„ï¼Œå¯ä»¥ç†è§£æˆè¯¥ä»»åŠ¡è¢«äººä¸ºåˆ†æˆä¸¤æ®µï¼Œå…ˆæ‰§è¡Œç¬¬ä¸€æ®µï¼Œç„¶åè½¬è€Œæ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œç­‰åšå¥½äº†å‡†å¤‡ï¼Œå†å›è¿‡å¤´æ‰§è¡Œç¬¬äºŒæ®µã€‚\næ¯”å¦‚ï¼Œæœ‰ä¸€ä¸ªä»»åŠ¡æ˜¯è¯»å–æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œä»»åŠ¡çš„ç¬¬ä¸€æ®µæ˜¯å‘æ“ä½œç³»ç»Ÿå‘å‡ºè¯·æ±‚ï¼Œè¦æ±‚è¯»å–æ–‡ä»¶ã€‚ç„¶åï¼Œç¨‹åºæ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œç­‰åˆ°æ“ä½œç³»ç»Ÿè¿”å›æ–‡ä»¶ï¼Œå†æ¥ç€æ‰§è¡Œä»»åŠ¡çš„ç¬¬äºŒæ®µï¼ˆå¤„ç†æ–‡ä»¶ï¼‰ã€‚è¿™ç§ä¸è¿ç»­çš„æ‰§è¡Œï¼Œå°±å«åšå¼‚æ­¥ã€‚\nç›¸åº”åœ°ï¼Œè¿ç»­çš„æ‰§è¡Œå°±å«åšåŒæ­¥ã€‚ç”±äºæ˜¯è¿ç»­æ‰§è¡Œï¼Œä¸èƒ½æ’å…¥å…¶ä»–ä»»åŠ¡ï¼Œæ‰€ä»¥æ“ä½œç³»ç»Ÿä»ç¡¬ç›˜è¯»å–æ–‡ä»¶çš„è¿™æ®µæ—¶é—´ï¼Œç¨‹åºåªèƒ½å¹²ç­‰ç€ã€‚\nå›è°ƒå‡½æ•° JavaScript è¯­è¨€å¯¹å¼‚æ­¥ç¼–ç¨‹çš„å®ç°ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°ã€‚æ‰€è°“å›è°ƒå‡½æ•°ï¼Œå°±æ˜¯æŠŠä»»åŠ¡çš„ç¬¬äºŒæ®µå•ç‹¬å†™åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œç­‰åˆ°é‡æ–°æ‰§è¡Œè¿™ä¸ªä»»åŠ¡çš„æ—¶å€™ï¼Œå°±ç›´æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚å›è°ƒå‡½æ•°çš„è‹±è¯­åå­— callback ï¼Œç›´è¯‘è¿‡æ¥å°±æ˜¯\u0026quot;é‡æ–°è°ƒç”¨\u0026quot;ã€‚\nè¯»å–æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œæ˜¯è¿™æ ·å†™çš„ã€‚\nğŸ“ƒ Example\nfs.readFile(\u0026#39;/etc/passwd\u0026#39;, \u0026#39;utf-8\u0026#39;, function (err, data) { if (err) throw err; console.log(data); }); ä¸Šé¢ä»£ç ä¸­ï¼ŒreadFileå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä»»åŠ¡çš„ç¬¬äºŒæ®µã€‚ç­‰åˆ°æ“ä½œç³»ç»Ÿè¿”å›äº†/etc/passwdè¿™ä¸ªæ–‡ä»¶ä»¥åï¼Œå›è°ƒå‡½æ•°æ‰ä¼šæ‰§è¡Œã€‚\nä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜æ˜¯ï¼Œä¸ºä»€ä¹ˆ Node çº¦å®šï¼Œå›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¿…é¡»æ˜¯é”™è¯¯å¯¹è±¡errï¼ˆå¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œè¯¥å‚æ•°å°±æ˜¯nullï¼‰ï¼Ÿ\nåŸå› æ˜¯æ‰§è¡Œåˆ†æˆä¸¤æ®µï¼Œç¬¬ä¸€æ®µæ‰§è¡Œå®Œä»¥åï¼Œä»»åŠ¡æ‰€åœ¨çš„ä¸Šä¸‹æ–‡ç¯å¢ƒå°±å·²ç»ç»“æŸäº†ã€‚åœ¨è¿™ä»¥åæŠ›å‡ºçš„é”™è¯¯ï¼ŒåŸæ¥çš„ä¸Šä¸‹æ–‡ç¯å¢ƒå·²ç»æ— æ³•æ•æ‰ï¼Œåªèƒ½å½“ä½œå‚æ•°ï¼Œä¼ å…¥ç¬¬äºŒæ®µã€‚\nPromise å›è°ƒå‡½æ•°æœ¬èº«å¹¶æ²¡æœ‰é—®é¢˜ï¼Œå®ƒçš„é—®é¢˜å‡ºç°åœ¨å¤šä¸ªå›è°ƒå‡½æ•°åµŒå¥—ã€‚\nğŸ“ƒ Example\nå‡å®šè¯»å–Aæ–‡ä»¶ä¹‹åï¼Œå†è¯»å–Bæ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ã€‚\nfs.readFile(fileA, \u0026#39;utf-8\u0026#39;, function (err, data) { fs.readFile(fileB, \u0026#39;utf-8\u0026#39;, function (err, data) { // ... }); }); ä¸éš¾æƒ³è±¡ï¼Œå¦‚æœä¾æ¬¡è¯»å–ä¸¤ä¸ªä»¥ä¸Šçš„æ–‡ä»¶ï¼Œå°±ä¼šå‡ºç°å¤šé‡åµŒå¥—ã€‚ä»£ç ä¸æ˜¯çºµå‘å‘å±•ï¼Œè€Œæ˜¯æ¨ªå‘å‘å±•ï¼Œå¾ˆå¿«å°±ä¼šä¹±æˆä¸€å›¢ï¼Œæ— æ³•ç®¡ç†ã€‚å› ä¸ºå¤šä¸ªå¼‚æ­¥æ“ä½œå½¢æˆäº†å¼ºè€¦åˆï¼Œåªè¦æœ‰ä¸€ä¸ªæ“ä½œéœ€è¦ä¿®æ”¹ï¼Œå®ƒçš„ä¸Šå±‚å›è°ƒå‡½æ•°å’Œä¸‹å±‚å›è°ƒå‡½æ•°ï¼Œå¯èƒ½éƒ½è¦è·Ÿç€ä¿®æ”¹ã€‚è¿™ç§æƒ…å†µå°±ç§°ä¸º å›è°ƒå‡½æ•°åœ°ç‹±callback hell ã€‚\nPromise å¯¹è±¡å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œæå‡ºçš„ã€‚å®ƒä¸æ˜¯æ–°çš„è¯­æ³•åŠŸèƒ½ï¼Œè€Œæ˜¯ä¸€ç§æ–°çš„å†™æ³•ï¼Œå…è®¸å°†å›è°ƒå‡½æ•°çš„åµŒå¥—ï¼Œæ”¹æˆé“¾å¼è°ƒç”¨ã€‚\nğŸ“ƒ Example\né‡‡ç”¨ Promiseï¼Œè¿ç»­è¯»å–å¤šä¸ªæ–‡ä»¶ï¼Œå†™æ³•å¦‚ä¸‹ã€‚\nlet readFile = require(\u0026#39;fs-readfile-promise\u0026#39;); readFile(fileA) .then(function (data) { console.log(data.toString()); }) .then(function () { return readFile(fileB); }) .then(function (data) { console.log(data.toString()); }) .catch(function (err) { console.log(err); }); ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä½¿ç”¨äº† fs-readfile-promise æ¨¡å—ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯è¿”å›ä¸€ä¸ª Promise ç‰ˆæœ¬çš„ readFile å‡½æ•°ã€‚Promise æä¾› then æ–¹æ³•åŠ è½½å›è°ƒå‡½æ•°ï¼Œ catch æ–¹æ³•æ•æ‰æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºçš„é”™è¯¯ã€‚\nå¯ä»¥çœ‹åˆ°ï¼ŒPromise çš„å†™æ³•åªæ˜¯å›è°ƒå‡½æ•°çš„æ”¹è¿›ï¼Œä½¿ç”¨ then æ–¹æ³•ä»¥åï¼Œå¼‚æ­¥ä»»åŠ¡çš„ä¸¤æ®µæ‰§è¡Œçœ‹å¾—æ›´æ¸…æ¥šäº†ï¼Œé™¤æ­¤ä»¥å¤–ï¼Œå¹¶æ— æ–°æ„ã€‚\nPromise çš„æœ€å¤§é—®é¢˜æ˜¯ä»£ç å†—ä½™ï¼ŒåŸæ¥çš„ä»»åŠ¡è¢« Promise åŒ…è£…äº†ä¸€ä¸‹ï¼Œä¸ç®¡ä»€ä¹ˆæ“ä½œï¼Œä¸€çœ¼çœ‹å»éƒ½æ˜¯ä¸€å † then ï¼ŒåŸæ¥çš„è¯­ä¹‰å˜å¾—å¾ˆä¸æ¸…æ¥šã€‚\né‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰æ›´å¥½çš„å†™æ³•å‘¢ï¼Ÿ\nGenerator å‡½æ•° åç¨‹ ä¼ ç»Ÿçš„ç¼–ç¨‹è¯­è¨€ï¼Œæ—©æœ‰å¼‚æ­¥ç¼–ç¨‹çš„è§£å†³æ–¹æ¡ˆï¼ˆå…¶å®æ˜¯å¤šä»»åŠ¡çš„è§£å†³æ–¹æ¡ˆï¼‰ã€‚å…¶ä¸­æœ‰ä¸€ç§å«åš åç¨‹coroutineï¼Œæ„æ€æ˜¯å¤šä¸ªçº¿ç¨‹äº’ç›¸åä½œï¼Œå®Œæˆå¼‚æ­¥ä»»åŠ¡ã€‚\nåç¨‹æœ‰ç‚¹åƒå‡½æ•°ï¼Œåˆæœ‰ç‚¹åƒçº¿ç¨‹ã€‚å®ƒçš„è¿è¡Œæµç¨‹å¤§è‡´å¦‚ä¸‹ã€‚\nç¬¬ä¸€æ­¥ï¼Œåç¨‹ A å¼€å§‹æ‰§è¡Œã€‚ ç¬¬äºŒæ­¥ï¼Œåç¨‹ A æ‰§è¡Œåˆ°ä¸€åŠï¼Œè¿›å…¥æš‚åœï¼Œæ‰§è¡Œæƒè½¬ç§»åˆ°åç¨‹Bã€‚ ç¬¬ä¸‰æ­¥ï¼Œï¼ˆä¸€æ®µæ—¶é—´åï¼‰åç¨‹ B äº¤è¿˜æ‰§è¡Œæƒã€‚ ç¬¬å››æ­¥ï¼Œåç¨‹ A æ¢å¤æ‰§è¡Œã€‚ ä¸Šé¢æµç¨‹çš„åç¨‹ A ï¼Œå°±æ˜¯å¼‚æ­¥ä»»åŠ¡ï¼Œå› ä¸ºå®ƒåˆ†æˆä¸¤æ®µï¼ˆæˆ–å¤šæ®µï¼‰æ‰§è¡Œã€‚\nä¸¾ä¾‹æ¥è¯´ï¼Œè¯»å–æ–‡ä»¶çš„åç¨‹å†™æ³•å¦‚ä¸‹ã€‚\nğŸ“ƒ Example\nfunction* asyncJob() { // ...å…¶ä»–ä»£ç  let f = yield readFile(fileA); // ...å…¶ä»–ä»£ç  } ä¸Šé¢ä»£ç çš„å‡½æ•° asyncJob æ˜¯ä¸€ä¸ªåç¨‹ï¼Œå®ƒçš„å¥¥å¦™å°±åœ¨å…¶ä¸­çš„ yield å‘½ä»¤ã€‚å®ƒè¡¨ç¤ºæ‰§è¡Œåˆ°æ­¤å¤„ï¼Œæ‰§è¡Œæƒå°†äº¤ç»™å…¶ä»–åç¨‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œyield å‘½ä»¤æ˜¯å¼‚æ­¥ä¸¤ä¸ªé˜¶æ®µçš„åˆ†ç•Œçº¿ã€‚\nåç¨‹é‡åˆ° yield å‘½ä»¤å°±æš‚åœï¼Œç­‰åˆ°æ‰§è¡Œæƒè¿”å›ï¼Œå†ä»æš‚åœçš„åœ°æ–¹ç»§ç»­å¾€åæ‰§è¡Œã€‚å®ƒçš„æœ€å¤§ä¼˜ç‚¹ï¼Œå°±æ˜¯ä»£ç çš„å†™æ³•éå¸¸åƒåŒæ­¥æ“ä½œï¼Œå¦‚æœå»é™¤ yield å‘½ä»¤ï¼Œç®€ç›´ä¸€æ¨¡ä¸€æ ·ã€‚\nå®ç° Generator å‡½æ•°æ˜¯åç¨‹åœ¨ ES6 çš„å®ç°ï¼Œæœ€å¤§ç‰¹ç‚¹å°±æ˜¯å¯ä»¥äº¤å‡ºå‡½æ•°çš„ æ‰§è¡Œæƒï¼ˆå³æš‚åœæ‰§è¡Œï¼‰ã€‚\næ•´ä¸ª Generator å‡½æ•°å°±æ˜¯ä¸€ä¸ªå°è£…çš„å¼‚æ­¥ä»»åŠ¡ï¼Œæˆ–è€…è¯´æ˜¯å¼‚æ­¥ä»»åŠ¡çš„å®¹å™¨ã€‚å¼‚æ­¥æ“ä½œéœ€è¦æš‚åœçš„åœ°æ–¹ï¼Œéƒ½ç”¨ yield è¯­å¥æ³¨æ˜ã€‚Generator å‡½æ•°çš„æ‰§è¡Œæ–¹æ³•å¦‚ä¸‹ã€‚\nğŸ“ƒ Example\nfunction* gen(x) { let y = yield x + 2; return y; } let g = gen(1); g.next() // { value: 3, done: false } g.next() // { value: undefined, done: true } ä¸Šé¢ä»£ç ä¸­ï¼Œè°ƒç”¨ Generator å‡½æ•°ï¼Œä¼šè¿”å›ä¸€ä¸ªå†…éƒ¨æŒ‡é’ˆï¼ˆå³éå†å™¨ï¼‰gã€‚\nè¿™æ˜¯ Generator å‡½æ•°ä¸åŒäºæ™®é€šå‡½æ•°çš„å¦ä¸€ä¸ªåœ°æ–¹ï¼Œå³æ‰§è¡Œå®ƒä¸ä¼šè¿”å›ç»“æœï¼Œè¿”å›çš„æ˜¯æŒ‡é’ˆå¯¹è±¡ã€‚è°ƒç”¨æŒ‡é’ˆ g çš„ next æ–¹æ³•ï¼Œä¼šç§»åŠ¨å†…éƒ¨æŒ‡é’ˆï¼ˆå³æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡çš„ç¬¬ä¸€æ®µï¼‰ï¼ŒæŒ‡å‘ç¬¬ä¸€ä¸ªé‡åˆ°çš„ yield è¯­å¥ï¼Œä¸Šä¾‹æ˜¯æ‰§è¡Œåˆ° x + 2 ä¸ºæ­¢ã€‚\næ¢è¨€ä¹‹ï¼Œnext æ–¹æ³•çš„ä½œç”¨æ˜¯åˆ†é˜¶æ®µæ‰§è¡Œ Generator å‡½æ•°ã€‚æ¯æ¬¡è°ƒç”¨ next æ–¹æ³•ï¼Œä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¡¨ç¤ºå½“å‰é˜¶æ®µçš„ä¿¡æ¯ï¼ˆ value å±æ€§å’Œdoneå±æ€§ï¼‰ã€‚value å±æ€§æ˜¯ yield è¯­å¥åé¢è¡¨è¾¾å¼çš„å€¼ï¼Œè¡¨ç¤ºå½“å‰é˜¶æ®µçš„å€¼ï¼›done å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤º Generator å‡½æ•°æ˜¯å¦æ‰§è¡Œå®Œæ¯•ï¼Œå³æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªé˜¶æ®µã€‚\nGenerator å‡½æ•°çš„æ•°æ®äº¤æ¢å’Œé”™è¯¯å¤„ç† Generator å‡½æ•°å¯ä»¥æš‚åœæ‰§è¡Œå’Œæ¢å¤æ‰§è¡Œï¼Œè¿™æ˜¯å®ƒèƒ½å°è£…å¼‚æ­¥ä»»åŠ¡çš„æ ¹æœ¬åŸå› ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒè¿˜æœ‰ä¸¤ä¸ªç‰¹æ€§ï¼Œä½¿å®ƒå¯ä»¥ä½œä¸ºå¼‚æ­¥ç¼–ç¨‹çš„å®Œæ•´è§£å†³æ–¹æ¡ˆï¼šå‡½æ•°ä½“å†…å¤–çš„æ•°æ®äº¤æ¢å’Œé”™è¯¯å¤„ç†æœºåˆ¶ã€‚\nnext è¿”å›å€¼çš„ value å±æ€§ï¼Œæ˜¯ Generator å‡½æ•°å‘å¤–è¾“å‡ºæ•°æ®ï¼›nextæ–¹æ³•è¿˜å¯ä»¥æ¥å—å‚æ•°ï¼Œå‘ Generator å‡½æ•°ä½“å†…è¾“å…¥æ•°æ®ã€‚\nğŸ“ƒ Example\nfunction* gen(x) { let y = yield x + 2; return y; } let g = gen(1); console.log( g.next(), // { value: 3, done: false } g.next(2), // { value: 2, done: true } ); ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬ä¸€ä¸ª next æ–¹æ³•çš„ value å±æ€§ï¼Œè¿”å›è¡¨è¾¾å¼ x + 2 çš„å€¼ 3 ã€‚ç¬¬äºŒä¸ª next æ–¹æ³•å¸¦æœ‰å‚æ•° 2 ï¼Œè¿™ä¸ªå‚æ•°å¯ä»¥ä¼ å…¥ Generator å‡½æ•°ï¼Œä½œä¸ºä¸Šä¸ªé˜¶æ®µå¼‚æ­¥ä»»åŠ¡çš„è¿”å›ç»“æœï¼Œè¢«å‡½æ•°ä½“å†…çš„å˜é‡ y æ¥æ”¶ã€‚å› æ­¤ï¼Œè¿™ä¸€æ­¥çš„ value å±æ€§ï¼Œè¿”å›çš„å°±æ˜¯ 2ï¼ˆå˜é‡ y çš„å€¼ï¼‰ã€‚\nGenerator å‡½æ•°å†…éƒ¨è¿˜å¯ä»¥éƒ¨ç½²é”™è¯¯å¤„ç†ä»£ç ï¼Œæ•è·å‡½æ•°ä½“å¤–æŠ›å‡ºçš„é”™è¯¯ã€‚\nğŸ“ƒ Example\nfunction* gen(x){ try { let y = yield x + 2; } catch (e){ console.log(e); } return y; } let g = gen(1); g.next(); g.throw(\u0026#39;å‡ºé”™äº†\u0026#39;); // å‡ºé”™äº† ä¸Šé¢ä»£ç çš„æœ€åä¸€è¡Œï¼ŒGenerator å‡½æ•°ä½“å¤–ï¼Œä½¿ç”¨æŒ‡é’ˆå¯¹è±¡çš„ throw æ–¹æ³•æŠ›å‡ºçš„é”™è¯¯ï¼Œå¯ä»¥è¢«å‡½æ•°ä½“å†…çš„ try\u0026hellip;catch ä»£ç å—æ•è·ã€‚\nè¿™æ„å‘³ç€ï¼Œå‡ºé”™çš„ä»£ç ä¸å¤„ç†é”™è¯¯çš„ä»£ç ï¼Œå®ç°äº†æ—¶é—´å’Œç©ºé—´ä¸Šçš„åˆ†ç¦»ï¼Œè¿™å¯¹äºå¼‚æ­¥ç¼–ç¨‹æ— ç–‘æ˜¯å¾ˆé‡è¦çš„ã€‚\nå¼‚æ­¥ä»»åŠ¡çš„å°è£… ä¸‹é¢çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ Generator å‡½æ•°ï¼Œæ‰§è¡Œä¸€ä¸ªçœŸå®çš„å¼‚æ­¥ä»»åŠ¡ã€‚\nğŸ“ƒ Example\nlet fetch = require(\u0026#39;node-fetch\u0026#39;); function* gen(){ let url = \u0026#39;https://api.github.com/users/github\u0026#39;; let result = yield fetch(url); console.log(result.bio); } ä¸Šé¢ä»£ç ä¸­ï¼ŒGenerator å‡½æ•°å°è£…äº†ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œè¯¥æ“ä½œå…ˆè¯»å–ä¸€ä¸ªè¿œç¨‹æ¥å£ï¼Œç„¶åä» JSON æ ¼å¼çš„æ•°æ®è§£æä¿¡æ¯ã€‚å°±åƒå‰é¢è¯´è¿‡çš„ï¼Œè¿™æ®µä»£ç éå¸¸åƒåŒæ­¥æ“ä½œï¼Œé™¤äº†åŠ ä¸Šäº† yield å‘½ä»¤ã€‚\næ‰§è¡Œè¿™æ®µä»£ç çš„æ–¹æ³•å¦‚ä¸‹ã€‚\nğŸ“ƒ Example\nlet g = gen(); let result = g.next(); result.value.then(function(data){ return data.json(); }).then(function(data){ g.next(data); }); ä¸Šé¢ä»£ç ä¸­ï¼Œé¦–å…ˆæ‰§è¡Œ Generator å‡½æ•°ï¼Œè·å–éå†å™¨å¯¹è±¡ï¼Œç„¶åä½¿ç”¨ next æ–¹æ³•ï¼ˆç¬¬äºŒè¡Œï¼‰ï¼Œæ‰§è¡Œå¼‚æ­¥ä»»åŠ¡çš„ç¬¬ä¸€é˜¶æ®µã€‚ç”±äº Fetch æ¨¡å—è¿”å›çš„æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå› æ­¤è¦ç”¨ then æ–¹æ³•è°ƒç”¨ä¸‹ä¸€ä¸ª next æ–¹æ³•ã€‚\nå¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶ Generator å‡½æ•°å°†å¼‚æ­¥æ“ä½œè¡¨ç¤ºå¾—å¾ˆç®€æ´ï¼Œä½†æ˜¯æµç¨‹ç®¡ç†å´ä¸æ–¹ä¾¿ï¼ˆå³ä½•æ—¶æ‰§è¡Œç¬¬ä¸€é˜¶æ®µã€ä½•æ—¶æ‰§è¡Œç¬¬äºŒé˜¶æ®µï¼‰ã€‚\nThunk å‡½æ•° Thunk å‡½æ•°æ˜¯è‡ªåŠ¨æ‰§è¡Œ Generator å‡½æ•°çš„ä¸€ç§æ–¹æ³•ã€‚\næ±‚å€¼ç­–ç•¥ Thunk å‡½æ•°æ—©åœ¨ä¸Šä¸ªä¸–çºª 60 å¹´ä»£å°±è¯ç”Ÿäº†ã€‚\né‚£æ—¶ï¼Œç¼–ç¨‹è¯­è¨€åˆšåˆšèµ·æ­¥ï¼Œè®¡ç®—æœºå­¦å®¶è¿˜åœ¨ç ”ç©¶ï¼Œç¼–è¯‘å™¨æ€ä¹ˆå†™æ¯”è¾ƒå¥½ã€‚ä¸€ä¸ªäº‰è®ºçš„ç„¦ç‚¹æ˜¯\u0026quot;æ±‚å€¼ç­–ç•¥\u0026quot;ï¼Œå³å‡½æ•°çš„å‚æ•°åˆ°åº•åº”è¯¥ä½•æ—¶æ±‚å€¼ã€‚\nğŸ“ƒ Example\nlet x = 1; function f(m) { return m * 2; } f(x + 5) ä¸Šé¢ä»£ç å…ˆå®šä¹‰å‡½æ•° f ï¼Œç„¶åå‘å®ƒä¼ å…¥è¡¨è¾¾å¼ x + 5 ã€‚\nè¯·é—®ï¼Œè¿™ä¸ªè¡¨è¾¾å¼åº”è¯¥ä½•æ—¶æ±‚å€¼ï¼Ÿ\nä¸€ç§æ„è§æ˜¯ ä¼ å€¼è°ƒç”¨call by valueï¼Œå³åœ¨è¿›å…¥å‡½æ•°ä½“ä¹‹å‰ï¼Œå°±è®¡ç®— x + 5 çš„å€¼ï¼ˆç­‰äº 6ï¼‰ï¼Œå†å°†è¿™ä¸ªå€¼ä¼ å…¥å‡½æ•°fã€‚C è¯­è¨€å°±é‡‡ç”¨è¿™ç§ç­–ç•¥ã€‚\nf(x + 5) // ä¼ å€¼è°ƒç”¨æ—¶ï¼Œç­‰åŒäº f(6) å¦ä¸€ç§æ„è§æ˜¯ ä¼ åè°ƒç”¨call by nameï¼Œå³ç›´æ¥å°†è¡¨è¾¾å¼ x + 5 ä¼ å…¥å‡½æ•°ä½“ï¼Œåªåœ¨ç”¨åˆ°å®ƒçš„æ—¶å€™æ±‚å€¼ã€‚Haskell è¯­è¨€é‡‡ç”¨è¿™ç§ç­–ç•¥ã€‚\nf(x + 5) // ä¼ åè°ƒç”¨æ—¶ï¼Œç­‰åŒäº (x + 5) * 2 ä¼ å€¼è°ƒç”¨å’Œä¼ åè°ƒç”¨ï¼Œå“ªä¸€ç§æ¯”è¾ƒå¥½ï¼Ÿ\nå›ç­”æ˜¯å„æœ‰åˆ©å¼Šã€‚ä¼ å€¼è°ƒç”¨æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯å¯¹å‚æ•°æ±‚å€¼çš„æ—¶å€™ï¼Œå®é™…ä¸Šè¿˜æ²¡ç”¨åˆ°è¿™ä¸ªå‚æ•°ï¼Œæœ‰å¯èƒ½é€ æˆæ€§èƒ½æŸå¤±ã€‚\nğŸ“ƒ Example\nfunction f(a, b){ return b; } f(3 * x * x - 2 * x - 1, x); ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•° f çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¤æ‚çš„è¡¨è¾¾å¼ï¼Œä½†æ˜¯å‡½æ•°ä½“å†…æ ¹æœ¬æ²¡ç”¨åˆ°ã€‚å¯¹è¿™ä¸ªå‚æ•°æ±‚å€¼ï¼Œå®é™…ä¸Šæ˜¯ä¸å¿…è¦çš„ã€‚å› æ­¤ï¼Œæœ‰ä¸€äº›è®¡ç®—æœºå­¦å®¶å€¾å‘äºä¼ åè°ƒç”¨ï¼Œå³åªåœ¨æ‰§è¡Œæ—¶æ±‚å€¼ã€‚\nå«ä¹‰ ç¼–è¯‘å™¨çš„â€œä¼ åè°ƒç”¨â€å®ç°ï¼Œå¾€å¾€æ˜¯å°†å‚æ•°æ”¾åˆ°ä¸€ä¸ªä¸´æ—¶å‡½æ•°ä¹‹ä¸­ï¼Œå†å°†è¿™ä¸ªä¸´æ—¶å‡½æ•°ä¼ å…¥å‡½æ•°ä½“ã€‚è¿™ä¸ªä¸´æ—¶å‡½æ•°å°±å«åš Thunk å‡½æ•°ã€‚\nğŸ“ƒ Example\nfunction f(m) { return m * 2; } f(x + 5); // ç­‰åŒäº let Thunk = function () { return x + 5; }; function f(thunk) { return thunk() * 2; } ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•° f çš„å‚æ•° x + 5 è¢«ä¸€ä¸ªå‡½æ•°æ›¿æ¢äº†ã€‚å‡¡æ˜¯ç”¨åˆ°åŸå‚æ•°çš„åœ°æ–¹ï¼Œå¯¹ Thunk å‡½æ•°æ±‚å€¼å³å¯ã€‚\nè¿™å°±æ˜¯ Thunk å‡½æ•°çš„å®šä¹‰ï¼Œå®ƒæ˜¯â€œä¼ åè°ƒç”¨â€çš„ä¸€ç§å®ç°ç­–ç•¥ï¼Œç”¨æ¥æ›¿æ¢æŸä¸ªè¡¨è¾¾å¼ã€‚\nJS-Thunk JavaScript è¯­è¨€æ˜¯ä¼ å€¼è°ƒç”¨ï¼Œå®ƒçš„ Thunk å‡½æ•°å«ä¹‰æœ‰æ‰€ä¸åŒã€‚åœ¨ JavaScript è¯­è¨€ä¸­ï¼ŒThunk å‡½æ•°æ›¿æ¢çš„ä¸æ˜¯è¡¨è¾¾å¼ï¼Œè€Œæ˜¯å¤šå‚æ•°å‡½æ•°ï¼Œå°†å…¶æ›¿æ¢æˆä¸€ä¸ªåªæ¥å—å›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°çš„å•å‚æ•°å‡½æ•°ã€‚\nğŸ“ƒ Example\n// æ­£å¸¸ç‰ˆæœ¬çš„readFileï¼ˆå¤šå‚æ•°ç‰ˆæœ¬ï¼‰ fs.readFile(fileName, callback); // Thunkç‰ˆæœ¬çš„readFileï¼ˆå•å‚æ•°ç‰ˆæœ¬ï¼‰ let Thunk = function (fileName) { return function (callback) { return fs.readFile(fileName, callback); }; }; let readFileThunk = Thunk(fileName); readFileThunk(callback); ä¸Šé¢ä»£ç ä¸­ï¼Œfs æ¨¡å—çš„ readFile æ–¹æ³•æ˜¯ä¸€ä¸ªå¤šå‚æ•°å‡½æ•°ï¼Œä¸¤ä¸ªå‚æ•°åˆ†åˆ«ä¸ºæ–‡ä»¶åå’Œå›è°ƒå‡½æ•°ã€‚ç»è¿‡è½¬æ¢å™¨å¤„ç†ï¼Œå®ƒå˜æˆäº†ä¸€ä¸ªå•å‚æ•°å‡½æ•°ï¼Œåªæ¥å—å›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªå•å‚æ•°ç‰ˆæœ¬ï¼Œå°±å«åš Thunk å‡½æ•°ã€‚\nä»»ä½•å‡½æ•°ï¼Œåªè¦å‚æ•°æœ‰ å›è°ƒå‡½æ•° ï¼Œå°±èƒ½å†™æˆ Thunk å‡½æ•°çš„å½¢å¼ã€‚\nğŸ“ƒ Example\nä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ Thunk å‡½æ•°è½¬æ¢å™¨ã€‚\n// ES5ç‰ˆæœ¬ let Thunk = function(fn){ return function (){ let args = Array.prototype.slice.call(arguments); // ç›¸å½“äºæ•°ç»„æµ…æ‹·è´ return function (callback){ args.push(callback); return fn.apply(this, args); } }; }; // ES6ç‰ˆæœ¬ const Thunk = function(fn) { return function (...args) { return function (callback) { return fn.call(this, ...args, callback); } }; }; ä½¿ç”¨ä¸Šé¢çš„è½¬æ¢å™¨ï¼Œç”Ÿæˆ fs.readFile çš„ Thunk å‡½æ•°ã€‚\nlet readFileThunk = Thunk(fs.readFile); readFileThunk(fileA)(callback); ğŸ“ƒ Example\nä¸‹é¢æ˜¯å¦ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­ã€‚\nfunction f(a, cb) { cb(a); } const ft = Thunk(f); ft(1)(console.log) // 1 Thunkify ç”Ÿäº§ç¯å¢ƒçš„è½¬æ¢å™¨ï¼Œå»ºè®®ä½¿ç”¨ Thunkify æ¨¡å—ã€‚\né¦–å…ˆæ˜¯å®‰è£…ã€‚\n$ npm install thunkify ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ã€‚\nlet thunkify = require(\u0026#39;thunkify\u0026#39;); let fs = require(\u0026#39;fs\u0026#39;); let read = thunkify(fs.readFile); read(\u0026#39;package.json\u0026#39;)(function(err, str){ // ... }); Thunkify çš„æºç ä¸ä¸Šä¸€èŠ‚é‚£ä¸ªç®€å•çš„è½¬æ¢å™¨éå¸¸åƒã€‚\nfunction thunkify(fn) { return function() { let args = new Array(arguments.length); let ctx = this; for (let i = 0; i \u0026lt; args.length; ++i) { args[i] = arguments[i]; } return function (done) { let called; args.push(function () { if (called) return; called = true; done.apply(null, arguments); }); try { fn.apply(ctx, args); } catch (err) { done(err); } } } }; å®ƒçš„æºç ä¸»è¦å¤šäº†ä¸€ä¸ªæ£€æŸ¥æœºåˆ¶ï¼Œå˜é‡ called ç¡®ä¿å›è°ƒå‡½æ•°åªè¿è¡Œä¸€æ¬¡ã€‚è¿™æ ·çš„è®¾è®¡ä¸ä¸‹æ–‡çš„ Generator å‡½æ•°ç›¸å…³ã€‚è¯·çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚\nğŸ“ƒ Example\nfunction f(a, b, callback){ let sum = a + b; callback(sum); callback(sum); } let ft = thunkify(f); let print = console.log.bind(console); ft(1, 2)(print); // 3 ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äºthunkifyåªå…è®¸å›è°ƒå‡½æ•°æ‰§è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥åªè¾“å‡ºä¸€è¡Œç»“æœã€‚\næµç¨‹ç®¡ç† ä½ å¯èƒ½ä¼šé—®ï¼Œ Thunk å‡½æ•°æœ‰ä»€ä¹ˆç”¨ï¼Ÿå›ç­”æ˜¯ä»¥å‰ç¡®å®æ²¡ä»€ä¹ˆç”¨ï¼Œä½†æ˜¯ ES6 æœ‰äº† Generator å‡½æ•°ï¼ŒThunk å‡½æ•°ç°åœ¨å¯ä»¥ç”¨äº Generator å‡½æ•°çš„è‡ªåŠ¨æµç¨‹ç®¡ç†ã€‚\nGenerator å‡½æ•°å¯ä»¥è‡ªåŠ¨æ‰§è¡Œã€‚\nğŸ“ƒ Example\nfunction* gen() { // ... } let g = gen(); let res = g.next(); while(!res.done){ console.log(res.value); res = g.next(); } ä¸Šé¢ä»£ç ä¸­ï¼ŒGenerator å‡½æ•°genä¼šè‡ªåŠ¨æ‰§è¡Œå®Œæ‰€æœ‰æ­¥éª¤ã€‚\nä½†æ˜¯ï¼Œè¿™ä¸é€‚åˆå¼‚æ­¥æ“ä½œã€‚å¦‚æœå¿…é¡»ä¿è¯å‰ä¸€æ­¥æ‰§è¡Œå®Œï¼Œæ‰èƒ½æ‰§è¡Œåä¸€æ­¥ï¼Œä¸Šé¢çš„è‡ªåŠ¨æ‰§è¡Œå°±ä¸å¯è¡Œã€‚è¿™æ—¶ï¼ŒThunk å‡½æ•°å°±èƒ½æ´¾ä¸Šç”¨å¤„ã€‚ä»¥è¯»å–æ–‡ä»¶ä¸ºä¾‹ã€‚ä¸‹é¢çš„ Generator å‡½æ•°å°è£…äº†ä¸¤ä¸ªå¼‚æ­¥æ“ä½œã€‚\nğŸ“ƒ Example\nlet fs = require(\u0026#39;fs\u0026#39;); let thunkify = require(\u0026#39;thunkify\u0026#39;); let readFileThunk = thunkify(fs.readFile); let gen = function* (){ let r1 = yield readFileThunk(\u0026#39;/etc/fstab\u0026#39;); console.log(r1.toString()); let r2 = yield readFileThunk(\u0026#39;/etc/shells\u0026#39;); console.log(r2.toString()); }; ä¸Šé¢ä»£ç ä¸­ï¼Œyieldå‘½ä»¤ç”¨äºå°†ç¨‹åºçš„æ‰§è¡Œæƒç§»å‡º Generator å‡½æ•°ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸€ç§æ–¹æ³•ï¼Œå°†æ‰§è¡Œæƒå†äº¤è¿˜ç»™ Generator å‡½æ•°ã€‚\nè¿™ç§æ–¹æ³•å°±æ˜¯ Thunk å‡½æ•°ï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨å›è°ƒå‡½æ•°é‡Œï¼Œå°†æ‰§è¡Œæƒäº¤è¿˜ç»™ Generator å‡½æ•°ã€‚ä¸ºäº†ä¾¿äºç†è§£ï¼Œæˆ‘ä»¬å…ˆçœ‹å¦‚ä½•æ‰‹åŠ¨æ‰§è¡Œä¸Šé¢è¿™ä¸ª Generator å‡½æ•°ã€‚\nğŸ“ƒ Example\nlet g = gen(); let r1 = g.next(); r1.value(function (err, data) { if (err) throw err; let r2 = g.next(data); r2.value(function (err, data) { if (err) throw err; g.next(data); }); }); ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡gæ˜¯ Generator å‡½æ•°çš„å†…éƒ¨æŒ‡é’ˆï¼Œè¡¨ç¤ºç›®å‰æ‰§è¡Œåˆ°å“ªä¸€æ­¥ã€‚nextæ–¹æ³•è´Ÿè´£å°†æŒ‡é’ˆç§»åŠ¨åˆ°ä¸‹ä¸€æ­¥ï¼Œå¹¶è¿”å›è¯¥æ­¥çš„ä¿¡æ¯ï¼ˆvalueå±æ€§å’Œdoneå±æ€§ï¼‰ã€‚\nä»”ç»†æŸ¥çœ‹ä¸Šé¢çš„ä»£ç ï¼Œå¯ä»¥å‘ç° Generator å‡½æ•°çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œå…¶å®æ˜¯å°†åŒä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œåå¤ä¼ å…¥nextæ–¹æ³•çš„valueå±æ€§ã€‚è¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥ç”¨é€’å½’æ¥è‡ªåŠ¨å®Œæˆè¿™ä¸ªè¿‡ç¨‹ã€‚\nThunk å‡½æ•°çš„è‡ªåŠ¨æµç¨‹ç®¡ç† Thunk å‡½æ•°çœŸæ­£çš„å¨åŠ›ï¼Œåœ¨äºå¯ä»¥è‡ªåŠ¨æ‰§è¡Œ Generator å‡½æ•°ã€‚ä¸‹é¢å°±æ˜¯ä¸€ä¸ªåŸºäº Thunk å‡½æ•°çš„ Generator æ‰§è¡Œå™¨ã€‚\nğŸ“ƒ Example\nfunction run(fn) { let gen = fn(); function next(err, data) { let result = gen.next(data); if (result.done) return; result.value(next); } next(); } function* g() { // ... } run(g); ä¸Šé¢ä»£ç çš„ run å‡½æ•°ï¼Œå°±æ˜¯ä¸€ä¸ª Generator å‡½æ•°çš„è‡ªåŠ¨æ‰§è¡Œå™¨ã€‚å†…éƒ¨çš„ next å‡½æ•°å°±æ˜¯ Thunk çš„å›è°ƒå‡½æ•°ã€‚next å‡½æ•°å…ˆå°†æŒ‡é’ˆç§»åˆ° Generator å‡½æ•°çš„ä¸‹ä¸€æ­¥ï¼ˆ gen.next æ–¹æ³•ï¼‰ï¼Œç„¶ååˆ¤æ–­ Generator å‡½æ•°æ˜¯å¦ç»“æŸï¼ˆ result.done å±æ€§ï¼‰ï¼Œå¦‚æœæ²¡ç»“æŸï¼Œå°±å°† next å‡½æ•°å†ä¼ å…¥ Thunk å‡½æ•°ï¼ˆ result.value å±æ€§ï¼‰ï¼Œå¦åˆ™å°±ç›´æ¥é€€å‡ºã€‚\næœ‰äº†è¿™ä¸ªæ‰§è¡Œå™¨ï¼Œæ‰§è¡Œ Generator å‡½æ•°æ–¹ä¾¿å¤šäº†ã€‚ä¸ç®¡å†…éƒ¨æœ‰å¤šå°‘ä¸ªå¼‚æ­¥æ“ä½œï¼Œç›´æ¥æŠŠ Generator å‡½æ•°ä¼ å…¥run å‡½æ•°å³å¯ã€‚å½“ç„¶ï¼Œå‰ææ˜¯æ¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œéƒ½è¦æ˜¯ Thunk å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè·Ÿåœ¨ yield å‘½ä»¤åé¢çš„å¿…é¡»æ˜¯ Thunk å‡½æ•°ã€‚\nğŸ“ƒ Example\nlet g = function* (){ let f1 = yield readFileThunk(\u0026#39;fileA\u0026#39;); let f2 = yield readFileThunk(\u0026#39;fileB\u0026#39;); // ... let fn = yield readFileThunk(\u0026#39;fileN\u0026#39;); }; run(g); ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•° g å°è£…äº† n ä¸ªå¼‚æ­¥çš„è¯»å–æ–‡ä»¶æ“ä½œï¼Œåªè¦æ‰§è¡Œrunå‡½æ•°ï¼Œè¿™äº›æ“ä½œå°±ä¼šè‡ªåŠ¨å®Œæˆã€‚è¿™æ ·ä¸€æ¥ï¼Œå¼‚æ­¥æ“ä½œä¸ä»…å¯ä»¥å†™å¾—åƒåŒæ­¥æ“ä½œï¼Œè€Œä¸”ä¸€è¡Œä»£ç å°±å¯ä»¥æ‰§è¡Œã€‚\nThunk å‡½æ•°å¹¶ä¸æ˜¯ Generator å‡½æ•°è‡ªåŠ¨æ‰§è¡Œçš„å”¯ä¸€æ–¹æ¡ˆã€‚å› ä¸ºè‡ªåŠ¨æ‰§è¡Œçš„å…³é”®æ˜¯ï¼Œå¿…é¡»æœ‰ä¸€ç§æœºåˆ¶ï¼Œè‡ªåŠ¨æ§åˆ¶ Generator å‡½æ•°çš„æµç¨‹ï¼Œæ¥æ”¶å’Œäº¤è¿˜ç¨‹åºçš„æ‰§è¡Œæƒã€‚å›è°ƒå‡½æ•°å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼ŒPromise å¯¹è±¡ä¹Ÿå¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚\nco æ¨¡å— åŸºæœ¬ç”¨æ³• co æ¨¡å—æ˜¯è‘—åç¨‹åºå‘˜ TJ Holowaychuk äº 2013 å¹´ 6 æœˆå‘å¸ƒçš„ä¸€ä¸ªå°å·¥å…·ï¼Œç”¨äº Generator å‡½æ•°çš„è‡ªåŠ¨æ‰§è¡Œã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ª Generator å‡½æ•°ï¼Œç”¨äºä¾æ¬¡è¯»å–ä¸¤ä¸ªæ–‡ä»¶ã€‚\nğŸ“ƒ Example\nlet gen = function* () { let f1 = yield readFile(\u0026#39;/etc/fstab\u0026#39;); let f2 = yield readFile(\u0026#39;/etc/shells\u0026#39;); console.log(f1.toString()); console.log(f2.toString()); }; co æ¨¡å—å¯ä»¥è®©ä½ ä¸ç”¨ç¼–å†™ Generator å‡½æ•°çš„æ‰§è¡Œå™¨ã€‚\nğŸ“ƒ Example\nlet co = require(\u0026#39;co\u0026#39;); co(gen); ä¸Šé¢ä»£ç ä¸­ï¼ŒGenerator å‡½æ•°åªè¦ä¼ å…¥co å‡½æ•°ï¼Œå°±ä¼šè‡ªåŠ¨æ‰§è¡Œã€‚\nco å‡½æ•°è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œå› æ­¤å¯ä»¥ç”¨ then æ–¹æ³•æ·»åŠ å›è°ƒå‡½æ•°ã€‚\nğŸ“ƒ Example\nco(gen).then(function (){ console.log(\u0026#39;Generator å‡½æ•°æ‰§è¡Œå®Œæˆ\u0026#39;); }); ä¸Šé¢ä»£ç ä¸­ï¼Œç­‰åˆ° Generator å‡½æ•°æ‰§è¡Œç»“æŸï¼Œå°±ä¼šè¾“å‡ºä¸€è¡Œæç¤ºã€‚\nco æ¨¡å—çš„åŸç† ä¸ºä»€ä¹ˆ co å¯ä»¥è‡ªåŠ¨æ‰§è¡Œ Generator å‡½æ•°ï¼Ÿ\nå‰é¢è¯´è¿‡ï¼ŒGenerator å°±æ˜¯ä¸€ä¸ª å¼‚æ­¥ æ“ä½œçš„å®¹å™¨ã€‚å®ƒçš„è‡ªåŠ¨æ‰§è¡Œéœ€è¦ä¸€ç§æœºåˆ¶ï¼Œå½“å¼‚æ­¥æ“ä½œæœ‰äº†ç»“æœï¼Œèƒ½å¤Ÿè‡ªåŠ¨äº¤å›æ‰§è¡Œæƒã€‚\nä¸¤ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚\nå›è°ƒå‡½æ•°ã€‚å°†å¼‚æ­¥æ“ä½œåŒ…è£…æˆ Thunk å‡½æ•°ï¼Œåœ¨å›è°ƒå‡½æ•°é‡Œé¢äº¤å›æ‰§è¡Œæƒã€‚ Promise å¯¹è±¡ã€‚å°†å¼‚æ­¥æ“ä½œåŒ…è£…æˆ Promise å¯¹è±¡ï¼Œç”¨ then() æ–¹æ³•äº¤å›æ‰§è¡Œæƒã€‚ co æ¨¡å—å…¶å®å°±æ˜¯å°†ä¸¤ç§è‡ªåŠ¨æ‰§è¡Œå™¨ï¼ˆThunk å‡½æ•°å’Œ Promise å¯¹è±¡ï¼‰ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ¨¡å—ã€‚ä½¿ç”¨ co çš„å‰ææ¡ä»¶æ˜¯ï¼ŒGenerator å‡½æ•°çš„ yield å‘½ä»¤åé¢ï¼Œåªèƒ½æ˜¯ Thunk å‡½æ•°æˆ– Promise å¯¹è±¡ã€‚å¦‚æœæ•°ç»„æˆ–å¯¹è±¡çš„æˆå‘˜ï¼Œå…¨éƒ¨éƒ½æ˜¯ Promise å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ co ï¼Œè¯¦è§åæ–‡çš„ä¾‹å­ã€‚\nä¸Šä¸€èŠ‚å·²ç»ä»‹ç»äº†åŸºäº Thunk å‡½æ•°çš„è‡ªåŠ¨æ‰§è¡Œå™¨ã€‚ä¸‹é¢æ¥çœ‹ï¼ŒåŸºäº Promise å¯¹è±¡çš„è‡ªåŠ¨æ‰§è¡Œå™¨ã€‚è¿™æ˜¯ç†è§£ co æ¨¡å—å¿…é¡»çš„ã€‚\nåŸºäº Promise å¯¹è±¡çš„è‡ªåŠ¨æ‰§è¡Œ è¿˜æ˜¯æ²¿ç”¨ä¸Šé¢çš„ä¾‹å­ã€‚é¦–å…ˆï¼ŒæŠŠ fs æ¨¡å—çš„ readFile æ–¹æ³•åŒ…è£…æˆä¸€ä¸ª Promise å¯¹è±¡ã€‚\nlet fs = require(\u0026#39;fs\u0026#39;); let readFile = function (fileName){ return new Promise(function (resolve, reject){ fs.readFile(fileName, function(error, data){ if (error) return reject(error); resolve(data); }); }); }; let gen = function* (){ let f1 = yield readFile(\u0026#39;/etc/fstab\u0026#39;); let f2 = yield readFile(\u0026#39;/etc/shells\u0026#39;); console.log(f1.toString()); console.log(f2.toString()); }; ç„¶åï¼Œæ‰‹åŠ¨æ‰§è¡Œä¸Šé¢çš„ Generator å‡½æ•°ã€‚\nlet g = gen(); g.next().value.then(function(data){ g.next(data).value.then(function(data){ g.next(data); }); }); æ‰‹åŠ¨æ‰§è¡Œå…¶å®å°±æ˜¯ç”¨ then() æ–¹æ³•ï¼Œå±‚å±‚æ·»åŠ å›è°ƒå‡½æ•°ã€‚ç†è§£äº†è¿™ä¸€ç‚¹ï¼Œå°±å¯ä»¥å†™å‡ºä¸€ä¸ªè‡ªåŠ¨æ‰§è¡Œå™¨ã€‚\nfunction run(gen){ let g = gen(); function next(data){ let result = g.next(data); if (result.done) return result.value; result.value.then(function(data){ next(data); }); } next(); } run(gen); ä¸Šé¢ä»£ç ä¸­ï¼Œåªè¦ Generator å‡½æ•°è¿˜æ²¡æ‰§è¡Œåˆ°æœ€åä¸€æ­¥ï¼Œnext å‡½æ•°å°±è°ƒç”¨è‡ªèº«ï¼Œä»¥æ­¤å®ç°è‡ªåŠ¨æ‰§è¡Œã€‚\nco æ¨¡å—çš„æºç  co å°±æ˜¯ä¸Šé¢é‚£ä¸ªè‡ªåŠ¨æ‰§è¡Œå™¨çš„æ‰©å±•ï¼Œå®ƒçš„æºç åªæœ‰å‡ åè¡Œï¼Œéå¸¸ç®€å•ã€‚\né¦–å…ˆï¼Œco å‡½æ•°æ¥å— Generator å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚\nfunction co(gen) { let ctx = this; return new Promise(function(resolve, reject) { }); } åœ¨è¿”å›çš„ Promise å¯¹è±¡é‡Œé¢ï¼Œco å…ˆæ£€æŸ¥å‚æ•°genæ˜¯å¦ä¸º Generator å‡½æ•°ã€‚å¦‚æœæ˜¯ï¼Œå°±æ‰§è¡Œè¯¥å‡½æ•°ï¼Œå¾—åˆ°ä¸€ä¸ªå†…éƒ¨æŒ‡é’ˆå¯¹è±¡ï¼›å¦‚æœä¸æ˜¯å°±è¿”å›ï¼Œå¹¶å°† Promise å¯¹è±¡çš„çŠ¶æ€æ”¹ä¸ºresolvedã€‚\nfunction co(gen) { let ctx = this; return new Promise(function(resolve, reject) { if (typeof gen === \u0026#39;function\u0026#39;) gen = gen.call(ctx); if (!gen || typeof gen.next !== \u0026#39;function\u0026#39;) return resolve(gen); }); } æ¥ç€ï¼Œco å°† Generator å‡½æ•°çš„å†…éƒ¨æŒ‡é’ˆå¯¹è±¡çš„nextæ–¹æ³•ï¼ŒåŒ…è£…æˆonFulfilledå‡½æ•°ã€‚è¿™ä¸»è¦æ˜¯ä¸ºäº†èƒ½å¤Ÿæ•æ‰æŠ›å‡ºçš„é”™è¯¯ã€‚\nfunction co(gen) { let ctx = this; return new Promise(function(resolve, reject) { if (typeof gen === \u0026#39;function\u0026#39;) gen = gen.call(ctx); if (!gen || typeof gen.next !== \u0026#39;function\u0026#39;) return resolve(gen); onFulfilled(); function onFulfilled(res) { let ret; try { ret = gen.next(res); } catch (e) { return reject(e); } next(ret); } }); } æœ€åï¼Œå°±æ˜¯å…³é”®çš„nextå‡½æ•°ï¼Œå®ƒä¼šåå¤è°ƒç”¨è‡ªèº«ã€‚\nfunction next(ret) { if (ret.done) return resolve(ret.value); let value = toPromise.call(ctx, ret.value); if (value \u0026amp;\u0026amp; isPromise(value)) return value.then(onFulfilled, onRejected); return onRejected( new TypeError( \u0026#39;You may only yield a function, promise, generator, array, or object, \u0026#39; + \u0026#39;but the following object was passed: \u0026#34;\u0026#39; + String(ret.value) + \u0026#39;\u0026#34;\u0026#39; ) ); } ä¸Šé¢ä»£ç ä¸­ï¼Œnext å‡½æ•°çš„å†…éƒ¨ä»£ç ï¼Œä¸€å…±åªæœ‰å››è¡Œå‘½ä»¤ã€‚\nç¬¬ä¸€è¡Œï¼Œæ£€æŸ¥å½“å‰æ˜¯å¦ä¸º Generator å‡½æ•°çš„æœ€åä¸€æ­¥ï¼Œå¦‚æœæ˜¯å°±è¿”å›ã€‚\nç¬¬äºŒè¡Œï¼Œç¡®ä¿æ¯ä¸€æ­¥çš„è¿”å›å€¼ï¼Œæ˜¯ Promise å¯¹è±¡ã€‚\nç¬¬ä¸‰è¡Œï¼Œä½¿ç”¨thenæ–¹æ³•ï¼Œä¸ºè¿”å›å€¼åŠ ä¸Šå›è°ƒå‡½æ•°ï¼Œç„¶åé€šè¿‡onFulfilledå‡½æ•°å†æ¬¡è°ƒç”¨nextå‡½æ•°ã€‚\nç¬¬å››è¡Œï¼Œåœ¨å‚æ•°ä¸ç¬¦åˆè¦æ±‚çš„æƒ…å†µä¸‹ï¼ˆå‚æ•°é Thunk å‡½æ•°å’Œ Promise å¯¹è±¡ï¼‰ï¼Œå°† Promise å¯¹è±¡çš„çŠ¶æ€æ”¹ä¸ºrejectedï¼Œä»è€Œç»ˆæ­¢æ‰§è¡Œã€‚\nå¤„ç†å¹¶å‘çš„å¼‚æ­¥æ“ä½œ co æ”¯æŒå¹¶å‘çš„å¼‚æ­¥æ“ä½œï¼Œå³å…è®¸æŸäº›æ“ä½œåŒæ—¶è¿›è¡Œï¼Œç­‰åˆ°å®ƒä»¬å…¨éƒ¨å®Œæˆï¼Œæ‰è¿›è¡Œä¸‹ä¸€æ­¥ã€‚\nè¿™æ—¶ï¼Œè¦æŠŠå¹¶å‘çš„æ“ä½œéƒ½æ”¾åœ¨æ•°ç»„æˆ–å¯¹è±¡é‡Œé¢ï¼Œè·Ÿåœ¨ yield è¯­å¥åé¢ã€‚\n// æ•°ç»„çš„å†™æ³• co(function* () { let res = yield [ Promise.resolve(1), Promise.resolve(2) ]; console.log(res); }).catch(onerror); // å¯¹è±¡çš„å†™æ³• co(function* () { let res = yield { 1: Promise.resolve(1), 2: Promise.resolve(2), }; console.log(res); }).catch(onerror); ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚\nğŸ“ƒ Example\nco(function* () { let values = [n1, n2, n3]; yield values.map(somethingAsync); }); function* somethingAsync(x) { // do something async return y } ä¸Šé¢çš„ä»£ç å…è®¸å¹¶å‘ä¸‰ä¸ª somethingAsync å¼‚æ­¥æ“ä½œï¼Œç­‰åˆ°å®ƒä»¬å…¨éƒ¨å®Œæˆï¼Œæ‰ä¼šè¿›è¡Œä¸‹ä¸€æ­¥ã€‚\nå®ä¾‹ï¼šå¤„ç† Stream Node æä¾› Stream æ¨¡å¼è¯»å†™æ•°æ®ï¼Œç‰¹ç‚¹æ˜¯ä¸€æ¬¡åªå¤„ç†æ•°æ®çš„ä¸€éƒ¨åˆ†ï¼Œæ•°æ®åˆ†æˆä¸€å—å—ä¾æ¬¡å¤„ç†ï¼Œå°±å¥½åƒâ€œæ•°æ®æµâ€ä¸€æ ·ã€‚è¿™å¯¹äºå¤„ç†å¤§è§„æ¨¡æ•°æ®éå¸¸æœ‰åˆ©ã€‚Stream æ¨¡å¼ä½¿ç”¨ EventEmitter APIï¼Œä¼šé‡Šæ”¾ä¸‰ä¸ªäº‹ä»¶ï¼š\ndataäº‹ä»¶ï¼šä¸‹ä¸€å—æ•°æ®å—å·²ç»å‡†å¤‡å¥½äº† endäº‹ä»¶ï¼šæ•´ä¸ªâ€œæ•°æ®æµâ€å¤„ç†å®Œäº†ã€‚ erroräº‹ä»¶ï¼šå‘ç”Ÿé”™è¯¯ã€‚ ä½¿ç”¨ Promise.race() å‡½æ•°ï¼Œå¯ä»¥åˆ¤æ–­è¿™ä¸‰ä¸ªäº‹ä»¶ä¹‹ä¸­å“ªä¸€ä¸ªæœ€å…ˆå‘ç”Ÿï¼Œåªæœ‰å½“ data äº‹ä»¶æœ€å…ˆå‘ç”Ÿæ—¶ï¼Œæ‰è¿›å…¥ä¸‹ä¸€ä¸ªæ•°æ®å—çš„å¤„ç†ã€‚ä»è€Œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ª while å¾ªç¯ï¼Œå®Œæˆæ‰€æœ‰æ•°æ®çš„è¯»å–ã€‚\nğŸ“ƒ Example\nconst co = require(\u0026#39;co\u0026#39;); const fs = require(\u0026#39;fs\u0026#39;); const stream = fs.createReadStream(\u0026#39;./les_miserables.txt\u0026#39;); let valjeanCount = 0; co(function*() { while(true) { const res = yield Promise.race([ new Promise(resolve =\u0026gt; stream.once(\u0026#39;data\u0026#39;, resolve)), new Promise(resolve =\u0026gt; stream.once(\u0026#39;end\u0026#39;, resolve)), new Promise((resolve, reject) =\u0026gt; stream.once(\u0026#39;error\u0026#39;, reject)) ]); if (!res) { break; } stream.removeAllListeners(\u0026#39;data\u0026#39;); stream.removeAllListeners(\u0026#39;end\u0026#39;); stream.removeAllListeners(\u0026#39;error\u0026#39;); valjeanCount += (res.toString().match(/valjean/ig) || []).length; } console.log(\u0026#39;count:\u0026#39;, valjeanCount); // count: 1120 }); ä¸Šé¢ä»£ç é‡‡ç”¨ Stream æ¨¡å¼è¯»å–ã€Šæ‚²æƒ¨ä¸–ç•Œã€‹çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¯¹äºæ¯ä¸ªæ•°æ®å—éƒ½ä½¿ç”¨ stream.once æ–¹æ³•ï¼Œåœ¨ data ã€end ã€error ä¸‰ä¸ªäº‹ä»¶ä¸Šæ·»åŠ ä¸€æ¬¡æ€§å›è°ƒå‡½æ•°ã€‚å˜é‡ res åªæœ‰åœ¨dataäº‹ä»¶å‘ç”Ÿæ—¶æ‰æœ‰å€¼ï¼Œç„¶åç´¯åŠ æ¯ä¸ªæ•°æ®å—ä¹‹ä¸­ valjean è¿™ä¸ªè¯å‡ºç°çš„æ¬¡æ•°ã€‚\nAsync ES2017 æ ‡å‡†å¼•å…¥äº† async å‡½æ•°ï¼Œå®ƒæ˜¯ Generator å‡½æ•°å’Œ [Promise](06 EcmaScript B/#promise-es6) å¯¹è±¡çš„è¯­æ³•ç³–ã€‚åœ¨ async å‡½æ•°ä¸­ï¼Œawait è§„å®šäº†å¼‚æ­¥æ“ä½œåªèƒ½ä¸€ä¸ªä¸€ä¸ªæ’é˜Ÿæ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°ç”¨åŒæ­¥çš„æ–¹å¼ï¼Œæ‰§è¡Œå¼‚æ­¥æ“ä½œçš„æ•ˆæœã€‚\n[è¿”å›å€¼] = await è¡¨è¾¾å¼; async å‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ then æ–¹æ³•æ·»åŠ å›è°ƒå‡½æ•°ã€‚å½“å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€æ—¦é‡åˆ° await å°±ä¼šå…ˆ è¿”å› ï¼Œç­‰åˆ°å¼‚æ­¥æ“ä½œå®Œæˆï¼Œå†æ¥ç€æ‰§è¡Œå‡½æ•°ä½“å†…åé¢çš„è¯­å¥ã€‚\n// \u0026gt;= ~~\u0026gt; =\u0026gt;= === \u0026lt;=\u0026gt; === =\u0026lt;= \u0026lt;~~ \u0026lt;= request = sec =\u0026gt; new Promise(_ =\u0026gt; setTimeout(() =\u0026gt; _(sec), sec * 1000)); async function fn() { const res1 = await request(1); // ç­‰å¾…1s const res2 = await request(res1 + 1); // ç­‰å¾…2s // await è¿”å›å€¼æ˜¯Promiseä¼ é€’çš„å‚æ•° console.log(`res1:${res1}, res2:${res2}`); // 2ç§’åè¾“å‡º20 } console.log(fn()); // Promise { \u0026lt;pending\u0026gt; } // res1:1, res2:2 ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚\nğŸ“ƒ Example\nconst getStockSymbol = name =\u0026gt; new Promise(_ =\u0026gt; setTimeout(_, 1000)) .then(_ =\u0026gt; ({alphabet: \u0026#39;GOOG\u0026#39;}[name])); const getStockPrice = symbol =\u0026gt; new Promise(_ =\u0026gt; setTimeout(_, 1000), symbol) /* Note: è¿™é‡Œçš„å†™æ³•ï¼šç”±äºå‡½æ•°å†…éƒ¨è°ƒç”¨çš„æ˜¯fn(...args) * å› æ­¤å¯ä»¥ç›´æ¥ä¼ å…¥fn * æ¥ä»£æ›¿(...args)=\u0026gt;fn(...args)è¿™æ ·çš„å†™æ³• * è¿˜å¯ä»¥å‡å°‘ä¸€å±‚åµŒå¥— * å‰ï¼š((...args)=\u0026gt;fn(...args))(...args) * åï¼šfn(...args) */ .then( _ =\u0026gt; (`${{GOOG: 2564.91}[_]} USD`) ); async function getStockPriceByName(name) { const symbol = await getStockSymbol(name); return await getStockPrice(symbol); } console.log( getStockPriceByName(\u0026#39;alphabet\u0026#39;) .then(ret =\u0026gt; console.log(ret)) // asyncäº§ç”Ÿçš„Promiseæœ€ç»ˆreturnå€¼ // è¢«Promiseåç»­çš„then()æ¥æ”¶ // 2såè¿”å›2564.91 USD ); // å…ˆè¾“å‡º Promise { \u0026lt;pending\u0026gt; } ä¸Šé¢ä»£ç æ˜¯ä¸€ä¸ªè·å–è‚¡ç¥¨æŠ¥ä»·çš„å‡½æ•°ï¼Œå‡½æ•°å‰é¢çš„ async å…³é”®å­—ï¼Œè¡¨æ˜è¯¥å‡½æ•°å†…éƒ¨æœ‰å¼‚æ­¥æ“ä½œã€‚è°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œä¼šç«‹å³è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚\nä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ï¼ŒæŒ‡å®šå¤šå°‘æ¯«ç§’åè¾“å‡ºä¸€ä¸ªå€¼ã€‚\nğŸ“ƒ Example\nconst timeout = ms =\u0026gt; new Promise(_ =\u0026gt; setTimeout(_, ms)); const asyncPrint = async (value, ms) =\u0026gt; { await timeout(ms); console.log(value); } asyncPrint(\u0026#39;hello world\u0026#39;, 500).then(); ä¸Šé¢ä»£ç æŒ‡å®š 500 æ¯«ç§’ä»¥åï¼Œè¾“å‡º hello world ã€‚\nç”±äº async å‡½æ•°è¿”å›çš„æ˜¯ Promise å¯¹è±¡ï¼Œå¯ä»¥ä½œä¸º await å‘½ä»¤çš„å‚æ•°ã€‚æ‰€ä»¥ï¼Œä¸Šé¢çš„ä¾‹å­ä¹Ÿå¯ä»¥å†™æˆä¸‹é¢çš„å½¢å¼ã€‚\nconst timeout = async ms =\u0026gt; await new Promise(resolve =\u0026gt; setTimeout(resolve, ms)); const asyncPrint = async (value, ms) =\u0026gt; await timeout(ms) || value; asyncPrint(\u0026#39;hello world\u0026#39;, 50) .then(console.log); async å‡½æ•°æœ‰å¤šç§ä½¿ç”¨å½¢å¼ã€‚\n// å‡½æ•°å£°æ˜ async function foo() { } // å‡½æ•°è¡¨è¾¾å¼ const foo = async function () {}; // å¯¹è±¡çš„æ–¹æ³• let obj = { async foo() { } }; obj.foo().then(() =\u0026gt; {}); // Class çš„æ–¹æ³• class Storage { constructor() { this.cachePromise = caches.open(\u0026#39;avatars\u0026#39;); } async getAvatar(name) { const cache = await this.cachePromise; return cache.match(`/avatars/${name}.jpg`); } } const storage = new Storage(); storage.getAvatar(\u0026#39;jake\u0026#39;).then(()=\u0026gt;{}); // ç®­å¤´å‡½æ•° const foo = async () =\u0026gt; {}; /* Note: Generatoræ²¡æœ‰ç®­å¤´å‡½æ•°å½¢å¼ */ è¯­æ³• async å‡½æ•°çš„è¯­æ³•è§„åˆ™æ€»ä½“ä¸Šæ¯”è¾ƒç®€å•ï¼Œéš¾ç‚¹æ˜¯é”™è¯¯å¤„ç†æœºåˆ¶ã€‚\nè¿”å› async å‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚\nasync å‡½æ•°å†…éƒ¨ return è¯­å¥è¿”å›çš„å€¼ï¼Œä¼šæˆä¸º then æ–¹æ³•å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚\nğŸ“ƒ Example\nf = (async () =\u0026gt; { await \u0026#39;hello \u0026#39;; // Redundant \u0026#39;await\u0026#39; for a non-promise type // awaitåªæ¥æ”¶Promiseçš„è¿”å›å€¼ï¼Œå…¶å®ƒæ— æ•ˆ return \u0026#39;hello world\u0026#39;; })(); f.then(console.log).then(console.log); ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•° f å†…éƒ¨ return å‘½ä»¤è¿”å›çš„å€¼ï¼Œä¼šè¢« then æ–¹æ³•å›è°ƒå‡½æ•°æ¥æ”¶åˆ°ã€‚\nasync å‡½æ•°å†…éƒ¨æŠ›å‡ºé”™è¯¯ï¼Œä¼šå¯¼è‡´è¿”å›çš„ Promise å¯¹è±¡å˜ä¸º reject çŠ¶æ€ã€‚æŠ›å‡ºçš„é”™è¯¯å¯¹è±¡ä¼šè¢« catch æ–¹æ³•å›è°ƒå‡½æ•°æ¥æ”¶åˆ°ã€‚\nğŸ“ƒ Example\nasync function f() { throw new Error(\u0026#39;å‡ºé”™äº†\u0026#39;); } f().then( v =\u0026gt; console.log(\u0026#39;resolve\u0026#39;, v), e =\u0026gt; console.error(\u0026#39;reject\u0026#39;, e.toString()) ) //reject Error: å‡ºé”™äº† çŠ¶æ€å˜åŒ– async å‡½æ•°è¿”å›çš„ Promise å¯¹è±¡ï¼Œå¿…é¡»ç­‰åˆ°å†…éƒ¨ æ‰€æœ‰ await å‘½ä»¤åé¢çš„ Promise å¯¹è±¡æ‰§è¡Œå®Œï¼Œæ‰ä¼šå‘ç”ŸçŠ¶æ€æ”¹å˜ï¼Œé™¤éé‡åˆ° return è¯­å¥æˆ–è€…æŠ›å‡ºé”™è¯¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰ async å‡½æ•°å†…éƒ¨çš„å¼‚æ­¥æ“ä½œæ‰§è¡Œå®Œï¼Œæ‰ä¼šæ‰§è¡Œ then æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚\nğŸ“ƒ Example\nasync function getTitle(url) { let response = await fetch(url); let html = await response.text(); return html.match(/\u0026lt;title\u0026gt;([\\s\\S]+)\u0026lt;\\/title\u0026gt;/i)[1]; } getTitle(\u0026#39;https://tc39.github.io/ecma262/\u0026#39;) .then(console.log) .catch(console.error); // \u0026#34;ECMAScript 2017 Language Specification\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•° getTitle å†…éƒ¨æœ‰ä¸‰ä¸ªæ“ä½œï¼šæŠ“å–ç½‘é¡µã€å–å‡ºæ–‡æœ¬ã€åŒ¹é…é¡µé¢æ ‡é¢˜ã€‚åªæœ‰è¿™ä¸‰ä¸ªæ“ä½œå…¨éƒ¨å®Œæˆï¼Œæ‰ä¼šæ‰§è¡Œ then æ–¹æ³•é‡Œé¢çš„ console.log ã€‚\nAwait æ­£å¸¸æƒ…å†µä¸‹ï¼Œ await å‘½ä»¤åé¢æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè¿”å›è¯¥å¯¹è±¡çš„ç»“æœã€‚å¦‚æœä¸æ˜¯ Promise å¯¹è±¡ï¼Œå°±ç›´æ¥è¿”å›å¯¹åº”çš„å€¼ã€‚\n:memo: Note\nasync è‡ªåŠ¨è¿”å› Promise() å¯¹è±¡ è€Œ await å¯ä»¥æ¥å— Promise.then() ä¼ é€’çš„ç¬¬ä¸€ä¸ª å‚æ•°*^resolve(\u0026hellip;)^* ğŸ“ƒ Example\nasync function f() { // ç­‰åŒäº // return 123; return await 123; // Redundant \u0026#39;return await\u0026#39; } f().then(v =\u0026gt; console.log(v)); // 123 ä¸Šé¢ä»£ç ä¸­ï¼Œ await å‘½ä»¤çš„å‚æ•°æ˜¯æ•°å€¼ 123 ï¼Œè¿™æ—¶ç­‰åŒäº return 123ã€‚\nWebStrom ä¸­ä¼šè‡ªåŠ¨æç¤ºã€‚\nğŸ“ƒ Example\nå°† NodeÂ çš„ fsÂ æ¨¡å—è½¬ä¸º PromiseÂ åŒæ­¥å†™æ³•ï¼š\n/* main.js */ import fs from \u0026#39;fs\u0026#39;; export const fsp = async (path, options) =\u0026gt; new Promise((resolve, reject) =\u0026gt; fs.readFile(path, options, (err, dataStr) =\u0026gt; err ? reject(err) : resolve(dataStr) )); const dataStr = await fsp(\u0026#39;./module.js\u0026#39;); console.log(dataStr.toString()); // module.js =\u0026gt; ... å¦ä¸€ç§æƒ…å†µæ˜¯ï¼Œ await å‘½ä»¤åé¢æ˜¯ä¸€ä¸ª thenable å¯¹è±¡ï¼ˆå³å®šä¹‰äº† then æ–¹æ³•çš„å¯¹è±¡ï¼‰ï¼Œé‚£ä¹ˆ await ä¼šå°†å…¶ç­‰åŒäº Promise å¯¹è±¡ã€‚ï¼ˆç±»ä¼¼äº Promise.reslove()ï¼‰\nğŸ“ƒ Example\nconsole.log(Date.now()) class Sleep { constructor(timeout) { this.timeout = timeout; } then(resolve, reject) { console.log(`resolve`); const startTime = Date.now(); setTimeout( () =\u0026gt; resolve(Date.now() - startTime), this.timeout ); } } (async () =\u0026gt; { const sleepTime = await new Sleep(1000); console.log(sleepTime); })(); // 1000 ä¸Šé¢ä»£ç ä¸­ï¼Œ await å‘½ä»¤åé¢æ˜¯ä¸€ä¸ª Sleep å¯¹è±¡çš„å®ä¾‹ã€‚è¿™ä¸ªå®ä¾‹ä¸æ˜¯ Promise å¯¹è±¡ï¼Œä½†æ˜¯å› ä¸ºå®šä¹‰äº† then æ–¹æ³•ï¼Œ await ä¼šå°†å…¶è§†ä¸º Promise å¤„ç†ã€‚\nè¿™ä¸ªä¾‹å­è¿˜æ¼”ç¤ºäº†å¦‚ä½•å®ç°ä¼‘çœ æ•ˆæœã€‚JavaScript ä¸€ç›´æ²¡æœ‰ä¼‘çœ çš„è¯­æ³•ï¼Œä½†æ˜¯å€ŸåŠ© await å‘½ä»¤å°±å¯ä»¥è®©ç¨‹åºåœé¡¿æŒ‡å®šçš„æ—¶é—´ã€‚\nğŸ“ƒ Example\nä¸‹é¢ç»™å‡ºäº†ä¸€ä¸ªç®€åŒ–çš„ sleep å®ç°ã€‚\nfunction sleep(interval) { return new Promise(resolve =\u0026gt; { setTimeout(resolve, interval); }) } // ç”¨æ³• async function one2FiveInAsync() { for (let i = 1; i \u0026lt;= 5; i++) { console.log(i); await sleep(1000); } } one2FiveInAsync(); await å‘½ä»¤åé¢çš„ Promise å¯¹è±¡å¦‚æœå˜ä¸º reject çŠ¶æ€ï¼Œåˆ™ reject çš„å‚æ•°ä¼šè¢« catch æ–¹æ³•çš„å›è°ƒå‡½æ•°æ¥æ”¶åˆ°ã€‚\n:memo: Note åªèƒ½åœ¨ async å‡½æ•°å†…ä½¿ç”¨ã€‚\nğŸ“ƒ Example\nasync function f() { await Promise.reject(\u0026#39;å‡ºé”™äº†\u0026#39;); } f().then(console.log) .catch(e =\u0026gt; console.error(e.toString())); // å‡ºé”™äº† æ³¨æ„ï¼Œä¸Šé¢ä»£ç ä¸­ï¼Œawait è¯­å¥å‰é¢æ²¡æœ‰ return ï¼Œä½†æ˜¯ reject æ–¹æ³•çš„å‚æ•°ä¾ç„¶ä¼ å…¥äº† catch æ–¹æ³•çš„å›è°ƒå‡½æ•°ã€‚è¿™é‡Œå¦‚æœåœ¨ await å‰é¢åŠ ä¸Š return ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚\nä»»ä½•ä¸€ä¸ª await è¯­å¥åé¢çš„ Promise å¯¹è±¡å˜ä¸º reject çŠ¶æ€ï¼Œé‚£ä¹ˆæ•´ä¸ª async å‡½æ•°éƒ½ä¼šä¸­æ–­æ‰§è¡Œã€‚\nğŸ“ƒ Example\nasync function f() { await Promise.reject(\u0026#39;å‡ºé”™äº†\u0026#39;); await Promise.resolve(\u0026#39;hello world\u0026#39;); // ç¬¬äºŒå¥ä¸ä¼šæ‰§è¡Œ // Redundant \u0026#39;await Promise.resolve()\u0026#39; } ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬äºŒä¸ª await è¯­å¥æ˜¯ä¸ä¼šæ‰§è¡Œçš„ï¼Œå› ä¸ºç¬¬ä¸€ä¸ª await è¯­å¥çŠ¶æ€å˜æˆäº† rejectã€‚\næœ‰æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å³ä½¿å‰ä¸€ä¸ªå¼‚æ­¥æ“ä½œå¤±è´¥ï¼Œä¹Ÿä¸è¦ä¸­æ–­åé¢çš„å¼‚æ­¥æ“ä½œã€‚è¿™æ—¶å¯ä»¥å°†ç¬¬ä¸€ä¸ª await æ”¾åœ¨ try-catch ç»“æ„é‡Œé¢ï¼Œè¿™æ ·ä¸ç®¡è¿™ä¸ªå¼‚æ­¥æ“ä½œæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ª await éƒ½ä¼šæ‰§è¡Œã€‚\nasync function f() { try { await Promise.reject(\u0026#39;å‡ºé”™äº†\u0026#39;); } catch (e) { } return await Promise.resolve(\u0026#39;hello world\u0026#39;); } f().then(v =\u0026gt; console.log(v)) // hello world å¦ä¸€ç§æ–¹æ³•æ˜¯ await åé¢çš„ Promise å¯¹è±¡å†è·Ÿä¸€ä¸ª catch æ–¹æ³•ï¼Œå¤„ç†å‰é¢å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚\nasync function f() { await Promise.reject(\u0026#39;å‡ºé”™äº†\u0026#39;) .catch(e =\u0026gt; console.log(e)); return await Promise.resolve(\u0026#39;hello world\u0026#39;); } f() .then(v =\u0026gt; console.log(v)) // å‡ºé”™äº† // hello world é”™è¯¯ å¦‚æœ await åé¢çš„å¼‚æ­¥æ“ä½œå‡ºé”™ï¼Œé‚£ä¹ˆç­‰åŒäº async å‡½æ•°è¿”å›çš„ Promise å¯¹è±¡è¢«rejectã€‚\nğŸ“ƒ Example\nasync function f() { await new Promise(function (resolve, reject) { throw new Error(\u0026#39;å‡ºé”™äº†\u0026#39;); }); } f().then(console.log).catch(e =\u0026gt; console.error(e.toString())); // Errorï¼šå‡ºé”™äº† ä¸Šé¢ä»£ç ä¸­ï¼Œ async å‡½æ•° f æ‰§è¡Œåï¼Œ await åé¢çš„ Promise å¯¹è±¡ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯å¯¹è±¡ï¼Œå¯¼è‡´ catch æ–¹æ³•çš„å›è°ƒå‡½æ•°è¢«è°ƒç”¨ï¼Œå®ƒçš„å‚æ•°å°±æ˜¯æŠ›å‡ºçš„é”™è¯¯å¯¹è±¡ã€‚å…·ä½“çš„æ‰§è¡Œæœºåˆ¶ï¼Œå¯ä»¥å‚è€ƒåæ–‡çš„â€œasync å‡½æ•°çš„å®ç°åŸç†â€ã€‚\né˜²æ­¢å‡ºé”™çš„æ–¹æ³•ï¼Œä¹Ÿæ˜¯å°†å…¶æ”¾åœ¨ try...catchä»£ç å—ä¹‹ä¸­ã€‚\nasync function f() { try { await new Promise(function (resolve, reject) { throw new Error(\u0026#39;å‡ºé”™äº†\u0026#39;); }); } catch(e) { } return (\u0026#39;hello world\u0026#39;); } å¦‚æœæœ‰å¤šä¸ª await å‘½ä»¤ï¼Œå¯ä»¥ç»Ÿä¸€æ”¾åœ¨ try-catch ç»“æ„ä¸­ã€‚\nasync function main() { try { const val1 = await firstStep(); const val2 = await secondStep(val1); const val3 = await thirdStep(val1, val2); console.log(\u0026#39;Final: \u0026#39;, val3); } catch (err) { console.error(err); } } ä¸‹é¢çš„ä¾‹å­ä½¿ç”¨ try-catch ç»“æ„ï¼Œå®ç°å¤šæ¬¡é‡å¤å°è¯•ã€‚\nğŸ“ƒ Example :star:\nconst superagent = require(\u0026#39;superagent\u0026#39;); const NUM_RETRIES = 3; async function test() { let i; for (i = 0; i \u0026lt; NUM_RETRIES; ++i) { try { await superagent.get(\u0026#39;http://google.com/this-throws-an-error\u0026#39;); break; } catch(err) {} } console.log(i); // 3 } test(); ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœ await æ“ä½œæˆåŠŸï¼Œå°±ä¼šä½¿ç”¨ break è¯­å¥é€€å‡ºå¾ªç¯ï¼›å¦‚æœå¤±è´¥ï¼Œä¼šè¢« catch è¯­å¥æ•æ‰ï¼Œç„¶åè¿›å…¥ä¸‹ä¸€è½®å¾ªç¯ã€‚\næ³¨æ„ç‚¹ ç¬¬ä¸€ç‚¹ï¼Œå‰é¢å·²ç»è¯´è¿‡ï¼Œ await å‘½ä»¤åé¢çš„Promiseå¯¹è±¡ï¼Œè¿è¡Œç»“æœå¯èƒ½æ˜¯rejectedï¼Œæ‰€ä»¥æœ€å¥½æŠŠ await å‘½ä»¤æ”¾åœ¨try...catchä»£ç å—ä¸­ã€‚\nğŸ“ƒ Example\nasync function myFunction() { try { await somethingThatReturnsAPromise(); } catch (err) { console.log(err); } } // å¦ä¸€ç§å†™æ³• async function myFunction() { await somethingThatReturnsAPromise() .catch(function (err) { console.log(err); }); } ç¬¬äºŒç‚¹ï¼Œå¤šä¸ª await å‘½ä»¤åé¢çš„å¼‚æ­¥æ“ä½œï¼Œå¦‚æœä¸å­˜åœ¨ç»§å‘å…³ç³»ï¼Œæœ€å¥½è®©å®ƒä»¬åŒæ—¶è§¦å‘ã€‚\nğŸ“ƒ Example\nlet foo = await getFoo(); let bar = await getBar(); ä¸Šé¢ä»£ç ä¸­ï¼ŒgetFoo å’Œ getBar æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„å¼‚æ­¥æ“ä½œï¼ˆå³äº’ä¸ä¾èµ–ï¼‰ï¼Œè¢«å†™æˆ ç»§å‘å…³ç³» ï¼ˆgetFoo ç»“æŸåæ‰è¿è¡Œ getBarï¼‰ã€‚è¿™æ ·æ¯”è¾ƒè€—æ—¶ï¼Œå› ä¸ºåªæœ‰ getFoo å®Œæˆä»¥åï¼Œæ‰ä¼šæ‰§è¡Œ getBar ï¼Œå®Œå…¨å¯ä»¥è®©å®ƒä»¬åŒæ—¶è§¦å‘ã€‚\n:link: Href Promise.all()\n// å†™æ³•ä¸€ let [foo, bar] = await Promise.all([getFoo(), getBar()]); // å†™æ³•äºŒ let fooPromise = getFoo(); let barPromise = getBar(); let foo = await fooPromise; let bar = await barPromise; ä¸Šé¢ä¸¤ç§å†™æ³•ï¼ŒgetFoo å’Œ getBar éƒ½æ˜¯åŒæ—¶è§¦å‘ï¼Œè¿™æ ·å°±ä¼šç¼©çŸ­ç¨‹åºçš„æ‰§è¡Œæ—¶é—´ã€‚\nç¬¬ä¸‰ç‚¹ï¼Œ await å‘½ä»¤åªèƒ½ç”¨åœ¨ async å‡½æ•°ä¹‹ä¸­ï¼Œå¦‚æœç”¨åœ¨æ™®é€šå‡½æ•°ï¼Œå°±ä¼šæŠ¥é”™ã€‚\nğŸ“ƒ Example\nasync function dbFuc(db) { let docs = [{}, {}, {}]; // æŠ¥é”™ docs.forEach(function (doc) { await db.post(doc); // The \u0026#39;await\u0026#39; operator can only be used in an \u0026#39;async\u0026#39; function // Replace \u0026#39;forEach\u0026#39; with \u0026#39;for-of\u0026#39; loop }); } ä¸Šé¢ä»£ç ä¼šæŠ¥é”™ï¼Œå› ä¸º await ç”¨åœ¨æ™®é€šå‡½æ•°ä¹‹ä¸­äº†ã€‚ä½†æ˜¯ï¼Œå¦‚æœå°† forEach æ–¹æ³•çš„å‚æ•°æ”¹æˆ async å‡½æ•°ï¼Œä¹Ÿæœ‰é—®é¢˜ã€‚\nğŸ“ƒ Example\nfunction dbFuc(db) { //è¿™é‡Œä¸éœ€è¦ async let docs = [{}, {}, {}]; // å¯èƒ½å¾—åˆ°é”™è¯¯ç»“æœ docs.forEach(async function (doc) { await db.post(doc); }); } ä¸Šé¢ä»£ç å¯èƒ½ä¸ä¼šæ­£å¸¸å·¥ä½œï¼ŒåŸå› æ˜¯è¿™æ—¶ä¸‰ä¸ª db.post() æ“ä½œå°†æ˜¯å¹¶å‘æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯åŒæ—¶æ‰§è¡Œï¼Œè€Œä¸æ˜¯ç»§å‘æ‰§è¡Œã€‚\nğŸ§ª Experimental åŒæ—¶æ‰§è¡Œå†™æ³•\nclass DB { post(doc) { return new Promise(_ =\u0026gt; { setTimeout($ =\u0026gt; { console.log(`doc ${JSON.stringify($)} called`); _($); }, Math.random() * 500 | 0, doc); }); } } const docs = [{1: \u0026#39;foo\u0026#39;}, {2: \u0026#39;bar\u0026#39;}, {3: \u0026#39;baz\u0026#39;}]; function dbFuc(db) { //è¿™é‡Œä¸éœ€è¦ async docs.forEach( async doc =\u0026gt; await db.post(doc) .then(console.log) // { \u0026#39;2\u0026#39;: \u0026#39;bar\u0026#39; } // { \u0026#39;1\u0026#39;: \u0026#39;foo\u0026#39; } // { \u0026#39;3\u0026#39;: \u0026#39;baz\u0026#39; } // æ ¹æ®setTimeoutçš„éšæœºå»¶æ—¶ï¼Œä¸‰ä¸ªè¿”å›é¡ºåºä¹Ÿä¸åŒ // è¾¾åˆ°äº†åŒæ—¶è¯·æ±‚çš„æ•ˆæœ ); } function dbFucA(db) { Promise.all(docs.map( async doc =\u0026gt; await db.post(doc) )).then(console.log); // [ { \u0026#39;1\u0026#39;: \u0026#39;foo\u0026#39; }, { \u0026#39;2\u0026#39;: \u0026#39;bar\u0026#39; }, { \u0026#39;3\u0026#39;: \u0026#39;baz\u0026#39; } ] // Promise.all()é£æ ¼çš„å†™æ³• // awaitè¿”å›çš„æ˜¯Promise } dbFuc(new DB()); dbFucA(new DB()); æ­£ç¡®çš„å†™æ³•æ˜¯é‡‡ç”¨ for å¾ªç¯ã€‚\nasync function dbFuc(db) { let docs = [{}, {}, {}]; for (let doc of docs) { await db.post(doc); } } å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨æ•°ç»„çš„ reduce() æ–¹æ³•ã€‚\nğŸ“ƒ Example\nasync function dbFuc(db) { let docs = [{}, {}, {}]; await docs.reduce(async (_, doc) =\u0026gt; { await _; await db.post(doc); }, undefined); } ä¸Šé¢ä¾‹å­ä¸­ï¼Œreduce()æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ async å‡½æ•°ï¼Œå¯¼è‡´è¯¥å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å‰ä¸€æ­¥æ“ä½œè¿”å›çš„ Promise å¯¹è±¡ï¼Œæ‰€ä»¥å¿…é¡»ä½¿ç”¨ await ç­‰å¾…å®ƒæ“ä½œç»“æŸã€‚å¦å¤–ï¼Œreduce()æ–¹æ³•è¿”å›çš„æ˜¯docsæ•°ç»„æœ€åä¸€ä¸ªæˆå‘˜çš„ async å‡½æ•°çš„æ‰§è¡Œç»“æœï¼Œä¹Ÿæ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¯¼è‡´åœ¨å®ƒå‰é¢ä¹Ÿå¿…é¡»åŠ ä¸Š await ã€‚\nä¸Šé¢çš„reduce()çš„å‚æ•°å‡½æ•°é‡Œé¢æ²¡æœ‰returnè¯­å¥ï¼ŒåŸå› æ˜¯è¿™ä¸ªå‡½æ•°çš„ä¸»è¦ç›®çš„æ˜¯db.post()æ“ä½œï¼Œä¸æ˜¯è¿”å›å€¼ã€‚è€Œä¸” async å‡½æ•°ä¸ç®¡æœ‰æ²¡æœ‰ return è¯­å¥ï¼Œæ€»æ˜¯è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œæ‰€ä»¥è¿™é‡Œçš„ return æ˜¯ä¸å¿…è¦çš„ã€‚\nå¦‚æœç¡®å®å¸Œæœ›å¤šä¸ªè¯·æ±‚å¹¶å‘æ‰§è¡Œï¼Œå¯ä»¥ä½¿ç”¨ Promise.all æ–¹æ³•ã€‚å½“ä¸‰ä¸ªè¯·æ±‚éƒ½ä¼š resolved æ—¶ï¼Œä¸‹é¢ä¸¤ç§å†™æ³•æ•ˆæœç›¸åŒã€‚\nasync function dbFuc(db) { let docs = [{}, {}, {}]; let promises = docs.map((doc) =\u0026gt; db.post(doc)); let results = await Promise.all(promises); console.log(results); } // æˆ–è€…ä½¿ç”¨ä¸‹é¢çš„å†™æ³• async function dbFuc(db) { let docs = [{}, {}, {}]; let promises = docs.map((doc) =\u0026gt; db.post(doc)); let results = []; for (let Promise of promises) { results.push(await promise); } console.log(results); } ç¬¬å››ç‚¹ï¼Œasync å‡½æ•°å¯ä»¥ä¿ç•™è¿è¡Œå †æ ˆã€‚\nğŸ“ƒ Example\nconst a = () =\u0026gt; { b().then(() =\u0026gt; c()); }; ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•° a å†…éƒ¨è¿è¡Œäº†ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ b() ã€‚å½“ b() è¿è¡Œçš„æ—¶å€™ï¼Œå‡½æ•°a()ä¸ä¼šä¸­æ–­ï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œã€‚ç­‰åˆ° b() è¿è¡Œç»“æŸï¼Œå¯èƒ½a()æ—©å°±è¿è¡Œç»“æŸäº†ï¼Œb()æ‰€åœ¨çš„ä¸Šä¸‹æ–‡ç¯å¢ƒå·²ç»æ¶ˆå¤±äº†ã€‚å¦‚æœb()æˆ–c()æŠ¥é”™ï¼Œé”™è¯¯å †æ ˆå°†ä¸åŒ…æ‹¬a()ã€‚\nç°åœ¨å°†è¿™ä¸ªä¾‹å­æ”¹æˆ async å‡½æ•°ã€‚\nconst a = async () =\u0026gt; { await b(); c(); }; ä¸Šé¢ä»£ç ä¸­ï¼Œb()è¿è¡Œçš„æ—¶å€™ï¼Œa()æ˜¯æš‚åœæ‰§è¡Œï¼Œä¸Šä¸‹æ–‡ç¯å¢ƒéƒ½ä¿å­˜ç€ã€‚ä¸€æ—¦b()æˆ–c()æŠ¥é”™ï¼Œé”™è¯¯å †æ ˆå°†åŒ…æ‹¬a()ã€‚\nåŸç† async å‡½æ•°çš„å®ç°åŸç†ï¼Œå°±æ˜¯å°† Generator å‡½æ•°å’Œè‡ªåŠ¨æ‰§è¡Œå™¨ï¼ŒåŒ…è£…åœ¨ä¸€ä¸ªå‡½æ•°é‡Œã€‚\nasync function fn(args) { // ... } // ç­‰åŒäº function fn(args) { return spawn(function* () { // ... }); } æ‰€æœ‰çš„ async å‡½æ•°éƒ½å¯ä»¥å†™æˆä¸Šé¢çš„ç¬¬äºŒç§å½¢å¼ï¼Œå…¶ä¸­çš„ spawn å‡½æ•°å°±æ˜¯è‡ªåŠ¨æ‰§è¡Œå™¨ã€‚\nä¸‹é¢ç»™å‡º spawn å‡½æ•°çš„å®ç°ï¼ŒåŸºæœ¬å°±æ˜¯å‰æ–‡è‡ªåŠ¨æ‰§è¡Œå™¨çš„ç¿»ç‰ˆã€‚\nfunction spawn(genF) { return new Promise(function (resolve, reject) { if (typeof genF !== \u0026#39;function\u0026#39;) return genF; const gen = genF(); function step(nextF) { let next; try { next = nextF(); } catch (e) { return reject(e); } if (next.done) { return resolve(next.value); } Promise.resolve(next.value).then(function (v) { step(function () { return gen.next(v); }); }).catch(function (e) { step(function () { return gen.throw(e); }); }); } step(function () { return gen.next(undefined); }); }); } æ¯”è¾ƒ æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­ï¼Œæ¥çœ‹ async å‡½æ•°ä¸ Promiseã€Generator å‡½æ•°çš„æ¯”è¾ƒã€‚\nå‡å®šæŸä¸ª DOM å…ƒç´ ä¸Šé¢ï¼Œéƒ¨ç½²äº†ä¸€ç³»åˆ—çš„åŠ¨ç”»ï¼Œå‰ä¸€ä¸ªåŠ¨ç”»ç»“æŸï¼Œæ‰èƒ½å¼€å§‹åä¸€ä¸ªã€‚å¦‚æœå½“ä¸­æœ‰ä¸€ä¸ªåŠ¨ç”»å‡ºé”™ï¼Œå°±ä¸å†å¾€ä¸‹æ‰§è¡Œï¼Œè¿”å›ä¸Šä¸€ä¸ªæˆåŠŸæ‰§è¡Œçš„åŠ¨ç”»çš„è¿”å›å€¼ã€‚\né¦–å…ˆæ˜¯ Promise çš„å†™æ³•ã€‚\nfunction chainAnimationsPromise(elem, animations) { // å˜é‡retç”¨æ¥ä¿å­˜ä¸Šä¸€ä¸ªåŠ¨ç”»çš„è¿”å›å€¼ let ret = null; // æ–°å»ºä¸€ä¸ªç©ºçš„Promise let p = Promise.resolve(); // ä½¿ç”¨thenæ–¹æ³•ï¼Œæ·»åŠ æ‰€æœ‰åŠ¨ç”» for(let anim of animations) { p = p.then(function(val) { ret = val; return anim(elem); }); } // è¿”å›ä¸€ä¸ªéƒ¨ç½²äº†é”™è¯¯æ•æ‰æœºåˆ¶çš„Promise return p.catch(function(e) { /* å¿½ç•¥é”™è¯¯ï¼Œç»§ç»­æ‰§è¡Œ */ }).then(function() { return ret; }); } è™½ç„¶ Promise çš„å†™æ³•æ¯”å›è°ƒå‡½æ•°çš„å†™æ³•å¤§å¤§æ”¹è¿›ï¼Œä½†æ˜¯ä¸€çœ¼çœ‹ä¸Šå»ï¼Œä»£ç å®Œå…¨éƒ½æ˜¯ Promise çš„ APIï¼ˆthenã€ catch ç­‰ç­‰ï¼‰ï¼Œæ“ä½œæœ¬èº«çš„è¯­ä¹‰åè€Œä¸å®¹æ˜“çœ‹å‡ºæ¥ã€‚\næ¥ç€æ˜¯ Generator å‡½æ•°çš„å†™æ³•ã€‚\næœ€åæ˜¯ async å‡½æ•°çš„å†™æ³•ã€‚\nasync function chainAnimationsAsync(elem, animations) { let ret = null; try { for(let anim of animations) { ret = await anim(elem); } } catch(e) { /* å¿½ç•¥é”™è¯¯ï¼Œç»§ç»­æ‰§è¡Œ */ } return ret; } å¯ä»¥çœ‹åˆ° async å‡½æ•°çš„å®ç°æœ€ç®€æ´ï¼Œæœ€ç¬¦åˆè¯­ä¹‰ï¼Œå‡ ä¹æ²¡æœ‰è¯­ä¹‰ä¸ç›¸å…³çš„ä»£ç ã€‚å®ƒå°† Generator å†™æ³•ä¸­çš„è‡ªåŠ¨æ‰§è¡Œå™¨ï¼Œæ”¹åœ¨è¯­è¨€å±‚é¢æä¾›ï¼Œä¸æš´éœ²ç»™ç”¨æˆ·ï¼Œå› æ­¤ä»£ç é‡æœ€å°‘ã€‚å¦‚æœä½¿ç”¨ Generator å†™æ³•ï¼Œè‡ªåŠ¨æ‰§è¡Œå™¨éœ€è¦ç”¨æˆ·è‡ªå·±æä¾›ã€‚\nå®ä¾‹ å®é™…å¼€å‘ä¸­ï¼Œç»å¸¸é‡åˆ°ä¸€ç»„å¼‚æ­¥æ“ä½œï¼Œéœ€è¦æŒ‰ç…§é¡ºåºå®Œæˆã€‚æ¯”å¦‚ï¼Œä¾æ¬¡è¿œç¨‹è¯»å–ä¸€ç»„ URLï¼Œç„¶åæŒ‰ç…§è¯»å–çš„é¡ºåºè¾“å‡ºç»“æœã€‚\nPromise çš„å†™æ³•å¦‚ä¸‹ã€‚\nğŸ“ƒ Example\nclass Response { constructor(text) { this.content = text; } text = () =\u0026gt; this.content; } function fetch(url) { return new Promise(_ =\u0026gt; setTimeout(_, 500, new Response(url)) ); } function logInOrder(urls) { // è¿œç¨‹è¯»å–æ‰€æœ‰URL const textPromises = urls.map(url =\u0026gt; { return fetch(url).then(response =\u0026gt; response.text()); }); let ret = []; // æŒ‰æ¬¡åºè¾“å‡º return textPromises.reduce((chain, textPromise) =\u0026gt; { // Array.reduce((prev, curr) =\u0026gt; {return as prev}), initialValue) // ä½¿ç”¨reduceå°†æ•°ç»„åŒ…è£…æˆPromiseé“¾ return chain.then(() =\u0026gt; textPromise) // \u0026lt;~~ ç”¨äºå°†å†…å±‚Promiseç»“æœè½¬ä¸ºå¤–å±‚Promise // then()æ–¹æ³•çš„å‚æ•° .then(text =\u0026gt; ret.push(text)); }, Promise.resolve()).then(() =\u0026gt; ret); // Promise.resolve().then( // \u0026lt;~~ å¤–å±‚Promiseé€šè¿‡Array.reduce()åŒ…è£¹ // Promise(\u0026#39;fetch\u0026#39;).then(\u0026#39;toString\u0026#39;) // ).then(..)...then(ret) // å¤–å±‚PromiseåŒ…è£¹å†…å±‚Promise // å†…å±‚æ‰§è¡Œå®Œæ¯•åï¼Œå¤–å±‚Promiseè½¬å‘ä¸‹ä¸€ä¸ªthen() } logInOrder([1, 2, 3]).then(console.log); // [ 1, 2, 3 ] ä¸Šé¢ä»£ç ä½¿ç”¨ fetch æ–¹æ³•ï¼ŒåŒæ—¶è¿œç¨‹è¯»å–ä¸€ç»„ URL ã€‚æ¯ä¸ª fetch æ“ä½œéƒ½è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œæ”¾å…¥textPromises æ•°ç»„ã€‚ç„¶åï¼Œreduce æ–¹æ³•ä¾æ¬¡å¤„ç†æ¯ä¸ª Promise å¯¹è±¡ï¼Œç„¶åä½¿ç”¨ then() ï¼Œå°†æ‰€æœ‰ Promise å¯¹è±¡è¿èµ·æ¥ï¼Œå› æ­¤å°±å¯ä»¥ä¾æ¬¡è¾“å‡ºç»“æœã€‚\nè¿™ç§å†™æ³•ä¸å¤ªç›´è§‚ï¼Œå¯è¯»æ€§æ¯”è¾ƒå·®ã€‚ä¸‹é¢æ˜¯ async å‡½æ•°å®ç°ã€‚\nğŸ“ƒ Example\nasync function logInOrder(urls) { for (const url of urls) { const response = await fetch(url); console.log(await response.text()); } } ä¸Šé¢ä»£ç ç¡®å®å¤§å¤§ç®€åŒ–ï¼Œé—®é¢˜æ˜¯æ‰€æœ‰è¿œç¨‹æ“ä½œéƒ½æ˜¯ç»§å‘ã€‚åªæœ‰å‰ä¸€ä¸ª URL è¿”å›ç»“æœï¼Œæ‰ä¼šå»è¯»å–ä¸‹ä¸€ä¸ª URLï¼Œè¿™æ ·åšæ•ˆç‡å¾ˆå·®ï¼Œéå¸¸æµªè´¹æ—¶é—´ã€‚æˆ‘ä»¬éœ€è¦çš„æ˜¯å¹¶å‘å‘å‡ºè¿œç¨‹è¯·æ±‚ã€‚\nğŸ“ƒ Example\nasync function fetch(time) { // async è‡ªåŠ¨è¿”å› Promise() å¯¹è±¡ // è€Œ await å¯ä»¥æ¥å— Promise.then ä¼ é€’çš„å‚æ•° return { then: _ =\u0026gt; setTimeout(() =\u0026gt; { _({text: () =\u0026gt; time}); }, time * 1000) }; } const urls = [1, 5, 2]; async function logInOrder(urls) { // å¹¶å‘è¯»å–è¿œç¨‹URL const textPromises = urls.map(async url =\u0026gt; { const response = await fetch(url); return response.text(); }); // æˆåŠŸå°±è¾“å‡º for (const textPromise of textPromises) { textPromise.then(_ =\u0026gt; console.log(`æˆåŠŸå°±è¾“å‡º: ${_}`)); } // æŒ‰æ¬¡åºè¾“å‡º for (const textPromise of textPromises) { console.log(`æŒ‰æ¬¡åºè¾“å‡º: ${await textPromise}`) } // Promise.all() Promise.all(textPromises) .then(_ =\u0026gt; console.log(`Promise.all: ${_}`)); } logInOrder(urls).then(); setTimeout(() =\u0026gt; console.log(`5s escaped`), 5000); setTimeout(() =\u0026gt; console.log(`5.5s escaped`), 5500); // æˆåŠŸå°±è¾“å‡º: 1 // æŒ‰æ¬¡åºè¾“å‡º: 1 // æˆåŠŸå°±è¾“å‡º: 2 // 5s escaped // æˆåŠŸå°±è¾“å‡º: 5 // æŒ‰æ¬¡åºè¾“å‡º: 5 // æŒ‰æ¬¡åºè¾“å‡º: 2 // Promise.all: 1,5,2 // 5.5s escaped ä¸Šé¢ä»£ç ä¸­ï¼Œè™½ç„¶ map æ–¹æ³•çš„å‚æ•°æ˜¯ async å‡½æ•°ï¼Œä½†å®ƒæ˜¯ å¹¶å‘ æ‰§è¡Œçš„ï¼Œå› ä¸ºåªæœ‰ async å‡½æ•°å†…éƒ¨æ˜¯ ç»§å‘ æ‰§è¡Œï¼Œå¤–éƒ¨ä¸å—å½±å“ã€‚\nåé¢çš„ for-of å¾ªç¯å†…éƒ¨ä½¿ç”¨äº† await ï¼Œå› æ­¤å®ç°äº†æŒ‰é¡ºåºè¾“å‡ºã€‚\nåŒæ ·ä¹Ÿå¯ä»¥ä½¿ç”¨ Promise.all() å®ç°ã€‚\nTop-level await æ ¹æ®è¯­æ³•è§„æ ¼ï¼Œ await å‘½ä»¤åªèƒ½å‡ºç°åœ¨ async å‡½æ•°å†…éƒ¨ï¼Œå¦åˆ™éƒ½ä¼šæŠ¥é”™ã€‚\nğŸ“ƒ Example\n// æŠ¥é”™ const data = await fetch(\u0026#39;https://api.example.com\u0026#39;); ä¸Šé¢ä»£ç ä¸­ï¼Œawait å‘½ä»¤ç‹¬ç«‹ä½¿ç”¨ï¼Œæ²¡æœ‰æ”¾åœ¨ async å‡½æ•°é‡Œé¢ï¼Œå°±ä¼šæŠ¥é”™ã€‚\nES 2021 å¼€å§‹ï¼Œå…è®¸åœ¨æ¨¡å—çš„é¡¶å±‚ç‹¬ç«‹ä½¿ç”¨ await å‘½ä»¤ï¼Œä½¿å¾—ä¸Šé¢é‚£è¡Œä»£ç ä¸ä¼šæŠ¥é”™äº†ã€‚è¿™ä¸ªææ¡ˆçš„ç›®çš„ï¼Œæ˜¯å€Ÿç”¨ await è§£å†³æ¨¡å—å¼‚æ­¥åŠ è½½çš„é—®é¢˜ã€‚\nâŸ¹Â æ²¡æœ‰ Top-level awaitÂ æ—¶ï¼š\nğŸ“ƒ Example\n// awaiting.js let output; async function main() { const dynamic = await import(someMission); // import() const data = await fetch(url); output = someProcess(dynamic.default, data); } main(); export { output }; ä¸Šé¢ä»£ç ä¸­ï¼Œæ¨¡å— awaiting.jsÂ çš„è¾“å‡ºå€¼ outputÂ ï¼Œå–å†³äºå¼‚æ­¥æ“ä½œã€‚æˆ‘ä»¬æŠŠå¼‚æ­¥æ“ä½œåŒ…è£…åœ¨ä¸€ä¸ª async å‡½æ•°é‡Œé¢ï¼Œç„¶åè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œåªæœ‰ç­‰é‡Œé¢çš„å¼‚æ­¥æ“ä½œéƒ½æ‰§è¡Œï¼Œå˜é‡ outputÂ æ‰ä¼šæœ‰å€¼ï¼Œå¦åˆ™å°±è¿”å› undefinedÂ ã€‚\nä¸Šé¢çš„ä»£ç ä¹Ÿå¯ä»¥å†™æˆç«‹å³æ‰§è¡Œå‡½æ•°çš„å½¢å¼ã€‚\nğŸ“ƒ Example\n// awaiting.js let output; (async function main() { const dynamic = await import(someMission); const data = await fetch(url); output = someProcess(dynamic.default, data); })(); export { output }; ä¸‹é¢æ˜¯åŠ è½½è¿™ä¸ªæ¨¡å—çš„å†™æ³•ã€‚\nğŸ“ƒ Example\n// usage.js import { output } from \u0026#34;./awaiting.js\u0026#34;; function outputPlusValue(value) { return output + value } console.log(outputPlusValue(100)); setTimeout(() =\u0026gt; console.log(outputPlusValue(100), 1000); ä¸Šé¢ä»£ç ä¸­ï¼ŒoutputPlusValue()Â çš„æ‰§è¡Œç»“æœï¼Œå®Œå…¨å–å†³äºæ‰§è¡Œçš„æ—¶é—´ã€‚å¦‚æœ awaiting.jsÂ é‡Œé¢çš„å¼‚æ­¥æ“ä½œæ²¡æ‰§è¡Œå®Œï¼ŒåŠ è½½è¿›æ¥çš„ outputÂ çš„å€¼å°±æ˜¯ undefinedÂ ã€‚\nç›®å‰çš„è§£å†³æ–¹æ³•ï¼Œå°±æ˜¯è®©åŸå§‹æ¨¡å—è¾“å‡ºä¸€ä¸ª Promise å¯¹è±¡ï¼Œä»è¿™ä¸ª Promise å¯¹è±¡åˆ¤æ–­å¼‚æ­¥æ“ä½œæœ‰æ²¡æœ‰ç»“æŸã€‚\nğŸ“ƒ Example\n// awaiting.js let output; export default (async function main() { const dynamic = await import(someMission); const data = await fetch(url); output = someProcess(dynamic.default, data); })(); export { output }; ä¸Šé¢ä»£ç ä¸­ï¼Œawaiting.jsÂ é™¤äº†è¾“å‡º outputÂ ï¼Œè¿˜é»˜è®¤è¾“å‡ºä¸€ä¸ª Promise å¯¹è±¡ï¼ˆasync å‡½æ•°ç«‹å³æ‰§è¡Œåï¼Œè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼‰ï¼Œä»è¿™ä¸ªå¯¹è±¡åˆ¤æ–­å¼‚æ­¥æ“ä½œæ˜¯å¦ç»“æŸã€‚\nä¸‹é¢æ˜¯åŠ è½½è¿™ä¸ªæ¨¡å—çš„æ–°çš„å†™æ³•ã€‚\nğŸ“ƒ Example\n// usage.js import promise, { output } from \u0026#34;./awaiting.js\u0026#34;; function outputPlusValue(value) { return output + value } promise.then(() =\u0026gt; { console.log(outputPlusValue(100)); setTimeout(() =\u0026gt; console.log(outputPlusValue(100), 1000); }); ä¸Šé¢ä»£ç ä¸­ï¼Œå°† awaiting.jsÂ å¯¹è±¡çš„è¾“å‡ºï¼Œæ”¾åœ¨ promise.then()Â é‡Œé¢ï¼Œè¿™æ ·å°±èƒ½ä¿è¯å¼‚æ­¥æ“ä½œå®Œæˆä»¥åï¼Œæ‰å»è¯»å– outputÂ ã€‚\nè¿™ç§å†™æ³•æ¯”è¾ƒéº»çƒ¦ï¼Œç­‰äºè¦æ±‚æ¨¡å—çš„ä½¿ç”¨è€…éµå®ˆä¸€ä¸ªé¢å¤–çš„ä½¿ç”¨åè®®ï¼ŒæŒ‰ç…§ç‰¹æ®Šçš„æ–¹æ³•ä½¿ç”¨è¿™ä¸ªæ¨¡å—ã€‚ä¸€æ—¦ä½ å¿˜äº†è¦ç”¨ Promise åŠ è½½ï¼Œåªä½¿ç”¨æ­£å¸¸çš„åŠ è½½æ–¹æ³•ï¼Œä¾èµ–è¿™ä¸ªæ¨¡å—çš„ä»£ç å°±å¯èƒ½å‡ºé”™ã€‚è€Œä¸”ï¼Œå¦‚æœä¸Šé¢çš„ usage.jsÂ åˆæœ‰å¯¹å¤–çš„è¾“å‡ºï¼Œç­‰äºè¿™ä¸ªä¾èµ–é“¾çš„æ‰€æœ‰æ¨¡å—éƒ½è¦ä½¿ç”¨ Promise åŠ è½½ã€‚\nâŸ¹ å¼•å…¥ Top-level awaitï¼š\né¡¶å±‚çš„ await å‘½ä»¤ï¼Œå°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å®ƒä¿è¯åªæœ‰å¼‚æ­¥æ“ä½œå®Œæˆï¼Œæ¨¡å—æ‰ä¼šè¾“å‡ºå€¼ã€‚\nğŸ“ƒ Example\n// awaiting.js const dynamic = import(someMission); const data = fetch(url); export const output = someProcess((await dynamic).default, await data); ä¸Šé¢ä»£ç ä¸­ï¼Œä¸¤ä¸ªå¼‚æ­¥æ“ä½œåœ¨è¾“å‡ºçš„æ—¶å€™ï¼Œéƒ½åŠ ä¸Šäº† await å‘½ä»¤ã€‚åªæœ‰ç­‰åˆ°å¼‚æ­¥æ“ä½œå®Œæˆï¼Œè¿™ä¸ªæ¨¡å—æ‰ä¼šè¾“å‡ºå€¼ã€‚\nåŠ è½½è¿™ä¸ªæ¨¡å—çš„å†™æ³•å¦‚ä¸‹ã€‚\nğŸ“ƒ Example\n// usage.js import { output } from \u0026#34;./awaiting.js\u0026#34;; function outputPlusValue(value) { return output + value } console.log(outputPlusValue(100)); setTimeout(() =\u0026gt; console.log(outputPlusValue(100), 1000); ä¸Šé¢ä»£ç çš„å†™æ³•ï¼Œä¸æ™®é€šçš„æ¨¡å—åŠ è½½å®Œå…¨ä¸€æ ·ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¨¡å—çš„ä½¿ç”¨è€…å®Œå…¨ä¸ç”¨å…³å¿ƒï¼Œä¾èµ–æ¨¡å—çš„å†…éƒ¨æœ‰æ²¡æœ‰å¼‚æ­¥æ“ä½œï¼Œæ­£å¸¸åŠ è½½å³å¯ã€‚\nè¿™æ—¶ï¼Œæ¨¡å—çš„åŠ è½½ä¼šç­‰å¾…ä¾èµ–æ¨¡å—ï¼ˆä¸Šä¾‹æ˜¯ awaiting.jsÂ ï¼‰çš„å¼‚æ­¥æ“ä½œå®Œæˆï¼Œæ‰æ‰§è¡Œåé¢çš„ä»£ç ï¼Œæœ‰ç‚¹åƒæš‚åœåœ¨é‚£é‡Œã€‚æ‰€ä»¥ï¼Œå®ƒæ€»æ˜¯ä¼šå¾—åˆ°æ­£ç¡®çš„ outputÂ ï¼Œä¸ä¼šå› ä¸ºåŠ è½½æ—¶æœºçš„ä¸åŒï¼Œè€Œå¾—åˆ°ä¸ä¸€æ ·çš„å€¼ã€‚\næ³¨æ„ï¼Œé¡¶å±‚ await åªèƒ½ç”¨åœ¨ ES6 æ¨¡å—ï¼Œä¸èƒ½ç”¨åœ¨ CommonJS æ¨¡å—ã€‚è¿™æ˜¯å› ä¸º CommonJS æ¨¡å—çš„ require()Â æ˜¯åŒæ­¥åŠ è½½ï¼Œå¦‚æœæœ‰é¡¶å±‚ await ï¼Œå°±æ²¡æ³•å¤„ç†åŠ è½½äº†ã€‚\nä¸‹é¢æ˜¯é¡¶å±‚ await çš„ä¸€äº›ä½¿ç”¨åœºæ™¯ã€‚\n// import() æ–¹æ³•åŠ è½½ const strings = await import(`/i18n/${navigator.language}`); // æ•°æ®åº“æ“ä½œ const connection = await dbConnector(); // ä¾èµ–å›æ»š let jQuery; try { jQuery = await import(\u0026#39;https://cdn-a.com/jQuery\u0026#39;); } catch { jQuery = await import(\u0026#39;https://cdn-b.com/jQuery\u0026#39;); } æ³¨æ„ï¼Œå¦‚æœåŠ è½½å¤šä¸ªåŒ…å«é¡¶å±‚ await å‘½ä»¤çš„æ¨¡å—ï¼ŒåŠ è½½å‘½ä»¤æ˜¯åŒæ­¥æ‰§è¡Œçš„ã€‚\nğŸ“ƒ Example\n/* x.js */ console.log(\u0026#39;before await\u0026#39;); await new Promise(r =\u0026gt; setTimeout(r, 1000)); console.log(\u0026#39;after await\u0026#39;); /* y.js */ console.log(\u0026#39;module Y\u0026#39;); /* z.js */ import \u0026#34;./x.js\u0026#34;; import \u0026#34;./y.js\u0026#34;; console.log(\u0026#39;module Z\u0026#39;); // module X // before await // module Y // after await // module Z è¿™è¯´æ˜ï¼Œz.jsÂ å¹¶æ²¡æœ‰ç­‰å¾… x.jsÂ åŠ è½½å®Œæˆï¼Œå†å»åŠ è½½ y.jsã€‚\nsequenceDiagram %%{ init: { \u0026#34;sequence\u0026#34;: { \u0026#34;width\u0026#34;: 100, \u0026#34;height\u0026#34;: 30, \u0026#34;useMaxWidth\u0026#34;: false, \u0026#34;showSequenceNumbers\u0026#34;: true } } }%% participant P as Promise participant X as Module X participant Y as Module Y participant Z as Module Z Z -\u0026gt;\u0026gt; +X: import X X --\u0026gt;\u0026gt; X: log â†’ \u0026#34;module X\u0026#34; X --\u0026gt;\u0026gt; X: log â†’ \u0026#34;before await\u0026#34; X -\u0026gt;\u0026gt; +P: await Promise P --\u0026gt;\u0026gt; Z: Z -\u0026gt;\u0026gt; +Y: import Y Y --\u0026gt;\u0026gt; Y: log â†’ \u0026#34;module Y\u0026#34; Y -\u0026gt;\u0026gt; -Z: return Y Z --\u0026gt;\u0026gt; P: P -\u0026gt;\u0026gt; X: timeout X --\u0026gt;\u0026gt; X: log â†’ \u0026#34;after await\u0026#34; X -\u0026gt;\u0026gt; -Z: return X Z --\u0026gt;\u0026gt; Z: log â†’ \u0026#34;module Z\u0026#34; é¡¶å±‚çš„ await å‘½ä»¤æœ‰ç‚¹åƒï¼Œäº¤å‡ºä»£ç çš„æ‰§è¡Œæƒç»™å…¶ä»–çš„æ¨¡å—åŠ è½½ï¼Œç­‰å¼‚æ­¥æ“ä½œå®Œæˆåï¼Œå†æ‹¿å›æ‰§è¡Œæƒï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œï¼ˆç±»ä¼¼äºéå®æ—¶çš„ä¸­æ–­ï¼‰ã€‚\nClass æœ¬è´¨ å¯¹è±¡ åœ¨ JS ä¸­ï¼Œä¸‡ç‰©çš†å¯¹è±¡ï¼Œå¯¹è±¡åˆåˆ†ä¸ºæ™®é€šå¯¹è±¡å’Œå‡½æ•°å¯¹è±¡ï¼Œå…¶ä¸­ Objectã€Function ä¸º JS è‡ªå¸¦çš„å‡½æ•°å¯¹è±¡ã€‚\nå‡¡æ˜¯é€šè¿‡ new Function() åˆ›å»ºçš„å¯¹è±¡éƒ½æ˜¯ å‡½æ•°å¯¹è±¡ ï¼Œå…¶ä»–çš„éƒ½æ˜¯æ™®é€šå¯¹è±¡ï¼ŒFunction Object æ˜¯é€šè¿‡ New Function() åˆ›å»ºçš„ã€‚\n:memo: Note è¯­æ³•ç³–å¯¹æ¢\nlet arr = [] /* \u0026lt;== */ let arr = new Array() let obj = {} /* \u0026lt;== */ let obj = new Object() function fun(){} /* \u0026lt;== */ var fun = new Function() å¯ä»¥ä½¿ç”¨ instanceof åˆ¤æ–­ä¸€ä¸ª å‡½æ•°function / ç±»*^class^* æ˜¯å¦ä¸ºä¸€ä¸ª å˜é‡*^variable^* çš„æ„é€ å‡½æ•°ã€‚ æ„é€ å‡½æ•° JavaScript è¯­è¨€ä¸­ï¼Œç”Ÿæˆå®ä¾‹å¯¹è±¡çš„ä¼ ç»Ÿæ–¹æ³•æ˜¯é€šè¿‡ [æ„é€ å‡½æ•°](05 JavaScript#construct-es5) ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚\nğŸ“ƒ Example\nfunction Point(x, y) { this.x = x; this.y = y; } Point.prototype.toString = function () { return \u0026#39;(\u0026#39; + this.x + \u0026#39;, \u0026#39; + this.y + \u0026#39;)\u0026#39;; }; var p = new Point(1, 2); ä¸Šé¢è¿™ç§å†™æ³•è·Ÿä¼ ç»Ÿçš„é¢å‘å¯¹è±¡è¯­è¨€ï¼ˆæ¯”å¦‚ C++ å’Œ Javaï¼‰å·®å¼‚å¾ˆå¤§ï¼Œå¾ˆå®¹æ˜“è®©æ–°å­¦ä¹ è¿™é—¨è¯­è¨€çš„ç¨‹åºå‘˜æ„Ÿåˆ°å›°æƒ‘ã€‚\nES6 æä¾›äº†æ›´æ¥è¿‘ä¼ ç»Ÿè¯­è¨€çš„å†™æ³•ï¼Œå¼•å…¥äº† Class è¿™ä¸ªæ¦‚å¿µï¼Œä½œä¸ºå¯¹è±¡çš„æ¨¡æ¿ã€‚é€šè¿‡ class å…³é”®å­—ï¼Œå¯ä»¥å®šä¹‰ç±»ã€‚\nåŸºæœ¬ä¸Šï¼ŒES6 çš„ class å¯ä»¥çœ‹ä½œä¸€ä¸ª è¯­æ³•ç³– ï¼Œå®ƒçš„ç»å¤§éƒ¨åˆ†åŠŸèƒ½ï¼ŒES5 éƒ½å¯ä»¥åšåˆ°ï¼Œæ–°çš„ class å†™æ³•åªæ˜¯è®©å¯¹è±¡åŸå‹çš„å†™æ³•æ›´åŠ æ¸…æ™°ã€æ›´åƒé¢å‘å¯¹è±¡ç¼–ç¨‹çš„è¯­æ³•è€Œå·²ã€‚\n:memo: Note JavaScript çš„ç±»ä»ç„¶æ˜¯åŸºäº prototype çš„ã€‚ä¸Šé¢çš„ä»£ç ç”¨ ES6 çš„ class æ”¹å†™ï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·ã€‚\nğŸ“ƒ Example\nclass Point { constructor(x, y) { this.x = x; this.y = y; } toString() { return `(${this.x}, ${this.y})`; } } ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ªâ€œç±»â€ï¼Œå¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰ä¸€ä¸ª constructor æ–¹æ³•ï¼Œè¿™å°±æ˜¯æ„é€ æ–¹æ³•ï¼Œè€Œ this å…³é”®å­—åˆ™ä»£è¡¨å®ä¾‹å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒES5 çš„æ„é€ å‡½æ•° Point ï¼Œå¯¹åº” ES6 çš„ Point ç±»çš„æ„é€ æ–¹æ³•ã€‚\nPoint ç±»é™¤äº†æ„é€ æ–¹æ³•ï¼Œè¿˜å®šä¹‰äº†ä¸€ä¸ª toString æ–¹æ³•ã€‚æ³¨æ„ï¼Œå®šä¹‰â€œç±»â€çš„æ–¹æ³•çš„æ—¶å€™ï¼Œå‰é¢ä¸éœ€è¦åŠ ä¸Š function è¿™ä¸ªå…³é”®å­—ï¼Œç›´æ¥æŠŠå‡½æ•°å®šä¹‰æ”¾è¿›å»äº†å°±å¯ä»¥äº†ã€‚å¦å¤–ï¼Œæ–¹æ³•ä¹‹é—´ä¸éœ€è¦ é€—å· åˆ†éš”ï¼ŒåŠ äº†ä¼šæŠ¥é”™ã€‚\nES6 çš„ç±»ï¼Œå®Œå…¨å¯ä»¥çœ‹ä½œ æ„é€ å‡½æ•° çš„å¦ä¸€ç§å†™æ³•ã€‚\nğŸ“ƒ Example\nclass Point { // ... } typeof Point // \u0026#34;function\u0026#34; Point === Point.prototype.constructor // true ä¸Šé¢ä»£ç è¡¨æ˜ï¼Œç±»çš„æ•°æ®ç±»å‹å°±æ˜¯å‡½æ•°ï¼Œç±»æœ¬èº«å°±æŒ‡å‘æ„é€ å‡½æ•°ã€‚\nä½¿ç”¨çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯ç›´æ¥å¯¹ç±»ä½¿ç”¨ new å‘½ä»¤ï¼Œè·Ÿæ„é€ å‡½æ•°çš„ç”¨æ³•å®Œå…¨ä¸€è‡´ã€‚\nğŸ“ƒ Example\nclass Bar { doStuff() { console.log(\u0026#39;stuff\u0026#39;); } } const b = new Bar(); b.doStuff(); // \u0026#34;stuff\u0026#34; æ„é€ å‡½æ•°çš„ prototype å±æ€§ï¼Œåœ¨ ES6 çš„â€œç±»â€ä¸Šé¢ç»§ç»­å­˜åœ¨ã€‚äº‹å®ä¸Šï¼Œç±»çš„æ‰€æœ‰æ–¹æ³•éƒ½å®šä¹‰åœ¨ç±»çš„ prototype å±æ€§ä¸Šé¢ã€‚\nclass Point { constructor() { // ... } toString() { // ... } toValue() { // ... } } // ç­‰åŒäº Point.prototype = { constructor() {}, toString() {}, toValue() {}, }; åœ¨ç±»çš„å®ä¾‹ä¸Šé¢è°ƒç”¨æ–¹æ³•ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨ åŸå‹prototype ä¸Šçš„æ–¹æ³•ã€‚\nğŸ“ƒ Example\nclass B {} let b = new B(); b.constructor === B.prototype.constructor // true ä¸Šé¢ä»£ç ä¸­ï¼Œbæ˜¯B ç±»çš„å®ä¾‹ï¼Œå®ƒçš„ constructor æ–¹æ³•å°±æ˜¯ B ç±»åŸå‹çš„ constructor æ–¹æ³•ã€‚\nç”±äºç±»çš„æ–¹æ³•éƒ½å®šä¹‰åœ¨ prototype å¯¹è±¡ä¸Šé¢ï¼Œæ‰€ä»¥ç±»çš„æ–°æ–¹æ³•å¯ä»¥æ·»åŠ åœ¨ prototype å¯¹è±¡ä¸Šé¢ã€‚Object.assignæ–¹æ³•å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ä¸€æ¬¡å‘ç±»æ·»åŠ å¤šä¸ªæ–¹æ³•ã€‚\nğŸ“ƒ Example\nclass Point { constructor() { // ... } } Object.assign(Point.prototype, { toString() {}, toValue() {} }); prototype å¯¹è±¡çš„ constructor å±æ€§ï¼Œç›´æ¥æŒ‡å‘â€œç±»â€çš„æœ¬èº«ï¼Œè¿™ä¸ ES5 çš„è¡Œä¸ºæ˜¯ä¸€è‡´çš„ã€‚\nPoint.prototype.constructor === Point // true :warning: Warning ç±»çš„å†…éƒ¨æ‰€æœ‰å®šä¹‰çš„æ–¹æ³•ï¼Œéƒ½æ˜¯ ä¸å¯æšä¸¾non-enumerable çš„ã€‚\nğŸ“ƒ Example\nclass Point { constructor(x, y) { // ... } toString() { // ... } } console.log( Object.keys(Point.prototype), // [] Object.getOwnPropertyNames(Point.prototype) // [\u0026#34;constructor\u0026#34;,\u0026#34;toString\u0026#34;] ); ä¸Šé¢ä»£ç ä¸­ï¼ŒtoStringæ–¹æ³•æ˜¯ Point ç±»å†…éƒ¨å®šä¹‰çš„æ–¹æ³•ï¼Œå®ƒæ˜¯ ä¸å¯æšä¸¾ çš„ã€‚è¿™ä¸€ç‚¹ä¸ ES5 çš„è¡Œä¸ºä¸ä¸€è‡´ã€‚\nğŸ“ƒ Example\nconst Point = function (x, y) { // ... }; Point.prototype.toString = function () { // ... }; /* è‡ªåŠ¨ç”Ÿæˆç›¸åº”çš„constructoræ–¹æ³• */ console.log( Object.keys(Point.prototype), // [\u0026#34;toString\u0026#34;] Object.getOwnPropertyNames(Point.prototype) // [\u0026#34;constructor\u0026#34;,\u0026#34;toString\u0026#34;] ); ä¸Šé¢ä»£ç è‹¥é‡‡ç”¨ ES5 çš„å†™æ³•ï¼ŒtoString() æ–¹æ³•å°±æ˜¯ å¯æšä¸¾ çš„ã€‚\nConstructor constructor æ–¹æ³•æ˜¯ç±»çš„é»˜è®¤æ–¹æ³•ï¼Œé€šè¿‡ new å‘½ä»¤ç”Ÿæˆå¯¹è±¡å®ä¾‹æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ã€‚ä¸€ä¸ªç±»å¿…é¡»æœ‰ constructor æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼å®šä¹‰ï¼Œä¸€ä¸ªç©ºçš„ constructor æ–¹æ³•ä¼šè¢«é»˜è®¤æ·»åŠ ã€‚\nğŸ“ƒ Example\nclass Point { } // ç­‰åŒäº class Point { constructor() { } } ä¸Šé¢ä»£ç ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªç©ºçš„ç±» Point ï¼ŒJavaScript å¼•æ“ä¼šè‡ªåŠ¨ä¸ºå®ƒæ·»åŠ ä¸€ä¸ªç©ºçš„ constructor æ–¹æ³•ã€‚\nconstructor æ–¹æ³•é»˜è®¤è¿”å›å®ä¾‹å¯¹è±¡ï¼ˆå³ this ï¼‰ï¼Œå®Œå…¨å¯ä»¥æŒ‡å®šè¿”å›å¦å¤–ä¸€ä¸ªå¯¹è±¡ã€‚\n:memo: Note å¯¹äºå¼•ç”¨ç±»å‹æ¥è¯´ constructor å±æ€§å€¼æ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œä½†æ˜¯å¯¹äºåŸºæœ¬ç±»å‹æ¥è¯´æ˜¯åªè¯»çš„ã€‚\n:warning: Caution JS å¯¹äºä¸å¯å†™çš„å±æ€§å€¼çš„ä¿®æ”¹ é™é»˜å¤±è´¥silently failedï¼Œä½†åªä¼šåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹æ‰ä¼šæç¤ºé”™è¯¯ã€‚\nğŸ“ƒ Example\nclass Foo { constructor() { return Object.create(null); } } console.log(new Foo() instanceof Foo); // false ä¸Šé¢ä»£ç ä¸­ï¼Œ constructor å‡½æ•°è¿”å›ä¸€ä¸ª å…¨æ–° çš„å¯¹è±¡ï¼Œç»“æœå¯¼è‡´å®ä¾‹å¯¹è±¡ä¸æ˜¯ Foo ç±»çš„å®ä¾‹ã€‚\nç±»å¿…é¡»ä½¿ç”¨ new è°ƒç”¨ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å®ƒè·Ÿæ™®é€šæ„é€ å‡½æ•°çš„ä¸€ä¸ªä¸»è¦åŒºåˆ«ï¼Œåè€…ä¸ç”¨ new ä¹Ÿå¯ä»¥æ‰§è¡Œã€‚\nclass Foo { constructor() { return Object.create(null); } } Foo(); // TypeError: Class constructor Foo cannot be invoked without \u0026#39;new\u0026#39; function Bar(){ return Object.create(null); } Bar(); // OK å®ä¾‹å±æ€§ å®ä¾‹å±æ€§é™¤äº†å®šä¹‰åœ¨ constructor() æ–¹æ³•é‡Œé¢çš„ this ä¸Šé¢ï¼Œä¹Ÿå¯ä»¥å®šä¹‰åœ¨ç±»çš„æœ€é¡¶å±‚ã€‚\nğŸ“ƒ Example\nclass IncreasingCounter { constructor() { this._count = 0; } get value() { console.log(\u0026#39;Getting the current value!\u0026#39;); return this._count; } increment() { this._count++; } } ä¸Šé¢ä»£ç ä¸­ï¼Œå®ä¾‹å±æ€§ this._count å®šä¹‰åœ¨ constructor() æ–¹æ³•é‡Œé¢ã€‚å¦ä¸€ç§å†™æ³•æ˜¯ï¼Œè¿™ä¸ªå±æ€§ä¹Ÿå¯ä»¥å®šä¹‰åœ¨ç±»çš„ æœ€é¡¶å±‚ ï¼Œå…¶ä»–éƒ½ä¸å˜ã€‚\nğŸ“ƒ Example\nclass IncreasingCounter { _count = 0; get value() { console.log(\u0026#39;Getting the current value!\u0026#39;); return this._count; } increment() { this._count++; } } ä¸Šé¢ä»£ç ä¸­ï¼Œå®ä¾‹å±æ€§ _count ä¸å–å€¼å‡½æ•° value() å’Œ increment() æ–¹æ³•ï¼Œå¤„äºåŒä¸€ä¸ªå±‚çº§ã€‚è¿™æ—¶ï¼Œä¸éœ€è¦åœ¨å®ä¾‹å±æ€§å‰é¢åŠ ä¸Š this ã€‚\n:warning: Warning æ­¤æ—¶ this æŒ‡çš„æ˜¯ new å‡ºæ¥çš„å¯¹è±¡ã€‚\nclass This { newThis = this; static classThis = this; } let thisC = new This(); console.log( thisC.newThis === thisC, // true This.classThis === This // true ); è¿™ç§æ–°å†™æ³•çš„å¥½å¤„æ˜¯ï¼Œæ‰€æœ‰å®ä¾‹å¯¹è±¡è‡ªèº«çš„å±æ€§éƒ½å®šä¹‰åœ¨ç±»çš„å¤´éƒ¨ï¼Œçœ‹ä¸Šå»æ¯”è¾ƒæ•´é½ï¼Œä¸€çœ¼å°±èƒ½çœ‹å‡ºè¿™ä¸ªç±»æœ‰å“ªäº›å®ä¾‹å±æ€§ã€‚\nğŸ“ƒ Example\nclass foo { bar = \u0026#39;hello\u0026#39;; baz = \u0026#39;world\u0026#39;; constructor() { // ... } } ä¸Šé¢çš„ä»£ç ï¼Œä¸€çœ¼å°±èƒ½çœ‹å‡ºï¼Œfoo ç±»æœ‰ä¸¤ä¸ªå®ä¾‹å±æ€§ï¼Œä¸€ç›®äº†ç„¶ã€‚å¦å¤–ï¼Œå†™èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€æ´ã€‚\nåˆ›å»º ç”Ÿæˆç±»çš„å®ä¾‹çš„å†™æ³•ï¼Œä¸ ES5 å®Œå…¨ä¸€æ ·ï¼Œä¹Ÿæ˜¯ä½¿ç”¨ new å‘½ä»¤ã€‚å‰é¢è¯´è¿‡ï¼Œå¦‚æœå¿˜è®°åŠ ä¸Š new ï¼Œåƒå‡½æ•°é‚£æ ·è°ƒç”¨ class ï¼Œå°†ä¼šæŠ¥é”™ã€‚\nclass Point { // ... } // æŠ¥é”™ var point = Point(2, 3); // æ­£ç¡® var point = new Point(2, 3); ä¸ ES5 ä¸€æ ·ï¼Œå®ä¾‹çš„å±æ€§é™¤éæ˜¾å¼å®šä¹‰åœ¨å…¶æœ¬èº«ï¼ˆå³å®šä¹‰åœ¨ this å¯¹è±¡ä¸Šï¼‰ï¼Œå¦åˆ™éƒ½æ˜¯å®šä¹‰åœ¨ åŸå‹prototype ä¸Šï¼ˆå³å®šä¹‰åœ¨ class ä¸Šï¼‰ã€‚\nğŸ“ƒ Example\n//å®šä¹‰ç±» class Point { constructor(x, y) { this.x = x; this.y = y; } toString() { return \u0026#39;(\u0026#39; + this.x + \u0026#39;, \u0026#39; + this.y + \u0026#39;)\u0026#39;; } } const point = new Point(2, 3); point.toString(); // (2, 3) point.hasOwnProperty(\u0026#39;x\u0026#39;); // true point.hasOwnProperty(\u0026#39;y\u0026#39;); // true point.hasOwnProperty(\u0026#39;toString\u0026#39;); // false point.__proto__.hasOwnProperty(\u0026#39;toString\u0026#39;); // true ä¸Šé¢ä»£ç ä¸­ï¼Œx å’Œ y éƒ½æ˜¯å®ä¾‹å¯¹è±¡ Point è‡ªèº«çš„å±æ€§ï¼ˆå› ä¸ºå®šä¹‰åœ¨ this å˜é‡ä¸Šï¼‰ï¼Œæ‰€ä»¥ hasOwnProperty æ–¹æ³•è¿”å› true ï¼Œè€Œ toString æ˜¯åŸå‹å¯¹è±¡çš„å±æ€§ï¼ˆå› ä¸ºå®šä¹‰åœ¨ Point ç±»ä¸Šï¼‰ï¼Œæ‰€ä»¥ hasOwnProperty æ–¹æ³•è¿”å› false ã€‚è¿™äº›éƒ½ä¸ ES5 çš„è¡Œä¸ºä¿æŒä¸€è‡´ã€‚\nä¸ ES5 ä¸€æ ·ï¼Œç±»çš„æ‰€æœ‰å®ä¾‹å…±äº« åŒä¸€ä¸ª åŸå‹å¯¹è±¡ã€‚\nğŸ“ƒ Example\nclass Point{} let p1 = new Point(2, 3); let p2 = new Point(3, 2); console.log(Object.getPrototypeOf(p1) === Object.getPrototypeOf(p2)); //true ä¸Šé¢ä»£ç ä¸­ï¼Œ p1 å’Œ p2 éƒ½æ˜¯ Point çš„å®ä¾‹ï¼Œå®ƒä»¬çš„åŸå‹éƒ½æ˜¯Point.prototypeï¼Œæ‰€ä»¥ __proto__ å±æ€§æ˜¯ç›¸ç­‰çš„ã€‚\nè¿™ä¹Ÿæ„å‘³ç€ï¼Œå¯ä»¥é€šè¿‡å®ä¾‹çš„ __proto__ å±æ€§ä¸ºâ€œç±»â€æ·»åŠ æ–¹æ³•ã€‚\n:link: Href [ES5](05 JavaScript#proto-es5)\n:memo: Note\n__proto__ å¹¶ä¸æ˜¯è¯­è¨€æœ¬èº«çš„ç‰¹æ€§ï¼Œè¿™æ˜¯å„å¤§å‚å•†å…·ä½“å®ç°æ—¶æ·»åŠ çš„ç§æœ‰å±æ€§ï¼Œè™½ç„¶ç›®å‰å¾ˆå¤šç°ä»£æµè§ˆå™¨çš„ JS å¼•æ“ä¸­éƒ½æä¾›äº†è¿™ä¸ªç§æœ‰å±æ€§ï¼Œä½†ä¾æ—§ä¸å»ºè®®åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨è¯¥å±æ€§ï¼Œé¿å…å¯¹ç¯å¢ƒäº§ç”Ÿä¾èµ–ã€‚ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Reflect.getPrototypeOf() æ–¹æ³•æ¥è·å–å®ä¾‹å¯¹è±¡çš„åŸå‹ï¼Œç„¶åå†æ¥ä¸ºåŸå‹æ·»åŠ æ–¹æ³•/å±æ€§ã€‚\n^*^ ä¼¼ä¹ __proto__ å±æ€§å¯ä»¥è¢«ç»§æ‰¿ï¼Œä½† Reflect.getPrototypeOf() å¹¶ä¸èƒ½ç›´æ¥è¢«ç»§æ‰¿ï¼Œéœ€è¦ä½¿ç”¨ Object.create() ï¼ŒåŸå› æœªçŸ¥ã€‚\nğŸ“ƒ Example\nclass Point {} let p1 = new Point(2, 3); let p2 = new Point(3, 2); p1.__proto__.printName = () =\u0026gt; console.log(\u0026#39;Oops\u0026#39;) // __proto__æ–¹æ³•å¯ä»¥ç›´æ¥ä¿®æ”¹åˆ°åŸå‹é“¾ // ä½†WebStromæ— æ³•æ­£ç¡®è¯†åˆ«ä¿®æ”¹çš„å†…å®¹ p1.printName() // \u0026#34;Oops\u0026#34; p2.printName() // \u0026#34;Oops\u0026#34; let p3 = new Point(4, 2); p3.printName() // \u0026#34;Oops\u0026#34; ä¸Šé¢ä»£ç åœ¨ p1 çš„åŸå‹ä¸Šæ·»åŠ äº†ä¸€ä¸ªprintNameæ–¹æ³•ï¼Œç”±äº p1 çš„åŸå‹å°±æ˜¯ p2 çš„åŸå‹ï¼Œå› æ­¤ p2 ä¹Ÿå¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚è€Œä¸”ï¼Œæ­¤åæ–°å»ºçš„å®ä¾‹ p3 ä¹Ÿå¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚\nğŸ§ª Experimental\nä½¿ç”¨ Reflect.setProtypeOf() ä¿®æ”¹å…·ä½“ç»§æ‰¿çš„ç±»ï¼š\nclass Point {} let p1 = new Point(0, 1); Reflect.setPrototypeOf(p1, { printName: () =\u0026gt; console.log(\u0026#39;Oops\u0026#39;) }); let p2 = new Point(2, 3); p1.printName(); // \u0026#34;Oops\u0026#34; try { p2.printName(); } catch (e) { console.error(e.toString()); // TypeError: p2.printName is not a function } let p3 = Object.create(p1); p3.printName(); //Oops ä½¿ç”¨ prototype ä¿®æ”¹åŸå‹ Point ï¼š\n:memo: Note prototype æ˜¯ æ„é€ å‡½æ•°Constructor ç‰¹æœ‰ çš„å±æ€§ï¼Œå®ƒçš„å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«çš„æ˜¯æ„é€ å‡½æ•°æƒ³è¦å…±äº«çš„å±æ€§å’Œæ–¹æ³•ã€‚\nclass Point {} let p1 = new Point(2, 3); let p2 = new Point(3, 2); Point.prototype.printName = () =\u0026gt; // å¯ä»¥åœ¨äº‹åé€šè¿‡prototypeå±æ€§ä¿®æ”¹Pointçš„åŸå‹ console.log(\u0026#39;Oops\u0026#39;) p1.printName() // \u0026#34;Oops\u0026#34; p2.printName() // \u0026#34;Oops\u0026#34; let p3 = new Point(4, 2); p3.printName() // \u0026#34;Oops\u0026#34; è¿™æ„å‘³ç€ï¼Œä½¿ç”¨å®ä¾‹çš„ __proto__ å±æ€§æ”¹å†™åŸå‹ï¼Œå¿…é¡»ç›¸å½“è°¨æ…ï¼Œä¸æ¨èä½¿ç”¨ï¼Œå› ä¸ºè¿™ä¼šæ”¹å˜â€œç±»â€çš„åŸå§‹å®šä¹‰ï¼Œå½±å“åˆ°æ‰€æœ‰å®ä¾‹ã€‚\nå­˜å–æ‹¦æˆª ä¸ ES5 ä¸€æ ·ï¼Œåœ¨â€œç±»â€çš„å†…éƒ¨å¯ä»¥ä½¿ç”¨ get å’Œ set å…³é”®å­—ï¼Œå¯¹æŸä¸ªå±æ€§è®¾ç½® å­˜å€¼å‡½æ•°getter å’Œ å–å€¼å‡½æ•°setter ï¼Œæ‹¦æˆªè¯¥å±æ€§çš„å­˜å–è¡Œä¸ºã€‚\nğŸ“ƒ Example\nclass MyClass { get prop() { console.log(\u0026#39;getter...\u0026#39;); } set prop(value) { console.log(\u0026#39;setter: \u0026#39; + value); } } let inst = new MyClass(); inst.prop = 123; // setter: 123 inst.prop; // getter... ä¸Šé¢ä»£ç ä¸­ï¼Œprop å±æ€§æœ‰å¯¹åº”çš„å­˜å€¼å‡½æ•°å’Œå–å€¼å‡½æ•°ï¼Œå› æ­¤èµ‹å€¼å’Œè¯»å–è¡Œä¸ºéƒ½è¢«è‡ªå®šä¹‰äº†ã€‚\nå­˜å€¼å‡½æ•°å’Œå–å€¼å‡½æ•°æ˜¯è®¾ç½®åœ¨å±æ€§çš„ Descriptor å¯¹è±¡ä¸Šçš„ã€‚\nğŸ“ƒ Example\nclass CustomHTMLElement { constructor(element) { this.element = element; } get html() { return this.element.innerHTML; } set html(value) { this.element.innerHTML = value; } } const descriptor = Reflect.getOwnPropertyDescriptor( CustomHTMLElement.prototype, \u0026#34;html\u0026#34; ); console.log( descriptor, // { // get: [Function: get html], // set: [Function: set html], // enumerable: false, /* ES6ä¸­é»˜è®¤ç±»çš„æ‰€æœ‰æˆå‘˜æ–¹æ³•éƒ½æ˜¯ä¸å¯æšä¸¾çš„ */ // configurable: true // } \u0026#34;get\u0026#34; in descriptor, // true \u0026#34;set\u0026#34; in descriptor // true ); ä¸Šé¢ä»£ç ä¸­ï¼Œå­˜å€¼å‡½æ•°å’Œå–å€¼å‡½æ•°æ˜¯å®šä¹‰åœ¨ html å±æ€§çš„æè¿°å¯¹è±¡ä¸Šé¢ï¼Œè¿™ä¸ ES5 å®Œå…¨ä¸€è‡´ã€‚\nè¡¨è¾¾å¼è¡¨ç¤ºæ³• å±æ€§ ç±»çš„å±æ€§åï¼Œå¯ä»¥é‡‡ç”¨è¡¨è¾¾å¼ã€‚\nğŸ“ƒ Example\nlet methodName = \u0026#39;getArea\u0026#39;; class Square { constructor(length) { // ... } [methodName]() { // ... } } ä¸Šé¢ä»£ç ä¸­ï¼ŒSquare ç±»çš„æ–¹æ³•å getArea ï¼Œæ˜¯ä»è¡¨è¾¾å¼å¾—åˆ°çš„ã€‚\nç±»å ä¸å‡½æ•°ä¸€æ ·ï¼Œç±»ä¹Ÿå¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼çš„å½¢å¼å®šä¹‰ã€‚\nğŸ“ƒ Example\nconst MyClass = class Me { name = \u0026#39;Me\u0026#39;; getClassName() { return Me.name; } } ä¸Šé¢ä»£ç ä½¿ç”¨è¡¨è¾¾å¼å®šä¹‰äº†ä¸€ä¸ªç±»ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªç±»çš„åå­—æ˜¯ Me ï¼Œä½†æ˜¯ Me åªåœ¨ Class çš„ å†…éƒ¨ å¯ç”¨ï¼ŒæŒ‡ä»£å½“å‰ç±»ã€‚åœ¨ Class å¤–éƒ¨ ï¼Œè¿™ä¸ªç±»åªèƒ½ç”¨ MyClass å¼•ç”¨ã€‚\nğŸ§ª Experimental ç§æœ‰å±æ€§çš„è§£å†³åŠæ³•ï¼Ÿâ†’ ES2022 ä¸­æ·»åŠ äº† # è¡¨ç¤ºå˜é‡ç§æœ‰å±æ€§\nğŸ“ƒ Example\nlet inst = new MyClass(); try { console.log( inst.getClassName(), // Me Me.name, // ReferenceError: Me is not defined ); } catch (e) { console.error(e.toString()); } ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œ Me åªåœ¨ Class å†…éƒ¨æœ‰å®šä¹‰ã€‚\nå¦‚æœç±»çš„å†…éƒ¨æ²¡ç”¨åˆ°çš„è¯ï¼Œå¯ä»¥çœç•¥ Me ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥å†™æˆä¸‹é¢çš„å½¢å¼ã€‚\nconst MyClass = Class { /* ... */ }; é‡‡ç”¨ Class è¡¨è¾¾å¼ï¼Œå¯ä»¥å†™å‡º ç«‹å³æ‰§è¡Œ(class{constructor(...args){}})(...args) çš„ Classã€‚\nğŸ“ƒ Example\nlet person = new class { constructor(name) { this.name = name; } sayName() { console.log(this.name); } }(\u0026#39;å¼ ä¸‰\u0026#39;); person.sayName(); // \u0026#34;å¼ ä¸‰\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼Œperson æ˜¯ä¸€ä¸ªç«‹å³æ‰§è¡Œçš„ç±»çš„å®ä¾‹ã€‚\næ³¨æ„ç‚¹ ä¸¥æ ¼æ¨¡å¼ ç±»å’Œæ¨¡å—çš„å†…éƒ¨ï¼Œé»˜è®¤ å°±æ˜¯ä¸¥æ ¼æ¨¡å¼ï¼Œæ‰€ä»¥ä¸éœ€è¦ä½¿ç”¨ use strict æŒ‡å®šè¿è¡Œæ¨¡å¼ã€‚åªè¦ä½ çš„ä»£ç å†™åœ¨ç±»æˆ–æ¨¡å—ä¹‹ä¸­ï¼Œå°±åªæœ‰ä¸¥æ ¼æ¨¡å¼å¯ç”¨ã€‚è€ƒè™‘åˆ°æœªæ¥æ‰€æœ‰çš„ä»£ç ï¼Œå…¶å®éƒ½æ˜¯è¿è¡Œåœ¨æ¨¡å—ä¹‹ä¸­ï¼Œæ‰€ä»¥ ES6 å®é™…ä¸ŠæŠŠæ•´ä¸ªè¯­è¨€å‡çº§åˆ°äº†ä¸¥æ ¼æ¨¡å¼ã€‚\nä¸å­˜åœ¨æå‡ ç±»ä¸å­˜åœ¨å˜é‡æå‡hoistï¼Œè¿™ä¸€ç‚¹ä¸ ES5 å®Œå…¨ä¸åŒã€‚\nnew Foo(); // ReferenceError class Foo {} ä¸Šé¢ä»£ç ä¸­ï¼ŒFoo ç±»ä½¿ç”¨åœ¨å‰ï¼Œå®šä¹‰åœ¨åï¼Œè¿™æ ·ä¼šæŠ¥é”™ï¼Œå› ä¸º ES6 ä¸ä¼šæŠŠç±»çš„å£°æ˜æå‡åˆ°ä»£ç å¤´éƒ¨ã€‚è¿™ç§è§„å®šçš„åŸå› ä¸ä¸‹æ–‡è¦æåˆ°çš„ç»§æ‰¿æœ‰å…³ï¼Œå¿…é¡»ä¿è¯å­ç±»åœ¨çˆ¶ç±»ä¹‹åå®šä¹‰ã€‚\nğŸ“ƒ Example\n{ let Foo = class {}; class Bar extends Foo {} } ä¸Šé¢çš„ä»£ç ä¸ä¼šæŠ¥é”™ï¼Œå› ä¸ºBar ç»§æ‰¿ Foo çš„æ—¶å€™ï¼ŒFoo å·²ç»æœ‰å®šä¹‰äº†ã€‚ä½†æ˜¯ï¼Œå¦‚æœå­˜åœ¨ class çš„æå‡ï¼Œä¸Šé¢ä»£ç å°±ä¼šæŠ¥é”™ï¼Œå› ä¸º class ä¼šè¢«æå‡åˆ°ä»£ç å¤´éƒ¨ï¼Œè€Œ let å‘½ä»¤æ˜¯ä¸æå‡çš„ï¼Œæ‰€ä»¥å¯¼è‡´ Bar ç»§æ‰¿ Foo çš„æ—¶å€™ï¼ŒFoo è¿˜æ²¡æœ‰å®šä¹‰ã€‚\nname å±æ€§ ç”±äºæœ¬è´¨ä¸Šï¼ŒES6 çš„ç±»åªæ˜¯ ES5 çš„æ„é€ å‡½æ•°çš„ä¸€å±‚ åŒ…è£… ï¼Œæ‰€ä»¥å‡½æ•°çš„è®¸å¤šç‰¹æ€§éƒ½è¢« class ç»§æ‰¿ï¼ŒåŒ…æ‹¬ name å±æ€§ã€‚\nlet Point = class P {} console.log(Point.name); // \u0026#34;P\u0026#34; console.log(P); // ReferenceError: P is not defined name å±æ€§æ€»æ˜¯è¿”å›ç´§è·Ÿåœ¨ class å…³é”®å­—åé¢çš„ç±»åã€‚\nGenerator å¦‚æœæŸä¸ªæ–¹æ³•ä¹‹å‰åŠ ä¸Š æ˜Ÿå·* ï¼Œå°±è¡¨ç¤ºè¯¥æ–¹æ³•æ˜¯ä¸€ä¸ª Generator å‡½æ•°ã€‚\nclass Foo { constructor(...args) { this.args = args; } * [Symbol.iterator]() { for (let arg of this.args) { yield arg; } } } for (let x of new Foo(\u0026#39;hello\u0026#39;, \u0026#39;world\u0026#39;)) { console.log(x); } // hello world ä¸Šé¢ä»£ç ä¸­ï¼ŒFoo ç±»çš„ Symbol.iterator æ–¹æ³•å‰æœ‰ä¸€ä¸ªæ˜Ÿå·*ï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•æ˜¯ä¸€ä¸ª Generator å‡½æ•°ã€‚ Symbol.iterator æ–¹æ³•å°†è¿”å›ä¸€ä¸ª Foo ç±»çš„é»˜è®¤éå†å™¨ï¼Œè€Œfor-of å¾ªç¯ä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªéå†å™¨ã€‚\nthis ç±»çš„æ–¹æ³•å†…éƒ¨å¦‚æœå«æœ‰ this ï¼Œå®ƒé»˜è®¤æŒ‡å‘ç±»çš„å®ä¾‹ã€‚ä½†æ˜¯ï¼Œå¿…é¡»éå¸¸å°å¿ƒï¼Œä¸€æ—¦å•ç‹¬ä½¿ç”¨è¯¥æ–¹æ³•ï¼Œå¾ˆå¯èƒ½æŠ¥é”™ã€‚\nğŸ“ƒ Example\nclass Logger { printName(name = \u0026#39;there\u0026#39;) { this.print(`Hello ${name}`); } print(text) { console.log(text); } } const logger = new Logger(); logger.printName(); // Hello there /* æå–å‡ºæ¥å•ç‹¬ä½¿ç”¨åï¼ŒthisæŒ‡å‘è¢«ä¿®æ”¹ */ const {printName} = logger; printName(); // TypeError: Cannot read property \u0026#39;print\u0026#39; of undefined ä¸Šé¢ä»£ç ä¸­ï¼ŒprintName æ–¹æ³•ä¸­çš„ this ï¼Œé»˜è®¤æŒ‡å‘ Logger ç±»çš„å®ä¾‹ã€‚\nä½†æ˜¯ï¼Œå¦‚æœå°†è¿™ä¸ªæ–¹æ³•æå–å‡ºæ¥å•ç‹¬ä½¿ç”¨ï¼Œ this ä¼šæŒ‡å‘è¯¥æ–¹æ³•è¿è¡Œæ—¶æ‰€åœ¨çš„ç¯å¢ƒï¼ˆç”±äº Class å†…éƒ¨æ˜¯ ä¸¥æ ¼æ¨¡å¼ ï¼Œæ‰€ä»¥ this å®é™…æŒ‡å‘çš„æ˜¯ undefined ï¼‰ï¼Œä»è€Œå¯¼è‡´æ‰¾ä¸åˆ° print æ–¹æ³•è€ŒæŠ¥é”™ã€‚\nä¸€ä¸ªæ¯”è¾ƒç®€å•çš„è§£å†³æ–¹æ³•æ˜¯ï¼Œåœ¨æ„é€ æ–¹æ³•ä¸­ç»‘å®š this ï¼Œè¿™æ ·å°±ä¸ä¼šæ‰¾ä¸åˆ° print æ–¹æ³•äº†ã€‚\nclass Logger { constructor() { this.printName = this.printName.bind(this); } // ... } ğŸ“ƒ Example\nå¦ä¸€ç§è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚\nclass Obj { constructor() { this.getThis = () =\u0026gt; this; // ç®­å¤´å‡½æ•°çš„thisæ°¸è¿œæŒ‡å‘ä¸Šä¸‹æ–‡ } } const myObj = new Obj(); console.log(myObj.getThis() === myObj); // true è¿˜æœ‰ä¸€ç§è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨ Proxy ï¼Œè·å–æ–¹æ³•çš„æ—¶å€™ï¼Œè‡ªåŠ¨ç»‘å®š this ã€‚\nğŸ“ƒ Example\nfunction selfish(target) { const cache = new WeakMap(); const handler = { get(target, key) { const value = Reflect.get(target, key); if (typeof value !== \u0026#39;function\u0026#39;) { return value; } // æ˜¯å‡½æ•°çš„æ—¶å€™ï¼Œå°±é€šè¿‡weakMapå­˜å‚¨é”®å€¼å¯¹ if (!cache.has(value)) { cache.set(value, value.bind(target)); // bind()æ–¹æ³•è¿”å›ä¸€ä¸ªç»‘å®šæ–°thisçš„å‡½æ•° } return cache.get(value); } }; return new Proxy(target, handler); } class Logger {} const logger = selfish(new Logger()); Static flowchart TB subgraph \u0026#34;å¯¹è±¡\u0026lt;i style=\u0026#39;font-size:.8em\u0026#39;\u0026gt;ï¼ˆåŸå‹å¯¹è±¡çš„å®ä¾‹ï¼‰\u0026lt;/i\u0026gt;\u0026#34; C --\u0026gt;|\u0026lt;tt\u0026gt;new\u0026lt;/tt\u0026gt;\u0026amp;nbspå®ä¾‹åŒ–|I1 C --\u0026gt;|\u0026lt;tt\u0026gt;extend\u0026lt;/tt\u0026gt;\u0026amp;nbspç»§æ‰¿|SC SC --\u0026gt;|\u0026lt;tt\u0026gt;new\u0026lt;/tt\u0026gt;\u0026amp;nbspå®ä¾‹åŒ–|I2 I1 x--x|æ²¡æœ‰å…³ç³»|I2 end C[\u0026#34;ç±»\u0026lt;br\u0026gt;\u0026lt;i style=\u0026#39;font-size:.8em\u0026#39;\u0026gt;æŠ½è±¡å¯¹è±¡\u0026lt;/i\u0026gt;\u0026#34;] SC[\u0026#34;å­ç±»\u0026lt;br\u0026gt;\u0026lt;i style=\u0026#39;font-size:.8em\u0026#39;\u0026gt;æŠ½è±¡å¯¹è±¡\u0026lt;/i\u0026gt;\u0026#34;] I1[\u0026#34;å®ä¾‹\u0026lt;br\u0026gt;\u0026lt;i style=\u0026#39;font-size:.8em\u0026#39;\u0026gt;å…·ä½“å¯¹è±¡\u0026lt;/i\u0026gt;\u0026#34;] I2[\u0026#34;å®ä¾‹\u0026lt;br\u0026gt;\u0026lt;i style=\u0026#39;font-size:.8em\u0026#39;\u0026gt;å…·ä½“å¯¹è±¡\u0026lt;/i\u0026gt;\u0026#34;] %% class definition classDef transparent fill:none,stroke:none class N,Foi,Obj transparent %% æ§åˆ¶subgraphæ ·å¼ classDef cluster fill:none %% :memo: Note å››è€…éƒ½æ˜¯å¯¹è±¡ï¼Œéƒ½æœ‰å±æ€§å’Œæ–¹æ³•ï¼›ä½†åªæœ‰ç±»ï¼Œæ‰æœ‰é™æ€å±æ€§å’Œæ–¹æ³•ã€‚\né™æ€æ–¹æ³• ç±»ç›¸å½“äº å®ä¾‹instance çš„ åŸå‹prototype ï¼Œæ‰€æœ‰åœ¨ç±»ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œéƒ½ä¼šè¢«å®ä¾‹ç»§æ‰¿ã€‚å¦‚æœåœ¨ä¸€ä¸ªæ–¹æ³•å‰ï¼ŒåŠ ä¸Š static å…³é”®å­—ï¼Œå°±è¡¨ç¤ºè¯¥æ–¹æ³• ä¸ä¼šè¢«å®ä¾‹ç»§æ‰¿ ï¼Œéœ€è¦ç›´æ¥é€šè¿‡ç±»æ¥è°ƒç”¨ï¼Œè¿™å°±ç§°ä¸ºâ€œé™æ€æ–¹æ³•â€ã€‚\nğŸ“ƒ Example\nclass Foo { static classMethod() { console.log`hello`; } } Foo.classMethod() // \u0026#39;hello\u0026#39; const foo = new Foo(); foo.classMethod() // TypeError: foo.classMethod is not a function ä¸Šé¢ä»£ç ä¸­ï¼ŒFoo ç±»çš„ classMethod æ–¹æ³•å‰æœ‰ static å…³é”®å­—ï¼Œè¡¨æ˜è¯¥æ–¹æ³•æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨ Foo ç±»ä¸Šè°ƒç”¨ï¼ˆFoo.classMethod()ï¼‰ï¼Œè€Œä¸æ˜¯åœ¨ Foo ç±»çš„å®ä¾‹ä¸Šè°ƒç”¨ã€‚å¦‚æœåœ¨å®ä¾‹ä¸Šè°ƒç”¨é™æ€æ–¹æ³•ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¡¨ç¤ºä¸å­˜åœ¨è¯¥æ–¹æ³•ã€‚\n:memo: Note åŒåçš„ é™æ€æ–¹æ³• å’Œ å®ä¾‹æ–¹æ³• å¯ä»¥åŒæ—¶å­˜åœ¨ã€‚\n:warning: Warning å¦‚æœé™æ€æ–¹æ³•åŒ…å« this å…³é”®å­—ï¼Œè¿™ä¸ª this å°†è‡ªåŠ¨æŒ‡å‘ ç±»class ï¼Œè€Œä¸æ˜¯ å®ä¾‹instanceã€‚\nğŸ“ƒ Example\nclass Foo { static bar() { this.baz(); } static baz() { console.log(\u0026#39;hello\u0026#39;); } baz() { console.log(\u0026#39;world\u0026#39;); } } Foo.bar() // hello ä¸Šé¢ä»£ç ä¸­ï¼Œé™æ€æ–¹æ³• bar è°ƒç”¨äº† this.baz ï¼Œè¿™é‡Œçš„ this æŒ‡çš„æ˜¯ Foo ç±»ï¼Œè€Œä¸æ˜¯ Foo çš„å®ä¾‹ï¼Œç­‰åŒäºè°ƒç”¨ Foo.baz ã€‚å¦å¤–ï¼Œä»è¿™ä¸ªä¾‹å­è¿˜å¯ä»¥çœ‹å‡ºï¼Œé™æ€æ–¹æ³•å¯ä»¥ä¸éé™æ€æ–¹æ³• é‡å ã€‚\nçˆ¶ç±»çš„é™æ€æ–¹æ³•ï¼Œå¯ä»¥è¢«å­ç±»ç»§æ‰¿ã€‚\nğŸ“ƒ Example\nclass Foo { static classMethod() { return \u0026#39;hello\u0026#39;; } } class Bar extends Foo {} Bar.classMethod() // \u0026#39;hello\u0026#39; ä¸Šé¢ä»£ç ä¸­ï¼Œçˆ¶ç±» Foo æœ‰ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå­ç±» Bar å¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚\né™æ€æ–¹æ³•ä¹Ÿæ˜¯å¯ä»¥ä» super å¯¹è±¡ä¸Šè°ƒç”¨çš„ã€‚\nclass Foo { static classMethod() { return \u0026#39;hello\u0026#39;; } } class Bar extends Foo { static classMethod() { return super.classMethod() + \u0026#39;, too\u0026#39;; } } Bar.classMethod() // \u0026#34;hello, too\u0026#34; é™æ€å±æ€§^ES2022^ é™æ€å±æ€§æŒ‡çš„æ˜¯ Class æœ¬èº«çš„å±æ€§ï¼Œå³ Class.propName ï¼Œè€Œä¸æ˜¯å®šä¹‰åœ¨ å®ä¾‹å¯¹è±¡ this ä¸Šçš„å±æ€§ã€‚ä½¿ç”¨æ—¶åœ¨å®ä¾‹å±æ€§çš„å‰é¢ï¼ŒåŠ ä¸Š static å…³é”®å­—ã€‚\n:memo: Note\nclass MyClass { static myStaticProp = 42; constructor() { console.log(MyClass.myStaticProp); // 42 } } è¿™ä¸ªæ–°å†™æ³•å¤§å¤§æ–¹ä¾¿äº†é™æ€å±æ€§çš„è¡¨è¾¾ã€‚\nğŸ“ƒ Example\n// è€å†™æ³• class Foo {} Foo.prop = 1; // æ–°å†™æ³• class Foo { static prop = 1; } ä¸Šé¢ä»£ç ä¸­ï¼Œè€å†™æ³•çš„é™æ€å±æ€§å®šä¹‰åœ¨ç±»çš„å¤–éƒ¨ã€‚\næ•´ä¸ªç±»ç”Ÿæˆä»¥åï¼Œå†ç”Ÿæˆé™æ€å±æ€§ã€‚è¿™æ ·è®©äººå¾ˆå®¹æ˜“å¿½ç•¥è¿™ä¸ªé™æ€å±æ€§ï¼Œä¹Ÿä¸ç¬¦åˆç›¸å…³ä»£ç åº”è¯¥æ”¾åœ¨ä¸€èµ·çš„ä»£ç ç»„ç»‡åŸåˆ™ã€‚å¦å¤–ï¼Œæ–°å†™æ³•æ˜¯ æ˜¾å¼å£°æ˜declarative ï¼Œè€Œä¸æ˜¯èµ‹å€¼å¤„ç†ï¼Œè¯­ä¹‰æ›´å¥½ã€‚\næŠ˜ä¸­åŠæ³• ç”±äº ES6 è§„å®š Class å†…éƒ¨åªæœ‰é™æ€æ–¹æ³•ï¼Œæ²¡æœ‰é™æ€å±æ€§ï¼Œå› æ­¤åªèƒ½é€šè¿‡å˜é€šæ–¹æ³•æ¨¡æ‹Ÿå®ç°ã€‚\nğŸ“ƒ Example\nclass Foo {} Foo.prop = 1; Foo.prop // 1 ä¸Šé¢çš„å†™æ³•ä¸º Foo ç±»å®šä¹‰äº†ä¸€ä¸ªé™æ€å±æ€§ prop ã€‚\nPirvate ç§æœ‰æ–¹æ³•å’Œç§æœ‰å±æ€§åªèƒ½åœ¨ç±»çš„å†…éƒ¨è®¿é—®çš„æ–¹æ³•å’Œå±æ€§ï¼Œå¤–éƒ¨ä¸èƒ½è®¿é—®ã€‚è¿™æ˜¯å¸¸è§éœ€æ±‚ï¼Œæœ‰åˆ©äºä»£ç çš„å°è£…ã€‚\nç§æœ‰æ–¹æ³•å’Œå±æ€§^ES2022^ ç›®å‰ï¼ŒES2022 ä¸º class å¡«åŠ äº†ç§æœ‰æ–¹æ³•å’Œå±æ€§ã€‚æ–¹æ³•æ˜¯åœ¨å±æ€§åä¹‹å‰ï¼Œä½¿ç”¨ # è¡¨ç¤ºï¼Œå¹¶å·²è¢«æœ€æ–°çš„ Chrome æ”¯æŒã€‚\nğŸ“ƒ Example\nclass IncreasingCounter { #count = 0; get value() { console.log(\u0026#39;Getting the current value!\u0026#39;); return this.#count; } increment() { this.#count++; } } new IncreasingCounter().value; // Getting the current value! ä¸Šé¢ä»£ç ä¸­ï¼Œ#count å°±æ˜¯ç§æœ‰å±æ€§ï¼Œåªèƒ½åœ¨ç±»çš„å†…éƒ¨ä½¿ç”¨ï¼ˆ this.#count ï¼‰ã€‚å¦‚æœåœ¨ç±»çš„å¤–éƒ¨ä½¿ç”¨ï¼Œå°±ä¼šæŠ¥é”™ã€‚\nğŸ“ƒ Example\nconst counter = new IncreasingCounter(); counter.#count // æŠ¥é”™ counter.#count = 42 // æŠ¥é”™ ä¸Šé¢ä»£ç åœ¨ç±»çš„å¤–éƒ¨ï¼Œè¯»å–ç§æœ‰å±æ€§ï¼Œå°±ä¼šæŠ¥é”™ã€‚\nä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚\nğŸ“ƒ Example\nclass Point { #x; constructor(x = 0) { this.#x = +x; } get x() { return this.#x; } set x(value) { this.#x = +value; } } ä¸Šé¢ä»£ç ä¸­ï¼Œ#x å°±æ˜¯ç§æœ‰å±æ€§ï¼Œåœ¨ Point ç±»ä¹‹å¤–æ˜¯è¯»å–ä¸åˆ°è¿™ä¸ªå±æ€§çš„ã€‚ç”±äºäº•å· # æ˜¯å±æ€§åçš„ä¸€éƒ¨åˆ†ï¼Œä½¿ç”¨æ—¶å¿…é¡»å¸¦æœ‰ # ä¸€èµ·ä½¿ç”¨ï¼Œæ‰€ä»¥ #x å’Œ x æ˜¯ä¸¤ä¸ªä¸åŒçš„å±æ€§ã€‚\nè¿™æ ·å°±å¯ä»¥åœ¨å®Œå…¨ä¸æš´éœ²å†…éƒ¨æˆå‘˜çš„æƒ…å†µä¸‹ä½¿ç”¨ getter å’Œ setter äº†ã€‚\nä¹‹æ‰€ä»¥è¦å¼•å…¥ä¸€ä¸ªæ–°çš„å‰ç¼€ # è¡¨ç¤ºç§æœ‰å±æ€§ï¼Œè€Œæ²¡æœ‰é‡‡ç”¨ private å…³é”®å­—ï¼Œæ˜¯å› ä¸º JavaScript æ˜¯ä¸€é—¨åŠ¨æ€è¯­è¨€ï¼Œæ²¡æœ‰ç±»å‹å£°æ˜ï¼Œä½¿ç”¨ç‹¬ç«‹çš„ç¬¦å·ä¼¼ä¹æ˜¯å”¯ä¸€çš„æ¯”è¾ƒæ–¹ä¾¿å¯é çš„æ–¹æ³•ï¼Œèƒ½å¤Ÿå‡†ç¡®åœ°åŒºåˆ†ä¸€ç§å±æ€§æ˜¯å¦ä¸ºç§æœ‰å±æ€§ã€‚å¦å¤–ï¼ŒRuby è¯­è¨€ä½¿ç”¨ @ è¡¨ç¤ºç§æœ‰å±æ€§ï¼ŒES6 æ²¡æœ‰ç”¨è¿™ä¸ªç¬¦å·è€Œä½¿ç”¨ # ï¼Œæ˜¯å› ä¸º @ å·²ç»è¢«ç•™ç»™äº† Decoratorã€‚\nè¿™ç§å†™æ³•ä¸ä»…å¯ä»¥å†™ç§æœ‰å±æ€§ï¼Œè¿˜å¯ä»¥ç”¨æ¥å†™ç§æœ‰æ–¹æ³•ã€‚\nğŸ“ƒ Example\nclass Foo { #a; #b; constructor(a, b) { this.#a = a; this.#b = b; } #sum() { return this.#a + this.#b; } printSum() { console.log(this.#sum()); } } ä¸Šé¢ä»£ç ä¸­ï¼Œ#sum() å°±æ˜¯ä¸€ä¸ªç§æœ‰æ–¹æ³•ã€‚\nå¦å¤–ï¼Œç§æœ‰å±æ€§ä¹Ÿå¯ä»¥è®¾ç½® getter å’Œ setter æ–¹æ³•ã€‚\nğŸ“ƒ Example\nclass Counter extends Function{ #xValue = 0; constructor() { super(); // ... } get #x() { return this.#xValue; } set #x(value) { this.#xValue = value; } } new Counter().#x; // Private field \u0026#39;#x\u0026#39; must be declared in an enclosing class ä¸Šé¢ä»£ç ä¸­ï¼Œ#x æ˜¯ä¸€ä¸ªç§æœ‰å±æ€§ï¼Œå®ƒçš„è¯»å†™éƒ½é€šè¿‡ get #x() å’Œ set #x() æ¥å®Œæˆã€‚\n:warning: Warning å¤–éƒ¨ä¸èƒ½ç›´æ¥è¯»å–ç§æœ‰å˜é‡æˆ–æˆå‘˜ã€‚\nç§æœ‰å±æ€§ä¸é™äºä» this å¼•ç”¨ï¼Œåªè¦æ˜¯åœ¨ç±»çš„å†…éƒ¨ï¼Œå®ä¾‹ä¹Ÿå¯ä»¥å¼•ç”¨ç§æœ‰å±æ€§ã€‚\nğŸ“ƒ Example\nclass Foo { #privateValue = 42; static getPrivateValue(foo) { return foo.#privateValue; } } Foo.getPrivateValue(new Foo()); // 42 ä¸Šé¢ä»£ç å…è®¸ä»å®ä¾‹ foo ä¸Šé¢å¼•ç”¨ç§æœ‰å±æ€§ã€‚\nç§æœ‰å±æ€§å’Œç§æœ‰æ–¹æ³•å‰é¢ï¼Œä¹Ÿå¯ä»¥åŠ ä¸Š static å…³é”®å­—ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªé™æ€çš„ç§æœ‰å±æ€§æˆ–ç§æœ‰æ–¹æ³•ã€‚\nğŸ“ƒ Example\nclass FakeMath { static PI = 22 / 7; static #totallyRandomNumber = 4; static #computeRandomNumber() { return FakeMath.#totallyRandomNumber; } static random() { console.log(\u0026#39;I heard you like random numbersâ€¦\u0026#39;) return FakeMath.#computeRandomNumber(); } } FakeMath.PI // 3.142857142857143 FakeMath.random() // I heard you like random numbersâ€¦ // 4 FakeMath.#totallyRandomNumber // æŠ¥é”™ FakeMath.#computeRandomNumber() // æŠ¥é”™ ä¸Šé¢ä»£ç ä¸­ï¼Œ#totallyRandomNumber æ˜¯ç§æœ‰å±æ€§ï¼Œ#computeRandomNumber() æ˜¯ç§æœ‰æ–¹æ³•ï¼Œåªèƒ½åœ¨ FakeMath è¿™ä¸ªç±»çš„å†…éƒ¨è°ƒç”¨ï¼Œå¤–éƒ¨è°ƒç”¨å°±ä¼šæŠ¥é”™ã€‚\nin :exclamation: Warning ç¤ºä¾‹å¯èƒ½æœ‰é—®é¢˜ï¼Œå¹¶åœ¨ Chrome 100 ä¸­æŠ¥é”™ï¼š\nSyntaxError: Private field \u0026#39;#bar\u0026#39; must be declared in an enclosing class V8 å¼•æ“æ”¹è¿›äº† in è¿ç®—ç¬¦ï¼Œä½¿å®ƒä¹Ÿå¯ä»¥ç”¨æ¥åˆ¤æ–­ ç§æœ‰å±æ€§ ã€‚\nclass A { use(obj) { if (#foo in obj) { // ç§æœ‰å±æ€§ #foo å­˜åœ¨ } else { // ç§æœ‰å±æ€§ #foo ä¸å­˜åœ¨ } } } ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œin è¿ç®—ç¬¦åˆ¤æ–­å½“å‰ç±» A çš„å®ä¾‹ï¼Œæ˜¯å¦æœ‰ç§æœ‰å±æ€§ #foo ï¼Œå¦‚æœæœ‰è¿”å› true ï¼Œå¦åˆ™è¿”å› false ã€‚\nin ä¹Ÿå¯ä»¥è·Ÿ this ä¸€èµ·é…åˆä½¿ç”¨ã€‚\nclass A { #foo = 0; m() { console.log(#foo in this); // true console.log(#bar in this); // false } } å¤åˆ¶ä»£ç  æ³¨æ„ï¼Œåˆ¤æ–­ç§æœ‰å±æ€§æ—¶ï¼Œinåªèƒ½ç”¨åœ¨å®šä¹‰è¯¥ç§æœ‰å±æ€§çš„ç±»çš„å†…éƒ¨ã€‚\nclass A { #foo = 0; static test(obj) { console.log(#foo in obj); } } A.test(new A()) // true A.test({}) // false class B { #foo = 0; } A.test(new B()) // false å¤åˆ¶ä»£ç  ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œç±» A çš„ç§æœ‰å±æ€§ #foo ï¼Œåªèƒ½åœ¨ç±» A å†…éƒ¨ä½¿ç”¨ in è¿ç®—ç¬¦åˆ¤æ–­ï¼Œè€Œä¸”åªå¯¹ A çš„å®ä¾‹è¿”å› true ï¼Œå¯¹äºå…¶ä»–å¯¹è±¡éƒ½è¿”å› false ã€‚\nå­ç±»ä»çˆ¶ç±»ç»§æ‰¿çš„ç§æœ‰å±æ€§ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ in è¿ç®—ç¬¦æ¥åˆ¤æ–­ã€‚\nclass A { #foo = 0; static test(obj) { console.log(#foo in obj); } } class SubA extends A { }; A.test(new SubA()) // true ä¸Šé¢ç¤ºä¾‹ä¸­ï¼ŒSubA ä»çˆ¶ç±»ç»§æ‰¿äº†ç§æœ‰å±æ€§ #foo ï¼Œin è¿ç®—ç¬¦ä¹Ÿæœ‰æ•ˆã€‚\næ³¨æ„ï¼Œin è¿ç®—ç¬¦å¯¹äº Object.create() ã€ Object.setPrototypeOf å½¢æˆçš„ç»§æ‰¿ï¼Œæ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºè¿™ç§ç»§æ‰¿ ä¸ä¼š ä¼ é€’ç§æœ‰å±æ€§ã€‚\nclass A { #foo = 0; static test(obj) { console.log(#foo in obj); } } const a = new A(); const o1 = Object.create(a); A.test(o1) // false A.test(o1.__proto__) // true const o2 = {}; Object.setPrototypeOf(o2, A); A.test(o2) // false A.test(o2.__proto__) // true ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå¯¹äºä¿®æ”¹åŸå‹é“¾å½¢æˆçš„ç»§æ‰¿ï¼Œå­ç±»éƒ½å–ä¸åˆ°çˆ¶ç±»çš„ç§æœ‰å±æ€§ï¼Œæ‰€ä»¥ in è¿ç®—ç¬¦æ— æ•ˆã€‚\næŠ˜ä¸­åŠæ³• ç”±äº ES6 ä¸æä¾›ç§æœ‰æ–¹æ³•ï¼Œå› æ­¤åªèƒ½é€šè¿‡å˜é€šæ–¹æ³•æ¨¡æ‹Ÿå®ç°ã€‚\nWeakMap^â­ï¸^ å¼±æ˜ å°„é€ å°±äº†åœ¨ JavaScript ES6 ä¸­å®ç°çœŸæ­£ç§æœ‰å˜é‡çš„ä¸€ç§æ–°æ–¹å¼ã€‚æ­¤æ—¶ç§æœ‰å˜é‡ä¼šå­˜å‚¨åœ¨å¼±æ˜ å°„ä¸­ï¼Œä»¥ å¯¹è±¡å®ä¾‹object-instance ä¸º é”®key ã€ä»¥ ç§æœ‰æˆå‘˜private-member çš„ å­—å…¸dictionary ä¸º å€¼value ã€‚\nğŸ“ƒ Example\nconst wm = new WeakMap(); class PrivateProperty { constructor(id) { this.id = id; } setPrivate(key, item) { const privateMembers = wm.get(this) || {}; privateMembers[key] = item; // å°†thisä¸ç§æœ‰æˆå‘˜å­—å…¸ç»‘å®š // é”®åæ˜¯å¼±å¼•ç”¨ï¼Œè€Œé”®å€¼å¯¹ä¸æ˜¯ wm.set(this, privateMembers); } getPrivate(key) { return wm.get(this)[key]; } set id(id) { this.setPrivate(this, id); } get id() { return this.getPrivate(this) } } const privateProperty = new PrivateProperty(123) privateProperty.setPrivate(\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;); console.log( privateProperty.id, // 123 Object.keys(privateProperty), // [] Reflect.ownKeys(privateProperty), // [] privateProperty.getPrivate(\u0026#39;foo\u0026#39;) //bar ); å½“ç„¶ï¼ŒWeakMap ä»ç„¶æš´éœ²åœ¨å¤–ã€‚å¯ä»¥ç”¨ä¸€ä¸ªé—­åŒ…åŒ…è£¹èµ·æ¥ï¼Œä½†è¿™æ ·ä¹Ÿå¯¼è‡´äº†é™·å…¥äº† ES5 ä¹‹å‰çš„ç§æœ‰å˜é‡æ¨¡å¼ã€‚\nconst PrivateProperty = (() =\u0026gt; { const wm = new WeakMap(); class PrivateProperty { /*...*/ } return PrivateProperty; })(); /* ... */ å‘½ååŒºåˆ« ä¸€ç§åšæ³•æ˜¯åœ¨å‘½åä¸ŠåŠ ä»¥åŒºåˆ«ã€‚\nğŸ“ƒ Example\nclass Widget { // å…¬æœ‰æ–¹æ³• foo(baz) { this._bar(baz); } // ç§æœ‰æ–¹æ³• _bar(baz) { return this.snaf = baz; } // ... } ä¸Šé¢ä»£ç ä¸­ï¼Œ_bar() æ–¹æ³•å‰é¢çš„ä¸‹åˆ’çº¿ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªåªé™äºå†…éƒ¨ä½¿ç”¨çš„ç§æœ‰æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œè¿™ç§å‘½åæ˜¯ä¸ä¿é™©çš„ï¼Œåœ¨ç±»çš„å¤–éƒ¨ï¼Œè¿˜æ˜¯å¯ä»¥è°ƒç”¨åˆ°è¿™ä¸ªæ–¹æ³•ã€‚\nå¤–éƒ¨å®šä¹‰ç±» å¦ä¸€ç§æ–¹æ³•å°±æ˜¯ç´¢æ€§å°†ç§æœ‰æ–¹æ³•ç§»å‡ºç±»ï¼Œå› ä¸ºç±»å†…éƒ¨çš„æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯å¯¹å¤–å¯è§çš„ã€‚\nğŸ“ƒ Example\nclass Widget { foo(baz) { bar.call(this, baz); } // ... } function bar(baz) { return this.snaf = baz; } ä¸Šé¢ä»£ç ä¸­ï¼Œfoo æ˜¯å…¬å¼€æ–¹æ³•ï¼Œå†…éƒ¨è°ƒç”¨äº† bar.call(this, baz) ã€‚è¿™ä½¿å¾— bar() å®é™…ä¸Šæˆä¸ºäº†å½“å‰ç±»çš„ç§æœ‰æ–¹æ³•ã€‚\nSymbol è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯åˆ©ç”¨ Symbol å€¼çš„å”¯ä¸€æ€§ï¼Œå°†ç§æœ‰æ–¹æ³•çš„åå­—å‘½åä¸ºä¸€ä¸ª Symbol å€¼ã€‚\nğŸ“ƒ Example\n// åŒ…è£¹åœ¨å‡½æ•°ä½œç”¨åŸŸå†… function PrivateClass(privatePropertyArgs) { const privateMethod = Symbol(\u0026#39;private method\u0026#39;); const privateProperty = Symbol(\u0026#39;private property\u0026#39;); return new class PrivateClass { constructor(privatePropertyArgs = {}) { this[privateProperty] = privatePropertyArgs; // ç§æœ‰æ–¹æ³• this[privateMethod] = function (key) { // ç§æœ‰å±æ€§ return this[this[privateProperty]][key]; } } // å…¬æœ‰æ–¹æ³• getPrivate(key) { return this[privateProperty][key]; } }(privatePropertyArgs); } /* ä½¿ç”¨ */ let privateClass = new PrivateClass( {foo: \u0026#39;bar\u0026#39;, foo2: \u0026#39;bar2\u0026#39;}); console.log( Object.keys(privateClass), // [] Reflect.ownKeys(privateClass), // [ Symbol(private property), // Symbol(private method) ] privateClass.getPrivate(\u0026#39;foo\u0026#39;) //bar ); ä¸Šé¢ä»£ç ä¸­ï¼Œbar å’Œ snaf éƒ½æ˜¯ Symbol å€¼ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ— æ³•è·å–åˆ°å®ƒä»¬ï¼Œå› æ­¤è¾¾åˆ°äº†ç§æœ‰æ–¹æ³•å’Œç§æœ‰å±æ€§çš„æ•ˆæœã€‚ä½†æ˜¯ä¹Ÿä¸æ˜¯ç»å¯¹ä¸è¡Œï¼ŒReflect.ownKeys() ä¾ç„¶å¯ä»¥æ‹¿åˆ°å®ƒä»¬ã€‚\nä¸Šé¢ä»£ç ä¸­ï¼ŒSymbol å€¼çš„å±æ€§åä¾ç„¶å¯ä»¥ä»ç±»çš„å¤–éƒ¨æ‹¿åˆ°ã€‚\nconst inst = new myClass(); Reflect.ownKeys(myClass.prototype) // [ \u0026#39;constructor\u0026#39;, \u0026#39;foo\u0026#39;, Symbol(bar) ] New new æ˜¯ä»æ„é€ å‡½æ•°ç”Ÿæˆå®ä¾‹å¯¹è±¡çš„å‘½ä»¤ã€‚\nå®ç° æ–°ç”Ÿæˆä¸€ä¸ªå¯¹è±¡ é“¾æ¥åˆ°åŸå‹ ç»‘å®š this è¿”å›æ–°å¯¹è±¡ function new_object() { /* 1. åˆ›å»ºä¸€ä¸ªç©ºçš„å¯¹è±¡ */ let obj = new Object() /* 2. è·å¾—æ„é€ å‡½æ•° */ let constructor = [].shift.call(arguments) /* 3. é“¾æ¥åˆ°åŸå‹ ï¼ˆä¸æ¨èä½¿ç”¨ï¼‰ */ obj.__proto__ = constructor.prototype /* 4. ç»‘å®š thisï¼Œæ‰§è¡Œæ„é€ å‡½æ•° */ let result = constructor.apply(obj, arguments) /* 5. ç¡®ä¿ new å‡ºæ¥çš„æ˜¯ä¸ªå¯¹è±¡ */ return typeof result === \u0026#39;object\u0026#39; ? result : obj } å¯¹å…¶è¿›è¡Œä¼˜åŒ–ï¼š\n// ä¼˜åŒ–å new å®ç° function create() { /* 1. è·å¾—æ„é€ å‡½æ•°ï¼ŒåŒæ—¶åˆ é™¤ arguments ä¸­ç¬¬ä¸€ä¸ªå‚æ•° */ let constructor = [].shift.call(arguments); /* 2. åˆ›å»ºä¸€ä¸ªç©ºçš„å¯¹è±¡å¹¶é“¾æ¥åˆ°åŸå‹ï¼Œobj å¯ä»¥è®¿é—®æ„é€ å‡½æ•°åŸå‹ä¸­çš„å±æ€§ */ let obj = Object.create(constructor.prototype); /* 3. ç»‘å®š this å®ç°ç»§æ‰¿ï¼Œobj å¯ä»¥è®¿é—®åˆ°æ„é€ å‡½æ•°ä¸­çš„å±æ€§ */ let ret = constructor.apply(obj, arguments); /* 4. ä¼˜å…ˆè¿”å›æ„é€ å‡½æ•°è¿”å›çš„å¯¹è±¡ */ return ret instanceof Object ? ret : obj; } New.target ES6 ä¸º new å‘½ä»¤å¼•å…¥äº†ä¸€ä¸ª new.target å±æ€§ï¼Œç”¨äºæ£€æµ‹å‡½æ•°æˆ–æ„é€ æ–¹æ³•æ˜¯å¦æ˜¯é€šè¿‡ new è¿ç®—ç¬¦è¢«è°ƒç”¨çš„ã€‚\nåœ¨æ™®é€šçš„å‡½æ•°è°ƒç”¨ä¸­ï¼Œnew.target çš„å€¼æ˜¯ undefined ã€‚\né€šè¿‡ new å‘½ä»¤æˆ– Reflect.construct() è°ƒç”¨æ—¶ï¼Œ new.target ä¼šæŒ‡å‘æ„é€  æ–¹æ³•æˆ–å‡½æ•° çš„å¼•ç”¨ ï¼Œå› æ­¤è¿™ä¸ªå±æ€§å¯ä»¥ç”¨æ¥ç¡®å®šæ„é€ å‡½æ•°æ˜¯æ€ä¹ˆè°ƒç”¨çš„ã€‚\nnew.target new.target è¯­æ³•ç”±ä¸€ä¸ªå…³é”®å­— new ï¼Œä¸€ä¸ªç‚¹ï¼Œå’Œä¸€ä¸ªå±æ€§å target ç»„æˆã€‚é€šå¸¸ new. çš„ä½œç”¨æ˜¯æä¾›å±æ€§è®¿é—®çš„ä¸Šä¸‹æ–‡ï¼Œä½†è¿™é‡Œ new. å…¶å®ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„å¯¹è±¡ã€‚ä¸è¿‡åœ¨æ„é€ æ–¹æ³•è°ƒç”¨ä¸­ï¼Œnew.target æŒ‡å‘è¢« new è°ƒç”¨çš„æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥ new. æˆä¸ºäº†ä¸€ä¸ªè™šæ‹Ÿä¸Šä¸‹æ–‡ã€‚\nğŸ“ƒ Example\nfunction Person(name) { if (!new.target) { // if (new.target !== undefined) { this.name = name; } else { throw new Error(\u0026#39;å¿…é¡»ä½¿ç”¨ new å‘½ä»¤ç”Ÿæˆå®ä¾‹\u0026#39;); } return this; } // å¦ä¸€ç§å†™æ³• function Person2(name) { if (new.target === Person) { this.name = name; } else { throw new Error(\u0026#39;å¿…é¡»ä½¿ç”¨ new å‘½ä»¤ç”Ÿæˆå®ä¾‹\u0026#39;); } } const person = new Person(\u0026#39;å¼ ä¸‰\u0026#39;); // æ­£ç¡® const notAPerson = Person.call(person, \u0026#39;å¼ ä¸‰\u0026#39;); // æŠ¥é”™ // Void function return value is used // åŠ ä¸Šreturn thisåï¼Œæ‰èƒ½åƒnewé‚£æ ·è‡ªåŠ¨è¿”å›` ä¸Šé¢ä»£ç ç¡®ä¿æ„é€ å‡½æ•°åªèƒ½é€šè¿‡ new å‘½ä»¤è°ƒç”¨ã€‚\nClass å†…éƒ¨è°ƒç”¨ new.target ï¼Œè¿”å›å½“å‰ Classã€‚\nğŸ“ƒ Example\nclass Rectangle { constructor(length, width) { console.log(new.target === Rectangle); this.length = length; this.width = width; } } const obj = new Rectangle(3, 4); // è¾“å‡º true éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå­ç±»ç»§æ‰¿çˆ¶ç±»æ—¶ï¼Œ new.target ä¼šè¿”å› å­ç±» ã€‚\nğŸ“ƒ Example\nclass Rectangle { constructor(length, width) { console.log(new.target === Rectangle); console.log(new.target); // [class Square extends Rectangle] } } class Square extends Rectangle { constructor(length) { super(length, length); } } const obj = new Square(3); // è¾“å‡º false ä¸Šé¢ä»£ç ä¸­ï¼Œ new.target ä¼šè¿”å›å­ç±»ã€‚\nåˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹ï¼Œå¯ä»¥å†™å‡ºä¸èƒ½ç‹¬ç«‹ä½¿ç”¨ã€å¿…é¡»ç»§æ‰¿åæ‰èƒ½ä½¿ç”¨çš„ç±»ã€‚\nç±»ä¼¼ C++ çš„è™šç±»\nğŸ“ƒ Example\nclass VShape { constructor() { if (new.target === VShape) { throw new Error(\u0026#39;æœ¬ç±»ä¸èƒ½å®ä¾‹åŒ–\u0026#39;); } } } class Rectangle extends VShape { constructor(length, width) { super(); // ... } } const x = new Rectangle(3, 4); // æ­£ç¡® const y = new VShape(); // æŠ¥é”™ ä¸Šé¢ä»£ç ä¸­ï¼ŒShape ç±»ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œåªèƒ½ç”¨äºç»§æ‰¿ã€‚\næ³¨æ„ï¼Œåœ¨å‡½æ•°å¤–éƒ¨ï¼Œä½¿ç”¨ new.target ä¼šæŠ¥é”™ã€‚\nåŸå‹ flowchart TD %% .__proto__ Op-.-\u0026gt;|.__proto__|N Fp-.-\u0026gt;|.__proto__|Op %% Fop-.-\u0026gt;|.__proto__|Fp %% ç›´æ¥é“¾æ¥ Fop-.-\u0026gt;|.__proto__.__proto__|Op %% å¸¦æ ‡ fFo-.-\u0026gt;|\u0026lt;div style=\u0026#39;background-color:white\u0026#39;\u0026gt;\u0026lt;div style=\u0026#39;border:1px dashed\u0026#39;\u0026gt;\u0026lt;tt\u0026gt;\u0026lt;em\u0026gt;\u0026amp;#40Foo created\u0026lt;br\u0026gt;by Function\u0026amp;#41\u0026lt;/div\u0026gt;\u0026lt;/em\u0026gt;\u0026lt;/tt\u0026gt;.__proto__\u0026lt;/div\u0026gt;|Fp fO-.-\u0026gt;|\u0026lt;div style=\u0026#39;background-color:white\u0026#39;\u0026gt;\u0026lt;div style=\u0026#39;border:1px dashed\u0026#39;\u0026gt;\u0026lt;tt\u0026gt;\u0026lt;em\u0026gt;\u0026amp;#40Object created\u0026lt;br\u0026gt;by Function\u0026amp;#41\u0026lt;/div\u0026gt;\u0026lt;/em\u0026gt;\u0026lt;/tt\u0026gt;.__proto__\u0026lt;/div\u0026gt;|Fp fF-.-\u0026gt;|\u0026lt;div style=\u0026#39;background-color:white\u0026#39;\u0026gt;\u0026lt;div style=\u0026#39;border:1px dashed\u0026#39;\u0026gt;\u0026lt;tt\u0026gt;\u0026lt;em\u0026gt;\u0026amp;#40Function created\u0026lt;br\u0026gt;by Function\u0026amp;#41\u0026lt;/div\u0026gt;\u0026lt;/em\u0026gt;\u0026lt;/tt\u0026gt;.__proto__\u0026lt;/div\u0026gt;|Fp %% %% %% prototype fO--\u0026gt;|prototype|Op Op--\u0026gt;|constructor|fO fF--\u0026gt;|prototype|Fp Fp--\u0026gt;|constructor|fF fFo--\u0026gt;|prototype|Fop Fop--\u0026gt;|constructor|fFo %% %% instance Foi Obj Foi-.-\u0026gt;|.__proto__|Fop Obj-.-\u0026gt;|.__proto__|Op %% %%subgraph \u0026#34;Prototypes \u0026lt;tt\u0026gt;(instances)\u0026lt;/tt\u0026gt;\u0026#34; subgraph \u0026#34;Object\u0026#34; direction TB Op fO end subgraph \u0026#34;Function\u0026#34; direction RL Fp fF end subgraph \u0026#34;Foo\u0026#34; direction BT Fop fFo end N[\u0026#34;\u0026lt;em\u0026gt;null\u0026lt;/em\u0026gt;\u0026#34;] Op([\u0026#34;\u0026lt;em\u0026gt;Object.\u0026lt;br\u0026gt;prototype\u0026lt;/em\u0026gt;\u0026#34;]) Fp([\u0026#34;\u0026lt;em\u0026gt;Function.\u0026lt;br\u0026gt;prototype\u0026lt;/em\u0026gt;\u0026#34;]) fO[\u0026#34;\u0026lt;tt\u0026gt;function\u0026lt;br\u0026gt;Object()\u0026lt;/tt\u0026gt;\u0026#34;] fF[\u0026#34;\u0026lt;tt\u0026gt;function\u0026lt;br\u0026gt;Function()\u0026lt;/tt\u0026gt;\u0026#34;] Fop([\u0026#34;\u0026lt;em\u0026gt;Foo.\u0026lt;br\u0026gt;prototype\u0026lt;/em\u0026gt;\u0026#34;]) fFo[\u0026#34;\u0026lt;tt\u0026gt;function\u0026lt;br\u0026gt;Foo()\u0026lt;/tt\u0026gt;\u0026#34;] Foi[\u0026#34;... = new Foo()\u0026lt;br\u0026gt;\u0026lt;em style=\u0026#39;color:indianred\u0026#39;\u0026gt;f1 \u0026amp; f2\u0026lt;/em\u0026gt;\u0026#34;] Obj[\u0026#34;... = new Object()\u0026lt;br\u0026gt;\u0026lt;em style=\u0026#39;color:blue\u0026#39;\u0026gt;o1 \u0026amp; o2\u0026lt;/em\u0026gt;\u0026#34;] %% class definition classDef transparent fill:none,stroke:none class N,Foi,Obj transparent %% æ§åˆ¶subgraphæ ·å¼ classDef cluster fill:none %% %%classDef white fill:white %%class fFo white %% flowchart LR n[\u0026#34;null\u0026#34;]--\u0026gt;O(\u0026#34;Object\u0026#34;) --\u0026gt;|\u0026lt;div style=\u0026#39;font-size:.8em\u0026#39;\u0026gt;\u0026lt;tt\u0026gt;native\u0026lt;br\u0026gt;code\u0026lt;/tt\u0026gt;\u0026lt;/div\u0026gt;|F(\u0026#34;Function\u0026#34;) --\u0026gt;|\u0026lt;tt\u0026gt;class\u0026lt;/tt\u0026gt;|Fo[\u0026#34;Foo\u0026#34;] --\u0026gt;|new Foo\u0026amp;#40 \u0026amp;#41|f1([f1]) Fo--\u0026gt;|new Foo\u0026amp;#40 \u0026amp;#41|f2([f2]) classDef transparent fill:none,stroke:none class n,f1,f2 transparent prototype æ‰€æœ‰ å‡½æ•° éƒ½æœ‰ä¸€ä¸ª æ˜¾å¼åŸå‹explicit-prototype,prototype å±æ€§ï¼Œç±»å‹ä¸º Object ã€‚åœ¨ new çš„è¿‡ç¨‹ä¸­ï¼Œå°†ä¼šä»¥åŸå‹ä¸ºæ¨¡ç‰ˆï¼Œåˆ›å»ºæ–°å¯¹è±¡ã€‚\nğŸ§ª Experimental å®ç°ç±»ä¼¼ Object.create(prototype)ï¼Œå°†æ–°å¯¹è±¡è¿æ¥åˆ°åŸå‹å¹¶ç»‘å®š this ã€‚\nå¯¹è±¡ä»¥å…¶ åŸå‹ ä¸º æ¨¡æ¿ ï¼Œä»åŸå‹ï¼ˆä½äºå¯¹è±¡çš„ æ„é€ å™¨å‡½æ•°constructor çš„ prototype å±æ€§ï¼‰ ç»§æ‰¿ æ–¹æ³•å’Œå±æ€§ã€‚\n:memo: Note ä½†æœ‰ä¸€ä¸ªä¾‹å¤–ï¼š Function.prototype.bind()ï¼Œå®ƒå¹¶æ²¡æœ‰ prototype å±æ€§ã€‚\næ„é€ å‡½æ•° Foo æœ‰ä¸€ä¸ªæŒ‡å‘åŸå‹çš„æŒ‡é’ˆï¼ŒåŸå‹ Foo.prototype æœ‰ä¸€ä¸ªæŒ‡å‘æ„é€ å‡½æ•°çš„æŒ‡é’ˆ Foo.prototype.constructor ï¼Œè¿™å°±æ˜¯ä¸€ä¸ª å¾ªç¯å¼•ç”¨ ï¼Œå³ï¼š\nFoo.prototype.constructor === Foo; // true graph LR F[\u0026#34;\u0026lt;ruby\u0026gt;æ„é€ å‡½æ•°\u0026lt;rt\u0026gt;\u0026lt;tt\u0026gt;constructor\u0026lt;/tt\u0026gt;\u0026lt;/rt\u0026gt;\u0026lt;/ruby\u0026gt;\u0026lt;br\u0026gt;\u0026lt;em\u0026gt;Foo\u0026lt;/em\u0026gt;\u0026#34;]--\u0026gt;|\u0026lt;ruby\u0026gt;æ˜¾å¼åŸå‹\u0026lt;rt\u0026gt;\u0026lt;tt\u0026gt;explicit\u0026amp;nbspprototype\u0026lt;/tt\u0026gt;\u0026lt;/rt\u0026gt;\u0026lt;/ruby\u0026gt;\u0026lt;br\u0026gt;.prototype|Fo[\u0026#34;\u0026lt;ruby\u0026gt;åŸå‹å¯¹è±¡\u0026lt;rt\u0026gt;\u0026lt;tt\u0026gt;prototype\u0026lt;/tt\u0026gt;\u0026lt;/rt\u0026gt;\u0026lt;/ruby\u0026gt;\u0026lt;br\u0026gt;\u0026lt;em\u0026gt;Foo.prototype\u0026lt;/em\u0026gt;\u0026#34;] Fo--\u0026gt;|æ„é€ å™¨å‡½æ•°\u0026lt;br\u0026gt;.constructor|F __proto__ æ¯ä¸ª å®ä¾‹å¯¹è±¡instance-object éƒ½æœ‰ä¸€ä¸ª éšå¼åŸå‹implicit-prototype,__proto__ å±æ€§æŒ‡å‘äº†åˆ›å»ºè¯¥å¯¹è±¡çš„ æ„é€ å‡½æ•°çš„ åŸå‹å¯¹è±¡prototype ã€‚\n:memo: Note Function ä¹Ÿå±äº Object å®ä¾‹ã€‚\nclass Foo {} let foo = new Foo(); å½“ new Foo() æ—¶ï¼Œ__proto__ è¢«è‡ªåŠ¨åˆ›å»ºã€‚å¹¶ä¸”\nfoo.__proto__ === Foo.prototype; // true graph LR F[\u0026#34;\u0026lt;ruby\u0026gt;æ„é€ å‡½æ•°\u0026lt;rt\u0026gt;\u0026lt;tt\u0026gt;constructor\u0026lt;/tt\u0026gt;\u0026lt;/rt\u0026gt;\u0026lt;/ruby\u0026gt;\u0026lt;br\u0026gt;\u0026lt;em\u0026gt;Foo\u0026lt;/em\u0026gt;\u0026#34;]--\u0026gt;|\u0026lt;ruby\u0026gt;æ˜¾å¼åŸå‹\u0026lt;rt\u0026gt;\u0026lt;tt\u0026gt;explicit\u0026amp;nbspprototype\u0026lt;/tt\u0026gt;\u0026lt;/rt\u0026gt;\u0026lt;/ruby\u0026gt;\u0026lt;br\u0026gt;.prototype|Fo[\u0026#34;\u0026lt;ruby\u0026gt;åŸå‹å¯¹è±¡\u0026lt;rt\u0026gt;\u0026lt;tt\u0026gt;prototype\u0026lt;/tt\u0026gt;\u0026lt;/rt\u0026gt;\u0026lt;/ruby\u0026gt;\u0026lt;br\u0026gt;\u0026lt;em\u0026gt;Foo.prototype\u0026lt;/em\u0026gt;\u0026#34;] Fo--\u0026gt;|æ„é€ å™¨å‡½æ•°\u0026lt;br\u0026gt;.constructor|F F-.-\u0026gt;|new|f[\u0026#34;å®ä¾‹\u0026lt;br\u0026gt;\u0026lt;tt\u0026gt;\u0026lt;em\u0026gt;foo\u0026lt;/em\u0026gt;\u0026lt;/tt\u0026gt;\u0026#34;] f--\u0026gt;|\u0026lt;ruby\u0026gt;éšå¼åŸå‹\u0026lt;rt\u0026gt;\u0026lt;tt\u0026gt;implicit\u0026amp;nbspprototype\u0026lt;/tt\u0026gt;\u0026lt;/rt\u0026gt;\u0026lt;/ruby\u0026gt;\u0026lt;br\u0026gt;__proto__|Fo __proto__ å‘éŸ³ dunder proto ï¼Œæœ€å…ˆè¢« Firefox ä½¿ç”¨ï¼Œåæ¥åœ¨ ES6 è¢«åˆ—ä¸º Javascript çš„æ ‡å‡†å†…å»ºå±æ€§ã€‚\n:memo: Note å¯¹æ„é€ å‡½æ•°æ‰§è¡Œ new æ–¹æ³•çš„æ—¶å€™ï¼Œå°†è‡ªåŠ¨æŠŠæ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ç»‘å®šåˆ°äº†æ–°å¯¹è±¡ä¸Šï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡å†…éƒ¨æ–¹æ³• __proto__ è®¿é—®ã€‚\n:link: Hrefnew çš„å®ç°\n:exclamation:Warning è¯¥ç‰¹æ€§å·²ç»ä» Web æ ‡å‡†ä¸­åˆ é™¤ï¼Œè™½ç„¶ä¸€äº›æµè§ˆå™¨ç›®å‰ä»ç„¶æ”¯æŒå®ƒï¼Œä½†ä¹Ÿè®¸ä¼šåœ¨æœªæ¥çš„æŸä¸ªæ—¶é—´åœæ­¢æ”¯æŒï¼Œè¯·å°½é‡ä¸è¦ä½¿ç”¨è¯¥ç‰¹æ€§ã€‚\n:memo: Note Reflect.setPrototypeOf() å’Œ Reflect.getPrototypeOf å¯ä»¥å®Œå…¨ä»£æ›¿ __proto__å†…éƒ¨æ–¹æ³•ã€‚\n:warning: Caution é€šè¿‡ç°ä»£æµè§ˆå™¨çš„æ“ä½œå±æ€§çš„ä¾¿åˆ©æ€§ï¼Œå¯ä»¥æ”¹å˜ä¸€ä¸ªå¯¹è±¡çš„ [[Prototype]] å±æ€§ï¼Œè¿™ç§è¡Œä¸ºåœ¨æ¯ä¸€ä¸ª JavaScript å¼•æ“å’Œæµè§ˆå™¨ä¸­éƒ½æ˜¯ä¸€ä¸ªéå¸¸æ…¢ä¸”å½±å“æ€§èƒ½çš„æ“ä½œï¼Œä½¿ç”¨è¿™ç§æ–¹å¼æ¥æ”¹å˜å’Œç»§æ‰¿å±æ€§æ˜¯å¯¹æ€§èƒ½å½±å“éå¸¸ä¸¥é‡çš„ï¼Œå› æ­¤æ¨èä½¿ç”¨ Object.create() ã€‚\n[[Prototype]] [[Prototype]] æ˜¯å¯¹è±¡çš„ä¸€ä¸ªå†…éƒ¨å±æ€§ï¼Œå¤–éƒ¨ä»£ç æ— æ³•ç›´æ¥è®¿é—®ã€‚\n:memo: Note å®é™…ä¸Šå¯ä»¥é€šè¿‡æš´éœ²åœ¨å¤–çš„æ¥å£ .__proto__ è¿›è¡Œè®¿é—®ã€‚\néµå¾ª ECMAScript æ ‡å‡†ï¼ŒsomeObject.[[Prototype]] ç¬¦å·ç”¨äºæŒ‡å‘ someObject çš„åŸå‹ã€‚\nå¦‚æœè¦è¯»å–æˆ–ä¿®æ”¹å¯¹è±¡çš„ [[Prototype]] å±æ€§ï¼Œå»ºè®®ä½¿ç”¨å¦‚ä¸‹æ–¹æ¡ˆï¼Œä½†æ˜¯æ­¤æ—¶è®¾ç½®å¯¹è±¡çš„ [[Prototype]] ä¾æ—§æ˜¯ä¸€ä¸ªç¼“æ…¢çš„æ“ä½œï¼Œå¦‚æœæ€§èƒ½æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå°±è¦é¿å…è¿™ç§æ“ä½œã€‚\n// è·å–ï¼ˆä¸¤è€…ä¸€è‡´ï¼‰ Object.getPrototypeOf() Reflect.getPrototypeOf() // ä¿®æ”¹ï¼ˆä¸¤è€…ä¸€è‡´ï¼‰ Object.setPrototypeOf() Reflect.setPrototypeOf() /* setå’Œgetæ–¹æ³•å¯ä»¥å®Œå…¨ä»£æ›¿__proto__å†…éƒ¨æ–¹æ³• */ Object.create() å¦‚æœè¦åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼ŒåŒæ—¶ç»§æ‰¿å¦ä¸€ä¸ªå¯¹è±¡çš„ åŸå‹å¯¹è±¡[[Prototype]] ï¼Œæ¨èä½¿ç”¨ Object.create()ã€‚\nğŸ“ƒ Example\nlet A = {foo: \u0026#39;bar\u0026#39;}; let B = Object.create(A, { foo2: { value: \u0026#39;bar2\u0026#39;, } }); let C = Object.create(B, { foo3: { value: \u0026#39;bar3\u0026#39;, enumerable: false, writable: true, configurable: true } }); console.log(C.foo); // bar // é“¾å¼ç»§æ‰¿äº†Açš„å±æ€§ä½œä¸ºåŸå‹ console.log(C.foo2); // bar2 console.log(C.foo3); // bar3 console.log(B.__proto__ === A); // true console.log(C.__proto__.__proto__ === A); // true ä¸Šé¢ä»£ç ä¸­ï¼ŒObject.create() æ–¹æ³•ä»¥ A å¯¹è±¡ä¸ºåŸå‹ï¼Œç”Ÿæˆäº† B å’Œ C å¯¹è±¡ã€‚B C ç»§æ‰¿äº† A çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚\nå®é™…ä¸Šï¼ŒObject.create() æ–¹æ³•å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç ä»£æ›¿ã€‚\nğŸ“ƒ Example\nObject.create = function (obj) { function F() {} F.prototype = obj; return new F(); }; ä¸Šé¢ä»£ç è¡¨æ˜ï¼ŒObject.createæ–¹æ³•çš„å®è´¨æ˜¯æ–°å»ºä¸€ä¸ªç©ºçš„æ„é€ å‡½æ•° F ï¼Œç„¶åè®© F.prototype å±æ€§æŒ‡å‘å‚æ•°å¯¹è±¡ obj ï¼Œæœ€åè¿”å›ä¸€ä¸ª F çš„å®ä¾‹ï¼Œä»è€Œå®ç°è®©è¯¥å®ä¾‹ç»§æ‰¿ obj çš„å±æ€§ã€‚\næˆ–æ˜¯\nObject.create = function (obj){ let O = {}; Object.setPrototypeOf(B, obj); /* æˆ–æ˜¯ */ B.__proto__ = obj; return B; } é™¤äº†å¯¹è±¡çš„åŸå‹ï¼ŒObject.create() æ–¹æ³•è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ã€‚è¯¥å‚æ•°æ˜¯ä¸€ä¸ªå±æ€§æè¿°å¯¹è±¡ï¼Œå®ƒæ‰€æè¿°çš„å¯¹è±¡å±æ€§ï¼Œä¼šæ·»åŠ åˆ°å®ä¾‹å¯¹è±¡ï¼Œä½œä¸ºè¯¥å¯¹è±¡ è‡ªèº« çš„å±æ€§ã€‚\nlet foo = {}; let bar = Object.create(foo, { p1: { value: 123, enumerable: true, configurable: true, writable: true, }, p2: { value: \u0026#39;abc\u0026#39;, enumerable: true, configurable: true, writable: true, } }); console.log(bar); // { p1: 123, p2: \u0026#39;abc\u0026#39; } console.log(bar.__proto__ === foo); // true // ç­‰åŒäº bar = Object.create(foo); bar.p1 = 123; bar.p2 = \u0026#39;abc\u0026#39;; åŸå‹é“¾ æ¯ä¸ª å¯¹è±¡object éƒ½æ‹¥æœ‰ä¸€ä¸ª åŸå‹å¯¹è±¡prototype å¹¶ä»ä¸­ ç»§æ‰¿æ–¹æ³•å’Œå±æ€§ï¼Œå¹¶é€šè¿‡ __proto__ æŒ‡é’ˆæŒ‡å‘ã€‚\nåŸå‹å¯¹è±¡ä¹Ÿå¯èƒ½æ‹¥æœ‰åŸå‹ï¼Œè¿™æ ·ä¸€å±‚ä¸€å±‚ï¼Œæœ€ç»ˆæŒ‡å‘ null ï¼Œè¿™ç§å…³ç³»è¢«ç§°ä¸º åŸå‹é“¾prototype chain ã€‚æ ¹æ®å®šä¹‰ï¼Œ null æ²¡æœ‰åŸå‹ï¼Œå¹¶ä½œä¸ºè¿™ä¸ªåŸå‹é“¾ä¸­çš„æœ€åä¸€ä¸ªç¯èŠ‚ã€‚\ngraph LR f([\u0026#34;foo\u0026#34;])--\u0026gt;|__proto__|Fp([\u0026#34;Foo.prototype\u0026#34;]) F[\u0026#34;Foo\u0026#34;]--\u0026gt;|.constructor|Fp Fp--\u0026gt;|__proto__|Op([\u0026#34;Object.prototype\u0026#34;]) O[\u0026#34;Object\u0026#34;]--\u0026gt;|.constructor|Op([\u0026#34;Object\u0026#34;]) Op--\u0026gt;|__proto__|null classDef transparent fill:none,stroke:none classDef semitrans fill:none class null transparent class F,O semitrans :memo: Note\nFunction å¯¹è±¡é€šè¿‡ __proto__ æŒ‡é’ˆæŒ‡å‘ Function çš„åŸå‹å¯¹è±¡\nâ†’ å³ Function.prototype\nâ‡’ å› æ­¤ Function.__proto__ === Function.prototype :warning: Caution è¿™æ˜¯å› ä¸ºï¼Œæ‰€æœ‰å‡½æ•°éƒ½æ˜¯é€šè¿‡ Function æ„é€ çš„ã€‚\nArray.__proto__ === Function.prototype; //true Function.__proto__ === Function.prototype; //true Object.__proto__ === Function.prototype; //true function foo(){} class Foo{} foo.__proto__===Function.prototype; // true Foo.__proto__===Function.prototype; // true Function.prototype å¯¹è±¡é€šè¿‡ __proto__ æŒ‡é’ˆæŒ‡å‘ Function.prototype çš„åŸå‹å¯¹è±¡\nâ†’ å³ Object.prototype\nâ‡’ å› æ­¤ Function.__proto__.__proto__ === Object.prototype Function.__proto__ === Function.prototype; // true Function.__proto__.__proto__ === Object.prototype; // true :memo: Note\næ‰€æœ‰çš„ å¼•ç”¨ç±»å‹reference type:Array,Object,Function éƒ½å…·æœ‰å¯¹è±¡ç‰¹æ€§ï¼Œå³å¯è‡ªç”±æ‰©å±•å±æ€§ï¼ˆnull é™¤å¤–ï¼‰ã€‚\næ‰€æœ‰çš„å¼•ç”¨ç±»å‹ï¼Œéƒ½æœ‰ä¸€ä¸ª __proto__ å±æ€§ï¼Œå±æ€§å€¼æ˜¯ä¸€ä¸ªæ™®é€šçš„å¯¹è±¡ï¼Œè¯¥åŸå‹å¯¹è±¡ä¹Ÿæœ‰ä¸€ä¸ªè‡ªå·±çš„ åŸå‹å¯¹è±¡__proto__ ï¼Œå±‚å±‚å‘ä¸Šç›´åˆ°ä¸€ä¸ªå¯¹è±¡çš„åŸå‹å¯¹è±¡ä¸º nullã€‚æ ¹æ®å®šä¹‰ï¼Œnull æ²¡æœ‰åŸå‹ï¼Œå¹¶ä½œä¸ºè¿™ä¸ªåŸå‹é“¾ ä¸­çš„æœ€åä¸€ä¸ªç¯èŠ‚ã€‚\nå½“è¯•å›¾å¾—åˆ°ä¸€ä¸ªå¯¹è±¡çš„æŸä¸ªå±æ€§æ—¶ï¼Œå¦‚æœè¿™ä¸ªå¯¹è±¡æœ¬èº«æ²¡æœ‰è¿™ä¸ªå±æ€§ï¼Œé‚£ä¹ˆä¼šå»å®ƒçš„ __proto__ ï¼ˆå³å®ƒçš„æ„é€ å‡½æ•°çš„ prototype ï¼‰ä¸­å¯»æ‰¾ã€‚\nç»§æ‰¿ Class å¯ä»¥é€šè¿‡ extends å…³é”®å­—å®ç°ç»§æ‰¿ï¼Œè¿™æ¯” ES5 çš„é€šè¿‡ä¿®æ”¹åŸå‹é“¾å®ç°ç»§æ‰¿ï¼Œè¦æ¸…æ™°å’Œæ–¹ä¾¿å¾ˆå¤šã€‚\nğŸ“ƒ Example\nclass Point { } class ColorPoint extends Point { } ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ª ColorPoint ç±»ï¼Œè¯¥ç±»é€šè¿‡ extends å…³é”®å­—ï¼Œç»§æ‰¿äº† Point ç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚ä½†æ˜¯ç”±äºæ²¡æœ‰éƒ¨ç½²ä»»ä½•ä»£ç ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªç±»å®Œå…¨ä¸€æ ·ï¼Œç­‰äºå¤åˆ¶äº†ä¸€ä¸ª Point ç±»ã€‚\nä¸‹é¢ï¼Œæˆ‘ä»¬åœ¨ ColorPoint å†…éƒ¨åŠ ä¸Šä»£ç ã€‚\nğŸ“ƒ Example\nclass Point { } class ColorPoint extends Point { constructor(x, y, color) { super(x, y); // è°ƒç”¨çˆ¶ç±»çš„constructor(x, y) this.color = color; } toString() { return this.color + \u0026#39; \u0026#39; + super.toString(); // è°ƒç”¨çˆ¶ç±»çš„toString() } } ä¸Šé¢ä»£ç ä¸­ï¼Œ constructor æ–¹æ³•å’Œ toString æ–¹æ³•ä¹‹ä¸­ï¼Œéƒ½å‡ºç°äº† super å…³é”®å­—ï¼Œå®ƒåœ¨è¿™é‡Œè¡¨ç¤ºçˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œç”¨æ¥æ–°å»ºçˆ¶ç±»çš„ this å¯¹è±¡ã€‚\nå­ç±»å¿…é¡»åœ¨ constructor æ–¹æ³•ä¸­è°ƒç”¨ super æ–¹æ³•ï¼Œå¦åˆ™æ–°å»ºå®ä¾‹æ—¶ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºå­ç±»è‡ªå·±çš„ this å¯¹è±¡ï¼Œå¿…é¡»å…ˆé€šè¿‡çˆ¶ç±»çš„æ„é€ å‡½æ•°å®Œæˆå¡‘é€ ï¼Œå¾—åˆ°ä¸çˆ¶ç±»åŒæ ·çš„å®ä¾‹å±æ€§å’Œæ–¹æ³•ï¼Œç„¶åå†å¯¹å…¶è¿›è¡ŒåŠ å·¥ï¼ŒåŠ ä¸Šå­ç±»è‡ªå·±çš„å®ä¾‹å±æ€§å’Œæ–¹æ³•ã€‚å¦‚æœä¸è°ƒç”¨ super æ–¹æ³•ï¼Œå­ç±»å°±å¾—ä¸åˆ° this å¯¹è±¡ã€‚\nğŸ“ƒ Example\nclass Point { /* ... */ } class ColorPoint extends Point { constructor() { // Missed superclasses\u0026#39; constructor invocation /* super(); */ } } let cp = new ColorPoint(); // ReferenceError ä¸Šé¢ä»£ç ä¸­ï¼ŒColorPoint ç»§æ‰¿äº†çˆ¶ç±» Point ï¼Œä½†æ˜¯å®ƒçš„æ„é€ å‡½æ•°æ²¡æœ‰è°ƒç”¨ super æ–¹æ³•ï¼Œå¯¼è‡´æ–°å»ºå®ä¾‹æ—¶æŠ¥é”™ã€‚\nES5 çš„ç»§æ‰¿ï¼Œå®è´¨æ˜¯å…ˆåˆ›é€ å­ç±»çš„å®ä¾‹å¯¹è±¡ this ï¼Œç„¶åå†å°†çˆ¶ç±»çš„æ–¹æ³•æ·»åŠ åˆ° this ä¸Šé¢Parent.apply(this) ã€‚ES6 çš„ç»§æ‰¿æœºåˆ¶å®Œå…¨ä¸åŒï¼Œå®è´¨æ˜¯å…ˆå°†çˆ¶ç±»å®ä¾‹å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼ŒåŠ åˆ° this ä¸Šé¢ï¼ˆæ‰€ä»¥å¿…é¡»å…ˆè°ƒç”¨ super æ–¹æ³•ï¼‰ï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®æ”¹ this ã€‚\nå¦‚æœå­ç±»æ²¡æœ‰å®šä¹‰ constructor æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šè¢«é»˜è®¤æ·»åŠ ï¼Œä»£ç å¦‚ä¸‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ç®¡æœ‰æ²¡æœ‰æ˜¾å¼å®šä¹‰ï¼Œä»»ä½•ä¸€ä¸ªå­ç±»éƒ½æœ‰ constructor æ–¹æ³•ã€‚\nclass Point {} class ColorPoint extends Point {} // ç­‰åŒäº class ColorPoint extends Point { constructor(...args) { super(...args); } } å¦ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œåœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¸­ï¼Œåªæœ‰è°ƒç”¨ super ä¹‹åï¼Œæ‰å¯ä»¥ä½¿ç”¨ this å…³é”®å­—ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºå­ç±»å®ä¾‹çš„æ„å»ºï¼ŒåŸºäºçˆ¶ç±»å®ä¾‹ï¼Œåªæœ‰ super æ–¹æ³•æ‰èƒ½è°ƒç”¨çˆ¶ç±»å®ä¾‹ã€‚\nğŸ“ƒ Example\nclass Point { constructor(x, y) { this.x = x; this.y = y; } } class ColorPoint extends Point { constructor(x, y, color) { /* this.color = color; */ // ReferenceError // \u0026#39;this\u0026#39; is not allowed before superclass constructor invocation super(x, y); this.color = color; } } ä¸Šé¢ä»£ç ä¸­ï¼Œå­ç±»çš„ constructor æ–¹æ³•æ²¡æœ‰è°ƒç”¨ super ä¹‹å‰ï¼Œå°±ä½¿ç”¨ this å…³é”®å­—ï¼Œç»“æœæŠ¥é”™ï¼Œè€Œæ”¾åœ¨ super æ–¹æ³•ä¹‹åå°±æ˜¯æ­£ç¡®çš„ã€‚\nä¸‹é¢æ˜¯ç”Ÿæˆå­ç±»å®ä¾‹çš„ä»£ç ã€‚\nğŸ“ƒ Example\nlet cp = new ColorPoint(25, 8, \u0026#39;green\u0026#39;); console.log( cp instanceof ColorPoint, // true cp instanceof Point, // true ); ä¸Šé¢ä»£ç ä¸­ï¼Œå®ä¾‹å¯¹è±¡ cp åŒæ—¶æ˜¯ ColorPoint å’Œ Point ä¸¤ä¸ªç±»çš„å®ä¾‹ï¼Œè¿™ä¸ ES5 çš„è¡Œä¸ºå®Œå…¨ä¸€è‡´ã€‚\næœ€åï¼Œçˆ¶ç±»çš„é™æ€æ–¹æ³•ï¼Œä¹Ÿä¼šè¢«å­ç±»ç»§æ‰¿ã€‚\nğŸ“ƒ Example\nclass A { static hello() { console.log(\u0026#39;hello world\u0026#39;); } } class B extends A { } B.hello() // hello world ä¸Šé¢ä»£ç ä¸­ï¼Œhello() æ˜¯ A ç±»çš„é™æ€æ–¹æ³•ï¼ŒB ç»§æ‰¿ A ï¼Œä¹Ÿç»§æ‰¿äº† A çš„é™æ€æ–¹æ³•ã€‚\nè·å–çˆ¶ç±» Object.getPrototypeOf æ–¹æ³•å¯ä»¥åˆ¤æ–­å­ç±»æ˜¯å¦ä»çˆ¶ç±»ä¸Šç»§æ‰¿åŸå‹prototypeã€‚\nObject.getPrototypeOf(ColorPoint) === Point // true å› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•åˆ¤æ–­ï¼Œä¸€ä¸ªç±»æ˜¯å¦ç»§æ‰¿äº†å¦ä¸€ä¸ªç±»ã€‚\nsuper super è¿™ä¸ªå…³é”®å­—ï¼Œæ—¢å¯ä»¥å½“ä½œå‡½æ•°ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å½“ä½œå¯¹è±¡ä½¿ç”¨ã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œå®ƒçš„ç”¨æ³•å®Œå…¨ä¸åŒã€‚\nä½œä¸ºå‡½æ•° ç¬¬ä¸€ç§æƒ…å†µï¼Œ super ä½œä¸º å‡½æ•°function è°ƒç”¨æ—¶ï¼Œä»£è¡¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ã€‚ES6 è¦æ±‚ï¼Œå­ç±»çš„æ„é€ å‡½æ•°å¿…é¡»æ‰§è¡Œä¸€æ¬¡ super å‡½æ•°ã€‚\nğŸ“ƒ Example\nclass A {} class B extends A { constructor() { super(); } } æ³¨æ„ï¼Œ super è™½ç„¶ä»£è¡¨äº†çˆ¶ç±» A çš„æ„é€ å‡½æ•°ï¼Œä½†æ˜¯è¿”å›çš„æ˜¯å­ç±» Bçš„å®ä¾‹ï¼Œå³ super å†…éƒ¨çš„ this æŒ‡çš„æ˜¯ B çš„å®ä¾‹ï¼Œå› æ­¤ super() åœ¨è¿™é‡Œç›¸å½“äº A.prototype.constructor.call(this) ã€‚\nğŸ“ƒ Example\n:link: Href new target\nclass A { constructor() { console.log(new.target.name); // new.target ä»æ„é€ å‡½æ•°ç”Ÿæˆå®ä¾‹å¯¹è±¡çš„å‘½ä»¤ } } class B extends A { constructor() { super(); } } new A() // A new B() // B ä¸Šé¢ä»£ç ä¸­ï¼Œ new.target æŒ‡å‘å½“å‰æ­£åœ¨æ‰§è¡Œçš„å‡½æ•°ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåœ¨super()æ‰§è¡Œæ—¶ï¼Œå®ƒæŒ‡å‘çš„æ˜¯å­ç±»Bçš„æ„é€ å‡½æ•°ï¼Œè€Œä¸æ˜¯çˆ¶ç±»Açš„æ„é€ å‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œsuper()å†…éƒ¨çš„ this æŒ‡å‘çš„æ˜¯Bã€‚\nä½œä¸ºå‡½æ•°æ—¶ï¼Œsuper()åªèƒ½ç”¨åœ¨å­ç±»çš„ æ„é€ å‡½æ•°constructor ä¹‹ä¸­ï¼Œç”¨åœ¨å…¶ä»–åœ°æ–¹å°±ä¼šæŠ¥é”™ã€‚\nğŸ“ƒ Example\nclass A { } class B extends A { m() { super(); // æŠ¥é”™ } } ä¸Šé¢ä»£ç ä¸­ï¼Œsuper() ç”¨åœ¨ B ç±»çš„ m æ–¹æ³•ä¹‹ä¸­ï¼Œå°±ä¼šé€ æˆè¯­æ³•é”™è¯¯ã€‚\nä½œä¸ºå¯¹è±¡ ç¬¬äºŒç§æƒ…å†µï¼Œ super ä½œä¸ºå¯¹è±¡æ—¶ï¼Œåœ¨æ™®é€šæ–¹æ³•ä¸­ï¼ŒæŒ‡å‘çˆ¶ç±»çš„åŸå‹å¯¹è±¡ï¼›åœ¨é™æ€æ–¹æ³•ä¸­ï¼ŒæŒ‡å‘çˆ¶ç±»ã€‚\nflowchart LR S(\u0026#34;super\u0026#34;)-.-\u0026gt;|ä½œä¸ºå¯¹è±¡|tN([\u0026#34;\u0026lt;em\u0026gt;this\u0026lt;/em\u0026gt;\u0026#34;])--\u0026gt;|æŒ‡å‘|N[\u0026#34;çˆ¶ç±»çš„åŸå‹å¯¹è±¡\u0026#34;] S-.-\u0026gt;|é™æ€æ–¹æ³•|TN([\u0026#34;\u0026lt;em\u0026gt;this\u0026lt;/em\u0026gt;\u0026#34;])--\u0026gt;|æŒ‡å‘|s[\u0026#34;æ™®é€šæ–¹æ³•\u0026#34;] ğŸ“ƒ Example\nclass A { p() { return 2; } } class B extends A { constructor() { super(); console.log(super.p()); } } let b = new B(); // 2 ä¸Šé¢ä»£ç ä¸­ï¼Œå­ç±» B å½“ä¸­çš„ super.p() ï¼Œå°±æ˜¯å°† super å½“ä½œä¸€ä¸ªå¯¹è±¡ä½¿ç”¨ã€‚è¿™æ—¶ï¼Œ super åœ¨æ™®é€šæ–¹æ³•ä¹‹ä¸­ï¼ŒæŒ‡å‘ A.prototype ï¼Œæ‰€ä»¥ super.p() å°±ç›¸å½“äº A.prototype.p() ã€‚\nè¿™é‡Œéœ€è¦æ³¨æ„ï¼Œç”±äº super æŒ‡å‘çˆ¶ç±»çš„ åŸå‹å¯¹è±¡prototypeï¼Œæ‰€ä»¥å®šä¹‰åœ¨çˆ¶ç±»å®ä¾‹ä¸Šçš„æ–¹æ³•æˆ–å±æ€§ï¼Œæ˜¯æ— æ³•é€šè¿‡ super è°ƒç”¨çš„ã€‚\nğŸ“ƒ Example\nclass A { constructor() { this.p = 2; } /* é¡¶å±‚å˜é‡å†™æ³•ä¹Ÿæ²¡ç”¨ */ p = 2; } class B extends A { get m() { return super.p; } } let b = new B(); b.m // undefined ä¸Šé¢ä»£ç ä¸­ï¼Œp æ˜¯çˆ¶ç±» A å®ä¾‹çš„å±æ€§ï¼Œsuper.p å°±å¼•ç”¨ä¸åˆ°å®ƒã€‚\nå¦‚æœå±æ€§å®šä¹‰åœ¨çˆ¶ç±»çš„ åŸå‹å¯¹è±¡ ä¸Šï¼Œ super å°±å¯ä»¥å–åˆ°ã€‚\nğŸ“ƒ Example\nclass A { } A.prototype.x = 2; class A2 { static x = 2; // æ— æ•ˆ } class B extends A { constructor() { super(); console.log(super.x); } } class B2 extends A2 { constructor() { super(); console.log(super.x); // Static member is not accessible } } let b = new B(); // 2 let b2 = new B2(); // undefined ä¸Šé¢ä»£ç ä¸­ï¼Œå±æ€§ x æ˜¯å®šä¹‰åœ¨ A.prototype ä¸Šé¢çš„ï¼Œæ‰€ä»¥ super.x å¯ä»¥å–åˆ°å®ƒçš„å€¼ã€‚\n:memo: Note static å…³é”®å­—è¡¨ç¤ºä¸èƒ½è¢«ç»§æ‰¿ï¼Œè€Œä¸æ˜¯è¡¨ç¤ºåœ¨åŸå‹å¯¹è±¡ä¸Š\nES6 è§„å®šï¼Œåœ¨å­ç±»æ™®é€šæ–¹æ³•ä¸­é€šè¿‡ super è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œæ–¹æ³•å†…éƒ¨çš„ this æŒ‡å‘å½“å‰çš„ å­ç±» å®ä¾‹ã€‚\nğŸ“ƒ Example\nclass A { constructor() { this.x = 1; } print() { console.log(this.x); } } class B extends A { constructor() { super(); this.x = 2; } m() { super.print(); } } let b = new B(); b.m() // 2 ä¸Šé¢ä»£ç ä¸­ï¼Œsuper.print() è™½ç„¶è°ƒç”¨çš„æ˜¯ A.prototype.print() ï¼Œä½†æ˜¯ A.prototype.print() å†…éƒ¨çš„ this æŒ‡å‘å­ç±» B çš„å®ä¾‹ï¼Œå¯¼è‡´è¾“å‡ºçš„æ˜¯ 2 ï¼Œè€Œä¸æ˜¯ 1 ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®é™…ä¸Šæ‰§è¡Œçš„æ˜¯ super.print.call(this) ã€‚\nç”±äº this æŒ‡å‘å­ç±»å®ä¾‹ï¼Œæ‰€ä»¥å¦‚æœé€šè¿‡ super å¯¹æŸä¸ªå±æ€§èµ‹å€¼ï¼Œè¿™æ—¶ super å°±æ˜¯ this ï¼Œèµ‹å€¼çš„å±æ€§ä¼šå˜æˆå­ç±»å®ä¾‹çš„å±æ€§ã€‚\nğŸ“ƒ Example\nclass A { constructor() { this.x = 1; } } class B extends A { constructor() { super(); this.x = 2; super.x = 3; console.log(super.x); // undefined console.log(this.x); // 3 } } let b = new B(); ä¸Šé¢ä»£ç ä¸­ï¼Œsuper.x èµ‹å€¼ä¸º 3 ï¼Œè¿™æ—¶ç­‰åŒäºå¯¹ this.x èµ‹å€¼ä¸º 3 ã€‚è€Œå½“è¯»å– super.x çš„æ—¶å€™ï¼Œè¯»çš„æ˜¯ A.prototype.x ï¼Œæ‰€ä»¥è¿”å› undefined ã€‚\nå¦‚æœ super ä½œä¸ºå¯¹è±¡ï¼Œç”¨åœ¨é™æ€æ–¹æ³•ä¹‹ä¸­ï¼Œè¿™æ—¶ super å°†æŒ‡å‘çˆ¶ç±»ï¼Œè€Œä¸æ˜¯çˆ¶ç±»çš„åŸå‹å¯¹è±¡ã€‚\nğŸ“ƒ Example\nclass Parent { static myMethod(msg) { console.log(\u0026#39;static\u0026#39;, msg); } myMethod(msg) { console.log(\u0026#39;instance\u0026#39;, msg); } } class Child extends Parent { static myMethod(msg) { super.myMethod(msg); } myMethod(msg) { super.myMethod(msg); } } Child.myMethod(1); // static 1 var child = new Child(); child.myMethod(2); // instance 2 ä¸Šé¢ä»£ç ä¸­ï¼Œ super åœ¨é™æ€æ–¹æ³•ä¹‹ä¸­æŒ‡å‘çˆ¶ç±»ï¼Œåœ¨æ™®é€šæ–¹æ³•ä¹‹ä¸­æŒ‡å‘çˆ¶ç±»çš„åŸå‹å¯¹è±¡ã€‚\nå¦å¤–ï¼Œåœ¨å­ç±»çš„é™æ€æ–¹æ³•ä¸­é€šè¿‡ super è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œæ–¹æ³•å†…éƒ¨çš„ this æŒ‡å‘å½“å‰çš„å­ç±»ï¼Œè€Œä¸æ˜¯å­ç±»çš„å®ä¾‹ã€‚\nğŸ“ƒ Example\nclass A { constructor() { this.x = 1; } static print() { console.log(this.x); } } class B extends A { constructor() { super(); this.x = 2; } static m() { super.print(); } } B.x = 3; B.m() // 3 ä¸Šé¢ä»£ç ä¸­ï¼Œé™æ€æ–¹æ³• B.m é‡Œé¢ï¼Œsuper.printæŒ‡å‘çˆ¶ç±»çš„é™æ€æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•é‡Œé¢çš„ this æŒ‡å‘çš„æ˜¯Bï¼Œè€Œä¸æ˜¯Bçš„å®ä¾‹ã€‚\næ³¨æ„ï¼Œä½¿ç”¨ super çš„æ—¶å€™ï¼Œå¿…é¡»æ˜¾å¼æŒ‡å®šæ˜¯ä½œä¸ºå‡½æ•°ã€è¿˜æ˜¯ä½œä¸ºå¯¹è±¡ä½¿ç”¨ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚\nğŸ“ƒ Example\nclass A { } class B extends A { constructor() { super(); console.log(super); // æŠ¥é”™ } } ä¸Šé¢ä»£ç ä¸­ï¼Œconsole.log(super) å½“ä¸­çš„ superï¼Œæ— æ³•çœ‹å‡ºæ˜¯ä½œä¸ºå‡½æ•°ä½¿ç”¨ï¼Œè¿˜æ˜¯ä½œä¸ºå¯¹è±¡ä½¿ç”¨ï¼Œæ‰€ä»¥ JavaScript å¼•æ“è§£æä»£ç çš„æ—¶å€™å°±ä¼šæŠ¥é”™ã€‚\nè¿™æ—¶ï¼Œå¦‚æœèƒ½æ¸…æ™°åœ°è¡¨æ˜superçš„æ•°æ®ç±»å‹ï¼Œå°±ä¸ä¼šæŠ¥é”™ã€‚\nğŸ“ƒ Example\nclass A {} class B extends A { constructor() { super(); console.log(super.valueOf() instanceof B); // true } } let b = new B(); ä¸Šé¢ä»£ç ä¸­ï¼Œsuper.valueOf()è¡¨æ˜ super æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤å°±ä¸ä¼šæŠ¥é”™ã€‚åŒæ—¶ï¼Œç”±äº super ä½¿å¾— this æŒ‡å‘Bçš„å®ä¾‹ï¼Œæ‰€ä»¥super.valueOf()è¿”å›çš„æ˜¯ä¸€ä¸ªBçš„å®ä¾‹ã€‚\næœ€åï¼Œç”±äºå¯¹è±¡æ€»æ˜¯ç»§æ‰¿å…¶ä»–å¯¹è±¡çš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ä»»æ„ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä½¿ç”¨ super å…³é”®å­—ã€‚\nvar obj = { toString() { return \u0026#34;MyObject: \u0026#34; + super.toString(); } }; obj.toString(); // MyObject: [object Object] prototype :link: Hrefå…·ä½“è§ åŸå‹ è¿™ä¸€èŠ‚\nå¤§å¤šæ•°æµè§ˆå™¨çš„ ES5 å®ç°ä¹‹ä¸­ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½æœ‰ __proto__ å±æ€§ï¼ŒæŒ‡å‘å¯¹åº”çš„æ„é€ å‡½æ•°çš„ prototype å±æ€§ã€‚Class ä½œä¸ºæ„é€ å‡½æ•°çš„è¯­æ³•ç³–ï¼ŒåŒæ—¶æœ‰ prototype å±æ€§å’Œ __proto__ å±æ€§ï¼Œå› æ­¤åŒæ—¶å­˜åœ¨ä¸¤æ¡ç»§æ‰¿é“¾ï¼š\nå­ç±»çš„ __proto__ å±æ€§ï¼Œè¡¨ç¤ºæ„é€ å‡½æ•°çš„ç»§æ‰¿ï¼Œæ€»æ˜¯æŒ‡å‘çˆ¶ç±»ã€‚\nå®ƒçš„å«ä¹‰æ˜¯ï¼šå®ä¾‹å¯¹è±¡çš„ __proto__ å±æ€§æŒ‡å‘è¿™ä¸ªå®ä¾‹æ„é€ å‡½æ•°çš„ prototype å±æ€§\nå­ç±» prototype å±æ€§çš„ __proto__ å±æ€§ï¼Œè¡¨ç¤ºæ–¹æ³•çš„ç»§æ‰¿ï¼Œæ€»æ˜¯æŒ‡å‘çˆ¶ç±»çš„ prototype å±æ€§ã€‚\nğŸ“ƒ Example\nclass A {} class B extends A {} B.__proto__ === A // true B.prototype.__proto__ === A.prototype // true ä¸Šé¢ä»£ç ä¸­ï¼Œå­ç±»Bçš„ __proto__ å±æ€§æŒ‡å‘çˆ¶ç±»Aï¼Œå­ç±»Bçš„ prototype å±æ€§çš„ __proto__ å±æ€§æŒ‡å‘çˆ¶ç±»Açš„ prototype å±æ€§ã€‚\nå®ƒçš„ä½œç”¨æ˜¯: å¯¹è±¡é€šè¿‡ __proto__ å±æ€§æ¥å…±äº«æ„é€ å‡½æ•°æƒ³è¦ä¼ é€’çš„å±æ€§å’Œæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š[å®ä¾‹å¯¹è±¡].__proto__ = [æ„é€ å‡½æ•°].prototype\nç±»çš„ç»§æ‰¿æ˜¯æŒ‰ç…§ä¸‹é¢çš„æ¨¡å¼å®ç°çš„ã€‚\nclass A {} class B {} // B çš„å®ä¾‹ç»§æ‰¿ A çš„å®ä¾‹ Reflect.setPrototypeOf(B.prototype, A.prototype); // B ç»§æ‰¿ A çš„é™æ€å±æ€§ Reflect.setPrototypeOf(B, A); const b = new B(); :memo: Note å¯¹è±¡çš„æ‰©å±•ä¸€ç« ç»™å‡ºè¿‡ Object.setPrototypeOf æ–¹æ³•çš„å®ç°ï¼š\nObject.setPrototypeOf = function (obj, proto) { obj.__proto__ = proto; return obj; } å› æ­¤ï¼Œå°±å¾—åˆ°äº†ä¸Šé¢çš„ç»“æœã€‚\nReflect.setPrototypeOf(B.prototype, A.prototype); // ç­‰åŒäº B.prototype.__proto__ = A.prototype; Object.setPrototypeOf(B, A); // ç­‰åŒäº B.__proto__ = A; è¿™ä¸¤æ¡ç»§æ‰¿é“¾ï¼Œå¯ä»¥è¿™æ ·ç†è§£ï¼šä½œä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå­ç±»ï¼ˆBï¼‰çš„åŸå‹ï¼ˆ __proto__ å±æ€§ï¼‰æ˜¯çˆ¶ç±»ï¼ˆAï¼‰ï¼›ä½œä¸ºä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå­ç±»ï¼ˆBï¼‰çš„åŸå‹å¯¹è±¡ï¼ˆ prototype å±æ€§ï¼‰æ˜¯çˆ¶ç±»çš„åŸå‹å¯¹è±¡ï¼ˆ prototype å±æ€§ï¼‰çš„å®ä¾‹ã€‚\nB.prototype = Object.create(A.prototype); // ç­‰åŒäº B.prototype.__proto__ = A.prototype; extendså…³é”®å­—åé¢å¯ä»¥è·Ÿå¤šç§ç±»å‹çš„å€¼ã€‚\nğŸ“ƒ Example\nclass B extends A { } ä¸Šé¢ä»£ç çš„Aï¼Œåªè¦æ˜¯ä¸€ä¸ªæœ‰ prototype å±æ€§çš„å‡½æ•°ï¼Œå°±èƒ½è¢«Bç»§æ‰¿ã€‚ç”±äºå‡½æ•°éƒ½æœ‰ prototype å±æ€§ï¼ˆé™¤äº†Function.prototypeå‡½æ•°ï¼‰ï¼Œå› æ­¤Aå¯ä»¥æ˜¯ä»»æ„å‡½æ•°ã€‚\nä¸‹é¢ï¼Œè®¨è®ºä¸¤ç§æƒ…å†µã€‚\nå­ç±»ç»§æ‰¿ Object ç±»ã€‚\nclass A extends Object {} A.__proto__ === Object // true A.prototype.__proto__ === Object.prototype // true è¿™ç§æƒ…å†µä¸‹ï¼ŒA å…¶å®å°±æ˜¯æ„é€ å‡½æ•° Object çš„å¤åˆ¶ï¼ŒAçš„å®ä¾‹å°±æ˜¯ Object çš„å®ä¾‹ã€‚\nä¸å­˜åœ¨ä»»ä½•ç»§æ‰¿ã€‚\nclass A {} A.__proto__ === Function.prototype // true A.prototype.__proto__ === Object.prototype // true console.log(A instanceof Object); // true è¿™ç§æƒ…å†µä¸‹ï¼ŒAä½œä¸ºä¸€ä¸ªåŸºç±»ï¼ˆå³ä¸å­˜åœ¨ä»»ä½•ç»§æ‰¿ï¼‰ï¼Œå°±æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œæ‰€ä»¥ç›´æ¥ç»§æ‰¿ Function.prototype ã€‚ä½†æ˜¯ï¼ŒA è°ƒç”¨åè¿”å›ä¸€ä¸ªç©ºå¯¹è±¡ï¼ˆå³Objectå®ä¾‹ï¼‰ï¼Œæ‰€ä»¥A.prototype.__proto__æŒ‡å‘æ„é€ å‡½æ•°ï¼ˆObjectï¼‰çš„ prototype å±æ€§ã€‚\nproto of proto å­ç±»å®ä¾‹çš„ __proto__ å±æ€§çš„ __proto__ å±æ€§ï¼ŒæŒ‡å‘çˆ¶ç±»å®ä¾‹çš„ __proto__ å±æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå­ç±»çš„åŸå‹çš„åŸå‹ï¼Œæ˜¯çˆ¶ç±»çš„åŸå‹ã€‚\nğŸ“ƒ Example\nvar p1 = new Point(2, 3); var p2 = new ColorPoint(2, 3, \u0026#39;red\u0026#39;); p2.__proto__ === p1.__proto__ // false p2.__proto__.__proto__ === p1.__proto__ // true ä¸Šé¢ä»£ç ä¸­ï¼ŒColorPointç»§æ‰¿äº† Point ï¼Œå¯¼è‡´å‰è€…åŸå‹çš„åŸå‹æ˜¯åè€…çš„åŸå‹ã€‚\nå› æ­¤ï¼Œé€šè¿‡å­ç±»å®ä¾‹çš„ __proto__.__proto__ å±æ€§ï¼Œå¯ä»¥ä¿®æ”¹çˆ¶ç±»å®ä¾‹çš„è¡Œä¸ºã€‚\nğŸ“ƒ Example\np2.__proto__.__proto__.printName = function () { console.log(\u0026#39;Ha\u0026#39;); }; p1.printName() // \u0026#34;Ha\u0026#34; ä¸Šé¢ä»£ç åœ¨ColorPoint çš„å®ä¾‹ p2 ä¸Šå‘ Point ç±»æ·»åŠ æ–¹æ³•ï¼Œç»“æœå½±å“åˆ°äº† Point çš„å®ä¾‹ p1 ã€‚\nåŸç”Ÿæ„é€ å‡½æ•°çš„ç»§æ‰¿ åŸç”Ÿæ„é€ å‡½æ•°æ˜¯æŒ‡è¯­è¨€å†…ç½®çš„æ„é€ å‡½æ•°ï¼Œé€šå¸¸ç”¨æ¥ç”Ÿæˆæ•°æ®ç»“æ„ã€‚ECMAScript çš„åŸç”Ÿæ„é€ å‡½æ•°å¤§è‡´æœ‰ä¸‹é¢è¿™äº›ã€‚\nBoolean(), Number(), String(), Array(), Date(), Function(), RegExp(), Error(), Object()\nä»¥å‰ï¼Œè¿™äº›åŸç”Ÿæ„é€ å‡½æ•°æ˜¯æ— æ³•ç»§æ‰¿çš„ï¼Œæ¯”å¦‚ï¼Œä¸èƒ½è‡ªå·±å®šä¹‰ä¸€ä¸ª Array çš„å­ç±»ã€‚\nğŸ“ƒ Example\nfunction MyArray() { Array.apply(this, arguments); } MyArray.prototype = Object.create(Array.prototype, { constructor: { value: MyArray, writable: true, configurable: true, enumerable: true } }); ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ªç»§æ‰¿ Array çš„ MyArray ç±»ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªç±»çš„è¡Œä¸ºä¸ Array å®Œå…¨ä¸ä¸€è‡´ã€‚\nvar colors = new MyArray(); colors[0] = \u0026#34;red\u0026#34;; colors.length // 0 colors.length = 0; colors[0] // \u0026#34;red\u0026#34; ä¹‹æ‰€ä»¥ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œæ˜¯å› ä¸ºå­ç±»æ— æ³•è·å¾—åŸç”Ÿæ„é€ å‡½æ•°çš„å†…éƒ¨å±æ€§ï¼Œé€šè¿‡ Array.apply() æˆ–è€…åˆ†é…ç»™åŸå‹å¯¹è±¡éƒ½ä¸è¡Œã€‚åŸç”Ÿæ„é€ å‡½æ•°ä¼šå¿½ç•¥applyæ–¹æ³•ä¼ å…¥çš„ this ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒåŸç”Ÿæ„é€ å‡½æ•°çš„ this æ— æ³•ç»‘å®š ï¼Œå¯¼è‡´æ‹¿ä¸åˆ°å†…éƒ¨å±æ€§ã€‚\nES5 æ˜¯å…ˆæ–°å»ºå­ç±»çš„å®ä¾‹å¯¹è±¡ this ï¼Œå†å°†çˆ¶ç±»çš„å±æ€§æ·»åŠ åˆ°å­ç±»ä¸Šï¼Œç”±äºçˆ¶ç±»çš„å†…éƒ¨å±æ€§æ— æ³•è·å–ï¼Œå¯¼è‡´æ— æ³•ç»§æ‰¿åŸç”Ÿçš„æ„é€ å‡½æ•°ã€‚æ¯”å¦‚ï¼Œ Array æ„é€ å‡½æ•°æœ‰ä¸€ä¸ªå†…éƒ¨å±æ€§ [[DefineOwnProperty]] ï¼Œç”¨æ¥å®šä¹‰æ–°å±æ€§æ—¶ï¼Œæ›´æ–° length å±æ€§ï¼Œè¿™ä¸ªå†…éƒ¨å±æ€§æ— æ³•åœ¨å­ç±»è·å–ï¼Œå¯¼è‡´å­ç±»çš„ length å±æ€§è¡Œä¸ºä¸æ­£å¸¸ã€‚\nä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æƒ³è®©ä¸€ä¸ªæ™®é€šå¯¹è±¡ç»§æ‰¿ Error å¯¹è±¡ã€‚\nğŸ“ƒ Example\nvar e = {}; Object.getOwnPropertyNames(Error.call(e)) // [ \u0026#39;stack\u0026#39; ] Object.getOwnPropertyNames(e) // [] ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬æƒ³é€šè¿‡ Error.call(e) è¿™ç§å†™æ³•ï¼Œè®©æ™®é€šå¯¹è±¡ e å…·æœ‰ Error å¯¹è±¡çš„å®ä¾‹å±æ€§ã€‚ä½†æ˜¯ï¼ŒError.call() å®Œå…¨å¿½ç•¥ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œe æœ¬èº«æ²¡æœ‰ä»»ä½•å˜åŒ–ã€‚è¿™è¯æ˜äº†Error.call(e) è¿™ç§å†™æ³•ï¼Œæ— æ³•ç»§æ‰¿åŸç”Ÿæ„é€ å‡½æ•°ã€‚\nES6 å…è®¸ ç»§æ‰¿åŸç”Ÿæ„é€ å‡½æ•° å®šä¹‰å­ç±»ï¼Œå› ä¸º ES6 æ˜¯å…ˆæ–°å»ºçˆ¶ç±»çš„å®ä¾‹å¯¹è±¡ this ï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®é¥° this ï¼Œä½¿å¾—çˆ¶ç±»çš„æ‰€æœ‰è¡Œä¸ºéƒ½å¯ä»¥ç»§æ‰¿ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç»§æ‰¿ Array çš„ä¾‹å­ã€‚\nğŸ“ƒ Example\nclass MyArray extends Array { constructor(...args) { super(...args); } } var arr = new MyArray(); arr[0] = 12; arr.length // 1 arr.length = 0; arr[0] // undefined ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ª MyArray ç±»ï¼Œç»§æ‰¿äº† Array æ„é€ å‡½æ•°ï¼Œå› æ­¤å°±å¯ä»¥ä» MyArray ç”Ÿæˆæ•°ç»„çš„å®ä¾‹ã€‚è¿™æ„å‘³ç€ï¼ŒES6 å¯ä»¥è‡ªå®šä¹‰åŸç”Ÿæ•°æ®ç»“æ„ï¼ˆæ¯”å¦‚ Array ã€ String ç­‰ï¼‰çš„å­ç±»ï¼Œè¿™æ˜¯ ES5 æ— æ³•åšåˆ°çš„ã€‚\nä¸Šé¢è¿™ä¸ªä¾‹å­ä¹Ÿè¯´æ˜ï¼Œextends å…³é”®å­—ä¸ä»…å¯ä»¥ç”¨æ¥ç»§æ‰¿ç±»ï¼Œè¿˜å¯ä»¥ç”¨æ¥ç»§æ‰¿ åŸç”Ÿ çš„æ„é€ å‡½æ•°ã€‚å› æ­¤å¯ä»¥åœ¨åŸç”Ÿæ•°æ®ç»“æ„çš„åŸºç¡€ä¸Šï¼Œå®šä¹‰è‡ªå·±çš„æ•°æ®ç»“æ„ã€‚ä¸‹é¢å°±æ˜¯å®šä¹‰äº†ä¸€ä¸ªå¸¦ç‰ˆæœ¬åŠŸèƒ½çš„æ•°ç»„ã€‚\nğŸ“ƒ Example\nclass VersionedArray extends Array { #history = [[]]; #point = 0; constructor() { super(); } push(i) { super.push(i); return this; } commit() { while (this.#point + 1 !== this.#history.length) { // æ¸…é™¤è¶…å‡ºæŒ‡é’ˆçš„å†…å®¹ this.#history.pop(); } this.#history.push(this.slice()); this.#point++; // this.logInner(); // åˆ›é€ æ•°ç»„æµ…æ‹·è´ return this; } undo() { if (JSON.stringify(this.#history[this.#point]) !== JSON.stringify(this)) this.commit(); // è‹¥æœ‰æœªä¿å­˜çš„å†…å®¹ï¼Œåˆ™è‡ªåŠ¨æäº¤ this.splice(0, this.length, ...this.#history[--this.#point]); return this; } redo() { // this.logInner(); if (this.#history[this.#point + 1]) this.splice(0, this.length, ...this.#history[++this.#point]); return this; } logInner() { console.log(this.#point, `this.#history[${JSON.stringify(this.#history)}]`) } } const x = new VersionedArray(); console.log(x[Symbol.iterator] === [][Symbol.iterator]); // true x.push(1).push(2); console.log(x); // [1, 2] x.commit().push(3); console.log(x);// [1, 2, 3] x.undo(); console.log(x); // [1, 2] x.redo(); console.log(x); // [1, 2, 3] x.push(4).push(5).undo().redo(); console.log(x); ä¸Šé¢ä»£ç ä¸­ï¼ŒVersionedArray ä¼šé€šè¿‡ commit() æ–¹æ³•ï¼Œå°†è‡ªå·±çš„å½“å‰çŠ¶æ€ç”Ÿæˆä¸€ä¸ªç‰ˆæœ¬å¿«ç…§ï¼Œå­˜å…¥ history å±æ€§ã€‚revert() æ–¹æ³•ç”¨æ¥å°†æ•°ç»„é‡ç½®ä¸ºæœ€æ–°ä¸€æ¬¡ä¿å­˜çš„ç‰ˆæœ¬ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒVersionedArray ä¾ç„¶æ˜¯ä¸€ä¸ªæ™®é€šæ•°ç»„ï¼Œæ‰€æœ‰åŸç”Ÿçš„æ•°ç»„æ–¹æ³•éƒ½å¯ä»¥åœ¨å®ƒä¸Šé¢è°ƒç”¨ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰ Error å­ç±»çš„ä¾‹å­ï¼Œå¯ä»¥ç”¨æ¥å®šåˆ¶æŠ¥é”™æ—¶çš„è¡Œä¸ºã€‚\nğŸ“ƒ Example\nclass ExtendableError extends Error { constructor(message) { super(); this.stack = (new Error(message)).stack; // this.name = this.constructor.name; } } class MyError extends ExtendableError { constructor(m) { super(m); } } try { throw new MyError(\u0026#39;ll\u0026#39;); } catch (e) { console.log( e instanceof Error, // true e instanceof MyError, // true e.name, // Error ); console.error(e); // Error // at MyError.ExtendableError // ... } æ³¨æ„ï¼Œç»§æ‰¿ Object çš„å­ç±»ï¼Œæœ‰ä¸€ä¸ªè¡Œä¸ºå·®å¼‚ã€‚\nğŸ“ƒ Example\nclass NewObj extends Object { constructor() { super(...arguments); } } const o = new NewObj({attr: true}); console.log(o.attr === true); // false ä¸Šé¢ä»£ç ä¸­ï¼ŒNewObj ç»§æ‰¿äº† Object ï¼Œä½†æ˜¯æ— æ³•é€šè¿‡ super æ–¹æ³•å‘çˆ¶ç±» Object ä¼ å‚ã€‚\nè¿™æ˜¯å› ä¸º ES6 æ”¹å˜äº†Object æ„é€ å‡½æ•°çš„è¡Œä¸ºï¼Œä¸€æ—¦å‘ç° Object æ–¹æ³•ä¸æ˜¯é€šè¿‡ new Object() è¿™ç§å½¢å¼è°ƒç”¨ï¼ŒES6 è§„å®š Object æ„é€ å‡½æ•°ä¼šå¿½ç•¥å‚æ•°ã€‚ï¼ˆä¸èƒ½è¢«ç»§æ‰¿çš„ç§æœ‰æˆå‘˜ï¼Ÿï¼‰\nå¤šå¯¹è±¡åˆæˆ Mixin æŒ‡çš„æ˜¯å¤šä¸ªå¯¹è±¡åˆæˆä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œæ–°å¯¹è±¡å…·æœ‰å„ä¸ªç»„æˆæˆå‘˜çš„æ¥å£ã€‚å®ƒçš„æœ€ç®€å•å®ç°å¦‚ä¸‹ã€‚\nğŸ“ƒ Example\nconst a = { a: \u0026#39;a\u0026#39; }; const b = { b: \u0026#39;b\u0026#39; }; const c = {...a, ...b}; // {a: \u0026#39;a\u0026#39;, b: \u0026#39;b\u0026#39;} ä¸Šé¢ä»£ç ä¸­ï¼Œc å¯¹è±¡æ˜¯ a å¯¹è±¡å’Œ b å¯¹è±¡çš„åˆæˆï¼Œå…·æœ‰ä¸¤è€…çš„æ¥å£ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªæ›´å®Œå¤‡çš„å®ç°ï¼Œå°†å¤šä¸ªç±»çš„æ¥å£â€œæ··å…¥â€ï¼ˆmix inï¼‰å¦ä¸€ä¸ªç±»ã€‚\nğŸ“ƒ Example\nfunction mix(...mixins) { class Mix { constructor() { for (let mixin of mixins) { copyProperties(this, new mixin()); // æ‹·è´å®ä¾‹å±æ€§ } } } for (let mixin of mixins) { copyProperties(Mix, mixin); // æ‹·è´é™æ€å±æ€§ copyProperties(Mix.prototype, mixin.prototype); // æ‹·è´åŸå‹å±æ€§ } return Mix; } function copyProperties(target, source) { for (let key of Reflect.ownKeys(source)) { if ( key !== \u0026#39;constructor\u0026#39; \u0026amp;\u0026amp; key !== \u0026#39;prototype\u0026#39; \u0026amp;\u0026amp; key !== \u0026#39;name\u0026#39; ) { let desc = Object.getOwnPropertyDescriptor(source, key); Object.defineProperty(target, key, desc); } } } new mix(); ä¸Šé¢ä»£ç çš„ mix å‡½æ•°ï¼Œå¯ä»¥å°†å¤šä¸ªå¯¹è±¡åˆæˆä¸ºä¸€ä¸ªç±»ã€‚ä½¿ç”¨çš„æ—¶å€™ï¼Œåªè¦ç»§æ‰¿è¿™ä¸ªç±»å³å¯ã€‚\nclass DistributedEdit extends mix(Loggable, Serializable) { // ... } ES 2022 2021 å¹´ï¼Œå¤šé¡¹ææ¡ˆè¿›å…¥äº† TC39 çš„ Stage 4 é˜¶æ®µã€‚æŒ‰ç…§ TC39 çš„è¿ä½œæµç¨‹ï¼Œæ¯ä¸ªææ¡ˆéƒ½ä» Stage 0 å¼€å§‹ï¼Œè€Œè¿›å…¥ Stage 4 åˆ™æ„å‘³ç€è¯¥ææ¡ˆå·²è¢« ECMAScript ç¼–è¾‘ç­¾ç½²åŒæ„æ„è§ï¼Œæˆä¸ºäº†äº‹å®ä¸Šçš„æ ‡å‡†ç‰¹æ€§ã€‚\nææ¡ˆæ‰€åŒ…å«çš„ç‰¹æ€§ç›®å‰å·²ç»å¯åœ¨ Chrome 74ï¼ŒNode 12ï¼ŒSafari Technology Preview 117ï¼ŒTypeScript 3.8ï¼ŒBabel 7.0+ ç­‰ç­‰ç¯å¢ƒä¸­ä½¿ç”¨ã€‚\nInstance Fields Instance Methods Static Fields Static Methods Public Class Trainer {\npkmn = \u0026ldquo;Pikachu\u0026rdquo;\n} Class Pokemon { attack() {\u0026hellip;}} Class pokemon { static pkdx = {\u0026hellip;}} Class Pokemon { static starter() {\n\u0026hellip;\n} Pirvate Class Trainer {#pkmn = \u0026ldquo;Raikow\u0026rdquo;} Class Pokemon { #evolve() {\u0026hellip;}} Class pokemon { static mobs = [\u0026hellip;]} Class Pokemon { static #teleport() { \u0026hellip;\n} class Base { name: string; constructor() { this.initProps(); } initProps() { this.name = \u0026#39;xxx\u0026#39;; } } class Derived extends Base { age: number; initProps() { super.initProps(); this.age = 10; } } const d = new Derived(); console.log(d.age); Private Fields, Methods è¯¥ææ¡ˆå±äº Class Fields ç³»åˆ—ææ¡ˆçš„ä¸€éƒ¨åˆ†ï¼Œå…¶ä½¿ç”¨ # å‰ç¼€å®šä¹‰ç±»çš„ ç§æœ‰æ–¹æ³• å’Œå­—æ®µã€‚\nclass Example { #value; constructor(value) { this.#value = value; } #calc() { return this.#value * 10; } print() { console.log(this.#calc()); } } const object = new Example(5); console.log(object.#value); // SyntaxErrorconsole.log(object.#calc()); // SyntaxErrorobject.print(); // 50 Public Static Class Fields åœ¨ä¹‹å‰çš„ç±»çš„å­—æ®µå’Œç§æœ‰æ–¹æ³•ææ¡ˆçš„åŸºç¡€ä¸Šï¼Œè¯¥ææ¡ˆä¸º JavaScript ç±»å¢åŠ äº† é™æ€å…¬å…±å­—æ®µStatic public fieldsã€é™æ€ç§æœ‰æ–¹æ³•Static private methods å’Œ é™æ€ç§æœ‰å­—æ®µStatic private fields çš„ç‰¹æ€§ã€‚\n// without static class fields class Customer { // ... } Customer.idCounter = 1; // with static class fields class Customer { static idCounter = 1; // ... } Private Fields In Operator æ£€æµ‹ç§æœ‰å­—æ®µæ˜¯å¦å­˜åœ¨ã€‚\nç”±äºå°è¯•è®¿é—®å¯¹è±¡ä¸Šä¸å­˜åœ¨çš„ç§æœ‰å­—æ®µä¼šå¼•å‘å¼‚å¸¸ï¼Œå› æ­¤éœ€è¦èƒ½å¤Ÿæ£€æŸ¥å¯¹è±¡æ˜¯å¦å…·æœ‰ç»™å®šçš„ç§æœ‰å­—æ®µã€‚\nè¿™ä¸ªææ¡ˆæä¾›äº†ä½¿ç”¨ in æ“ä½œç¬¦æ¥åˆ¤æ–­å‰ä¸ä¹…æ­£å¼è¿›å…¥ Stage 4 çš„ Class Private Fields ææ¡ˆä¸­å¼•å…¥çš„ å­—æ®µ æ˜¯å¦åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­å­˜åœ¨ã€‚ç›¸æ¯”äºç›´æ¥é€šè¿‡è®¿é—®ç§æœ‰å­—æ®µ\ntry { obj.#foo } catch { /* #foo not exist in obj */ } æ¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æœ‰å®‰è£…å¯¹åº”çš„ å­—æ®µ æ¥è¯´ï¼ŒPrivate-In å¯ä»¥åŒºåˆ†æ˜¯è®¿é—®é”™è¯¯ï¼Œè¿˜æ˜¯çœŸæ­£æ²¡æœ‰ å­—æ®µ ï¼Œå¦‚ä»¥ä¸‹åœºæ™¯é€šè¿‡ try-catch å°±æ— æ³•åŒºåˆ†æ˜¯å¦æ˜¯è®¿é—®å¼‚å¸¸è¿˜æ˜¯ å­—æ®µ ç¡®å®ä¸å­˜åœ¨ï¼š\nclass C { get #getter() { throw new Error(\u0026#39;gotcha\u0026#39;); } static isC(obj) { try { obj.#getter; return true; } catch { return false; } } } è€Œé€šè¿‡ä¸æ™®é€šå­—æ®µç±»ä¼¼çš„ in æ“ä½œç¬¦è¯­ä¹‰å¯åˆ¤æ–­ä¸€ä¸ª #field æ˜¯å¦å­˜åœ¨åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šï¼š\nclass C { #brand; #method() { } get #getter() { } static isC(obj) { return #brand in obj \u0026amp;\u0026amp; #method in obj \u0026amp;\u0026amp; #getter in obj; } } Class Static Initialization Blocks ç±»é™æ€åˆå§‹åŒ–å—Class Static Initialization Blocks æä¾›äº†ä¸€ç§åœ¨ç±»å£°æ˜/å®šä¹‰æœŸé—´è¯„ä¼°é™æ€åˆå§‹åŒ–ä»£ç å—çš„æ–¹å¼ï¼Œå¯ä»¥è®¿é—®ç±»çš„ ç§æœ‰å­—æ®µClass Private Fieldsã€‚\nè‡ªä»æœ‰äº† Class Private Fieldsï¼Œå¯¹äºç±»çš„è¯­æ³•æ˜¯ä¸æ–­åœ°æœ‰æ–°çš„å®è·µä¸éœ€æ±‚ã€‚è¿™ä¸ªææ¡ˆæè®®çš„ç±»é™æ€åˆå§‹åŒ–å—ä¼šåœ¨ç±»åˆå§‹åŒ–æ—¶è¢«æ‰§è¡Œã€‚Java ç­‰è¯­è¨€ä¸­ä¹Ÿæœ‰ç±»ä¼¼çš„é™æ€åˆå§‹åŒ–ä»£ç å—çš„èƒ½åŠ›ï¼ŒStatic Initialization Blocksã€‚\nææ¡ˆä¸­å®šä¹‰çš„åˆå§‹åŒ–ä»£ç å—å¯ä»¥è·å¾— class å†…çš„ä½œç”¨åŸŸï¼Œå¦‚åŒ class çš„æ–¹æ³•ä¸€æ ·ï¼Œä¹Ÿæ„å‘³ç€å¯ä»¥è®¿é—®ç±»çš„ #å­—æ®µã€‚é€šè¿‡è¿™ä¸ªå®šä¹‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç° JavaScript ä¸­çš„ Friend ç±»äº†ã€‚\nclass Example { // Class static initialization blocks static propertyA; static #propertyB; // private static { // static initializer block try { const json = JSON.parse(fs.readFileSync(\u0026#39;example.json\u0026#39;, \u0026#39;utf8\u0026#39;)); this.propertyA = json.someProperty; this.#propertyB = json.anotherProperty; } catch (error) { this.propertyA = \u0026#39;default1\u0026#39;; this.#propertyB = \u0026#39;default2\u0026#39;; } } static print() { console.log(Example.propertyA); console.log(Example.#propertyB); } } Example.print(); Relative indexing .at() method åœ¨æ‰€æœ‰å†…ç½®çš„å¯ç´¢å¼•æ•°æ®ä¸Šæ–°å¢ .at() æ–¹æ³•ã€‚\nè¯¥ææ¡ˆæä¾›äº†ä¸€ç§ä»å­—ç¬¦ä¸²ï¼ˆæˆ–æ•°ç»„ï¼‰çš„å¼€å¤´ï¼ˆæ­£å‘ç´¢å¼•ï¼‰æˆ–ç»“å°¾ï¼ˆåå‘ç´¢å¼•ï¼‰è·å–å…ƒç´ çš„æ–¹æ³•ï¼Œæ— éœ€ä½¿ç”¨ä¸´æ—¶å˜é‡ã€‚\nå¾ˆå¤šæ—¶å€™ï¼Œç±»ä¼¼äº Python ä¸­çš„æ•°ç»„è´Ÿå€¼ç´¢å¼•éå¸¸å®ç”¨ã€‚æ¯”å¦‚åœ¨ Python ä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡ arr[-1] æ¥è®¿é—®æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œè€Œä¸ç”¨é€šè¿‡ç›®å‰ JavaScript ä¸­çš„æ–¹å¼ arr[arr.length-1] æ¥è®¿é—®ã€‚è¿™é‡Œçš„è´Ÿæ•°æ˜¯ä½œä¸ºä»èµ·å§‹å…ƒç´ ï¼ˆå³ arr[0] ï¼‰å¼€å§‹çš„åå‘ç´¢å¼•ã€‚\nä½†æ˜¯ç°åœ¨ JavaScript ä¸­çš„é—®é¢˜æ˜¯ï¼Œ[] è¿™ä¸ªè¯­æ³•ä¸ä»…ä»…åªæ˜¯åœ¨æ•°ç»„ä¸­ä½¿ç”¨ï¼ˆå½“ç„¶åœ¨ Python ä¸­ä¹Ÿä¸æ˜¯ï¼‰ï¼Œè€Œåœ¨æ•°ç»„ä¸­ä¹Ÿä¸ä»…ä»…åªå¯ä»¥ä½œä¸ºç´¢å¼•ä½¿ç”¨ã€‚åƒ arr[1] ä¸€æ ·é€šè¿‡ç´¢å¼•å¼•ç”¨ä¸€ä¸ªå€¼ï¼Œäº‹å®ä¸Šå¼•ç”¨çš„æ˜¯è¿™ä¸ªå¯¹è±¡çš„ \u0026ldquo;1\u0026rdquo; è¿™ä¸ªå±æ€§ã€‚æ‰€ä»¥ arr[-1] å·²ç»å®Œå…¨å¯ä»¥åœ¨ç°åœ¨çš„ JavaScript å¼•æ“ä¸­ä½¿ç”¨ï¼Œåªæ˜¯å®ƒå¯èƒ½ä¸æ˜¯ä»£è¡¨çš„æˆ‘ä»¬æƒ³è¦è¡¨è¾¾çš„æ„æ€è€Œå·²ï¼šå®ƒå¼•ç”¨çš„æ˜¯ç›®æ ‡å¯¹è±¡çš„ \u0026quot;-1\u0026quot; è¿™ä¸ªå±æ€§ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªåå‘ç´¢å¼•ã€‚\nè¿™ä¸ªææ¡ˆæä¾›äº†ä¸€ä¸ªé€šç”¨çš„æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»»æ„å¯ç´¢å¼•çš„ç±»å‹ï¼ˆArray, String, TypedArrayï¼‰ä¸Šçš„ .at() æ–¹æ³•ï¼Œæ¥è®¿é—®ä»»æ„ä¸€ä¸ªåå‘ç´¢å¼•ã€æˆ–è€…æ˜¯æ­£å‘ç´¢å¼•çš„å…ƒç´ ã€‚\nArray.prototype.at = null; // é—­åŒ…ä¸ºæ²¡æœ‰at()çš„æ—¶å€™æ·»åŠ å…¼å®¹ (fn =\u0026gt; Array.prototype.at = fn )(!Array.prototype.at \u0026amp;\u0026amp; (function (i) { return i \u0026gt; 0 ? this[i] : this[this.length + i]; } )); console.log( // æ•°ç»„ [0, 1, 2, 3, 4, 5].at(1), // =\u0026gt; 1 [0, 1, 2, 3, 4, 5].at(-2), // =\u0026gt; 4 // å­—ç¬¦ä¸² \u0026#39;abcdefghi\u0026#39;.at(1), // =\u0026gt; b \u0026#39;abcdefghi\u0026#39;.at(-2), // =\u0026gt; h ); Object.hasOwn ç®€å•æ¥è¯´ï¼Œè¯¥ææ¡ˆå°±æ˜¯ä½¿ç”¨ Object.hasOwn æ›¿ä»£Object.prototype.hasOwnProperty.call(obj, \u0026lsquo;attr\u0026rsquo;) / obj.hasOwnProperty(\u0026lsquo;attr\u0026rsquo;)ï¼Œæ˜¯ä¸€ç§æ›´ç®€æ´ã€æ›´å¯é åœ°æ£€æŸ¥å±æ€§æ˜¯å¦ç›´æ¥è®¾ç½®åœ¨å¯¹è±¡ä¸Šçš„æ–¹æ³•ã€‚\nObject.hasOwn = null; (fn =\u0026gt; Object.hasOwn = fn)( !Object.hasOwn \u0026amp;\u0026amp; Object.prototype.hasOwnProperty.call ) let symbol = Symbol(\u0026#39;s\u0026#39;); const proto = {proto: \u0026#39;foo\u0026#39;}; const example = Object.create(proto, { property: { value: \u0026#39;123\u0026#39; }, }); console.log([ Object.prototype.hasOwnProperty.call(example, [\u0026#39;proto\u0026#39;]), // false example.hasOwnProperty(\u0026#39;proto\u0026#39;) // false ]); console.log([ Object.prototype.hasOwnProperty.call(example, [\u0026#39;property\u0026#39;]), // true example.hasOwnProperty(\u0026#39;property\u0026#39;) // true ]); // console.log(Object.hasOwn(example, \u0026#39;l\u0026#39;)); // preferred Error Cause Error Cause æ˜¯é˜¿é‡Œå·´å·´æå‡ºçš„ææ¡ˆï¼Œæ®ç§°ä¹Ÿæ˜¯ä¸­å›½é¦–ä¸ªè¿›å…¥ Stage 4 çš„ TC39 ææ¡ˆã€‚\næ­¤ææ¡ˆä¸º JavaScript ä¸­çš„ Error æ„é€ å‡½æ•°æ–°å¢äº†ä¸€ä¸ªå±æ€§ causeï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡è¿™ä¸ªå±æ€§ä¸ºæŠ›å‡ºçš„é”™è¯¯é™„åŠ é”™è¯¯åŸå› ï¼Œæ¥æ¸…æ™°åœ°è·¨è¶Šå¤šä¸ªè°ƒç”¨æ ˆä¼ é€’é”™è¯¯ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚å…·ä½“æ¥è¯´ï¼Œè¯¥ææ¡ˆä¸º Error Constructor æ–°å¢äº†ä¸€ä¸ªå¯é€‰çš„å‚æ•° optionsï¼Œå…¶ä¸­å¯ä»¥è®¾ç½® cause å¹¶ä¸”æ¥å—ä»»æ„ JavaScript å€¼ï¼ˆJavaScript å¯ä»¥ throw ä»»æ„å€¼ï¼Œå¦‚ undefined æˆ–è€…å­—ç¬¦ä¸²ï¼‰ï¼Œå°†è¿™ä¸ªå€¼èµ‹å€¼åˆ°æ–°åˆ›å»ºçš„ error.cause ä¸Šã€‚\n// ES6å…è®¸é€šè¿‡extendsç»§æ‰¿åŸç”Ÿæ„é€ å‡½æ•° class ErrorWithCause extends Error { constructor(err, {cause = null} = {}) { super(); let error = new Error(err); this.stack = error.stack; this.message=error.message; this.cause = cause; this.name = this.constructor.name; } toString(){ return(`${this.name}: ${this.message}`); } } async function errorCause() { return await Promise.reject() // æŠ›å‡ºä¸€ä¸ª low level é”™è¯¯ .catch(() =\u0026gt; { // åŸæ¥ä½¿ç”¨fetchçš„å†™æ³•æ—¶ï¼Œè·³è¿‡äº†å†…éƒ¨Promiseé‡Œçš„catchç›´æ¥æŠ›å‡ºäº†æ™®é€šError() throw new ErrorWithCause(\u0026#39;Download raw resource failed\u0026#39;, {cause: \u0026#39;Failed to fetch\u0026#39;}) // å°† low level é”™è¯¯åŒ…è£…æˆä¸€ä¸ª high levelã€æ˜“æ‡‚çš„é”™è¯¯ }); } errorCause().catch(err =\u0026gt; { console.log(err.toString()); console.log(`Caused by: ${err.cause}`); // Error: Download raw resource failed // Caused by: Failed to fetch console.log(err instanceof Error); // true console.log(err instanceof ErrorWithCause); // true }) RegExp Match Indices (\u0026rsquo;d\u0026rsquo; Flag) å½“å‰ ECMAScript ä¸­çš„ RegExp.prototype.exec æ–¹æ³•çš„è¿”å›å€¼å·²ç»æä¾›äº†å¯¹äºåŒ¹é…çš„æ•è·ç»„Capture Group æ–‡æœ¬ä¸å¯¹åº”çš„æ•è·ç»„åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ç´¢å¼•ã€‚ä½†æ˜¯ï¼Œæœ‰äº›åœºæ™¯ä¸‹æˆ‘ä»¬ä¸ä»…ä»…åªæ˜¯å¸Œæœ›åŒ¹é…æ–‡æœ¬ï¼Œæ›´éœ€è¦è·å¾—è¢«åŒ¹é…çš„æ–‡æœ¬åœ¨è¾“å‡ºæ–‡æœ¬ä¸­çš„èµ·å§‹ä½ç½®ä¸ç»“æŸä½ç½®ï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸ç”¨çš„ VS Code ç­‰å¼€å‘ç¯å¢ƒæä¾›è¯­æ³•é«˜äº®å°±éœ€è¦è¿™äº›ä¿¡æ¯ã€‚å› æ­¤ï¼ŒRegExp Match Indices (\u0026rsquo;d\u0026rsquo; Flag) ææ¡ˆæœŸæœ›å‘ RegExp.prototype.exec è¿”å›çš„æ•°ç»„å¯¹è±¡ä¸Šï¼Œæ–°å¢ indices å±æ€§ç”¨æ¥æè¿°è¿™äº›ä½ç½®ä¿¡æ¯ã€‚\nconst text = \u0026#34;Let\u0026#39;s match one:1.\u0026#34;; const regexp = /matchs(?\u0026lt;word\u0026gt;w+):(?\u0026lt;digit\u0026gt;d)/gd; for (const match of text.matchAll(regexp)) { console.log(match); } Top-Level await ECMAScript 2017 å¼€å§‹å¼•å…¥äº† å¼‚æ­¥å‡½æ•°Async functions å’Œ await å…³é”®å­—ï¼Œæ­¤ç‰¹æ€§å¤§å¤§ç®€åŒ–äº†å¯¹ Promise çš„ä½¿ç”¨ã€‚ä¸è¿‡ await åªèƒ½åœ¨ Async functions å†…éƒ¨ä½¿ç”¨ã€‚\næ–°çš„ææ¡ˆ Top-Level await åˆ™å…è®¸åœ¨ Async functions ä¹‹å¤–ä½¿ç”¨ awaitï¼ˆä¾‹å¦‚ CLI è„šæœ¬ï¼Œä»¥åŠåŠ¨æ€å¯¼å…¥å’Œæ•°æ®åŠ è½½ï¼‰ã€‚è¯¥ææ¡ˆå°† ES Modules å½“åšå¤§å‹çš„ Async functionsï¼Œå› æ­¤è¿™äº› ES Modules å¯ä»¥ç­‰å¾…èµ„æºåŠ è½½ï¼Œè¿™æ ·å…¶ä»–å¯¼å…¥è¿™äº›æ¨¡å—çš„æ¨¡å—åœ¨å¼€å§‹æ‰§è¡Œè‡ªå·±çš„ä»£ç ä¹‹å‰ä¹Ÿè¦ç­‰å¾…èµ„æºåŠ è½½å®Œå†å»æ‰§è¡Œã€‚\n// load-attribute.mjs // with top-level await const data = await (await fetch(JSON.parse(data))); // main.mjs // loaded after load-attribute.mjs is fully loaded // and its exports are available import { attribute } from \u0026#34;./load-attribute.mjs\u0026#34;; console.log(attribute); Module åœ¨ ES6 å‰ï¼Œ å®ç°æ¨¡å—åŒ–ä½¿ç”¨çš„æ˜¯ [RequireJS](11 Node/#requirejs) æˆ–è€… [SeaJS](11 Node/#seajs)ï¼ˆåˆ†åˆ«æ˜¯åŸºäº [AMD](11 Node/#amd) è§„èŒƒçš„æ¨¡å—åŒ–åº“ï¼Œ å’ŒåŸºäº [CMD](11 Node/#cmd) è§„èŒƒçš„æ¨¡å—åŒ–åº“ï¼‰ã€‚\nES6 å¼•å…¥äº†æ¨¡å—åŒ–ï¼Œå…¶è®¾è®¡æ€æƒ³æ˜¯åœ¨ ç¼–è¯‘*^compile^* æ—¶å°±èƒ½ç¡®å®šæ¨¡å—çš„ä¾èµ–å…³ç³»ï¼Œä»¥åŠè¾“å…¥å’Œè¾“å‡ºçš„å˜é‡ã€‚è€Œä¼ ç»Ÿçš„ CommonJS çš„ä¸è¶³ï¼Œåœ¨äºåªèƒ½åœ¨ è¿è¡Œ*^runtime^* æ—¶ç¡®å®šã€‚\n:link: Href å…³äº ES Module çš„åŠ è½½ï¼Œè§ Node.js [ES Module](11 Node/#es-module) ä¸€ç« ã€‚\nğŸ“ƒ Example CommonJS å¯¼å…¥\n// CommonJSæ¨¡å— let { stat, exists, readfile } = require(\u0026#39;fs\u0026#39;); // ç­‰åŒäº let _fs = require(\u0026#39;fs\u0026#39;); let stat = _fs.stat; let exists = _fs.exists; let readfile = _fs.readfile; ä¸Šé¢ä»£ç çš„å®è´¨æ˜¯æ•´ä½“åŠ è½½ fs æ¨¡å—ï¼ˆå³åŠ è½½ fs çš„æ‰€æœ‰æ–¹æ³•ï¼‰ï¼Œç”Ÿæˆä¸€ä¸ªå¯¹è±¡object _fs ï¼Œç„¶åå†ä»è¿™ä¸ªå¯¹è±¡ä¸Šé¢è¯»å– 3 ä¸ªæ–¹æ³•ã€‚è¿™ç§åŠ è½½ç§°ä¸º è¿è¡Œæ—¶åŠ è½½load at runtime ï¼Œå› ä¸ºåªæœ‰è¿è¡Œæ—¶æ‰èƒ½å¾—åˆ°è¿™ä¸ªå¯¹è±¡ï¼Œå¯¼è‡´å®Œå…¨æ²¡åŠæ³•åœ¨ç¼–è¯‘æ—¶åš é™æ€ä¼˜åŒ–static optimization ã€‚\n:memo: Note WebStrom å¯ä»¥åœ¨è¿è¡Œå‰è·å–å¯¹è±¡æˆå‘˜ã€‚\nES6 çš„æ¨¡å—åŒ–åˆ†ä¸º å¯¼å‡º*^export^* ä¸ å¯¼å…¥*^import^* ä¸¤ä¸ªæ–¹æ³•ã€‚\nç‰¹ç‚¹ ES6 æ¨¡å—ä¸æ˜¯å¯¹è±¡ï¼Œè€Œæ˜¯é€šè¿‡ export å‘½ä»¤æ˜¾å¼æŒ‡å®šè¾“å‡ºçš„ä»£ç ï¼Œå†é€šè¿‡ import å‘½ä»¤è¾“å…¥ã€‚\nğŸ“ƒ Example\n// ES6æ¨¡å— import { stat, exists, readFile } from \u0026#39;fs\u0026#39;; ä¸Šé¢ä»£ç çš„å®è´¨æ˜¯ä» fs æ¨¡å—åŠ è½½ 3 ä¸ªæ–¹æ³•ï¼Œå…¶ä»–æ–¹æ³•ä¸åŠ è½½ã€‚\nè¿™ç§åŠ è½½ç§°ä¸º ç¼–è¯‘æ—¶åŠ è½½load at compile time æˆ–è€… é™æ€åŠ è½½static loading ï¼Œå³ ES6 å¯ä»¥åœ¨ ç¼–è¯‘*^compile^* æ—¶å°±å®Œæˆæ¨¡å—åŠ è½½ï¼Œæ•ˆç‡è¦æ¯” CommonJS æ¨¡å—çš„åŠ è½½æ–¹å¼é«˜ã€‚å½“ç„¶ï¼Œè¿™ä¹Ÿå¯¼è‡´äº†æ²¡æ³•å¼•ç”¨ ES6 æ¨¡å—æœ¬èº«ï¼Œå› ä¸ºå®ƒä¸æ˜¯å¯¹è±¡ã€‚\næ¨¡å—ä¸­å¯ä»¥å¯¼å…¥å’Œå¯¼å‡ºå„ç§ç±»å‹çš„å˜é‡ï¼Œå¦‚ å‡½æ•°*^function^, å¯¹è±¡^object^* , å­—ç¬¦ä¸²*^string^* , æ•°å­—*^number^* , å¸ƒå°”å€¼*^boolean^* , ç±»*^class^* ç­‰ã€‚\næ¯ä¸ªæ¨¡å—éƒ½æœ‰è‡ªå·±çš„ ä¸Šä¸‹æ–‡context ï¼Œæ¯ä¸€ä¸ªæ¨¡å—å†…å£°æ˜çš„å˜é‡éƒ½æ˜¯ å±€éƒ¨å˜é‡*^locale^* ï¼Œä¸ä¼šæ±¡æŸ“ å…¨å±€ä½œç”¨åŸŸ*^global-scope^* ã€‚\næ¯ä¸€ä¸ªæ¨¡å—åªåŠ è½½ä¸€æ¬¡ï¼ˆæ˜¯å•ä¾‹çš„ï¼‰ï¼Œ è‹¥å†å»åŠ è½½åŒç›®å½•ä¸‹åŒæ–‡ä»¶ï¼Œç›´æ¥ä» å†…å­˜*^memory^* ä¸­è¯»å–ã€‚\né™¤äº†é™æ€åŠ è½½å¸¦æ¥çš„å„ç§å¥½å¤„ï¼ŒES6 æ¨¡å—è¿˜æœ‰ä»¥ä¸‹å¥½å¤„ï¼š\nä¸å†éœ€è¦ UMD universal model definition æ¨¡å—è§„èŒƒ å°†æ¥æµè§ˆå™¨çš„æ–° API å°±èƒ½ç”¨æ¨¡å—æ ¼å¼æä¾›ï¼Œä¸å†å¿…é¡»åšæˆ å…¨å±€å˜é‡*^global^* æˆ–è€… navigator å¯¹è±¡çš„å±æ€§ã€‚ ä¸å†éœ€è¦å¯¹è±¡ä½œä¸º å‘½åç©ºé—´*^namespace^*ï¼Œæœªæ¥è¿™äº›åŠŸèƒ½å¯ä»¥é€šè¿‡æ¨¡å—æä¾›ã€‚ ä¸¥æ ¼æ¨¡å¼ ES6 çš„æ¨¡å—è‡ªåŠ¨å¼€å¯ ä¸¥æ ¼æ¨¡å¼ ï¼Œä¸ç®¡æ¨¡å—å¤´éƒ¨æœ‰æ—  'use strict' ã€‚\n:memo: Note [ä¸¥æ ¼æ¨¡å¼strict mode](06 EcmaScript A/#strict-mode-es6) ES5 æ—¶å³å¼•å…¥ã€‚\nExport export ç”¨äºè§„èŒƒæ¨¡å—çš„å¯¹å¤–æ¥å£ã€‚\nå¯¼å‡ºçš„å‡½æ•°å£°æ˜ä¸ç±»å£°æ˜å¿…é¡»è¦æœ‰åç§°ï¼ˆexport default å‘½ä»¤å¦å¤–è€ƒè™‘ï¼‰ ä¸ä»…èƒ½å¯¼å‡º å£°æ˜*^declare^* è¿˜èƒ½å¯¼å‡º å¼•ç”¨reference e.g.:function export å‘½ä»¤ä¸å—æ¨¡å—çš„ä½ç½®å½±å“ï¼Œä½†å¿…é¡»å¤„äºæ¨¡å— é¡¶å±‚*^top-level^* ğŸ“ƒ Example\n/* module.js */ let myName = \u0026#34;Tom\u0026#34;; let myAge = 20; let fun = function () { return \u0026#34;My name is\u0026#34; + myName + \u0026#34;! I\u0026#39;m \u0026#39;\u0026#34; + myAge + \u0026#34;years old.\u0026#34; } let myClass = class myClass { static a = \u0026#34;yeah!\u0026#34;; } export {myName, myAge, fun, myClass}; /* main.js */ import {myName, myAge, fun, myClass} from \u0026#34;./module.js\u0026#34;; console.log(fun()); // My name is Tom! I\u0026#39;m 20 years old. console.log(myAge); // 20 console.log(myName); // Tom console.log(myClass.a); // yeah! :memo: Note Node.jsÂ æ”¯æŒ ESMÂ æ—¶éœ€è¦å°†æ–‡ä»¶æ‹“å±•åæ”¹ä¸º .mjsÂ æˆ–åœ¨ package.jsonÂ ä¸­å°† typeÂ å­—æ®µè®¾ç½®ä¸º moduleÂ ã€‚\nå¯ä»¥ä½¿ç”¨ as å…³é”®å­—ä¸ºå¯¼å‡ºçš„å˜é‡åˆ›å»ºåˆ«åã€‚å¦‚ä¸ä½¿ç”¨ export ç›´æ¥å¯¼å‡ºå˜é‡ï¼Œéœ€æ·»åŠ  å¤§æ‹¬å·*^{}^* åŒ…è£¹éœ€å¯¼å‡ºçš„å˜é‡ã€‚\nğŸ“ƒ Example\n/* module.js */ export const firstName = \u0026#39;Michael\u0026#39;; const lastName = \u0026#39;Jackson\u0026#39;; const year = 1958; export {lastName, year as yr}; å¦å¤–ï¼Œexport è¯­å¥è¾“å‡ºçš„æ¥å£ï¼Œä¸å…¶å¯¹åº”çš„å€¼æ˜¯ åŠ¨æ€ç»‘å®š*^dynamic-binding^* å…³ç³»ï¼Œå³é€šè¿‡è¯¥æ¥å£ï¼Œå¯ä»¥å–åˆ°æ¨¡å—å†…éƒ¨å®æ—¶çš„å€¼ã€‚\nğŸ“ƒ Example\nES Module /* main.js */ import {foo} from \u0026#39;./module.js\u0026#39;; console.log(foo); setTimeout(() =\u0026gt; console.log(foo), 1100); /* module.js */ export let foo = \u0026#39;bar\u0026#39;; setTimeout(() =\u0026gt; foo = \u0026#39;baz\u0026#39;, 1000); ä¸Šé¢ä»£ç è¾“å‡ºå˜é‡ foo ï¼Œå€¼ä¸º bar ï¼Œ1.1 ç§’ä¹‹åå˜æˆ baz ã€‚\nCommonJS /* main.js */ let {foo} = require (\u0026#39;./module.js\u0026#39;); console.log(foo); setTimeout(() =\u0026gt; console.log(foo), 1100); /* module.js */ let foo = \u0026#39;bar\u0026#39;; module.exports = {foo}; setTimeout(() =\u0026gt; foo = \u0026#39;baz\u0026#39;, 1000); ä¸Šé¢ä»£ç è¾“å‡ºå˜é‡ foo ï¼Œå€¼ä¸º bar ï¼Œ1.1 ç§’ä¹‹ä¸ä¼šæ”¹å˜ï¼Œä»ç„¶æ˜¯ bar ã€‚\nè¿™ä¸€ç‚¹ä¸ CommonJS è§„èŒƒå®Œå…¨ä¸åŒã€‚CommonJS æ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„ æ‹·è´*^copy^* ï¼Œä¸å­˜åœ¨åŠ¨æ€æ›´æ–°ã€‚è¿™æ˜¯ç”±äº Node.js åœ¨ [å…·ä½“å®ç°](11 Node/#commomjs-javascript-load) ä¸Šï¼Œè·å–åŸæ¨¡å—çš„ä»£ç ååˆç”¨ new Function() é‡æ–°åŒ…è£…äº†ä¸€éï¼Œå› æ­¤åŸæ¨¡å—ä¸­çš„ä»£ç æ— æ³•å½±å“ require() è·å–çš„å†…å®¹ã€‚\nè€Œ ES Module ä¸æ˜¯å¯¹è±¡ï¼Œå®ƒçš„å¯¹å¤–æ¥å£åªæ˜¯ä¸€ç§é™æ€å®šä¹‰ï¼Œåœ¨ä»£ç é™æ€è§£æé˜¶æ®µå°±ä¼šç”Ÿæˆï¼Œè¿è¡Œæ—¶åŠ¨æ€å¼•ç”¨ï¼Œå…¶å®ç°ç±»ä¼¼äº Unix ç³»ç»Ÿçš„ ç¬¦å·è¿æ¥symbolic link ã€‚\næœ€ååï¼ŒexportÂ å‘½ä»¤å¯ä»¥å‡ºç°åœ¨æ¨¡å—çš„ä»»ä½•ä½ç½®ï¼Œåªè¦å¤„äº æ¨¡å—é¡¶å±‚*^top-level^* å°±å¯ä»¥ã€‚å¦‚æœå¤„äºå—çº§ä½œç”¨åŸŸå†…ï¼Œå°±ä¼šæŠ¥é”™ï¼ŒimportÂ å‘½ä»¤ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œè¿™æ˜¯å‡ºäº é™æ€ä¼˜åŒ–*^static-optimization^* çš„è€ƒè™‘ã€‚\nExport default ç”±äºï¼Œä½¿ç”¨ importÂ å‘½ä»¤çš„æ—¶å€™ï¼Œç”¨æˆ·éœ€è¦çŸ¥é“æ‰€è¦åŠ è½½çš„å˜é‡åæˆ–å‡½æ•°åï¼Œå¦åˆ™æ— æ³•åŠ è½½ã€‚ä½†æ˜¯ï¼Œç”¨æˆ·è‚¯å®šå¸Œæœ›å¿«é€Ÿä¸Šæ‰‹ï¼Œæœªå¿…æ„¿æ„é˜…è¯»æ–‡æ¡£ï¼Œå»äº†è§£æ¨¡å—æœ‰å“ªäº›å±æ€§å’Œæ–¹æ³•ã€‚\nä¸ºäº†ç»™ç”¨æˆ·æä¾›æ–¹ä¾¿ï¼Œè®©ä»–ä»¬ä¸ç”¨é˜…è¯»æ–‡æ¡£å°±èƒ½åŠ è½½æ¨¡å—ï¼Œå¯ä»¥ä½¿ç”¨ export default å‘½ä»¤ï¼Œä¸ºæ¨¡å—æŒ‡å®šé»˜è®¤è¾“å‡ºã€‚\nä½œä¸ºå¯¹æ¯”ï¼ŒåŸæ¥çš„æ–¹æ³•è¢«ç§°ä¸º named exportÂ ã€‚\nğŸ“ƒ Example\n/* export-default.js */ export default function () { console.log(\u0026#39;foo\u0026#39;); } ä¸Šé¢ä»£ç æ˜¯ä¸€ä¸ªæ¨¡å—æ–‡ä»¶ export-default.js ï¼Œå®ƒçš„é»˜è®¤è¾“å‡ºæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚\nå…¶ä»–æ¨¡å—åŠ è½½è¯¥æ¨¡å—æ—¶ï¼Œimport å‘½ä»¤å¯ä»¥ä¸ºè¯¥åŒ¿åå‡½æ•°æŒ‡å®šä»»æ„åå­—ã€‚\n/* import-default.js */ import customName from \u0026#39;./export-default\u0026#39;; customName(); // \u0026#39;foo\u0026#39; ä¸Šé¢ä»£ç çš„ import å‘½ä»¤ï¼Œå¯ä»¥ç”¨ä»»æ„åç§°æŒ‡å‘ export-default.js è¾“å‡ºçš„æ–¹æ³•ï¼Œè¿™æ—¶å°±ä¸éœ€è¦çŸ¥é“åŸæ¨¡å—è¾“å‡ºçš„å‡½æ•°åã€‚\n:exclamation:Warning import default å‘½ä»¤åé¢ï¼Œä¸ä½¿ç”¨ å¤§æ‹¬å·*^{}^*ã€‚\næœ¬è´¨ä¸Šï¼Œexport default å°±æ˜¯è¾“å‡ºä¸€ä¸ªå«åš default çš„å˜é‡æˆ–æ–¹æ³•ï¼Œç„¶åç³»ç»Ÿå…è®¸ä½ ä¸ºå®ƒå–ä»»æ„åå­—ã€‚\n:warning: Caution é”™è¯¯ç¤ºä¾‹\n// æ­£ç¡® export let a = 1; // æ­£ç¡® let a = 1; export default a; // é”™è¯¯ export default let a = 1; ä¸Šé¢ä»£ç ä¸­ï¼Œexport default aÂ çš„å«ä¹‰æ˜¯å°†å˜é‡ aÂ çš„å€¼èµ‹ç»™å˜é‡defaultÂ ã€‚æ‰€ä»¥ï¼Œæœ€åä¸€ç§å†™æ³•ä¼šæŠ¥é”™ã€‚\nexport default å‘½ä»¤çš„æœ¬è´¨æ˜¯å°†åé¢çš„å€¼ï¼Œèµ‹ç»™ default å˜é‡ï¼Œæ‰€ä»¥å®ƒåé¢ä¸èƒ½è·Ÿå˜é‡ å£°æ˜*^statement^* è¯­å¥ï¼Œä½†å¯ä»¥ç›´æ¥å°†ä¸€ä¸ªå€¼å†™åœ¨ export default ä¹‹åã€‚\nğŸ“ƒ Example\n// æ­£ç¡® export default 42; // æŠ¥é”™ export 42; ä¸Šé¢ä»£ç ä¸­ï¼Œåä¸€å¥æŠ¥é”™æ˜¯å› ä¸ºæ²¡æœ‰æŒ‡å®šå¯¹å¤–çš„æ¥å£ï¼Œè€Œå‰ä¸€å¥æŒ‡å®šå¯¹å¤–æ¥å£ä¸º default ã€‚\nğŸ“ƒ Example\næœ‰äº† export defaultÂ å‘½ä»¤ï¼Œè¾“å…¥æ¨¡å—æ—¶å°±éå¸¸ç›´è§‚äº†ï¼Œä»¥è¾“å…¥ lodash æ¨¡å—ä¸ºä¾‹ã€‚\nimport _ from \u0026#39;lodash\u0026#39;; å¦‚æœæƒ³åœ¨ä¸€æ¡ import è¯­å¥ä¸­ï¼ŒåŒæ—¶è¾“å…¥é»˜è®¤æ–¹æ³•å’Œå…¶ä»–æ¥å£ï¼Œè€Œå…¶ä»–æ¥å£ç»Ÿä¸€ä½¿ç”¨ { }Â è¡¨ç¤ºï¼š\nimport _, { each, forEach } from \u0026#39;lodash\u0026#39;; å¯¹åº”ä¸Šé¢ä»£ç çš„ exportÂ è¯­å¥å¦‚ä¸‹ã€‚\nexport default function (obj) { /*...*/ } export function each(obj, iterator, context) { /*...*/ } export { each as forEach }; ä¸Šé¢ä»£ç çš„æœ€åä¸€è¡Œçš„æ„æ€æ˜¯ï¼Œæš´éœ²å‡º forEachÂ æ¥å£ï¼Œé»˜è®¤æŒ‡å‘ eachÂ æ¥å£ï¼Œå³ forEachÂ å’Œ eachÂ æŒ‡å‘åŒä¸€ä¸ªæ–¹æ³•ã€‚\nImport import å‘½ä»¤ç”¨äºè¾“å…¥å…¶å®ƒæ¨¡å—æä¾›çš„åŠŸèƒ½ï¼Œä¼š æå‡*^promote^* åˆ°æ•´ä¸ªæ¨¡å—çš„å¤´éƒ¨ï¼Œé¦–å…ˆæ‰§è¡Œã€‚\n/* main.js */ import { firstName, lastName, obj } from \u0026#39;./module.js\u0026#39;; function setName(element) { element.textContent = firstName + \u0026#39; \u0026#39; + lastName; } setName(obj); console.log(obj.textContent); // Michal Jackson ä¸Šé¢ä»£ç çš„ import å‘½ä»¤ï¼Œç”¨äºåŠ è½½profile.jsæ–‡ä»¶ï¼Œå¹¶ä»ä¸­è¾“å…¥å˜é‡ã€‚ import å‘½ä»¤æ¥å—ä¸€å¯¹å¤§æ‹¬å·ï¼Œé‡Œé¢æŒ‡å®šè¦ä»å…¶ä»–æ¨¡å—å¯¼å…¥çš„å˜é‡åã€‚å¤§æ‹¬å·é‡Œé¢çš„å˜é‡åï¼Œå¿…é¡»ä¸è¢«å¯¼å…¥æ¨¡å—ï¼ˆprofile.jsï¼‰å¯¹å¤–æ¥å£çš„åç§°ç›¸åŒã€‚\nåŒæ ·ä¹Ÿæ”¯æŒä½¿ç”¨ as é‡æ–°å®šä¹‰å˜é‡åã€‚\nğŸ“ƒ Example\n/* module.js */ export {myName as exportName}; let myName = \u0026#34;Tom\u0026#34;; // ä½¿ç”¨ as é‡æ–°å®šä¹‰å¯¼å‡ºçš„æ¥å£åç§°ï¼Œéšè—æ¨¡å—å†…éƒ¨çš„å˜é‡ /* main.js */ import {exportName} from \u0026#34;./module.js\u0026#34;; console.log(exportName); // Tom import å‘½ä»¤è¾“å…¥çš„å˜é‡éƒ½æ˜¯ åªè¯»*^const^* çš„ï¼Œå› ä¸ºå®ƒçš„æœ¬è´¨æ˜¯è¾“å…¥ æ¥å£*^interface^* ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å…è®¸åœ¨åŠ è½½æ¨¡å—çš„è„šæœ¬é‡Œé¢ï¼Œæ”¹å†™æ¥å£ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ˜¯ä¸€ä¸ª å¯¹è±¡ pointer: object ï¼Œå…è®¸ä¿®æ”¹å†…éƒ¨å±æ€§ã€‚\nç”±äº import æ˜¯é™æ€æ‰§è¡Œï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨è¡¨è¾¾å¼å’Œå˜é‡è¿™ç±»åªæœ‰åœ¨è¿è¡Œæ—¶æ‰èƒ½å¾—åˆ°ç»“æœçš„è¯­æ³•ç»“æ„ã€‚\né€šè¿‡ Babel è½¬ç ï¼ŒCommonJS æ¨¡å—çš„ requireÂ å‘½ä»¤å’Œ ES6 æ¨¡å—çš„ importÂ å‘½ä»¤ï¼Œå¯ä»¥å†™åœ¨åŒä¸€ä¸ªæ¨¡å—é‡Œé¢ï¼Œä½†æ˜¯æœ€å¥½ä¸è¦è¿™æ ·åšã€‚å› ä¸º importÂ åœ¨é™æ€è§£æé˜¶æ®µæ‰§è¡Œï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ªæ¨¡å—ä¹‹ä¸­æœ€æ—©æ‰§è¡Œçš„ã€‚ä¸‹é¢çš„ä»£ç å¯èƒ½ä¸ä¼šå¾—åˆ°é¢„æœŸç»“æœã€‚\nrequire(\u0026#39;core-js/modules/es6.symbol\u0026#39;); require(\u0026#39;core-js/modules/es6.promise\u0026#39;); import React from \u0026#39;React\u0026#39;; æ•´ä½“åŠ è½½ é™¤äº†æŒ‡å®šåŠ è½½æŸä¸ªè¾“å‡ºå€¼ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ•´ä½“åŠ è½½ï¼Œå³ç”¨ æ˜Ÿå·* æŒ‡å®šä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€æœ‰è¾“å‡ºå€¼éƒ½åŠ è½½åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šé¢ï¼Œå¹¶ç”¨ as æŒ‚è½½åˆ°å®é™…çš„æ–¹æ³•ä¸Šã€‚\nğŸ“ƒ Example\nimport * as circle from \u0026#39;./circle\u0026#39;; console.log(\u0026#39;åœ†é¢ç§¯ï¼š\u0026#39; + circle.area(4)); console.log(\u0026#39;åœ†å‘¨é•¿ï¼š\u0026#39; + circle.circumference(14)); æ•´ä½“åŠ è½½æ—¶çš„é‚£ä¸ªå¯¹è±¡åŒæ ·æ˜¯ä¸å…è®¸è¿è¡Œæ—¶æ”¹å˜çš„ã€‚\nğŸ“ Note export.defaultÂ å°†è¢«è¾“å‡ºä¸º defaultÂ çš„é”®ã€‚\nimport() import å‘½ä»¤ä¼šè¢« JavaScript å¼•æ“ é™æ€*^static^* åˆ†æï¼Œå…ˆäºæ¨¡å—å†…çš„å…¶ä»–è¯­å¥æ‰§è¡Œï¼ˆ import å‘½ä»¤å«åš è¿æ¥*^binding^* å…¶å®æ›´åˆé€‚ï¼‰ã€‚æ‰€ä»¥ï¼Œä¸‹é¢çš„ä»£ç ä¼šæŠ¥é”™ã€‚\nğŸ“ Note\n// æŠ¥é”™ if (x === 2) { import MyModual from \u0026#39;./myModual\u0026#39;; } ä¸Šé¢ä»£ç ä¸­ï¼Œå¼•æ“å¤„ç† import è¯­å¥æ˜¯åœ¨ç¼–è¯‘æ—¶ï¼Œè¿™æ—¶ä¸ä¼šå»åˆ†ææˆ–æ‰§è¡Œifè¯­å¥ï¼Œæ‰€ä»¥ import è¯­å¥æ”¾åœ¨ if ä»£ç å—ä¹‹ä¸­æ¯«æ— æ„ä¹‰ï¼Œå› æ­¤ä¼šæŠ¥å¥æ³•é”™è¯¯ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ—¶é”™è¯¯ã€‚\nä¹Ÿå°±æ˜¯è¯´ï¼Œ import å’Œ export å‘½ä»¤åªèƒ½åœ¨æ¨¡å—çš„é¡¶å±‚ï¼Œä¸èƒ½åœ¨ä»£ç å—ä¹‹ä¸­ï¼ˆæ¯”å¦‚ï¼Œåœ¨ ifÂ ä»£ç å—ä¹‹ä¸­ï¼Œæˆ–åœ¨å‡½æ•°ä¹‹ä¸­ï¼‰ã€‚\nè¿™æ ·çš„è®¾è®¡ï¼Œå›ºç„¶æœ‰åˆ©äºç¼–è¯‘å™¨æé«˜æ•ˆç‡ï¼Œä½†ä¹Ÿå¯¼è‡´æ— æ³•åœ¨è¿è¡Œæ—¶åŠ è½½æ¨¡å—ã€‚åœ¨è¯­æ³•ä¸Šï¼Œæ¡ä»¶åŠ è½½ å°±ä¸å¯èƒ½å®ç°ã€‚å¦‚æœ import å‘½ä»¤è¦å–ä»£ Node çš„ require æ–¹æ³•ï¼Œè¿™å°±å½¢æˆäº†ä¸€ä¸ªéšœç¢ã€‚å› ä¸ºÂ require æ˜¯è¿è¡Œæ—¶åŠ è½½æ¨¡å—ï¼Œ import å‘½ä»¤æ— æ³•å–ä»£ requireÂ çš„åŠ¨æ€åŠ è½½åŠŸèƒ½ã€‚\nconst path = \u0026#39;./\u0026#39; + fileName; const myModual = require(path); ä¸Šé¢çš„è¯­å¥å°±æ˜¯åŠ¨æ€åŠ è½½ï¼ŒrequireÂ åˆ°åº•åŠ è½½å“ªä¸€ä¸ªæ¨¡å—ï¼Œåªæœ‰è¿è¡Œæ—¶æ‰çŸ¥é“ã€‚ import å‘½ä»¤åšä¸åˆ°è¿™ä¸€ç‚¹ã€‚\nES2020 å¼•å…¥ import() å‡½æ•°ï¼Œæ”¯æŒåŠ¨æ€åŠ è½½æ¨¡å—ã€‚\nimport(specifier) ä¸Šé¢ä»£ç ä¸­ï¼Œ import å‡½æ•°çš„å‚æ•° specifierÂ ï¼ŒæŒ‡å®šæ‰€è¦åŠ è½½çš„æ¨¡å—ã€‚ import å‘½ä»¤èƒ½å¤Ÿæ¥å—ä»€ä¹ˆå‚æ•°ï¼Œ import() å‡½æ•°å°±èƒ½æ¥å—ä»€ä¹ˆå‚æ•°ï¼Œä¸¤è€…åŒºåˆ«ä¸»è¦æ˜¯åè€…ä¸ºåŠ¨æ€åŠ è½½ã€‚\nimport() è¿”å›ä¸€ä¸ª [Promise](06 EcmaScript B/#promise-es6) å¯¹è±¡ï¼Œå…·æœ‰ then() å’Œ catch() æ–¹æ³•ã€‚\nå› æ­¤ï¼Œä¹Ÿå¯ä»¥åœ¨ import() å‰åŠ ä¸Š await è¯­æ³•ç³–ï¼ŒåƒåŒæ­¥å‡½æ•°é‚£æ ·å†™å¼‚æ­¥é€»è¾‘ã€‚\nğŸ“ƒ Example\næ™®é€š Promise å†™æ³•\n/* main.js */ import document from \u0026#39;./document.js\u0026#39;; const main = document.querySelector(\u0026#39;main\u0026#39;); import(`./middleware.js`) .then(module =\u0026gt; { console.log(module); // [Module: null prototype] { default: { get: [Function: get] } } }) .catch(err =\u0026gt; { console.log(err.toString()); // Error [ERR_UNSUPPORTED_DIR_IMPORT]: ... is not supported resolving ES modules imported from ... }); top-level await è¯­æ³•ç³–å†™æ³•\n// top-level await /*...*/ try { const module = await import(`./middleware.js`); console.log(module); // Same }catch (err) { console.log(err.toString()); // Same } :memo: Note async å‡½æ•°å†…éƒ¨æŠ›å‡ºé”™è¯¯ï¼Œä¼šå¯¼è‡´è¿”å›çš„ Promise å¯¹è±¡å˜ä¸º reject çŠ¶æ€ã€‚æŠ›å‡ºçš„é”™è¯¯å¯¹è±¡å¯ä»¥è¢« catch æ–¹æ³•å›è°ƒå‡½æ•°æ¥æ”¶åˆ°ã€‚\n:memo: Note æ­¤æ—¶é€šè¿‡ module.defaultÂ è®¿é—® export defaultÂ ã€‚\nimport() å‡½æ•°å¯ä»¥ç”¨åœ¨ä»»ä½•åœ°æ–¹ï¼Œä¸ä»…ä»…æ˜¯æ¨¡å—ï¼Œéæ¨¡å—çš„è„šæœ¬ä¹Ÿå¯ä»¥ä½¿ç”¨ã€‚å®ƒæ˜¯è¿è¡Œæ—¶æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä»€ä¹ˆæ—¶å€™è¿è¡Œåˆ°è¿™ä¸€å¥ï¼Œå°±ä¼šåŠ è½½æŒ‡å®šçš„æ¨¡å—ã€‚å¦å¤–ï¼Œ import() å‡½æ•°ä¸æ‰€åŠ è½½çš„æ¨¡å—æ²¡æœ‰é™æ€è¿æ¥å…³ç³»ï¼Œè¿™ç‚¹ä¹Ÿæ˜¯ä¸ import è¯­å¥ä¸ç›¸åŒã€‚ import() ç±»ä¼¼äº Node çš„ require() æ–¹æ³•ï¼ŒåŒºåˆ«ä¸»è¦æ˜¯å‰è€…æ˜¯å¼‚æ­¥åŠ è½½ï¼Œåè€…æ˜¯ åŒæ­¥*^synchronous:é˜»å¡^* åŠ è½½ã€‚\nimport() åŠ è½½æ¨¡å—æˆåŠŸä»¥åï¼Œè¿™ä¸ªæ¨¡å—ä¼šä½œä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå½“ä½œ then æ–¹æ³•çš„å‚æ•°ã€‚å› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨å¯¹è±¡ è§£æ„èµ‹å€¼destructing assignment çš„è¯­æ³•ï¼Œè·å–è¾“å‡ºæ¥å£ã€‚\nåˆç”±äºè¿”å›çš„æ˜¯ä¸€ä¸ª PromiseÂ å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥ç”¨åœ¨ awaitÂ å‡½æ•°ä¹‹ä¸­å˜æˆ åŒæ­¥*^synchronous^* å†™æ³•ã€‚\nå¤åˆå†™æ³• å¦‚æœåœ¨ä¸€ä¸ªæ¨¡å—ä¹‹ä¸­ï¼Œå…ˆè¾“å…¥åè¾“å‡ºåŒä¸€ä¸ªæ¨¡å—ï¼Œ import è¯­å¥å¯ä»¥ä¸ export è¯­å¥å†™åœ¨ä¸€èµ·ã€‚\nğŸ“ƒ Example\nexport { foo, bar } from \u0026#39;my_module\u0026#39;; // å¯ä»¥ç®€å•ç†è§£ä¸º import { foo, bar } from \u0026#39;my_module\u0026#39;; export { foo, bar }; ä¸Šé¢ä»£ç ä¸­ï¼Œexport å’Œ import è¯­å¥å¯ä»¥ç»“åˆåœ¨ä¸€èµ·ï¼Œå†™æˆä¸€è¡Œã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå†™æˆä¸€è¡Œä»¥åï¼Œfoo å’Œ bar å®é™…ä¸Šå¹¶æ²¡æœ‰è¢«å¯¼å…¥å½“å‰æ¨¡å—ï¼Œåªæ˜¯ç›¸å½“äºå¯¹å¤–è½¬å‘äº†è¿™ä¸¤ä¸ªæ¥å£ï¼Œå¯¼è‡´å½“å‰æ¨¡å—ä¸èƒ½ç›´æ¥ä½¿ç”¨ foo å’Œ bar ã€‚\næ¨¡å—çš„æ¥å£æ”¹åå’Œæ•´ä½“è¾“å‡ºï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨è¿™ç§å†™æ³•ã€‚\n// æ¥å£æ”¹å export { foo as myFoo } from \u0026#39;my_module\u0026#39;; // æ•´ä½“è¾“å‡º export * from \u0026#39;my_module\u0026#39;; é»˜è®¤æ¥å£çš„å†™æ³•å¦‚ä¸‹ã€‚\nexport { default } from \u0026#39;foo\u0026#39;; å…·åæ¥å£æ”¹ä¸ºé»˜è®¤æ¥å£çš„å†™æ³•å¦‚ä¸‹ã€‚\nexport { es6 as default } from \u0026#39;./someModule.js\u0026#39;; // ç­‰åŒäº import { es6 } from \u0026#39;./someModule.js\u0026#39;; export default es6; åŒæ ·åœ°ï¼Œé»˜è®¤æ¥å£ä¹Ÿå¯ä»¥æ”¹åä¸ºå…·åæ¥å£ã€‚\nexport { default as es6 } from \u0026#39;./someModule.js\u0026#39;; ES2020 ä¹‹å‰ï¼Œæœ‰ä¸€ç§ import è¯­å¥ï¼Œæ²¡æœ‰å¯¹åº”çš„å¤åˆå†™æ³•ã€‚\nimport * as someIdentifier from \u0026#34;./someModule.js\u0026#34;; ES2020 è¡¥ä¸Šäº†è¿™ä¸ªå†™æ³•ã€‚\nexport * as ns from \u0026#34;mod\u0026#34;; // ç­‰åŒäº import * as ns from \u0026#34;mod\u0026#34;; export {ns}; ç»§æ‰¿ æ¨¡å—ä¹‹é—´ä¹Ÿå¯ä»¥ç»§æ‰¿ã€‚\nå‡è®¾æœ‰ä¸€ä¸ª circleplusÂ æ¨¡å—ï¼Œç»§æ‰¿äº† circleÂ æ¨¡å—ã€‚\n/* circleplus.js */ export * from \u0026#39;circle\u0026#39;; export var e = 2.71828182846; export default function(x) { return Math.exp(x); } ä¸Šé¢ä»£ç ä¸­çš„ export *Â ï¼Œè¡¨ç¤ºå†è¾“å‡º circleÂ æ¨¡å—çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚æ³¨æ„ï¼Œexport *Â å‘½ä»¤ä¼šå¿½ç•¥ circleÂ æ¨¡å—çš„ defaultÂ æ–¹æ³•ã€‚ç„¶åï¼Œä¸Šé¢ä»£ç åˆè¾“å‡ºäº†è‡ªå®šä¹‰çš„ eÂ å˜é‡å’Œé»˜è®¤æ–¹æ³•ã€‚\nè¿™æ—¶ï¼Œä¹Ÿå¯ä»¥å°† circleÂ çš„å±æ€§æˆ–æ–¹æ³•ï¼Œæ”¹ååå†è¾“å‡ºã€‚\n/* circleplus.js */ export { area as circleArea } from \u0026#39;circle\u0026#39;; ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œåªè¾“å‡º circleÂ æ¨¡å—çš„ areaÂ æ–¹æ³•ï¼Œä¸”å°†å…¶æ”¹åä¸º circleAreaÂ ã€‚\nåŠ è½½ä¸Šé¢æ¨¡å—çš„å†™æ³•å¦‚ä¸‹ã€‚\n/* main.js */ import * as math from \u0026#39;circleplus\u0026#39;; import exp from \u0026#39;circleplus\u0026#39;; console.log(exp(math.e)); ä¸Šé¢ä»£ç ä¸­çš„ import exp è¡¨ç¤ºï¼Œå°† circleplus æ¨¡å—çš„ é»˜è®¤æ–¹æ³•default åŠ è½½ä¸º exp æ–¹æ³•ã€‚\nè·¨æ¨¡å—å¸¸é‡ ç”±äº const å£°æ˜çš„å¸¸é‡åªåœ¨å½“å‰ä»£ç å—æœ‰æ•ˆï¼Œå¦‚æœæƒ³è®¾ç½®è·¨æ¨¡å—çš„å¸¸é‡ï¼Œæˆ–è€…è¯´ä¸€ä¸ªå€¼è¦è¢«å¤šä¸ªæ¨¡å—å…±äº«ï¼Œå¯ä»¥é‡‡ç”¨ä¸‹é¢çš„å†™æ³•ï¼š\n/* constants.js */ export const A = 1; export const B = 3; export const C = 4; /* test1.js */ import * as constants from \u0026#39;./constants\u0026#39;; console.log(constants.A); // 1 console.log(constants.B); // 3 /* or test2.js */ import {A, B} from \u0026#39;./constants\u0026#39;; console.log(A); // 1 console.log(B); // 3 å¦‚æœè¦ä½¿ç”¨çš„å¸¸é‡éå¸¸å¤šï¼Œå¯ä»¥å»ºä¸€ä¸ªä¸“é—¨çš„ constantsÂ ç›®å½•ï¼Œå°†å„ç§å¸¸é‡å†™åœ¨ä¸åŒçš„æ–‡ä»¶é‡Œé¢ï¼Œä¿å­˜åœ¨è¯¥ç›®å½•ä¸‹ã€‚\n/* constants/db.js */ export const db = { url: \u0026#39;http://my.couchdbserver.local:5984\u0026#39;, admin_username: \u0026#39;admin\u0026#39;, admin_password: \u0026#39;admin password\u0026#39; }; /* constants/users.js */ export const users = [ \u0026#39;root\u0026#39;, \u0026#39;admin\u0026#39;, \u0026#39;staff\u0026#39;, \u0026#39;ceo\u0026#39;, \u0026#39;chief\u0026#39;, \u0026#39;moderator\u0026#39; ]; ç„¶åï¼Œå°†è¿™äº›æ–‡ä»¶è¾“å‡ºçš„å¸¸é‡ï¼Œåˆå¹¶åœ¨åŒçº§çš„ const.jsÂ é‡Œé¢ã€‚\n/* constants/const.js */ export * from \u0026#39;./db.js\u0026#39;; export * from \u0026#39;./users.js\u0026#39;; ä½¿ç”¨çš„æ—¶å€™ï¼Œç›´æ¥åŠ è½½ indexÂ å°±å¯ä»¥äº†ã€‚\n/* main.js */ import * as constant from \u0026#39;./constant/const.js\u0026#39;; console.log(constant); /* [Module: null prototype] { db: { url: \u0026#39;http://my.couchdbserver.local:5984\u0026#39;, admin_username: \u0026#39;admin\u0026#39;, admin_password: \u0026#39;admin password\u0026#39; }, users: [ \u0026#39;root\u0026#39;, \u0026#39;admin\u0026#39;, \u0026#39;staff\u0026#39;, \u0026#39;ceo\u0026#39;, \u0026#39;chief\u0026#39;, \u0026#39;moderator\u0026#39; ] }*/ Exception å‚æ•°çœç•¥ JavaScript è¯­è¨€çš„try...catchç»“æ„ï¼Œä»¥å‰æ˜ç¡®è¦æ±‚ catch å‘½ä»¤åé¢å¿…é¡»è·Ÿå‚æ•°ï¼Œæ¥å— try ä»£ç å—æŠ›å‡ºçš„é”™è¯¯å¯¹è±¡ã€‚\ntry { // ... } catch (err) { // å¤„ç†é”™è¯¯ } ä¸Šé¢ä»£ç ä¸­ï¼Œ catch å‘½ä»¤åé¢å¸¦æœ‰å‚æ•°errã€‚\nå¾ˆå¤šæ—¶å€™ï¼Œ catch ä»£ç å—å¯èƒ½ç”¨ä¸åˆ°è¿™ä¸ªå‚æ•°ã€‚ä½†æ˜¯ï¼Œä¸ºäº†ä¿è¯è¯­æ³•æ­£ç¡®ï¼Œè¿˜æ˜¯å¿…é¡»å†™ã€‚ES2019 åšå‡ºäº†æ”¹å˜ï¼Œå…è®¸ catch è¯­å¥çœç•¥å‚æ•°ã€‚\ntry { // ... } catch { // ... } è§£æ„èµ‹å€¼ è§£æ„èµ‹å€¼æ˜¯å¯¹èµ‹å€¼è¿ç®—ç¬¦çš„æ‰©å±•ã€‚åœ¨ä»£ç ä¹¦å†™ä¸Šç®€æ´ä¸”æ˜“è¯»ï¼Œè¯­ä¹‰æ›´åŠ æ¸…æ™°æ˜äº†ï¼Œä¹Ÿæ–¹ä¾¿äº†å¤æ‚å¯¹è±¡ä¸­æ•°æ®å­—æ®µè·å–ã€‚\næœ¬è´¨ä¸Šï¼Œè¿™ç§å†™æ³•å±äº æ¨¡å¼åŒ¹é… ï¼Œåªè¦ç­‰å·ä¸¤è¾¹çš„ æ¨¡å¼ ç›¸åŒï¼Œå·¦è¾¹çš„å˜é‡å°±ä¼šè¢«èµ‹äºˆå¯¹åº”çš„å€¼ã€‚ä¸‹é¢æ˜¯ä¸€äº›ä½¿ç”¨åµŒå¥—æ•°ç»„è¿›è¡Œè§£æ„çš„ä¾‹å­ã€‚\nğŸ“ƒ Example\næ¨¡å¼ç»“æ„ åŒ¹é… [] = [1, 2, 3]; ç´¢å¼•å€¼ ç›¸åŒçš„å®Œæˆèµ‹å€¼ const [a, b, c] = [1, 2, 3]; ä¸¾ä¾‹ const [a, [, , b], c] = [1, [2, 3, 4], 5]; console.log(a, b, c);\t// 1 4 5 // Setä¹Ÿå¯ä»¥ä½¿ç”¨æ•°ç»„çš„è§£æ„èµ‹å€¼ let [x, y, z] = new Set([\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;]); console.log(x); // \u0026#34;a\u0026#34; åœ¨è§£æ„ä¸­ï¼Œæœ‰ä¸‹é¢ä¸¤éƒ¨åˆ†å‚ä¸ï¼š\nè§£æ„èµ‹å€¼è¡¨è¾¾å¼çš„å·¦è¾¹éƒ¨åˆ†è§£æ„çš„ç›®æ ‡ â‡‹ è§£æ„çš„æºè§£æ„èµ‹å€¼è¡¨è¾¾å¼çš„å³è¾¹éƒ¨åˆ† æ•°ç»„ æ•°ç»„æ¨¡å‹Array çš„è§£æ„\nåŸºæœ¬ let [a, b, c] = [1, 2, 3]; // a = 1 b = 2 c = 3 å¯åµŒå¥— let [a, [[b], c]] = [1, [[2], 3]]; // a = 1 b = 2 c = 3 å¯å¿½ç•¥ let [a, , b] = [1, 2, 3]; // a = 1 b = 3 ä¸å®Œå…¨è§£æ„ let [a = 1, b] = []; // a = 1, b = undefined å‰©ä½™è¿ç®—ç¬¦...restArgs let [a, ...b] = [1, 2, 3]; //a = 1 b = [2, 3] è§£æ„é»˜è®¤å€¼ é»˜è®¤å€¼çš„åŸºæœ¬ç”¨æ³•\nconst [a, b] = []; console.log(a, b);\t// undefined undefined const [a = 1, b = 2] = []; console.log([a, b]);\t// 1, 2 é»˜è®¤å€¼çš„ç”Ÿæ•ˆæ¡ä»¶\nåªæœ‰å½“ä¸€ä¸ªæ•°ç»„æˆå‘˜ å…¨ç­‰äº=== undefined ï¼ˆä¸å†™æˆ–æ˜¯ç›´æ¥æŒ‡å®šï¼‰æ—¶ï¼Œå¯¹åº”çš„é»˜è®¤å€¼æ‰ä¼šç”Ÿæ•ˆã€‚\nconst [a = 1, b = 2] = [3, 0];\t// 3 0 const [a = 1, b = 2] = [3, null];\t// 3 null const [a = 1, b = 2] = [3];\t// 3 é»˜è®¤å€¼è¡¨è¾¾å¼\nå¦‚æœé»˜è®¤å€¼æ˜¯è¡¨è¾¾å¼ï¼Œé»˜è®¤å€¼è¡¨è¾¾å¼æ˜¯ æƒ°æ€§æ±‚å€¼ çš„ã€‚ï¼ˆå³ï¼šå½“æ— éœ€ç”¨åˆ°é»˜è®¤å€¼æ—¶ï¼Œè¡¨è¾¾å¼æ˜¯ä¸ä¼šæ±‚å€¼çš„ï¼‰\nconst func = () =\u0026gt; { return 24; }; const [a = func()] = [1];\t// 1 const [b = func()] = [];\t// 24 åº”ç”¨\nArguments function func() { const [a, b] = arguments; console.log([a, b]); // 1, 2 } func(1, 2); NodeList \u0026lt;p\u0026gt;1\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;2\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;3\u0026lt;/p\u0026gt; \u0026lt;script\u0026gt; const [p1, p2, p3] = document.querySelectorAll(\u0026#39;p\u0026#39;); console.log(p1, p2, p3); // æ‰“å°å‡º3ä¸ªèŠ‚ç‚¹ \u0026lt;p\u0026gt;1\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;2\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;3\u0026lt;/p\u0026gt; \u0026lt;/script\u0026gt; å‡½æ•°å‚æ•°è§£æ„èµ‹å€¼ const array = [1, 1]; // const add = arr =\u0026gt; arr[0] + arr[1]; const $ = function ([x = 0, y = 0]) { return x + y; } const $_ = ([x = 0, y = 0]) =\u0026gt; x + y; console.log([$(array),$([])]); // [ 2, 0 ] console.log([$_(array),$_([])]);\t// [ 2, 0 ] :memo: Note å®é™…ä¸Šå‡½æ•°å‚æ•°èµ‹å€¼æ˜¯å°†ä¼ å…¥çš„ æ•°ç»„å®å‚array å¯¹å‡½æ•° æ•°ç»„å½¢å‚array è¿›è¡Œ è§£æ„èµ‹å€¼ ã€‚\n// ä¼ å…¥å®å‚ $([/* array */]); // æ¥æ”¶å½¢å‚ $ = ([/*arrayMember = var*/]){/* vars */} /* ä¼ å…¥çš„è¿‡ç¨‹ä¸­å‘ç”Ÿè§£æ„èµ‹å€¼ */ ä»å‡½æ•°è¿”å›å¤šä¸ªå€¼\nå‡½æ•°åªèƒ½è¿”å›ä¸€ä¸ªå€¼ï¼Œå¦‚æœè¦è¿”å›å¤šä¸ªå€¼ï¼Œåªèƒ½å°†å®ƒä»¬æ”¾åœ¨æ•°ç»„æˆ–å¯¹è±¡é‡Œè¿”å›ã€‚æœ‰äº†è§£æ„èµ‹å€¼ï¼Œå–å‡ºè¿™äº›å€¼å°±éå¸¸æ–¹ä¾¿ã€‚\n// è¿”å›ä¸€ä¸ªæ•°ç»„ let [a, b, c] = (() =\u0026gt; { return [1, 2, 3]; })(); console.log([a, b, c]); // [ 1, 2, 3 ] // è¿”å›ä¸€ä¸ªå¯¹è±¡ let {foo, bar} = (() =\u0026gt; { return {foo: 1, bar: 2}; })(); console.log({foo, bar}); // { foo: 1, bar: 2 } äº¤æ¢å˜é‡çš„å€¼ let x = 2, y = 1; // å…¶å®ƒè¯­è¨€çš„èµ‹å€¼ let tmp = x; x = y; y = tmp; // ä½¿ç”¨è§£æ„èµ‹å€¼ [x, y] = [y, x]; // ç†è§£ï¼š[x, y] = [2, 1] console.log(x, y); // 1 2 å¯¹è±¡ åŸºæœ¬ let {foo, bar} = {foo: \u0026#39;aaa\u0026#39;, bar: \u0026#39;bbb\u0026#39;}; // foo = \u0026#39;aaa\u0026#39;, bar = \u0026#39;bbb\u0026#39; let {foo2: bar2} = {foo2: \u0026#39;ddd\u0026#39;}; // bar2 = \u0026#39;ddd\u0026#39; console.log([foo, bar, bar2]); ğŸ“ Note å°†ä¸€ä¸ªå·²ç»å£°æ˜çš„å˜é‡ç”¨äºè§£æ„èµ‹å€¼æ—¶ï¼Œæ•´ä¸ªèµ‹å€¼éœ€è¦åœ¨åœ†æ‹¬å·ä¸­è¿›è¡Œï¼š\nlet x = 2; ({x} = {x: 1}); // å¦‚æœä¸åŠ  ()ï¼Œé‚£ä¹ˆ {x} ä¼šè¢«æµè§ˆå™¨è¯¯è®¤ä¸ºæ˜¯æ™®é€šçš„ä»£ç å— // å·²ç»å£°æ˜çš„å˜é‡ç”¨äºæ•°ç»„çš„è§£æ„èµ‹å€¼å°±ä¸ä¼šé‡åˆ°è¿™ä¸ªé—®é¢˜ let {x} = {x: 1} // åœ¨æœªå£°æ˜è¿™ä¸ªå˜é‡çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨letå³å¯ ğŸ“ Note å¯¹è±¡è§£æ„èµ‹å€¼å¯ä»¥å–åˆ°ç»§æ‰¿å±æ€§ã€‚\nconst {toString} = {}; console.log(toString);\t// [Function: toString] // toString æ˜¯ object çš„å±æ€§ï¼Œè€Œä»»ä½•å¯¹è±¡éƒ½ç»§æ‰¿è‡ª Object å¯åµŒå¥—å¯å¿½ç•¥ let obj = {p: [\u0026#39;hello\u0026#39;, {y: \u0026#39;world\u0026#39;}]}; let {p: [x, {y}]} = obj; // x = \u0026#39;hello\u0026#39;, y = \u0026#39;world\u0026#39; let obj2 = {p: [\u0026#39;hello\u0026#39;, {y: \u0026#39;world\u0026#39;}]}; let {p: [x2, {}]} = obj; // x = \u0026#39;hello\u0026#39; console.log([x, y, x2]); ä¸å®Œå…¨è§£æ„ let obj = {p: [{y: \u0026#39;world\u0026#39;}]}; let {p: [{y}, x]} = obj; // x = undefined, y = \u0026#39;world\u0026#39; console.log([x, y]); å‰©ä½™è¿ç®—ç¬¦...theArgs let {a, b, ...rest} = {a: 10, b: 20, c: 30, d: 40}; // a = 10, b = 20, rest = {c: 30, d: 40} console.log([a, b, rest]); è§£æ„é»˜è®¤å€¼ å¯¹è±¡çš„å±æ€§å€¼ä¸¥æ ¼ç­‰äº undefined æ—¶ï¼Œå¯¹åº”çš„é»˜è®¤å€¼æ‰ä¼šç”Ÿæ•ˆ å¦‚æœé»˜è®¤å€¼æ˜¯è¡¨è¾¾å¼ï¼Œé»˜è®¤å€¼è¡¨è¾¾å¼æ˜¯ æƒ°æ€§æ±‚å€¼ çš„ let {a = 10, b = 5} = {a: 3}; // a = 3; b = 5; let {a: aa = 10, b: bb = 5} = {a: 3}; // aa = 3; bb = 5; åº”ç”¨ å‡½æ•°å‚æ•°çš„å®šä¹‰ è§£æ„èµ‹å€¼å¯ä»¥æ–¹ä¾¿åœ°å°†ä¸€ç»„å‚æ•°ä¸å˜é‡åå¯¹åº”èµ·æ¥ã€‚\n// å‚æ•°æ˜¯ä¸€ç»„æœ‰æ¬¡åºçš„å€¼ (([x, y, z]) =\u0026gt; { console.log([x, y, z]); // [ 1, 2, 3 ] })([1, 2, 3]); // å‚æ•°æ˜¯ä¸€ç»„æ— æ¬¡åºçš„å€¼ (({x, y, z}) =\u0026gt; { console.log([x, y, z]); // [ 1, 2, 3 ] })({z: 3, y: 2, x: 1}); æå– JSON æ•°æ® è§£æ„èµ‹å€¼å¯¹æå– JSON å¯¹è±¡ä¸­çš„æ•°æ®ï¼Œå°¤å…¶æœ‰ç”¨ã€‚\nlet data = { id: 42, status: \u0026#34;OK\u0026#34;, data: [867, 5309] }; let jsonData = JSON.stringify(data); let _data_ = JSON.parse(jsonData); let { id, status, data: number } = _data_; console.log(id, status, number); // 42 \u0026#39;OK\u0026#39; [867, 5309] å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ jQuery.ajax = function (url, { async = true, beforeSend = function () {}, cache = true, complete = function () {}, crossDomain = false, global = true, // ... more config } = {}) { // ... do stuff }; æŒ‡å®šå‚æ•°çš„é»˜è®¤å€¼ï¼Œå°±é¿å…äº†åœ¨å‡½æ•°ä½“å†…éƒ¨å†å†™var foo = config.foo || 'default foo';è¿™æ ·çš„è¯­å¥ã€‚\néå† Map ç»“æ„ ä»»ä½•éƒ¨ç½²äº† Iterator æ¥å£çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥ç”¨for...ofå¾ªç¯éå†ã€‚Map ç»“æ„åŸç”Ÿæ”¯æŒ Iterator æ¥å£ï¼Œé…åˆå˜é‡çš„è§£æ„èµ‹å€¼ï¼Œè·å–é”®åå’Œé”®å€¼å°±éå¸¸æ–¹ä¾¿ã€‚\nconst map = new Map(); map.set(\u0026#39;first\u0026#39;, \u0026#39;hello\u0026#39;); map.set(\u0026#39;second\u0026#39;, \u0026#39;world\u0026#39;); for (let [key, value] of map) { console.log(key + \u0026#34; is \u0026#34; + value); } // first is hello // second is world å¦‚æœåªæƒ³è·å–é”®åï¼Œæˆ–è€…åªæƒ³è·å–é”®å€¼ï¼Œå¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ã€‚\n// è·å–é”®å for (let [key] of map) { // ... } // è·å–é”®å€¼ for (let [, value] of map) { // ... } è¾“å…¥æ¨¡å—çš„æŒ‡å®šæ–¹æ³• åŠ è½½æ¨¡å—æ—¶ï¼Œå¾€å¾€éœ€è¦æŒ‡å®šè¾“å…¥å“ªäº›æ–¹æ³•ã€‚è§£æ„èµ‹å€¼ä½¿å¾—è¾“å…¥è¯­å¥éå¸¸æ¸…æ™°ã€‚\nconst { SourceMapConsumer, SourceNode } = require(\u0026#34;source-map\u0026#34;); :memo: Note\nç›¸ä¿¡å¤§å®¶å¯¹äº foo å’Œ bar è¿™ä¸¤ä¸ªå•è¯ä¸€å®šå†ç†Ÿæ‚‰ä¸è¿‡äº†ï¼Œå®ƒä»¬æ˜¯è®¡ç®—æœºå›¾ä¹¦ä¸­æœ€å¸¸ä½¿ç”¨çš„å˜é‡åã€‚ä¸åŒçš„å­—å…¸å¯¹ foo çš„è§£é‡Šç›¸å»ç”šè¿œï¼Œä¸€è¯´æ¥è‡ªä¸­å›½\u0026quot;ç¦\u0026quot;å­—çš„å‘éŸ³ï¼Œåˆæœ‰è§£é‡Šä¸ºäºŒæˆ˜æ—¶æœŸçš„ä¸€ç§æ­¦å™¨ã€‚\nå…¶å®å°† foo å’Œ bar ç»„åˆåœ¨ä¸€èµ·æ‰€æ„æˆçš„ foobar åº”è¯¥æœ€èƒ½åæ˜ å…¶åŸå§‹çš„æ„æ€ï¼Œè¿™ä¸ªå¯ä»¥è¿½æº¯åˆ°äºŒæˆ˜æ—¶æœŸçš„ç±³å›½é™†å†›ä¿šè¯­ç¼©å†™ â€œFUBARâ€ï¼ŒåŸæ–‡æ˜¯ â€œFucked Up Beyond All Repairâ€ æˆ– â€œFucked Up Beyond All Recognitionâ€ï¼Œå¤§æ„æ˜¯äº‹æƒ…å·²ç»æçš„ä¸€å¡Œç³Šæ¶‚ï¼Œé¢ç›®å…¨éï¼Œä»¥è‡³äºæ— æ³•ä¿®å¤å’Œè¯†åˆ«ã€‚\nFoo å’Œ bar èƒ½æˆä¸ºç¼–ç¨‹ç•Œæœ€å¸¸ç”¨çš„ä¸¤ä¸ªå˜é‡åï¼Œä¹Ÿè®¸æ­£ä½“ç°äº†ç¨‹åºå‘˜ä»¬çš„å¹½é»˜æ„Ÿã€‚\n:warning: Caution ç”±äº undefined å’Œ null æ— æ³•è½¬ä¸ºå¯¹è±¡ï¼Œæ‰€ä»¥å¯¹å®ƒä»¬è¿›è¡Œè§£æ„èµ‹å€¼ï¼Œéƒ½ä¼šæŠ¥é”™ã€‚\nå­—ç¬¦ æ—¢å¯ä»¥ç”¨æ•°ç»„çš„å½¢å¼æ¥è§£æ„èµ‹å€¼ï¼Œä¹Ÿå¯ä»¥ç”¨å¯¹è±¡çš„å½¢å¼æ¥è§£æ„èµ‹å€¼ã€‚\næ•°ç»„ -\u0026gt; åœ¨æ•°ç»„çš„è§£æ„ä¸­ï¼Œè§£æ„çš„ç›®æ ‡è‹¥ä¸º å¯éå†å¯¹è±¡ ï¼Œçš†å¯è¿›è¡Œè§£æ„èµ‹å€¼ã€‚å¯éå†å¯¹è±¡å³å®ç° Iterator æ¥å£çš„æ•°æ®ã€‚\nlet [a, b, c, d, e] = \u0026#39;hello\u0026#39;; // a = \u0026#39;h\u0026#39; b = \u0026#39;e\u0026#39; c = \u0026#39;l\u0026#39; d = \u0026#39;l\u0026#39; e = \u0026#39;o\u0026#39; å¯¹è±¡ const {0: a, 1: b, 3: l, length} = \u0026#39;hello\u0026#39;; console.log(a, b, l, length);\t// h e o 5 åœ†æ‹¬å· è§£æ„èµ‹å€¼è™½ç„¶å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯è§£æèµ·æ¥å¹¶ä¸å®¹æ˜“ã€‚å¯¹äºç¼–è¯‘å™¨æ¥è¯´ï¼Œä¸€ä¸ªå¼å­åˆ°åº•æ˜¯æ¨¡å¼ï¼Œè¿˜æ˜¯è¡¨è¾¾å¼ï¼Œæ²¡æœ‰åŠæ³•ä»ä¸€å¼€å§‹å°±çŸ¥é“ï¼Œå¿…é¡»è§£æåˆ°ï¼ˆæˆ–è§£æä¸åˆ°ï¼‰ç­‰å·æ‰èƒ½çŸ¥é“ã€‚\nç”±æ­¤å¸¦æ¥çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœæ¨¡å¼ä¸­å‡ºç°åœ†æ‹¬å·æ€ä¹ˆå¤„ç†ã€‚ES6 çš„è§„åˆ™æ˜¯ï¼Œåªè¦æœ‰å¯èƒ½å¯¼è‡´è§£æ„çš„æ­§ä¹‰ï¼Œå°±ä¸å¾—ä½¿ç”¨åœ†æ‹¬å·ã€‚\nä½†æ˜¯ï¼Œè¿™æ¡è§„åˆ™å®é™…ä¸Šä¸é‚£ä¹ˆå®¹æ˜“è¾¨åˆ«ï¼Œå¤„ç†èµ·æ¥ç›¸å½“éº»çƒ¦ã€‚å› æ­¤ï¼Œå»ºè®®åªè¦æœ‰å¯èƒ½ï¼Œå°±ä¸è¦åœ¨æ¨¡å¼ä¸­æ”¾ç½®åœ†æ‹¬å·ã€‚\nä»¥ä¸‹ä¸‰ç§è§£æ„èµ‹å€¼ä¸å¾—ä½¿ç”¨åœ†æ‹¬å·ï¼š\nå˜é‡å£°æ˜è¯­å¥ // å…¨éƒ¨æŠ¥é”™ let [(a)] = [1]; let {x: (c)} = {}; let ({x: c}) = {}; let {(x: c)} = {}; let {(x): c} = {}; let { o: ({ p: p }) } = { o: { p: 2 } }; ä¸Šé¢ 6 ä¸ªè¯­å¥éƒ½ä¼šæŠ¥é”™ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ˜¯ å˜é‡å£°æ˜ è¯­å¥ï¼Œ æ¨¡å¼ ä¸èƒ½ä½¿ç”¨åœ†æ‹¬å·ã€‚\nå‡½æ•°å‚æ•° å‡½æ•°å‚æ•°ä¹Ÿå±äº å˜é‡å£°æ˜ ï¼Œå› æ­¤ä¸èƒ½å¸¦æœ‰åœ†æ‹¬å·ã€‚\n// æŠ¥é”™ function f([(z)]) { return z; } // æŠ¥é”™ function f([z,(x)]) { return x; } èµ‹å€¼è¯­å¥çš„æ¨¡å¼ // å…¨éƒ¨æŠ¥é”™ ({ p: a }) = { p: 42 }; ([a]) = [5]; ä¸Šé¢ä»£ç å°†æ•´ä¸ªæ¨¡å¼æ”¾åœ¨åœ†æ‹¬å·ä¹‹ä¸­ï¼Œå¯¼è‡´æŠ¥é”™ã€‚\n// æŠ¥é”™ [({ p: a }), { x: c }] = [{}, {}]; ä¸Šé¢ä»£ç å°†ä¸€éƒ¨åˆ†æ¨¡å¼æ”¾åœ¨åœ†æ‹¬å·ä¹‹ä¸­ï¼Œå¯¼è‡´æŠ¥é”™ã€‚\nå¯ä»¥ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µåªæœ‰ä¸€ç§ï¼šèµ‹å€¼è¯­å¥çš„éæ¨¡å¼éƒ¨åˆ†ï¼Œå¯ä»¥ä½¿ç”¨åœ†æ‹¬å·ã€‚\n[(b)] = [3]; // æ­£ç¡® ({ p: (d) } = {}); // æ­£ç¡® [(parseInt.prop)] = [3]; // æ­£ç¡® ä¸Šé¢ä¸‰è¡Œè¯­å¥éƒ½å¯ä»¥æ­£ç¡®æ‰§è¡Œï¼Œå› ä¸ºé¦–å…ˆå®ƒä»¬éƒ½æ˜¯èµ‹å€¼è¯­å¥ï¼Œè€Œä¸æ˜¯å£°æ˜è¯­å¥ï¼›å…¶æ¬¡å®ƒä»¬çš„åœ†æ‹¬å·éƒ½ä¸å±äºæ¨¡å¼çš„ä¸€éƒ¨åˆ†ã€‚ç¬¬ä¸€è¡Œè¯­å¥ä¸­ï¼Œæ¨¡å¼æ˜¯å–æ•°ç»„çš„ç¬¬ä¸€ä¸ªæˆå‘˜ï¼Œè·Ÿåœ†æ‹¬å·æ— å…³ï¼›ç¬¬äºŒè¡Œè¯­å¥ä¸­ï¼Œæ¨¡å¼æ˜¯ p ï¼Œè€Œä¸æ˜¯ d ï¼›ç¬¬ä¸‰è¡Œè¯­å¥ä¸ç¬¬ä¸€è¡Œè¯­å¥çš„æ€§è´¨ä¸€è‡´ã€‚\nç®€æ´è¡¨ç¤ºæ³• å¯¹è±¡å­—é¢é‡ // å®ä¾‹åŒ–æ„é€ å‡½æ•°ç”Ÿæˆå¯¹è±¡ const person = new Object(); person.age = 18; person.speak = function() {}; // { age: 18, speak: [Function (anonymous)] } // å¯¹è±¡å­—é¢é‡ const person2 = { age: 18, speak: function() {} }; // { age: 18, speak: [Function: speak] } console.log([person,person2]); :memo: Note Object.create() å¯ä»¥ä»£æ›¿ new Object() çš„ä½œç”¨ï¼Œä»¥åŸå¯¹è±¡ä¸º prototype åˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œå¹¶ç»§æ‰¿åŸæ¥çš„æ–¹æ³•ã€‚\nå±æ€§ç®€åŒ– // é€šè¿‡é”®å€¼å¯¹æ–¹æ³•è¡¨ç¤º const age1 = 18; const person1 = { age1: age1 }; //18 // è¡¨ç¤ºæ–¹æ³•2 const age2 = 18; const person2 = { \u0026#39;age2\u0026#39;: age2 };// 18 // é”®åå’Œå˜é‡æˆ–å¸¸é‡åä¸€æ ·çš„æ—¶å€™ï¼Œå¯ä»¥åªå†™ä¸€ä¸ª // {val} = {val: val} const age3 = 18; const person3 = {age3}; // 18 console.log([person1.age1, person2.age2, person3.age3]); å‡½æ•°ç®€åŒ– const fun = { // foo: function() {} foo() {} }; console.log(fun);\t// { foo: [Function: foo] } :memo: Note 1 æµ‹è¯•è¯¥æ–¹æ³•åˆ›å»ºçš„å‡½æ•°ç±»å‹\n\u0026#39;use strict\u0026#39; const foo = { bar: { fun() { console.log([arguments, this]); // åˆ›å»ºçš„ä¸æ˜¯åŒ¿åå‡½æ•° }, fun2: () =\u0026gt; { console.log([arguments, this]); // è¿”å›äº†ä¼¼ä¹æ˜¯jsæ–‡ä»¶çš„arguments // jsæ²¡æœ‰è‡ªå·±çš„argument } } }; foo.bar.fun(); // Object bar foo.bar.fun2(); // window (chrome) | {}(Node.js) :memo: Note 2 æ–¹æ³•çš„ name å±æ€§\nå‡½æ•°å…·æœ‰ name å±æ€§ï¼Œè¿”å›å‡½æ•°åã€‚å¯¹è±¡æ–¹æ³•ä¹Ÿæ˜¯å‡½æ•°ï¼Œå› æ­¤ä¹Ÿæœ‰ name å±æ€§ã€‚\nconst person = { sayName() { console.log(\u0026#39;hello!\u0026#39;); }, }; person.sayName.name // \u0026#34;sayName\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼Œæ–¹æ³•çš„ name å±æ€§è¿”å›å‡½æ•°å - å³æ–¹æ³•åã€‚\nå¦‚æœå¯¹è±¡çš„æ–¹æ³•ä½¿ç”¨äº† å–å€¼å‡½æ•° getter() å’Œ å­˜å€¼å‡½æ•° setter()ï¼Œåˆ™ name å±æ€§ä¸æ˜¯åœ¨è¯¥æ–¹æ³•ä¸Šé¢ï¼Œè€Œæ˜¯è¯¥æ–¹æ³•çš„å±æ€§çš„æè¿°å¯¹è±¡çš„ get å’Œset å±æ€§ä¸Šé¢ï¼Œè¿”å›å€¼æ˜¯æ–¹æ³•åå‰åŠ ä¸Š get å’Œ set ã€‚\nconst obj = { get foo() {}, set foo(x) {} }; // obj.foo.name // TypeError: Cannot read property \u0026#39;name\u0026#39; of undefined const descriptor = Object.getOwnPropertyDescriptor(obj, \u0026#39;foo\u0026#39;); descriptor.get.name // \u0026#34;get foo\u0026#34; descriptor.set.name // \u0026#34;set foo\u0026#34; æœ‰ä¸¤ç§ç‰¹æ®Šæƒ…å†µï¼šbind æ–¹æ³•åˆ›é€ çš„å‡½æ•°ï¼Œname å±æ€§è¿”å› bound åŠ ä¸ŠåŸå‡½æ•°çš„åå­—ï¼›Function æ„é€ å‡½æ•°åˆ›é€ çš„å‡½æ•°ï¼Œname å±æ€§è¿”å› anonymousã€‚\n(new Function()).name // \u0026#34;anonymous\u0026#34; var doSomething = function() { // ... }; doSomething.bind().name // \u0026#34;bound doSomething\u0026#34; å¦‚æœå¯¹è±¡çš„æ–¹æ³•æ˜¯ä¸€ä¸ª Symbol å€¼ï¼Œé‚£ä¹ˆnameå±æ€§è¿”å›çš„æ˜¯è¿™ä¸ª Symbol å€¼çš„æè¿°ã€‚\nconst key1 = Symbol(\u0026#39;description\u0026#39;); const key2 = Symbol(); let obj = { [key1]() {}, [key2]() {}, }; obj[key1].name // \u0026#34;[description]\u0026#34; obj[key2].name // \u0026#34;\u0026#34; ä¸Šé¢ä»£ç ä¸­ï¼Œkey1å¯¹åº”çš„ Symbol å€¼æœ‰æè¿°ï¼Œkey2æ²¡æœ‰ã€‚\næ–¹æ‹¬å·è¯­æ³• å¯¹è±¡å­—é¢é‡çš„å¦ä¸€ä¸ªé‡è¦æ›´æ–°æ˜¯å…è®¸ä½ ä½¿ç”¨ å¯è®¡ç®—çš„å±æ€§å ã€‚\nåœ¨ ES5 ä¸­ï¼Œéœ€è¦é€šè¿‡ å¯¹è±¡ä¸‹æ ‡[] ç»™å¯¹è±¡æ·»åŠ å±æ€§åä¸º å˜é‡ çš„å±æ€§ã€‚\nvar foo = \u0026#39;aaa\u0026#39;; var bar = { foo:\u0026#39;bbb\u0026#39; }; bar[foo]={foo:\u0026#39;bar\u0026#39;}; // baræ·»åŠ äº†ä»¥fooå˜é‡valueä½œä¸ºkey-\u0026gt;\u0026#39;aaa\u0026#39;çš„å±æ€§ // { foo: \u0026#39;bbb\u0026#39;, aaa: { foo: \u0026#39;bar\u0026#39; } } console.log(bar); ES6 ä¸­ï¼Œæ–°å¢äº† æ–¹æ‹¬å·è¯­æ³• ï¼Œç”¨äºè®¡ç®—å€¼å’Œå¯ä»¥å¾—åˆ°å€¼çš„è¡¨è¾¾å¼ã€‚\nconst foo = \u0026#39;aaa\u0026#39;; const bar = { [foo]: 18 //æ–¹æ‹¬å·å†…å€¼å¯ç›´æ¥è®¡ç®— }; console.log(bar);\t// { aaa: 18 } ğŸ“ƒ Example æ–¹æ‹¬å·å†…å¯ä»¥æ”¾çš„å†…å®¹\n// [å€¼ã€å¯ä»¥å¾—åˆ°å€¼çš„è¡¨è¾¾å¼] const prop = \u0026#39;aaa\u0026#39;; const fun = () =\u0026gt; \u0026#39;bbb\u0026#39;; const foo = { [prop]: \u0026#39;aaa\u0026#39;, [fun()]: \u0026#39;bbb\u0026#39;, [\u0026#39;bar\u0026#39;]: \u0026#39;ccc\u0026#39;, [\u0026#39;b\u0026#39; + \u0026#39;arr\u0026#39;]: \u0026#39;ddd\u0026#39; }; console.log(foo); // { aaa: \u0026#39;aaa\u0026#39;, bbb: \u0026#39;bbb\u0026#39;, bar: \u0026#39;ccc\u0026#39;, barr: \u0026#39;ddd\u0026#39; } :memo: Note æ–¹æ‹¬å·è¯­æ³•å’Œç‚¹è¯­æ³•çš„åŒºåˆ«\nç‚¹è¯­æ³•æ˜¯æ–¹æ‹¬å·è¯­æ³•çš„ ç‰¹æ®Šå½¢å¼ å±æ€§åç”± 0-9 A-z _ $ æ„æˆï¼Œä¸ä»¥æ•°å­—å¼€å¤´çš„æ—¶å€™å¯ä»¥ä½¿ç”¨ ç‚¹è¯­æ³•åˆæ³•æ ‡è¯†ç¬¦ èƒ½ç”¨ç‚¹è¯­æ³•ä¼˜å…ˆä½¿ç”¨ç‚¹è¯­æ³• const foo = { $bar: \u0026#39;aaa\u0026#39; }; console.log(foo.$bar === foo[\u0026#39;$bar\u0026#39;]); // true ","date":"2023-03-20","section":"techs","summary":"EcmaScript ES6 ä¹Ÿå³ ECMAScript è¿™é—¨æ ‡å‡†çš„ç¬¬ 6 ä»£ç‰ˆæœ¬ - 2015ã€‚\nECMAï¼šæ¬§æ´²è®¡ç®—æœºåˆ¶é€ å•†åä¼š\nå…·ä½“å†…å®¹ï¼šè¯­æ³• + API\nå†å²ç‰ˆæœ¬ï¼šES1 â†’ ES3 | ES5 â†’ ES6 ï¼Œä¹‹åæ¯å¹´å‡ºä¸€ä¸ªæ–°ç‰ˆæœ¬\nç›®å‰ä½¿ç”¨ JS çš„å¤§éƒ¨åˆ†å†…å®¹æ¥è‡ª ES3\nES ä¸ JS çš„å…³ç³»ï¼š\nJavaScriptæµè§ˆå™¨ç«¯ = ESMAScriptè¯­æ³•+API + DOM + BOM\nES6 çš„å…¼å®¹æ€§ï¼š\nä¸»æµæµè§ˆå™¨çš„æœ€æ–°ç‰ˆæœ¬å‡ ä¹éƒ½å…¨éƒ¨æ”¯æŒ ES6 IE è€ç‰ˆæœ¬ç­‰ä¸æ”¯æŒçš„æµè§ˆå™¨ï¼Œå¯ä»¥ä½¿ç”¨ Babel è½¬ç  æ€»ä¹‹ï¼Œè¯·æ”¾å¿ƒå¤§èƒ†åœ°ä½¿ç”¨ ES6 ES6 æ–°å¢äº†è¿™äº›ç‰¹æ€§ï¼š\nè¡¨è¾¾å¼ï¼šå£°æ˜ã€è§£æ„èµ‹å€¼\nå†…ç½®å¯¹è±¡ï¼šå­—ç¬¦ä¸²æ‰©å±•ã€æ•°å€¼æ‰©å±•ã€å¯¹è±¡æ‰©å±•ã€æ•°ç»„æ‰©å±•ã€å‡½æ•°æ‰©å±•ã€æ­£åˆ™æ‰©å±•ã€Symbolã€Setã€Mapã€Proxyã€Reflect\nè¯­å¥ä¸è¿ç®—ï¼šClass, Module, Iterator\nå¼‚æ­¥ç¼–ç¨‹ï¼šPromise, Generator, Async\nä¸¥æ ¼æ¨¡å¼ ä» ES5 å¼€å§‹ï¼Œå‡½æ•°å†…éƒ¨å¯ä»¥è®¾å®šä¸ºä¸¥æ ¼æ¨¡å¼ã€‚\nä¸¥æ ¼æ¨¡å¼æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š\nå˜é‡å¿…é¡»å£°æ˜åå†ä½¿ç”¨\nå‡½æ•°çš„å‚æ•°ä¸èƒ½æœ‰åŒåå±æ€§ï¼Œå¦åˆ™æŠ¥é”™\nä¸èƒ½ä½¿ç”¨ with è¯­å¥\n","title":"06 EcmaScript","url":"/techs/06-ecmascript/"},{"content":"Typescript TypeS*cript* - TS ï¼Œæ˜¯ä¸€ç§ç”±å¾®è½¯å¼€å‘çš„è‡ªç”±å’Œå¼€æºçš„ç¼–ç¨‹è¯­è¨€ã€‚\nflowchart LR %%--level 1 0(\u0026#34;Typescript\u0026#34;) 1[\u0026#34;TSæ˜¯ä»€ä¹ˆ\u0026#34;] 2[\u0026#34;TSçš„åŸºæœ¬æ•°æ®ç±»å‹\u0026#34;] 3[\u0026#34;Class\u0026#34;] 4[\u0026#34;æ–­è¨€ä¸ç±»å‹å®ˆå«\u0026#34;] 5[\u0026#34;èŒƒå‹\u0026#34;] 6[\u0026#34;\u0026lt;ruby\u0026gt;è”åˆç±»å‹\u0026lt;rt\u0026gt;Union Type\u0026lt;/rt\u0026gt;\u0026lt;/ruby\u0026gt;\u0026#34;] 7[\u0026#34;åˆ«åä¸æ¥å£\u0026#34;] 8[\u0026#34;å¸¸ç”¨æŠ€å·§\u0026#34;] %%--level 0 relation 1---0;2---0;3---0;4---0; 0---5;0---6;0---7;0---8 subgraph \u0026amp;nbsp %%--level 1 1.1[\u0026#34;TSå’ŒJSçš„å…³ç³»\u0026#34;] 1.2[\u0026#34;å®‰è£…TS\u0026#34;] 1.3[\u0026#34;ç¼–è¯‘\u0026#34;] %%--level 1 relation 1.1---1;1.2---1;1.3---1 %%--level 2 2.1[\u0026#34;åŸºæœ¬ç±»å‹\u0026#34;] 2.2[\u0026#34;å¼•ç”¨ç±»å‹\u0026#34;] 2.3[\u0026#34;ç‰¹æ®Šç±»å‹\u0026#34;] 2.4[\u0026#34;å…¶å®ƒç±»å‹\u0026#34;] %%--level 2 relation 2.1---2;2.2---2;2.3---2;2.4---2; %%--level 3 3.1[\u0026#34;åŸºæœ¬æ–¹æ³•\u0026#34;] 3.2[\u0026#34;ç§æœ‰å­—æ®µ\u0026#34;] 3.3[\u0026#34;åªè¯»å±æ€§\u0026#34;] 3.4[\u0026#34;ç»§æ‰¿\u0026#34;] 3.5[\u0026#34;ä¿®é¥°ç¬¦\u0026#34;] 3.6[\u0026#34;abstract\u0026#34;] 3.7[\u0026#34;é‡å†™ä¸é‡è½½\u0026#34;] %%--level 3 relation 3.1---3;3.2---3;3.3---3;3.4---3;3.5---3;3.6---3;3.7---3; %%--level 4 4.1[\u0026#34;TSæ–­è¨€\u0026#34;] 4.2[\u0026#34;ç±»å‹å®ˆå«\u0026#34;] %%--level 4 relation 4.1---4;4.2---4; end subgraph \u0026amp;nbsp\u0026amp;nbsp %%--level 5 5.1[\u0026#34;è¯­æ³•\u0026#34;] 5.2[\u0026#34;å¤šç±»å‹ä¼ å‚\u0026#34;] 5.3[\u0026#34;æ¥å£\u0026#34;] 5.4[\u0026#34;ç±»\u0026#34;] 5.5[\u0026#34;ç±»åˆ«å\u0026#34;] 5.6[\u0026#34;é»˜è®¤å‚æ•°\u0026#34;] 5.7[\u0026#34;å¸¸ç”¨å­—æ¯\u0026#34;] %%--level 5 relation 5---5.1;5---5.2;5---5.3;5---5.4;5---5.5;5---5.6;5---5.7 %%--level 6 6.1[\u0026#34;å¯è¾¨è¯†è”åˆ\u0026#34;] %%--level 6 relation 6---6.1 %%--level 7 7.1[\u0026#34;ç±»å‹åˆ«å\u0026#34;] 7.2[\u0026#34;æ¥å£\u0026#34;] 7.3[\u0026#34;typeå’ŒinterfaceåŒºåˆ«\u0026#34;] %%--level 7 relation 7---7.1;7---7.2;7---7.3 %%--level 8 8.1[\u0026#34;extends\u0026#34;] 8.2[\u0026#34;tepeof\u0026#34;] 8.3[\u0026#34;keyof\u0026#34;] 8.4[\u0026#34;ç´¢å¼•è®¿é—®æ“ä½œç¬¦\u0026#34;] 8.5[\u0026#34;in\u0026#34;] 8.6[\u0026#34;infer\u0026#34;] 8.7[\u0026#34;...\u0026#34;] %%--level 8 relation 8---8.1;8---8.2;8---8.3;8---8.4;8---8.5;8---8.6;8---8.7 end classDef transparent fill:none,stroke:none class \u0026amp;nbsp,\u0026amp;nbsp\u0026amp;nbsp transparent TypeScript æ˜¯ JavaScript çš„ è¶…é›† ï¼Œç®€å•çš„è¯´å°±æ˜¯åœ¨ JavaScript çš„åŸºç¡€ä¸ŠåŠ å…¥äº† ç±»å‹ç³»ç»Ÿtype systemï¼Œè®©æ¯ä¸ªå‚æ•°éƒ½æœ‰æ˜ç¡®çš„æ„ä¹‰ï¼Œä»è€Œå¸¦æ¥äº†æ›´åŠ  æ™ºèƒ½ çš„æç¤ºã€‚\nTypeScript å±äºå¼ºç±»å‹è¯­è¨€ï¼Œæ‰€ä»¥å¯¹äºé¡¹ç›®è€Œè¨€ï¼Œä¼šä½¿ä»£ç æ›´åŠ è§„èŒƒï¼Œä»è€Œè§£å†³äº†å¤§å‹é¡¹ç›®ä»£ç çš„å¤æ‚æ€§ã€‚\nTypeScript å¯ä»¥åˆ†ä¸ºä¸¤éƒ¨ä»½ï¼š\nEcmaScript çš„é«˜é˜¶è¯­æ³•ç³– ä¸»è¦åŒ…æ‹¬ä¸åŒç‰ˆæœ¬çš„ JS ç›¸äº’å…¼å®¹ã€Class çš„ implements å®ç°æ¥å£ç»§æ‰¿ã€ abstract å®ç°æŠ½è±¡ç±»ã€ä»¥åŠç›®å‰è¿˜åœç•™åœ¨ stage2 çš„ @decoratorç¼–è¯‘æ—¶éœ€æ·»åŠ  --experimentalDecorators å‚æ•°\nâ€”â€”è¿™éƒ¨åˆ†é€šè¿‡ Babel ä¹Ÿå¯å®ç°ç›¸åŒæ•ˆæœ\nå¦ä¸€éƒ¨åˆ†æ˜¯å¼ºç±»å‹çš„ç±»å‹ç³»ç»Ÿï¼Œä¸»è¦åŒ…æ‹¬äº† Type^ç±»å‹^, Assertion^æ–­è¨€^, Guards^ç±»å‹å®ˆå«^, Interfaces^æ¥å£^, Generics^æ³›å‹^ã€‚å¦å¤–è¿˜æœ‰ä¸€äº›äº¤å‰çŸ¥è¯† ç¬¬ä¸€éƒ¨åˆ†å°†ä¼šè¢«è‡ªåŠ¨è½¬æ¢ï¼Œæ¯”å¦‚ ES2022 ä¸­çš„ # ç¼–è¯‘ä¸ºä½ç‰ˆæœ¬æ—¶ç”± WeakMap(this, privateKeys) å®ç°ï¼›è€Œç¬¬äºŒéƒ¨åˆ†ä¸ä¼šè¢«ç¼–è¯‘ä¸º JavaScript ï¼Œåœ¨è¾“å…¥ä»£ç æ—¶è¿›è¡ŒåŠ¨æ€ç±»å‹æ£€æŸ¥ã€‚ææ‡‚è¿™ä¸¤éƒ¨åˆ†å…³ç³»ï¼Œå­¦ä¹ å°±è½»æ¾å¤šäº†ã€‚\nå¯¹äºä¸€èˆ¬çš„é¢å‘å¯¹è±¡è¯­è¨€ï¼Œç»§æ‰¿æœ‰ä¸¤ç§ï¼šæ¥å£ç»§æ‰¿interface inheritance å’Œ å®ç°ç»§æ‰¿implement inheritance ï¼ŒES åªå®ç°äº†åè€…ï¼Œè€Œ TS é€šè¿‡ interface å…³é”®å­—è§£å†³äº†è¿™ä¸ªé—®é¢˜ ã€‚å¦å¤– TS åˆä» C++, Haskell å€Ÿé‰´äº†ä¸€éƒ¨åˆ†çš„è¯­æ³•ã€‚TS å¼¥è¡¥äº†å¤§é‡ä¸è¶³ï¼Œä½¿å¾— JS æˆä¸ºäº†ä¸€é—¨å¼ºå¤§çš„è¯­è¨€ã€‚\næµè§ˆå™¨ä¸èƒ½ç›´æ¥è¯†åˆ« TypeScript ï¼Œæ‰€ä»¥åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼ŒTypeScript æ–‡ä»¶ä¼šå…ˆç¼–è¯‘ä¸º JavaScript æ–‡ä»¶ã€‚\ngraph LR T--\u0026gt;|ç¼–è¯‘|J1 J1--\u0026gt;|æ‰“åŒ…|J2 J2--\u0026gt;|éƒ¨ç½²|C T(\u0026#34;TypeScript\u0026lt;tt\u0026gt;\u0026lt;div style=\u0026#39;border:1px dashed;padding:1em;margin:.5em\u0026#39;\u0026gt;a.ts\u0026lt;br\u0026gt;b.ts\u0026lt;br\u0026gt;c.ts\u0026lt;/div\u0026gt;\u0026lt;/tt\u0026gt;\u0026#34;) J1(\u0026#34;JavaScript\u0026lt;tt\u0026gt;\u0026lt;div style=\u0026#39;border:1px dashed;padding:1em;margin:.5em\u0026#39;\u0026gt;a.js\u0026lt;br\u0026gt;b.js\u0026lt;br\u0026gt;c.js\u0026lt;/div\u0026gt;\u0026lt;/tt\u0026gt;\u0026#34;) J2(\u0026#34;JavaScript\u0026lt;tt\u0026gt;\u0026lt;div style=\u0026#39;border:1px dashed;padding:1em;margin:.5em\u0026#39;\u0026gt;\u0026lt;br\u0026gt;main.js\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/tt\u0026gt;\u0026#34;) C(\u0026#34;Chrome\u0026lt;tt\u0026gt;\u0026lt;div style=\u0026#39;border:1px dashed;padding:1em;margin:.5em\u0026#39;\u0026gt;\u0026lt;br\u0026gt;main.js\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/tt\u0026gt;\u0026#34;) Usage^ä½¿ç”¨^ å®‰è£… $ npm install -g typescript //æˆ– $ yarn global add typescript // package.json \u0026#34;devDependencies\u0026#34;: { \u0026#34;typescript\u0026#34;: \u0026#34;^4.7.4\u0026#34;, \u0026#34;jslint\u0026#34;: \u0026#34;^0.12.1\u0026#34; } ç„¶åè¿è¡Œ (npm install) \u0026amp;\u0026amp; (npx tsc --init) è¿›è¡Œåˆå§‹åŒ–ã€‚ç°åœ¨ä¸éœ€è¦å•ç‹¬å®‰è£… tsc äº†ã€‚\næŸ¥çœ‹ç‰ˆæœ¬ $ tsc -v ç¼–è¯‘ $ tsc test.ts # test.ts =\u0026gt; test.js // package.json \u0026#34;scripts\u0026#34;: { \u0026#34;start\u0026#34;: \u0026#34;tsc \u0026amp;\u0026amp; (node out/entry.js)\u0026#34;, \u0026#34;init\u0026#34;: \u0026#34;clear \u0026amp;\u0026amp; (npm install) \u0026amp;\u0026amp; (npx tsc --init) \u0026amp;\u0026amp; (npm init @eslint/config)\u0026#34; }, å‚æ•° ä½¿ç”¨ -t æŒ‡å®šç¼–è¯‘åçš„ ES ç‰ˆæœ¬ï¼Œä½¿ç”¨ -lib æŒ‡å®šåº“\n:memo: Note -lib å‚æ•°æ¥å—ä¸€ä¸ªæ•°ç»„ list ã€‚\nå¯ä»¥åœ¨ Webstromä¸­æŒ‡å®šå•ä¸ª Typescript æ–‡ä»¶çš„ç¼–è¯‘ï¼Œå‚æ•°è®¾ç½®å¦‚ä¸‹ï¼š\n$ -t ES2020 --lib: [\u0026#34;ES2020\u0026#34;, \u0026#34;DOM\u0026#34;] --alwaysStrict test.ts åœ¨çº¿ç¼–è¯‘ æ–¹ä¾¿èµ·è§ï¼Œå¯ä»¥ä½¿ç”¨çº¿ä¸Šçš„ç¼–è¾‘å™¨ï¼šTypeScript Playground ã€‚\nå¹¶ä¸”è¿˜å¯ä»¥çœ‹çœ‹ç”Ÿæˆå¯¹åº”çš„ TS è½¬åŒ– ES5 ï¼ŒES6 ä¹‹åçš„ä»£ç ã€‚\nType^ç±»å‹^ TypeScript çš„æ•°æ®ç±»å‹ç®€å•å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š\nåŸºæœ¬ç±»å‹ string, number, boolean, symbol, bigint, null, undefined\nå¼•ç”¨ç±»å‹ array, Tupleå…ƒç»„, objectåŒ…å«Objectå’Œ*{}*, function\nç‰¹æ®Šç±»å‹ any, unknow, void, nerver, enum\nåˆ«åä¸æ¥å£ type, interface\nå…¶ä»–ç±»å‹ ç±»å‹æ¨ç†, å­—é¢é‡ç±»å‹, äº¤å‰ç±»å‹\nTypeScript åªä¼šåœ¨ç¼–è¯‘é˜¶æ®µå¯¹ç±»å‹è¿›è¡Œé™æ€æ£€æŸ¥ï¼Œå¦‚æœå‘ç°æœ‰é”™è¯¯ï¼Œç¼–è¯‘æ—¶å°±ä¼šæŠ¥é”™ã€‚è€Œåœ¨è¿è¡Œæ—¶ï¼Œç¼–è¯‘ç”Ÿæˆçš„ JS ä¸æ™®é€šçš„ JavaScript æ–‡ä»¶ä¸€æ ·ï¼Œå¹¶ä¸ä¼šè¿›è¡Œç±»å‹æ£€æŸ¥ã€‚\nBasic^åŸºæœ¬ç±»å‹^ //å­—ç¬¦ä¸² let str: string = \u0026#34;Domes\u0026#34;; // æ•°å­— let num: number = 7; //å¸ƒå°” let bool: boolean = true; //symbol let sym: symbol; // TS2585: \u0026#39;Symbol\u0026#39; only refers to a type, but is being used as a value here. Do you need to change your target library? Try changing the \u0026#39;lib\u0026#39; compiler option to es2015 or later. //bigint let big: bigint = 10n; // TS2737: BigInt literals are not available when targeting lower than ES2020 //null let nu: null = null; //undefined let un: undefined = undefined; :memo: Note\nnull å’Œ undefined ä¸¤ä¸ªç±»å‹ä¸€æ—¦èµ‹å€¼ä¸Šï¼Œå°±ä¸èƒ½åœ¨èµ‹å€¼ç»™ä»»ä½•å…¶ä»–ç±»å‹\nsymbol æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œå‡è®¾å†å®šä¹‰ä¸€ä¸ª sym1 ï¼Œé‚£ä¹ˆ\nlet sym = Symbol(); let sym1 = Symbol(); sym === sym1; //false Reference^å¼•ç”¨ç±»å‹^ Array^æ•°ç»„^ ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼š\nT + []\nArray\u0026lt;T\u0026gt;ï¼šæ³›å‹*^genertic^* è¯­æ³•\nlet arr1: number[] = [1, 2, 3] let arr2: Array\u0026lt;number\u0026gt; = [1, 2, 3] let arr3: Array\u0026lt;number\u0026gt; = [1, 2, \u0026#39;3\u0026#39;] // error // TS2322: Type \u0026#39;string\u0026#39; is not assignable to type \u0026#39;number\u0026#39;. // æ”¯æŒå¤šç§ç±»å‹ï¼Œä½¿ç”¨ï½œç¬¦å· let arr4: Array\u0026lt;number | string\u0026gt; = [1, 2, \u0026#39;3\u0026#39;] //ok Tuple^å…ƒç»„^ Tuple å¯ä»¥è¯´æ˜¯ Array çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µã€‚\narr3 çš„ç±»å‹å¯ä»¥æ˜¯ string ä¹Ÿå¯ä»¥æ˜¯ number ï¼Œä½†å¯¹æ¯ä¸ªå…ƒç´ æ²¡æœ‰ä½œå‡ºå…·ä½“çš„é™åˆ¶ã€‚\né‚£ä¹ˆ Tuple çš„ä½œç”¨å°±æ˜¯é™åˆ¶ å…ƒç´ çš„ç±»å‹ å¹¶ä¸” é™åˆ¶ä¸ªæ•° çš„æ•°ç»„ï¼ŒåŒæ—¶ Tupleè¿™ä¸ªæ¦‚å¿µåªå­˜åœ¨äº TS ï¼Œåœ¨ JS ä¸Šæ˜¯ä¸å­˜åœ¨çš„ã€‚\nè¿™é‡Œå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šåœ¨ TS ä¸­ï¼Œæ˜¯å…è®¸å¯¹ Tuple æ‰©å¢çš„ï¼ˆä¹Ÿå°±æ˜¯å…è®¸ä½¿ç”¨ push æ–¹æ³•ï¼‰ï¼Œä½†åœ¨ è®¿é—®ä¸Šä¸å…è®¸ ã€‚\nlet t: [number, string] = [1, \u0026#39;2\u0026#39;]; // ok let t1: [number, string] = [1, 3]; // error // TS2322: Type \u0026#39;number\u0026#39; is not assignable to type \u0026#39;string\u0026#39;. let t2: [number, string] = [1]; // error // TS2322: Type \u0026#39;[number]\u0026#39; is not assignable to type \u0026#39;[number, string]\u0026#39;. Source has 1 element(s) but target requires 2. let t3: [number, string] = [1, \u0026#39;1\u0026#39;, true]; // error // Source has 3 element(s) but target allows only 2. let t5: [number, string] = [1, \u0026#39;2\u0026#39;]; // ok t.push(2); // å…è®¸é€šè¿‡pushå¯¹tupleæ‰©å¢ï¼Œä½†å¹¶ä¸èƒ½è¢«è®¿é—® console.log(t) // [1, \u0026#39;2\u0026#39;, 2] let a = t[0]; // ok let b = t[1]; // ok let c = t[2]; // error // TS2493: Tuple type \u0026#39;[number, string]\u0026#39; of length \u0026#39;2\u0026#39; has no element at index \u0026#39;2\u0026#39;. TypeScript 4.0 å¼€å§‹ï¼Œæ”¯æŒä¸ºå…ƒç»„ç±»å‹è®¾ç½®æ ‡ç­¾ï¼š\nfunction addPerson(...args: [name: string, age: number]): void { console.log(`Person info: name: ${args[0]}, age: ${args[1]}`); } ä¹‹åï¼Œå½“æˆ‘ä»¬ä½¿ç”¨ addPerson æ–¹æ³•æ—¶ï¼ŒTypeScript çš„æ™ºèƒ½æç¤ºå°±ä¼šå˜å¾—æ›´åŠ å‹å¥½ã€‚\n// æœªä½¿ç”¨æ ‡ç­¾çš„æ™ºèƒ½æç¤º // addPerson(args_0: string, args_1: number): void function addPerson(...args: [string, number]): void { console.log(`Person info: name: ${args[0]}, age: ${args[1]}`) } // è®¾ç½®ç±»å‹æ ‡ç­¾åçš„æ™ºèƒ½æç¤º // addPerson(name: string, age: number): void function addPerson2(...args: [name: string, age: number]): void { console.log(`Person info: name: ${args[0]}, age: ${args[1]}`); } Object^å¯¹è±¡^ objecté¦–å­—æ¯å°å†™ object è¡¨ç¤ºéåŸå§‹ç±»å‹ã€‚åœ¨å®šä¹‰ä¸Šç›´æ¥ä½¿ç”¨ object æ˜¯å¯ä»¥çš„ï¼Œä½†ä¸èƒ½æ›´æ”¹å¯¹è±¡çš„å±æ€§ï¼ŒåŸå› æ˜¯å¹¶æ²¡æœ‰ä½¿å¯¹è±¡çš„å†…éƒ¨å…·ä½“çš„å±æ€§åšé™åˆ¶ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ {} æ¥å®šä¹‰å†…éƒ¨ç±»å‹\nlet obj1: object = {a: 1, b: 2} obj1.a = 3 // error // Property \u0026#39;a\u0026#39; does not exist on type \u0026#39;object\u0026#39;.(2339) let obj2: { a: number, b: number } = {a: 1, b: 2} obj2.a = 3 // ok Object^é¦–å­—æ¯å¤§å†™^ Object è¡¨ç¤º Object ç±»çš„å®ä¾‹ï¼Œä¹Ÿå³é™¤äº† null å’Œ undefined çš„æ‰€æœ‰ç±»å‹ã€‚ï¼ˆè¿™æ˜¯å› ä¸ºï¼Œ Function ç±»å‹ä¹Ÿæ˜¯ç”± Object ç»§æ‰¿è€Œæ¥ ï¼‰\nlet obj: Object; obj = null; // error // Type \u0026#39;null\u0026#39; is not assignable to type \u0026#39;Object\u0026#39;.(2322) obj = undefined; // error // Type \u0026#39;undefined\u0026#39; is not assignable to type \u0026#39;Object\u0026#39;.(2322) obj = 1; // ok obj = \u0026#34;a\u0026#34;; // ok obj = true; // ok obj = {}; // ok obj = Symbol() //ok // BigInt literals are not available when targeting lower than ES2020. obj = 10n //ok :memo: Note\nObject æ¥å£å®šä¹‰äº† Object.prototype åŸå‹å¯¹è±¡ä¸Šçš„å±æ€§ // node_modules/typescript/lib/lib.es5.d.ts interface Object { constructor: Function; toString(): string; toLocaleString(): string; valueOf(): Object; hasOwnProperty(v: PropertyKey): boolean; isPrototypeOf(v: Object): boolean; propertyIsEnumerable(v: PropertyKey): boolean; } ObjectConstructor æ¥å£å®šä¹‰äº† Object ç±»çš„å±æ€§ // node_modules/typescript/lib/lib.es5.d.ts interface ObjectConstructor { /** Invocation via `new` */ new(value?: any): Object; /** Invocation via function calls */ (value?: any): any; readonly prototype: Object; getPrototypeOf(o: any): any; // Â·Â·Â· } declare var Object: ObjectConstructor; Object ç±»çš„æ‰€æœ‰å®ä¾‹éƒ½ç»§æ‰¿äº† Object æ¥å£ä¸­çš„æ‰€æœ‰å±æ€§ã€‚\n{}^ç©ºå¯¹è±¡^ ç±»å‹æè¿°äº†ä¸€ä¸ªæ²¡æœ‰æˆå‘˜çš„å¯¹è±¡ã€‚å½“ä½ è¯•å›¾è®¿é—®è¿™æ ·ä¸€ä¸ªå¯¹è±¡çš„ä»»æ„å±æ€§æ—¶ï¼ŒTypeScript ä¼šäº§ç”Ÿä¸€ä¸ªç¼–è¯‘æ—¶é”™è¯¯ã€‚\n// Type {} const obj = {}; // Error: Property \u0026#39;prop\u0026#39; does not exist on type \u0026#39;{}\u0026#39;. obj.prop = \u0026#34;semlinker\u0026#34;; ä½†æ˜¯ï¼Œä½ ä»ç„¶å¯ä»¥ä½¿ç”¨åœ¨ Object ç±»å‹ä¸Šå®šä¹‰çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œè¿™äº›å±æ€§å’Œæ–¹æ³•å¯é€šè¿‡ JavaScript çš„åŸå‹é“¾éšå¼åœ°ä½¿ç”¨ï¼š\n// Type {} const obj = {}; // \u0026#34;[object Object]\u0026#34; obj.toString(); Function^å‡½æ•°^ classDiagram direction LR JavaScript --\u0026gt; TypeScript class TypeScript{ å«æœ‰ç±»å‹ ç®­å¤´å‡½æ•° å‡½æ•°ç±»å‹ å¿…å¡«å’Œå¯é€‰å‚æ•° é»˜è®¤å‚æ•° å‰©ä½™å‚æ•° å‡½æ•°é‡è½½ } class JavaScript{ æ— ç±»å‹ ç®­å¤´å‡½æ•°ï¼ˆES2015ï¼‰ æ— å‡½æ•°ç±»å‹ æ‰€æœ‰å‚æ•°éƒ½æ˜¯å¯é€‰çš„ é»˜è®¤å‚æ•° å‰©ä½™å‚æ•° æ— å‡½æ•°é‡è½½ } å®šä¹‰å‡½æ•° æœ‰ä¸¤ç§å®šä¹‰æ–¹å¼ï¼šä¸€ç§ä¸º functionï¼Œ å¦ä¸€ç§ä¸º ç®­å¤´å‡½æ•° ã€‚\nåœ¨ä¹¦å†™çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥å†™å…¥è¿”å›å€¼çš„ç±»å‹ï¼Œå¦‚æœå†™å…¥ï¼Œåˆ™ å¿…é¡» è¦æœ‰å¯¹åº”ç±»å‹çš„è¿”å›å€¼ï¼Œä½†é€šå¸¸æƒ…å†µä¸‹å¯ä»¥ çœç•¥ ï¼Œå› ä¸º TS çš„ç±»å‹æ¨æ–­åŠŸèƒ½å¤Ÿæ­£ç¡®æ¨æ–­å‡ºè¿”å›å€¼ç±»å‹ã€‚\nfunction setName1(name: string) { //ok console.log(\u0026#34;hello\u0026#34;, name); } setName1(\u0026#34;Domes\u0026#34;); // \u0026#34;hello\u0026#34;, \u0026#34;Domes\u0026#34; function setName2(name: string): string { //error // TS2355: A function whose declared type is neither \u0026#39;void\u0026#39; nor \u0026#39;any\u0026#39; must return a value. console.log(\u0026#34;hello\u0026#34;, name); } setName2(\u0026#34;Domes\u0026#34;); function setName3(name: string): string { //error console.log(\u0026#34;hello\u0026#34;, name); return 1; // TS2322: Type \u0026#39;number\u0026#39; is not assignable to type \u0026#39;string\u0026#39;. } setName3(\u0026#34;Domes\u0026#34;); function setName4(name: string): string { //ok console.log(\u0026#34;hello\u0026#34;, name); return name; } setName4(\u0026#34;Domes\u0026#34;); // \u0026#34;hello\u0026#34;, \u0026#34;Domes\u0026#34; // ç®­å¤´å‡½æ•°ä¸ä¸ŠåŒç†ï¼Œä¸è¿‡å†™åœ¨å†…éƒ¨ const setName5 = (name: string) =\u0026gt; console.log(\u0026#34;hello\u0026#34;, name); setName5(\u0026#34;Domes\u0026#34;) // \u0026#34;hello\u0026#34;, \u0026#34;Domes\u0026#34; å‚æ•°ç±»å‹ å¯é€‰å‚æ•°ï¼š å¦‚æœå‡½æ•°è¦é…ç½®å¯æœ‰å¯æ— çš„å‚æ•°æ—¶ï¼Œå¯ä»¥åœ¨å½¢å‚æ•°ååŠ ä¸Š ? å®ç°ï¼Œæ³¨æ„å¯é€‰å‚æ•°è¦æ”¾åœ¨æœ€åé¢ TS1016: A required parameter cannot follow an optional parameter. é»˜è®¤å‚æ•°ï¼šå‡½æ•°å†…å¯ä»¥è‡ªå·±è®¾å®šå…¶é»˜è®¤å‚æ•°ï¼Œç”¨ = å®ç°\nå‰©ä½™å‚æ•°ï¼šä»å¯ä»¥ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ ...\n/* 1. å¯é€‰å‚æ•° */ const setInfo1 = (name: string, age?: number) =\u0026gt; console.log(name, age) setInfo1(\u0026#39;Domesy\u0026#39;) //\u0026#34;Domesy\u0026#34;, undefined setInfo1(\u0026#39;Domesy\u0026#39;, 7) //\u0026#34;Domesy\u0026#34;, 7 /* 2. é»˜è®¤å‚æ•° */ const setInfo2 = (name: string, age: number = 11) =\u0026gt; console.log(name, age) setInfo2(\u0026#39;Domesy\u0026#39;) //\u0026#34;Domesy\u0026#34;, 11 setInfo2(\u0026#39;Domesy\u0026#39;, 7) //\u0026#34;Domesy\u0026#34;, 7 /* 3. å‰©ä½™å‚æ•° */ const allCount = (...numbers: number[]) =\u0026gt; console.log(`æ•°å­—æ€»å’Œä¸ºï¼š${numbers.reduce((val, item) =\u0026gt; (val += item), 0)}`); allCount(1, 2, 3); //\u0026#34;æ•°å­—æ€»å’Œä¸ºï¼š6\u0026#34; å‡½æ•°é‡è½½ æ˜¯ä½¿ç”¨ ç›¸åŒåç§° å’Œ ä¸åŒå‚æ•°æ•°é‡æˆ–ç±»å‹ åˆ›å»ºå¤šä¸ªæ–¹æ³•çš„ä¸€ç§èƒ½åŠ›ã€‚\nTypeScript å…è®¸åœ¨åŒä¸€èŒƒå›´ä¸­å£°æ˜å‡ ä¸ªåŠŸèƒ½ç±»ä¼¼çš„ åŒå å‡½æ•°ï¼Œè¡¨ç°ä¸ºç»™åŒä¸€ä¸ªå‡½æ•°æä¾›å¤šä¸ªå‡½æ•°ç±»å‹å®šä¹‰ï¼Œå¸¸ç”¨æ¥å®ç°åŠŸèƒ½ç±»ä¼¼è€Œæ‰€å¤„ç†çš„æ•°æ®ç±»å‹ä¸åŒçš„é—®é¢˜ã€‚\n:memo: Note TS å¼•æ“æŒ‰ç…§è‡ªä¸Šè€Œä¸‹çš„é¡ºåºæŸ¥æ‰¾é‡è½½è¡¨ï¼Œå› æ­¤è¦æŠŠæœ€ç²¾ç¡®çš„å®šä¹‰æ”¾åœ¨æœ€å‰é¢ï¼Œä»¥å‡å°‘æŸ¥æ‰¾æ—¶é—´ã€‚\nlet obj: any = {}; // é‡è½½åˆ—è¡¨ function setInfo(val: string): void; function setInfo(val: number): void; function setInfo(val: boolean, val2): void; // å®é™…å‡½æ•° function setInfo(val: string | number | boolean, val2?): void { if (typeof val === \u0026#34;string\u0026#34;) { obj.name = val; } else { obj.age = val; } val2 = val; } setInfo(\u0026#34;Domes\u0026#34;); setInfo(7); setInfo(true, \u0026#39;any\u0026#39;); console.log(obj); // { name: \u0026#39;Domes\u0026#39;, age: 7 } ReturnType è·å–å‡½æ•°è¿”å›å€¼\ntype Bar = string; type foo = () =\u0026gt; Bar; type baz = ReturnType\u0026lt;foo\u0026gt;; Wildcard^é€šé…ç±»å‹^ Any åœ¨ TS ä¸­ï¼Œä»»ä½•ç±»å‹éƒ½å¯ä»¥å½’äº any ç±»å‹ï¼Œæ‰€ä»¥ any ç±»å‹ä¹Ÿå°±æˆäº†æ‰€æœ‰ç±»å‹çš„é¡¶çº§ç±»å‹ï¼ŒåŒæ—¶ï¼Œå¦‚æœä¸æŒ‡å®šå˜é‡çš„ç±»å‹ï¼Œåˆ™é»˜è®¤ä¸º any ç±»å‹ï¼Œå½“ç„¶ä¸æ¨èä½¿ç”¨è¯¥ç±»å‹ï¼Œå› ä¸ºè¿™æ ·ä¸§å¤±äº† TS çš„ä½œç”¨ï¼Œè€Œä¸”å†™å’Œä¸å†™æ²¡ä»€ä¹ˆåŒºåˆ«ã€‚\nlet d:any; //ç­‰ä»·äº let d d = \u0026#39;1\u0026#39;; d = 2; d = etrue; d = [1, 2, 3]; d = {} :memo: Note ç±»å‹æ¨è®º\nå¦‚æœä¸è®¾ç½®ç±»å‹ï¼Œå¹¶ä¸”ä¸è¿›è¡Œèµ‹å€¼æ—¶ï¼Œå°†ä¼šè¢«è¢«è‡ªåŠ¨æ¨è®ºä¸º any ç±»å‹ï¼Œå¦‚æœå¯¹å…¶è¿›è¡Œèµ‹å€¼å°±ä¼šé»˜è®¤ä¸ºè¯¥ç±»å‹ã€‚\nlet any; // æ¨æ–­ä¸ºany let str = \u0026#39;foo\u0026#39;; // æ¨æ–­ä¸ºstring let num = 1; // æ¨æ–­ä¸ºnumber let flag = false; // æ¨æ–­ä¸ºboolean str = true; // TS2322: Type \u0026#39;boolean\u0026#39; is not assignable to type \u0026#39;string\u0026#39;. num = \u0026#39;bar\u0026#39;; // TS2322: Type \u0026#39;string\u0026#39; is not assignable to type \u0026#39;number\u0026#39;. flag = 0; // TS2322: Type \u0026#39;number\u0026#39; is not assignable to type \u0026#39;boolean\u0026#39;. Unknow unknow ä¸ any ä¸€æ ·ï¼Œéƒ½å¯ä»¥ä½œä¸ºæ‰€æœ‰ç±»å‹çš„ é¡¶çº§ç±»å‹ ï¼Œä½† unknow æ›´åŠ ä¸¥æ ¼ï¼Œåªèƒ½è¢«èµ‹å€¼ç»™ any ç±»å‹å’Œ unknown ç±»å‹æœ¬èº«ã€‚ä¸å…è®¸å®šä¹‰çš„å€¼æœ‰ä»»ä½•æ“ä½œï¼ˆå¦‚ æ–¹æ³•ï¼Œnewç­‰ï¼‰ï¼Œä½† any å¯ä»¥ã€‚\nlet u:unknown; let a: any; u = \u0026#39;1\u0026#39;; //ok u = 2; //ok u = true; //ok u = [1, 2, 3]; //ok u = {}; //ok let value:any = u //ok let value1:any = a //ok let value2:unknown = u //ok let value3:unknown = a //ok let value4:string = u //error let value5:string = a //ok let value6:number = u //error let value7:number = a //ok let value8:boolean = u //error let value9:boolean = a //ok u.set() // error a.set() //ok u() // error a() //ok new u() // error new a() //ok Void void å½“ä¸€ä¸ªå‡½æ•°ï¼Œæ²¡æœ‰è¿”å›å€¼æ—¶ï¼ŒTS ä¼šé»˜è®¤å®ƒçš„è¿”å›å€¼ä¸º void ç±»å‹ï¼Œå®é™…ä¸º undefined ã€‚\nconst setInfo = ():void =\u0026gt; {} // ç­‰ä»·äº const setInfo = () =\u0026gt; {} const setInfo1 = ():void =\u0026gt; { return \u0026#39;1\u0026#39; } // error const setInfo2 = ():void =\u0026gt; { return 2 } // error const setInfo3 = ():void =\u0026gt; { return true } // error const setInfo4 = ():void =\u0026gt; { return } // ok const setInfo5 = ():void =\u0026gt; { return undefined } //ok Never never è¡¨ç¤ºä¸€ä¸ªå‡½æ•°æ°¸è¿œä¸å­˜åœ¨è¿”å›å€¼ï¼ŒTS ä¼šè®¤ä¸ºç±»å‹ä¸º never ï¼Œé‚£ä¹ˆä¸ void ç›¸æ¯”ï¼Œ never åº”è¯¥æ˜¯ void å­é›†ï¼Œ å› ä¸º void å®é™…ä¸Šçš„è¿”å›å€¼ä¸º undefined ï¼Œè€Œ never è¿ undefined ä¹Ÿä¸è¡Œ\nç¬¦åˆ never çš„æƒ…å†µæœ‰ï¼šå½“æŠ›å‡ºå¼‚å¸¸çš„æƒ…å†µå’Œæ— é™æ­»å¾ªç¯\nlet error = (): never =\u0026gt; { // ç­‰ä»·äº let error = () =\u0026gt; {} throw new Error(\u0026#34;error\u0026#34;); }; let _while = (): never =\u0026gt; { while(true){} } ğŸ’¡ Trick ^â­ï¸^ å…¨é¢æ€§æ£€æŸ¥ åœ¨ TypeScript ä¸­ï¼Œå¯ä»¥åˆ©ç”¨ never ç±»å‹çš„ç‰¹æ€§æ¥å®ç°å…¨é¢æ€§æ£€æŸ¥ï¼Œå…·ä½“ç¤ºä¾‹å¦‚ä¸‹ï¼š\n:page_with_curl: Example\ntype Foo = string | number; function controlFlowAnalysisWithNever(foo: Foo) { if (typeof foo === \u0026#34;string\u0026#34;) { // è¿™é‡Œ foo è¢«æ”¶çª„ä¸º string ç±»å‹ } else if (typeof foo === \u0026#34;number\u0026#34;) { // è¿™é‡Œ foo è¢«æ”¶çª„ä¸º number ç±»å‹ } else { // foo åœ¨è¿™é‡Œæ˜¯ never const check: never = foo; } } æ³¨æ„åœ¨ else åˆ†æ”¯é‡Œé¢ï¼Œæˆ‘ä»¬æŠŠæ”¶çª„ä¸º never çš„ foo èµ‹å€¼ç»™ä¸€ä¸ªæ˜¾ç¤ºå£°æ˜çš„ never å˜é‡ã€‚å¦‚æœä¸€åˆ‡é€»è¾‘æ­£ç¡®ï¼Œé‚£ä¹ˆè¿™é‡Œåº”è¯¥èƒ½å¤Ÿç¼–è¯‘é€šè¿‡ã€‚ä½†æ˜¯å‡å¦‚åæ¥æœ‰ä¸€å¤©ä½ çš„åŒäº‹ä¿®æ”¹äº† Foo çš„ç±»å‹ï¼š\ntype Foo = string | number | boolean; ç„¶è€Œä»–å¿˜è®°åŒæ—¶ä¿®æ”¹ controlFlowAnalysisWithNever æ–¹æ³•ä¸­çš„æ§åˆ¶æµç¨‹ï¼Œè¿™æ—¶å€™ else åˆ†æ”¯çš„ foo ç±»å‹ä¼šè¢«æ”¶çª„ä¸º boolean ç±»å‹ï¼Œå¯¼è‡´æ— æ³•èµ‹å€¼ç»™ never ç±»å‹çš„ check å˜é‡ï¼Œè¿™æ—¶å°±ä¼šäº§ç”Ÿä¸€ä¸ªç¼–è¯‘é”™è¯¯ã€‚é€šè¿‡è¿™ä¸ªæ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿ controlFlowAnalysisWithNever æ–¹æ³•æ€»æ˜¯ç©·å°½äº† Foo çš„æ‰€æœ‰å¯èƒ½ç±»å‹ã€‚\né€šè¿‡è¿™ä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€ä¸ªç»“è®ºï¼šä½¿ç”¨ never é¿å…å‡ºç°æ–°å¢äº†è”åˆç±»å‹æ²¡æœ‰å¯¹åº”çš„å®ç°ï¼Œç›®çš„å°±æ˜¯å†™å‡ºç±»å‹ç»å¯¹å®‰å…¨çš„ä»£ç ã€‚\nEnum^æšä¸¾^ æšä¸¾ç±»å‹ï¼Œå¯ä»¥å®šä¹‰ä¸€äº›å¸¦åå­—çš„å¸¸é‡ã€‚\n:memo: Note\næšä¸¾çš„ç±»å‹åªèƒ½æ˜¯ string æˆ– number\nå®šä¹‰çš„åç§°ä¸èƒ½ä¸º å…³é”®å­—\næ•°å­—æšä¸¾ æšç»„çš„ç±»å‹é»˜è®¤ä¸º æ•°å­—ç±»å‹ ï¼Œé»˜è®¤ä» 0 å¼€å§‹ä»¥æ­¤ç´¯åŠ ï¼Œå¦‚æœæœ‰è®¾ç½®é»˜è®¤å€¼ï¼Œåˆ™ä¼šå¯¹ åé¢ çš„å€¼äº§ç”Ÿå½±å“\nåŒæ—¶æ”¯æŒç±»ä¼¼æ•°ç»„ä¸‹æ ‡æ–¹å¼è®¿é—®çš„ åå‘æ˜ å°„ ã€‚\n// TypeScript enum numberType { A, B, C = 7, D } let num1 = numberType.A // æ­£å‘æ˜ å°„ let num2 = numberType[0] // åå‘æ˜ å°„ let num3 = numberType[2] let num4 = numberType[3] console.log( num1, num2, num3, num4 ); ç¼–è¯‘ä¸º JavaScript æ•ˆæœï¼š\n// ==\u0026gt; ES2020 var numberType; // ç¼–è¯‘åä¸ºvarï¼Œä½¿å¾—è¯¥æšä¸¾æˆä¸ºäº†ä¸€ä¸ªå…¨å±€å˜é‡ (function (numberType) { numberType[numberType[\u0026#34;A\u0026#34;] = 0] = \u0026#34;A\u0026#34;; numberType[numberType[\u0026#34;B\u0026#34;] = 1] = \u0026#34;B\u0026#34;; numberType[numberType[\u0026#34;C\u0026#34;] = 7] = \u0026#34;C\u0026#34;; numberType[numberType[\u0026#34;D\u0026#34;] = 8] = \u0026#34;D\u0026#34;; })(numberType || (numberType = {})); let num1 = numberType.A; // æ­£å‘æ˜ å°„ let num2 = numberType[0]; // åå‘æ˜ å°„ let num3 = numberType[2]; let num4 = numberType[3]; console.log(num1, num2, num3, num4); numberType: {0:\u0026#39;A\u0026#39;, 1:\u0026#39;B\u0026#39;, 7:\u0026#39;C\u0026#39;, 8:\u0026#39;D\u0026#39;, A:0, B:1, C:7, D:8} å­—ç¬¦ä¸²æšä¸¾ å­—ç¬¦ä¸²æšä¸¾è¦æ³¨æ„çš„æ˜¯å¿…é¡»è¦æœ‰ é»˜è®¤å€¼ ï¼Œä¸æ”¯æŒ åå‘æ˜ å°„ ã€‚\n// TypeScript enum stringType { A = \u0026#39;A\u0026#39;, B = \u0026#39;B\u0026#39;, C = \u0026#39;C\u0026#39;, D = \u0026#39;D\u0026#39;, // E /* TS1061: Enum member must have initializer. */ /* ä½¿ç”¨å­—ç¬¦ä¸²æšä¸¾çš„æ—¶å€™ï¼Œåé¢çš„æšä¸¾æˆå‘˜å¿…é¡»å…ˆåˆå§‹åŒ– */ } ç¼–è¯‘ä¸º JavaScript æ•ˆæœï¼š\n// ==\u0026gt; ES2020 var stringType; (function (stringType) { stringType[\u0026#34;A\u0026#34;] = \u0026#34;A\u0026#34;; stringType[\u0026#34;B\u0026#34;] = \u0026#34;B\u0026#34;; stringType[\u0026#34;C\u0026#34;] = \u0026#34;C\u0026#34;; stringType[\u0026#34;D\u0026#34;] = \u0026#34;D\u0026#34;; // E /* TS1061: Enum member must have initializer. */ /* ä½¿ç”¨å­—ç¬¦ä¸²æšä¸¾çš„æ—¶å€™ï¼Œå¿…é¡»åˆå§‹åŒ– */ })(stringType || (stringType = {})); å¼‚æ„æšä¸¾ åŒ…å«äº† æ•°å­—ç±»å‹:array å’Œ å­—ç¬¦ä¸²ç±»å‹:string çš„æ··åˆï¼ŒåŒæ ·å­—ç¬¦ä¸²æšä¸¾ç±»å‹ä¹Ÿä¸æ”¯æŒåå‘æ˜ å°„ã€‚\n// TypeScript enum mixedType { A, B, C = \u0026#34;C\u0026#34;, D = \u0026#34;D\u0026#34;, E = 7, F } ç¼–è¯‘ä¸º JavaScript æ•ˆæœï¼š\n// ==\u0026gt; ES2020 var mixedType; (function (mixedType) { mixedType[mixedType[\u0026#34;A\u0026#34;] = 0] = \u0026#34;A\u0026#34;; mixedType[mixedType[\u0026#34;B\u0026#34;] = 1] = \u0026#34;B\u0026#34;; mixedType[\u0026#34;C\u0026#34;] = \u0026#34;C\u0026#34;; mixedType[\u0026#34;D\u0026#34;] = \u0026#34;D\u0026#34;; mixedType[mixedType[\u0026#34;E\u0026#34;] = 7] = \u0026#34;E\u0026#34;; mixedType[mixedType[\u0026#34;F\u0026#34;] = 8] = \u0026#34;F\u0026#34;; })(mixedType || (mixedType = {})); å¸¸é‡æšä¸¾ é™¤äº† æ•°å­—ç±»å‹:array å’Œ å­—ç¬¦ä¸²ç±»å‹:string ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ç§ç‰¹æ®Šçš„ç±»å‹ï¼Œé‚£å°±æ˜¯ å¸¸é‡æšä¸¾ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡ const å»å®šä¹‰ enum ï¼Œä½†è¿™ç§ç±»å‹ä¸ä¼šç¼–è¯‘æˆä»»ä½• JS ï¼Œè€Œæ˜¯ç›´æ¥ç¼–è¯‘å¯¹åº”çš„å€¼ã€‚\n:memo: Note å¹¶ä¸”ï¼Œæ·»åŠ äº† const å…³é”®å­—åï¼Œåé¢å¿…é¡»ä½¿ç”¨ç›¸åº”å®ä¾‹ï¼Œå¦åˆ™ TypeScript å°†ä¸ä¼šè¿›è¡Œç¼–è¯‘ã€‚\nä¹Ÿå°±æ˜¯è¯´ï¼Œæ™®é€šæƒ…å†µä¸‹å°†ä¼šåˆ›å»ºä¸€ä¸ªé—­åŒ…ï¼Œå¹¶å°†ç”Ÿæˆçš„æ•°ç»„ä¼ å…¥ var å‰ç¼€çš„å…¨å±€å˜é‡ï¼›è€Œå˜ä¸ºå¸¸é‡æšä¸¾åï¼Œåˆ™æ˜¯ç›´æ¥å°†æšä¸¾å€¼ç¡¬ç¼–ç è¿›ç›¸åº”å‡½æ•°ä¸­ã€‚\n// TypeScript const enum constType { A, B, C = 7, D } let con1 = constType.A; let con2 = constType.C; ç¼–è¯‘ä¸º JavaScript æ•ˆæœï¼š\n// ==\u0026gt; ES2020 let con1 = 0 /* A */; let con2 = 7 /* C */; Literal^å­—é¢é‡ç±»å‹^ å¯ä»¥ç›´æ¥æŒ‡å®šå‚æ•°çš„å¯é€‰ å­—é¢é‡*^literal^* ï¼Œå¤šä¸ªå­—é¢é‡é€šè¿‡ | åˆ†éš” ï¼Œç›®å‰æ”¯æŒ å­—ç¬¦ä¸²stringã€æ•°å­—numberã€å¸ƒå°”boolean ç±»å‹ã€‚\nlet str:\u0026#39;foo\u0026#39;|\u0026#39;bar\u0026#39; // strå˜é‡çš„å€¼åªèƒ½æ˜¯fooæˆ–bar let num: 1 | 2 | 3 = 1 let flag:true str = \u0026#39;foo\u0026#39; //ok str = \u0026#39;bar\u0026#39; // ok str = \u0026#39;baz\u0026#39; // error // TS2322: Type \u0026#39;\u0026#34;baz\u0026#34;\u0026#39; is not assignable to type \u0026#39;\u0026#34;foo\u0026#34; | \u0026#34;bar\u0026#34;\u0026#39;. num = 2 //ok num = 7 // error // TS2322: Type \u0026#39;7\u0026#39; is not assignable to type \u0026#39;1 | 2 | 3\u0026#39; flag = true // ok flag = false // error // TS2322: Type \u0026#39;false\u0026#39; is not assignable to type \u0026#39;true\u0026#39;. Template^æ¨¡æ¿å­—é¢é‡^ æ¨¡æ¿å­—é¢é‡ç±»å‹ä»¥ å­—ç¬¦ä¸²å­—é¢é‡ç±»å‹*^literal^* ä¸ºåŸºç¡€ï¼Œå¯ä»¥é€šè¿‡ è”åˆç±»å‹*^union^* æ‰©å±•æˆå¤šä¸ªå­—ç¬¦ä¸²ã€‚\nå®ƒä»¬è·Ÿ JavaScript çš„æ¨¡æ¿å­—ç¬¦ä¸²æ˜¯ç›¸åŒçš„è¯­æ³•ï¼Œä½†æ˜¯åªèƒ½ç”¨åœ¨ç±»å‹æ“ä½œä¸­ã€‚å½“ä½¿ç”¨æ¨¡æ¿å­—é¢é‡ç±»å‹æ—¶ï¼Œå®ƒä¼šæ›¿æ¢æ¨¡æ¿ä¸­çš„å˜é‡ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²å­—é¢é‡ï¼š\ntype world = \u0026#34;world\u0026#34;; type World = \u0026#34;World\u0026#34;; type Greeting = `hello ${world | World}`; // type Greeting = \u0026#34;hello world\u0026#34; Intrinsic^å†…ç½®å­—ç¬¦æ“ä½œç±»å‹^ TypeScript çš„ä¸€äº›ç±»å‹å¯ä»¥ç”¨äºå­—ç¬¦æ“ä½œï¼Œè¿™äº›ç±»å‹å¤„äºæ€§èƒ½çš„è€ƒè™‘è¢«å†…ç½®åœ¨ç¼–è¯‘å™¨ä¸­ï¼Œä¸èƒ½åœ¨ .d.ts æ–‡ä»¶é‡Œæ‰¾åˆ°å®ƒä»¬ã€‚\næ¨¡ç‰ˆ: Operation\u0026lt;type\u0026gt;\nUppercase - æŠŠæ¯ä¸ªå­—ç¬¦è½¬ä¸ºå¤§å†™å½¢å¼ Lowercase - æŠŠæ¯ä¸ªå­—ç¬¦è½¬ä¸ºå°å†™å½¢å¼ Capitalize - æŠŠå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦è½¬ä¸ºå¤§å†™å½¢å¼ Uncapitalize - æŠŠå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦è½¬æ¢ä¸ºå°å†™å½¢å¼ Aliases^ç±»å‹åˆ«å^ type ç”¨æ¥ç»™ä¸€ä¸ªç±»å‹èµ·ä¸ªåˆ«åã€‚\ntype InfoProps = string | number; const setInfo = (data: InfoProps) =\u0026gt; {}; Assertion^æ–­è¨€^ As^ç±»å‹æ–­è¨€^ ç±»å‹æ–­è¨€Type Assertion å¯ä»¥ç”¨æ¥æ‰‹åŠ¨æŒ‡å®šä¸€ä¸ªå€¼çš„ç±»å‹ã€‚ç”¨é€”ï¼š\nå°†ä¸€ä¸ª è”åˆç±»å‹*^union^* æ–­è¨€ä¸ºå…¶ä¸­ä¸€ä¸ªç±»å‹è¯­æ³• å°†ä¸€ä¸ª çˆ¶ç±»*^parent^* æ–­è¨€ä¸ºæ›´åŠ å…·ä½“çš„ å­ç±»*^child^* å°†ä»»ä½•ä¸€ä¸ªç±»å‹æ–­è¨€ä¸º any / å°† any æ–­è¨€ä¸ºå…·ä½“ç±»å‹ å€¼ as ç±»å‹ \u0026lt;ç±»å‹\u0026gt;å€¼ :page_with_curl: Example\n//å°–æ‹¬å· let num: any = \u0026#39;foo\u0026#39; let res1: number = (\u0026lt;string\u0026gt;num).length; // Reactä¸­ä¼š error // as è¯­æ³• let str: any = \u0026#39;bar\u0026#39;; let res: number = (str as string).length; :warning: Caution å°–æ‹¬å·è¯­æ³•åœ¨ React ä¸­ä¼šæŠ¥é”™ï¼ŒåŸå› æ˜¯ä¸ JSX è¯­æ³•ä¼šäº§ç”Ÿå†²çªï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨ as ã€‚\nAs^..as..^^åŒé‡æ–­è¨€^ ä½¿ç”¨ç±»ä¼¼ as any as Foo çš„è¯­æ³•ï¼Œå¯¹å˜é‡è¿›è¡Œä¸¤æ¬¡æ–­è¨€ï¼Œæ¥è¾¾åˆ°å°†ä»»ä½•ä¸€ä¸ªç±»å‹æ–­è¨€ä¸ºä»»ä½•å¦ä¸€ä¸ªç±»å‹çš„æ•ˆæœã€‚\n:warning: Caution è¿™ç§åšæ³•ç›¸å½“äºæŠ›å¼ƒäº† TypeScript ï¼Œéå¸¸å®¹æ˜“å¯¼è‡´è¿è¡Œæ—¶é”™è¯¯ï¼Œä¸æ¨èä½¿ç”¨ã€‚\ninterface Cat { run(): never; swim(): string } interface Fish { swim(): string; } function cat2Fish(cat: { run(): void; swim(): void }) { return (cat as any as Fish); } class Fish implements Fish {} let cat = new class Cat implements Cat { run() {} swim() { return \u0026#39;cat.swim\u0026#39; } } console.log(cat2Fish(cat).swim()); // implemented as Fish // cat.swim !^for-key^^ç¡®å®šèµ‹å€¼æ–­è¨€^ ç¡®å®šèµ‹å€¼æ–­è¨€ï¼Œå³å…è®¸åœ¨ å®ä¾‹å±æ€§*^properties^* å’Œ å˜é‡å£°æ˜*^statement^* åé¢æ”¾ç½®ä¸€ä¸ª ! å·ï¼Œä»¥å‘Šè¯‰ TS è¯¥å±æ€§ä¼šè¢«æ˜ç¡®èµ‹å€¼ã€‚\nlet foo: string; let bar!: string; const setFoo = () =\u0026gt; foo = \u0026#39;foo\u0026#39; const setBar = () =\u0026gt; bar = \u0026#39;bar\u0026#39; setFoo(); setBar(); console.log(foo); // error // Variable \u0026#39;foo\u0026#39; is used before being assigned. console.log(bar); // ok !^for-value^^éç©ºæ–­è¨€^ åœ¨ä¸Šä¸‹æ–‡ä¸­å½“ç±»å‹æ£€æŸ¥å™¨æ— æ³•æ–­å®šç±»å‹æ—¶ï¼Œä¸€ä¸ªæ–°çš„åç¼€è¡¨è¾¾å¼æ“ä½œç¬¦ ! å¯ä»¥ç”¨äºæ–­è¨€æ“ä½œå¯¹è±¡æ˜¯é null å’Œé undefined ç±»å‹ã€‚\nconst info = (str: string | null | undefined) =\u0026gt; { const name: string = str; // Type \u0026#39;undefined\u0026#39; is not assignable to type \u0026#39;string\u0026#39;.(2322) const name2: string = str!; // æ·»åŠ !ç¬¦å·è¿›è¡Œéç©ºæ–­è¨€ }; info(\u0026#39;foo\u0026#39;); Guards^ç±»å‹å®ˆå«^ Type guards æ˜¯å¯æ‰§è¡Œè¿è¡Œæ—¶æ£€æŸ¥çš„ä¸€ç§è¡¨è¾¾å¼ï¼Œç”¨äºç¡®ä¿è¯¥ç±»å‹åœ¨ä¸€å®šçš„èŒƒå›´å†…ã€‚ä½¿ç”¨å®ˆå«è¿›è¡Œ Type narrowing åï¼Œå°±å¯ä»¥ä½¿ç”¨ç›¸åº”çš„ç±»å‹æ–¹æ³•å’Œå±æ€§äº† ã€‚\nç±»å‹ä¿æŠ¤å¯ä»¥ä¿è¯ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå°½ç®¡å®ƒçš„å€¼ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ•°å€¼ã€‚ç±»å‹ä¿æŠ¤ä¸ç‰¹æ€§æ£€æµ‹å¹¶ä¸æ˜¯å®Œå…¨ä¸åŒï¼Œå…¶ä¸»è¦æ€æƒ³æ˜¯å°è¯•æ£€æµ‹å±æ€§ã€æ–¹æ³•æˆ–åŸå‹ï¼Œä»¥ç¡®å®šå¦‚ä½•å¤„ç†å€¼ã€‚\nIn^æˆå‘˜æ£€æµ‹^ ç”¨äºåˆ¤æ–­æŸä¸ª å±æ€§*^property^* æ˜¯å¦å­˜åœ¨äº å¯¹è±¡*^object^* å½“ä¸­ã€‚\ninterface Employee { name: string salary: number } interface Manager extends Employee { isManager: true } const printInfo = (data: Employee | Manager) =\u0026gt; { console.log(`è¯¥${\u0026#34;isManager\u0026#34; in data ? `ç»ç†` : `é›‡å‘˜`}åå­—æ˜¯ï¼š${data.name}ï¼Œè–ªæ°´æ˜¯ï¼š${data.salary}`) } printInfo({name: \u0026#39;David\u0026#39;, salary: 2000}); printInfo({name: \u0026#39;White\u0026#39;, salary: 7000, isManager: true}); // è¯¥é›‡å‘˜åå­—æ˜¯ï¼šDavidï¼Œè–ªæ°´æ˜¯ï¼š2000 // è¯¥ç»ç†åå­—æ˜¯ï¼šWhiteï¼Œè–ªæ°´æ˜¯ï¼š7000 Typeof^ç±»å‹æ£€æµ‹^ ç”¨äº å˜é‡*^variable^* æ˜¯å¦å±äºæŸä¸ª åŸºæœ¬ç±»å‹basic-type instance ï¼Œè§ EcmaScript [typeof](04 JavaScript.md/#variable-typeof-es5) ã€‚\nInstanceof^å®ä¾‹æ£€æµ‹^ ç”¨äºåˆ¤æ–­ä¸€ä¸ª å¯¹è±¡*^object^* æ˜¯ä¸æ˜¯æŸä¸ª ç±»*^class^* çš„ å®ä¾‹*^instance^* ï¼Œè§ EcmaScript [instanceof](05 EcmaScript.md/#class-instanceof-usage-es6) ã€‚\nIs is å…³é”®å­—ç”¨äºå®šä¹‰ç±»å‹ä¿æŠ¤ï¼Œç”¨äºè‡ªå®šä¹‰å‡½æ•°è¿”å›ç±»å‹ã€‚\nå½“ç±»å‹ç¬¦åˆçš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ç±»å‹ç›¸åº”çš„æ–¹æ³•ã€‚\nclass Fish { swim() { console.log(\u0026#39;swimming\u0026#39;); } } class Bird { fly() { } } function getSmallPet() { return new Fish(); } function isFish(pet: Fish | Bird): pet is Fish { // å‘Šè¯‰ç¼–è¯‘å™¨å°†ä¼šè¿”å›Fishç±»å‹ return (pet as Fish).swim !== undefined; } // Both calls to \u0026#39;swim\u0026#39; and \u0026#39;fly\u0026#39; are now okay. let pet = getSmallPet(); pet.swim(); if (isFish(pet)) { pet.swim(); } é€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç° assertion^æ–­è¨€^ ä¸ ç±»å‹å®ˆå« çš„æ¦‚å¿µéå¸¸ç›¸ä¼¼ï¼Œéƒ½æ˜¯ç¡®å®šå‚æ•°çš„ç±»å‹ï¼Œä½† assertion^æ–­è¨€^ å®ƒæ˜¯ç›´æ¥å‘Šè¯‰ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªå‚æ•°å°±æ˜¯è¿™ä¸ªç±»å‹ï¼Œè€Œç±»å‹å®ˆå«æ›´åƒåˆ¤æ–­è¿™ä¸ªå‚æ•°å…·ä½“æ˜¯ä»€ä¹ˆç±»å‹ã€‚\nCombine^ç±»å‹ç»„åˆ^ Union^è”åˆç±»å‹^^|^ ä½¿ç”¨ | ç¬¦å·è¿æ¥ï¼Œå°†å¤šä¸ªç±»å‹åˆå¹¶ä¸ºä¸€ä¸ªç±»å‹*^type/interface^* å¹¶é›†$\\cup$ï¼Œä½¿å¾—è¿™ä¸ªç±»å‹å¯ä»¥æ˜¯å¤šç§ç±»å‹ ä¹‹ä¸€ ã€‚åœ¨ä½¿ç”¨ ç±»å‹å®ˆå«*^guards^* è¿›è¡Œ Narrowing ä¹‹å‰ï¼Œåªèƒ½ä½¿ç”¨ç±»å‹ä¸­å…±æœ‰çš„æ–¹æ³•ã€‚\nè”åˆç±»å‹é€šå¸¸ä¸ null æˆ– undefined ä¸€èµ·ä½¿ç”¨ï¼š\nconst sayHello = (name: string | undefined) =\u0026gt; { /* ... */ }; ä¾‹å¦‚ï¼Œè¿™é‡Œ name çš„ç±»å‹æ˜¯ string|undefined æ„å‘³ç€å¯ä»¥å°† string æˆ– undefined çš„å€¼ä¼ é€’ç»™ sayHello å‡½æ•°ã€‚\nsayHello(\u0026#34;semlinker\u0026#34;); sayHello(undefined); sayHello(123); // error é€šè¿‡è¿™ä¸ªç¤ºä¾‹ï¼Œä½ å¯ä»¥å‡­ç›´è§‰çŸ¥é“ç±»å‹ A å’Œç±»å‹ B è”åˆåçš„ç±»å‹æ˜¯åŒæ—¶æ¥å— A å’Œ B å€¼çš„ç±»å‹ã€‚æ­¤å¤–ï¼Œå¯¹äºè”åˆç±»å‹æ¥è¯´ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°ä»¥ä¸‹çš„ç”¨æ³•ï¼š\nlet num: 1 | 2 = 1; type EventNames = \u0026#39;click\u0026#39; | \u0026#39;scroll\u0026#39; | \u0026#39;mousemove\u0026#39;; let event:EventNames = \u0026#39;foo\u0026#39;; // error ä»¥ä¸Šç¤ºä¾‹ä¸­çš„ 1ã€2 æˆ– 'click' è¢«ç§°ä¸ºå­—é¢é‡ç±»å‹ï¼Œç”¨æ¥çº¦æŸå–å€¼åªèƒ½æ˜¯æŸå‡ ä¸ªå€¼ä¸­çš„ä¸€ä¸ªã€‚\nDiscriminated Unions^å¯è¾¨è¯†è”åˆ^ å¯è¾¨è¯†è”åˆç±»å‹æ˜¯ TypeScript ä¸€ä¸ªæ¨¡ä»¿ Haskell çš„æ¦‚å¿µï¼Œä¹Ÿç§°ä¸ºä»£æ•°æ•°æ®ç±»å‹æˆ–æ ‡ç­¾è”åˆç±»å‹ã€‚\nè¿™ç§ç±»å‹çš„æœ¬è´¨æ˜¯ç»“åˆ è”åˆç±»å‹*^union^* å’Œ å­—é¢é‡ç±»å‹ çš„ä¸€ç§ç±»å‹ä¿æŠ¤æ–¹æ³•ã€‚å¦‚æœä¸€ä¸ªç±»å‹æ˜¯å¤šä¸ªç±»å‹çš„è”åˆç±»å‹ï¼Œä¸”å¤šä¸ªç±»å‹å«æœ‰ä¸€ä¸ª å…¬å…±å±æ€§ ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªå…¬å…±å±æ€§ï¼Œæ¥åˆ›å»ºç›¸ä¼¼çš„ç±»å‹ æ¥å£*^interface^* ç»„ã€‚\nDiscriminantable^å¯è¾¨è¯†^ å¯è¾¨è¯†è¦æ±‚è”åˆç±»å‹ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½è‡³å°‘å«æœ‰ä¸€ä¸ª ç›¸åŒ å•ä¾‹ç±»å‹å±æ€§ï¼Œæ¯”å¦‚ï¼š\nconst enum CarTransmission { Automatic = 200, Manual = 300 } interface Motorcycle { vType: \u0026#34;motorcycle\u0026#34;; // discriminant make: number; // year } interface Car { vType: \u0026#34;car\u0026#34;; // discriminant transmission: CarTransmission } interface Truck { vType: \u0026#34;truck\u0026#34;; // discriminant capacity: number; // in tons } åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«å®šä¹‰äº† Motorcycleã€ Car å’Œ Truck ä¸‰ä¸ªæ¥å£ï¼Œåœ¨è¿™äº›æ¥å£ä¸­éƒ½åŒ…å«ä¸€ä¸ª vType å±æ€§ï¼Œè¯¥å±æ€§è¢«ç§°ä¸ºå¯è¾¨è¯†çš„å±æ€§ï¼Œè€Œå…¶å®ƒçš„å±æ€§åªè·Ÿç‰¹æ€§çš„æ¥å£ç›¸å…³ã€‚\n:page_with_curl: Example Narrowing\nç»è¿‡ Type Guards çš„ Narrowing åï¼Œå°±å¯ä»¥ä½¿ç”¨ç›¸åº”çš„æ–¹æ³•äº†ã€‚\ntype Shape = | { kind: \u0026#34;circle\u0026#34;; radius: number } | { kind: \u0026#34;square\u0026#34;; x: number } | { kind: \u0026#34;triangle\u0026#34;; x: number; y: number }; function area(s: Shape) { switch (s.kind) { case \u0026#34;circle\u0026#34;: // Type Narrowing return Math.PI * s.radius * s.radius; case \u0026#34;square\u0026#34;: return s.x * s.x; case \u0026#34;triangle\u0026#34;: return (s.x * s.y) / 2; } // å½“ç±»å‹æ— æ³•æ”¶çª„è‡³ä¸Šè¿°ç±»å‹ï¼Œå°±ä¼šæŠ¥é”™ const check: never = s; } ç¼–è¯‘æˆ JavaScript ï¼š\n\u0026#34;use strict\u0026#34;; function area(s) { switch (s.kind) { case \u0026#34;circle\u0026#34;: return Math.PI * s.radius * s.radius; case \u0026#34;square\u0026#34;: return s.x * s.x; case \u0026#34;triangle\u0026#34;: return (s.x * s.y) / 2; } const check = s; } Combine^è”åˆç±»å‹^ åŸºäºå‰é¢å®šä¹‰äº†ä¸‰ä¸ªæ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª Vehicle è”åˆç±»å‹ï¼š\ntype Vehicle = Motorcycle | Car | Truck; ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ä½¿ç”¨ Vehicle è”åˆç±»å‹ï¼Œå¯¹äº Vehicle ç±»å‹çš„å˜é‡ï¼Œå®ƒå¯ä»¥è¡¨ç¤ºä¸åŒç±»å‹çš„è½¦è¾†ã€‚\nGuard^ç±»å‹å®ˆå«^ ä¸‹é¢æˆ‘ä»¬æ¥å®šä¹‰ä¸€ä¸ª evaluatePrice æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç”¨äºæ ¹æ®è½¦è¾†çš„ç±»å‹ã€å®¹é‡å’Œè¯„ä¼°å› å­æ¥è®¡ç®—ä»·æ ¼ï¼Œå…·ä½“å®ç°å¦‚ä¸‹ï¼š\nconst EVALUATION_FACTOR = Math.PI; function evaluatePrice(vehicle: Vehicle) { return vehicle.capacity * EVALUATION_FACTOR; // err // Property \u0026#39;capacity\u0026#39; does not exist on type \u0026#39;Vehicle\u0026#39;. // Property \u0026#39;capacity\u0026#39; does not exist on type \u0026#39;Motorcycle\u0026#39;.(2339) } const myTruck: Truck = { vType: \u0026#34;truck\u0026#34;, capacity: 9.5 }; evaluatePrice(myTruck); è¯¥ä»£ç å°†ä¼šæŠ¥é”™ï¼ŒåŸå› æ˜¯åœ¨ Motorcycle æ¥å£ä¸­ï¼Œå¹¶ä¸å­˜åœ¨ capacity å±æ€§ï¼Œè€Œå¯¹äº Car æ¥å£æ¥è¯´ï¼Œå®ƒä¹Ÿä¸å­˜åœ¨ capacity å±æ€§ã€‚é‚£ä¹ˆï¼Œç°åœ¨æˆ‘ä»¬åº”è¯¥å¦‚ä½•è§£å†³ä»¥ä¸Šé—®é¢˜å‘¢ï¼Ÿè¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ç±»å‹å®ˆå«*type guard* ã€‚ä¸‹é¢æˆ‘ä»¬æ¥é‡æ„ä¸€ä¸‹å‰é¢å®šä¹‰çš„ evaluatePrice æ–¹æ³•ï¼Œé‡æ„åçš„ä»£ç å¦‚ä¸‹ï¼š\nfunction evaluatePrice(vehicle: Vehicle) { switch (vehicle.vType) { case \u0026#34;car\u0026#34;: return vehicle.transmission * EVALUATION_FACTOR; case \u0026#34;truck\u0026#34;: return vehicle.capacity * EVALUATION_FACTOR; case \u0026#34;motorcycle\u0026#34;: return vehicle.make * EVALUATION_FACTOR; } } åœ¨ä»¥ä¸Šä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ switch å’Œ case è¿ç®—ç¬¦æ¥å®ç°ç±»å‹å®ˆå«ï¼Œä»è€Œç¡®ä¿åœ¨ evaluatePrice æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å®‰å…¨åœ°è®¿é—® vehicle å¯¹è±¡ä¸­çš„æ‰€åŒ…å«çš„å±æ€§ï¼Œæ¥æ­£ç¡®çš„è®¡ç®—è¯¥è½¦è¾†ç±»å‹æ‰€å¯¹åº”çš„ä»·æ ¼ã€‚\nAlias^ç±»å‹åˆ«å^ ç±»å‹åˆ«åç”¨æ¥ç»™ä¸€ä¸ªç±»å‹èµ·ä¸ªæ–°åå­—ã€‚\ntype Message = string | string[]; let greet = (message: Message) =\u0026gt; { // ... }; Intersect^äº¤å‰ç±»å‹^^\u0026amp;^ ä½¿ç”¨ \u0026amp; ç¬¦å·è¿æ¥ï¼Œå°† å¤šä¸ªç±»å‹ åˆå¹¶ä¸º ä¸€ä¸ª æ‹¥æœ‰å®ƒä»¬ å±æ€§*^property^* å¹¶é›†$\\cup$ çš„ç±»å‹ã€‚\ntype AProps = { foo: string } type BProps = { bar: number } type allProps = AProps \u0026amp; BProps const Info: allProps = { foo: \u0026#39;1\u0026#39;, bar: 2 } Basic^åŒååŸºç¡€å±æ€§åˆå¹¶^ æˆ‘ä»¬å¯ä»¥çœ‹åˆ° äº¤å‰ç±»å‹ æ˜¯ç»“åˆä¸¤ä¸ªå±æ€§çš„å±æ€§å€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç°åœ¨æœ‰ä¸ªé—®é¢˜ï¼Œè¦æ˜¯ä¸¤ä¸ªå±æ€§éƒ½æœ‰ç›¸åŒçš„å±æ€§å€¼ï¼Œé‚£ä¹ˆæ­¤æ—¶æ€»çš„ç±»å‹ä¼šæ€ä¹ˆæ ·ï¼Œå…ˆçœ‹çœ‹ä¸‹é¢çš„æ¡ˆåˆ—ï¼š\ntype AProps = { a: string, c: number } type BProps = { b: number, c: string } type allProps = AProps \u0026amp; BProps const Info: allProps = { a: \u0026#39;1\u0026#39;, b: 2, c: 3, // TS2322: Type \u0026#39;number\u0026#39; is not assignable to type \u0026#39;never\u0026#39;. c: \u0026#39;4\u0026#39;, // TS2300: Duplicate identifier \u0026#39;c\u0026#39;. // TS2322: Type \u0026#39;string\u0026#39; is not assignable to type \u0026#39;never\u0026#39;. // ts.ts(1, 28): The expected type comes from property \u0026#39;c\u0026#39; which is declared here on type \u0026#39;allProps\u0026#39; } å¦‚æœæ˜¯ç›¸åŒçš„ç±»å‹ï¼Œåˆå¹¶åçš„ç±»å‹ä¹Ÿæ˜¯æ­¤ç±»å‹ï¼Œé‚£å¦‚æœæ˜¯ä¸åŒçš„ç±»å‹ä¼šå¦‚ä½•ï¼š\næˆ‘ä»¬åœ¨ Aprops å’Œ BProps ä¸­åŒæ—¶åŠ å…¥ c å±æ€§ï¼Œå¹¶ä¸” c å±æ€§çš„ç±»å‹ä¸åŒï¼Œä¸€ä¸ªæ˜¯ number ç±»å‹ï¼Œå¦ä¸€ä¸ªæ˜¯ string ç±»å‹ã€‚\nç°åœ¨ç»“åˆä¸º allProps åå‘¢? æ˜¯ä¸æ˜¯ c å±æ€§æ˜¯ number æˆ– string ç±»å‹éƒ½å¯ä»¥ï¼Œè¿˜æ˜¯å…¶ä¸­çš„ä¸€ç§ï¼Ÿ\nç„¶è€Œåœ¨å®é™…ä¸­ï¼Œ c ä¼ å…¥ æ•°å­—ç±»å‹number å’Œ å­—ç¬¦ä¸²ç±»å‹string éƒ½ä¸è¡Œï¼Œå› æ­¤çœ‹åˆ°æŠ¥é”™ï¼Œç°å®çš„æ˜¯ c çš„ç±»å‹æ˜¯ never ã€‚\nè¿™æ˜¯å› ä¸ºå¯¹åº” c å±æ€§è€Œè¨€æ˜¯ number \u0026amp; string ï¼Œç„¶è€Œè¿™ç§å±æ€§æ˜æ˜¾æ˜¯ä¸å­˜åœ¨çš„ï¼Œæ‰€ä»¥ c çš„å±æ€§æ˜¯ never ï¼Œå³ä¸èƒ½ä¸ºä»»ä½•å€¼ã€‚\nReference^åŒåéåŸºç¡€å±æ€§åˆå¹¶^ interface A { a: number } interface B { b: string } interface C { x: A } interface D { x: B } type allProps = C \u0026amp; D const Info: allProps = { x: { a: 0, b: \u0026#39;1\u0026#39; } } console.log(Info); // { x: { a: 0, b: \u0026#39;1\u0026#39; } } æˆ‘ä»¬æ¥çœ‹çœ‹æ¡ˆä¾‹ï¼Œå¯¹äºæ··å…¥å¤šä¸ªç±»å‹æ—¶ï¼Œè‹¥å­˜åœ¨ç›¸åŒçš„æˆå‘˜ï¼Œä¸”æˆå‘˜ç±»å‹ä¸ºéåŸºæœ¬æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆæ˜¯å¯ä»¥æˆåŠŸåˆåˆå¹¶ã€‚\nå¦‚æœ æ¥å£ A ä¸­çš„ä¹Ÿæ˜¯ b ï¼Œç±»å‹ä¸º number ï¼Œå°±ä¼šè·Ÿ åŒååŸºç¡€å±æ€§åˆå¹¶ ä¸€æ ·ï¼Œå˜ä¸º never ç±»å‹ã€‚\nInterfaces^æ¥å£^ åœ¨ TypeScript ä¸­ï¼Œä½¿ç”¨ æ¥å£*^Interfaces^* æ¥å®šä¹‰å¯¹è±¡çš„ç±»å‹ã€‚\nåœ¨é¢å‘å¯¹è±¡è¯­è¨€ä¸­ï¼Œæ¥å£*^Interfaces^* æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„æ¦‚å¿µï¼Œå®ƒæ˜¯å¯¹è¡Œä¸ºçš„æŠ½è±¡ï¼Œè€Œå…·ä½“å¦‚ä½•è¡ŒåŠ¨éœ€è¦ç”± ç±»*^classes^å» å®ç°^implement^* ã€‚\nTypeScript ä¸­çš„æ¥å£æ˜¯ä¸€ä¸ªéå¸¸çµæ´»çš„æ¦‚å¿µï¼Œé™¤äº†å¯ç”¨äºå¯¹ç±»çš„ä¸€éƒ¨åˆ†è¡Œä¸ºè¿›è¡Œ æŠ½è±¡*^abstract^* ä»¥å¤–ï¼Œä¹Ÿå¸¸ç”¨äºå¯¹å¯¹è±¡çš„ å½¢çŠ¶*^Shape^* è¿›è¡Œæè¿°ã€‚\nShape^å¯¹è±¡çš„å½¢çŠ¶^ interface Shape { height: bigint, width: bigint } let rectangle: Shape = { height: 10n, width: 10n }; ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæ¥å£ Shape ï¼Œæ¥ç€å®šä¹‰äº†ä¸€ä¸ªå˜é‡ rectangleï¼Œå®ƒçš„ç±»å‹æ˜¯ Shapeã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±çº¦æŸäº† rectangle çš„å½¢çŠ¶å¿…é¡»å’Œæ¥å£ Shape ä¸€è‡´ã€‚\næ¥å£ä¸€èˆ¬é¦–å­—æ¯å¤§å†™ï¼Œå†…éƒ¨å˜é‡çš„å½¢çŠ¶å¿…é¡»å’Œæ¥å£çš„å½¢çŠ¶ä¿æŒä¸€è‡´ã€‚\n?^å¯é€‰å±æ€§^ æœ‰æ—¶æˆ‘ä»¬å¸Œæœ›ä¸è¦å®Œå…¨åŒ¹é…ä¸€ä¸ªå½¢çŠ¶ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨å¯é€‰å±æ€§ï¼Œè¯¥å±æ€§å¯ä»¥ä¸å­˜åœ¨ï¼Œä¸”ä½ç½®ä»»æ„ã€‚\ninterface Shape { height: bigint, note?: string, width: bigint } let rectangle: Shape = { height: 10n, width: 10n }; Any^ä»»æ„å±æ€§^ æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›ä¸€ä¸ªæ¥å£æˆå‘˜å…è®¸æœ‰ä»»æ„çš„å±æ€§ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼ï¼š\ninterface Person { name: string; note: any; } ä½¿ç”¨ [propName: string] å®šä¹‰äº†ä»»æ„å±æ€§å– string ç±»å‹çš„å€¼ã€‚\nReadonly^åªè¯»å±æ€§^ æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›å¯¹è±¡ä¸­çš„ä¸€äº› å­—æ®µ åªèƒ½åœ¨ åˆ›å»ºçš„æ—¶å€™è¢«èµ‹å€¼ ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ readonly å®šä¹‰åªè¯»å±æ€§ã€‚\nå®šä¹‰åï¼Œåªå…è®¸ä¸€æ¬¡åˆå§‹åŒ–ï¼Œä¹‹åä¾¿ä¸å…è®¸ä¿®æ”¹ã€‚\nğŸ§ª Experimental const å¯èƒ½åªèƒ½å½±å“å˜é‡ï¼Œè€Œä¸èƒ½å½±å“æˆå‘˜ã€‚\ninterface Person { readonly id: number; name: string; age?: number; [propName: string]: any; } let tom: Person = { id: 89757, name: \u0026#39;Tom\u0026#39;, gender: \u0026#39;male\u0026#39; }; tom.id = 9527; // index.ts(14,5): error TS2540: Cannot assign to \u0026#39;id\u0026#39; because it is a constant or a read-only property. ä¸Šä¾‹ä¸­ï¼Œä½¿ç”¨ readonly å®šä¹‰çš„å±æ€§ id åˆå§‹åŒ–åï¼Œåˆè¢«èµ‹å€¼äº†ï¼Œæ‰€ä»¥æŠ¥é”™äº†ã€‚\n:exclamation:Warning åªè¯»*^readonly^* çš„çº¦æŸå­˜åœ¨äºç¬¬ä¸€æ¬¡ç»™ å¯¹è±¡*^object^* èµ‹å€¼çš„æ—¶å€™ï¼Œè€Œä¸æ˜¯ç¬¬ä¸€æ¬¡ç»™åªè¯»å±æ€§èµ‹å€¼çš„æ—¶å€™ã€‚\n:memo: Note 1 å¯ä»¥ç†è§£ä¸ºï¼Œåˆå§‹åŒ–å¯¹è±¡çš„æ—¶å€™ï¼Œå°±å¿…é¡»æä¾›ä¸€ä¸ªåˆå§‹å€¼ã€‚\ninterface Person { readonly id: number; name: string; age?: number; [propName: string]: any; } let tom: Person = { name: \u0026#39;Tom\u0026#39;, gender: \u0026#39;male\u0026#39; }; tom.id = 89757; // Attempt to assign to const or readonly variable // TS2540: Cannot assign to \u0026#39;id\u0026#39; because it is a read-only property ä¸Šä¾‹ä¸­ï¼ŒæŠ¥é”™ä¿¡æ¯æœ‰ä¸¤å¤„ï¼Œç¬¬ä¸€å¤„æ˜¯åœ¨å¯¹ tom è¿›è¡Œèµ‹å€¼çš„æ—¶å€™ï¼Œæ²¡æœ‰ç»™ id èµ‹å€¼ã€‚\nç¬¬äºŒå¤„æ˜¯åœ¨ç»™ tom.id èµ‹å€¼çš„æ—¶å€™ï¼Œç”±äºå®ƒæ˜¯åªè¯»å±æ€§ï¼Œæ‰€ä»¥æŠ¥é”™äº†ã€‚\n:memo: Note 2 æ­¤å¤– TypeScript è¿˜æä¾›äº† ReadonlyArray\u0026lt;T\u0026gt; æ•°ç»„èŒƒå‹*^genertic^* ï¼Œå®ƒä¸ Array\u0026lt;T\u0026gt; ç›¸ä¼¼ï¼Œåªæ˜¯æŠŠæ‰€æœ‰å¯å˜æ–¹æ³•å»æ‰äº†ï¼Œå› æ­¤å¯ä»¥ç¡®ä¿æ•°ç»„åˆ›å»ºåå†ä¹Ÿä¸èƒ½è¢«ä¿®æ”¹ã€‚\nSignatures^ç´¢å¼•ç­¾å^ æœ‰æ—¶å¹¶ä¸æå‰çŸ¥é“ç±»å‹å±æ€§çš„æ‰€æœ‰åç§°ï¼Œä½†çŸ¥é“å€¼çš„ å½¢çŠ¶*^shape^* ã€‚æ­¤æ—¶å¯ä»¥ä½¿ç”¨ ç´¢å¼•ç­¾åindex signatures ï¼ˆç±»ä¼¼æ–¹æ‹¬å·è¯­æ³•ï¼‰æ¥æè¿°å¯èƒ½å€¼çš„ç±»å‹ã€‚å€¼*^key^* çš„å¯é€‰ç±»å‹æœ‰ string, number, symbol ã€‚\ninterface NumberOrStringDictionary { [index: string]: number | string; length: number; // ok, length is a number name: string; // ok, name is a string } å½“ å€¼*^value^* ç±»å‹ä¸ç¬¦æ—¶ï¼Œå°±ä¼šæŠ¥é”™ï¼š\ninterface NumberDictionary { [index: string]: number; length: number; // ok name: string; // error } Mapped^æ˜ å°„ç±»å‹^ æ˜ å°„ç±»å‹å»ºç«‹åœ¨ ç´¢å¼•ç­¾åindex signatures çš„è¯­æ³•ä¹‹ä¸Šï¼Œç”¨äºå£°æ˜æœªæå‰å£°æ˜çš„å±æ€§ç±»å‹ï¼š\ntype OnlyBoolsAndHorses = { [key: string]: boolean | Horse; }; const conforms: OnlyBoolsAndHorses = { del: true, rodney: false, }; å½“ é”®å*^key^* ç±»å‹ä¸ç¬¦æ—¶ï¼Œå°±ä¼šæŠ¥é”™ï¼š\ninterface NumberDictionary { [index: string]: number; length: number; // ok name: string; // error } ^â­ï¸^Distinguish^è¾¨åˆ«^ :star: Important Alias^\u0010ç±»å‹åˆ«å^ å’Œ interface^æ¥å£^ çš„åŒºåˆ«\nObjects Functions æ¥å£å’Œç±»å‹åˆ«åéƒ½å¯ä»¥ç”¨æ¥æè¿°å¯¹è±¡çš„å½¢çŠ¶æˆ–å‡½æ•°ç­¾åï¼š\nInterface^æ¥å£^ interface Point { x: number; y: number; } interface SetPoint { (x: number, y: number): void; } Alias^ç±»å‹åˆ«å^ type Point = { x: number; y: number; }; type SetPoint = (x: number, y: number) =\u0026gt; void; Other Types ä¸æ¥å£ç±»å‹ä¸ä¸€æ ·ï¼Œç±»å‹åˆ«åå¯ä»¥ç”¨äºä¸€äº›å…¶ä»–ç±»å‹ï¼Œæ¯”å¦‚åŸå§‹ç±»å‹ã€è”åˆç±»å‹å’Œå…ƒç»„ï¼š\n// primitive type Name = string; // object type PartialPointX = { x: number; }; type PartialPointY = { y: number; }; // union type PartialPoint = PartialPointX | PartialPointY; // tuple type Data = [number, string]; Extend æ¥å£å’Œç±»å‹åˆ«åéƒ½èƒ½å¤Ÿè¢«æ‰©å±•ï¼Œä½†è¯­æ³•æœ‰æ‰€ä¸åŒã€‚æ­¤å¤–ï¼Œæ¥å£å’Œç±»å‹åˆ«åä¸æ˜¯äº’æ–¥çš„ã€‚æ¥å£*^interface^* å¯ä»¥æ‰©å±• ç±»å‹åˆ«å*^alias^* ï¼Œè€Œåè¿‡æ¥æ˜¯ä¸è¡Œçš„ã€‚\nInterface extends interface\ninterface PartialPointX { x: number; } interface Point extends PartialPointX { y: number; } Type alias extends type alias\ntype PartialPointX = { x: number; }; type Point = PartialPointX \u0026amp; { y: number; }; Interface extends type alias\ntype PartialPointX = { x: number; }; interface Point extends PartialPointX { y: number; } Type alias extends interface\ninterface PartialPointX { x: number; } type Point = PartialPointX \u0026amp; { y: number; }; Implements ç±»å¯ä»¥ä»¥ç›¸åŒçš„æ–¹å¼å®ç° æ¥å£*^interface^* æˆ– ç±»å‹åˆ«å*^type^* ï¼Œä½†ç±»ä¸èƒ½å®ç°ç”± ç±»å‹åˆ«å*^type^* å®šä¹‰çš„ è”åˆç±»å‹*^union^* ï¼š\ninterface Point { x: number; y: number; } class SomePoint implements Point { x = 1; y = 2; } type Point2 = { x: number; y: number; }; class SomePoint2 implements Point2 { x = 1; y = 2; } type PartialPoint = { x: number; } | { y: number; }; // A class can only implement an object type or // intersection of object types with statically known members. class SomePartialPoint implements PartialPoint { // Error x = 1; y = 2; } Declaration merging ä¸ç±»å‹åˆ«åä¸åŒï¼Œæ¥å£å¯ä»¥å®šä¹‰å¤šæ¬¡ï¼Œä¼šè¢«è‡ªåŠ¨åˆå¹¶ä¸ºå•ä¸ªæ¥å£ã€‚\ninterface Point { x: number; } interface Point { y: number; } const point: Point = { x: 1, y: 2 }; Class^ç±»^ ES6 ä¸­æ–°å¢äº† class å…³é”®å­—ï¼Œç”¨äºå®šä¹‰ç±»ã€‚\nBasic^åŸºæœ¬æ–¹æ³•^ åŒ…æ‹¬ï¼šé™æ€å±æ€§ï¼Œé™æ€æ–¹æ³•ã€æˆå‘˜å±æ€§ã€æˆå‘˜æ–¹æ³•ã€ç§æœ‰å±æ€§ã€ç§æœ‰æ–¹æ³•ã€æ„é€ å™¨ã€getter \u0026amp; setter ã€‚\n:memo: Note éœ€è¦æ³¨æ„çš„æ˜¯ï¼š åœ¨é™æ€æ–¹æ³•ä¸­ï¼Œå¦‚æœä¸ç»™é»˜è®¤å€¼ï¼Œå¹¶ä¸”ä¸ä½¿ç”¨æ˜¯ä¼šæŠ¥é”™çš„ï¼Œå¦‚æœä¸æƒ³æŠ¥é”™å°±ä½¿ç”¨ ! å…³é”®å­—ï¼Œå¦‚ï¼šmemberProperty!:string ã€‚\nclass Class { /* 1. é™æ€å±æ€§ */ static staticProperty: string = \u0026#39;é™æ€å±æ€§\u0026#39;; // static name!:string; // TS1255: A definite assignment assertion \u0026#39;!\u0026#39; is not permitted in this context. /* 2. é™æ€æ–¹æ³• */ static staticMember = () =\u0026gt; { return `æˆ‘æ˜¯é™æ€æ–¹æ³•:${this.staticProperty}`; } /* 3. æˆå‘˜å±æ€§ */ // å®é™…ä¸Šæ˜¯é€šè¿‡publicä¸Šè¿›è¡Œä¿®é¥°ï¼Œåªæ˜¯çœç•¥äº† member1: string = \u0026#39;æˆå‘˜å±æ€§\u0026#39;; member2: string; // note: å¹¶æ²¡æœ‰æŠ¥é”™ memberProperty!: string; // ok ä¸è®¾ç½®é»˜è®¤å€¼çš„æ—¶å€™å¿…é¡»åŠ å…¥ï¼ /* 4. æˆå‘˜æ–¹æ³• */ memberMethod = () =\u0026gt; { return `æˆ‘æ˜¯æˆå‘˜æ–¹æ³•:${this.memberProperty}`; } getPrivateMethod = () =\u0026gt; { return this.#privateMethod(); } /* 5. ç§æœ‰å±æ€§ */ #privateProperty: string = \u0026#39;ç§æœ‰å±æ€§\u0026#39;; /* 6. ç§æœ‰æ–¹æ³• */ #privateMethod = () =\u0026gt; { return `æˆ‘æ˜¯ç§æœ‰æ–¹æ³•:${this.#privateProperty}`; }; /* 7. æ„é€ å™¨ */ constructor(_name: string) { this.memberProperty = _name; } /* 8. get */ get getter() { return this.memberProperty; } /* ... \u0026amp; set */ set getter(val) { this.memberProperty = val; } } const instance = new Class(\u0026#39;æˆå‘˜å±æ€§\u0026#39;); console.log(Class.staticMember()); console.log(instance.getPrivateMethod()); console.log(instance.memberMethod()); // æˆ‘æ˜¯é™æ€æ–¹æ³•:é™æ€å±æ€§ // æˆ‘æ˜¯ç§æœ‰æ–¹æ³•:ç§æœ‰å±æ€§ // æˆ‘æ˜¯æˆå‘˜æ–¹æ³•:æˆå‘˜å±æ€§ Modifier^ä¿®é¥°ç¬¦^ public^å…¬å¼€^ ä¿®é¥°çš„å±æ€§æˆ–æ–¹æ³•æ˜¯å…¬æœ‰çš„ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¢«è®¿é—®åˆ°ï¼Œé»˜è®¤æ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•éƒ½æ˜¯ public çš„ã€‚\nprotected^ä¿æŠ¤^ ä¿®é¥°çš„å±æ€§æˆ–æ–¹æ³•æ˜¯å—ä¿æŠ¤çš„ï¼Œå®ƒå’Œ private ç±»ä¼¼ï¼Œä½†å…è®¸è¢«å­ç±»ç»§æ‰¿ä»è€Œè¢«è®¿é—®ã€‚\nprivate^ç§æœ‰^ ä¿®é¥°çš„å±æ€§æˆ–æ–¹æ³•æ˜¯ç§æœ‰çš„ï¼Œä¸èƒ½åœ¨å£°æ˜å®ƒçš„ç±»çš„å¤–éƒ¨è®¿é—®ã€‚\n:memo: Note è¯¥é™åˆ¶ä»…å­˜åœ¨äºç¼–è¯‘æœŸé—´ï¼Œç¼–è¯‘ä¹‹åçš„ä»£ç ä¸­ï¼Œå¹¶æ²¡æœ‰é™åˆ¶ private å±æ€§åœ¨å¤–éƒ¨çš„å¯è®¿é—®æ€§ã€‚\n#^ç§æœ‰å­—æ®µ^ åœ¨ TS 3.8 ç‰ˆæœ¬ä¾¿å¼€å§‹æ”¯æŒ ES2022 æ–°å¢çš„ç§æœ‰æ–¹æ³•ï¼Œè€Œç¿»è¯‘æˆä¹‹å‰çš„ç‰ˆæœ¬åˆ™ä½¿ç”¨ WeakMap() å®ç°ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ ç§æœ‰å­—æ®µ ä¸å¸¸è§„å­—æ®µä¸åŒï¼Œä¸»è¦çš„åŒºåˆ«æ˜¯ï¼š\nç§æœ‰å­—æ®µä»¥ # å­—ç¬¦å¼€å¤´ï¼Œä¹Ÿå«ç§æœ‰åç§° æ¯ä¸ªç§æœ‰å­—æ®µåç§°éƒ½ å”¯ä¸€ åœ°é™å®šäºå…¶åŒ…å«çš„ç±» ä¸èƒ½åœ¨ç§æœ‰å­—æ®µä¸Šä½¿ç”¨ TypeScript å¯è®¿é—®æ€§ä¿®é¥°ç¬¦ï¼ˆå¦‚ public æˆ– privateï¼‰ ç§æœ‰å­—æ®µä¸èƒ½åœ¨åŒ…å«çš„ç±»ä¹‹å¤–è®¿é—®ï¼Œç”šè‡³ä¸èƒ½è¢«æ£€æµ‹åˆ°ã€‚ readonly^åªè¯»å±æ€§^ è§ æ¥å£*^interface^* çš„åªè¯»å±æ€§ã€‚\n:page_with_curl: Example\nclass PropertyTest { public publicProperty = \u0026#39;foo\u0026#39;; private privateProperty = \u0026#39;bar\u0026#39;; #property = \u0026#39;baz\u0026#39;; method() { console.log(this.publicProperty); // foo console.log(this.privateProperty); // bar // ç¼–è¯‘ä¹‹åçš„ä»£ç ä¸­ï¼Œå¹¶æ²¡æœ‰é™åˆ¶ private å±æ€§åœ¨å¤–éƒ¨çš„å¯è®¿é—®æ€§ console.log(this.#property); // baz // ES2022å‰ï¼Œä½¿ç”¨WeakMap()ä¿å­˜ä¸ºçœŸæ­£çš„ç§æœ‰å±æ€§ } } new PropertyTest().method(); ç¼–è¯‘ä¸º EcmaScript2020 ï¼š\n// ES2020 \u0026#34;use strict\u0026#34;; var __classPrivateFieldGet = (this \u0026amp;\u0026amp; this.__classPrivateFieldGet) || function (receiver, state, kind, f) { if (kind === \u0026#34;a\u0026#34; \u0026amp;\u0026amp; !f) throw new TypeError(\u0026#34;Private accessor was defined without a getter\u0026#34;); if (typeof state === \u0026#34;function\u0026#34; ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\u0026#34;Cannot read private member from an object whose class did not declare it\u0026#34;); return kind === \u0026#34;m\u0026#34; ? f : kind === \u0026#34;a\u0026#34; ? f.call(receiver) : f ? f.value : state.get(receiver); }; var _PropertyTest_property; class PropertyTest { constructor() { this.publicProperty = \u0026#39;foo\u0026#39;; this.privateProperty = \u0026#39;bar\u0026#39;; _PropertyTest_property.set(this, \u0026#39;baz\u0026#39;); } method() { console.log(this.publicProperty); // foo console.log(this.privateProperty); // bar // ç¼–è¯‘ä¹‹åçš„ä»£ç ä¸­ï¼Œå¹¶æ²¡æœ‰é™åˆ¶ private å±æ€§åœ¨å¤–éƒ¨çš„å¯è®¿é—®æ€§ console.log(__classPrivateFieldGet(this, _PropertyTest_property, \u0026#34;f\u0026#34;)); // baz // ES2022å‰ï¼Œä½¿ç”¨WeakMap()ä¿å­˜ä¸ºçœŸæ­£çš„ç§æœ‰å±æ€§ } } _PropertyTest_property = new WeakMap(); new PropertyTest().method(); Extends^ç»§æ‰¿^ ç»§æ‰¿*^Inheritance^* æ˜¯ä¸€ç§è”ç»“ç±»ä¸ç±»çš„å±‚æ¬¡æ¨¡å‹ã€‚æŒ‡çš„æ˜¯ä¸€ä¸ªç±»ï¼ˆç§°ä¸ºå­ç±»ã€å­æ¥å£ï¼‰ç»§æ‰¿å¦å¤–çš„ä¸€ä¸ªç±»ï¼ˆç§°ä¸ºçˆ¶ç±»ã€çˆ¶æ¥å£ï¼‰çš„åŠŸèƒ½ï¼Œå¹¶å¯ä»¥å¢åŠ å®ƒè‡ªå·±çš„æ–°åŠŸèƒ½çš„èƒ½åŠ›ï¼Œç»§æ‰¿æ˜¯ç±»ä¸ç±»æˆ–è€…æ¥å£ä¸æ¥å£ä¹‹é—´æœ€å¸¸è§çš„å…³ç³»ã€‚\nè§ EcmaScript Class ä¸€ç« ä¸­çš„ [ç»§æ‰¿](05 EcmaScript.md#class-extends-es6) ã€‚ç»§æ‰¿æ˜¯ä¸€ç§ is-a å…³ç³»ï¼š\nclassDiagram direction BT Class_B --\u0026gt; Class_A Interface_B --\u0026gt; Interface_A class Class_A{ } class Class_B{ } class Interface_A{ } class Interface_B{ } Implements^å®ç°^ ç”¨äºæ£€æµ‹æŸä¸ªç±»æ˜¯å¦å®ç°äº†ç›¸åº”æ¥å£ï¼Œä¸ç¬¦åˆåˆ™æŠ¥é”™ã€‚\n// @errors: 2420 interface Pingable { ping(): void; } class Sonar implements Pingable { ping() { console.log(\u0026#34;ping!\u0026#34;); } } class Ball implements Pingable { // error, Ballä¸­æ²¡æœ‰ping()æ–¹æ³• pong() { console.log(\u0026#34;pong!\u0026#34;); } } Abstract^æŠ½è±¡ç±»^ ç”¨ abstract å…³é”®å­—å£°æ˜çš„ç±»å«åš æŠ½è±¡ç±»ï¼Œå£°æ˜çš„æ–¹æ³•å«åš æŠ½è±¡æ–¹æ³• ã€‚\næŠ½è±¡ç±»ï¼šæŒ‡ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œå› ä¸ºå®ƒé‡Œé¢åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŠ½è±¡æ–¹æ³•ã€‚\næŠ½è±¡æ–¹æ³•ï¼šæ˜¯æŒ‡ä¸åŒ…å«å…·ä½“å®ç°çš„æ–¹æ³•ï¼›\n:memo: Note æŠ½è±¡ç±»æŒ‡çš„æ˜¯ä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ï¼Œåªèƒ½å®ä¾‹åŒ–å®ç°äº†æ‰€æœ‰æŠ½è±¡æ–¹æ³•çš„å­ç±»ã€‚\n:page_with_curl: Example\nabstract class Shape { protected readonly name; protected constructor({name = \u0026#39;\u0026#39;}) { this.name = name; } // Abstract class constructor can be made protected abstract getArea(): number; } class Rectangle extends Shape { protected readonly height; protected readonly width; constructor(name, [height = 0, width = 0]) { super({name}); this.height = height; this.width = width; } getArea() { return this.height * this.width; } } class Square extends Rectangle { constructor(name, length: number) { super(name, [length, length]); } } class Triangle extends Shape { protected readonly height; protected readonly width; constructor(name, [height = 0, width = 0]) { super({name}); this.height = height; this.width = width; } getArea() { return this.height * this.width / 2; } } console.log( new Triangle(\u0026#39;triangle\u0026#39;, [12, 10]).getArea(), new Rectangle(\u0026#39;rectangle\u0026#39;, [12, 10]).getArea(), new Square(\u0026#39;square\u0026#39;, 10).getArea(), ); // 60 120 100 Override \u0026amp; overload^é‡å†™å’Œé‡è½½^ [é‡å†™override](06 EcmaScript C/#class-extends-es6)ï¼šä½¿ç”¨ extends å…³é”®å­—ä½¿å­ç±»èƒ½é‡å†™ç»§æ‰¿è‡ªçˆ¶ç±»ä¸­çš„æ–¹æ³• é‡è½½overloadï¼šå…è®¸åŒä¸€ä¸ªå‡½æ•°æ‹¥æœ‰å¤šä¸ªç±»å‹å®šä¹‰ Infer^ç±»å‹æ¨æ–­^ å½“ noImplicitAny é…ç½®å±æ€§è¢«å¯ç”¨ä¹‹åï¼ŒTypeScript å°±å¯ä»¥ä½¿ç”¨æ§åˆ¶æµåˆ†ææ¥ç¡®è®¤ç±»ä¸­çš„å±æ€§ç±»å‹ï¼š\nclass Person { fullName; // (property) Person.fullName: string firstName; // (property) Person.firstName: string | undefined lastName; // (property) Person.lastName: string | undefined constructor(fullName: string) { this.fullName = fullName; if(Math.random()){ this.firstName = fullName.split(\u0026#34; \u0026#34;)[0]; this.lastName = fullName.split(\u0026#34; \u0026#34;)[1]; } } } :memo: Note ä½†åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æ³•ä¿è¯å¯¹æˆå‘˜å±æ€§éƒ½è¿›è¡Œèµ‹å€¼ï¼Œé‚£ä¹ˆè¯¥å±æ€§å¯èƒ½ä¼šè¢«è®¤ä¸ºæ˜¯ undefinedã€‚\né»˜è®¤ TS å¹¶ä¸ä¼šè‡ªåŠ¨æ¨æ–­ ç±»*^class^* çš„ æˆå‘˜*^property^* ç±»å‹ï¼š\nTS7045: Member \u0026#39;fullName\u0026#39; implicitly has an \u0026#39;any\u0026#39; type, but a better type may be inferred from usage. Generics^æ³›å‹^ ç±»ä¼¼ C++ å’Œ Java çš„è¯­æ³•ï¼ŒTypeScript å¯ä»¥åœ¨å®šä¹‰å‡½æ•°ã€æ¥å£æˆ–ç±»çš„æ—¶å€™ï¼Œä¸é¢„å…ˆæŒ‡å®šå…·ä½“çš„ç±»å‹ï¼Œè€Œåœ¨ä½¿ç”¨çš„æ—¶å€™å†æŒ‡å®šç±»å‹ã€‚\nfunction identity\u0026lt;T\u0026gt;(value: T): T { // T:ä¼ é€’ç±»å‹ --\u0026gt; Té“¾å¼ä¼ é€’ç»™å‚æ•°ç±»å‹å’Œè¿”å›ç±»å‹ return value; } identity\u0026lt;Number\u0026gt;(1); å‚è€ƒä¸Šé¢çš„å›¾ç‰‡ï¼Œå½“æˆ‘ä»¬è°ƒç”¨ identity\u0026lt;Number\u0026gt;(1) ï¼ŒNumber ç±»å‹å°±åƒå‚æ•° 1 ä¸€æ ·ï¼Œå®ƒå°†åœ¨å‡ºç° T çš„ä»»ä½•ä½ç½®å¡«å……è¯¥ç±»å‹ã€‚\n\u0026lt;T\u0026gt; å†…éƒ¨çš„ T è¢«ç§°ä¸º ç±»å‹å˜é‡type variable ï¼Œåœ¨å®šä¹‰æ³›å‹æ—¶é€šå¸¸ç”¨ä½œç¬¬ä¸€ä¸ªç±»å‹å˜é‡åç§°ã€‚ä½†å®é™…ä¸Š T å¯ä»¥ç”¨ä»»ä½•æœ‰æ•ˆåç§°ä»£æ›¿ã€‚å®ƒæ˜¯æˆ‘ä»¬å¸Œæœ›ä¼ é€’ç»™ identity å‡½æ•°çš„ç±»å‹å ä½ç¬¦ï¼ŒåŒæ—¶å®ƒè¢«åˆ†é…ç»™ value å‚æ•°ç”¨æ¥ä»£æ›¿å®ƒçš„ç±»å‹ï¼šæ­¤æ—¶ T å……å½“çš„æ˜¯ç±»å‹ï¼Œè€Œä¸æ˜¯ç‰¹å®šçš„ Number ç±»å‹ã€‚\né™¤äº† T ä¹‹å¤–ï¼Œä»¥ä¸‹æ˜¯å¸¸è§æ³›å‹å˜é‡ä»£è¡¨çš„æ„æ€ï¼š\nK ^key^ï¼šè¡¨ç¤ºå¯¹è±¡ä¸­çš„é”®ç±»å‹ï¼› V ^value^ï¼šè¡¨ç¤ºå¯¹è±¡ä¸­çš„å€¼ç±»å‹ï¼› E ^element^ï¼šè¡¨ç¤ºå…ƒç´ ç±»å‹ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæ³›å‹æ˜¯å…è®¸åŒä¸€ä¸ªå‡½æ•°æ¥å—ä¸åŒç±»å‹å‚æ•°çš„ä¸€ç§æ¨¡ç‰ˆï¼Œä¸ any ç›¸æ¯”ï¼Œä½¿ç”¨æ³›å‹æ¥åˆ›å»ºå¯ å¤ç”¨*^multiplex^* çš„ç»„ä»¶è¦æ›´å¥½ï¼Œå› ä¸ºæ³›å‹ä¼šä¿ç•™ å‚æ•°ç±»å‹*^type^* ã€‚\nå…¶å®å¹¶ä¸æ˜¯åªèƒ½å®šä¹‰ä¸€ä¸ªç±»å‹å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥å¼•å…¥å¸Œæœ›å®šä¹‰çš„ä»»ä½•æ•°é‡çš„ç±»å‹å˜é‡ã€‚æ¯”å¦‚æˆ‘ä»¬å¼•å…¥ä¸€ä¸ªæ–°çš„ç±»å‹å˜é‡ U ï¼Œç”¨äºæ‰©å±•æˆ‘ä»¬å®šä¹‰çš„ identity å‡½æ•°ï¼š\nfunction identity\u0026lt;T, U\u0026gt;(value: T, message: U): T { console.log(message); return value; } console.log(identity\u0026lt;Number, String\u0026gt;(68, \u0026#39;semi-linker\u0026#39;)); // semi-linker ~\u0026gt; Number --\u0026gt; T // 68 ~\u0026gt; String --\u0026gt; U é™¤äº†ä¸ºç±»å‹å˜é‡æ˜¾å¼è®¾å®šå€¼ä¹‹å¤–ï¼Œä¸€ç§æ›´å¸¸è§çš„åšæ³•æ˜¯ä½¿ç¼–è¯‘å™¨è‡ªåŠ¨é€‰æ‹©è¿™äº›ç±»å‹ï¼Œä»è€Œä½¿ä»£ç æ›´ç®€æ´ã€‚æˆ‘ä»¬å¯ä»¥å®Œå…¨çœç•¥å°–æ‹¬å·ï¼Œæ¯”å¦‚ï¼š\nfunction identity\u0026lt;T, U\u0026gt;(value: T, message: U): T { console.log(message); return value; } console.log(identity(68, \u0026#34;Semlinker\u0026#34;)); å¯¹äºä¸Šè¿°ä»£ç ï¼Œç¼–è¯‘å™¨è¶³å¤Ÿèªæ˜ï¼Œèƒ½å¤ŸçŸ¥é“æˆ‘ä»¬çš„å‚æ•°ç±»å‹ï¼Œå¹¶å°†å®ƒä»¬èµ‹å€¼ç»™ T å’Œ U ï¼Œè€Œä¸éœ€è¦å¼€å‘äººå‘˜æ˜¾å¼æŒ‡å®šå®ƒä»¬ã€‚\nInterface^æ³›å‹æ¥å£^ interface GenericIdentityFn\u0026lt;T\u0026gt; { (arg: T): T; } Class^æ³›å‹ç±»^ class GenericNumber\u0026lt;T\u0026gt; { zeroValue: T; add: (x: T, y: T) =\u0026gt; T; } let myGenericNumber = new GenericNumber\u0026lt;number\u0026gt;(); myGenericNumber.zeroValue = 0; myGenericNumber.add = function (x, y) { return x + y; }; Operator^æ“ä½œç¬¦^ Typeof åœ¨ TypeScript ä¸­ï¼Œtypeof æ“ä½œç¬¦å¯ä»¥ç”¨æ¥è·å–ä¸€ä¸ªå˜é‡å£°æ˜æˆ–å¯¹è±¡çš„ç±»å‹ã€‚\ninterface Person { name: string; age: number; } const sem: Person = {name: \u0026#39;semi-linker\u0026#39;, age: 33}; type Sem = typeof sem; // -\u0026gt; Person let Sam: Sem = {name: \u0026#39;foo\u0026#39;, age: 42} // ok é”®åå­—é¢é‡ç›¸åŒã€é”®å€¼ç±»å‹ç›¸åŒ function toArray(x: number): Array\u0026lt;number\u0026gt; { return [x]; } type Func = typeof toArray; // -\u0026gt; (x: number) =\u0026gt; number[] // Alias for: typeof toArray // Initial type: (x: number) =\u0026gt; Array\u0026lt;number\u0026gt; let func: Func = function (x: number) { return [1, 2, 3]; } // ok å‚æ•°ç›¸åŒã€è¿”å›å€¼ç›¸åŒ Keyof keyof æ“ä½œç¬¦å¯ä»¥ç”¨äºè·å–æŸç§ç±»å‹çš„æ‰€æœ‰é”®ï¼Œå…¶è¿”å›ç±»å‹æ˜¯è”åˆç±»å‹ã€‚\ninterface Person { name: string; age: number; } type K1 = keyof Person; // \u0026#34;name\u0026#34; | \u0026#34;age\u0026#34; type K2 = keyof Person[]; // æ•°ç»„ç±»å‹ Alias for: keyof Person[]/keyof [] // \u0026#34;length\u0026#34; | \u0026#34;toString\u0026#34; | \u0026#34;toLocaleString\u0026#34; | \u0026#34;pop\u0026#34; | \u0026#34;push\u0026#34; | \u0026#34;concat\u0026#34; | \u0026#34;join\u0026#34; | \u0026#34;reverse\u0026#34; | \u0026#34;shift\u0026#34; | \u0026#34;slice\u0026#34; | \u0026#34;sort\u0026#34; | ... type K3 = keyof { [x: string]: Person }; // string | number // Alias for: keyof {[p: string]: Person} // Initial type: string | number åœ¨ TypeScript ä¸­æ”¯æŒä¸¤ç§ç´¢å¼•ç­¾åï¼Œæ•°å­—ç´¢å¼•å’Œå­—ç¬¦ä¸²ç´¢å¼•ï¼š\ninterface StringArray { // å­—ç¬¦ä¸²ç´¢å¼• -\u0026gt; keyof StringArray =\u0026gt; string | number [index: string]: string; } interface NumberArray { // æ•°å­—ç´¢å¼• -\u0026gt; keyof NumberArray =\u0026gt; number [index: number]: string; } interface Person { name: string; age: number; } :memo: Note\nä¸ºäº†åŒæ—¶æ”¯æŒä¸¤ç§ç´¢å¼•ç±»å‹ï¼Œå°±å¾—è¦æ±‚æŠŠ æ•°å€¼*^number^* ç´¢å¼•*^index^* çš„è¿”å›å€¼å¿…é¡»æ˜¯ å­—ç¬¦ä¸²*^string^* ç´¢å¼•è¿”å›å€¼çš„ å­ç±» ã€‚å…¶ä¸­çš„åŸå› å°±æ˜¯å½“ä½¿ç”¨æ•°å€¼ç´¢å¼•æ—¶ï¼ŒJavaScript åœ¨æ‰§è¡Œç´¢å¼•æ“ä½œæ—¶ï¼Œä¼šå…ˆæŠŠ æ•°å€¼*^number^* ç´¢å¼•å…ˆè½¬æ¢ä¸º å­—ç¬¦ä¸²*^string^* ç´¢å¼•ã€‚æ‰€ä»¥ä¸‹é¢ k çš„ç±»å‹æ˜¯ string|number ã€‚\n:page_with_curl: Example\ninterface Person { name: string; age: number; } type k = keyof { [x: string]: Person }; // Alias for: keyof {[p: string]: Person} // Initial type: string | number In in ç”¨æ¥éå† å¯æšä¸¾ç±»å‹*^iterable-type^* ï¼š\ntype Keys = \u0026#34;a\u0026#34; | \u0026#34;b\u0026#34; | \u0026#34;c\u0026#34; type Obj = { [p in Keys]: any; } // éå†Keyç±»å‹ä¸­çš„æ‰€æœ‰æˆå‘˜ä½œä¸ºé”®å // Initial type: {a: any, b: any, c: any} type Str = { [P in keyof \u0026#39;\u0026#39;]: \u0026#39;\u0026#39;[P]; } // è·å–å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰é”®å: å†…å®¹ä¸ºå­—ç¬¦ä¸²ç±»å‹ä¸­çš„æ‰€æœ‰é”®å€¼ // Initial type: {toString(): string, ... Infer åœ¨æ¡ä»¶ç±»å‹è¯­å¥ä¸­ï¼Œå¯ä»¥ç”¨ infer å£°æ˜ä¸€ä¸ªç±»å‹å˜é‡å¹¶ä¸”å¯¹å®ƒè¿›è¡Œä½¿ç”¨ã€‚\ntype ReturnType\u0026lt;T\u0026gt; = T extends ( ...args: any[] ) =\u0026gt; infer R ? R : any; ä»¥ä¸Šä»£ç ä¸­ infer R å°±æ˜¯å£°æ˜ä¸€ä¸ªå˜é‡æ¥æ‰¿è½½ä¼ å…¥å‡½æ•°ç­¾åçš„è¿”å›å€¼ç±»å‹ï¼Œç®€å•è¯´å°±æ˜¯ç”¨å®ƒå–åˆ°å‡½æ•°è¿”å›å€¼çš„ç±»å‹æ–¹ä¾¿ä¹‹åä½¿ç”¨ã€‚\nExtends æœ‰æ—¶å€™æˆ‘ä»¬å®šä¹‰çš„æ³›å‹ä¸æƒ³è¿‡äºçµæ´»æˆ–è€…è¯´æƒ³ç»§æ‰¿æŸäº›ç±»ç­‰ï¼Œå¯ä»¥é€šè¿‡ extends å…³é”®å­—æ·»åŠ æ³›å‹çº¦æŸã€‚\ninterface Lengthwise { length: number; } function loggingIdentity\u0026lt;T extends Lengthwise\u0026gt;(arg: T): T { console.log(arg.length); return arg; } ç°åœ¨è¿™ä¸ªæ³›å‹å‡½æ•°è¢«å®šä¹‰äº†çº¦æŸï¼Œå› æ­¤å®ƒä¸å†æ˜¯é€‚ç”¨äºä»»æ„ç±»å‹ï¼š\nloggingIdentity(3); // undefined è¿™æ—¶æˆ‘ä»¬éœ€è¦ä¼ å…¥ç¬¦åˆçº¦æŸç±»å‹çš„å€¼ï¼Œå¿…é¡»åŒ…å«å¿…é¡»çš„å±æ€§ï¼š\nloggingIdentity({length: 3}); // 3 Complex^å¤åˆç±»å‹^ Record Record\u0026lt;K extends string | number | symbol, T\u0026gt;\nä»¥ typeof æ ¼å¼å¿«é€Ÿåˆ›å»ºä¸€ä¸ªç±»å‹ï¼Œæ­¤ç±»å‹åŒ…å«ä¸€ç»„æŒ‡å®šçš„å±æ€§ä¸”éƒ½æ˜¯å¿…å¡«ã€‚\ntype Coord = Record\u0026lt;\u0026#39;x\u0026#39; | \u0026#39;y\u0026#39;, number\u0026gt;; // ç­‰åŒäº type Coord = { x: number; y: number; } å…·ä½“çš„å¤æ‚ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œä¸€èˆ¬ä¼šæ¥å£ Pick ã€Partial ç­‰ç»„åˆä½¿ç”¨ï¼Œä»è€Œè¿‡æ»¤å’Œé‡ç»„å‡ºæ–°çš„ç±»å‹å®šä¹‰ã€‚\nPartial Partial\u0026lt;T\u0026gt;\nå°†ç±»å‹å®šä¹‰çš„æ‰€æœ‰å±æ€§éƒ½ä¿®æ”¹ä¸ºå¯é€‰é¡¹ ? ã€‚\ntype Coord = Partial\u0026lt;Record\u0026lt;\u0026#39;x\u0026#39; | \u0026#39;y\u0026#39;, number\u0026gt;\u0026gt;; // ç­‰åŒäº type Coord = { x?: number; y?: number; } /** * node_modules/typescript/lib/lib.es5.d.ts * Make all properties in T optional */ type Partial\u0026lt;T\u0026gt; = { [P in keyof T]?: T[P]; }; åœ¨ä»¥ä¸Šä»£ç ä¸­ï¼Œé¦–å…ˆé€šè¿‡ keyof T æ‹¿åˆ° T çš„æ‰€æœ‰å±æ€§åï¼Œç„¶åä½¿ç”¨ in è¿›è¡Œéå†ï¼Œå°†å€¼èµ‹ç»™ Pï¼Œæœ€åé€šè¿‡ T[P] å–å¾—ç›¸åº”çš„å±æ€§å€¼ã€‚ä¸­é—´çš„ ? å·ï¼Œç”¨äºå°†æ‰€æœ‰å±æ€§å˜ä¸ºå¯é€‰ã€‚\nç¤ºä¾‹ï¼š\ninterface Todo { title: string; description: string; } function updateTodo(todo: Todo, fieldsToUpdate: Partial\u0026lt;Todo\u0026gt;) { return {...todo, ...fieldsToUpdate}; // è§£æ„å†™æ³• } const todo1 = { title: \u0026#34;Learn TS\u0026#34;, description: \u0026#34;Learn TypeScript\u0026#34;, }; const todo2 = updateTodo(todo1, { description: \u0026#34;Learn TypeScript Enum\u0026#34;, }); åœ¨ä¸Šé¢çš„ updateTodo æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨ Partial\u0026lt;T\u0026gt; å·¥å…·ç±»å‹ï¼Œå®šä¹‰ fieldsToUpdate çš„ç±»å‹ä¸º Partial\u0026lt;Todo\u0026gt;ï¼Œå³ï¼š\ninterface PartiallyTodo { title?: string | undefined; description?: string | undefined; } Readonly Readonly\u0026lt;T\u0026gt;\nä¸ç®¡æ˜¯ä»å­—é¢æ„æ€ï¼Œè¿˜æ˜¯å®šä¹‰ä¸Šéƒ½å¾ˆå¥½ç†è§£ï¼šå°†æ‰€æœ‰å±æ€§å®šä¹‰ä¸ºè‡ªè¯»ã€‚\ntype Coord = Readonly\u0026lt;Record\u0026lt;\u0026#39;x\u0026#39; | \u0026#39;y\u0026#39;, number\u0026gt;\u0026gt;; // ç­‰åŒäº type Coord = { readonly x: number; readonly y: number; } // å¦‚æœè¿›è¡Œäº†ä¿®æ”¹ï¼Œåˆ™ä¼šæŠ¥é”™ï¼š const c: Coord = { x: 1, y: 1 }; c.x = 2; // Error: Cannot assign to \u0026#39;x\u0026#39; because it is a read-only property. Pick type Pick\u0026lt;T, K extends keyof T\u0026gt;\nä»ç±»å‹å®šä¹‰çš„å±æ€§ä¸­ï¼Œé€‰å–æŒ‡å®šä¸€ç»„å±æ€§ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ç±»å‹å®šä¹‰ã€‚\ntype Coord = Record\u0026lt;\u0026#39;x\u0026#39; | \u0026#39;y\u0026#39;, number\u0026gt;; type CoordX = Pick\u0026lt;Coord, \u0026#39;x\u0026#39;\u0026gt;; // ç­‰ç”¨äº type CoordX = { x: number; } Required Required\u0026lt;T\u0026gt;\n/** * Make all properties in T required */ type Required\u0026lt;T\u0026gt; = { [P in keyof T]-?: T[P]; }; ä¸ Partial\u0026lt;T\u0026gt; ç¨‹åºç±»å‹çš„ä½œç”¨ç›¸åï¼Œå°†ç±»å‹å±æ€§éƒ½å˜æˆå¿…å¡«ã€‚\ntype Coord = Required\u0026lt;{ x: number, y?:number }\u0026gt;; // ç­‰åŒäº type Coord = { x: number; y: number; } æ–¹æ³•é€šè¿‡ -? æ˜ å°„æ¡ä»¶è£…é¥°ç¬¦ï¼Œå»æ‰äº†æ‰€æœ‰å¯é€‰å‚æ•°çŠ¶æ€ã€‚\nExclude Exclude\u0026lt;T, U\u0026gt;\n/** * Exclude from T those types that are assignable to U */ type Exclude\u0026lt;T, U\u0026gt; = T extends U ? never : T; æ’é™¤ä¸€ä¸ª è”åˆç±»å‹ ä¸­æŒ‡å®šçš„å­ç±»å‹ï¼š\ntype T0 = Exclude\u0026lt;\u0026#39;a\u0026#39; | \u0026#39;b\u0026#39; | \u0026#39;c\u0026#39;, \u0026#39;b\u0026#39;\u0026gt; // \u0026#39;a\u0026#39; | \u0026#39;c\u0026#39; type T1 = Exclude\u0026lt;string | number | boolean, boolean\u0026gt; // string | number ä¸»è¦æ˜¯åŸºäº extends æ¡ä»¶ç±»å‹çš„ è§£ææ¨è¿Ÿ çš„ç‰¹æ€§ ï¼Œè¿”å›äº†åŒ¹é…ä¹‹å¤–çš„æ‰€æœ‰ å€™é€‰ç±»å‹ï¼Œé…åˆ never ç±»å‹çš„ç©ºå€¼ç‰¹æ€§ï¼Œå®ç°äº†è¿™ä¸€é«˜çº§ç±»å‹ã€‚\nExtract Extract\u0026lt;T, U\u0026gt;\n/** * Extract from T those types that are assignable to U */ type Extract\u0026lt;T, U\u0026gt; = T extends U ? T : never; ä¸ Exclude\u0026lt;T, U\u0026gt; å®Œå…¨ç›¸åçš„åŠŸèƒ½ï¼Œç”¨äºæå–æŒ‡å®šçš„ è”åˆç±»å‹ï¼Œå¦‚æœä¸å­˜åœ¨æå–ç±»å‹ï¼Œåˆ™è¿”å›neverã€‚å¯ä»¥ç”¨åœ¨åˆ¤æ–­ä¸€ä¸ªå¤æ‚çš„ è”åˆç±»å‹ ä¸­æ˜¯å¦åŒ…å«æŒ‡å®šå­ç±»å‹ï¼š\ntype T0 = Extract\u0026lt;\u0026#39;a\u0026#39; | \u0026#39;b\u0026#39; | \u0026#39;c\u0026#39;, \u0026#39;a\u0026#39;\u0026gt; // \u0026#39;a\u0026#39; type T1 = Extract\u0026lt;string | number | boolean, boolean\u0026gt; // boolean Omit Omit\u0026lt;T, K extends keyof any\u0026gt;\n/** * Construct a type with the properties of T except for those in type K. */ type Omit\u0026lt;T, K extends keyof any\u0026gt; = Pick\u0026lt;T, Exclude\u0026lt;keyof T, K\u0026gt;\u0026gt;; æ’é™¤æ¥å£ä¸­æŒ‡å®šçš„å±æ€§ï¼š\ninterface I1 { a: number; b: string; c: boolean; } type AC = Omit\u0026lt;I1, \u0026#39;b\u0026#39;\u0026gt;; // { a:number; c:boolean } type C = Omit\u0026lt;I1, \u0026#39;a\u0026#39; |\u0026#39;b\u0026#39;\u0026gt; // { c: boolean } è¿™ä¸ªåœ¨é«˜çº§ç±»å‹çš„ä½¿ç”¨é¢‘ç‡ä¹Ÿæ¯”è¾ƒé«˜ã€‚\nNonNullable NonNullable\u0026lt;T\u0026gt;\n/** * Exclude null and undefined from T */ type NonNullable\u0026lt;T\u0026gt; = T extends null | undefined ? never : T; è¿‡æ»¤æ‰ è”åˆç±»å‹ ä¸­çš„ null å’Œ undefined ç±»å‹ï¼š\ntype T1 = NonNullable\u0026lt;string | null | undefined\u0026gt;; // string é¢å¤–è¯´æ˜ä¸‹ï¼Œå› ä¸º null å’Œ undefined ç±»å‹çš„ç‰¹æ®Šæ€§ï¼Œä»–ä»¬å¯ä»¥èµ‹å€¼ç»™ä»»ä½•ç±»å‹ï¼Œè¿™å¾€å¾€ä¼šå¸¦æ¥æ„æ–™ä¹‹å¤–çš„é”™è¯¯ã€‚å½“ä½ å¼€å¯ --strictNullChecks è®¾ç½®åï¼ŒTS å°±ä¼šä¸¥æ ¼æ£€æŸ¥ï¼Œåªæœ‰è¢«å£°æ˜ null åæ‰èƒ½è¢«èµ‹å€¼ï¼š\n// å…³é—­ --strictNullChecks let s: string = \u0026#34;foo\u0026#34;; s = null; // æ­£å¸¸ // å¼€å¯ --strictNullChecks s = null; // Error: Type \u0026#39;null\u0026#39; is not assignable to type \u0026#39;string\u0026#39;. Parameters Parameters\u0026lt;T extends (\u0026hellip;args: any) =\u0026gt; any\u0026gt;\n/** * Obtain the parameters of a function type in a tuple */ type Parameters\u0026lt;T extends (...args: any) =\u0026gt; any\u0026gt; = T extends (...args: infer P) =\u0026gt; any ? P : never; è·å–å‡½æ•°çš„å…¨éƒ¨å‚æ•°ç±»å‹ï¼Œä»¥ å…ƒç»„ç±»å‹ è¿”å›ï¼š\ntype F1 = (a: string, b: number) =\u0026gt; void; type F1ParamTypes = Parameters(F1); // [string, number] ConstructorParameters ConstructorParameters\u0026lt;T extends new (\u0026hellip;args: any) =\u0026gt; any\u0026gt;\n/** * Obtain the parameters of a constructor function type in a tuple */ type ConstructorParameters\u0026lt;T extends new (...args: any) =\u0026gt; any\u0026gt; = T extends new (...args: infer P) =\u0026gt; any ? P : never; åŒä¸Šé¢çš„ç±»å‹å¾ˆç›¸ä¼¼ï¼Œåªæ˜¯è¿™é‡Œè·å–çš„æ˜¯ æ„é€ å‡½æ•° çš„å…¨éƒ¨å‚æ•°ã€‚å…³äºæ„é€ å‡½æ•°å£°æ˜ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨æ­¤ é«˜çº§ç±»å‹ çš„æ–¹å¼ï¼š\ninterface IEntity { count?: () =\u0026gt; number } interface IEntityConstructor { new (a: boolean, b: string): IEntity; } class Entity implements IEntity { constructor(a: boolean, b: string) { } } type EntityConstructorParamType = ConstructorParameters\u0026lt;IEntityConstructor\u0026gt;; // [boolean, string] è¿™é‡Œçš„ IEntityConstructor æ¥å£ç”¨æ¥å¹²ä»€ä¹ˆçš„å‘¢ï¼Œå½“åŸºäº åˆ›å»ºå®ä¾‹å‡½æ•° æ—¶å°±æ´¾ä¸Šäº†ç”¨åœºï¼š\nfunction createEntity(ctor: IEntityConstructor, ...arg: EntityConstructorParamType): IEntity { return new ctor(...arg); } const entity = createEntity(Entity, true, \u0026#39;a\u0026#39;); ReturnType ReturnType\u0026lt;T extends (\u0026hellip;args: any) =\u0026gt; any\u0026gt;\n/** * Obtain the return type of a function type */ type ReturnType\u0026lt;T extends (...args: any) =\u0026gt; any\u0026gt; = T extends (...args: any) =\u0026gt; infer R ? R : any; æ¥æ”¶å‡½æ•°å£°æ˜ï¼Œè¿”å›å‡½æ•°çš„è¿”å›å€¼ç±»å‹ï¼Œå¦‚æœå¤šä¸ªç±»å‹åˆ™ä»¥ è”åˆç±»å‹ æ–¹å¼è¿”å›ï¼š\ntype F1 = () =\u0026gt; Date; type F1ReturnType = ReturnType\u0026lt;F1\u0026gt;; // Date InstanceType InstanceType\u0026lt;T extends new (\u0026hellip;args: any) =\u0026gt; any\u0026gt;\n/** * Obtain the return type of a constructor function type */ type InstanceType\u0026lt;T extends new (...args: any) =\u0026gt; any\u0026gt; = T extends new (...args: any) =\u0026gt; infer R ? R : any; è·å– æ„é€ å‡½æ•° çš„è¿”å›ç±»å‹ï¼Œå¦‚æœæ˜¯å¤šä¸ªå°±ä»¥ è”åˆç±»å‹ çš„æ–¹å¼è¿”å›ï¼Œæˆ‘ä»¬å€Ÿç”¨ä¸Šé¢çš„å®šä¹‰ï¼š\ntype EntityType = InstanceType\u0026lt;IEntityConstructor\u0026gt;; // IEntity ThisParameterType ThisParameterType\u0026lt;T\u0026gt;\n/** * Extracts the type of the \u0026#39;this\u0026#39; parameter of a function type, or \u0026#39;unknown\u0026#39; if the function type has no \u0026#39;this\u0026#39; parameter. */ type ThisParameterType\u0026lt;T\u0026gt; = T extends (this: infer U, ...args: any[]) =\u0026gt; any ? U : unknown; è·å–å‡½æ•°ä¸­ this çš„æ•°æ®ç±»å‹ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿”å› unknown ç±»å‹ï¼š\ninterface Foo { x: number }; function fn(this: Foo) {} type Test = ThisParameterType\u0026lt;typeof fn\u0026gt;; // Foo å› ä¸ºå¯ä»¥åœ¨ TS å£°æ˜å‡½æ•°çš„ this ï¼Œæ­¤æ–¹æ³•ç”¨äºè·å–æ­¤å£°æ˜ï¼Œå…·ä½“çš„ä½¿ç”¨ï¼š\nfn.bind({ x: 1 }); // æ­£å¸¸ fn.bind({ x: \u0026#39;1\u0026#39; }); // Error: ...Type \u0026#39;string\u0026#39; is not assignable to type \u0026#39;number\u0026#39;... OmitThisParameter OmitThisParameter\u0026lt;T\u0026gt;\n/** * Removes the \u0026#39;this\u0026#39; parameter from a function type. */ type OmitThisParameter\u0026lt;T\u0026gt; = unknown extends ThisParameterType\u0026lt;T\u0026gt; ? T : T extends (...args: infer A) =\u0026gt; infer R ? (...args: A) =\u0026gt; R : T; ç§»é™¤å‡½æ•°ä¸­çš„ this æ•°æ®ç±»å‹ï¼š\ninterface Foo { x: number }; type Fn = (this: Foo) =\u0026gt; void type NonReturnFn = OmitThisParameter\u0026lt;Fn\u0026gt;; // () =\u0026gt; void å£°æ˜æ­¤ç±»çš„å‡½æ•°ç±»å‹æ•ˆæœå¦‚ä¸‹ï¼š\nfunction f(this: void) {} // æ­¤å£°æ˜åœ¨å‡½æ•°å†…ä¸å¯ä½¿ç”¨ this Decorator^è£…é¥°å™¨^ éšç€ TypeScript å’Œ ES6 ä¸­ ç±»*^class^* çš„å¼•å…¥ï¼Œç°åœ¨å­˜åœ¨æŸäº›éœ€è¦é™„åŠ åŠŸèƒ½æ¥æ”¯æŒ æ³¨é‡Š*^comment^* æˆ–ä¿®æ”¹ç±»å’Œç±»æˆå‘˜çš„åœºæ™¯ã€‚è£…é¥°å™¨*^decorator^* æä¾›äº†ä¸€ç§ä¸ºç±»å£°æ˜å’Œæˆå‘˜æ·»åŠ æ³¨é‡Šå’Œå…ƒç¼–ç¨‹è¯­æ³•çš„æ–¹æ³•ã€‚è£…é¥°å™¨æ˜¯ JavaScript çš„ stage2 ææ¡ˆï¼Œå¯ä½œä¸º TypeScript çš„å®éªŒæ€§åŠŸèƒ½ä½¿ç”¨ã€‚å®ƒæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼š\nè¯¥è¡¨è¾¾å¼è¢«æ‰§è¡Œåï¼Œè¿”å›ä¸€ä¸ªå‡½æ•° å‡½æ•°çš„å…¥å‚åˆ†åˆ«ä¸º targetã€name å’Œ descriptor æ‰§è¡Œè¯¥å‡½æ•°åï¼Œå¯èƒ½è¿”å› descriptor å¯¹è±¡ï¼Œç”¨äºé…ç½® target å¯¹è±¡ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè‹¥è¦å¯ç”¨å®éªŒæ€§çš„è£…é¥°å™¨ç‰¹æ€§ï¼Œä½ å¿…é¡»åœ¨å‘½ä»¤è¡Œæˆ– tsconfig.json é‡Œå¯ç”¨ experimentalDecorators ç¼–è¯‘å™¨é€‰é¡¹ï¼š\nå‘½ä»¤è¡Œï¼š\ntsc --target ES5 --experimentalDecorators æˆ–æ˜¯åœ¨ tsconfig.jsonï¼š\n{ \u0026#34;compilerOptions\u0026#34;: { \u0026#34;target\u0026#34;: \u0026#34;ES5\u0026#34;, \u0026#34;experimentalDecorators\u0026#34;: true } } è£…é¥°å™¨æ˜¯ä¸€ç§å‡½æ•°ï¼Œå†™æˆ @ + å‡½æ•°å ã€‚å®ƒå¯ä»¥æ”¾åœ¨ç±»å’Œç±»æ–¹æ³•çš„å®šä¹‰å‰é¢ã€‚\n@frozen class Foo { @configurable(false) @enumerable(true) method() {} @throttle(500) expensiveMethod() {} } ä¸Šé¢ä»£ç ä¸€å…±ä½¿ç”¨äº†å››ä¸ªè£…é¥°å™¨ï¼Œä¸€ä¸ªç”¨åœ¨ç±»æœ¬èº«ï¼Œå¦å¤–ä¸‰ä¸ªç”¨åœ¨ç±»æ–¹æ³•ã€‚å®ƒä»¬ä¸ä»…å¢åŠ äº†ä»£ç çš„å¯è¯»æ€§ï¼Œæ¸…æ™°åœ°è¡¨è¾¾äº†æ„å›¾ï¼Œè€Œä¸”æä¾›ä¸€ç§æ–¹ä¾¿çš„æ‰‹æ®µï¼Œå¢åŠ æˆ–ä¿®æ”¹ç±»çš„åŠŸèƒ½ã€‚\nClass^ç±»è£…é¥°å™¨^ è£…é¥°å™¨å¯ä»¥ç”¨æ¥è£…é¥°æ•´ä¸ªç±»ã€‚\n// lib.es5.d.ts declare type ClassDecorator = \u0026lt;TFunction extends Function\u0026gt; ( target: TFunction ) =\u0026gt; TFunction | void; // æ¥æ”¶functionç±»å‹ï¼Œè¿”å›æ˜¯functionæˆ–void åŸºæœ¬ä¸Šï¼Œè£…é¥°å™¨çš„è¡Œä¸ºå°±æ˜¯ä¸‹é¢è¿™æ ·ã€‚\n@decorator class A {} function decorator\u0026lt;FT extends Function\u0026gt;(target: FT): void | FT {} // ç­‰åŒäº class _A {} var _A_Decorated = _decorator(_A) || _A; function _decorator\u0026lt;FT extends Function\u0026gt;(target: FT): void | FT {} :page_with_curl: Example\nfunction decorator(target): void { (target as any).isTestable = true; } @decorator class DecorativeClass { // ... } console.log((DecorativeClass as any).isTestable); // true ä¸Šé¢ä»£ç ä¸­ï¼Œ@testable å°±æ˜¯ä¸€ä¸ªè£…é¥°å™¨ã€‚å®ƒä¿®æ”¹äº† MyTestableClass è¿™ä¸ªç±»çš„è¡Œä¸ºï¼Œä¸ºå®ƒåŠ ä¸Šäº† é™æ€*^static^* å±æ€§ isTestable ã€‚testable å‡½æ•°çš„å‚æ•° target æ˜¯ MyTestableClass ç±»æœ¬èº«ã€‚\nğŸ§ª Experimental\nå¯ä»¥ä¸ºè£…é¥°å™¨æ·»åŠ æ–¹æ³•ï¼Œæ­¤æ—¶è¿”å› ClassDecorator ç±»å‹å³å¯ã€‚\n:memo: Note\nå®é™…ä¸Š decorator('foo', 'bar') å¤„å°±æ‰§è¡Œå¹¶ä¼ å‚ 'foo', 'bar' ç»™äº† decorator å‡½æ•°ï¼Œå°†è¿”å›çš„å‡½æ•°ç»™ @ ï¼Œè€Œè¿™ä¸ªè¿”å›çš„å‡½æ•°ç¬¦åˆ type ClassDecorator çš„èŒƒå¼ã€‚å¯ä»¥ç†è§£ä¸º IIFE ã€‚\nfunction decorator(...param): ClassDecorator { return target =\u0026gt; { (target as any)[param[0]] = param[1]; } } @decorator(\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;) class ParamDecorativeClass { // ... } console.log((ParamDecorativeClass as any).foo); // bar ä¹Ÿå°±æ˜¯è¯´ï¼Œè£…é¥°å™¨æ˜¯ä¸€ä¸ªå¯¹ç±»è¿›è¡Œå¤„ç†çš„å‡½æ•°ã€‚è£…é¥°å™¨å‡½æ•°*^decorate^* çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯æ‰€è¦è£…é¥°çš„ç›®æ ‡ç±»ã€‚\n:memo: Note è£…é¥°å™¨å¯¹ç±»çš„è¡Œä¸ºçš„æ”¹å˜ï¼Œæ˜¯ä»£ç  ç¼–è¯‘ æ—¶å‘ç”Ÿçš„ï¼Œè€Œä¸æ˜¯åœ¨è¿è¡Œæ—¶ã€‚è¿™æ„å‘³ç€ï¼Œè£…é¥°å™¨èƒ½åœ¨ç¼–è¯‘é˜¶æ®µè¿è¡Œä»£ç ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè£…é¥°å™¨æœ¬è´¨å°±æ˜¯ç¼–è¯‘æ—¶æ‰§è¡Œçš„å‡½æ•°ã€‚\nå¦‚æœæƒ³æ·»åŠ å®ä¾‹å±æ€§ï¼Œå¯ä»¥é€šè¿‡ç›®æ ‡ç±»çš„ prototype å¯¹è±¡æ“ä½œã€‚\n:page_with_curl: Example\nfunction decorator(target): void { target.prototype.isTestable = true; } @decorator class DecorativeClass { } let obj = new DecorativeClass(); console.log((obj as any).isTestable); // true ä¸Šé¢ä»£ç ä¸­ï¼Œè£…é¥°å™¨å‡½æ•° testable æ˜¯åœ¨ç›®æ ‡ç±»çš„ prototype å¯¹è±¡ä¸Šæ·»åŠ å±æ€§ï¼Œå› æ­¤å°±å¯ä»¥åœ¨å®ä¾‹ä¸Šè°ƒç”¨ã€‚\nä¸‹é¢æ˜¯å¦å¤–ä¸€ä¸ªä¾‹å­ã€‚\n:page_with_curl: Example\n// mixins.js export function mixins(...list) { return function (target) { Object.assign(target.prototype, ...list) } } // main.js import { mixins } from \u0026#39;./mixins.js\u0026#39; const Foo = { foo() { console.log(\u0026#39;foo\u0026#39;) } }; @mixins(Foo) class MyClass { } let obj = new MyClass(); (obj as { foo() }).foo() // \u0026#39;foo\u0026#39; ä¸Šé¢ä»£ç é€šè¿‡è£…é¥°å™¨ mixins ï¼ŒæŠŠ Foo å¯¹è±¡çš„æ–¹æ³•æ·»åŠ åˆ°äº† MyClass çš„å®ä¾‹ä¸Šé¢ã€‚æ²¡æœ‰è£…é¥°å™¨ @decorator æ—¶ï¼Œå¯ä»¥ç”¨ Object.assign() æ¨¡æ‹Ÿè¿™ä¸ªåŠŸèƒ½ã€‚\nconst Foo = { foo() { console.log(\u0026#39;foo\u0026#39;) } }; class MyClass { } Object.assign(MyClass.prototype, Foo); let obj = new MyClass(); obj.foo() // \u0026#39;foo\u0026#39; :memo: Note\nå®é™…å¼€å‘ä¸­ï¼ŒReact ä¸ Redux åº“ç»“åˆä½¿ç”¨æ—¶ï¼Œå¸¸å¸¸éœ€è¦å†™æˆä¸‹é¢è¿™æ ·ã€‚\nclass MyReactComponent extends React.Component {} export default connect(mapStateToProps, mapDispatchToProps)(MyReactComponent); æœ‰äº†è£…é¥°å™¨ï¼Œå°±å¯ä»¥æ”¹å†™ä¸Šé¢çš„ä»£ç ã€‚\n@connect(mapStateToProps, mapDispatchToProps) export default class MyReactComponent extends React.Component {} ç›¸å¯¹æ¥è¯´ï¼Œåä¸€ç§å†™æ³•çœ‹ä¸Šå»æ›´å®¹æ˜“ç†è§£ã€‚\nProperty^å±æ€§è£…é¥°å™¨^ // lib.es5.d.ts declare type PropertyDecorator = ( target: Object, // è¢«è£…é¥°çš„ç±» propertyKey: string | symbol //è¢«è£…é¥°ç±»çš„å±æ€§å ) =\u0026gt; void; :exclamation:Warning ä¸è¦ä½¿ç”¨ï¼š\nä½¿ç”¨å±æ€§è£…é¥°å™¨çš„æ—¶å€™ï¼Œå‡ ä¹æ²¡æœ‰ä½œç”¨ï¼ŒåŸå› æ˜¯è£…é¥°å™¨çš„æœ¬æ„æ˜¯è¦â€œè£…é¥°â€ç±»çš„ å®ä¾‹*^instance^* ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™å®ä¾‹è¿˜æ²¡ç”Ÿæˆï¼Œæ‰€ä»¥åªèƒ½å»è£…é¥° åŸå‹*^prototype^* ï¼›ç”±äºæ— æ³•ç›´æ¥åœ¨ç±»çš„é¡¶å±‚åˆ›å»ºç›´æ¥ä¿®æ”¹åŸå‹çš„è¯­å¥ï¼Œå› æ­¤ä¼šäº§ç”Ÿä¸€ä¸ªå’Œå®ä¾‹åŒåçš„å±æ€§ï¼Œä»è€ŒåŸå‹ä¸Šçš„å±æ€§ä¼šç›´æ¥è¢«å®ä¾‹ä¸Šçš„å±æ€§è¦†ç›–ã€‚\nclass Class { @(decorator as PropertyDecorator) property: any; } function decorator(target: object, propertyKey: string | symbol): void { console.log(target === Class.prototype); // true } ä½¿ç”¨ æ–¹æ³•è£…é¥°å™¨*^method-decorator^* çš„æ—¶å€™ï¼Œç”±äºæ–¹æ³•æ˜¯ç›´æ¥å®šä¹‰åœ¨ åŸå‹*^.prototype^* ä¸Šçš„ï¼Œå› æ­¤ä¿®æ”¹æœ‰æ•ˆã€‚\nMethod^æ–¹æ³•è£…é¥°å™¨^ è£…é¥°å™¨ä¸ä»…å¯ä»¥è£…é¥°ç±»ï¼Œè¿˜å¯ä»¥è£…é¥°ç±»çš„æ–¹æ³•ã€‚\n// lib.es5.d.ts declare type MethodDecorator = \u0026lt;T\u0026gt;( target: // è¢«è£…é¥°çš„ç±» Object, propertyKey: //è¢«è£…é¥°ç±»çš„æ–¹æ³•å string | symbol, descriptor: // å±æ€§æè¿°ç¬¦ TypedPropertyDescriptor\u0026lt;T\u0026gt; ) =\u0026gt; TypedPropertyDescriptor\u0026lt;T\u0026gt; | void; å¦å¤–ï¼Œä¸Šé¢ä»£ç è¯´æ˜ï¼Œè£…é¥°å™¨*^readonly^* å¯ä»¥é€šè¿‡ä¿®æ”¹ æè¿°å¯¹è±¡*^descriptor^* çš„å€¼è¾¾åˆ°ä¿®æ”¹å±æ€§çš„æ–¹æ³•*^method^* ï¼Œæ³¨æ„æè¿°å¯¹è±¡æ­¤æ—¶æ˜¯å­˜å‚¨åœ¨ åŸå‹é“¾*^prototype^* ä¸Šçš„ã€‚\n:page_with_curl: Example ä½¿ç”¨ @decorator å®ç° logger\nfunction log(target: Object, propertyKey: string, descriptor: PropertyDescriptor) { let originalMethod = descriptor.value; descriptor.value = function (...args: any[]) { console.log(\u0026#34;wrapped function: before invoking \u0026#34; + propertyKey); let result = originalMethod.apply(this, args); console.log(\u0026#34;wrapped function: after invoking \u0026#34; + propertyKey); return result; }; } class Task { @(log as MethodDecorator) runTask(arg: any): any { console.log(\u0026#34;runTask invoked, args: \u0026#34; + arg); return \u0026#34;finished\u0026#34;; } } let task = new Task(); let result = task.runTask(\u0026#34;learn ts\u0026#34;); console.log(\u0026#34;result: \u0026#34; + result); // wrapped function: before invoking runTask // runTask invoked, args: learn ts // wrapped function: after invoking runTask // result: finished :page_with_curl: Example ä½¿ç”¨ Proxy å®ç° logger\nProxy å’Œ @decorator åŒºåˆ«ï¼š\nProxy åªèƒ½å®ç°â€œçœ¼å‰â€ï¼Œçœ‹ä¸é•¿è¿œï¼ˆè¦ä¹ˆä»£ç† functionï¼Œè¦ä¹ˆä»£ç† classï¼‰ï¼Œä¸èƒ½åŒæ—¶ä»£ç† @decorator å¯ä»¥é€šè¿‡ target å’Œ propKey åŒæ—¶è·å¾— class å’Œ functionä½œä¸ºprototypeè¢«ä¿®æ”¹ ï¼Œä»¥åŠé€šè¿‡ descriptor è·å– function æš´éœ²çš„å±æ€§æè¿°ç¬¦ï¼Œå¯ä»¥åœ¨è¿è¡Œä¹‹å‰é€šè¿‡ é’©å­*^hook^* ä¿®æ”¹ å€¼*^descriptor.value^* æ’å…¥ class Task { runTask(arg: any): string { console.log(`runTask invoked, args:${arg}`); return \u0026#34;finished\u0026#34;; } } // log é€šè¿‡Proxyçš„applyå®ç°äº†@decoratorçš„æ•ˆæœ // åŒºåˆ«æ˜¯decoratoræ˜¯ç¼–è¯‘æ—¶å°±ä¿®æ”¹å†…å®¹ï¼Œè€Œproxyè¦åˆ°è¿è¡Œæ—¶ const log = (targetFunction) =\u0026gt; new Proxy(targetFunction, { apply\u0026lt;F extends Function\u0026gt;(target: F, thisArg: Object, argArray: Array\u0026lt;any\u0026gt;) { console.log(\u0026#34;wrapped function: before invoking \u0026#34; + target.name); let result = Reflect.apply(target, thisArg, argArray); console.log(\u0026#34;wrapped function: after invoking \u0026#34; + target.name); return result; } }); let task = new Task(); let logFn = log(task.runTask); let result = logFn(\u0026#39;foo\u0026#39;); console.log(\u0026#34;result: \u0026#34; + result); // wrapped function: before invoking runTask // runTask invoked, args:foo // wrapped function: after invoking runTask // result: finished Parameter^å‚æ•°è£…é¥°å™¨^ declare type ParameterDecorator = ( target: // è¢«è£…é¥°çš„ç±» Object, propertyKey: // æ–¹æ³•å string | symbol, parameterIndex: // æ–¹æ³•ä¸­å‚æ•°çš„ç´¢å¼•å€¼ number ) =\u0026gt; void; :exclamation:Warning ä¸è¦ä½¿ç”¨ï¼š\nç”±äºä¼ å…¥çš„ä¸‰ä¸ªå‚æ•° target, key, parameterIndex éƒ½æ— æ³•å¯¹å½¢å‚è¿›è¡Œå®è´¨æ€§ä¿®æ”¹ï¼Œä¸”æ˜¯æœ€æ—©è¿è¡Œçš„ï¼Œå› æ­¤éå¸¸é¸¡è‚‹ã€‚\nfunction Log(target: Function, key: string, parameterIndex: number):void { console.log(key); let functionLogged = key || target.prototype.constructor.name; console.log(`The parameter in position ${parameterIndex} at ${functionLogged} has been decorated`); } class Greeter { greeting: string; constructor(@(Log as ParameterDecorator) phrase: string) { this.greeting = phrase; } } Usage^åº”ç”¨^ è£…é¥°å™¨æœ‰æ³¨é‡Šçš„ä½œç”¨ã€‚\n:page_with_curl: Example 1\nconst testableList = new Set(); let testable = \u0026lt;TFunction extends Function\u0026gt;(target: TFunction): void =\u0026gt; { testableList.add(target.name); }; let readonly = \u0026lt;T\u0026gt;(target: Object, propertyKey: string | symbol, descriptor: TypedPropertyDescriptor\u0026lt;T\u0026gt;): void =\u0026gt; { Reflect.defineProperty(target, propertyKey, { writable: false }); }; let nonEnumAble = \u0026lt;T\u0026gt;(target: Object, propertyKey: string | symbol, descriptor: TypedPropertyDescriptor\u0026lt;T\u0026gt;): void =\u0026gt; { Reflect.defineProperty(target, propertyKey, { enumerable: false }); }; @(testable as ClassDecorator) // @testable class Person { #name @(readonly as MethodDecorator) @(nonEnumAble as MethodDecorator) // @readonly // @nonEnumAble name() { return this.#name; } } console.log([...testableList]); // [ \u0026#39;Person\u0026#39; ] console.log(Reflect.getOwnPropertyDescriptor(Person, \u0026#39;name\u0026#39;)); // { // value: \u0026#39;Person\u0026#39;, // writable: false, // enumerable: false, // configurable: true // } ä»ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¸€çœ¼å°±èƒ½çœ‹å‡ºï¼ŒPerson ç±»æ˜¯å¯æµ‹è¯•çš„ï¼Œè€Œ name æ–¹æ³•æ˜¯åªè¯»å’Œä¸å¯æšä¸¾çš„ã€‚\nä¸‹é¢æ˜¯ä½¿ç”¨ Decorator å†™æ³•çš„ç»„ä»¶ï¼Œçœ‹ä¸Šå»ä¸€ç›®äº†ç„¶ã€‚\n@Component({ tag: \u0026#39;my-component\u0026#39;, styleUrl: \u0026#39;my-component.scss\u0026#39; }) export class MyComponent { @Prop() first: string; @Prop() last: string; @State() isVisible: boolean = true; render() { return ( \u0026lt;p\u0026gt;Hello, my name is {this.first} {this.last}\u0026lt;/p\u0026gt; ); } } å¦‚æœåŒä¸€ä¸ªæ–¹æ³•æœ‰å¤šä¸ªè£…é¥°å™¨ï¼Œä¼šåƒå‰¥æ´‹è‘±ä¸€æ ·ï¼Œå…ˆä»å¤–åˆ°å†…è¿›å…¥ï¼Œç„¶åç”±å†…å‘å¤–æ‰§è¡Œã€‚\nfunction dec(id): MethodDecorator { console.log(\u0026#39;evaluated\u0026#39;, id); return function (target) { console.log(\u0026#39;executed\u0026#39;, id); } } class Example { @dec(1) @dec(2) method(){} } // evaluated 1 // evaluated 2 // executed 2 // executed 1 ä¸Šé¢ä»£ç ä¸­ï¼Œå¤–å±‚è£…é¥°å™¨ @dec(1) å…ˆè¿›å…¥ï¼Œä½†æ˜¯å†…å±‚è£…é¥°å™¨ @dec(2) å…ˆæ‰§è¡Œã€‚\nCompile^ç¼–è¯‘^ TypeScript é€šè¿‡ tsconfig.json ä¿®æ”¹ç¼–è¯‘é€‰é¡¹ï¼Œå¯ä»¥ï¼š\nç”¨äºæ ‡è¯† TypeScript é¡¹ç›®çš„æ ¹è·¯å¾„ ç”¨äºé…ç½® TypeScript ç¼–è¯‘å™¨ ç”¨äºæŒ‡å®šç¼–è¯‘çš„æ–‡ä»¶ Field^é‡è¦å­—æ®µ^ files - è®¾ç½®è¦ç¼–è¯‘çš„æ–‡ä»¶çš„åç§° include - è®¾ç½®éœ€è¦è¿›è¡Œç¼–è¯‘çš„æ–‡ä»¶ï¼Œæ”¯æŒè·¯å¾„æ¨¡å¼åŒ¹é… exclude - è®¾ç½®æ— éœ€è¿›è¡Œç¼–è¯‘çš„æ–‡ä»¶ï¼Œæ”¯æŒè·¯å¾„æ¨¡å¼åŒ¹é… compilerOptions - è®¾ç½®ä¸ç¼–è¯‘æµç¨‹ç›¸å…³çš„é€‰é¡¹ CompilerOptions^é€‰é¡¹^ compilerOptions æ”¯æŒå¾ˆå¤šé€‰é¡¹ï¼Œå¸¸è§çš„æœ‰ baseUrlã€ targetã€baseUrlã€ moduleResolution å’Œ lib ç­‰ã€‚\ncompilerOptions æ¯ä¸ªé€‰é¡¹çš„è¯¦ç»†è¯´æ˜å¦‚ä¸‹ï¼š\n{ \u0026#34;compilerOptions\u0026#34;: { /* åŸºæœ¬é€‰é¡¹ */ \u0026#34;target\u0026#34;: \u0026#34;es5\u0026#34;, // æŒ‡å®š ECMAScript ç›®æ ‡ç‰ˆæœ¬: \u0026#39;ES3\u0026#39; (default), \u0026#39;ES5\u0026#39;, \u0026#39;ES6\u0026#39;/\u0026#39;ES2015\u0026#39;, \u0026#39;ES2016\u0026#39;, \u0026#39;ES2017\u0026#39;, or \u0026#39;ESNEXT\u0026#39; \u0026#34;module\u0026#34;: \u0026#34;commonjs\u0026#34;, // æŒ‡å®šä½¿ç”¨æ¨¡å—: \u0026#39;commonjs\u0026#39;, \u0026#39;amd\u0026#39;, \u0026#39;system\u0026#39;, \u0026#39;umd\u0026#39; or \u0026#39;es2015\u0026#39; \u0026#34;lib\u0026#34;: [], // æŒ‡å®šè¦åŒ…å«åœ¨ç¼–è¯‘ä¸­çš„åº“æ–‡ä»¶ \u0026#34;allowJs\u0026#34;: true, // å…è®¸ç¼–è¯‘ javascript æ–‡ä»¶ \u0026#34;checkJs\u0026#34;: true, // æŠ¥å‘Š javascript æ–‡ä»¶ä¸­çš„é”™è¯¯ \u0026#34;jsx\u0026#34;: \u0026#34;preserve\u0026#34;, // æŒ‡å®š jsx ä»£ç çš„ç”Ÿæˆ: \u0026#39;preserve\u0026#39;, \u0026#39;react-native\u0026#39;, or \u0026#39;react\u0026#39; \u0026#34;declaration\u0026#34;: true, // ç”Ÿæˆç›¸åº”çš„ \u0026#39;.d.ts\u0026#39; æ–‡ä»¶ \u0026#34;sourceMap\u0026#34;: true, // ç”Ÿæˆç›¸åº”çš„ \u0026#39;.map\u0026#39; æ–‡ä»¶ \u0026#34;outFile\u0026#34;: \u0026#34;./\u0026#34;, // å°†è¾“å‡ºæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶ \u0026#34;outDir\u0026#34;: \u0026#34;./\u0026#34;, // æŒ‡å®šè¾“å‡ºç›®å½• \u0026#34;rootDir\u0026#34;: \u0026#34;./\u0026#34;, // ç”¨æ¥æ§åˆ¶è¾“å‡ºç›®å½•ç»“æ„ --outDir. \u0026#34;removeComments\u0026#34;: true, // åˆ é™¤ç¼–è¯‘åçš„æ‰€æœ‰çš„æ³¨é‡Š \u0026#34;noEmit\u0026#34;: true, // ä¸ç”Ÿæˆè¾“å‡ºæ–‡ä»¶ \u0026#34;importHelpers\u0026#34;: true, // ä» tslib å¯¼å…¥è¾…åŠ©å·¥å…·å‡½æ•° \u0026#34;isolatedModules\u0026#34;: true, // å°†æ¯ä¸ªæ–‡ä»¶åšä¸ºå•ç‹¬çš„æ¨¡å— ï¼ˆä¸ \u0026#39;ts.transpileModule\u0026#39; ç±»ä¼¼ï¼‰. /* ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥é€‰é¡¹ */ \u0026#34;strict\u0026#34;: true, // å¯ç”¨æ‰€æœ‰ä¸¥æ ¼ç±»å‹æ£€æŸ¥é€‰é¡¹ \u0026#34;noImplicitAny\u0026#34;: true, // åœ¨è¡¨è¾¾å¼å’Œå£°æ˜ä¸Šæœ‰éšå«çš„ anyç±»å‹æ—¶æŠ¥é”™ \u0026#34;strictNullChecks\u0026#34;: true, // å¯ç”¨ä¸¥æ ¼çš„ null æ£€æŸ¥ \u0026#34;noImplicitThis\u0026#34;: true, // å½“ this è¡¨è¾¾å¼å€¼ä¸º any ç±»å‹çš„æ—¶å€™ï¼Œç”Ÿæˆä¸€ä¸ªé”™è¯¯ \u0026#34;alwaysStrict\u0026#34;: true, // ä»¥ä¸¥æ ¼æ¨¡å¼æ£€æŸ¥æ¯ä¸ªæ¨¡å—ï¼Œå¹¶åœ¨æ¯ä¸ªæ–‡ä»¶é‡ŒåŠ å…¥ \u0026#39;use strict\u0026#39; /* é¢å¤–çš„æ£€æŸ¥ */ \u0026#34;noUnusedLocals\u0026#34;: true, // æœ‰æœªä½¿ç”¨çš„å˜é‡æ—¶ï¼ŒæŠ›å‡ºé”™è¯¯ \u0026#34;noUnusedParameters\u0026#34;: true, // æœ‰æœªä½¿ç”¨çš„å‚æ•°æ—¶ï¼ŒæŠ›å‡ºé”™è¯¯ \u0026#34;noImplicitReturns\u0026#34;: true, // å¹¶ä¸æ˜¯æ‰€æœ‰å‡½æ•°é‡Œçš„ä»£ç éƒ½æœ‰è¿”å›å€¼æ—¶ï¼ŒæŠ›å‡ºé”™è¯¯ \u0026#34;noFallthroughCasesInSwitch\u0026#34;: true, // æŠ¥å‘Š switch è¯­å¥çš„ fallthrough é”™è¯¯ã€‚ï¼ˆå³ï¼Œä¸å…è®¸ switch çš„ case è¯­å¥è´¯ç©¿ï¼‰ /* æ¨¡å—è§£æé€‰é¡¹ */ \u0026#34;moduleResolution\u0026#34;: \u0026#34;node\u0026#34;, // é€‰æ‹©æ¨¡å—è§£æç­–ç•¥ï¼š \u0026#39;node\u0026#39; (Node.js) or \u0026#39;classic\u0026#39; (TypeScript pre-1.6) \u0026#34;baseUrl\u0026#34;: \u0026#34;./\u0026#34;, // ç”¨äºè§£æéç›¸å¯¹æ¨¡å—åç§°çš„åŸºç›®å½• \u0026#34;paths\u0026#34;: {}, // æ¨¡å—ååˆ°åŸºäº baseUrl çš„è·¯å¾„æ˜ å°„çš„åˆ—è¡¨ \u0026#34;rootDirs\u0026#34;: [], // æ ¹æ–‡ä»¶å¤¹åˆ—è¡¨ï¼Œå…¶ç»„åˆå†…å®¹è¡¨ç¤ºé¡¹ç›®è¿è¡Œæ—¶çš„ç»“æ„å†…å®¹ \u0026#34;typeRoots\u0026#34;: [], // åŒ…å«ç±»å‹å£°æ˜çš„æ–‡ä»¶åˆ—è¡¨ \u0026#34;types\u0026#34;: [], // éœ€è¦åŒ…å«çš„ç±»å‹å£°æ˜æ–‡ä»¶ååˆ—è¡¨ \u0026#34;allowSyntheticDefaultImports\u0026#34;: true, // å…è®¸ä»æ²¡æœ‰è®¾ç½®é»˜è®¤å¯¼å‡ºçš„æ¨¡å—ä¸­é»˜è®¤å¯¼å…¥ã€‚ /* Source Map Options */ \u0026#34;sourceRoot\u0026#34;: \u0026#34;./\u0026#34;, // æŒ‡å®šè°ƒè¯•å™¨åº”è¯¥æ‰¾åˆ° TypeScript æ–‡ä»¶è€Œä¸æ˜¯æºæ–‡ä»¶çš„ä½ç½® \u0026#34;mapRoot\u0026#34;: \u0026#34;./\u0026#34;, // æŒ‡å®šè°ƒè¯•å™¨åº”è¯¥æ‰¾åˆ°æ˜ å°„æ–‡ä»¶è€Œä¸æ˜¯ç”Ÿæˆæ–‡ä»¶çš„ä½ç½® \u0026#34;inlineSourceMap\u0026#34;: true, // ç”Ÿæˆå•ä¸ª soucemaps æ–‡ä»¶ï¼Œè€Œä¸æ˜¯å°† sourcemaps ç”Ÿæˆä¸åŒçš„æ–‡ä»¶ \u0026#34;inlineSources\u0026#34;: true, // å°†ä»£ç ä¸ sourcemaps ç”Ÿæˆåˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè¦æ±‚åŒæ—¶è®¾ç½®äº† --inlineSourceMap æˆ– --sourceMap å±æ€§ /* å…¶ä»–é€‰é¡¹ */ \u0026#34;experimentalDecorators\u0026#34;: true, // å¯ç”¨è£…é¥°å™¨ \u0026#34;emitDecoratorMetadata\u0026#34;: true // ä¸ºè£…é¥°å™¨æä¾›å…ƒæ•°æ®çš„æ”¯æŒ } } Module^æ¨¡å—^ Solve - Cannot find module \u0026lsquo;fs\u0026rsquo; Error in TypeScript | bobbyhadz\nExcerpt To solve the \u0026ldquo;Cannot find module fs or its corresponding type declarations\u0026rdquo; error, install the types for node by running the command npm i -D @types/node. You can then import fs with the following line of code import * as fs from 'fs'.\nSolve - Cannot find module \u0026lsquo;fs\u0026rsquo; Error in TypeScript #\nTo solve the \u0026ldquo;Cannot find module fs or its corresponding type declarations\u0026rdquo; error, install the types for node by running the command npm i -D @types/node. You can then import fs with the following line of code import * as fs from 'fs'.\nMake sure to install the typings for node, by opening your terminal in your project\u0026rsquo;s root directory and running the following command:\nCopied!npm i -D @types/node This will install the typings for node as a dev dependency in your project.\nNow you are able to import the fs module with the following line of code.\nCopied!import * as fs from \u0026#39;fs\u0026#39;; console.log(fs); If your error has not been resolved, open your tsconfig.json file and make sure the types array contains the string node.\nCopied!{ \u0026#34;compilerOptions\u0026#34;: { \u0026#34;types\u0026#34;: [ \u0026#34;node\u0026#34; ] }, } This should fix the error and now TypeScript should be able to find the type definitions for the fs module.\nIf the error is not resolved, try to delete your node_modules and package-lock.json files, re-run npm install and restart your IDE.\nCopied!rm -rf node_modules package-lock.json npm install Make sure to restart your IDE if the error still persists. VSCode glitches often and a reboot solves things sometimes.\nHere is an example of how you would read a file in the same directory named another-file.ts with the fs module using TypeScript.\nCopied!import * as fs from \u0026#39;fs\u0026#39;; import * as path from \u0026#39;path\u0026#39;; console.log( fs.readFileSync(path.join(__dirname, \u0026#39;./another-file.ts\u0026#39;), { encoding: \u0026#39;utf-8\u0026#39;, }), ); And here is the output in my terminal showing the contents of another-file.ts.\nTricks^æŠ€å·§^ åœ¨çº¿å·¥å…· :link: Href TypeScript Playground\nTypeScript å®˜æ–¹æä¾›çš„åœ¨çº¿ TypeScript è¿è¡Œç¯å¢ƒï¼Œåˆ©ç”¨å®ƒä½ å¯ä»¥æ–¹ä¾¿åœ°å­¦ä¹  TypeScript ç›¸å…³çŸ¥è¯†ä¸ä¸åŒç‰ˆæœ¬çš„åŠŸèƒ½ç‰¹æ€§ã€‚\n:link: Href TypeScript UML Playground\nä¸€æ¬¾åœ¨çº¿ TypeScript UML å·¥å…·ï¼Œåˆ©ç”¨å®ƒä½ å¯ä»¥ä¸ºæŒ‡å®šçš„ TypeScript ä»£ç ç”Ÿæˆ UML ç±»å›¾ã€‚\n:link: Href JSON TO TS\nä¸ºæŒ‡å®šçš„ JSON æ•°æ®ç”Ÿæˆå¯¹åº”çš„ TypeScript æ¥å£å®šä¹‰ã€‚\n:link: Href Schemats\nåŸºäº SQL ^(Postgres,MySQL)^ æ•°æ®åº“ä¸­çš„ schema å­—æ®µè‡ªåŠ¨ç”Ÿæˆ TypeScript æ¥å£å®šä¹‰ã€‚\n:link: Href TypeScript AST Viewer\nä¸€æ¬¾ TypeScript AST åœ¨çº¿å·¥å…·ï¼Œåˆ©ç”¨å®ƒä½ å¯ä»¥æŸ¥çœ‹æŒ‡å®š TypeScript ä»£ç å¯¹åº”çš„ ASTAbstract Syntax Tree æŠ½è±¡è¯­æ³•æ ‘ã€‚\n:link: Href TypeDoc\nTypeDoc ç”¨äºå°† TypeScript æºä»£ç ä¸­çš„æ³¨é‡Šè½¬æ¢ä¸º HTML æ–‡æ¡£æˆ– JSON æ¨¡å‹ã€‚å®ƒå¯çµæ´»æ‰©å±•ï¼Œå¹¶æ”¯æŒå¤šç§é…ç½®ã€‚\n:link: Href TypeScript ESLint\nä½¿ç”¨ TypeScript ESLint (TSLint) å¯ä»¥å¸®åŠ©æˆ‘ä»¬è§„èŒƒä»£ç è´¨é‡ï¼Œæé«˜å›¢é˜Ÿå¼€å‘æ•ˆç‡ã€‚\nå®Œæ•´æ€§æ£€æŸ¥ ","date":"2023-03-20","section":"techs","summary":"Typescript TypeS*cript* - TS ï¼Œæ˜¯ä¸€ç§ç”±å¾®è½¯å¼€å‘çš„è‡ªç”±å’Œå¼€æºçš„ç¼–ç¨‹è¯­è¨€ã€‚\nflowchart LR %%--level 1 0(\u0026#34;Typescript\u0026#34;) 1[\u0026#34;TSæ˜¯ä»€ä¹ˆ\u0026#34;] 2[\u0026#34;TSçš„åŸºæœ¬æ•°æ®ç±»å‹\u0026#34;] 3[\u0026#34;Class\u0026#34;] 4[\u0026#34;æ–­è¨€ä¸ç±»å‹å®ˆå«\u0026#34;] 5[\u0026#34;èŒƒå‹\u0026#34;] 6[\u0026#34;\u0026lt;ruby\u0026gt;è”åˆç±»å‹\u0026lt;rt\u0026gt;Union Type\u0026lt;/rt\u0026gt;\u0026lt;/ruby\u0026gt;\u0026#34;] 7[\u0026#34;åˆ«åä¸æ¥å£\u0026#34;] 8[\u0026#34;å¸¸ç”¨æŠ€å·§\u0026#34;] %%--level 0 relation 1---0;2---0;3---0;4---0; 0---5;0---6;0---7;0---8 subgraph \u0026amp;nbsp %%--level 1 1.1[\u0026#34;TSå’ŒJSçš„å…³ç³»\u0026#34;] 1.2[\u0026#34;å®‰è£…TS\u0026#34;] 1.3[\u0026#34;ç¼–è¯‘\u0026#34;] %%--level 1 relation 1.1---1;1.2---1;1.3---1 %%--level 2 2.1[\u0026#34;åŸºæœ¬ç±»å‹\u0026#34;] 2.2[\u0026#34;å¼•ç”¨ç±»å‹\u0026#34;] 2.3[\u0026#34;ç‰¹æ®Šç±»å‹\u0026#34;] 2.4[\u0026#34;å…¶å®ƒç±»å‹\u0026#34;] %%--level 2 relation 2.1---2;2.2---2;2.3---2;2.4---2; %%--level 3 3.1[\u0026#34;åŸºæœ¬æ–¹æ³•\u0026#34;] 3.2[\u0026#34;ç§æœ‰å­—æ®µ\u0026#34;] 3.3[\u0026#34;åªè¯»å±æ€§\u0026#34;] 3.4[\u0026#34;ç»§æ‰¿\u0026#34;] 3.5[\u0026#34;ä¿®é¥°ç¬¦\u0026#34;] 3.6[\u0026#34;abstract\u0026#34;] 3.7[\u0026#34;é‡å†™ä¸é‡è½½\u0026#34;] %%--level 3 relation 3.1---3;3.2---3;3.3---3;3.4---3;3.5---3;3.6---3;3.7---3; %%--level 4 4.1[\u0026#34;TSæ–­è¨€\u0026#34;] 4.2[\u0026#34;ç±»å‹å®ˆå«\u0026#34;] %%--level 4 relation 4.1---4;4.2---4; end subgraph \u0026amp;nbsp\u0026amp;nbsp %%--level 5 5.1[\u0026#34;è¯­æ³•\u0026#34;] 5.2[\u0026#34;å¤šç±»å‹ä¼ å‚\u0026#34;] 5.3[\u0026#34;æ¥å£\u0026#34;] 5.4[\u0026#34;ç±»\u0026#34;] 5.5[\u0026#34;ç±»åˆ«å\u0026#34;] 5.6[\u0026#34;é»˜è®¤å‚æ•°\u0026#34;] 5.7[\u0026#34;å¸¸ç”¨å­—æ¯\u0026#34;] %%--level 5 relation 5---5.1;5---5.2;5---5.3;5---5.4;5---5.5;5---5.6;5---5.7 %%--level 6 6.1[\u0026#34;å¯è¾¨è¯†è”åˆ\u0026#34;] %%--level 6 relation 6---6.1 %%--level 7 7.1[\u0026#34;ç±»å‹åˆ«å\u0026#34;] 7.2[\u0026#34;æ¥å£\u0026#34;] 7.3[\u0026#34;typeå’ŒinterfaceåŒºåˆ«\u0026#34;] %%--level 7 relation 7---7.1;7---7.2;7---7.3 %%--level 8 8.1[\u0026#34;extends\u0026#34;] 8.2[\u0026#34;tepeof\u0026#34;] 8.3[\u0026#34;keyof\u0026#34;] 8.4[\u0026#34;ç´¢å¼•è®¿é—®æ“ä½œç¬¦\u0026#34;] 8.5[\u0026#34;in\u0026#34;] 8.6[\u0026#34;infer\u0026#34;] 8.7[\u0026#34;...\u0026#34;] %%--level 8 relation 8---8.1;8---8.2;8---8.3;8---8.4;8---8.5;8---8.6;8---8.7 end classDef transparent fill:none,stroke:none class \u0026amp;nbsp,\u0026amp;nbsp\u0026amp;nbsp transparent TypeScript æ˜¯ JavaScript çš„ è¶…é›† ï¼Œç®€å•çš„è¯´å°±æ˜¯åœ¨ JavaScript çš„åŸºç¡€ä¸ŠåŠ å…¥äº† ç±»å‹ç³»ç»Ÿtype systemï¼Œè®©æ¯ä¸ªå‚æ•°éƒ½æœ‰æ˜ç¡®çš„æ„ä¹‰ï¼Œä»è€Œå¸¦æ¥äº†æ›´åŠ  æ™ºèƒ½ çš„æç¤ºã€‚\n","title":"07 TypeScript","url":"/techs/07-typescript/"},{"content":"Async JS çš„ç²¾é«“åœ¨äºå¼‚æ­¥ã€‚\nå¼‚æ­¥é€šä¿¡ Pubsub å‘å¸ƒè®¢é˜…æ¨¡å¼publishâ€“subscribe pattern ä¸­æŒ‡çš„æ˜¯å‡½æ•°è‡ªåŠ¨è§‚å¯Ÿæ•°æ®å¯¹è±¡ï¼Œä¸€æ—¦å¯¹è±¡æœ‰å˜åŒ–ï¼Œå‡½æ•°å°±ä¼šè‡ªåŠ¨æ‰§è¡Œï¼ŒåŒ…å« å‘å¸ƒè€…publishersï¼Œäº‹ä»¶è°ƒåº¦ä¸­å¿ƒmessage broker/event bus ï¼Œè®¢é˜…è€…subscribers ä¸‰ä¸ªè§’è‰²ã€‚\nè¿™ç§æ¨¡å¼å¸¸å¸¸ç”¨æ¥ è§£è€¦ ä¸šåŠ¡é€»è¾‘ï¼Œäº‹ä»¶å‘å¸ƒè€…æ— é¡»å…³æ³¨è®¢é˜…çš„ä¾¦å¬å™¨å¦‚ä½•å®ç°ä¸šåŠ¡é€»è¾‘ï¼Œç”šè‡³ä¸ç”¨å…³æ³¨æœ‰å¤šå°‘ä¸ªä¾¦å¬å™¨å­˜åœ¨ï¼Œæ•°æ®é€šè¿‡æ¶ˆæ¯çš„æ–¹å¼å¯ä»¥å¾ˆçµæ´»åœ°ä¼ é€’ã€‚\nåœ¨ä¸€äº›å…¸å‹åœºæ™¯ä¸­ï¼Œå¯ä»¥é€šè¿‡äº‹ä»¶å‘å¸ƒ/è®¢é˜…æ¨¡å¼è¿›è¡Œç»„ä»¶ å°è£…^package^ ï¼Œå°†ä¸å˜çš„éƒ¨åˆ†å°è£…åœ¨ç»„ä»¶å†…éƒ¨ï¼Œå°†å®¹æ˜“å˜åŒ–ã€éœ€è‡ªå®šä¹‰çš„éƒ¨åˆ†é€šè¿‡äº‹ä»¶æš´éœ²ç»™å¤–éƒ¨å¤„ç†ï¼Œè¿™æ˜¯ä¸€ç§å…¸å‹çš„ é€»è¾‘åˆ†ç¦» æ–¹å¼ã€‚\nåœ¨è¿™ç§ç»„ä»¶ä¸­ï¼Œäº‹ä»¶çš„è®¾è®¡éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒå…³ä¹å¤–éƒ¨è°ƒç”¨ç»„ä»¶æ—¶æ˜¯å¦ä¼˜é›…ï¼Œä»æŸç§è§’åº¦æ¥è¯´äº‹ä»¶çš„è®¾è®¡å°±æ˜¯ç»„ä»¶çš„æ¥å£è®¾è®¡ã€‚\nå‘å¸ƒè€…å’Œè®¢é˜…è€…æ˜¯æ¾æ•£è€¦åˆçš„ï¼Œäº’ä¸å…³å¿ƒå¯¹æ–¹ï¼Œå…³æ³¨çš„æ˜¯äº‹ä»¶æœ¬èº« å‘å¸ƒè€…é€šè¿‡äº‹ä»¶è°ƒåº¦ä¸­å¿ƒæä¾›çš„ publish æ–¹æ³•è¿›è¡Œäº‹ä»¶å‘å¸ƒæ“ä½œï¼Œå¹¶ä¸å…³å¿ƒæ˜¯å¦æœ‰äººè®¢é˜… è®¢é˜…è€…é€šè¿‡äº‹ä»¶è°ƒåº¦ä¸­å¿ƒæä¾›çš„ subscribe æ–¹æ³•è¿›è¡Œäº‹ä»¶è®¢é˜…æ“ä½œï¼Œå¹¶ä¸å…³å¿ƒæ˜¯å¦æœ‰äººå‘å¸ƒäº‹ä»¶ï¼Œä½†åªè¦è‡ªå·±è®¢é˜…çš„äº‹ä»¶å‘ç”Ÿäº†ï¼Œå°±åšå‡ºå“åº” ç‰¹ç‚¹\nå‘å¸ƒè®¢é˜…æ¨¡å¼ä¸­ï¼Œå¯¹äºå‘å¸ƒè€… Publisher å’Œè®¢é˜…è€… Subscriber æ²¡æœ‰ç‰¹æ®Šçš„çº¦æŸï¼Œä»–ä»¬å¥½ä¼¼æ˜¯åŒ¿åæ´»åŠ¨ï¼Œå€ŸåŠ©äº‹ä»¶è°ƒåº¦ä¸­å¿ƒæä¾›çš„æ¥å£å‘å¸ƒå’Œè®¢é˜…äº‹ä»¶ï¼Œäº’ä¸äº†è§£å¯¹æ–¹æ˜¯è° æ¾æ•£è€¦åˆï¼Œçµæ´»åº¦é«˜ï¼Œå¸¸ç”¨ä½œäº‹ä»¶æ€»çº¿ æ˜“ç†è§£ï¼Œå¯ç±»æ¯”äº DOM äº‹ä»¶ä¸­çš„ dispatchEvent å’ŒaddEventListener ã€‚ ç¼ºç‚¹\nå½“äº‹ä»¶ç±»å‹è¶Šæ¥è¶Šå¤šæ—¶ï¼Œéš¾ä»¥ç»´æŠ¤ï¼Œéœ€è¦è€ƒè™‘äº‹ä»¶å‘½åçš„è§„èŒƒï¼Œä¹Ÿè¦é˜²èŒƒæ•°æ®æµæ··ä¹±ã€‚\nclass EventEmitter { constructor() { this.handler = Object.create(null); // å­˜å‚¨å¯¹è±¡-å¤„ç†å‡½æ•°æ•°ç»„ } on(evt, fn) { if (typeof fn !== \u0026#39;function\u0026#39;) throw new TypeError; if (!this.handler[evt]) this.handler[evt] = []; this.handler[evt].push(fn); } emit(evt, ...args) { if (!this.handler[evt]) return false; this.handler[evt].map(fn =\u0026gt; { Reflect.apply(fn, this, args); // ç›¸å½“äºfn.call(this, args) }); } } let ee = new EventEmitter(); ee.on(\u0026#39;foo\u0026#39;, function(arg) { console.log(`${arg} called`); }) // foo called // NOTE: ä½¿ç”¨ç®­å¤´å‡½æ•°ä¼šå¯¼è‡´æ— æ³•ç»‘å®šthis ee.emit(\u0026#39;foo\u0026#39;, \u0026#39;foo\u0026#39;); æœ‰äº†ç®€å•ç‰ˆæœ¬çš„ EventEmitter ï¼Œå°±å¯ä»¥ä¸ç”¨ä¾èµ–ç¬¬ä¸‰æ–¹åº“ã€‚vue çš„å®ç°å¦‚ä¸‹ï¼š\nconst ee = new Vue(); ee.$on(\u0026#39;foo\u0026#39;, args =\u0026gt; console.log(args)); ee.$emit(\u0026#39;foo\u0026#39;,\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;); æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å•ç‹¬ new ä¸€ä¸ª Vue çš„å®ä¾‹ï¼Œä½œä¸ºäº‹ä»¶ç®¡ç†å™¨å¯¼å‡ºç»™å¤–éƒ¨ä½¿ç”¨ã€‚\nå…¶å®ä»”ç»†çœ‹çœ‹ï¼ŒEventEmitter å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„ å‘å¸ƒè®¢é˜…publishâ€“subscribe æ¨¡å¼ï¼Œå®ç°äº†äº‹ä»¶è°ƒåº¦ä¸­å¿ƒã€‚\nåˆšåˆšå®ç°çš„ EventEmitter çš„ä¸€ä¸ªå®ä¾‹ ee å°±æ˜¯ä¸€ä¸ªäº‹ä»¶è°ƒåº¦ä¸­å¿ƒï¼Œå‘å¸ƒè€…å’Œè®¢é˜…è€…æ˜¯ æ¾æ•£è€¦åˆloosely coupled çš„ï¼Œäº’ä¸å…³å¿ƒå¯¹æ–¹æ˜¯å¦å­˜åœ¨ï¼Œä»–ä»¬å…³æ³¨çš„æ˜¯äº‹ä»¶æœ¬èº«ã€‚å‘å¸ƒè€…å€Ÿç”¨äº‹ä»¶è°ƒåº¦ä¸­å¿ƒæä¾›çš„ emit æ–¹æ³•å‘å¸ƒäº‹ä»¶ï¼Œè€Œè®¢é˜…è€…åˆ™é€šè¿‡ on è¿›è¡Œè®¢é˜…ã€‚\nObserver è§‚å¯Ÿè€…æ¨¡å¼observer pattern ä¸å‘å¸ƒè®¢é˜…æ¨¡å¼ç›¸æ¯”ï¼Œè€¦åˆåº¦æ›´é«˜ï¼Œé€šå¸¸ç”¨æ¥å®ç°ä¸€äº›å“åº”å¼çš„æ•ˆæœã€‚è§‚å¯Ÿè€…æ¨¡å‹ä¸­é€šå¸¸ç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼Œå³ä¸€ä¸ª è§‚å¯Ÿè€…observer å’Œä¸€ä¸ª ç›®æ ‡å¯¹è±¡subject ã€‚ä»å­—é¢æ„æ€ä¸Šç†è§£ï¼Œå³è¢«è§‚å¯Ÿè€…å‘ç”ŸæŸäº›è¡Œä¸ºæˆ–è€…å˜åŒ–æ—¶ï¼Œä¼šé€šçŸ¥è§‚å¯Ÿè€…ï¼Œè§‚å¯Ÿè€…æ ¹æ®æ­¤è¡Œä¸ºæˆ–è€…å˜åŒ–åšå‡ºå¤„ç†ã€‚\nè§‚å¯Ÿè€…observer å’Œ ç›®æ ‡å¯¹è±¡subject è€¦åˆç¨‹åº¦ç›¸å¯¹è¾ƒé«˜ è§‚å¯Ÿè€…è¦å®ç° update æ–¹æ³•ï¼Œåœ¨ç›®æ ‡å¯¹è±¡é€šçŸ¥æ›´æ–°çš„æ—¶å€™è¢«è°ƒç”¨ ç›®æ ‡å¯¹è±¡éœ€è¦ç»´æŠ¤è§‚å¯Ÿè€…åˆ—è¡¨ï¼Œåœ¨è‡ªèº«çŠ¶æ€æ”¹å˜æ—¶ï¼Œé€šè¿‡ notify() æ–¹æ³•éå†è§‚å¯Ÿè€…åˆ—è¡¨ï¼Œé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€… ç‰¹ç‚¹\nè§’è‰²å¾ˆæ˜ç¡®ï¼Œæ²¡æœ‰ äº‹ä»¶è°ƒåº¦ä¸­å¿ƒmessage broker ä½œä¸ºä¸­é—´è€…ï¼Œè§‚å¯Ÿè€…observer å’Œ ç›®æ ‡å¯¹è±¡subject éƒ½è¦å®ç°çº¦å®šçš„æˆå‘˜æ–¹æ³• ä¸¤è€… ç´§å¯†è€¦åˆtightly coupledï¼Œè§‚å¯Ÿè€…çš„ä¸»åŠ¨æ€§å¾ˆå¼ºï¼Œè‡ªå·±æ”¶é›†å’Œç»´æŠ¤è§‚å¯Ÿè€…ï¼Œå¹¶åœ¨çŠ¶æ€å˜åŒ–æ—¶ä¸»åŠ¨é€šçŸ¥ç›®æ ‡å¯¹è±¡æ›´æ–° æŒ‰ç…§è¿™ç§å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªç®€å•ç‰ˆæœ¬çš„è§‚å¯Ÿè€…æ¨¡å¼ã€‚\nclass Observer { constructor(fn) { if (typeof fn !== \u0026#39;function\u0026#39;) throw TypeError; this.fn = fn; } update(args) { Reflect.apply(this.fn, this.fn, args); } } class Subject { constructor() { this.observerList = []; } addObserver(observer) { if (!(observer instanceof Observer)) throw TypeError; this.observerList.push(observer) return this; } notify(...args) { this.observerList.map( observer =\u0026gt; observer.update(args) ); } } let obs1 = new Observer((..._) =\u0026gt; console.log(..._)); let obs2 = new Observer(function () { console.log(this); }); let sub1 = new Subject().addObserver(obs1).addObserver(obs2); let sub2 = new Subject().addObserver(obs1); sub1.notify(\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;); // foo bar [Function (anonymous)] sub2.notify({foo: \u0026#39;bar\u0026#39;}); // { foo: \u0026#39;bar\u0026#39; } äº’æ–¥é” é€šè¿‡ Promise ï¼ŒJS å¯ä»¥å®ç°äº’æ–¥é”ã€‚åˆ›å»º Mutex å¯¹è±¡ï¼Œå†…éƒ¨é€šè¿‡æ•°ç»„ä¿å­˜ä»»åŠ¡é˜Ÿåˆ—ï¼Œacquire() æ–¹æ³•æŠŠè¿›å…¥ä¸´ç•ŒåŒºè¿™ä¸€æ“ä½œ push åˆ°é˜Ÿåˆ—ä¸­ï¼›release() åˆ™ä»ä»»åŠ¡é˜Ÿåˆ—å–å‡ºæ¥æ‰§è¡Œã€‚å¦å¤–é€šè¿‡è®¾ç½® concurrency å¹¶å‘ï¼Œå¯ä»¥å®ç°é™åˆ¶åŒæ—¶è¿è¡Œçº¿ç¨‹æ•°ç›®çš„è¦æ±‚ - ç±»ä¼¼ Semaphore ã€‚\nclass Mutex { private _concurrency = 1 private _queue: Array\u0026lt;Function\u0026gt; = [] private _threads: number = 0 async acquire() { if (this._threads \u0026gt;= this._concurrency) { await new Promise(resolve =\u0026gt; this._queue.push(resolve)) } this._threads++ } release() { if (this._threads \u0026lt;= 0) return this._queue.shift()?.() this._threads-- } } export default Mutex ","date":"2023-03-20","section":"techs","summary":"Async JS çš„ç²¾é«“åœ¨äºå¼‚æ­¥ã€‚\nå¼‚æ­¥é€šä¿¡ Pubsub å‘å¸ƒè®¢é˜…æ¨¡å¼publishâ€“subscribe pattern ä¸­æŒ‡çš„æ˜¯å‡½æ•°è‡ªåŠ¨è§‚å¯Ÿæ•°æ®å¯¹è±¡ï¼Œä¸€æ—¦å¯¹è±¡æœ‰å˜åŒ–ï¼Œå‡½æ•°å°±ä¼šè‡ªåŠ¨æ‰§è¡Œï¼ŒåŒ…å« å‘å¸ƒè€…publishersï¼Œäº‹ä»¶è°ƒåº¦ä¸­å¿ƒmessage broker/event bus ï¼Œè®¢é˜…è€…subscribers ä¸‰ä¸ªè§’è‰²ã€‚\nè¿™ç§æ¨¡å¼å¸¸å¸¸ç”¨æ¥ è§£è€¦ ä¸šåŠ¡é€»è¾‘ï¼Œäº‹ä»¶å‘å¸ƒè€…æ— é¡»å…³æ³¨è®¢é˜…çš„ä¾¦å¬å™¨å¦‚ä½•å®ç°ä¸šåŠ¡é€»è¾‘ï¼Œç”šè‡³ä¸ç”¨å…³æ³¨æœ‰å¤šå°‘ä¸ªä¾¦å¬å™¨å­˜åœ¨ï¼Œæ•°æ®é€šè¿‡æ¶ˆæ¯çš„æ–¹å¼å¯ä»¥å¾ˆçµæ´»åœ°ä¼ é€’ã€‚\nåœ¨ä¸€äº›å…¸å‹åœºæ™¯ä¸­ï¼Œå¯ä»¥é€šè¿‡äº‹ä»¶å‘å¸ƒ/è®¢é˜…æ¨¡å¼è¿›è¡Œç»„ä»¶ å°è£…^package^ ï¼Œå°†ä¸å˜çš„éƒ¨åˆ†å°è£…åœ¨ç»„ä»¶å†…éƒ¨ï¼Œå°†å®¹æ˜“å˜åŒ–ã€éœ€è‡ªå®šä¹‰çš„éƒ¨åˆ†é€šè¿‡äº‹ä»¶æš´éœ²ç»™å¤–éƒ¨å¤„ç†ï¼Œè¿™æ˜¯ä¸€ç§å…¸å‹çš„ é€»è¾‘åˆ†ç¦» æ–¹å¼ã€‚\nåœ¨è¿™ç§ç»„ä»¶ä¸­ï¼Œäº‹ä»¶çš„è®¾è®¡éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒå…³ä¹å¤–éƒ¨è°ƒç”¨ç»„ä»¶æ—¶æ˜¯å¦ä¼˜é›…ï¼Œä»æŸç§è§’åº¦æ¥è¯´äº‹ä»¶çš„è®¾è®¡å°±æ˜¯ç»„ä»¶çš„æ¥å£è®¾è®¡ã€‚\nå‘å¸ƒè€…å’Œè®¢é˜…è€…æ˜¯æ¾æ•£è€¦åˆçš„ï¼Œäº’ä¸å…³å¿ƒå¯¹æ–¹ï¼Œå…³æ³¨çš„æ˜¯äº‹ä»¶æœ¬èº« å‘å¸ƒè€…é€šè¿‡äº‹ä»¶è°ƒåº¦ä¸­å¿ƒæä¾›çš„ publish æ–¹æ³•è¿›è¡Œäº‹ä»¶å‘å¸ƒæ“ä½œï¼Œå¹¶ä¸å…³å¿ƒæ˜¯å¦æœ‰äººè®¢é˜… è®¢é˜…è€…é€šè¿‡äº‹ä»¶è°ƒåº¦ä¸­å¿ƒæä¾›çš„ subscribe æ–¹æ³•è¿›è¡Œäº‹ä»¶è®¢é˜…æ“ä½œï¼Œå¹¶ä¸å…³å¿ƒæ˜¯å¦æœ‰äººå‘å¸ƒäº‹ä»¶ï¼Œä½†åªè¦è‡ªå·±è®¢é˜…çš„äº‹ä»¶å‘ç”Ÿäº†ï¼Œå°±åšå‡ºå“åº” ç‰¹ç‚¹\nå‘å¸ƒè®¢é˜…æ¨¡å¼ä¸­ï¼Œå¯¹äºå‘å¸ƒè€… Publisher å’Œè®¢é˜…è€… Subscriber æ²¡æœ‰ç‰¹æ®Šçš„çº¦æŸï¼Œä»–ä»¬å¥½ä¼¼æ˜¯åŒ¿åæ´»åŠ¨ï¼Œå€ŸåŠ©äº‹ä»¶è°ƒåº¦ä¸­å¿ƒæä¾›çš„æ¥å£å‘å¸ƒå’Œè®¢é˜…äº‹ä»¶ï¼Œäº’ä¸äº†è§£å¯¹æ–¹æ˜¯è° æ¾æ•£è€¦åˆï¼Œçµæ´»åº¦é«˜ï¼Œå¸¸ç”¨ä½œäº‹ä»¶æ€»çº¿ æ˜“ç†è§£ï¼Œå¯ç±»æ¯”äº DOM äº‹ä»¶ä¸­çš„ dispatchEvent å’ŒaddEventListener ã€‚ ç¼ºç‚¹\nå½“äº‹ä»¶ç±»å‹è¶Šæ¥è¶Šå¤šæ—¶ï¼Œéš¾ä»¥ç»´æŠ¤ï¼Œéœ€è¦è€ƒè™‘äº‹ä»¶å‘½åçš„è§„èŒƒï¼Œä¹Ÿè¦é˜²èŒƒæ•°æ®æµæ··ä¹±ã€‚\nclass EventEmitter { constructor() { this.handler = Object.create(null); // å­˜å‚¨å¯¹è±¡-å¤„ç†å‡½æ•°æ•°ç»„ } on(evt, fn) { if (typeof fn !== \u0026#39;function\u0026#39;) throw new TypeError; if (!this.handler[evt]) this.handler[evt] = []; this.handler[evt].push(fn); } emit(evt, ...args) { if (!this.handler[evt]) return false; this.handler[evt].map(fn =\u0026gt; { Reflect.apply(fn, this, args); // ç›¸å½“äºfn.call(this, args) }); } } let ee = new EventEmitter(); ee.on(\u0026#39;foo\u0026#39;, function(arg) { console.log(`${arg} called`); }) // foo called // NOTE: ä½¿ç”¨ç®­å¤´å‡½æ•°ä¼šå¯¼è‡´æ— æ³•ç»‘å®šthis ee.emit(\u0026#39;foo\u0026#39;, \u0026#39;foo\u0026#39;); æœ‰äº†ç®€å•ç‰ˆæœ¬çš„ EventEmitter ï¼Œå°±å¯ä»¥ä¸ç”¨ä¾èµ–ç¬¬ä¸‰æ–¹åº“ã€‚vue çš„å®ç°å¦‚ä¸‹ï¼š\n","title":"08 Async","url":"/techs/08-async/"},{"content":"Network ç½‘ç»œç¼–ç¨‹çš„æœ¬è´¨æ˜¯å¤šå°è®¡ç®—æœºä¹‹é—´çš„ æ•°æ®äº¤æ¢ ã€‚æ•°æ®ä¼ é€’æœ¬èº«æ²¡æœ‰å¤šå¤§çš„éš¾åº¦ï¼Œä¸å°±æ˜¯æŠŠä¸€ä¸ªè®¾å¤‡ä¸­çš„æ•°æ®å‘é€ç»™å…¶ä»–è®¾å¤‡ï¼Œç„¶åæ¥å—å¦å¤–ä¸€ä¸ªè®¾å¤‡åé¦ˆçš„æ•°æ®ã€‚ç°åœ¨çš„ç½‘ç»œç¼–ç¨‹åŸºæœ¬ä¸Šéƒ½æ˜¯åŸºäº è¯·æ±‚/å“åº” æ–¹å¼çš„ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªè®¾å¤‡å‘é€è¯·æ±‚æ•°æ®ç»™å¦å¤–ä¸€ä¸ªï¼Œç„¶åæ¥æ”¶å¦ä¸€ä¸ªè®¾å¤‡çš„åé¦ˆã€‚\nåœ¨ç½‘ç»œç¼–ç¨‹ä¸­ï¼Œå‘èµ·è¿æ¥ç¨‹åºï¼Œä¹Ÿå°±æ˜¯å‘é€ç¬¬ä¸€æ¬¡è¯·æ±‚çš„ç¨‹åºï¼Œè¢«ç§°ä½œ å®¢æˆ·ç«¯^Client^ï¼Œç­‰å¾…å…¶ä»–ç¨‹åºè¿æ¥çš„ç¨‹åºè¢«ç§°ä½œ æœåŠ¡å™¨^Server^ã€‚å®¢æˆ·ç«¯ç¨‹åºå¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™å¯åŠ¨ï¼Œè€ŒæœåŠ¡å™¨ä¸ºäº†èƒ½å¤Ÿæ—¶åˆ»ç›¸åº”è¿æ¥ï¼Œåˆ™éœ€è¦ä¸€ç›´å¯åŠ¨ã€‚\nä¾‹å¦‚ä»¥æ‰“ç”µè¯ä¸ºä¾‹ï¼Œé¦–å…ˆæ‹¨å·çš„äººç±»ä¼¼äºå®¢æˆ·ç«¯ï¼Œæ¥å¬ç”µè¯çš„äººå¿…é¡»ä¿æŒç”µè¯ç•…é€šç±»ä¼¼äºæœåŠ¡å™¨ã€‚è¿æ¥ä¸€æ—¦å»ºç«‹ä»¥åï¼Œå°±å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯å°±å¯ä»¥è¿›è¡Œæ•°æ®ä¼ é€’äº†ï¼Œè€Œä¸”ä¸¤è€…çš„èº«ä»½æ˜¯ç­‰ä»·çš„ã€‚åœ¨ä¸€äº›ç¨‹åºä¸­ï¼Œç¨‹åºæ—¢æœ‰å®¢æˆ·ç«¯åŠŸèƒ½ä¹Ÿæœ‰æœåŠ¡å™¨ç«¯åŠŸèƒ½ï¼Œæœ€å¸¸è§çš„è½¯ä»¶å°±æ˜¯ QQ ã€å¾®ä¿¡è¿™ç±»è½¯ä»¶äº†ã€‚\nğŸ“ Note ç½‘ç»œç¼–ç¨‹ä¸­ä¸¤ä¸ªä¸»è¦çš„é—®é¢˜\nä¸€ä¸ªæ˜¯å¦‚ä½•å‡†ç¡®çš„å®šä½ç½‘ç»œä¸Šä¸€å°æˆ–å¤šå°ä¸»æœºï¼Œ å¦ä¸€ä¸ªå°±æ˜¯æ‰¾åˆ°ä¸»æœºåå¦‚ä½•å¯é é«˜æ•ˆçš„è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚ åœ¨ TCP/IP åè®®ä¸­ [IP å±‚] ä¸»è¦è´Ÿè´£ç½‘ç»œä¸»æœºçš„å®šä½ï¼Œæ•°æ®ä¼ è¾“çš„è·¯ç”±ï¼Œç”±IPåœ°å€å¯ä»¥å”¯ä¸€åœ°ç¡®å®š Internet ä¸Šçš„ä¸€å°ä¸»æœºã€‚\nè€Œ TCP å±‚åˆ™æä¾›é¢å‘åº”ç”¨çš„ å¯é ^TCP^çš„æˆ– éå¯é ^UDP^ çš„æ•°æ®ä¼ è¾“æœºåˆ¶ï¼Œè¿™æ˜¯ç½‘ç»œç¼–ç¨‹çš„ä¸»è¦å¯¹è±¡ï¼Œä¸€èˆ¬ä¸éœ€è¦å…³å¿ƒ [IP å±‚] æ˜¯å¦‚ä½•å¤„ç†æ•°æ®çš„ã€‚\nç›®å‰è¾ƒä¸ºæµè¡Œçš„ç½‘ç»œç¼–ç¨‹æ¨¡å‹æ˜¯ å®¢æˆ·æœº/æœåŠ¡å™¨ï¼ˆC/Sï¼‰ç»“æ„ã€‚å³é€šä¿¡åŒæ–¹ä¸€æ–¹ä½œä¸ºæœåŠ¡å™¨ç­‰å¾…å®¢æˆ·æå‡ºè¯·æ±‚å¹¶äºˆä»¥å“åº”ã€‚å®¢æˆ·åˆ™åœ¨éœ€è¦æœåŠ¡æ—¶å‘æœåŠ¡å™¨æå‡ºç”³è¯·ã€‚æœåŠ¡å™¨ä¸€èˆ¬ä½œä¸º å®ˆæŠ¤è¿›ç¨‹^daemon^ å§‹ç»ˆè¿è¡Œï¼Œç›‘å¬ç½‘ç»œç«¯å£ï¼Œä¸€æ—¦æœ‰å®¢æˆ·è¯·æ±‚ï¼Œå°±ä¼šå¯åŠ¨ä¸€ä¸ªæœåŠ¡è¿›ç¨‹æ¥å“åº”è¯¥å®¢æˆ·ï¼ŒåŒæ—¶è‡ªå·±ç»§ç»­ç›‘å¬æœåŠ¡ç«¯å£ï¼Œä½¿åæ¥çš„å®¢æˆ·ä¹Ÿèƒ½åŠæ—¶å¾—åˆ°æœåŠ¡ã€‚\nç½‘ç»œåè®®æ˜¯ä»€ä¹ˆ\nåœ¨è®¡ç®—æœºç½‘ç»œè¦åšåˆ°äº•äº•æœ‰æ¡çš„äº¤æ¢æ•°æ®ï¼Œå°±å¿…é¡»éµå®ˆä¸€äº›äº‹å…ˆçº¦å®šå¥½çš„è§„åˆ™ï¼Œæ¯”å¦‚äº¤æ¢æ•°æ®çš„æ ¼å¼ã€æ˜¯å¦éœ€è¦å‘é€ä¸€ä¸ªåº”ç­”ä¿¡æ¯ã€‚è¿™äº›è§„åˆ™è¢«ç§°ä¸ºç½‘ç»œåè®®ã€‚ ä¸ºä»€ä¹ˆè¦å¯¹ç½‘ç»œåè®®åˆ†å±‚\nç®€åŒ–é—®é¢˜éš¾åº¦å’Œå¤æ‚åº¦ã€‚ç”±äºå„å±‚ä¹‹é—´ç‹¬ç«‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†å‰²å¤§é—®é¢˜ä¸ºå°é—®é¢˜ã€‚ çµæ´»æ€§å¥½ã€‚å½“å…¶ä¸­ä¸€å±‚çš„æŠ€æœ¯å˜åŒ–æ—¶ï¼Œåªè¦å±‚é—´æ¥å£å…³ç³»ä¿æŒä¸å˜ï¼Œå…¶ä»–å±‚ä¸å—å½±å“ã€‚ æ˜“äºå®ç°å’Œç»´æŠ¤ã€‚ ä¿ƒè¿›æ ‡å‡†åŒ–å·¥ä½œã€‚åˆ†å¼€åï¼Œæ¯å±‚åŠŸèƒ½å¯ä»¥ç›¸å¯¹ç®€å•åœ°è¢«æè¿° OSI OSI - Open System Interconnectï¼Œå³å¼€æ”¾å¼ç³»ç»Ÿäº’è”ã€‚ä¸€èˆ¬éƒ½å« OSI å‚è€ƒæ¨¡å‹ï¼Œæ˜¯ ISO^å›½é™…æ ‡å‡†åŒ–ç»„ç»‡^ åœ¨ 1985 å¹´ç ”ç©¶çš„ç½‘ç»œäº’è¿æ¨¡å‹ã€‚ISO ä¸ºäº†æ›´å¥½çš„ä½¿ç½‘ç»œåº”ç”¨æ›´ä¸ºæ™®åŠï¼Œæ¨å‡ºäº† OSI å‚è€ƒæ¨¡å‹ï¼Œè¿™æ ·æ‰€æœ‰çš„å…¬å¸éƒ½æŒ‰ç…§ç»Ÿä¸€çš„æ ‡å‡†æ¥æŒ‡å®šè‡ªå·±çš„ç½‘ç»œï¼Œå°±å¯ä»¥äº’é€šäº’è”äº†ã€‚\nç½‘ç»œåè®®é€šè¿‡ åˆ†å±‚ æ¥æ˜ç¡®å„å±‚å·¥ä½œèŒè´£ï¼Œé€šè¿‡å®šä¹‰æ˜ç¡®çš„æ¥å£æ¥ååŒå·¥ä½œï¼Œç¬¬ä¸€å±‚éƒ½å¯ä»¥ä½¿ç”¨ä¸‹é¢å„å±‚çš„åŠŸèƒ½ï¼Œè€Œä¸ç”¨æ‹…å¿ƒå„å±‚æ˜¯æ€ä¹ˆå®ç°çš„ã€‚å°±å¥½åƒæˆ‘ä»¬å¼€å‘å°è£…ç»„ä»¶ä¸€æ ·ï¼Œæ¯ä¸€ä¸ªç»„ä»¶å„è‡ªè´Ÿè´£å„è‡ªçš„äº‹ï¼Œäº’ä¸å¹²æ‰°ï¼Œä¹Ÿæé«˜äº†å¤ç”¨åº¦ã€‚æ ‡å‡†æ¨¡å‹ä¸º OSI ä¸ƒå±‚ç½‘ç»œæ¨¡å‹ï¼ŒåŒ…æ‹¬ï¼š\nç‰©ç†å±‚1. Physical, é“¾è·¯å±‚2. Data link, ç½‘ç»œå±‚3. Network, ä¼ è¾“å±‚4. Transport, ä¼šè¯å±‚5. Session, è¡¨ç¤ºå±‚6. Presentation, åº”ç”¨å±‚7. Application\nä¸‹å›¾ä¸º ISO/OSI æ ‡å‡†ä¸å®é™…åº”ç”¨ä¸­ TCP/IP æ ‡å‡†çš„å¯¹æ¯”ï¼š\nOSIä¸ƒå±‚æ¨¡å‹åŠŸèƒ½å¯¹åº”çš„ç½‘ç»œåè®®TCP/IPå››å±‚æ¦‚å¿µæ¨¡å‹åº”ç”¨å±‚æ–‡ä»¶ä¼ è¾“ã€æ–‡ä»¶ç®¡ç†ã€ç”µå­é‚®ä»¶çš„ä¿¡æ¯å¤„ç†â€”â€”apduHTTP, TFTP, FTP, NFS, WAIS, SMTPåº”ç”¨å±‚è¡¨ç¤ºå±‚ç¡®ä¿ä¸€ä¸ªç³»ç»Ÿçš„åº”ç”¨å±‚å‘é€çš„æ¶ˆæ¯å¯ä»¥è¢«å¦ä¸€ä¸ªç³»ç»Ÿçš„åº”ç”¨å±‚è¯»å–ï¼Œç¼–ç è½¬æ¢ã€æ•°æ®è§£æã€ç®¡ç†æ•°æ®çš„è§£å¯†å’ŒåŠ å¯†çš„æœ€å°å•ä½â€”â€”ppduTeInet, Rlogin, SNMP, Gopheråº”ç”¨å±‚ä¼šè¯å±‚è´Ÿè´£åœ¨ç½‘ç»œä¸­çš„ä¸¤èŠ‚ç‚¹å»ºç«‹ï¼Œç»´æŒå’Œç»ˆæ­¢é€šä¿¡ï¼Œåœ¨ä¸€å±‚åè®®ä¸­ï¼Œå¯ä»¥è§£å†³èŠ‚ç‚¹è¿æ¥çš„åè°ƒå’Œç®¡ç†é—®é¢˜ã€‚åŒ…æ‹¬é€šä¿¡è¿æ¥çš„å»ºç«‹ã€ä¿æŒä¼šè¯è¿‡ç¨‹é€šä¿¡è¿æ¥çš„ç•…é€šã€ä¸¤èŠ‚ç‚¹ä¹‹é—´çš„å¯¹è¯ã€é€šä¿¡ç»ˆç«¯æ˜¯å†³å®šä»ä½•å¤„é‡æ–°å‘é€çš„æœ€å°å•ä½â€”â€”spduSMTP, DNSåº”ç”¨å±‚ä¼ è¾“å±‚å®šä¹‰ä¸€äº›ä¼ è¾“æ•°æ®çš„åè®®å’Œç«¯å£ã€‚ä¼ è¾“åè®®åŒæ—¶è¿›è¡Œæµé‡æ§åˆ¶ï¼Œæˆ–æ˜¯æ ¹æ®æ¥æ”¶æ–¹æ¥æ”¶æ•°æ®çš„å¿«æ…¢ç¨‹åº¦ï¼Œè§„å®šé€‚å½“çš„å‘é€é€Ÿç‡ï¼Œè§£å†³ä¼ è¾“æ•ˆç‡åŠèƒ½åŠ›çš„é—®é¢˜â€”â€”tpduTCP, UDPä¼ è¾“å±‚ç½‘ç»œå±‚æ§åˆ¶å­ç½‘çš„è¿è¡Œï¼Œå¦‚é€»è¾‘ç¼–å€ã€åˆ†ç»„ä¼ è¾“ã€è·¯ç”±é€‰æ‹©çš„æœ€å°å•ä½â€”â€”åˆ†ç»„(åŒ…)æŠ¥æ–‡IP, ICMP, ARP, RARP, AKP, UUCPç½‘ç»œå±‚æ•°æ®é“¾è·¯å±‚ä¸»è¦æ˜¯å¯¹ç‰©ç†å±‚ä¼ è¾“çš„æ¯”ç‰¹æµåŒ…è£…,æ£€æµ‹ä¿è¯æ•°æ®ä¼ è¾“çš„å¯é æ€§ï¼Œå°†ç‰©ç†å±‚æ¥æ”¶çš„æ•°æ®è¿›è¡ŒMAC(åª’ä½“è®¿é—®æ§åˆ¶)åœ°å€çš„å°è£…å’Œè§£å°è£…ï¼Œä¹Ÿå¯ä»¥ç®€å•çš„ç†è§£ä¸ºç‰©ç†å¯»å€çš„æœ€å°çš„ä¼ è¾“å•ä½â€”â€”å¸§ï¼Œäº¤æ¢æœºå°±å¤„åœ¨è¿™ä¸€å±‚FDDI, Ethernet, Arpanet, PDN, SLIP, PPP, STP, HDLC, SDLC, å¸§ä¸­ç»§æ•°æ®é“¾è·¯å±‚ç‰©ç†å±‚å®šä¹‰ç‰©ç†è®¾å¤‡çš„æ ‡å‡†ï¼Œä¸»è¦å¯¹ç‰©ç†è¿æ¥æ–¹å¼ã€ç”µæ°”ç‰¹æ€§ã€æœºæ¢°ç‰¹æ€§ç­‰åˆ¶å®šç»Ÿä¸€æ ‡å‡†ï¼Œä¼ è¾“æ¯”ç‰¹æµçš„æœ€å°çš„ä¼ è¾“å•ä½â€”â€”ä½(æ¯”ç‰¹æµ)IÎ•Î•Î• 802.1Î‘, Î™Î•Î•E 802. 2åˆ°IEEE 802.æ•°æ®é“¾è·¯å±‚ TCP/IP å®é™…ä½¿ç”¨ä¸­ï¼Œ TCP/IP æˆä¸ºäº†å®é™…æ ‡å‡†ï¼Œè¢«ç®€åŒ–ä¸º 4 å±‚ï¼š\nç½‘ç»œæ¥å£å±‚1. Data linkç½‘ç»œæ¥å£å±‚1. Data linkç½‘ç»œæ¥å£å±‚1. Data link, ç½‘é™…å±‚2. Networkç½‘é™…å±‚2. Networkç½‘é™…å±‚2. Network, ä¼ è¾“å±‚3. Transportä¼ è¾“å±‚3. Transportä¼ è¾“å±‚3. Transport, åº”ç”¨å±‚4. Applicationåº”ç”¨å±‚4. Applicationåº”ç”¨å±‚4. Application\nç½‘ç»œæ¥å£å±‚ï¼šåŒ…æ‹¬é“¾è·¯å±‚å’Œç‰©ç†å±‚ï¼Œé“¾è·¯å±‚è´Ÿè´£å°†äºŒè¿›åˆ¶æ•°æ®åŒ…å’Œç½‘ç»œä¿¡å·ç›¸äº’è½¬æ¢ï¼Œäº¤æ¢æœºã€ç½‘å¡å°±æ˜¯åœ¨è¿™ä¸€å±‚ï¼Œç‰©ç†å±‚ä¸»è¦æœ‰æ¥æ”¶å™¨ã€å‘é€å™¨ã€ä¸­ç»§å™¨ã€å…‰çº¤ç”µç¼†ç­‰ ç½‘é™…å±‚ï¼šè´Ÿè´£å¯»å€å’Œè·¯ç”±åŠŸèƒ½ï¼Œå°†æ•°æ®åŒ…å‘é€åˆ°ç‰¹å®šçš„è®¡ç®—æœºï¼Œä¸»è¦åè®®æ˜¯ IP åè®®ï¼Œè·¯ç”±å™¨å°±æ˜¯åœ¨è¿™ä¸€å±‚ ä¼ è¾“å±‚ï¼šä¸ºä¸¤ä¸ªä¸»æœº è¿›ç¨‹ å»ºç«‹ç«¯åˆ°ç«¯çš„é“¾æ¥ï¼Œæä¾›å¯é é€æ˜çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼ŒåŒ…æ‹¬å¤„ç†å·®é”™æ§åˆ¶å’Œæµé‡æ§åˆ¶ç­‰é—®é¢˜ï¼Œå¹¶å‘å±è”½ä¸‹å±‚æ•°æ®é€šä¿¡çš„ç»†èŠ‚ï¼Œä¸»è¦åè®®åŒ…æ‹¬ TCP / UDP åº”ç”¨å±‚ï¼šæœ€é«˜å±‚ï¼Œæä¾›ç‰¹å®šäºåº”ç”¨ç¨‹åºçš„åè®®ï¼Œè¿è¡Œåœ¨è¯¥å±‚çš„åè®®æœ‰ HTTP / FTP / SSH / WebScoket / FTP / TELNET ç­‰ å’Œ OSI ä¸ƒå±‚ç½‘ç»œåè®®çš„ä¸»è¦åŒºåˆ«å¦‚ä¸‹ï¼š\n[åº”ç”¨å±‚]ã€[è¡¨ç¤ºå±‚]ã€[ä¼šè¯å±‚] ä¸‰ä¸ªå±‚æ¬¡æä¾›çš„æœåŠ¡ç›¸å·®ä¸æ˜¯å¾ˆå¤§ï¼Œæ‰€ä»¥åœ¨ TCP/IP åè®®ä¸­ï¼Œå®ƒä»¬è¢«åˆå¹¶ä¸º [åº”ç”¨å±‚] ä¸€ä¸ªå±‚æ¬¡ã€‚ ç”±äº [æ•°æ®é“¾è·¯å±‚] å’Œ [ç‰©ç†å±‚] çš„å†…å®¹å¾ˆç›¸ä¼¼ï¼Œæ‰€ä»¥åœ¨ TCP/IP åè®®ä¸­å®ƒä»¬è¢«å½’å¹¶åœ¨ [ç½‘ç»œæ¥å£å±‚] ä¸€ä¸ªå±‚æ¬¡é‡Œã€‚ TCP/IP åè®®ç°‡ä¸­çš„åè®®ï¼š\n[é“¾æ¥å±‚] ARP^Address-Resolution-Protocol^ ARP - Address Resolution Protocol^åœ°å€è§£æåè®®^\nğŸ“ Location [é“¾æ¥å±‚]\nARP åè®®å®Œæˆäº† IP åœ°å€ ä¸ ç‰©ç†åœ°å€ çš„æ˜ å°„ã€‚ä¸»æœºå‘é€ä¿¡æ¯æ—¶ä¼šå°†åŒ…å«ç›®æ ‡ IP çš„ ARP è¯·æ±‚å¹¿æ’­åˆ°å±€åŸŸç½‘ç»œä¸Šçš„æ‰€æœ‰ä¸»æœºï¼Œå¹¶æ¥å—è¿”å›æ¶ˆæ¯ï¼Œä»¥æ­¤æ¥ç¡®å®šç‰©ç†åœ°å€ã€‚æ”¶åˆ°æ¶ˆæ¯åçš„ç‰©ç†åœ°å€å’Œ IP åœ°å€ä¼šåœ¨ ARP ä¸­ç¼“å­˜ä¸€æ®µæ—¶é—´ï¼Œä¸‹æ¬¡æŸ¥è¯¢çš„æ—¶å€™ç›´æ¥ä» ARP ä¸­æŸ¥è¯¢å³å¯ã€‚\nPPP^Point-to-Point-Protocol^ ğŸ“ Location [é“¾æ¥å±‚]\nPPP - Point to Point Protocol^ç‚¹å¯¹ç‚¹åè®®^\næ˜¯åœ¨ä¸ºåŒç­‰å•å…ƒä¹‹é—´ä¼ è¾“æ•°æ®åŒ…è€Œè®¾è®¡çš„ã€‚è®¾è®¡ç›®çš„ä¸»è¦æ˜¯ç”¨æ¥é€šè¿‡æ‹¨å·æˆ–ä¸“çº¿æ–¹å¼å»ºç«‹ç‚¹å¯¹ç‚¹è¿æ¥å‘é€æ•°æ®ï¼Œä½¿å…¶æˆä¸ºå„ç§ä¸»æœºã€ç½‘æ¡¥å’Œè·¯ç”±å™¨ä¹‹é—´ç®€å•è¿æ¥çš„ä¸€ç§å…±é€šçš„è§£å†³æ–¹æ¡ˆã€‚\nSLIP^Serial-Line-Internet-Protocol^ ğŸ“ Location [é“¾è·¯å±‚]\nSLIP - Serial Line Internet Protocol^ä¸²è¡Œçº¿è·¯ç½‘é™…åè®®^\nSLIP åè®®æ˜¯åœ¨ä¸²è¡Œé€šä¿¡çº¿è·¯ä¸Šæ”¯æŒ TCP/IP åè®®çš„ä¸€ç§ ç‚¹å¯¹ç‚¹^Point-to-Point^ å¼çš„é“¾è·¯å±‚é€šä¿¡åè®®ã€‚\n[ç½‘ç»œå±‚] IP - Internet Protocol^äº’è”ç½‘åè®®^\nğŸ“ Location [ç½‘ç»œå±‚]\nIP æ˜¯æ•´ä¸ª TCP/IP åè®®æ—çš„æ ¸å¿ƒï¼Œä¹Ÿæ˜¯æ„æˆäº’è”ç½‘çš„åŸºç¡€ã€‚\nIP åè®®çš„ç‰¹ç‚¹æ˜¯ï¼šIPåè®®æ˜¯ ä¸å¯é  çš„ä¼ è¾“åè®®ã€‚å¦‚æœ ICMP åè®®å‡ºç°ä¼ è¾“å¼‚å¸¸ï¼ŒIP éƒ½ä¼šä¸¢å¼ƒæ•°æ®åŒ…å¹¶å¯èƒ½ä¼šå“åº”ä¸€ä¸ª [ICMP å·®é”™æ¶ˆæ¯] ç»™å‘é€ç«¯ï¼Œè€Œä»»ä½•è¦æ±‚å¯é æ€§å¿…é¡»ç”±ä¸Šå±‚å¦‚TCPåè®®æ¥æä¾›ã€‚\nå¦‚æœæ˜¯åœ¨ å±€åŸŸç½‘ å†…éƒ½æ˜¯ç”¨ [MAC åœ°å€] é€šä¿¡ ï¼Œå±€åŸŸç½‘ä¹‹å¤–ï¼Œå°±å¾—ç”¨ IP äº†ã€‚MAC å°±åƒæ˜¯èº«ä»½è¯ï¼ŒIPå°±åƒæ˜¯ä½å€ã€‚æ‰€æœ‰ TCPã€UDPã€ICMP ç­‰æ•°æ®éƒ½æ˜¯ä»¥ [IPæ•°æ®æŠ¥] æ ¼å¼è¿›è¡Œä¼ è¾“ã€‚\nIP åè®®æ˜¯ æ— è¿æ¥ çš„ï¼Œä¸ç»´æŠ¤ä»»ä½•å…³äºåç»­æ•°æ®çš„çŠ¶æ€ä¿¡æ¯ï¼Œæ¯ä¸ªæ•°æ®ç‹¬ç«‹ã€‚è¡¨ç°åœ¨ï¼šå¯ä»¥ä¸æŒ‰å‘é€é¡ºåºæ¥æ”¶ï¼Œä¸ç”¨ç»´æŠ¤è¿æ¥çŠ¶æ€ï¼Œå…å»äº†ç»´æŠ¤å¤åˆ¶çš„é“¾è·¯çŠ¶æ€ä¿¡æ¯(TCPä¼šè®²åˆ°)\nIP èƒ½å¤Ÿä¸º [è¿è¾“å±‚]^åœ¨TCP/IPä¸­ä¸ºç½‘ç»œå±‚^ æä¾›æ•°æ®åˆ†å‘ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¤Ÿç»„è£…æ•°æ®ä¾›è¿è¾“å±‚ä½¿ç”¨ã€‚å®ƒå°†å¤šä¸ªå•ä¸ªç½‘ç»œè¿æ¥æˆä¸ºä¸€ä¸ªäº’è”ç½‘ï¼Œè¿™æ ·èƒ½å¤Ÿæé«˜ç½‘ç»œçš„å¯æ‰©å±•æ€§ï¼Œå®ç°å¤§è§„æ¨¡çš„ç½‘ç»œäº’è”ã€‚äºŒæ˜¯åˆ†å‰²é¡¶å±‚ç½‘ç»œå’Œåº•å±‚ç½‘ç»œä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚\nICMP^Internet-Control-Message-Protocol^ ICMP - Internet Control Message Protocol^äº’è”ç½‘æ§åˆ¶æ¶ˆæ¯åè®®^\nğŸ“ Location [ç½‘ç»œå±‚]\nICMP åè®®ä¸»è¦ç”¨äºåœ¨ IP ä¸»æœºã€è·¯ç”±å™¨ä¹‹é—´ä¼ é€’æ§åˆ¶æ¶ˆæ¯ã€‚\nICMP ä¾é  IP æ¥å®Œæˆå®ƒçš„ä»»åŠ¡ï¼Œå®ƒæ˜¯ IP çš„ä¸»è¦éƒ¨åˆ†ã€‚\nIP åè®®æœ¬èº«ä¸æ”¯æŒå‘å¾€ç›®çš„åœ°å€å¤±è´¥çš„IPæ•°æ®åŒ…ï¼Œä¹Ÿæ²¡æœ‰æä¾›ç›´æ¥çš„æ–¹å¼è·å–è¯Šæ–­ä¿¡æ¯ï¼Œæ¯”å¦‚å‘é€é€”ä¸­ç»è¿‡å“ªäº›è·¯ç”±å™¨ï¼Œä»¥åŠå¾€è¿”æ—¶é—´ï¼Œè€Œè¿™å°±ç”± [ICMP åè®®] æ¥ä¸“é—¨è´Ÿè´£ã€‚\nå®ƒä¸ä¼ è¾“åè®®^TCP/UDP^ æ˜¾è‘—ä¸åŒï¼šå®ƒä¸€èˆ¬ä¸ç”¨äºåœ¨ä¸¤ç‚¹é—´ ä¼ è¾“æ•°æ® ã€‚å®ƒé€šå¸¸ä¸ç”±ç½‘ç»œç¨‹åºç›´æ¥ä½¿ç”¨ï¼Œé™¤äº† ping å’Œ traceroute è¿™ä¸¤ä¸ªç‰¹åˆ«çš„ä¾‹å­ã€‚ IPv4 ä¸­çš„ ICMP è¢«ç§°ä½œ ICMPv4 ï¼ŒIPv6 ä¸­çš„ ICMP åˆ™è¢«ç§°ä½œ ICMPv6 ã€‚\nICMP å±äºç½‘ç»œå±‚çš„åè®®ï¼Œå½“é‡åˆ° IP æ— æ³•è®¿é—®ç›®æ ‡ã€IP è·¯ç”±å™¨æ— æ³•æŒ‰ç…§å½“å‰ä¼ è¾“é€Ÿç‡è½¬å‘æ•°æ®åŒ…æ—¶ï¼Œä¼šè‡ªåŠ¨å‘é€ ICMP æ¶ˆæ¯ï¼Œä»è¿™ä¸ªè§’åº¦æ¥è¯´ï¼ŒICMP åè®®å¯ä»¥çœ‹ä½œæ˜¯ é”™è¯¯ä¾¦æµ‹ä¸å›æŠ¥æœºåˆ¶ï¼Œè®©æˆ‘ä»¬æ£€æŸ¥ç½‘ç»œçŠ¶å†µã€ä¹Ÿèƒ½å¤Ÿç¡®ä¿è¿çº¿çš„å‡†ç¡®æ€§ã€‚\nğŸ“ Note æˆ‘ä»¬å¸¸ç”¨çš„ ping å°±æ˜¯ç”¨ ICMP æŸ¥è¯¢æŠ¥æ–‡ã€‚ä¸è¿‡ ping ä½¿ç”¨ ICMP åè®®ä¼šç›´æ¥è·³è¿‡ [ä¼ è¾“å±‚] ï¼Œæ‰€ä»¥ ping ç¨‹åºæ˜¯æ²¡æœ‰ç«¯å£å·\nNAT*^Network-Address-Translation^* NAT - Network Address Translation^ç½‘ç»œåœ°å€è½¬æ¢^\nğŸ“ Location [ç½‘ç»œå±‚]\nç”¨äºè§£å†³å†…ç½‘ä¸­çš„ä¸»æœºè¦å’Œå› ç‰¹ç½‘ä¸Šçš„ä¸»æœºé€šä¿¡ã€‚ç”± NAT è·¯ç”±å™¨å°†ä¸»æœºçš„æœ¬åœ°IP åœ°å€è½¬æ¢ä¸ºå…¨çƒ IP åœ°å€ï¼Œåˆ†ä¸ºé™æ€è½¬æ¢ï¼ˆè½¬æ¢å¾—åˆ°çš„å…¨çƒ IP åœ°å€å›ºå®šä¸å˜ï¼‰å’ŒåŠ¨æ€ NAT è½¬æ¢ã€‚\n[ä¼ è¾“å±‚] TCP/UDP^Transmission-Control-Protocol/User-Datagram-Protocol^ TCP - Transmission Control Protocol^ä¼ è¾“æ§åˆ¶åè®®^\nUDP - User Datagram Protocol^ç”¨æˆ·æ•°æ®æŠ¥åè®®^\nğŸ“ Location [ä¼ è¾“å±‚]\nğŸ”— Href TCP/UDP\n[åº”ç”¨å±‚] FTP*^File-Transfer-Protocol^* FTP - File Transfer Protocol æ–‡ä»¶ä¼ è¾“åè®®\nğŸ“ Location [åº”ç”¨å±‚]\nåº”ç”¨å±‚åè®®ä¹‹ä¸€ï¼Œæ˜¯ TCP/IP åè®®çš„é‡è¦ç»„æˆä¹‹ä¸€ï¼ŒFTP åè®®åˆ†ä¸ºæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¸¤éƒ¨åˆ†ï¼ŒFTP æœåŠ¡å™¨ç”¨æ¥å­˜å‚¨æ–‡ä»¶ï¼ŒFTP å®¢æˆ·ç«¯ç”¨æ¥è®¿é—® FTP æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼ŒFTP çš„ä¼ è¾“æ•ˆç‡æ¯”è¾ƒé«˜ï¼Œæ‰€ä»¥ä¸€èˆ¬ä½¿ç”¨ FTP æ¥ä¼ è¾“å¤§æ–‡ä»¶ã€‚\nDNS^Domain-Name-System^ DNS - Domain Name System åŸŸåç³»ç»Ÿåè®®\nğŸ“ Location [åº”ç”¨å±‚]\nDNS åè®®æ˜¯ä¸€ä¸ªå°†åŸŸåå’Œ IP ç›¸äº’æ˜ å°„çš„åˆ†å¸ƒå¼æ•°æ®åº“ç³»ç»Ÿã€‚DNS ç¼“å­˜èƒ½å¤ŸåŠ å¿«ç½‘ç»œèµ„æºçš„è®¿é—®ã€‚\nSMTP^Simple-Mail-Transfer-Protocol^ SMTP - Simple Mail Transfer Protocol ç®€å•é‚®ä»¶ä¼ è¾“åè®®\nğŸ“ Location [åº”ç”¨å±‚]\nSMTP ä¸»è¦ç”¨ä½œé‚®ä»¶æ”¶å‘åè®®ï¼ŒSMTP æœåŠ¡å™¨æ˜¯éµå¾ª SMTP åè®®çš„å‘é€é‚®ä»¶æœåŠ¡å™¨ï¼Œç”¨æ¥å‘é€æˆ–ä¸­è½¬ç”¨æˆ·å‘å‡ºçš„ç”µå­é‚®ä»¶ã€‚\nTCP/UDP TCP/IP å³ä¼ è¾“æ§åˆ¶/ç½‘ç»œåè®®ï¼Œæ˜¯é¢å‘è¿æ¥çš„åè®®ï¼Œå‘é€æ•°æ®å‰è¦å…ˆå»ºç«‹è¿æ¥(å‘é€æ–¹å’Œæ¥æ”¶æ–¹çš„æˆå¯¹çš„ä¸¤ä¸ªä¹‹é—´å¿…é¡»å»ºç«‹è¿æ¥)ï¼ŒTCP æä¾›å¯é çš„æœåŠ¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡ TCP è¿æ¥ä¼ è¾“çš„æ•°æ®ä¸ä¼šä¸¢å¤±ã€æ²¡æœ‰é‡å¤ã€å¹¶ä¸”æŒ‰åºåˆ°è¾¾ã€‚\nUDP å®ƒæ˜¯å±äº TCP/IP åè®®æ—ä¸­çš„ä¸€ç§ã€‚æ˜¯æ— è¿æ¥çš„åè®®ï¼Œå‘é€æ•°æ®å‰ä¸éœ€è¦å»ºç«‹è¿æ¥ï¼Œæ˜¯æ²¡æœ‰å¯é æ€§çš„åè®®ã€‚å› ä¸ºä¸éœ€è¦å»ºç«‹è¿æ¥æ‰€ä»¥å¯ä»¥åœ¨åœ¨ç½‘ç»œä¸Šä»¥ä»»ä½•å¯èƒ½çš„è·¯å¾„ä¼ è¾“ï¼Œå› æ­¤èƒ½å¦åˆ°è¾¾ç›®çš„åœ°ï¼Œåˆ°è¾¾ç›®çš„åœ°çš„æ—¶é—´ä»¥åŠå†…å®¹çš„æ­£ç¡®æ€§éƒ½æ˜¯ä¸èƒ½è¢«ä¿è¯çš„ã€‚\nåŒºåˆ« TCP æ˜¯ é¢å‘è¿æ¥ çš„åè®®ï¼Œå‘é€æ•°æ®å‰è¦å…ˆå»ºç«‹è¿æ¥ï¼ŒTCP æä¾›å¯é çš„æœåŠ¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡TCPè¿æ¥ä¼ è¾“çš„æ•°æ®ä¸ä¼šä¸¢å¤±ï¼Œæ²¡æœ‰é‡å¤ï¼Œå¹¶ä¸”æŒ‰é¡ºåºåˆ°è¾¾ UDP æ˜¯ æ— è¿æ¥ çš„åè®®ï¼Œå‘é€æ•°æ®å‰ä¸éœ€è¦å»ºç«‹è¿æ¥ï¼Œæ²¡æœ‰å¯é æ€§ TCP é€šä¿¡ç±»ä¼¼äºäºè¦æ‰“ä¸ªç”µè¯ï¼Œæ¥é€šäº†ï¼Œç¡®è®¤èº«ä»½åï¼Œæ‰å¼€å§‹è¿›è¡Œé€šè¡Œ UDP é€šä¿¡ç±»ä¼¼äºå­¦æ ¡å¹¿æ’­ï¼Œé ç€å¹¿æ’­æ’­æŠ¥ç›´æ¥è¿›è¡Œé€šä¿¡ TCP åªæ”¯æŒç‚¹å¯¹ç‚¹é€šä¿¡ï¼ŒUDPæ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€ã€å¤šå¯¹å¤š TCP æ˜¯é¢å‘ å­—èŠ‚æµ çš„ï¼ŒUDPæ˜¯é¢å‘ æŠ¥æ–‡ çš„ï¼› é¢å‘å­—èŠ‚æµæ˜¯æŒ‡å‘é€æ•°æ®æ—¶ä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œä¸€ä¸ªæ•°æ®åŒ…å¯ä»¥æ‹†åˆ†æˆ è‹¥å¹²ç»„ è¿›è¡Œå‘é€ï¼Œè€Œ UDP ä¸€ä¸ªæŠ¥æ–‡åªèƒ½ä¸€æ¬¡å‘å®Œ TCP é¦–éƒ¨å¼€é”€^20å­—èŠ‚^ æ¯” UDP é¦–éƒ¨å¼€é”€^8å­—èŠ‚^ è¦å¤§ UDP çš„ä¸»æœºä¸éœ€è¦ç»´æŒå¤æ‚çš„è¿æ¥çŠ¶æ€è¡¨ åº”ç”¨åœºæ™¯ å¯¹æŸäº›å®æ—¶æ€§è¦æ±‚æ¯”è¾ƒé«˜çš„æƒ…å†µä½¿ç”¨ UDP ï¼Œæ¯”å¦‚æ¸¸æˆã€åª’ä½“é€šä¿¡ã€å®æ—¶ç›´æ’­ï¼Œå³ä½¿å‡ºç°ä¼ è¾“é”™è¯¯ä¹Ÿå¯ä»¥å®¹å¿ï¼›å…¶å®ƒå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼ŒHTTP éƒ½æ˜¯ç”¨ TCP ï¼Œå› ä¸ºè¦æ±‚ä¼ è¾“çš„å†…å®¹å¯é ï¼Œä¸è‡³äºå‡ºç°ä¸¢å¤±çš„æƒ…å†µã€‚\nè¿è¡Œåœ¨ TCP åè®®ä¸Šçš„åè®®ï¼š\nHTTP - Hypertext Transfer Protocol^è¶…æ–‡æœ¬ä¼ è¾“åè®®^ ï¼Œä¸»è¦ç”¨äºæ™®é€šæµè§ˆ HTTPS - HTTP over SSL^å®‰å…¨è¶…æ–‡æœ¬ä¼ è¾“åè®®^ ï¼ŒHTTP åè®®çš„å®‰å…¨ç‰ˆæœ¬ FTP - File Transfer Protocol^æ–‡ä»¶ä¼ è¾“åè®®^ ï¼Œç”¨äºæ–‡ä»¶ä¼ è¾“ POP3 - Post Office Protocol, version 3 ^é‚®å±€åè®®^ ï¼Œç”¨äºæ¥æ”¶é‚®ä»¶ SMTP - Simple Mail Transfer Protocol^ç®€å•é‚®ä»¶ä¼ è¾“åè®®^ ï¼Œç”¨äºå‘é€é‚® TELNET - Teletype over the Network^ç½‘ç»œç”µä¼ ^ï¼Œé€šè¿‡ç»ˆç«¯^terminal^ ç™»é™†ç½‘ç»œ SSH - Secure Shellï¼Œç”¨äºæ›¿ä»£å®‰å…¨æ€§å·®çš„ TELNET åŠ å¯†å®‰å…¨ç™»é™† è¿è¡Œåœ¨ UDP åè®®ä¸Šçš„åè®®ï¼š\nBOOTP - Boot Protocol^å¯åŠ¨åè®®^ï¼Œç”¨äºæ— ç›˜è®¾å¤‡ NTP - Network Time Protocol^ç½‘ç»œæ—¶é—´åè®®^ï¼Œç”¨äºç½‘ç»œåŒæ­¥ DHCP - Dynamic Host Configuration Protocol^åŠ¨æ€ä¸»æœºé…ç½®åè®®^ï¼ŒåŠ¨æ€é…ç½® IP è¿è¡Œåœ¨ TCP å’Œ UDP åè®®ä¸Šï¼š\nDNS - Domain Name Service^åŸŸåæœåŠ¡^ï¼Œç”¨äºå®ŒæˆåŸŸåè½¬æ¢ ECHO - Echo Protocol^å›ç»•åè®®^ï¼Œç”¨äºæŸ¥é”™åŠæµ‹é‡åº”ç­”æ—¶é—´ SNMP - Simple Network Management Protocol^ç®€å•ç½‘ç»œç®¡ç†åè®®^ ï¼Œç”¨äºç½‘ç»œä¿¡æ¯çš„æ”¶é›†å’Œç½‘ç»œç®¡ç† DHCP - Dynamic Host Configuration Protocol^åŠ¨æ€ä¸»æœºé…ç½®åè®®^ï¼ŒåŠ¨æ€é…ç½® IP åœ°å€ ARP - Address Resolution Protocol^åœ°å€è§£æåè®®^ï¼Œç”¨äºåŠ¨æ€è§£æä»¥å¤ªç½‘ç¡¬ä»¶åœ°å€ ğŸ“ Note\nä»è¾“å…¥å€åˆ°è·å¾—é¡µé¢çš„è¿‡ç¨‹\næµè§ˆå™¨æŸ¥è¯¢ DNSï¼Œè·å–åŸŸåå¯¹åº”çš„IPåœ°å€ï¼šå…·ä½“è¿‡ç¨‹åŒ…æ‹¬æµè§ˆå™¨æœç´¢è‡ªèº«çš„DNS ç¼“å­˜ã€æœç´¢æ“ä½œç³»ç»Ÿçš„ DNS ç¼“å­˜ã€è¯»å–æœ¬åœ°çš„ Host æ–‡ä»¶å’Œå‘æœ¬åœ° DNS æœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ç­‰ã€‚å¯¹äºå‘æœ¬åœ° DNS æœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ï¼Œå¦‚æœè¦æŸ¥è¯¢çš„åŸŸååŒ…å«åœ¨æœ¬åœ°é…ç½®åŒºåŸŸèµ„æºä¸­ï¼Œåˆ™è¿”å›è§£æç»“æœç»™å®¢æˆ·æœºï¼Œå®ŒæˆåŸŸåè§£æ(æ­¤è§£æå…·æœ‰æƒå¨æ€§)ï¼›å¦‚æœè¦æŸ¥è¯¢çš„åŸŸåä¸ç”±æœ¬åœ° DNS æœåŠ¡å™¨åŒºåŸŸè§£æï¼Œä½†è¯¥æœåŠ¡å™¨å·²ç¼“å­˜äº†æ­¤ç½‘å€æ˜ å°„å…³ç³»ï¼Œåˆ™è°ƒç”¨è¿™ä¸ª IP åœ°å€æ˜ å°„ï¼Œå®ŒæˆåŸŸåè§£æï¼ˆæ­¤è§£æä¸å…·æœ‰æƒå¨æ€§ï¼‰ã€‚å¦‚æœæœ¬åœ°åŸŸåæœåŠ¡å™¨å¹¶æœªç¼“å­˜è¯¥ç½‘å€æ˜ å°„å…³ç³»ï¼Œé‚£ä¹ˆå°†æ ¹æ®å…¶è®¾ç½®å‘èµ·é€’å½’æŸ¥è¯¢æˆ–è€…è¿­ä»£æŸ¥è¯¢ æµè§ˆå™¨è·å¾—åŸŸåå¯¹åº”çš„ IP åœ°å€ä»¥åï¼Œæµè§ˆå™¨å‘æœåŠ¡å™¨è¯·æ±‚å»ºç«‹é“¾æ¥ï¼Œå‘èµ·ä¸‰æ¬¡æ¡æ‰‹ TCP/IP é“¾æ¥å»ºç«‹èµ·æ¥åï¼Œæµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€ HTTP è¯·æ±‚ æœåŠ¡å™¨æ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ï¼Œå¹¶æ ¹æ®è·¯å¾„å‚æ•°æ˜ å°„åˆ°ç‰¹å®šçš„è¯·æ±‚å¤„ç†å™¨è¿›è¡Œå¤„ç†ï¼Œå¹¶å°†å¤„ç†ç»“æœåŠç›¸åº”çš„è§†å›¾è¿”å›ç»™æµè§ˆå™¨ æµè§ˆå™¨è§£æå¹¶æ¸²æŸ“è§†å›¾ï¼Œè‹¥é‡åˆ°å¯¹ JS æ–‡ä»¶ã€CSS æ–‡ä»¶åŠå›¾ç‰‡ç­‰é™æ€èµ„æºçš„å¼•ç”¨ï¼Œåˆ™é‡å¤ä¸Šè¿°æ­¥éª¤å¹¶å‘æœåŠ¡å™¨è¯·æ±‚è¿™äº›èµ„æº æµè§ˆå™¨æ ¹æ®å…¶è¯·æ±‚åˆ°çš„èµ„æºã€æ•°æ®æ¸²æŸ“é¡µé¢ï¼Œæœ€ç»ˆå‘ç”¨æˆ·å‘ˆç°ä¸€ä¸ªå®Œæ•´çš„é¡µé¢ TCP^Transmission-Control-Protocol^ TCP - Transmission Control Protocol^ä¼ è¾“æ§åˆ¶åè®®^\nè¿™æ˜¯æˆ‘ä»¬å¹³æ—¶ç”¨çš„æœ€å¤šçš„åè®®ï¼Œç‰¹åˆ«æ˜¯å‰åç«¯ TCP ç»™åº”ç”¨ç¨‹åºæä¾›äº†ä¸€ç§ä¸UDP å®Œå…¨ä¸åŒçš„æœåŠ¡ã€‚\nTCP æ˜¯ [é¢å‘è¿æ¥] ä¸” [å¯é çš„] æœåŠ¡ï¼Œé¢å‘è¿æ¥æŒ‡ TCP çš„ä¸¤ä¸ªåº”ç”¨ç¨‹åºå¿…é¡»åœ¨å®ƒä»¬å¯äº¤æ¢æ•°æ®ä¹‹å‰ï¼Œé€šè¿‡ç›¸äº’è”ç³»æ¥å»ºç«‹ä¸€ä¸ª TCP è¿æ¥ TCP æä¾›äº†ä¸€ç§å­—èŠ‚æµæŠ½è±¡æ¦‚å¿µç»™åº”ç”¨ç¨‹åºï¼šä¸ä¼šè‡ªåŠ¨æ’å…¥è®°å½•æ ‡å¿—æˆ–è€… æ¶ˆæ¯è¾¹ç•Œ ï¼Œå¦‚å‘é€ç«¯åˆ†åˆ«å‘ 10 å­—èŠ‚å’Œ 30 å­—èŠ‚ï¼Œæ¥æ”¶ç«¯å¯èƒ½ä¼šä»¥ä¸¤ä¸ª 20 å­—èŠ‚çš„æ–¹å¼è¯»å…¥ã€‚\né€‚åˆä¼ è¾“å¤§é‡æ•°æ®ï¼Œä»¥åŠè¦æ±‚å¯é æ€§ä¼ è¾“çš„åœºæ™¯ï¼ˆè¦å¯¹æ•°æ®ç¡®è®¤ã€é‡å‘ã€æ’åºç­‰ï¼‰ï¼Œæ¯”å¦‚ç™»å½•ï¼Œä¼ æ–‡ä»¶ç­‰\nğŸ“ Note TCP çš„ç‰¹ç‚¹\né¢å‘è¿æ¥ ï¼Œé€šä¿¡ä¹‹å‰åŒæ–¹å¿…é¡»è¦å…ˆå»ºç«‹è¿æ¥\nåªæ”¯æŒ å•æ’­ ï¼Œå°±æ˜¯ç‚¹å¯¹ç‚¹çš„ä¼ è¾“ï¼Œä¸€æ¡ TCP è¿æ¥åªèƒ½æœ‰ä¸¤ä¸ªç«¯ç‚¹\næä¾› å¯é äº¤ä»˜ çš„æœåŠ¡ ï¼Œæœ‰å®Œæ•´æ€§æ ¡éªŒã€æ•°æ®ä¸ä¼šä¸¢å¤±ï¼Œä¼šä¸¢åŒ…é‡ä¼ ã€ä¸”ä¼šæŒ‰é¡ºåºåˆ°è¾¾\né¢å‘ å­—èŠ‚æµ ï¼Œä¸åƒ UDP é‚£æ ·ä¸€ä¸ªä¸ªæŠ¥æ–‡ç‹¬ç«‹ä¼ è¾“ï¼Œè€Œæ˜¯åœ¨ä¸ä¿ç•™æŠ¥æ–‡è¾¹ç•Œçš„æƒ…å†µä¸‹ä»¥å­—èŠ‚æµæ–¹å¼è¿›è¡Œä¼ è¾“\næä¾› æ‹¥å¡æ§åˆ¶ ï¼Œå½“ç½‘ç»œå‡ºç°æ‹¥å¡çš„æƒ…å†µï¼Œæœ‰æµé‡æ§åˆ¶ï¼Œèƒ½å¤Ÿå‡å°‘ä¼ è¾“æ•°æ®çš„é€Ÿåº¦å’Œæ•°é‡ï¼Œç¼“è§£æ‹¥å¡ï¼Œä¿è¯ç¨³å®š\næä¾› å…¨åŒå·¥é€šä¿¡ å’Œ å¯é é€šä¿¡ ï¼ŒæŒ‡çš„æ˜¯å‘é€æ–¹å’Œæ¥æ”¶æ–¹å¯ä»¥ åŒæ—¶ å‘é€/æ¥æ”¶æ•°æ® ã€‚å› ä¸ºä¸¤è¾¹éƒ½ä¼šè®¾ç½®æœ‰ å‘é€ç¼“å­˜ å’Œ æ¥æ”¶ç¼“å­˜\nå‘é€ç¼“å­˜ å°±æ˜¯å‘é€ç¼“å­˜çš„é˜Ÿåˆ—é‡Œé¢æœ‰å‡†å¤‡å‘é€çš„æ•°æ®å’Œå·²ç»å‘é€ä½†æ˜¯è¿˜æ²¡æœ‰æ”¶åˆ°æ¥è‡ªæ¥æ”¶æ–¹ç¡®è®¤çš„æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰æ”¶åˆ°ç¡®è®¤è¿˜è¦é‡å‘æ‰€ä»¥ä¸èƒ½æ‰”æ‰ï¼Œå°†å¯èƒ½ä¼šè¢«é‡ä¼ ï¼Œå› ä¸º TCP éœ€è¦ä¿è¯å¯é ä¼ è¾“ æ¥æ”¶ç¼“å­˜ å°±æ˜¯æŒ‰åºåˆ°è¾¾ä½†æ˜¯è¿˜æ²¡æœ‰è¢«æ¥æ”¶åº”ç”¨ç¨‹åºè¯»å–çš„æ•°æ®å’Œæ²¡æŒ‰åºåˆ°è¾¾çš„æ•°æ®ï¼Œéœ€è¦é¡ºåºæ’å¥½äº†ï¼Œæ¥æ”¶æ–¹æ‰èƒ½é€ä¸€æ¥æ”¶æ•°æ® å¯é ä¼ è¾“ ç”±äº TCP çš„ä¸‹å±‚ç½‘ç»œå±‚å¯èƒ½å‡ºç°ä¸¢å¤±ã€é‡å¤æˆ–ä¹±åºçš„æƒ…å†µï¼ŒTCP åè®®æ”¯æŒå¯é æ•°æ®ä¼ è¾“æœåŠ¡ã€‚\nå› ä¸ºæ¥æ”¶æ–¹æ”¶åˆ°æ•°æ®åä¼šå‘é€ä¸€ä¸ª ACK ç¡®è®¤åº”ç­”æ¶ˆæ¯ï¼Œè¿™æ ·å‘é€æ–¹å°±çŸ¥é“è‡ªå·±çš„æ•°æ®è¢«å¯¹æ–¹æ¥æ”¶äº†ï¼Œå¦‚æœä¸€ç›´æ²¡æœ‰æ”¶åˆ° ACK ä¸€å®šæ—¶é—´åå°±ä¼šé‡å‘ã€‚å› æ­¤å°±ç®—æ•°æ®æ²¡æœ‰å‘åˆ°æ¥æ”¶æ–¹ï¼Œæˆ–è€…æ¥æ”¶æ–¹çš„ ACK æ•°æ®åŒ…ä¸¢å¤±ä¹Ÿæœ‰é‡ä¼ æœºåˆ¶ï¼Œç¡®ä¿åŒæ–¹æœ€ç»ˆå¯ä»¥é€šè¿‡é‡ä¼ ä¹Ÿèƒ½æ­£ç¡®æ”¶åˆ°æ¶ˆæ¯\nä¸ºä¿æ•°æ®ä¼ è¾“çš„æ­£ç¡®æ€§ï¼Œå°±æ˜¯åœ¨å‘é€ä¸€ä¸ªæ•°æ®åŒ…ä¹‹åï¼Œå°±ä¼šå¼€å¯ä¸€ä¸ª å®šæ—¶å™¨ ï¼Œè‹¥åœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°å‘é€æ•°æ®çš„ ACKç¡®è®¤æŠ¥æ–‡ ï¼Œå°±ä¼šå¯¹è¯¥æŠ¥æ–‡è¿›è¡Œ é‡ä¼  ï¼Œåœ¨è¾¾åˆ°ä¸€å®šæ¬¡æ•°è¿˜æ²¡æœ‰æˆåŠŸæ—¶æ”¾å¼ƒå¹¶å‘é€ä¸€ä¸ª å¤ä½ä¿¡å· ã€‚\næ‹¥å¡æ§åˆ¶ ä¸»è¦ä½“ç°åœ¨å››ä¸ªæ–¹é¢ï¼š\nä¸€æ˜¯ æ…¢å¯åŠ¨ ï¼Œå¼€å§‹çš„æ—¶å€™ä¸è¦å‘é€å¤§é‡æ•°æ®ï¼Œå…ˆæµ‹è¯•ä¸€ä¸‹ç½‘ç»œï¼Œç„¶åæ…¢æ…¢ç”±å°åˆ°å¤§çš„å¢åŠ æ‹¥å¡çª—å£å¤§å° äºŒæ˜¯ æ‹¥å¡é¿å… ï¼Œä¸€æ—¦åˆ¤æ–­ç½‘ç»œå‡ºç°æ‹¥å¡ï¼Œå°±å°†ä¼ é€è®¾ç½®æˆå‡ºç°æ‹¥å¡æ—¶ä¸€åŠçš„å¤§å°ï¼Œå¹¶æŠŠæ‹¥å¡çª—å£è®¾ä¸º 1 ï¼Œå†é‡æ–°å¼€å§‹æ…¢å¯åŠ¨ç®—æ³• ä¸‰æ˜¯ å¿«é€Ÿé‡ä¼  ï¼Œå°±æ˜¯æ¥æ”¶æ–¹åœ¨æ”¶åˆ°ä¸€ä¸ªå¤±åºçš„æŠ¥æ–‡åç«‹å³å‘å‡ºé‡å¤ç¡®è®¤ï¼Œå¿«é‡ä¼ ç®—æ³•è§„å®šå‘é€æ–¹åªè¦è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤å°±ç«‹å³é‡ä¼ å¯¹æ–¹å°šæœªæ”¶åˆ°çš„æŠ¥æ–‡æ®µï¼Œè€Œä¸ç”¨ç»§ç»­ç­‰é‡ä¼ è®¡æ—¶å™¨åˆ°æœŸ å››æ˜¯ å¿«é€Ÿæ¢å¤ ï¼Œè€ƒè™‘åˆ°å¦‚æœç½‘ç»œå‡ºç°æ‹¥å¡çš„è¯ï¼Œå°±ä¸è‡³äºèƒ½è¿ç»­æ”¶åˆ°å¥½å‡ ä¸ªé‡å¤çš„ç¡®è®¤ï¼Œæ‰€ä»¥å‘é€æ–¹ä¼šè®¤ä¸ºç½‘ç»œå¯èƒ½æ²¡æœ‰å‡ºç°æ‹¥å¡ï¼Œè¿™æ ·å°±ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼Œè€Œæ˜¯æ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³• æµé‡æ§åˆ¶ ç›®çš„æ˜¯ä¸ºäº†è®©å‘é€æ–¹å‘é€æ•°æ®çš„é€Ÿåº¦ä¸è¦å¤ªå¿«ï¼Œè¦è®©æ¥æ”¶æ–¹æ¥å¾—åŠæ¥æ”¶ã€‚\nåœ¨æ¥æ”¶æ–¹ç¼“å­˜ä¸­å·²æ¥å—çš„æ•°æ®å¤„ç†ä¸è¿‡æ¥æ—¶ï¼Œå‡å°å‘é€æ–¹çš„çª—å£å¤§å°ï¼Œè®©æ¥æ”¶æ–¹æœ‰è¶³å¤Ÿçš„æ—¶é—´æ¥æ¥æ”¶æ•°æ®åŒ…ã€‚æˆ–æ˜¯æ¥æ”¶æ–¹æ¯”è¾ƒç©ºé—²æ—¶ï¼Œå‘é€æ–¹è°ƒå¤§çª—å£å¤§å°ï¼Œä»¥åŠ å¿«ä¼ è¾“ï¼Œåˆç†åˆ©ç”¨ç½‘ç»œèµ„æº\nä¸‰æ¬¡æ¡æ‰‹ ç½‘ç»œæ•°æ®ä¼ è¾“ä¸­ï¼Œä¼ è¾“å±‚åè®® TCP æ˜¯è¦å»ºç«‹è¿æ¥çš„å¯é ä¼ è¾“ï¼ŒTCP å»ºç«‹è¿æ¥çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç§°ä¸ºä¸‰æ¬¡æ¡æ‰‹ã€‚\nğŸ“ Note TCP ä¸‰æ¬¡æ¡æ‰‹æµç¨‹\nç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€(SYN,seq) ä¸€ä¸ª SYNæŠ¥æ–‡ ä¸€ä¸ªå®¢æˆ·ç«¯ åˆå§‹åŒ–éšæœºåºåˆ—å· (seq) ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åå‘å®¢æˆ·ç«¯å‘é€(SYN,ACK,seq,ack) è‡ªå·±çš„ SYNæŠ¥æ–‡ å’Œ ACKæŠ¥æ–‡ ä¸€ä¸ªæœåŠ¡ç«¯çš„ åˆå§‹åŒ–éšæœºåºåˆ—å· seq ä¸€ä¸ªç¡®è®¤å·ack=å®¢æˆ·ç«¯å‘æ¥çš„åºåˆ—å·+1ï¼Œè¡¨ç¤ºè‡ªå·±æ”¶åˆ°äº† ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„ç¡®è®¤åº”ç­”åï¼Œå‘æœåŠ¡ç«¯å‘é€(ACK,seq,ack) ç¡®è®¤åº”ç­”ACKæŠ¥æ–‡ ä¸€ä¸ªseqï¼Œå€¼ä¸ºç¬¬äºŒæ¬¡æ¡æ‰‹å®¢æˆ·ç«¯å‘è¿‡æ¥çš„ackçš„å€¼ ä¸€ä¸ªç¡®è®¤å·ackï¼Œå€¼ä¸ºæœåŠ¡ç«¯çš„åºåˆ—å·+1ï¼Œå‘Šè¯‰æœåŠ¡ç«¯æˆ‘æ”¶åˆ°äº† â˜•ï¸ Q~\u0026amp;~A\nä¸ºä»€ä¹ˆä¸èƒ½ä¸¤æ¬¡ï¼Ÿ\nç¡®è®¤åŒæ–¹ å‘é€ å’Œ æ¥æ”¶ çš„èƒ½åŠ›æ˜¯ä¸æ˜¯æ­£å¸¸ ç›¸äº’ ç¡®è®¤åˆå§‹åŒ–åºåˆ—å· ï¼Œå¹¶å‘Šè¯‰å¯¹æ–¹ä»€ä¹ˆæ ·åºå·çš„æŠ¥æ–‡èƒ½è¢«æ¥æ”¶ï¼Œåªç”¨ä¸¤æ¬¡çš„è¯ï¼ŒæœåŠ¡å™¨å°±ä¸çŸ¥é“è‡ªå·±çš„åºåˆ—å·æœ‰æ²¡æœ‰è¢«å¯¹æ–¹ç¡®è®¤ï¼Œå¯èƒ½é€ æˆå¤±æ•ˆçš„æŠ¥æ–‡æ®µè¢«æœåŠ¡å™¨æ¥æ”¶ï¼Œé€ æˆé”™è¯¯æƒ…å†µã€‚ ä¸ºä»€ä¹ˆä¸èƒ½å››æ¬¡ï¼Ÿ\nå› ä¸ºæ²¡å¿…è¦ï¼Œè¯¥ç¡®è®¤çš„ä¸‰æ¬¡éƒ½ç¡®è®¤å®Œäº†\nå››æ¬¡æŒ¥æ‰‹ å…³é—­ TCP è¿æ¥çš„æŒ¥æ‰‹ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¯ä»¥å‘èµ·å…³é—­æ“ä½œã€‚\nä»¥å®¢æˆ·ç«¯å‘èµ·ä¸ºä¾‹ï¼š\næµè§ˆå™¨å…ˆå‘é€ [FIN æŠ¥æ–‡]ã€[Seq = åˆå§‹åŒ–åºåˆ—å·] ç»™æœåŠ¡å™¨ï¼Œå¹¶åœæ­¢å‘é€æ•°æ®ï¼Œä½†ä»å¯ä»¥æ¥å—æœåŠ¡ç«¯å“åº”çš„æ•°æ® æœåŠ¡å™¨æ”¶åˆ°åï¼Œå‘é€ [ACK =æµè§ˆå™¨åºåˆ—å· + 1] ç»™æµè§ˆå™¨ï¼Œè¡¨æ˜æ”¶åˆ° æœåŠ¡å™¨æ•°æ®éƒ½å‘å®Œäº†ï¼Œç»™æµè§ˆå™¨å‘é€ [FIN æŠ¥æ–‡]ã€[Seq = åºåˆ—å·] ç»™æµè§ˆå™¨ æµè§ˆå™¨æ”¶åˆ°åï¼Œå‘é€ [ACK = æœåŠ¡å™¨åºåˆ—å· + 1] ç»™æœåŠ¡å™¨ï¼Œè¡¨æ˜æ”¶åˆ° ç¬¬å››æ¬¡æŒ¥æ‰‹ç»“æŸååéœ€è¦è¿‡ä¸€é˜µï¼ˆæ—¶é—´ç­‰å¾…è®¡æ—¶å™¨è®¾ç½®çš„æ—¶é—´ 2MSL åï¼‰ä»¥ç¡®ä¿æœåŠ¡å™¨æ”¶åˆ°è‡ªå·±çš„ ack æŠ¥æ–‡æ‰ä¼šè¿›å…¥å…³é—­çŠ¶æ€ï¼ŒæœåŠ¡å™¨æ”¶åˆ° ack æŠ¥æ–‡ä¹‹åï¼Œä¹Ÿå…³é—­è¿æ¥\nâ˜•ï¸ Q~\u0026amp;~A\nä¸ºä»€ä¹ˆè¦ç­‰ä¸€æ®µæ—¶é—´å†å…³é—­ï¼Œä¸ç­‰ä¸è¡Œå—ï¼Ÿ\nè¿™æ˜¯ä¸ºäº†é˜²æ­¢å‘é€ç»™æœåŠ¡å™¨çš„ç¡®è®¤æŠ¥æ–‡æ®µä¸¢å¤±æˆ–è€…å‡ºé”™ï¼Œä»è€Œå¯¼è‡´æœåŠ¡ç«¯ä¸èƒ½æ­£å¸¸å…³é—­ã€‚ç­‰å¾…æ—¶é—´æ˜¯ 2MSL ï¼Œè¿™ä¹Ÿæ˜¯æŠ¥æ–‡åœ¨ç½‘ç»œä¸Šçš„æœ€å¤§ç”Ÿå­˜æ—¶é—´ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´å°±ä¼šè¢«ä¸¢å¼ƒã€‚\nRFC793 ä¸­è§„å®š MSL ä¸º 2åˆ†é’Ÿ ï¼Œä½†å®é™…åº”ç”¨ä¸­å¸¸ç”¨çš„æ˜¯ 30ç§’ ï¼Œ1åˆ†é’Ÿ å’Œ 2åˆ†é’Ÿ éƒ½æœ‰ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œé‚£ä¹ˆä¸»åŠ¨å…³é—­è€…å°±ä¼šå‘é€ä¸€ä¸ª RSTçŠ¶æ€ä½ çš„åŒ…ï¼Œè¡¨ç¤ºé‡ç½®è¿æ¥ï¼Œè¿™æ—¶å€™è¢«å…³é—­è€…å°±çŸ¥é“å¯¹æ–¹å·²ç»å…³é—­äº†è¿æ¥ã€‚\nå¦‚æœä¸»åŠ¨å…³é—­è€…ä¸è¿›è¡Œç­‰å¾…ï¼Œç”±äºç«¯å£å¤ç”¨çš„åŸå› ï¼Œä¸»åŠ¨å…³é—­å¯èƒ½å·²ç»å¼€å¯äº†å¦ä¸€ä¸ªè¿æ¥ï¼Œè¿™æ—¶å€™è¢«å…³é—­è€…è¿˜åœ¨é‡è¯•å‘èµ· FINè¯·æ±‚ ï¼Œå¯¼è‡´ä¸»åŠ¨å…³é—­è€…æ”¶åˆ°å¾ˆå¤šæ²¡ç”¨çš„åŒ…ã€‚å› ä¸ºåŒ…æ˜¯æœ‰åºåˆ—å·çš„ï¼Œæ‰€ä»¥å¯ä»¥åˆ¤æ–­åˆ°ä¸æ˜¯æœ¬æ¬¡è¿æ¥è¯¥æ¥æ”¶çš„åŒ…ï¼Œå°±ä¸ä¼šç®¡ã€‚ä¸ºæ­¤éœ€è¦è®©ä¸»åŠ¨å…³é—­è€…ç­‰å¾…ï¼Œç¡®ä¿è¢«å…³é—­è€…ä¸ä¼šå†å‘é€ FINè¯·æ±‚ äº†å†è¿›è¡Œç«¯å£å¤ç”¨ã€‚\nä¸ºä»€ä¹ˆè¦å››æ¬¡æŒ¥æ‰‹\nTCP ä½¿ç”¨å››æ¬¡æŒ¥æ‰‹æ˜¯å› ä¸º TCP çš„è¿æ¥æ˜¯å…¨åŒå·¥çš„ï¼Œæ‰€ä»¥éœ€è¦åŒæ–¹åˆ†åˆ«é‡Šæ”¾å¯¹æ–¹çš„è¿æ¥ï¼Œå•ç‹¬çš„ä¸€æ–¹çš„è¿æ¥é‡Šæ”¾ï¼Œåªèƒ½ä»£è¡¨ä¸èƒ½å†å‘å¯¹æ–¹ å‘é€æ•°æ® ï¼Œä½†ä»ç„¶å¯ä»¥ æ¥æ”¶æ•°æ® ã€‚\næ‰€ä»¥åœ¨å…³é—­è¿æ¥æ—¶ï¼ŒæœåŠ¡ç«¯æ”¶åˆ° FINæŠ¥æ–‡ æ—¶ï¼Œå¾ˆå¯èƒ½å¹¶ä¸ä¼šç«‹å³å…³é—­ socket ï¼Œå› ä¸ºå®ƒå¯èƒ½è¿˜æœ‰æŠ¥æ–‡æ²¡æœ‰å‘é€å®Œï¼Œæ‰€ä»¥åªèƒ½å›å¤ä¸€ä¸ª ackæŠ¥æ–‡ ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯â€œä½ å‘çš„æŠ¥æ–‡æˆ‘æ”¶åˆ°äº†â€ï¼Œç­‰æˆ‘æ‰€æœ‰çš„æŠ¥æ–‡éƒ½å‘é€å®Œäº†ï¼Œæˆ‘æ‰èƒ½å‘é€ FINæŠ¥æ–‡ ï¼Œå› æ­¤ä¸èƒ½ä¸€èµ·å‘é€ï¼Œæ‰€ä»¥éœ€è¦å››æ¬¡æŒ¥æ‰‹ã€‚\nç²˜åŒ…å¤„ç† ç²˜åŒ…æ˜¯æŒ‡ä¸ºäº†é˜²æ­¢æ•°æ®é‡è¿‡å°å¯¼è‡´å¤§é‡ä¼ è¾“ï¼Œå…¨å°†å¤šä¸ªTCPæ®µåˆå¹¶æˆä¸€ä¸ªå‘é€ã€‚å°±æ˜¯å°†è‹¥å¹²ä¸ªåŒ…æ•°æ®ç²˜æˆä¸€ä¸ªåŒ…ï¼Œä»æ¥æ”¶ç¼“å†²åŒºçœ‹ï¼Œåä¸€åŒ…æ•°æ®çš„å¤´ç´§æ¥é€å‰ä¸€åŒ…æ•°æ®çš„å°¾ã€‚å› ä¸ºTCPå±‚ä¼ è¾“æ˜¯æµå¼ä¼ è¾“ï¼Œæµï¼Œæœ€å¤§çš„é—®é¢˜æ˜¯æ²¡æœ‰è¾¹ç•Œï¼Œæ²¡æœ‰è¾¹ç•Œå°±ä¼šé€ æˆæ•°æ®ç²˜åœ¨ä¸€èµ·\næ‹†åŒ…å°±æ˜¯å°†ä»»åŠ¡æ‹†åˆ†å¤„ç†äº†ï¼Œé™ä½å‡ºé”™ç‡\né€ æˆåœºæ™¯ æ¥æ”¶æ–¹ä¸åŠæ—¶æ¥æ”¶ç¼“å†²åŒºçš„åŒ…ï¼Œé€ æˆå¤šä¸ªåŒ…æ¥æ”¶ å› ä¸º TCP é»˜è®¤ä½¿ç”¨ Nagle ç®—æ³• ï¼Œè¿™ä¸ªç®—æ³•æœ¬èº«ä¹Ÿå¯èƒ½ä¼šå¯¼è‡´ç²˜åŒ…é—®é¢˜ ç”±äºTCPçš„ å¤ç”¨ é€ æˆç²˜åŒ…ã€‚ç”±äº TCP è¿æ¥çš„å¤ç”¨æ€§ï¼Œå»ºç«‹ä¸€æ¡è¿æ¥å¯ä»¥ä¾›ä¸€å°ä¸»æœºä¸Šçš„å¤šä¸ªè¿›ç¨‹ä½¿ç”¨ï¼Œé‚£ä¹ˆå¤šç§ä¸åŒç»“æ„çš„æ•°æ®åˆ°TCPçš„æµå¼ä¼ è¾“é‡Œï¼Œè¾¹ç•Œåˆ†å‰²è‚¯å®šä¼šå‡ºç°å¥‡è‘©çš„é—®é¢˜ æ•°æ®åŒ…è¿‡å¤§é€ æˆçš„ç²˜åŒ…é—®é¢˜ï¼Œæ¯”å¦‚åº”ç”¨è¿›ç¨‹ç¼“å†²åŒºçš„ä¸€æ¡æ¶ˆæ¯å†…å®¹å¤§å°è¶…è¿‡äº†å‘é€ç¼“å­˜åŒºçš„å¤§å°ï¼Œå°±å¯èƒ½äº§ç”Ÿç²˜åŒ…ï¼Œå› ä¸ºæ¶ˆæ¯å·²ç»è¢«åˆ†å‰²äº†ï¼Œå‰ä¸€éƒ¨åˆ†å·²ç»è¢«æ¥æ”¶äº†ï¼Œä½†å¦ä¸€éƒ¨åˆ†å¯èƒ½åˆšæ”¾å…¥ç¼“å­˜å†²åŒºå‡†å¤‡å‘é€ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´åä¸€éƒ¨åˆ†ç²˜åŒ… æµé‡æ§åˆ¶ï¼Œæ‹¥å¡æ§åˆ¶ä¹Ÿå¯èƒ½å¯¼è‡´ç²˜åŒ… Nagleç®—æ³•ï¼Œä¸»è¦åšä¸¤ä»¶äº‹ï¼š ä¸€æ˜¯åªæœ‰ä¸Šä¸€ä¸ªåˆ†ç»„å¾—åˆ°ç¡®è®¤ï¼Œæ‰ä¼šå‘é€ä¸‹ä¸€ä¸ªåˆ†ç»„ï¼› äºŒæ˜¯æ”¶é›†å¤šä¸ªå°åˆ†ç»„ï¼Œæ•°æ®åŒ…å¤§å°è¾¾åˆ°æœ€å¤§æ®µå¤§å°(M121 b bSS)ï¼Œåœ¨ä¸€ä¸ªç¡®è®¤åˆ°æ¥æ—¶ä¸€èµ·å‘é€ã€‚ å¤šä¸ªåˆ†ç»„æ‹¼æˆä¸€ä¸ªæ•°æ®æ®µå‘å‡ºå»ï¼Œå¦‚æœæ²¡æœ‰å¤„ç†å¥½è¾¹ç•Œé—®é¢˜ï¼Œåœ¨è§£åŒ…çš„æ—¶å€™å°±ä¼šå‘ç”Ÿç²˜åŒ… å¤åˆ¶ä»£ç  ç²˜åŒ…å¤„ç† å¦‚æœæ˜¯Nagleç®—æ³•å¯¼è‡´çš„ï¼Œç»“åˆåº”ç”¨åœºæ™¯é€‚å½“å…³é—­ç®—æ³•å°±å¯ä»¥äº† å¦‚æœä¸æ˜¯ å°¾éƒ¨æ ‡è®°åºåˆ—ã€‚é€šè¿‡ç‰¹æ®Šæ ‡è¯†ç¬¦è¡¨ç¤ºæ•°æ®åŒ…çš„è¾¹ç•Œï¼Œæ¯”å¦‚\\n\\r\\tæˆ–ä¸€äº›éšè—å­—ç¬¦ å¤´éƒ¨æ ‡è®°åˆ†æ­¥æ¥æ”¶ã€‚åœ¨TCPæŠ¥æ–‡çš„å¤´éƒ¨åŠ ä¸Šè¡¨ç¤ºæ•°æ®é•¿åº¦ã€‚ä½¿ç”¨å¸¦æ¶ˆæ¯å¤´çš„åè®®ï¼Œæ¶ˆæ¯å¤´å­˜å‚¨å¼€å§‹æ ‡è¯†åŠæ¶ˆæ¯é•¿åº¦ä¿¡æ¯ï¼ŒæœåŠ¡å•†è·å–æ¶ˆæ¯å¤´çš„æ—¶å€™è§£æå‡ºæ¶ˆæ¯é•¿åº¦ï¼Œç„¶åå‘åè¯»å–è¯¥é•¿åº¦çš„å†…å®¹ åº”ç”¨å±‚å‘é€æ•°æ®æ—¶å®šé•¿å‘é€ï¼ŒæœåŠ¡ç«¯è¯»å–æ—¢å®šé•¿åº¦çš„å†…å®¹ä½œä¸ºä¸€æ¡å®Œæ•´æ¶ˆæ¯ï¼Œå¦‚æœä¸å¤Ÿé•¿ï¼Œå°±åœ¨ç©ºä½ä¸Šè¡¥å›ºå®šå­—ç¬¦ UDPä¸ºä»€ä¹ˆä¸ä¼šç²˜åŒ… å› ä¸ºUDPæ˜¯é¢å‘æ¶ˆæ¯çš„åè®®ï¼ŒUDPæ®µéƒ½æ˜¯ä¸€æ¡æ¶ˆæ¯ï¼Œåº”ç”¨ç¨‹åºå¿…é¡»ä»¥æ¶ˆæ¯ä¸ºå•ä½æå–æ•°æ®ï¼Œä¸èƒ½ä¸€æ¬¡æå–ä»»æ„å­—èŠ‚çš„æ•°æ® UDPå…·æœ‰ä¿æŠ¤æ¶ˆæ¯è¾¹ç•Œï¼Œåœ¨æ¯ä¸ªUDPåŒ…ä¸­æœ‰æ¶ˆæ¯å¤´ï¼ˆæ¶ˆæ¯æ¥æºåœ°å€ï¼Œç«¯å£ä¿¡æ¯ç­‰ï¼‰ï¼Œè¿™æ ·å¯¹äºæ¥æ”¶ç«¯æ¥è¯´å®¹æ˜“è¿›è¡Œåˆ†åŒºå¤„ç†ã€‚ä¼ è¾“åè®®æŠŠæ•°æ®å½“ä½œä¸€æ¡ç‹¬ç«‹çš„æ¶ˆæ¯åœ¨ç½‘ä¸Šä¼ è¾“ï¼Œæ¥æ”¶æ–¹åªèƒ½æ¥æ”¶ç‹¬ç«‹çš„æ¶ˆæ¯ï¼Œå¦‚æœæ¶ˆæ¯å†…å®¹è¿‡å¤§ï¼Œè¶…è¿‡æ¥æ”¶æ–¹ä¸€æ¬¡æ‰€èƒ½æ¥å—çš„å¤§å°ï¼Œå°±ä¼šä¸¢å¤±ä¸€éƒ¨åˆ†æ•°æ®ï¼Œå› ä¸ºå°±ç®—æ˜¯ä¸¢å¤±ï¼Œå®ƒä¹Ÿä¸ä¼šåˆ†ä¸¤æ¬¡å»æ¥æ”¶ UDP^User-Datagram-Protocol^ UDP - User Datagram Protocol^ç”¨æˆ·æ•°æ®æŠ¥åè®®^\nUDP æŠŠé‡ç‚¹æ”¾åœ¨äº†æ•°æ®æŠ¥ä¸Šï¼Œå®ƒä¸ºåº”ç”¨å±‚æä¾›äº†ä¸€ç§æ— éœ€å»ºç«‹è¿æ¥å°±å¯ä»¥ç›´æ¥å‘é€æ•°æ®æŠ¥çš„æ–¹æ³•ã€‚\né€‚åˆä¼ è¾“å°‘é‡æ•°æ®ï¼Œä»¥åŠè¦æ±‚æ•ˆç‡é«˜çš„åœºæ™¯ï¼Œæ¯”å¦‚å®æ—¶åº”ç”¨ï¼Œå³æ—¶é€šè®¯ï¼ŒèŠå¤©è§†é¢‘é€šè¯ç­‰\nğŸ“ Note UDP çš„ç‰¹ç‚¹\næ— è¿æ¥ï¼š ä¸éœ€è¦æ¡æ‰‹å’ŒæŒ¥æ‰‹å°±å¯ä»¥ç›´æ¥å‘é€æ•°æ®ã€‚\nä¸å¯é æ€§ï¼šå°±æ˜¯ä¸€ä¸ªä¼ é€’æ•°æ®çš„æ¬è¿å·¥ï¼Œæ¥ä¸€ä¸ªåŒ…å°±å‘ä¸€ä¸ªã€‚ä¸ä¼šå¤‡ä»½ï¼Œä¹Ÿä¸å…³å¿ƒå¯¹æ–¹æ˜¯å¦æ­£ç¡®æ”¶åˆ°ï¼Œä¼ è¾“é¡ºåºä¹Ÿæ— æ³•ä¿è¯ã€‚æ‰€ä»¥å°±åªèƒ½ç”±åº”ç”¨å±‚æ¥ä¿è¯å¯é ï¼Œå› ä¸ºç½‘ç»œå±‚ä¹Ÿæ˜¯ä¸å¯é çš„\nåœ¨å‘é€ç«¯åº”ç”¨å±‚å°†æ•°æ®ä¼ ç»™ä¼ è¾“å±‚çš„ UDP ï¼Œå®ƒåª åŠ ä¸€ä¸ªUDPå¤´æ ‡è¯† (UDPåè®®)ï¼Œå°±ç›´æ¥å‘ç»™ç½‘ç»œå±‚äº†ã€‚ æ¥æ”¶ç«¯åœ¨ç½‘ç»œå±‚å°†æ•°æ®å‘ç»™ä¼ è¾“å±‚ï¼Œä¼ è¾“å±‚UDPåªå»æ‰IPæŠ¥æ–‡å¤´å°±ä¼ ç»™åº”ç”¨å±‚äº†ã€‚ å…¶ä»–ä»€ä¹ˆéƒ½ä¸ä¼šç®¡ï¼Œä¸è¿‡è¿™ä¹Ÿå‡å°‘å¼€é”€å’Œå‘é€æ•°æ®ä¹‹å‰çš„å»¶è¿Ÿ æ”¯æŒå¹¿æ’­ï¼šæœ‰å•æ’­ï¼Œå¤šæ’­ï¼Œå¹¿æ’­çš„åŠŸèƒ½ï¼Œä¸åªæ”¯æŒä¸€å¯¹ä¸€ä¼ è¾“æ–¹å¼ï¼Œè¿˜æ”¯æŒä¸€å¯¹å¤šï¼Œå¤šå¯¹å¤šçš„æ–¹å¼\né¦–éƒ¨å¼€é”€å°ï¼š8ä¸ªå­—èŠ‚ï¼ˆæºç«¯å£å·(éå¿…å¡«)ã€ç›®çš„ç«¯å£å·ã€UDPé•¿åº¦(æ•°æ®æŠ¥çš„æ•´ä¸ªé•¿åº¦)ã€UDPæ£€æŸ¥å’Œ(æ£€æµ‹UDPæ•°æ®æŠ¥æ˜¯å¦æœ‰é”™æˆ–è€…ç›®çš„ç«¯å£æ‰¾ä¸åˆ°å¯¹åº”çš„è¿›ç¨‹ï¼Œå„2å­—èŠ‚ï¼‰ï¼Œå› ä¸ºå®ƒè¦æ±‚ä¸é«˜è€Œä¸”å®ç°çš„åŠŸèƒ½æ²¡æœ‰é‚£ä¹ˆå¤šï¼Œæ‰€ä»¥é¦–éƒ¨å­—æ®µä¸å¤šï¼Œè€ŒTCPæœ‰20ä¸ªå­—èŠ‚ã€‚å®ƒçš„æ•°æ®æ˜¯å¯ä»¥ä¸º0çš„ï¼Œæ‰€ä»¥å®ƒæœ€å°‘å¯ä»¥æ˜¯8ä¸ªå­—èŠ‚\né¢å‘æŠ¥æ–‡ï¼šé€‚åˆä¸€æ¬¡æ€§ä¼ è¾“å°‘é‡æ•°æ®ï¼Œå› ä¸ºåº”ç”¨å±‚ç»™UDPå¤šé•¿çš„æŠ¥æ–‡éƒ½ä¼šç…§æ ·å‘é€ï¼Œå³ä¸€æ¬¡å‘é€ä¸€ä¸ªå®Œæ•´çš„æŠ¥æ–‡ï¼Œå³ä¸åˆå¹¶ä¹Ÿä¸æ‹†åˆ†ã€‚å¦‚æœæŠ¥æ–‡å¤ªé•¿çš„è¯ï¼ŒUDPå®Œæ•´çš„è£…è¿›æ¥äº¤ç»™ç½‘ç»œå±‚çš„è¯ï¼Œç½‘ç»œå±‚å°±è¦åˆ†ç‰‡äº†ï¼Œå› ä¸ºä¼ ç»™é“¾è·¯å±‚çš„è¯å®ƒæœ‰ä¸€ä¸ªMTUçš„è¦æ±‚ï¼Œæ‰€ä»¥ç½‘ç»œå±‚å°±è¦åˆ†ç‰‡ï¼Œè¿™ä¼šç»™ç½‘ç»œå±‚çš„æ•ˆç‡é€ æˆå½±å“\næ— æ‹¥å¡æ§åˆ¶ï¼šé€‚åˆå®æ—¶åº”ç”¨ï¼Œå› ä¸ºå®ƒä¼šä¸€ç›´ä»¥æ’å®šçš„é€Ÿåº¦å‘é€æ•°æ®ï¼Œå³ä½¿ç½‘ç»œæ¡ä»¶ä¸å¥½ï¼Œä¹Ÿä¸ä¼šå¯¹å‘é€é€Ÿç‡è¿›è¡Œè°ƒæ•´ã€‚è¿™å°±å¯¼è‡´åœ¨ç½‘ç»œä¸å¥½çš„æƒ…å†µä¸‹å°±æœ‰å¯èƒ½ä¸¢åŒ…ï¼Œä½†ä¼˜ç‚¹ä¹Ÿæ˜æ˜¾ï¼Œåœ¨æŸäº›å®æ—¶æ€§è¦æ±‚é«˜çš„åœºæ™¯æ¯”å¦‚è¯´èŠå¤©ã€åœ¨çº¿è§†é¢‘ã€ç½‘ç»œè¯­éŸ³ç”µè¯ç­‰ä½¿ç”¨UDPè€Œä¸æ˜¯TCPï¼Œæ¯”å¦‚æ‰“å¾®ä¿¡ç”µè¯å‡ºç°å¶å°”æ–­ç»­ä¸æ˜¯å¤ªå¤§é—®é¢˜ã€‚å½“ç„¶æ‹¥å¡å¤ªä¸¥é‡ä¹Ÿæœ‰ä¸€äº›è¡¥æ•‘æªæ–½æ¯”å¦‚å‘å‰çº é”™æˆ–è€…é‡\nSocket ç½‘ç»œä¸Šçš„ä¸¤ä¸ªç¨‹åºé€šè¿‡ä¸€ä¸ª [åŒå‘çš„é€šè®¯è¿æ¥] å®ç°æ•°æ®çš„äº¤æ¢ï¼Œè¿™ä¸ªåŒå‘é“¾è·¯çš„ä¸€ç«¯ç§°ä¸ºä¸€ä¸ª Socket ã€‚Socket é€šå¸¸ç”¨æ¥å®ç°å®¢æˆ·æ–¹å’ŒæœåŠ¡æ–¹çš„è¿æ¥ã€‚Socket æ˜¯ TCP/IP åè®®çš„ä¸€ä¸ªååˆ†æµè¡Œçš„ç¼–ç¨‹ç•Œé¢ï¼Œä¸€ä¸ª Socket ç”±ä¸€ä¸ª [IP åœ°å€]å’Œä¸€ä¸ª [ç«¯å£å·] å”¯ä¸€ç¡®å®šã€‚\nä½†æ˜¯ï¼ŒSocket æ‰€æ”¯æŒçš„åè®®ç§ç±»ä¹Ÿä¸å…‰ TCP/IPã€UDPï¼Œå› æ­¤ä¸¤è€…ä¹‹é—´æ˜¯æ²¡æœ‰å¿…ç„¶è”ç³»çš„ã€‚åœ¨ Java ç¯å¢ƒä¸‹ï¼ŒSocket ç¼–ç¨‹ä¸»è¦æ˜¯æŒ‡åŸºäº TCP/IP åè®®çš„ç½‘ç»œç¼–ç¨‹ã€‚\nSocket è¿æ¥å°±æ˜¯æ‰€è°“çš„ é•¿è¿æ¥ ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€è¦äº’ç›¸è¿æ¥ï¼Œç†è®ºä¸Šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¸€æ—¦å»ºç«‹èµ·è¿æ¥å°†ä¸ä¼šä¸»åŠ¨åˆ‡æ–­\nSocket åå‘äºåº•å±‚ã€‚ä¸€èˆ¬å¾ˆå°‘ç›´æ¥ä½¿ç”¨ Socket æ¥ç¼–ç¨‹ï¼Œæ¡†æ¶åº•å±‚ä½¿ç”¨Socket æ¯”è¾ƒå¤šï¼Œ\nğŸ’¡ Trick\nSocket æ˜¯åº”ç”¨å±‚ä¸ TCP/IP åè®®æ—é€šä¿¡çš„ [ä¸­é—´è½¯ä»¶æŠ½è±¡å±‚] ï¼Œå®ƒæ˜¯ä¸€ç»„æ¥å£ï¼Œä»‹äº [ä¼ è¾“å±‚] å’Œ [åº”ç”¨å±‚] ä¹‹é—´ã€‚åœ¨è®¾è®¡æ¨¡å¼ä¸­ï¼ŒSocket å…¶å®å°±æ˜¯ä¸€ä¸ª å¤–è§‚æ¨¡å¼ ï¼Œå®ƒæŠŠå¤æ‚çš„ TCP/IP åè®®æ—éšè—åœ¨ Socket æ¥å£åé¢ï¼Œå¯¹ç”¨æˆ·æ¥è¯´ï¼Œä¸€ç»„ç®€å•çš„æ¥å£å°±æ˜¯å…¨éƒ¨ï¼Œè®© Socket å»ç»„ç»‡æ•°æ®ï¼Œä»¥ç¬¦åˆæŒ‡å®šçš„åè®®ã€‚\nå¤–è§‚æ¨¡å¼ï¼šä¹Ÿå«é—¨é¢æ¨¡å¼ï¼Œéšè—ç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œå¹¶å‘å®¢æˆ·ç«¯æä¾›äº†ä¸€ä¸ªå®¢æˆ·ç«¯å¯ä»¥è®¿é—®ç³»ç»Ÿçš„æ¥å£ã€‚\nå®ƒå‘ç°æœ‰çš„ç³»ç»Ÿæ·»åŠ ä¸€ä¸ªæ¥å£ï¼Œç”¨è¿™ä¸€ä¸ªæ¥å£æ¥éšè—å®é™…çš„ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚ä½¿ç”¨å¤–è§‚æ¨¡å¼ï¼Œå¤–éƒ¨çœ‹èµ·æ¥å°±æ˜¯ä¸€ä¸ªæ¥å£ï¼Œè€Œå†…éƒ¨åˆ™ç”±å¤æ‚é»‘ç®±å®ç°ã€‚\nğŸ“ Note\nSocket è¿æ¥æ˜¯ é•¿è¿æ¥ ï¼Œç†è®ºä¸Šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¸€æ—¦å»ºç«‹èµ·è¿æ¥å°†ä¸ä¼šä¸»åŠ¨æ–­æ‰ Socket é€‚ç”¨åœºæ™¯ï¼šç½‘ç»œæ¸¸æˆï¼Œé“¶è¡ŒæŒç»­äº¤äº’ï¼Œç›´æ’­ï¼Œåœ¨çº¿è§†é¢‘ç­‰ WebSocket ğŸ“ Location [åº”ç”¨å±‚]\nWebSocket æ˜¯ HTML5 å®šä¹‰çš„ä¸€ä¸ªæ–°åè®®ï¼Œå±äº æœåŠ¡å™¨æ¨é€æŠ€æœ¯push technology çš„ä¸€ç§ã€‚ä¸ä¼ ç»Ÿçš„ HTTP åè®®ä¸åŒï¼Œè¯¥åè®®å…è®¸ç”±æœåŠ¡å™¨ä¸»åŠ¨çš„å‘å®¢æˆ·ç«¯æ¨é€ä¿¡æ¯ã€‚\nä½¿ç”¨ WebSocket åè®®çš„ç¼ºç‚¹æ˜¯åœ¨æœåŠ¡å™¨ç«¯çš„é…ç½®æ¯”è¾ƒå¤æ‚ã€‚WebSocket æ˜¯ä¸€ä¸ª [å…¨åŒå·¥] çš„åè®®ï¼Œä¹Ÿå°±æ˜¯é€šä¿¡åŒæ–¹æ˜¯ å¹³ç­‰ çš„ï¼Œå¯ä»¥ç›¸äº’å‘é€æ¶ˆæ¯ã€‚\nğŸ’¡ Trick WebSocket çš„å…¶ä»–ç‰¹ç‚¹åŒ…æ‹¬ï¼š\nå»ºç«‹åœ¨ TCP åè®®ä¹‹ä¸Šï¼ŒæœåŠ¡å™¨ç«¯çš„å®ç°æ¯”è¾ƒå®¹æ˜“ ä¸ HTTP åè®®æœ‰ç€è‰¯å¥½çš„å…¼å®¹æ€§ã€‚é»˜è®¤ç«¯å£ä¹Ÿæ˜¯ 80^ws^ å’Œ 443^wss^ ï¼Œå¹¶ä¸”æ¡æ‰‹é˜¶æ®µé‡‡ç”¨ [HTTP åè®®]ï¼Œå› æ­¤æ¡æ‰‹æ—¶ä¸å®¹æ˜“å±è”½ï¼Œèƒ½é€šè¿‡å„ç§ HTTP ä»£ç†æœåŠ¡å™¨ æ•°æ®æ ¼å¼æ¯”è¾ƒè½»é‡ï¼Œæ€§èƒ½å¼€é”€å°ï¼Œé€šä¿¡é«˜æ•ˆ å¯ä»¥å‘é€æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥å‘é€äºŒè¿›åˆ¶æ•°æ® æ²¡æœ‰ åŒæºé™åˆ¶ ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸ [ä»»æ„æœåŠ¡å™¨] é€šä¿¡ åè®®æ ‡è¯†ç¬¦æ˜¯ wsï¼ˆå¦‚æœåŠ å¯†ï¼Œåˆ™ä¸º wssï¼‰ï¼ŒæœåŠ¡å™¨ç½‘å€å°±æ˜¯ URL ws://example.com:80/some/path ğŸ“ Note\nWebSocket è®¾è®¡ç›®çš„æ˜¯ä¸ºäº†è§£å†³ HTTP åè®®çš„ç¼ºé™·ï¼šé€šä¿¡åªèƒ½ç”± å®¢æˆ·ç«¯ å‘èµ·ï¼Œä¸å…·å¤‡ æœåŠ¡å™¨æ¨é€ èƒ½åŠ›ã€‚\nä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ä»¬æƒ³äº†è§£æŸ¥è¯¢ä»Šå¤©çš„å®æ—¶æ•°æ®ï¼Œåªèƒ½æ˜¯å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼ŒæœåŠ¡å™¨è¿”å›æŸ¥è¯¢ç»“æœã€‚HTTP åè®®åšä¸åˆ°æœåŠ¡å™¨ä¸»åŠ¨å‘å®¢æˆ·ç«¯ ä¸»åŠ¨æ¨é€ ä¿¡æ¯ã€‚\nè¿™ç§å•å‘è¯·æ±‚çš„ç‰¹ç‚¹ï¼Œæ³¨å®šäº†å¦‚æœæœåŠ¡å™¨æœ‰è¿ç»­çš„çŠ¶æ€å˜åŒ–ï¼Œå®¢æˆ·ç«¯è¦è·çŸ¥å°±éå¸¸éº»çƒ¦ã€‚\nå› æ­¤åªèƒ½ä½¿ç”¨ [è½®è¯¢]ï¼šæ¯éš”ä¸€æ®µæ—¶å€™ï¼Œå°±å‘å‡ºä¸€ä¸ªè¯¢é—®ï¼Œäº†è§£æœåŠ¡å™¨æœ‰æ²¡æœ‰æ–°çš„ä¿¡æ¯ã€‚æœ€å…¸å‹çš„åœºæ™¯å°±æ˜¯èŠå¤©å®¤ã€‚è½®è¯¢çš„æ•ˆç‡ä½ï¼Œéå¸¸æµªè´¹èµ„æºï¼ˆå› ä¸ºå¿…é¡»ä¸åœè¿æ¥^çŸ­è½®è¯¢^ ï¼Œæˆ–è€… HTTP è¿æ¥å§‹ç»ˆæ‰“å¼€^é•¿è½®è¯¢^ ï¼‰ã€‚\nåœ¨ WebSocket åè®®å‡ºç°ä»¥å‰ï¼Œåˆ›å»ºä¸€ä¸ªå’ŒæœåŠ¡ç«¯è¿›åŒé€šé“é€šä¿¡çš„ web åº”ç”¨ï¼Œéœ€è¦ä¾èµ– HTTP åè®®è¿›è¡Œä¸åœçš„è½®è¯¢ï¼Œè¿™ä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ï¼š\næœåŠ¡ç«¯è¢«è¿«ç»´æŒæ¥è‡ªæ¯ä¸ªå®¢æˆ·ç«¯çš„å¤§é‡ä¸åŒçš„è¿æ¥ å¤§é‡çš„è½®è¯¢è¯·æ±‚ä¼šé€ æˆé«˜å¼€é”€ï¼Œæ¯”å¦‚ä¼šå¸¦ä¸Šå¤šä½™çš„ header ï¼Œé€ æˆäº†æ— ç”¨çš„æ•°æ®ä¼ è¾“ ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼ŒWebSocket åè®®ç”±æ­¤è€Œç”Ÿï¼Œäº 2011 å¹´è¢« IETF å®šä¸ºæ ‡å‡† RFC6455 ï¼Œå¹¶è¢« RFC7936 æ‰€è¡¥å……ã€‚\nå¹¶ä¸”åœ¨ HTML5 æ ‡å‡†ä¸­å¢åŠ äº†æœ‰å…³ WebSocket åè®®çš„ç›¸å…³ apiï¼Œæ‰€ä»¥åªè¦å®ç°äº† HTML5 æ ‡å‡†çš„å®¢æˆ·ç«¯ï¼Œå°±å¯ä»¥ä¸æ”¯æŒ WebSocket åè®®çš„æœåŠ¡å™¨è¿›è¡Œå…¨åŒå·¥çš„æŒä¹…é€šä¿¡äº†ã€‚\nç”Ÿå‘½å‘¨æœŸ ä¸ HTTP åè®®ä¸€æ ·ï¼ŒWebSocket åè®®ä¹Ÿéœ€è¦é€šè¿‡å·²å»ºç«‹çš„ TCP è¿æ¥æ¥ä¼ è¾“æ•°æ®ã€‚å…·ä½“å®ç°ä¸Šæ˜¯é€šè¿‡ HTTP åè®®å»ºç«‹é€šé“ï¼Œç„¶ååœ¨æ­¤åŸºç¡€ä¸Šç”¨çœŸæ­£çš„WebSocketåè®®è¿›è¡Œé€šä¿¡ï¼Œæ‰€ä»¥ WebSocket åè®®å’Œ HTTP åè®®æ˜¯æœ‰ä¸€å®šçš„äº¤å‰å…³ç³»çš„ã€‚è€Œ WebSocket æ˜¯ åŒå‘é€šä¿¡ åè®®ï¼Œæ¨¡æ‹Ÿ [Socketåè®®] ï¼Œå¯ä»¥åŒå‘å‘é€æˆ–æ¥å—ä¿¡æ¯ã€‚\né¦–å…ˆï¼ŒWebSocket æ˜¯ä¸€ä¸ªæŒä¹…åŒ–çš„åè®®ï¼Œç›¸å¯¹äº HTTP è¿™ç§éæŒä¹…çš„åè®®æ¥è¯´ã€‚ç®€å•çš„ä¸¾ä¸ªä¾‹å­å§ï¼Œç”¨ç›®å‰åº”ç”¨æ¯”è¾ƒå¹¿æ³›çš„ PHP ç”Ÿå‘½å‘¨æœŸæ¥è§£é‡Šã€‚\nHTTP çš„ç”Ÿå‘½å‘¨æœŸé€šè¿‡ Request æ¥ç•Œå®šï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª Request ä¸€ä¸ª Response ï¼Œé‚£ä¹ˆåœ¨ HTTP1.0 ä¸­ï¼Œè¿™æ¬¡ HTTP è¯·æ±‚å°±ç»“æŸäº†ã€‚\nåœ¨ HTTP1.1 ä¸­è¿›è¡Œäº†æ”¹è¿›ï¼Œä½¿å¾—æœ‰ä¸€ä¸ª keep-aliveï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä¸€ä¸ª HTTP è¿æ¥ä¸­ï¼Œå¯ä»¥å‘é€å¤šä¸ª Requestï¼Œæ¥æ”¶å¤šä¸ª Responseã€‚ä½†æ˜¯è¯·è®°ä½ Request = Responseï¼Œ åœ¨ HTTP ä¸­æ°¸è¿œæ˜¯è¿™æ ·ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ª Request åªèƒ½æœ‰ä¸€ä¸ª Responseã€‚è€Œä¸”è¿™ä¸ª Response ä¹Ÿæ˜¯è¢«åŠ¨çš„ï¼Œä¸èƒ½ä¸»åŠ¨å‘èµ·ã€‚\né¦–å…ˆ WebSocket æ˜¯åŸºäº HTTP åè®®çš„ï¼Œæˆ–è€…è¯´å€Ÿç”¨äº† HTTP åè®®æ¥å®Œæˆä¸€éƒ¨åˆ†æ¡æ‰‹ã€‚\né¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸ªå…¸å‹çš„ WebSocket æ¡æ‰‹\nGET /chat HTTP/1.1 Host: server.example.com Upgrade: websocket Connection: Upgrade Sec-WebSocket-Key: x3JJHMbDL1EzLkh9GBhXDw== Sec-WebSocket-Protocol: chat, superchat Sec-WebSocket-Version: 13 Origin: HTTP://example.com ç†Ÿæ‚‰ HTTP çš„ç«¥é‹å¯èƒ½å‘ç°äº†ï¼Œè¿™æ®µç±»ä¼¼ HTTP åè®®çš„æ¡æ‰‹è¯·æ±‚ä¸­ï¼Œå¤šäº†è¿™ä¹ˆå‡ ä¸ªä¸œè¥¿ã€‚\nUpgrade: websocket Connection: Upgrade è¿™ä¸ªå°±æ˜¯ WebSocket çš„æ ¸å¿ƒäº†ï¼Œå‘Šè¯‰ Apache ã€ Nginx ç­‰æœåŠ¡å™¨ï¼šæ³¨æ„å•¦ï¼Œæˆ‘å‘èµ·çš„è¯·æ±‚è¦ç”¨ WebSocket åè®®ï¼Œå¿«ç‚¹å¸®æˆ‘æ‰¾åˆ°å¯¹åº”çš„åŠ©ç†å¤„ç†~è€Œä¸æ˜¯é‚£ä¸ªè€åœŸçš„ HTTPã€‚\nSec-WebSocket-Key: x3JJHMbDL1EzLkh9GBhXDw== Sec-WebSocket-Protocol: chat, superchat Sec-WebSocket-Version: 13 é¦–å…ˆï¼Œ Sec-WebSocket-Key æ˜¯ä¸€ä¸ª Base64 encode çš„å€¼ï¼Œè¿™ä¸ªæ˜¯æµè§ˆå™¨éšæœºç”Ÿæˆçš„ï¼Œå‘Šè¯‰æœåŠ¡å™¨ï¼šæ³¥ç…¤ï¼Œä¸è¦å¿½æ‚ æˆ‘ï¼Œæˆ‘è¦éªŒè¯ä½ æ˜¯ä¸æ˜¯çœŸçš„æ˜¯ WebSocket åŠ©ç†ã€‚\nç„¶åï¼Œ Sec_WebSocket-Protocol æ˜¯ä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„å­—ç¬¦ä¸²ï¼Œç”¨æ¥åŒºåˆ†åŒ URL ä¸‹ï¼Œä¸åŒçš„æœåŠ¡æ‰€éœ€è¦çš„åè®®ã€‚ç®€å•ç†è§£ï¼šä»Šæ™šæˆ‘è¦æœåŠ¡Aï¼Œåˆ«æé”™å•¦~\næœ€åï¼Œ Sec-WebSocket-Version æ˜¯å‘Šè¯‰æœåŠ¡å™¨æ‰€ä½¿ç”¨çš„ WebSocket Draft ï¼ˆåè®®ç‰ˆæœ¬ï¼‰ï¼Œåœ¨æœ€åˆçš„æ—¶å€™ï¼ŒWebSocket åè®®è¿˜åœ¨ Draft é˜¶æ®µï¼Œå„ç§å¥‡å¥‡æ€ªæ€ªçš„åè®®éƒ½æœ‰ï¼Œè€Œä¸”è¿˜æœ‰å¾ˆå¤šæœŸå¥‡å¥‡æ€ªæ€ªä¸åŒçš„ä¸œè¥¿ï¼Œä»€ä¹ˆ Firefox å’Œ Chrome ç”¨çš„ä¸æ˜¯ä¸€ä¸ªç‰ˆæœ¬ä¹‹ç±»çš„ï¼Œå½“åˆ WebSocket åè®®å¤ªå¤šå¯æ˜¯ä¸€ä¸ªå¤§éš¾é¢˜ã€‚ã€‚ä¸è¿‡ç°åœ¨è¿˜å¥½ï¼Œå·²ç»å®šä¸‹æ¥å•¦~å¤§å®¶éƒ½ä½¿ç”¨åŒä¸€ä¸ªç‰ˆæœ¬ï¼š æœåŠ¡å‘˜ï¼Œæˆ‘è¦çš„æ˜¯13å²çš„å™¢â†’_â†’\nç„¶åæœåŠ¡å™¨ä¼šè¿”å›ä¸‹åˆ—ä¸œè¥¿ï¼Œè¡¨ç¤ºå·²ç»æ¥å—åˆ°è¯·æ±‚ï¼Œ æˆåŠŸå»ºç«‹ WebSocket å•¦ï¼\nHTTP/1.1 101 Switching Protocols Upgrade: websocket Connection: Upgrade Sec-WebSocket-Accept: HSmrc0sMlYUkAGmm5OPpG2HaGWk= Sec-WebSocket-Protocol: chat å¤åˆ¶ä»£ç  è¿™é‡Œå¼€å§‹å°±æ˜¯ HTTP æœ€åè´Ÿè´£çš„åŒºåŸŸäº†ï¼Œå‘Šè¯‰å®¢æˆ·ï¼Œæˆ‘å·²ç»æˆåŠŸåˆ‡æ¢åè®®å•¦~\nUpgrade: websocket Connection: Upgrade å¤åˆ¶ä»£ç  ä¾ç„¶æ˜¯å›ºå®šçš„ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯å³å°†å‡çº§çš„æ˜¯ WebSocket åè®®ï¼Œè€Œä¸æ˜¯ mozillasocketï¼Œlurnarsocket æˆ–è€… shitsocketã€‚\nç„¶åï¼Œ Sec-WebSocket-Accept è¿™ä¸ªåˆ™æ˜¯ç»è¿‡æœåŠ¡å™¨ç¡®è®¤ï¼Œå¹¶ä¸”åŠ å¯†è¿‡åçš„ Sec-WebSocket-Key ã€‚ æœåŠ¡å™¨ï¼šå¥½å•¦å¥½å•¦ï¼ŒçŸ¥é“å•¦ï¼Œç»™ä½ çœ‹æˆ‘çš„ ID CARD æ¥è¯æ˜è¡Œäº†å§ã€‚\nåé¢çš„ï¼Œ Sec-WebSocket-Protocol åˆ™æ˜¯è¡¨ç¤ºæœ€ç»ˆä½¿ç”¨çš„åè®®ã€‚\nè‡³æ­¤ï¼ŒHTTP å·²ç»å®Œæˆå®ƒæ‰€æœ‰å·¥ä½œäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å®Œå…¨æŒ‰ç…§ WebSocket åè®®è¿›è¡Œäº†ã€‚\næ€»ç»“ï¼ŒWebSocketè¿æ¥çš„è¿‡ç¨‹æ˜¯ï¼š\né¦–å…ˆï¼Œå®¢æˆ·ç«¯å‘èµ·HTTPè¯·æ±‚ï¼Œç»è¿‡3æ¬¡æ¡æ‰‹åï¼Œå»ºç«‹èµ·TCPè¿æ¥ï¼›HTTPè¯·æ±‚é‡Œå­˜æ”¾WebSocketæ”¯æŒçš„ç‰ˆæœ¬å·ç­‰ä¿¡æ¯ï¼Œå¦‚ï¼šUpgradeã€Connectionã€WebSocket-Versionç­‰ï¼›\nç„¶åï¼ŒæœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„æ¡æ‰‹è¯·æ±‚åï¼ŒåŒæ ·é‡‡ç”¨HTTPåè®®å›é¦ˆæ•°æ®ï¼›\næœ€åï¼Œå®¢æˆ·ç«¯æ”¶åˆ°è¿æ¥æˆåŠŸçš„æ¶ˆæ¯åï¼Œå¼€å§‹å€ŸåŠ©äºTCPä¼ è¾“ä¿¡é“è¿›è¡Œå…¨åŒå·¥é€šä¿¡ã€‚\nHTTP HTTP - Hypertext Transport Protocol è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œåè®®è¯¦ç»†è§„å®šäº†æµè§ˆå™¨å’Œä¸‡ç»´ç½‘æœåŠ¡å™¨ä¹‹é—´äº’ç›¸é€šä¿¡çš„è§„åˆ™ï¼Œé€šè¿‡ HTTP æˆ–è€… HTTPS åè®®è¯·æ±‚çš„èµ„æºç”±ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼ˆURI - Uniform Resource Identifiersï¼‰æ¥æ ‡è¯†ï¼ŒåŸºäº TCP å®ç°ã€‚\nğŸ“ Note HTTP çš„ç‰¹ç‚¹å¦‚ä¸‹ï¼š\nğŸ™‚ Pros\n[çµæ´»å¯æ‰©å±•] è¯­æ³•ä¸Šåªè§„å®šäº†åŸºæœ¬æ ¼å¼ï¼Œä»¥ç©ºæ ¼åˆ†éš”å•è¯ï¼Œæ¢è¡Œåˆ†éš”å­—æ®µç­‰ã€‚å¦å¤–ä¸€ä¸ªå°±æ˜¯ä¼ è¾“å½¢å¼ä¸Šä¸ä»…å¯ä»¥ä¼ è¾“æ–‡æœ¬ï¼Œè¿˜å¯ä»¥ä¼ è¾“å›¾ç‰‡ï¼Œè§†é¢‘ç­‰ä»»æ„æ•°æ®ã€‚ [è¯·æ±‚-åº”ç­”æ¨¡å¼] é€šå¸¸è€Œè¨€ï¼Œå°±æ˜¯ä¸€æ–¹å‘å‡ºè¯·æ±‚è€Œå¦ä¸€æ–¹ç›¸åº”è¿›è¡Œåº”ç­”ã€‚ [å¯é ä¼ è¾“] HTTP æ˜¯åŸºäº TCP/IP æ ‡å‡†ï¼Œå› æ­¤æŠŠè¿™ä¸€ç‰¹æ€§ç»§æ‰¿äº†ä¸‹æ¥ã€‚ [æ— çŠ¶æ€] HTTP è¿æ¥æœ¬èº«æ— çŠ¶æ€ï¼Œç»´æŠ¤è¿æ¥ç”±ä¼ è¾“å±‚çš„ TCP å®ç°ã€‚ ğŸ™ƒ Cons\n[æ— çŠ¶æ€] ï¼Œæœ‰æ—¶å€™ï¼Œéœ€è¦ä¿å­˜ä¿¡æ¯ï¼Œæ¯”å¦‚åƒè´­ç‰©ç³»ç»Ÿï¼Œéœ€è¦ä¿ç•™ä¸‹é¡¾å®¢ä¿¡æ¯ç­‰ç­‰ï¼Œå¦å¤–ä¸€æ–¹é¢ï¼Œæœ‰æ—¶å€™ï¼Œæ— çŠ¶æ€ä¹Ÿä¼šå‡å°‘ç½‘ç»œå¼€é”€ï¼Œæ¯”å¦‚ç±»ä¼¼ç›´æ’­è¡Œä¸šè¿™æ ·å­ç­‰ï¼Œè¿™ä¸ªè¿˜æ˜¯åˆ†åœºæ™¯æ¥è¯´ã€‚ [æ˜æ–‡ä¼ è¾“] ï¼Œå³åè®®é‡Œçš„æŠ¥æ–‡(ä¸»è¦æŒ‡çš„æ˜¯å¤´éƒ¨)ä¸ä½¿ç”¨äºŒè¿›åˆ¶æ•°æ®ï¼Œè€Œæ˜¯æ–‡æœ¬å½¢å¼ã€‚è¿™è®© HTTP çš„æŠ¥æ–‡ä¿¡æ¯æš´éœ²ç»™äº†å¤–ç•Œï¼Œç»™æ”»å‡»è€…å¸¦æ¥äº†ä¾¿åˆ©ã€‚ [é˜Ÿå¤´é˜»å¡] ï¼Œå½“ HTTP å¼€å¯ é•¿è¿æ¥ æ—¶ï¼Œå…±ç”¨ä¸€ä¸ª TCP è¿æ¥ï¼Œå½“æŸä¸ªè¯·æ±‚æ—¶é—´è¿‡é•¿æ—¶ï¼Œå…¶ä»–çš„è¯·æ±‚åªèƒ½å¤„äºé˜»å¡çŠ¶æ€ï¼Œè¿™å°±æ˜¯é˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚ å“åº”æ¨¡å‹ HTTP ç”±è¯·æ±‚å’Œå“åº”æ„æˆï¼Œæ˜¯ä¸€ä¸ªæ ‡å‡†çš„å®¢æˆ·ç«¯æœåŠ¡å™¨æ¨¡å‹ï¼ˆB/Sï¼‰ã€‚HTTP åè®®æ°¸è¿œéƒ½æ˜¯å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨å›é€å“åº”ã€‚\nHTTP æ˜¯ä¸€ä¸ª æ— çŠ¶æ€ çš„åè®®ã€‚æ— çŠ¶æ€æ˜¯æŒ‡ å®¢æˆ·æœº^Webæµè§ˆå™¨^ å’Œ æœåŠ¡å™¨ ä¹‹é—´ä¸éœ€è¦å»ºç«‹ [æŒä¹…è¿æ¥] ï¼Œè¿™æ„å‘³ç€å½“ä¸€ä¸ªå®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘å‡ºè¯·æ±‚ï¼Œç„¶åæœåŠ¡å™¨ è¿”å›å“åº”^response^ ï¼Œè¿æ¥å°±è¢«å…³é—­äº†ï¼Œåœ¨æœåŠ¡å™¨ç«¯ä¸ä¿ç•™è¿æ¥çš„æœ‰å…³ä¿¡æ¯ã€‚\nHTTPéµå¾ª [è¯·æ±‚^Request^] / [åº”ç­”^Response^] æ¨¡å‹ã€‚å®¢æˆ·æœº^æµè§ˆå™¨^ å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼ŒæœåŠ¡å™¨å¤„ç†è¯·æ±‚å¹¶è¿”å›é€‚å½“çš„åº”ç­”ã€‚æ‰€æœ‰ HTTP è¿æ¥éƒ½è¢«æ„é€ æˆä¸€å¥—è¯·æ±‚å’Œåº”ç­”ã€‚\nè¿æ¥ä¿æŒ Connection: keep-alive\nå½“å¤„äºé keep-alive æ¨¡å¼æ—¶ï¼Œç”±äº HTTP åè®®ä¸º æ— è¿æ¥ çš„åè®®ï¼Œæ¯ä¸ªè¯·æ±‚/åº”ç­”å®¢æˆ·å’ŒæœåŠ¡å™¨éƒ½è¦æ–°å»ºä¸€ä¸ªè¿æ¥ï¼Œå®Œæˆ ä¹‹å ç«‹å³æ–­å¼€ è¿æ¥ã€‚\nkeep-alive èƒ½åœ¨å¤šæ¬¡ HTTPä¹‹å‰é‡ç”¨åŒä¸€ä¸ª TCP è¿æ¥ï¼Œå½“å‡ºç°å¯¹æœåŠ¡å™¨çš„åç»§è¯·æ±‚æ—¶ï¼Œkeep-alive åŠŸèƒ½é¿å…äº†å»ºç«‹æˆ–è€…é‡æ–°å»ºç«‹è¿æ¥ï¼Œä»è€Œå‡å°‘åˆ›å»º/å…³é—­å¤šä¸ª TCP è¿æ¥çš„å¼€é”€ã€‚\nåœ¨ HTTP 1.0 åè®®ä¸­ï¼Œé»˜è®¤æ˜¯å…³é—­çš„ï¼Œéœ€è¦åœ¨ HTTP å¤´ä¸­å¯ç”¨ï¼š\nconnection: keep-alive HHTP 1.1ä¸­é»˜è®¤å¯ç”¨ keep-aliveï¼Œå¯é€šè¿‡ \u0026ldquo;connection: close\u0026rdquo; æ‰‹åŠ¨å…³é—­ã€‚\nconnection: close ç›®å‰å¤§éƒ¨åˆ†æµè§ˆå™¨éƒ½æ˜¯ç”¨ HTTP 1.1 åè®®ï¼Œä¹Ÿå°±æ˜¯è¯´é»˜è®¤éƒ½ä¼šå‘èµ· keep-alive çš„è¿æ¥è¯·æ±‚ã€‚\nè¯·æ±‚æ–¹å¼ HTTP åè®®ä¸­å®šä¹‰äº† 9 ç§æ–¹æ³•æ¥è¡¨æ˜å¯¹ Request-URI æŒ‡å®šçš„èµ„æºçš„ä¸åŒæ“ä½œæ–¹å¼ã€‚\n[HTTP 1.0] å®šä¹‰äº† 3 ç§è¯·æ±‚æ–¹æ³•ï¼š GET, POST, HEAD\n[HTTP 1.1] æ–°å¢äº† 6 ç§è¯·æ±‚æ–¹æ³•ï¼šOPTIONS, PUT, PATCH,DELETE, TRACE, CONNECT\nåœ¨å®é™…åº”ç”¨ä¸­å¸¸ç”¨çš„ä¹Ÿå°±æ˜¯ GET å’Œ POST ã€‚\nâ˜•ï¸ Q~\u0026amp;~A\nGETå’ŒPOSTæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\næ•°æ®ä¼ è¾“æ–¹å¼ä¸åŒï¼šGETè¯·æ±‚é€šè¿‡URLä¼ è¾“æ•°æ®ï¼Œè€ŒPOSTçš„æ•°æ®é€šè¿‡è¯·æ±‚ä½“ä¼ è¾“ã€‚\nå®‰å…¨æ€§ä¸åŒï¼šPOSTçš„æ•°æ®å› ä¸ºåœ¨è¯·æ±‚ä¸»ä½“å†…ï¼Œæ‰€ä»¥æœ‰ä¸€å®šçš„å®‰å…¨æ€§ä¿è¯ï¼Œè€ŒGETçš„æ•°æ®åœ¨URLä¸­ï¼Œé€šè¿‡å†å²è®°å½•ï¼Œç¼“å­˜å¾ˆå®¹æ˜“æŸ¥åˆ°æ•°æ®ä¿¡æ¯ã€‚\næ•°æ®ç±»å‹ä¸åŒï¼šGETåªå…è®¸ ASCII å­—ç¬¦ï¼Œè€ŒPOSTæ— é™åˆ¶\nGETæ— å®³ï¼š åˆ·æ–°ã€åé€€ç­‰æµè§ˆå™¨æ“ä½œGETè¯·æ±‚æ˜¯æ— å®³çš„ï¼ŒPOSTå¯èƒ½é‡å¤æäº¤è¡¨å•\nç‰¹æ€§ä¸åŒï¼šGETæ˜¯å®‰å…¨ï¼ˆè¿™é‡Œçš„å®‰å…¨æ˜¯æŒ‡åªè¯»ç‰¹æ€§ï¼Œå°±æ˜¯ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ä¸ä¼šå¼•èµ·æœåŠ¡å™¨çŠ¶æ€å˜åŒ–ï¼‰ä¸”å¹‚ç­‰ï¼ˆå¹‚ç­‰çš„æ¦‚å¿µæ˜¯æŒ‡åŒä¸€ä¸ªè¯·æ±‚æ–¹æ³•æ‰§è¡Œå¤šæ¬¡å’Œä»…æ‰§è¡Œä¸€æ¬¡çš„æ•ˆæœå®Œå…¨ç›¸åŒï¼‰ï¼Œè€ŒPOSTæ˜¯éå®‰å…¨éå¹‚ç­‰\nPUTå’ŒPOSTéƒ½æ˜¯ç»™æœåŠ¡å™¨å‘é€æ–°å¢èµ„æºï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\nPUT å’ŒPOSTæ–¹æ³•çš„åŒºåˆ«æ˜¯,PUTæ–¹æ³•æ˜¯å¹‚ç­‰çš„ï¼šè¿ç»­è°ƒç”¨ä¸€æ¬¡æˆ–è€…å¤šæ¬¡çš„æ•ˆæœç›¸åŒï¼ˆæ— å‰¯ä½œç”¨ï¼‰ï¼Œè€ŒPOSTæ–¹æ³•æ˜¯éå¹‚ç­‰çš„ã€‚\né™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€ä¸ªåŒºåˆ«ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼ŒPUTçš„URIæŒ‡å‘æ˜¯å…·ä½“å•ä¸€èµ„æºï¼Œè€ŒPOSTå¯ä»¥æŒ‡å‘èµ„æºé›†åˆã€‚\nä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åœ¨å¼€å‘ä¸€ä¸ªåšå®¢ç³»ç»Ÿï¼Œå½“æˆ‘ä»¬è¦åˆ›å»ºä¸€ç¯‡æ–‡ç« çš„æ—¶å€™å¾€å¾€ç”¨POST HTTPs://www.jianshu.com/articlesï¼Œè¿™ä¸ªè¯·æ±‚çš„è¯­ä¹‰æ˜¯ï¼Œåœ¨articlesçš„èµ„æºé›†åˆä¸‹åˆ›å»ºä¸€ç¯‡æ–°çš„æ–‡ç« ï¼Œå¦‚æœæˆ‘ä»¬å¤šæ¬¡æäº¤è¿™ä¸ªè¯·æ±‚ä¼šåˆ›å»ºå¤šä¸ªæ–‡ç« ï¼Œè¿™æ˜¯éå¹‚ç­‰çš„ã€‚\nè€ŒPUT HTTPs://www.jianshu.com/articles/820357430çš„è¯­ä¹‰æ˜¯æ›´æ–°å¯¹åº”æ–‡ç« ä¸‹çš„èµ„æºï¼ˆæ¯”å¦‚ä¿®æ”¹ä½œè€…åç§°ç­‰ï¼‰ï¼Œè¿™ä¸ªURIæŒ‡å‘çš„å°±æ˜¯å•ä¸€èµ„æºï¼Œè€Œä¸”æ˜¯å¹‚ç­‰çš„ï¼Œæ¯”å¦‚ä½ æŠŠã€åˆ˜å¾·åã€ä¿®æ”¹æˆã€è”¡å¾å¤ã€ï¼Œæäº¤å¤šå°‘æ¬¡éƒ½æ˜¯ä¿®æ”¹æˆã€è”¡å¾å¤ã€\nps: ã€POSTè¡¨ç¤ºåˆ›å»ºèµ„æºï¼ŒPUTè¡¨ç¤ºæ›´æ–°èµ„æºã€è¿™ç§è¯´æ³•æ˜¯é”™è¯¯çš„ï¼Œä¸¤ä¸ªéƒ½èƒ½åˆ›å»ºèµ„æºï¼Œæ ¹æœ¬åŒºåˆ«å°±åœ¨äºå¹‚ç­‰æ€§\nPUTå’ŒPATCHéƒ½æ˜¯ç»™æœåŠ¡å™¨å‘é€ä¿®æ”¹èµ„æºï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\nPUTå’ŒPATCHéƒ½æ˜¯æ›´æ–°èµ„æºï¼Œè€ŒPATCHç”¨æ¥å¯¹å·²çŸ¥èµ„æºè¿›è¡Œå±€éƒ¨æ›´æ–°ã€‚\næ¯”å¦‚æˆ‘ä»¬æœ‰ä¸€ç¯‡æ–‡ç« çš„åœ°å€HTTPs://www.jianshu.com/articles/820357430,è¿™ç¯‡æ–‡ç« çš„å¯ä»¥è¡¨ç¤ºä¸º:\narticle = { author: \u0026#39;dxy\u0026#39;, creationDate: \u0026#39;2019-6-12\u0026#39;, content: \u0026#39;æˆ‘å†™æ–‡ç« åƒè”¡å¾å¤\u0026#39;, id: 820357430 } å½“æˆ‘ä»¬è¦ä¿®æ”¹æ–‡ç« çš„ä½œè€…æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å‘é€PUT HTTPs://www.jianshu.com/articles/820357430ï¼Œè¿™ä¸ªæ—¶å€™çš„æ•°æ®åº”è¯¥æ˜¯:\n{ author:\u0026#39;è”¡å¾å¤\u0026#39;, creationDate: \u0026#39;2019-6-12\u0026#39;, content: \u0026#39;æˆ‘å†™æ–‡ç« åƒè”¡å¾å¤\u0026#39;, id: 820357430 } è¿™ç§ç›´æ¥è¦†ç›–èµ„æºçš„ä¿®æ”¹æ–¹å¼åº”è¯¥ç”¨putï¼Œä½†æ˜¯ä½ è§‰å¾—æ¯æ¬¡éƒ½å¸¦æœ‰è¿™ä¹ˆå¤šæ— ç”¨çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆå¯ä»¥å‘é€PATCH HTTPs://www.jianshu.com/articles/820357430ï¼Œè¿™ä¸ªæ—¶å€™åªéœ€è¦:\n{ author:\u0026#39;è”¡å¾å¤\u0026#39;, } å·¥ä½œæµç¨‹ ä¸€æ¬¡ HTTP æ“ä½œç§°ä¸ºä¸€ä¸ªäº‹åŠ¡ï¼Œå…¶å·¥ä½œæ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹ï¼š\nåœ°å€è§£æ å¦‚ç”¨å®¢æˆ·ç«¯æµè§ˆå™¨è¯·æ±‚è¿™ä¸ªé¡µé¢ï¼šlocalhost.com:8080/index.htm\nä»ä¸­åˆ†è§£å‡ºåè®®åã€ä¸»æœºåã€ç«¯å£ã€å¯¹è±¡è·¯å¾„ç­‰éƒ¨åˆ†ï¼Œå¯¹äºæˆ‘ä»¬çš„è¿™ä¸ªåœ°å€ï¼Œè§£æå¾—åˆ°çš„ç»“æœå¦‚ä¸‹ï¼š\nåè®®åï¼šHTTP ä¸»æœºåï¼šlocalhost.com ç«¯å£ï¼š8080 å¯¹è±¡è·¯å¾„ï¼š/index.htm åœ¨è¿™ä¸€æ­¥ï¼Œéœ€è¦ [åŸŸåç³»ç»Ÿ DNS] è§£æåŸŸå localhost.com ï¼Œå¾—ä¸»æœºçš„ IP åœ°å€ã€‚\nå°è£… HTTP è¯·æ±‚æ•°æ®åŒ… æŠŠä»¥ä¸Šéƒ¨åˆ†ç»“åˆæœ¬æœºè‡ªå·±çš„ä¿¡æ¯ï¼Œå°è£…æˆä¸€ä¸ª HTTP è¯·æ±‚æ•°æ®åŒ…ã€‚\nå°è£…æˆ TCP åŒ…ï¼Œå»ºç«‹ TCP è¿æ¥ï¼ˆTCPçš„ä¸‰æ¬¡æ¡æ‰‹ï¼‰ åœ¨ HTTP å·¥ä½œå¼€å§‹ä¹‹å‰ï¼Œå®¢æˆ·æœº^Webæµè§ˆå™¨^ é¦–å…ˆè¦é€šè¿‡ç½‘ç»œä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œè¯¥è¿æ¥æ˜¯é€šè¿‡ TCP æ¥å®Œæˆçš„ï¼Œè¯¥åè®®ä¸ IP åè®® å…±åŒæ„å»º Internetï¼Œå³è‘—åçš„TCP/IPåè®®æ—ï¼Œå› æ­¤ Internet åˆè¢«ç§°ä½œæ˜¯ TCP/IP ç½‘ç»œ ã€‚\nHTTP æ˜¯æ¯” TCP æ›´é«˜å±‚æ¬¡çš„ [åº”ç”¨å±‚] åè®®ï¼Œæ ¹æ®è§„åˆ™ï¼Œåªæœ‰ä½å±‚åè®®å»ºç«‹ä¹‹åæ‰èƒ½è¿›è¡Œæ›´å±‚åè®®çš„è¿æ¥ï¼Œå› æ­¤ï¼Œé¦–å…ˆè¦å»ºç«‹ TCP è¿æ¥ï¼Œä¸€èˆ¬ TCP è¿æ¥çš„ç«¯å£å·æ˜¯ 80 ã€‚è¿™é‡Œæ˜¯ 8080 ç«¯å£ã€‚\nå®¢æˆ·æœºå‘é€è¯·æ±‚å‘½ä»¤ å»ºç«‹è¿æ¥åï¼Œå®¢æˆ·æœºå‘é€ä¸€ä¸ªè¯·æ±‚ç»™æœåŠ¡å™¨ï¼Œè¯·æ±‚æ–¹å¼çš„æ ¼å¼ä¸ºï¼šç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦^URL^ã€åè®®ç‰ˆæœ¬å·ï¼Œåè¾¹æ˜¯ MIME ä¿¡æ¯åŒ…æ‹¬è¯·æ±‚ä¿®é¥°ç¬¦ã€å®¢æˆ·æœºä¿¡æ¯å’Œå¯å†…å®¹ã€‚\næœåŠ¡å™¨å“åº” æœåŠ¡å™¨æ¥åˆ°è¯·æ±‚åï¼Œç»™äºˆç›¸åº”çš„å“åº”ä¿¡æ¯ï¼Œå…¶æ ¼å¼ä¸ºä¸€ä¸ªçŠ¶æ€è¡Œï¼ŒåŒ…æ‹¬ä¿¡æ¯çš„åè®®ç‰ˆæœ¬å·ã€ä¸€ä¸ªæˆåŠŸæˆ–é”™è¯¯çš„ä»£ç ï¼Œåè¾¹æ˜¯ MIME ä¿¡æ¯åŒ…æ‹¬æœåŠ¡å™¨ä¿¡æ¯ã€å®ä½“ä¿¡æ¯å’Œå¯èƒ½çš„å†…å®¹ã€‚\nå®ä½“æ¶ˆæ¯æ˜¯æœåŠ¡å™¨å‘æµè§ˆå™¨å‘é€å¤´ä¿¡æ¯åï¼Œå®ƒä¼šå‘é€ä¸€ä¸ªç©ºç™½è¡Œæ¥è¡¨ç¤ºå¤´ä¿¡æ¯çš„å‘é€åˆ°æ­¤ä¸ºç»“æŸï¼Œæ¥ç€ï¼Œå®ƒå°±ä»¥ Content-Type åº”ç­”å¤´ä¿¡æ¯æ‰€æè¿°çš„æ ¼å¼å‘é€ç”¨æˆ·æ‰€è¯·æ±‚çš„å®é™…æ•°æ®ã€‚\næœåŠ¡å™¨å…³é—­TCPè¿æ¥ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€æ—¦ Web æœåŠ¡å™¨å‘æµè§ˆå™¨å‘é€äº†è¯·æ±‚æ•°æ®ï¼Œå®ƒå°±è¦ å…³é—­ TCP è¿æ¥ï¼Œç„¶åå¦‚æœæµè§ˆå™¨æˆ–è€…æœåŠ¡å™¨åœ¨å…¶å¤´ä¿¡æ¯åŠ å…¥äº†è¿™è¡Œä»£ç ï¼š\nConnection:keep-alive TCP è¿æ¥åœ¨å‘é€åå°†ä»ç„¶ä¿æŒ æ‰“å¼€ çŠ¶æ€ï¼Œäºæ˜¯ï¼Œæµè§ˆå™¨å¯ä»¥ç»§ç»­é€šè¿‡ç›¸åŒçš„è¿æ¥å‘é€è¯·æ±‚ã€‚ä¿æŒè¿æ¥èŠ‚çœäº†ä¸ºæ¯ä¸ªè¯·æ±‚å»ºç«‹æ–°è¿æ¥æ‰€éœ€çš„æ—¶é—´ï¼Œè¿˜èŠ‚çº¦äº†ç½‘ç»œå¸¦å®½ã€‚\næŠ¥æ–‡å°è£… è¯·æ±‚æŠ¥æ–‡ æ ¼å¼å¦‚ä¸‹ï¼š\n[è¯·æ±‚è¡Œ] ï¼ [é€šç”¨ä¿¡æ¯å¤´] ï¼ [è¯·æ±‚å¤´] ï¼ [å®ä½“å¤´] ï¼ [æŠ¥æ–‡ä¸»ä½“]\nğŸ“ Note åªæœ‰ POST æ–¹å¼å…·æœ‰è¯·æ±‚ä½“ã€‚\nåº”ç­”æŠ¥æ–‡ æ ¼å¼å¦‚ä¸‹ï¼š\n[çŠ¶æ€è¡Œ] ï¼ [é€šç”¨ä¿¡æ¯å¤´] ï¼ [å“åº”å¤´] ï¼ [å®ä½“å¤´] ï¼ [æŠ¥æ–‡ä¸»ä½“]\nå“åº”æŠ¥æ–‡åŒ…å«ä¸‰éƒ¨åˆ†ï¼šçŠ¶æ€è¡Œã€å“åº”é¦–éƒ¨å­—æ®µã€å“åº”å†…å®¹å®ä½“å®ç°å…¶ä»–æŠ¥æ–‡å­—æ®µ\nå…¶å®ƒå­—æ®µ è¿™äº›å­—æ®µä¸æ˜¯ HTTP åè®®ä¸­å®šä¹‰çš„ï¼Œä½†è¢«å¹¿æ³›åº”ç”¨äº HTTP è¯·æ±‚ä¸­ã€‚\nCookieï¼šå±äºè¯·æ±‚å‹æŠ¥æ–‡å­—æ®µï¼Œåœ¨è¯·æ±‚æ—¶æ·»åŠ  Cookie ï¼Œä»¥å®ç° HTTP çš„çŠ¶æ€è®°å½•ã€‚\nSet-Cookieï¼šå±äºåº”ç­”å‹æŠ¥æ–‡å­—æ®µã€‚æœåŠ¡å™¨ç»™å®¢æˆ·ç«¯ä¼ é€’ Cookie ä¿¡æ¯æ—¶ï¼Œå°±æ˜¯é€šè¿‡æ­¤å­—æ®µå®ç°çš„ã€‚\nSet-Cookieçš„å­—æ®µå±æ€§ï¼š\nNAME=VALUE: èµ‹äºˆCookieçš„åç§°å’Œå€¼ï¼› expires=DATE: Cookieçš„æœ‰æ•ˆæœŸï¼› path=PATH: å°†æœåŠ¡å™¨ä¸Šçš„ç›®å½•ä½œä¸ºCookieçš„é€‚ç”¨å¯¹è±¡ï¼Œè‹¥ä¸æŒ‡å®šï¼Œåˆ™é»˜è®¤ä¸ºæ–‡æ¡£æ‰€åœ¨çš„æ–‡ä»¶ç›®å½•ï¼› domin=åŸŸå: ä½œä¸ºCookiesé€‚ç”¨å¯¹è±¡çš„åŸŸåï¼Œè‹¥ä¸æŒ‡å®šï¼Œåˆ™é»˜è®¤ä¸ºåˆ›å»ºCookieçš„æœåŠ¡å™¨åŸŸåï¼› Secure: ä»…åœ¨HTTPSå®‰å…¨é€šä¿¡æ˜¯æ‰ä¼šå‘é€Cookieï¼› HTTPOnly: ä½¿Cookieä¸èƒ½è¢«JSè„šæœ¬è®¿é—®ï¼› å¦‚ï¼šSet-Cookie:BDSVRBFE=Go; max-age=10; domain=m.baidu.com; path=/ æŸ¥çœ‹æŠ¥æ–‡ è¯·æ±‚å¤´ Network â†’ Hearders å“åº”ä½“ Network â†’ Responseï¼šé€šå¸¸è¿”å›çš„æ˜¯ HTML HTTPçŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯HTTPè¯·æ±‚çš„è¿”å›ç»“æœã€æ ‡è¯†æœåŠ¡å™¨å¤„ç†æ˜¯å¦æ­£å¸¸ã€è¡¨æ˜è¯·æ±‚å‡ºç°çš„é”™è¯¯ç­‰ã€‚\nåº”ç­”çŠ¶æ€ç  çŠ¶æ€ç  ç±»åˆ« æè¿° 1xx Informational(ä¿¡æ¯æ€§çŠ¶æ€ç ) è¯·æ±‚æ­£åœ¨è¢«å¤„ç† 2xx Success(æˆåŠŸçŠ¶æ€ç ) è¯·æ±‚å¤„ç†æˆåŠŸ 3xx Redirection(é‡å®šå‘çŠ¶æ€ç ) éœ€è¦è¿›è¡Œé‡å®šå‘ 4xx Client Error(å®¢æˆ·ç«¯çŠ¶æ€ç ) æœåŠ¡å™¨æ— æ³•å¤„ç†è¯·æ±‚ 5xx Server Error(æœåŠ¡ç«¯çŠ¶æ€ç ) æœåŠ¡å™¨å¤„ç†è¯·æ±‚æ—¶å‡ºé”™ ğŸ“ Note å¸¸è§çš„çŠ¶æ€ç ï¼š\nçŠ¶æ€ç  æè¿° 200ï¼š è¯·æ±‚è¢«æ­£å¸¸å¤„ç† 204ï¼š è¯·æ±‚è¢«å—ç†ä½†æ²¡æœ‰èµ„æºå¯ä»¥è¿”å› 206ï¼š å®¢æˆ·ç«¯åªæ˜¯è¯·æ±‚èµ„æºçš„ä¸€éƒ¨åˆ†ï¼ŒæœåŠ¡å™¨åªå¯¹è¯·æ±‚çš„éƒ¨åˆ†èµ„æºæ‰§è¡ŒGETæ–¹æ³•ï¼Œç›¸åº”æŠ¥æ–‡ä¸­é€šè¿‡Content-RangeæŒ‡å®šèŒƒå›´çš„èµ„æºã€‚ 301ï¼š æ°¸ä¹…æ€§é‡å®šå‘ 302ï¼š ä¸´æ—¶é‡å®šå‘ 303ï¼š ä¸302çŠ¶æ€ç æœ‰ç›¸ä¼¼åŠŸèƒ½ï¼Œåªæ˜¯å®ƒå¸Œæœ›å®¢æˆ·ç«¯åœ¨è¯·æ±‚ä¸€ä¸ªURIçš„æ—¶å€™ï¼Œèƒ½é€šè¿‡GETæ–¹æ³•é‡å®šå‘åˆ°å¦ä¸€ä¸ªURIä¸Š 304ï¼š å‘é€é™„å¸¦æ¡ä»¶çš„è¯·æ±‚æ—¶ï¼Œæ¡ä»¶ä¸æ»¡è¶³æ—¶è¿”å›ï¼Œä¸é‡å®šå‘æ— å…³ 307ï¼š ä¸´æ—¶é‡å®šå‘ï¼Œä¸ 302 ç±»ä¼¼ï¼Œåªæ˜¯å¼ºåˆ¶è¦æ±‚ä½¿ç”¨ POST æ–¹æ³• 400ï¼š è¯·æ±‚æŠ¥æ–‡è¯­æ³•æœ‰è¯¯ï¼ŒæœåŠ¡å™¨æ— æ³•è¯†åˆ« 401ï¼š è¯·æ±‚éœ€è¦è®¤è¯ 403ï¼š è¯·æ±‚çš„å¯¹åº”èµ„æºç¦æ­¢è¢«è®¿é—® 404ï¼š æœåŠ¡å™¨æ— æ³•æ‰¾åˆ°å¯¹åº”èµ„æº 500ï¼š æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ 503ï¼š æœåŠ¡å™¨æ­£å¿™ 302 æ˜¯ HTTP1.0 çš„åè®®çŠ¶æ€ç ï¼Œåœ¨ HTTP1.1 ç‰ˆæœ¬çš„æ—¶å€™ä¸ºäº†ç»†åŒ– 302 çŠ¶æ€ç åˆå‡ºæ¥äº†ä¸¤ä¸ª 303 å’Œ 307 ã€‚\n303 æ˜ç¡®è¡¨ç¤ºå®¢æˆ·ç«¯åº”å½“é‡‡ç”¨ GET æ–¹æ³•è·å–èµ„æºï¼Œä»–ä¼šæŠŠ POST è¯·æ±‚å˜ä¸º GET è¯·æ±‚è¿›è¡Œé‡å®šå‘ã€‚ 307ä¼šéµç…§æµè§ˆå™¨æ ‡å‡†ï¼Œä¸ä¼šä» POST å˜ä¸º GET ã€‚\nè¯·æ±‚æ–¹å¼ è¯·æ±‚æ–¹å¼ æè¿° GETï¼š ç”¨äºè¯·æ±‚è®¿é—®å·²ç»è¢«URIï¼ˆç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼‰è¯†åˆ«çš„èµ„æºï¼Œå¯ä»¥é€šè¿‡URLä¼ å‚ç»™æœåŠ¡å™¨ POSTï¼š ç”¨äºä¼ è¾“ä¿¡æ¯ç»™æœåŠ¡å™¨ï¼Œä¸»è¦åŠŸèƒ½ä¸GETæ–¹æ³•ç±»ä¼¼ï¼Œä½†ä¸€èˆ¬æ¨èä½¿ç”¨POSTæ–¹å¼ã€‚ PUTï¼š ä¼ è¾“æ–‡ä»¶ï¼ŒæŠ¥æ–‡ä¸»ä½“ä¸­åŒ…å«æ–‡ä»¶å†…å®¹ï¼Œä¿å­˜åˆ°å¯¹åº”URIä½ç½®ã€‚ HEADï¼š è·å¾—æŠ¥æ–‡é¦–éƒ¨ï¼Œä¸GETæ–¹æ³•ç±»ä¼¼ï¼Œåªæ˜¯ä¸è¿”å›æŠ¥æ–‡ä¸»ä½“ï¼Œä¸€èˆ¬ç”¨äºéªŒè¯URIæ˜¯å¦æœ‰ \u0026gt; æ•ˆã€‚ PATCHï¼š å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€çš„æ•°æ®å–ä»£æŒ‡å®šçš„æ–‡æ¡£çš„å†…å®¹(éƒ¨åˆ†å–ä»£) TRACEï¼š å›æ˜¾å®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨çš„åŸå§‹è¯·æ±‚æŠ¥æ–‡ï¼Œç”¨äº\u0026quot;å›ç¯\u0026quot;è¯Šæ–­ DELETEï¼š åˆ é™¤æ–‡ä»¶ï¼Œä¸PUTæ–¹æ³•ç›¸åï¼Œåˆ é™¤å¯¹åº”URIä½ç½®çš„æ–‡ä»¶ã€‚ OPTIONSï¼š æŸ¥è¯¢ç›¸åº”URIæ”¯æŒçš„HTTPæ–¹æ³•ã€‚ å†…å®¹ç±»å‹ Content-Type å­—æ®µç”¨äºå®šä¹‰ç½‘ç»œæ–‡ä»¶çš„ç±»å‹å’Œç½‘é¡µçš„ç¼–ç ï¼Œæµè§ˆå™¨ä½¿ç”¨ MIME ç±»å‹è€Œä¸æ˜¯æ–‡ä»¶æ‰©å±•åæ¥ç¡®å®šå¦‚ä½•å¤„ç† URL ã€‚\nğŸ”— Href IANA Media Types\nè¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š\ntype/subtype;parameter=value ç½‘ç»œæ–‡ä»¶çš„ç±»å‹æœ‰å¾ˆå¤šï¼Œä¸»è¦åˆ†ä¸ºä¸€ä¸‹å‡ ç±»ï¼š\nå¸¸è§çš„ç½‘ç»œæ–‡ä»¶çš„ç±»å‹\ntext/html ï¼š HTMLæ ¼å¼ text/plain ï¼šçº¯æ–‡æœ¬æ ¼å¼ text/xml ï¼š XMLæ ¼å¼ image/gif ï¼šgifå›¾ç‰‡æ ¼å¼ image/jpeg ï¼šjpgå›¾ç‰‡æ ¼å¼ image/pngï¼špngå›¾ç‰‡æ ¼å¼ ä»¥ application å¼€å¤´çš„\napplication/xhtml+xml ï¼šXHTMLæ ¼å¼ application/xmlï¼š XMLæ•°æ®æ ¼å¼ application/atom+xml ï¼šAtom XMLèšåˆæ ¼å¼ application/jsonï¼š JSONæ•°æ®æ ¼å¼ application/pdfï¼špdfæ ¼å¼ application/msword ï¼š Wordæ–‡æ¡£æ ¼å¼ application/octet-stream ï¼š äºŒè¿›åˆ¶æµæ•°æ®ï¼ˆå¦‚å¸¸è§çš„æ–‡ä»¶ä¸‹è½½ï¼‰ application/x-www-form-urlencoded ï¼š \u0026lt;form encType=â€â€\u0026gt;ä¸­é»˜è®¤çš„encTypeï¼Œformè¡¨å•æ•°æ®è¢«ç¼–ç ä¸ºkey/valueæ ¼å¼å‘é€åˆ°æœåŠ¡å™¨ï¼ˆè¡¨å•é»˜è®¤çš„æäº¤æ•°æ®çš„æ ¼å¼ï¼‰ ä¸Šä¼ æ–‡ä»¶æ—¶ä½¿ç”¨çš„\nmultipart/form-data ï¼š éœ€è¦åœ¨è¡¨å•ä¸­è¿›è¡Œæ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨è¯¥æ ¼å¼ ç‰ˆæœ¬å·®å¼‚ 2021 å¹´ä¸åŒç‰ˆæœ¬ä½¿ç”¨ç»Ÿè®¡\nProtocol Desktop Mobile HTTP/1.1 49.22% 50.05% HTTP/2+ 49.97% 49.28% HTTP 0.9 1991 å¹´æ¨å‡ºï¼ŒåŸå‹ç‰ˆæœ¬ï¼ŒåŠŸèƒ½ç®€é™‹ï¼Œåªæœ‰ä¸€ä¸ªå‘½ä»¤ GET ï¼Œä¸”åªæ”¯æŒçº¯æ–‡æœ¬å†…å®¹ï¼Œå› æ­¤ç‰ˆæœ¬å·²è¿‡æ—¶ã€‚\nHTTP 1.0 å¯ä»¥å‘é€ä»»ä½•æ ¼å¼çš„å†…å®¹ï¼Œè¿™ä½¿å¾—äº’è”ç½‘ä¸ä»…å¯ä»¥ä¼ è¾“æ–‡å­—ï¼Œè¿˜èƒ½ä¼ è¾“å›¾åƒã€è§†é¢‘ã€äºŒè¿›åˆ¶ç­‰æ–‡ä»¶ é™¤äº† GET å‘½ä»¤ï¼Œè¿˜å¼•å…¥äº† POST å‘½ä»¤å’Œ HEAD å‘½ä»¤ HTTP è¯·æ±‚å’Œå›åº”çš„æ ¼å¼æ”¹å˜ï¼Œé™¤äº†æ•°æ®éƒ¨åˆ†ï¼Œæ¯æ¬¡é€šä¿¡éƒ½å¿…é¡»åŒ…æ‹¬ å¤´ä¿¡æ¯header ï¼Œç”¨æ¥æè¿°ä¸€äº›å…ƒæ•°æ® åªä½¿ç”¨ header ä¸­çš„ If-Modified-Since å’Œ Expires ä½œä¸ºç¼“å­˜å¤±æ•ˆçš„æ ‡å‡†ã€‚ ä¸æ”¯æŒ æ–­ç‚¹ç»­ä¼  ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡éƒ½ä¼šä¼ é€å…¨éƒ¨çš„é¡µé¢å’Œæ•°æ® é€šå¸¸æ¯å°è®¡ç®—æœºåªèƒ½ç»‘å®šä¸€ä¸ª IPï¼Œæ‰€ä»¥è¯·æ±‚æ¶ˆæ¯ä¸­çš„ URL å¹¶æ²¡æœ‰ä¼ é€’ä¸»æœºå^hostname^ HTTP 1.1 HTTP1.1 æ˜¯ç›®å‰æœ€ä¸ºä¸»æµçš„ HTTP åè®®ç‰ˆæœ¬ï¼Œä» 1999 å¹´å‘å¸ƒè‡³ä»Šï¼Œä»æ˜¯ä¸»æµçš„HTTPåè®®ç‰ˆæœ¬ã€‚\nå¼•å…¥äº†æŒä¹…è¿æ¥persistent connection ï¼Œå³ TCP è¿æ¥é»˜è®¤ä¸å…³é—­ï¼Œå¯ä»¥è¢«å¤šä¸ªè¯·æ±‚å¤ç”¨ï¼Œä¸ç”¨å£°æ˜ Connection: keep-alive ã€‚é•¿è¿æ¥çš„è¿æ¥æ—¶é•¿å¯ä»¥é€šè¿‡è¯·æ±‚å¤´ä¸­çš„ keep-alive æ¥è®¾ç½® å¼•å…¥äº† ç®¡é“æœºåˆ¶^pipelining^ ï¼Œå³åœ¨åŒä¸€ä¸ª TCP è¿æ¥é‡Œï¼Œå®¢æˆ·ç«¯å¯ä»¥åŒæ—¶å‘é€å¤šä¸ª è¯·æ±‚ï¼Œè¿›ä¸€æ­¥æ”¹è¿›äº† HTTP åè®®çš„æ•ˆç‡ HTTP 1.1 ä¸­æ–°å¢åŠ äº† E-tagï¼ŒIf-Unmodified-Since, If-Match, If-None-Match ç­‰ç¼“å­˜æ§åˆ¶æ ‡å¤´æ¥æ§åˆ¶ç¼“å­˜å¤±æ•ˆ æ”¯æŒ æ–­ç‚¹ç»­ä¼  ï¼Œé€šè¿‡ä½¿ç”¨è¯·æ±‚å¤´ä¸­çš„ Range æ¥å®ç° ä½¿ç”¨äº†è™šæ‹Ÿç½‘ç»œï¼Œåœ¨ä¸€å°ç‰©ç†æœåŠ¡å™¨ä¸Šå¯ä»¥å­˜åœ¨å¤šä¸ªè™šæ‹Ÿä¸»æœºMulti-homed Web Servers ï¼Œå¹¶ä¸”å®ƒä»¬å…±äº«ä¸€ä¸ª IP åœ°å€ æ–°å¢æ–¹æ³•ï¼šPUTã€ PATCHã€ OPTIONSã€ DELETE ğŸ“ Note HTTP1.x ç‰ˆæœ¬é—®é¢˜\nåœ¨ä¼ è¾“æ•°æ®è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰å†…å®¹éƒ½æ˜¯æ˜æ–‡ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½æ— æ³•éªŒè¯å¯¹æ–¹çš„èº«ä»½ï¼Œæ— æ³•ä¿è¯æ•°æ®çš„å®‰å…¨æ€§ã€‚ HTTP/1.1 ç‰ˆæœ¬é»˜è®¤å…è®¸å¤ç”¨ TCP è¿æ¥ï¼Œä½†æ˜¯åœ¨åŒä¸€ä¸ª TCP è¿æ¥é‡Œï¼Œæ‰€æœ‰æ•°æ®é€šä¿¡æ˜¯æŒ‰æ¬¡åºè¿›è¡Œçš„ï¼ŒæœåŠ¡å™¨é€šå¸¸åœ¨å¤„ç†å®Œä¸€ä¸ªå›åº”åï¼Œæ‰ä¼šç»§ç»­å»å¤„ç†ä¸‹ä¸€ä¸ªï¼Œè¿™æ ·å­å°±ä¼šé€ æˆé˜Ÿå¤´é˜»å¡ã€‚ HTTP/1.x ç‰ˆæœ¬æ”¯æŒ Keep-alive ï¼Œç”¨æ­¤æ–¹æ¡ˆæ¥å¼¥è¡¥åˆ›å»ºå¤šæ¬¡è¿æ¥äº§ç”Ÿçš„å»¶è¿Ÿï¼Œä½†æ˜¯åŒæ ·ä¼šç»™æœåŠ¡å™¨å¸¦æ¥å‹åŠ›ï¼Œå¹¶ä¸”çš„è¯ï¼Œå¯¹äºå•æ–‡ä»¶è¢«ä¸æ–­è¯·æ±‚çš„æœåŠ¡ï¼ŒKeep-aliveä¼šæå¤§å½±å“æ€§èƒ½ï¼Œå› ä¸ºå®ƒåœ¨æ–‡ä»¶è¢«è¯·æ±‚ä¹‹åè¿˜ä¿æŒäº†ä¸å¿…è¦çš„è¿æ¥å¾ˆé•¿æ—¶é—´ã€‚ ğŸ“ Note HTTP1.x å­˜åœ¨é˜Ÿå¤´é˜»å¡\nå¯¹äºæ¯ä¸€ä¸ªHTTPè¯·æ±‚è€Œè¨€ï¼Œè¿™äº›ä»»åŠ¡æ˜¯ä¼šè¢«æ”¾å…¥ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­ä¸²è¡Œæ‰§è¡Œçš„ï¼Œä¸€æ—¦é˜Ÿé¦–ä»»åŠ¡è¯·æ±‚å¤ªæ…¢æ—¶ï¼Œå°±ä¼šé˜»å¡åé¢çš„è¯·æ±‚å¤„ç†ï¼Œè¿™å°±æ˜¯ HTTPé˜Ÿå¤´é˜»å¡ é—®é¢˜ã€‚\næƒå®œæ–¹æ¡ˆ å¹¶å‘è¿æ¥ æˆ‘ä»¬çŸ¥é“å¯¹äºä¸€ä¸ªåŸŸåè€Œè¨€ï¼Œæ˜¯å…è®¸åˆ†é… å¤šä¸ªé•¿è¿æ¥ çš„ï¼Œé‚£ä¹ˆå¯ä»¥ç†è§£æˆå¢åŠ äº†ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ä¼šå¯¼è‡´ä¸€ä¸ªä»»åŠ¡é˜»å¡äº†è¯¥ä»»åŠ¡é˜Ÿåˆ—çš„å…¶ä»–ä»»åŠ¡ï¼Œåœ¨ RFCè§„èŒƒ ä¸­è§„å®šå®¢æˆ·ç«¯æœ€å¤šå¹¶å‘ 2 ä¸ªè¿æ¥ï¼Œä¸è¿‡å®é™…æƒ…å†µå°±æ˜¯è¦æ¯”è¿™ä¸ªè¿˜è¦å¤šï¼Œä¸¾ä¸ªä¾‹å­ï¼ŒChrome ä¸­æ˜¯ 6 ä¸ªã€‚\nåŸŸååˆ†ç‰‡ é¡¾åæ€ä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªåŸŸåä¸‹åˆ†å‡ºå¤šä¸ªäºŒçº§åŸŸåå‡ºæ¥ï¼Œè€Œå®ƒä»¬æœ€ç»ˆæŒ‡å‘çš„è¿˜æ˜¯åŒä¸€ä¸ªæœåŠ¡å™¨ï¼Œè¿™æ ·å­çš„è¯å°±å¯ä»¥å¹¶å‘å¤„ç†çš„ä»»åŠ¡é˜Ÿåˆ—æ›´å¤šï¼Œä¹Ÿæ›´å¥½çš„è§£å†³äº†é˜Ÿå¤´é˜»å¡çš„é—®é¢˜ã€‚\nä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ TianTian.com ï¼Œå¯ä»¥åˆ†å‡ºå¾ˆå¤šäºŒçº§åŸŸåï¼Œæ¯”å¦‚Day1.TianTian.com, Day2.TianTian.com,Day3.TianTian.com,è¿™æ ·å­å°±å¯ä»¥æœ‰æ•ˆè§£å†³é˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚\nğŸ“ Note HTTP1.x æ•°æ®ä¼ è¾“\næ•°æ®ä¼ è¾“åˆ†ä¸º [å®šé•¿æ•°æ®] ä¸ [ä¸å®šé•¿æ•°æ®] çš„å¤„ç†ã€‚\nå®šé•¿æ•°æ® å¯¹äºå®šé•¿çš„æ•°æ®åŒ…è€Œè¨€ï¼Œå‘é€ç«¯åœ¨å‘é€æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦è®¾ç½® Content-Length æ¥æŒ‡æ˜å‘é€æ•°æ®çš„é•¿åº¦ã€‚\nå¦‚æœé‡‡ç”¨äº† Gzip å‹ç¼©çš„è¯ï¼ŒContent-Length è®¾ç½®çš„å°±æ˜¯å‹ç¼©åçš„ä¼ è¾“é•¿åº¦ã€‚\n- Content-Lengthå¦‚æœå­˜åœ¨å¹¶ä¸”æœ‰æ•ˆçš„è¯ï¼Œåˆ™å¿…é¡»å’Œæ¶ˆæ¯å†…å®¹çš„ä¼ è¾“é•¿åº¦å®Œå…¨ä¸€è‡´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè¿‡çŸ­å°±ä¼šæˆªæ–­ï¼Œè¿‡é•¿çš„è¯ï¼Œå°±ä¼šå¯¼è‡´è¶…æ—¶ã€‚ - å¦‚æœé‡‡ç”¨çŸ­é“¾æ¥çš„è¯ï¼Œç›´æ¥å¯ä»¥é€šè¿‡æœåŠ¡å™¨å…³é—­è¿æ¥æ¥ç¡®å®šæ¶ˆæ¯çš„ä¼ è¾“é•¿åº¦ã€‚ - é‚£ä¹ˆåœ¨HTTP/1.0ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼ŒContent-Lengthå­—æ®µå¯æœ‰å¯æ— ,å› ä¸ºä¸€æ—¦æœåŠ¡å™¨å…³é—­è¿æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å–åˆ°ä¼ è¾“æ•°æ®çš„é•¿åº¦äº†ã€‚ - åœ¨HTTP/1.1ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœæ˜¯Keep-aliveçš„è¯ï¼Œchunkedä¼˜å…ˆçº§é«˜äºContent-Lengthï¼Œè‹¥æ˜¯éKeep-aliveï¼Œè·Ÿå‰é¢æƒ…å†µä¸€æ ·ï¼ŒContent-Lengthå¯æœ‰å¯æ— ã€‚\nåœ¨ Node.js ä¸­è®¾ç½® Content-Length çš„åŠæ³•ï¼š\nimport HTTP from \u0026#39;HTTP\u0026#39;; const server = HTTP.createServer(); server.on(\u0026#39;request\u0026#39;, (req, res) =\u0026gt; { if (req.url === \u0026#39;/index\u0026#39;) { // è®¾ç½®æ•°æ®ç±»å‹ res.setHeader(\u0026#39;Content-Type\u0026#39;, \u0026#39;text/plain; charset=utf8\u0026#39;); res.setHeader(\u0026#39;Content-Length\u0026#39;, 10); res.write(\u0026#34;ä½ å¥½ï¼Œä½¿ç”¨çš„æ˜¯Content-Lengthè®¾ç½®ä¼ è¾“æ•°æ®å½¢å¼\u0026#34;); } }); server.listen(3000, () =\u0026gt; { console.log(\u0026#34;æˆåŠŸå¯åŠ¨\u0026#34;); // æˆåŠŸå¯åŠ¨ }); // è®¿é—® HTTP://127.0.0.1:3000/index // è¿”å› ä½ å¥½ï¼Œï¿½ ä¸å®šé•¿æ•°æ® ç°åœ¨é‡‡ç”¨æœ€å¤šçš„å°±æ˜¯HTTP/1.1ç‰ˆæœ¬ï¼Œæ¥å®Œæˆä¼ è¾“æ•°æ®ï¼Œåœ¨ä¿å­˜Keep-aliveçŠ¶æ€ä¸‹ï¼Œå½“æ•°æ®æ˜¯ä¸å®šé•¿çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®æ–°çš„å¤´éƒ¨å­—æ®µğŸ‘‡\nTransfer-Encoding: chunked é€šè¿‡ chunked æœºåˆ¶ï¼Œå¯ä»¥å®Œæˆå¯¹ä¸å®šé•¿æ•°æ®çš„å¤„ç†ï¼Œå½“ç„¶äº†ï¼Œä½ éœ€è¦çŸ¥é“çš„æ˜¯\n- å¦‚æœå¤´éƒ¨ä¿¡æ¯ä¸­æœ‰ Transfer-Encoding ï¼Œä¼˜å…ˆé‡‡ç”¨Transfer-Encodingé‡Œé¢çš„æ–¹æ³•æ¥æ‰¾åˆ°å¯¹åº”çš„é•¿åº¦ã€‚ - å¦‚æœè®¾ç½®äº†Transfer-Encodingï¼Œé‚£ä¹ˆContent-Lengthå°†è¢«å¿½è§†ã€‚ - ä½¿ç”¨é•¿è¿æ¥çš„è¯ï¼Œä¼šæŒç»­çš„æ¨é€åŠ¨æ€å†…å®¹ã€‚\nä½¿ç”¨ Node.js çš„ HTTP æ¨¡å—æ¨¡æ‹Ÿ\nimport HTTP from \u0026#39;HTTP\u0026#39;; const server = HTTP.createServer(); server.on(\u0026#39;request\u0026#39;, (req, res) =\u0026gt; { if (req.url === \u0026#39;/index\u0026#39;) { // è®¾ç½®æ•°æ®ç±»å‹ res.setHeader(\u0026#39;Content-Type\u0026#39;, \u0026#39;text/html; charset=utf8\u0026#39;); res.setHeader(\u0026#39;Content-Length\u0026#39;, 10); res.setHeader(\u0026#39;Transfer-Encoding\u0026#39;, \u0026#39;chunked\u0026#39;); res.write(\u0026#39;æ­£åœ¨ä½¿ç”¨ Transfer-Encoding:chunked è®¾ç½®ä¼ è¾“æ•°æ®å½¢å¼\u0026lt;br\u0026gt;\u0026#39;); let time = 0; const loading = setInterval(() =\u0026gt; res.write(`${time += 500}ms...\u0026lt;br\u0026gt;`), 500); res.write(\u0026#39;è¯·ç¨åï¼Œæ•°æ®æ­£åœ¨å¤„ç†ä¸­\u0026lt;br\u0026gt;\u0026#39;); setTimeout(() =\u0026gt; { res.write(\u0026#39;ç¬¬ä¸€æ¬¡ä¼ è¾“æ•°æ®\u0026lt;br\u0026gt;\u0026#39;); }, 1000); setTimeout(() =\u0026gt; { clearInterval(loading); res.write(\u0026#39;ç¬¬äºŒæ¬¡ä¼ è¾“æ•°æ®\u0026lt;br\u0026gt;\u0026#39;); res.end(); }, 3000); } }) server.listen(3000, () =\u0026gt; { console.log(\u0026#34;æˆåŠŸå¯åŠ¨\u0026#34;); }) /* * æ­£åœ¨ä½¿ç”¨ Transfer-Encoding:chunked è®¾ç½®ä¼ è¾“æ•°æ®å½¢å¼ * è¯·ç¨åï¼Œæ•°æ®æ­£åœ¨å¤„ç†ä¸­ * 500ms... * ç¬¬ä¸€æ¬¡ä¼ è¾“æ•°æ® * 1000ms... * 1500ms... * 2000ms... * 2500ms... * ç¬¬äºŒæ¬¡ä¼ è¾“æ•°æ® */ HTTP/2 äºŒè¿›åˆ¶åˆ†å¸§ è¿™æ˜¯ä¸€æ¬¡å½»åº•çš„äºŒè¿›åˆ¶åè®®ï¼Œå¤´ä¿¡æ¯å’Œæ•°æ®ä½“éƒ½æ˜¯äºŒè¿›åˆ¶ï¼Œå¹¶ä¸”ç»Ÿç§°ä¸º\u0026quot;å¸§\u0026quot;ï¼šå¤´ä¿¡æ¯å¸§å’Œæ•°æ®å¸§ã€‚ å¤´éƒ¨å‹ç¼© HTTP 1.1ç‰ˆæœ¬ä¼šå‡ºç° [User-Agentã€Cookieã€Acceptã€Serverã€Range] ç­‰å­—æ®µå¯èƒ½ä¼šå ç”¨å‡ ç™¾ç”šè‡³å‡ åƒå­—èŠ‚ï¼Œè€Œ Body å´ç»å¸¸åªæœ‰å‡ åå­—èŠ‚ï¼Œæ‰€ä»¥å¯¼è‡´å¤´éƒ¨åé‡ã€‚HTTP 2.0 ä½¿ç”¨ HPACK ç®—æ³•è¿›è¡Œå‹ç¼©ã€‚ å¤šè·¯å¤ç”¨ å¤ç”¨ TCP è¿æ¥ï¼Œåœ¨ä¸€ä¸ªè¿æ¥é‡Œï¼Œå®¢æˆ·ç«¯å’Œæµè§ˆå™¨éƒ½å¯ä»¥åŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚æˆ–å›åº”ï¼Œä¸”ä¸ç”¨æŒ‰é¡ºåºä¸€ä¸€å¯¹åº”ï¼Œè¿™æ ·å­ è§£å†³äº† é˜Ÿå¤´é˜»å¡çš„é—®é¢˜ã€‚ æœåŠ¡å™¨æ¨é€ å…è®¸æœåŠ¡å™¨æœªç»è¯·æ±‚ï¼Œä¸»åŠ¨å‘å®¢æˆ·ç«¯å‘é€èµ„æºï¼Œå³æœåŠ¡å™¨æ¨é€ã€‚ è¯·æ±‚ä¼˜å…ˆçº§ å¯ä»¥è®¾ç½®æ•°æ®å¸§çš„ä¼˜å…ˆçº§ï¼Œè®©æœåŠ¡ç«¯å…ˆå¤„ç†é‡è¦èµ„æºï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒã€‚ å¤´éƒ¨å‹ç¼© HTTP 1.1ç‰ˆæœ¬ä¼šå‡ºç° [User-Agentã€Cookieã€Acceptã€Serverã€Range] ç­‰å­—æ®µå¯èƒ½ä¼šå ç”¨å‡ ç™¾ç”šè‡³å‡ åƒå­—èŠ‚ï¼Œè€Œ Body å´ç»å¸¸åªæœ‰å‡ åå­—èŠ‚ï¼Œæ‰€ä»¥å¯¼è‡´å¤´éƒ¨åé‡ã€‚\nHTTP 2.0 ä½¿ç”¨ HPACK ç®—æ³•è¿›è¡Œå‹ç¼©ã€‚\nä»ä¸Šé¢çœ‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç±»ä¼¼äºç´¢å¼•è¡¨ï¼Œæ¯ä¸ªç´¢å¼•è¡¨å¯¹åº”ä¸€ä¸ªå€¼ï¼Œæ¯”å¦‚ç´¢å¼•ä¸º 2 å¯¹åº”å¤´éƒ¨ä¸­çš„ method å¤´éƒ¨ä¿¡æ¯ï¼Œè¿™æ ·å­çš„è¯ï¼Œåœ¨ä¼ è¾“çš„æ—¶å€™ï¼Œä¸åœ¨æ˜¯ä¼ è¾“å¯¹åº”çš„å¤´éƒ¨ä¿¡æ¯äº†ï¼Œè€Œæ˜¯ä¼ é€’ç´¢å¼•ï¼Œå¯¹äºä¹‹å‰å‡ºç°è¿‡çš„å¤´éƒ¨ä¿¡æ¯ï¼Œåªéœ€è¦æŠŠ [ç´¢å¼•] (æ¯”å¦‚1ï¼Œ2ï¼Œ\u0026hellip;)ä¼ ç»™å¯¹æ–¹å³å¯ï¼Œå¯¹æ–¹æ‹¿åˆ°ç´¢å¼•æŸ¥è¡¨å°±è¡Œäº†ã€‚\nè¿™ç§ [ä¼ ç´¢å¼•] çš„æ–¹å¼ï¼Œå¯ä»¥è¯´è®©è¯·æ±‚å¤´å­—æ®µå¾—åˆ°æå¤§ç¨‹åº¦çš„ç²¾ç®€å’Œå¤ç”¨ã€‚\nå¯¹äºæ•´æ•°å’Œå­—ç¬¦ä¸²è¿›è¡Œ [å“ˆå¤«æ›¼ç¼–ç ] ï¼Œå“ˆå¤«æ›¼ç¼–ç çš„åŸç†å°±æ˜¯å…ˆå°†æ‰€æœ‰å‡ºç°çš„å­—ç¬¦å»ºç«‹ä¸€å¼ ç´¢å¼•è¡¨ï¼Œç„¶åè®©å‡ºç°æ¬¡æ•°å¤šçš„å­—ç¬¦å¯¹åº”çš„ç´¢å¼•å°½å¯èƒ½çŸ­ï¼Œä¼ è¾“çš„æ—¶å€™ä¹Ÿæ˜¯ä¼ è¾“è¿™æ ·çš„ [ç´¢å¼•åºåˆ—] ï¼Œå¯ä»¥è¾¾åˆ°éå¸¸é«˜çš„å‹ç¼©ç‡ã€‚\n[é¦–éƒ¨è¡¨] åœ¨ HTTP/2 çš„è¿æ¥å­˜ç»­æœŸå†… å§‹ç»ˆå­˜åœ¨ ï¼Œç”±å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å…±åŒ æ¸è¿›æ›´æ–° ã€‚\nå¤šè·¯å¤ç”¨ HTTP 1.x ä¸­ï¼Œå¦‚æœæƒ³å¹¶å‘å¤šä¸ªè¯·æ±‚ï¼Œå¿…é¡»ä½¿ç”¨å¤šä¸ª TCP é“¾æ¥ï¼Œä¸”æµè§ˆå™¨ä¸ºäº†æ§åˆ¶èµ„æºï¼Œè¿˜ä¼šå¯¹å•ä¸ªåŸŸåæœ‰ 6-8 ä¸ªçš„ TCP é“¾æ¥è¯·æ±‚é™åˆ¶ã€‚\nHTTP2 ä¸­ï¼š\nåŒåŸŸåä¸‹æ‰€æœ‰é€šä¿¡éƒ½åœ¨ å•ä¸ªè¿æ¥ ä¸Šå®Œæˆã€‚ å•ä¸ªè¿æ¥å¯ä»¥æ‰¿è½½ ä»»æ„æ•°é‡ çš„ åŒå‘ æ•°æ®æµã€‚ æ•°æ®æµä»¥ æ¶ˆæ¯ çš„å½¢å¼å‘é€ï¼Œè€Œæ¶ˆæ¯åˆç”±ä¸€ä¸ªæˆ–å¤šä¸ªå¸§ç»„æˆï¼Œå¤šä¸ªå¸§ä¹‹é—´å¯ä»¥ ä¹±åºå‘é€ ï¼Œå› ä¸ºæ ¹æ®å¸§é¦–éƒ¨çš„æµæ ‡è¯†å¯ä»¥é‡æ–°ç»„è£… æœåŠ¡å™¨æ¨é€ æµè§ˆå™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼ŒæœåŠ¡å™¨ä¸»åŠ¨å‘æµè§ˆå™¨æ¨é€ä¸è¿™ä¸ªè¯·æ±‚ç›¸å…³çš„èµ„æºï¼Œè¿™æ ·æµè§ˆå™¨å°±ä¸ç”¨å‘èµ·åç»­è¯·æ±‚ã€‚\nç›¸æ¯”è¾ƒHTTP/1.1çš„ä¼˜åŠ¿\næ¨é€èµ„æºå¯ä»¥ç”±ä¸åŒé¡µé¢å…±äº« æœåŠ¡å™¨å¯ä»¥æŒ‰ç…§ä¼˜å…ˆçº§æ¨é€èµ„æº å®¢æˆ·ç«¯å¯ä»¥ç¼“å­˜æ¨é€çš„èµ„æº å®¢æˆ·ç«¯å¯ä»¥æ‹’æ”¶æ¨é€è¿‡æ¥çš„èµ„æº äºŒè¿›åˆ¶åˆ†å¸§ ä¹‹å‰æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œä¸æ–¹ä¾¿è®¡ç®—æœºè§£æï¼Œå¯¹äºå›è½¦æ¢è¡Œç¬¦æ¥è¯´åˆ°åº•æ˜¯å†…å®¹è¿˜æ˜¯åˆ†éš”ç¬¦ï¼Œéƒ½éœ€è¦å†…éƒ¨çŠ¶æ€æœºå»è¯†åˆ«ï¼Œè¿™æ ·å­æ•ˆç‡ä½ï¼ŒHTTP/2é‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼ï¼Œå…¨éƒ¨ä¼ è¾“01ä¸²ï¼Œä¾¿äºæœºå™¨è§£ç ã€‚\nè¿™æ ·å­ä¸€ä¸ªæŠ¥æ–‡æ ¼å¼å°±è¢«æ‹†åˆ†ä¸ºä¸€ä¸ªä¸ªäºŒè¿›åˆ¶å¸§ï¼Œç”¨ [Headerså¸§] å­˜æ”¾å¤´éƒ¨å­—æ®µï¼Œ [Dataå¸§] å­˜æ”¾è¯·æ±‚ä½“æ•°æ®ã€‚è¿™æ ·å­çš„è¯ï¼Œå°±æ˜¯ä¸€å †ä¹±åºçš„äºŒè¿›åˆ¶å¸§ï¼Œå®ƒä»¬ä¸å­˜åœ¨å…ˆåå…³ç³»ï¼Œå› æ­¤ä¸éœ€è¦æ’é˜Ÿç­‰å¾…ï¼Œè§£å†³äº†HTTPé˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚\nåœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ï¼ŒåŒæ–¹éƒ½å¯ä»¥äº’ç›¸å‘é€äºŒè¿›åˆ¶å¸§ï¼Œè¿™æ ·å­ [åŒå‘ä¼ è¾“çš„åºåˆ—]ï¼Œç§°ä¸º æµ^stream^ ï¼Œæ‰€ä»¥HTTP/2ä¸­ä»¥æµæ¥è¡¨ç¤ºä¸€ä¸ªTCPè¿æ¥ä¸Šè¿›è¡Œå¤šä¸ªæ•°æ®å¸§çš„é€šä¿¡ï¼Œè¿™å°±æ˜¯ [å¤šè·¯å¤ç”¨] æ¦‚å¿µã€‚\né‚£ä¹±åºçš„äºŒè¿›åˆ¶å¸§ï¼Œæ˜¯å¦‚ä½•ç»„è£…æˆå¯¹äºçš„æŠ¥æ–‡å‘¢ï¼Ÿ\næ‰€è°“çš„ä¹±åºï¼Œå€¼çš„æ˜¯ä¸åŒIDçš„Streamæ˜¯ä¹±åºçš„ï¼Œå¯¹äºåŒä¸€ä¸ªStream IDçš„å¸§æ˜¯æŒ‰é¡ºåºä¼ è¾“çš„ã€‚ æ¥æ”¶æ–¹æ”¶åˆ°äºŒè¿›åˆ¶å¸§åï¼Œå°†ç›¸åŒçš„Stream IDç»„è£…æˆå®Œæ•´çš„è¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡ã€‚ äºŒè¿›åˆ¶å¸§ä¸­æœ‰ä¸€äº›å­—æ®µï¼Œæ§åˆ¶ç€ä¼˜å…ˆçº§å’Œæµé‡æ§åˆ¶ç­‰åŠŸèƒ½ï¼Œè¿™æ ·å­çš„è¯ï¼Œå°±å¯ä»¥è®¾ç½®æ•°æ®å¸§çš„ä¼˜å…ˆçº§ï¼Œè®©æœåŠ¡å™¨å¤„ç†é‡è¦èµ„æºï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒã€‚ HTTP/3 ç”±äº TCP å’Œ UDP ä¸¤è€…åœ¨è¿è¾“å±‚å­˜åœ¨ä¸€å®šå·®å¼‚ï¼ŒTCP çš„ä¼ é€’æ•ˆç‡ä¸ UDP ç›¸æ¯”æœ‰å¤©ç„¶åŠ£åŠ¿ï¼Œäºæ˜¯ Google åŸºäº UDP å¼€å‘å‡ºäº†æ–°çš„åè®® QUIC ï¼Œå¸Œæœ›å–ä»£ TCP æé«˜ä¼ è¾“æ•ˆç‡ï¼Œåç»è¿‡åå•†å°†QUICåè®®æ›´åä¸ºHTTP/3ã€‚\nQUIC - Quick UDP Internet Connections\nTCPã€UDPæ˜¯æˆ‘ä»¬æ‰€ç†Ÿæ‚‰çš„ä¼ è¾“å±‚åè®®ï¼ŒUDPæ¯”TCPç›¸æ¯”æ•ˆç‡æ›´é«˜ä½†å¹¶ä¸å…·å¤‡ä¼ è¾“å¯é æ€§ã€‚è€ŒQUICä¾¿æ˜¯çœ‹ä¸­UDPä¼ è¾“æ•ˆç‡è¿™ä¸€ç‰¹æ€§ï¼Œå¹¶ç»“åˆäº†TCPã€TLSã€HTTP/2çš„ä¼˜åŠ¿ï¼ŒåŠ ä»¥ä¼˜åŒ–ã€‚\näºæ˜¯åœ¨QUICä¸Šå±‚çš„åº”ç”¨å±‚æ‰€è¿è¡Œçš„HTTPåè®®ä¹Ÿå°±è¢«ç§°ä¸ºHTTP/3ã€‚\nHTTP over QUIC is HTTP/3\né›¶ RTT å»ºç«‹è¿æ¥\nä¼ ç»Ÿ HTTP/2^*^ ä¼ è¾“æ•°æ®å‰éœ€è¦ä¸‰æ¬¡ RTT æ—¶å»¶ï¼Œå³ä½¿å°†ç¬¬ä¸€æ¬¡ TLS æ¡æ‰‹çš„å¯¹ç§°ç§˜é’¥ç¼“å­˜ä¹Ÿéœ€è¦ä¸¤æ¬¡ RTT æ‰èƒ½ä¼ é€’æ•°æ®\n*: ^æ‰€æœ‰HTTP/2çš„æµè§ˆå™¨å‡åŸºäºHTTPS^\nå¯¹äº HTTP/3 è€Œè¨€ï¼Œä»…ä»…éœ€è¦ä¸€æ¬¡ RTT å³å¯ä¼ é€’æ•°æ®ï¼Œå¦‚æœå°†å…¶ç¼“å­˜ï¼Œå°±å¯å°† RTT å‡å°‘è‡³é›¶ã€‚\nå…¶æ ¸å¿ƒå°±æ˜¯ DH ç§˜é’¥äº¤æ¢ç®—æ³•ã€‚\nå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯è¯·æ±‚æ•°æ®ã€‚ æœåŠ¡ç«¯ç”Ÿæˆ gã€pã€a ä¸‰ä¸ªéšæœºæ•°ï¼Œç”¨ä¸‰ä¸ªéšæœºæ•°ç”Ÿæˆ A ã€‚å°† a ä¿ç•™åï¼Œå°†gã€pã€A(Server Config) ä¼ é€’åˆ°å®¢æˆ·ç«¯ã€‚ å®¢æˆ·ç«¯ç”Ÿæˆéšæœºæ•°bï¼Œå°†bä¿ç•™åï¼Œç”¨gã€pã€bä¸‰ä¸ªéšæœºæ•°ç”ŸæˆBã€‚ å®¢æˆ·ç«¯å†ä½¿ç”¨Aã€bã€pç”Ÿæˆç§˜é’¥Kï¼Œç”¨K åŠ å¯†HTTPæ•°æ® å¹¶ä¸Bä¸€åŒå‘é€åˆ°æœåŠ¡ç«¯ã€‚ æœåŠ¡ç«¯å†ä½¿ç”¨Bã€aã€på¾—åˆ°ç›¸åŒç§˜é’¥Kï¼Œå¹¶è§£å¯† HTTP æ•°æ®ã€‚ è‡³æ­¤å³å¯å®Œæˆä¸€æ¬¡ RTT å¯¹è¿æ¥çš„å»ºç«‹ï¼Œå½“ç¼“å­˜ Server Config åé›¶ RTT å³å¯è¿›è¡Œæ•°æ®ä¼ é€’ã€‚\nè¿æ¥è¿ç§»\nä¼ ç»Ÿè¿æ¥é€šè¿‡æºIPã€æºç«¯å£ã€ç›®çš„IPã€ç›®çš„ç«¯å£è¿›è¡Œè¿æ¥ï¼Œå½“ç½‘ç»œå‘ç”Ÿæ›´æ¢åè¿æ¥å†æ¬¡å»ºç«‹æ—¶å»¶è¾ƒé•¿ã€‚\nHTTP/3 ä½¿ç”¨ Connection ID å¯¹è¿æ¥ä¿æŒï¼Œåªè¦ Connection ID ä¸æ”¹å˜ï¼Œè¿æ¥ä»å¯ç»´æŒã€‚\né˜Ÿå¤´é˜»å¡/å¤šè·¯å¤ç”¨\nTCP ä½œä¸ºé¢å‘è¿æ¥çš„åè®®ï¼Œå¯¹æ¯æ¬¡è¯·æ±‚åºç­‰åˆ° ACK æ‰å¯ç»§ç»­è¿æ¥ï¼Œä¸€æ—¦ä¸­é—´è¿æ¥ä¸¢å¤±å°†ä¼šäº§ç”Ÿé˜Ÿå¤´é˜»å¡ã€‚\nHTTP/1.1 ä¸­æå‡º Pipelining çš„æ–¹å¼ï¼Œå•ä¸ª TCP è¿æ¥å¯å¤šæ¬¡å‘é€è¯·æ±‚ï¼Œä½†ä¾æ—§ä¼šæœ‰ä¸­é—´è¯·æ±‚ä¸¢å¤±äº§ç”Ÿé˜»å¡çš„é—®é¢˜ã€‚\nHTTP/2 ä¸­å°†è¯·æ±‚ç²’åº¦å‡å°ï¼Œé€šè¿‡ Frame çš„æ–¹å¼è¿›è¡Œè¯·æ±‚çš„å‘é€ã€‚ä½†åœ¨TCPå±‚Frameç»„åˆå¾—åˆ°Streamè¿›è¡Œä¼ è¾“ï¼Œä¸€æ—¦å‡ºç°Streamä¸­çš„Frameä¸¢å¤±ï¼Œå…¶åæ–¹çš„Streaméƒ½å°†ä¼šè¢«é˜»å¡ã€‚\nå¯¹äºHTTP/2è€Œè¨€ï¼Œæµè§ˆå™¨ä¼šé»˜è®¤é‡‡å–TLSæ–¹å¼ä¼ è¾“ï¼ŒTLSåŸºäºRecordç»„ç»‡æ•°æ®ï¼Œæ¯ä¸ªRecordåŒ…å«16Kï¼Œå…¶ä¸­æœ‰12ä¸ªTCPçš„åŒ…ï¼Œä¸€æ—¦å…¶ä¸­ä¸€ä¸ªTCPåŒ…å‡ºç°é—®é¢˜å°†ä¼šå¯¼è‡´æ•´ä¸ªRecordæ— æ³•è§£å¯†ã€‚\nè¿™ä¹Ÿæ˜¯ç½‘ç»œç¯å¢ƒè¾ƒå·®æ—¶ HTTP/2çš„ä¼ è¾“é€Ÿåº¦æ¯”HTTP/1.1æ›´æ…¢ çš„åŸå› ã€‚\nHTTP/3åŸºäºUDPçš„ä¼ è¾“ï¼Œä¸ä¿è¯ è¿æ¥å¯é æ€§ ï¼Œä¹Ÿå°±æ²¡æœ‰å¯¹å¤´é˜»å¡çš„åæœã€‚åŒæ ·ä¼ è¾“å•å…ƒä¸åŠ å¯†å•å…ƒä¸ºPacketï¼Œåœ¨ TLS ä¸‹ä¹Ÿå¯é¿å…å¯¹å¤´é˜»å¡çš„é—®é¢˜ã€‚\næ‹¥å¡æ§åˆ¶\nçƒ­æ‹”æ’ï¼šTCPå¯¹äºæ‹¥å¡æ§åˆ¶åœ¨äºä¼ è¾“å±‚ï¼ŒQUIC å¯åœ¨åº”ç”¨å±‚æ“ä½œæ”¹å˜æ‹¥å¡æ§åˆ¶æ–¹æ³•ã€‚\nFEC^å‰å‘çº é”™^ï¼šå°†æ•°æ®åˆ‡å‰²æˆåŒ…åå¯å¯¹æ¯ä¸ªåŒ…è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå°†è¿ç®—ç»“æœéšæ•°æ®å‘é€ã€‚ä¸€æ—¦ä¸¢å¤±æ•°æ®å¯æ®æ­¤æ¨ç®—ã€‚(å¸¦å®½æ¢æ—¶é—´)\nå•è°ƒé€’å¢çš„ Packet Number ï¼šTCP åœ¨è¶…æ—¶é‡ä¼ åçš„ä¸¤æ¬¡ ACK æ¥å—æƒ…å†µå¹¶ä¸æ”¯æŒçš„å¾ˆå¥½ã€‚å¯¼è‡´ RTT å’Œ RTO çš„è®¡ç®—æœ‰æ‰€åå·®ã€‚HTTP/3 å¯¹æ­¤è¿›è¡Œæ”¹è¿›ï¼Œä¸€æ—¦é‡ä¼ åçš„ Packet N ä¼šé€’å¢ã€‚\nACK Delay\nHTTP/3 åœ¨è®¡ç®— RTT æ—¶å¥å£®çš„è€ƒè™‘äº†æœåŠ¡ç«¯çš„ ACK å¤„ç†æ—¶å»¶ã€‚\næ›´å¤šåœ° ACK å—\nä¸€èˆ¬æ¯æ¬¡è¯·æ±‚éƒ½ä¼šå¯¹åº”ä¸€ä¸ª ACK ï¼Œä½†è¿™æ ·ä¹Ÿä¼šæµªè´¹(ä¸‹è½½åœºæ™¯åªéœ€è¿”å›æ•°æ®å³å¯)ã€‚\näºæ˜¯å¯è®¾è®¡æˆæ¯æ¬¡è¿”å› 3 ä¸ªACK block ã€‚åœ¨ HTTP/3 å°†å…¶æ‰©å……æˆæœ€å¤šå¯æºå¸¦ 256 ä¸ª ACK block ã€‚\næµé‡æ§åˆ¶\nTCP ä½¿ç”¨æ»‘åŠ¨çª—å£çš„æ–¹å¼å¯¹å‘é€æ–¹çš„æµé‡è¿›è¡Œæ§åˆ¶ã€‚è€Œå¯¹æ¥æ”¶æ–¹å¹¶æ— é™åˆ¶ã€‚åœ¨ QUIC ä¸­ä¾¿è¡¥é½äº†è¿™ä¸€çŸ­æ¿ã€‚\nQUIC ä¸­æ¥æ”¶æ–¹ä»å•æŒ‘Streamå’Œæ•´æ¡è¿æ¥ä¸¤ä¸ªè§’åº¦åŠ¨æ€è°ƒæ•´æ¥å—çš„çª—å£å¤§å°ã€‚\nç¼“å­˜æœºåˆ¶ æˆ‘ä»¬çŸ¥é“ HTTP çš„ç¼“å­˜å±äº å®¢æˆ·ç«¯ç¼“å­˜ ï¼Œåé¢ä¼šæåˆ°ä¸ºä»€ä¹ˆå±äºå®¢æˆ·ç«¯ç¼“å­˜ã€‚æ‰€ä»¥æˆ‘ä»¬è®¤ä¸ºæµè§ˆå™¨å­˜åœ¨ä¸€ä¸ªç¼“å­˜æ•°æ®åº“ï¼Œç”¨äºå‚¨å­˜ä¸€äº›ä¸ç»å¸¸å˜åŒ–çš„é™æ€æ–‡ä»¶ï¼ˆå›¾ç‰‡ã€cssã€jsç­‰ï¼‰ã€‚æˆ‘ä»¬å°†ç¼“å­˜åˆ†ä¸ºå¼ºåˆ¶ç¼“å­˜å’Œåå•†ç¼“å­˜ã€‚ä¸‹é¢æˆ‘å°†åˆ†åˆ«è¯¦ç»†çš„ä»‹ç»è¿™ä¸¤ç§ç¼“å­˜çš„ç¼“å­˜è§„åˆ™ã€‚\nå¼ºåˆ¶ç¼“å­˜ å½“ç¼“å­˜æ•°æ®åº“ä¸­å·²æœ‰æ‰€è¯·æ±‚çš„æ•°æ®æ—¶ã€‚å®¢æˆ·ç«¯ç›´æ¥ä»ç¼“å­˜æ•°æ®åº“ä¸­è·å–æ•°æ®ã€‚å½“ç¼“å­˜æ•°æ®åº“ä¸­æ²¡æœ‰æ‰€è¯·æ±‚çš„æ•°æ®æ—¶ï¼Œå®¢æˆ·ç«¯çš„æ‰ä¼šä»æœåŠ¡ç«¯è·å–æ•°æ®ã€‚\nç”± [Expires] å’Œ [Cache-Control] å­—æ®µæ§åˆ¶ã€‚\nğŸ—‘ Depreciated\nExpires Expriresçš„å€¼ä¸ºæœåŠ¡ç«¯è¿”å›çš„æ•°æ®åˆ°æœŸæ—¶é—´ã€‚å½“å†æ¬¡è¯·æ±‚æ—¶çš„è¯·æ±‚æ—¶é—´å°äºè¿”å›çš„æ­¤æ—¶é—´ï¼Œåˆ™ç›´æ¥ä½¿ç”¨ç¼“å­˜æ•°æ®ã€‚\nä½†ç”±äºæœåŠ¡ç«¯æ—¶é—´å’Œå®¢æˆ·ç«¯æ—¶é—´å¯èƒ½æœ‰è¯¯å·®ï¼Œè¿™ä¹Ÿå°†å¯¼è‡´ç¼“å­˜å‘½ä¸­çš„è¯¯å·®ï¼Œå¦ä¸€æ–¹é¢ï¼ŒExpires æ˜¯ HTTP1.0 çš„äº§ç‰©ï¼Œæ•…ç°åœ¨å¤§å¤šæ•°ä½¿ç”¨ Cache-Control æ›¿ä»£ã€‚\nCache-Control privateï¼šå®¢æˆ·ç«¯å¯ä»¥ç¼“å­˜ publicï¼šå®¢æˆ·ç«¯å’Œä»£ç†æœåŠ¡å™¨éƒ½å¯ä»¥ç¼“å­˜ max-age=tï¼šç¼“å­˜å†…å®¹å°†åœ¨tç§’åå¤±æ•ˆ no-cacheï¼šéœ€è¦ä½¿ç”¨åå•†ç¼“å­˜æ¥éªŒè¯ç¼“å­˜æ•°æ® no-storeï¼šæ‰€æœ‰å†…å®¹éƒ½ä¸ä¼šç¼“å­˜ åå•†ç¼“å­˜ åˆç§°å¯¹æ¯”ç¼“å­˜ï¼Œå®¢æˆ·ç«¯ä¼šå…ˆä»ç¼“å­˜æ•°æ®åº“ä¸­è·å–åˆ°ä¸€ä¸ªç¼“å­˜æ•°æ®çš„æ ‡è¯†ï¼Œå¾—åˆ°æ ‡è¯†åè¯·æ±‚æœåŠ¡ç«¯éªŒè¯æ˜¯å¦å¤±æ•ˆï¼ˆæ–°é²œï¼‰ï¼Œå¦‚æœæ²¡æœ‰å¤±æ•ˆæœåŠ¡ç«¯ä¼šè¿”å› 304 ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯ç›´æ¥ä»ç¼“å­˜ä¸­è·å–æ‰€è¯·æ±‚çš„æ•°æ®ï¼Œå¦‚æœæ ‡è¯†å¤±æ•ˆï¼ŒæœåŠ¡ç«¯ä¼šè¿”å›æ›´æ–°åçš„æ•°æ®ã€‚\nç”± [Last-Modified] å’Œ [E-tag] å­—æ®µæ§åˆ¶ã€‚\nLast-Modified Last-Modifiedï¼š æœåŠ¡å™¨åœ¨å“åº”è¯·æ±‚æ—¶ï¼Œä¼šå‘Šè¯‰æµè§ˆå™¨èµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´ã€‚\nif-Modified-Since: æµè§ˆå™¨å†æ¬¡è¯·æ±‚æœåŠ¡å™¨çš„æ—¶å€™ï¼Œè¯·æ±‚å¤´ä¼šåŒ…å«æ­¤å­—æ®µï¼Œåé¢è·Ÿç€åœ¨ç¼“å­˜ä¸­è·å¾—çš„æœ€åä¿®æ”¹æ—¶é—´ã€‚æœåŠ¡ç«¯æ”¶åˆ°æ­¤è¯·æ±‚å¤´å‘ç°æœ‰ if-Modified-Since ï¼Œåˆ™ä¸è¢«è¯·æ±‚èµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœä¸€è‡´åˆ™è¿”å› 304 å’Œå“åº”æŠ¥æ–‡å¤´ï¼Œæµè§ˆå™¨åªéœ€è¦ä»ç¼“å­˜ä¸­è·å–ä¿¡æ¯å³å¯ã€‚ ä»å­—é¢ä¸Šçœ‹ï¼Œå°±æ˜¯è¯´ï¼šä»æŸä¸ªæ—¶é—´èŠ‚ç‚¹ç®—èµ·ï¼Œæ˜¯å¦æ–‡ä»¶è¢«ä¿®æ”¹äº†\nå¦‚æœçœŸçš„è¢«ä¿®æ”¹: é‚£ä¹ˆå¼€å§‹ä¼ è¾“å“åº”ä¸€ä¸ªæ•´ä½“\nâŸ¹ æœåŠ¡å™¨è¿”å›: 200 OK\nå¦‚æœæ²¡æœ‰è¢«ä¿®æ”¹: é‚£ä¹ˆåªéœ€ä¼ è¾“å“åº” header\nâŸ¹ æœåŠ¡å™¨è¿”å›: 304 Not Modified\nif-Unmodified-Since: ä»å­—é¢ä¸Šçœ‹, å°±æ˜¯è¯´: ä»æŸä¸ªæ—¶é—´ç‚¹ç®—èµ·, æ˜¯å¦æ–‡ä»¶æ²¡æœ‰è¢«ä¿®æ”¹\nå¦‚æœæ²¡æœ‰è¢«ä¿®æ”¹: åˆ™å¼€å§‹ç»§ç»­ä¼ é€æ–‡ä»¶\nâŸ¹ æœåŠ¡å™¨è¿”å›: 200 OK\nå¦‚æœæ–‡ä»¶è¢«ä¿®æ”¹: åˆ™ä¸ä¼ è¾“\nâŸ¹ æœåŠ¡å™¨è¿”å› 412 Precondition failed^é¢„å¤„ç†é”™è¯¯^\nåä¸¤ä¸ªçš„åŒºåˆ«æ˜¯ä¸€ä¸ªæ˜¯ä¿®æ”¹äº†æ‰ä¸‹è½½ä¸€ä¸ªæ˜¯æ²¡ä¿®æ”¹æ‰ä¸‹è½½ã€‚\nLast-Modified è¯´å¥½å´ä¹Ÿä¸æ˜¯ç‰¹åˆ«å¥½ï¼Œå› ä¸ºå¦‚æœåœ¨æœåŠ¡å™¨ä¸Šï¼Œä¸€ä¸ªèµ„æºè¢«ä¿®æ”¹äº†ï¼Œä½†å…¶å®é™…å†…å®¹æ ¹æœ¬æ²¡å‘ç”Ÿæ”¹å˜ï¼Œä¼šå› ä¸º Last-Modified æ—¶é—´åŒ¹é…ä¸ä¸Šè€Œè¿”å›äº†æ•´ä¸ªå®ä½“ç»™å®¢æˆ·ç«¯ï¼ˆå³ä½¿å®¢æˆ·ç«¯ç¼“å­˜é‡Œæœ‰ä¸ªä¸€æ¨¡ä¸€æ ·çš„èµ„æºï¼‰ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒHTTP1.1 æ¨å‡ºäº† Etag ã€‚\nğŸ—‘ Depreciated\nEtag Etag: æœåŠ¡å™¨å“åº”è¯·æ±‚æ—¶ï¼Œé€šè¿‡æ­¤å­—æ®µå‘Šè¯‰æµè§ˆå™¨å½“å‰èµ„æºåœ¨æœåŠ¡å™¨ç”Ÿæˆçš„å”¯ä¸€æ ‡è¯†ï¼ˆç”Ÿæˆè§„åˆ™ç”±æœåŠ¡å™¨å†³å®šï¼‰\nIf-None-Match: å†æ¬¡è¯·æ±‚æœåŠ¡å™¨æ—¶ï¼Œæµè§ˆå™¨çš„è¯·æ±‚æŠ¥æ–‡å¤´éƒ¨ä¼šåŒ…å«æ­¤å­—æ®µï¼Œåé¢çš„å€¼ä¸ºåœ¨ç¼“å­˜ä¸­è·å–çš„æ ‡è¯†ã€‚æœåŠ¡å™¨æ¥æ”¶åˆ°æ¬¡æŠ¥æ–‡åå‘ç° If-None-Match åˆ™ä¸è¢«è¯·æ±‚èµ„æºçš„å”¯ä¸€æ ‡è¯†è¿›è¡Œå¯¹æ¯”ã€‚\nä¸åŒï¼Œè¯´æ˜èµ„æºè¢«æ”¹åŠ¨è¿‡ï¼Œåˆ™å“åº”æ•´ä¸ªèµ„æºå†…å®¹\nâŸ¹æœåŠ¡å™¨è¿”å›: 200 OK\nç›¸åŒï¼Œè¯´æ˜èµ„æºæ— å¿ƒä¿®æ”¹ï¼Œåˆ™å“åº” header ï¼Œæµè§ˆå™¨ç›´æ¥ä»ç¼“å­˜ä¸­è·å–æ•°æ®ä¿¡æ¯ã€‚\nâŸ¹ è¿”å›çŠ¶æ€ç : 304 Not Modified\nä½†æ˜¯å®é™…åº”ç”¨ä¸­ç”±äº Etag çš„è®¡ç®—æ˜¯ä½¿ç”¨ç®—æ³•æ¥å¾—å‡ºçš„ï¼Œè€Œç®—æ³•ä¼šå ç”¨æœåŠ¡ç«¯è®¡ç®—çš„èµ„æºï¼Œæ‰€æœ‰æœåŠ¡ç«¯çš„èµ„æºéƒ½æ˜¯å®è´µçš„ï¼Œæ‰€ä»¥å°±å¾ˆå°‘ä½¿ç”¨ Etag äº†ã€‚\nğŸ“ Note\nä¸¤ç±»ç¼“å­˜æœºåˆ¶å¯ä»¥åŒæ—¶å­˜åœ¨ï¼Œå¼ºåˆ¶ç¼“å­˜ çš„ä¼˜å…ˆçº§é«˜äº åå•†ç¼“å­˜ ï¼Œå½“æ‰§è¡Œå¼ºåˆ¶ç¼“å­˜æ—¶ï¼Œå¦‚è‹¥ç¼“å­˜å‘½ä¸­ï¼Œåˆ™ç›´æ¥ä½¿ç”¨ç¼“å­˜æ•°æ®åº“æ•°æ®ï¼Œä¸å†è¿›è¡Œåå•†ç¼“å­˜ã€‚\nğŸ“ Note ä¸åŒåˆ·æ–°çš„è¯·æ±‚æ‰§è¡Œè¿‡ç¨‹\næµè§ˆå™¨åœ°å€æ ä¸­å†™å…¥ URL ï¼Œå›è½¦\næµè§ˆå™¨å‘ç°ç¼“å­˜ä¸­æœ‰è¿™ä¸ªæ–‡ä»¶äº†ï¼Œä¸ç”¨ç»§ç»­è¯·æ±‚äº†ï¼Œç›´æ¥å»ç¼“å­˜æ‹¿ã€‚ï¼ˆæœ€å¿«ï¼‰\nF5\nF5å°±æ˜¯å‘Šè¯‰æµè§ˆå™¨ï¼Œåˆ«å·æ‡’ï¼Œå¥½æ­¹å»æœåŠ¡å™¨çœ‹çœ‹è¿™ä¸ªæ–‡ä»¶æ˜¯å¦æœ‰è¿‡æœŸäº†ã€‚äºæ˜¯æµè§ˆå™¨å°±èƒ†èƒ†è¥Ÿè¥Ÿçš„å‘é€ä¸€ä¸ªè¯·æ±‚å¸¦ä¸Š If-Modify-since ã€‚\nCtrl + F5\nå‘Šè¯‰æµè§ˆå™¨ï¼Œä½ å…ˆæŠŠä½ ç¼“å­˜ä¸­çš„è¿™ä¸ªæ–‡ä»¶ç»™æˆ‘åˆ äº†ï¼Œç„¶åå†å»æœåŠ¡å™¨è¯·æ±‚ä¸ªå®Œæ•´çš„èµ„æºæ–‡ä»¶ä¸‹æ¥ã€‚äºæ˜¯å®¢æˆ·ç«¯å°±å®Œæˆäº†å¼ºè¡Œæ›´æ–°çš„æ“ä½œ.\nHTTPS HTTPS - HyperText Transfer Protocol Secure^è¶…æ–‡æœ¬ä¼ è¾“å®‰å…¨åè®®^\nHTTP åè®®é‡‡ç”¨æ˜æ–‡ä¼ è¾“ä¿¡æ¯ï¼Œå­˜åœ¨ä¿¡æ¯çªƒå¬ã€ä¿¡æ¯ç¯¡æ”¹å’Œä¿¡æ¯åŠ«æŒçš„é£é™©ï¼Œè€Œåè®® TLS/SSL å…·æœ‰èº«ä»½éªŒè¯ã€ä¿¡æ¯åŠ å¯†å’Œå®Œæ•´æ€§æ ¡éªŒçš„åŠŸèƒ½ï¼Œå¯ä»¥é¿å…æ­¤ç±»é—®é¢˜å‘ç”Ÿã€‚\nå› æ­¤ï¼ŒHTTPS åœ¨ HTTP çš„åŸºç¡€ä¸Šå¢åŠ äº† TLS/SSL åè®®ï¼Œè¿™å±‚åè®®ä»‹äº [TCP] ä¸ [HTTP] ä¹‹é—´ã€‚\nå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯é€šä¿¡ï¼š\nTLS/SSL TLS - Transport Layer Security^ä¼ è¾“å±‚å®‰å…¨æ€§åè®®^\nSSL - Secure Sockets Layer^å®‰å…¨å¥—æ¥å±‚^ ä¸ºå…¶å‰èº«\nå…¶åŠŸèƒ½å®ç°ä¸»è¦ä¾èµ–äºä¸‰ç±»åŸºæœ¬ç®—æ³•ï¼šæ•£åˆ—å‡½æ•° Hashã€å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ï¼Œå…¶åˆ©ç”¨éå¯¹ç§°åŠ å¯†å®ç°èº«ä»½è®¤è¯å’Œå¯†é’¥åå•†ï¼Œå¯¹ç§°åŠ å¯†ç®—æ³•é‡‡ç”¨åå•†çš„å¯†é’¥å¯¹æ•°æ®åŠ å¯†ï¼ŒåŸºäºæ•£åˆ—å‡½æ•°éªŒè¯ä¿¡æ¯çš„å®Œæ•´æ€§ã€‚\næ•£åˆ—å‡½æ•°Hash å¸¸è§çš„æœ‰ MD5ã€SHA1ã€SHA256ï¼Œè¯¥ç±»å‡½æ•°ç‰¹ç‚¹æ˜¯å‡½æ•°å•å‘ä¸å¯é€†ã€å¯¹è¾“å…¥éå¸¸æ•æ„Ÿã€è¾“å‡ºé•¿åº¦å›ºå®šï¼Œé’ˆå¯¹æ•°æ®çš„ä»»ä½•ä¿®æ”¹éƒ½ä¼šæ”¹å˜æ•£åˆ—å‡½æ•°çš„ç»“æœï¼Œç”¨äºé˜²æ­¢ä¿¡æ¯ç¯¡æ”¹å¹¶éªŒè¯æ•°æ®çš„å®Œæ•´æ€§; åœ¨ä¿¡æ¯ä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œæ•£åˆ—å‡½æ•°ä¸èƒ½å•ç‹¬å®ç°ä¿¡æ¯é˜²ç¯¡æ”¹ï¼Œå› ä¸ºæ˜æ–‡ä¼ è¾“ï¼Œä¸­é—´äººå¯ä»¥ä¿®æ”¹ä¿¡æ¯ä¹‹åé‡æ–°è®¡ç®—ä¿¡æ¯æ‘˜è¦ï¼Œå› æ­¤éœ€è¦å¯¹ä¼ è¾“çš„ä¿¡æ¯ä»¥åŠä¿¡æ¯æ‘˜è¦è¿›è¡ŒåŠ å¯†;\nå¯¹ç§°åŠ å¯† å¸¸è§çš„æœ‰ AES-CBCã€DESã€3DESã€AES-GCM ç­‰ï¼Œç›¸åŒçš„å¯†é’¥å¯ä»¥ç”¨äºä¿¡æ¯çš„åŠ å¯†å’Œè§£å¯†ï¼ŒæŒæ¡å¯†é’¥æ‰èƒ½è·å–ä¿¡æ¯ï¼Œèƒ½å¤Ÿé˜²æ­¢ä¿¡æ¯çªƒå¬ï¼Œé€šä¿¡æ–¹å¼æ˜¯1å¯¹1; å¯¹ç§°åŠ å¯†çš„ä¼˜åŠ¿æ˜¯ä¿¡æ¯ä¼ è¾“1å¯¹1ï¼Œéœ€è¦å…±äº«ç›¸åŒçš„å¯†ç ï¼Œå¯†ç çš„å®‰å…¨æ˜¯ä¿è¯ä¿¡æ¯å®‰å…¨çš„åŸºç¡€ï¼ŒæœåŠ¡å™¨å’Œ N ä¸ªå®¢æˆ·ç«¯é€šä¿¡ï¼Œéœ€è¦ç»´æŒ N ä¸ªå¯†ç è®°å½•ï¼Œä¸”ç¼ºå°‘ä¿®æ”¹å¯†ç çš„æœºåˆ¶;\néå¯¹ç§°åŠ å¯† å³å¸¸è§çš„ RSA ç®—æ³•ï¼Œè¿˜åŒ…æ‹¬ ECCã€DH ç­‰ç®—æ³•ï¼Œç®—æ³•ç‰¹ç‚¹æ˜¯ï¼Œå¯†é’¥æˆå¯¹å‡ºç°ï¼Œä¸€èˆ¬ç§°ä¸ºå…¬é’¥(å…¬å¼€)å’Œç§é’¥(ä¿å¯†)ï¼Œå…¬é’¥åŠ å¯†çš„ä¿¡æ¯åªèƒ½ç§é’¥è§£å¼€ï¼Œç§é’¥åŠ å¯†çš„ä¿¡æ¯åªèƒ½å…¬é’¥è§£å¼€ã€‚å› æ­¤æŒæ¡å…¬é’¥çš„ä¸åŒå®¢æˆ·ç«¯ä¹‹é—´ä¸èƒ½äº’ç›¸è§£å¯†ä¿¡æ¯ï¼Œåªèƒ½å’ŒæŒæ¡ç§é’¥çš„æœåŠ¡å™¨è¿›è¡ŒåŠ å¯†é€šä¿¡ï¼ŒæœåŠ¡å™¨å¯ä»¥å®ç°1å¯¹å¤šçš„é€šä¿¡ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ç”¨æ¥éªŒè¯æŒæ¡ç§é’¥çš„æœåŠ¡å™¨èº«ä»½ã€‚ éå¯¹ç§°åŠ å¯†çš„ç‰¹ç‚¹æ˜¯ä¿¡æ¯ä¼ è¾“1å¯¹å¤šï¼ŒæœåŠ¡å™¨åªéœ€è¦ç»´æŒä¸€ä¸ªç§é’¥å°±èƒ½å¤Ÿå’Œå¤šä¸ªå®¢æˆ·ç«¯è¿›è¡ŒåŠ å¯†é€šä¿¡ï¼Œä½†æœåŠ¡å™¨å‘å‡ºçš„ä¿¡æ¯èƒ½å¤Ÿè¢«æ‰€æœ‰çš„å®¢æˆ·ç«¯è§£å¯†ï¼Œä¸”è¯¥ç®—æ³•çš„è®¡ç®—å¤æ‚ï¼ŒåŠ å¯†é€Ÿåº¦æ…¢ã€‚\nç»“åˆä¸‰ç±»ç®—æ³•çš„ç‰¹ç‚¹ï¼ŒTLSçš„åŸºæœ¬å·¥ä½œæ–¹å¼æ˜¯ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨éå¯¹ç§°åŠ å¯†ä¸æœåŠ¡å™¨è¿›è¡Œé€šä¿¡ï¼Œå®ç°èº«ä»½éªŒè¯å¹¶åå•†å¯¹ç§°åŠ å¯†ä½¿ç”¨çš„å¯†é’¥ï¼Œ ç„¶åå¯¹ç§°åŠ å¯†ç®—æ³•é‡‡ç”¨åå•†å¯†é’¥å¯¹ä¿¡æ¯ä»¥åŠä¿¡æ¯æ‘˜è¦è¿›è¡ŒåŠ å¯†é€šä¿¡ï¼Œä¸åŒçš„èŠ‚ç‚¹ä¹‹é—´é‡‡ç”¨çš„å¯¹ç§°å¯†é’¥ä¸åŒï¼Œä»è€Œå¯ä»¥ä¿è¯ä¿¡æ¯åªèƒ½é€šä¿¡åŒæ–¹è·å–ã€‚\nPKIä½“ç³» RSAèº«ä»½éªŒè¯çš„éšæ‚£ èº«ä»½éªŒè¯å’Œå¯†é’¥åå•†æ˜¯TLSçš„åŸºç¡€åŠŸèƒ½ï¼Œè¦æ±‚çš„å‰ææ˜¯åˆæ³•çš„æœåŠ¡å™¨æŒæ¡ç€å¯¹åº”çš„ç§é’¥ã€‚ä½†RSAç®—æ³•æ— æ³•ç¡®ä¿æœåŠ¡å™¨èº«ä»½çš„åˆæ³•æ€§ï¼Œå› ä¸ºå…¬é’¥å¹¶ä¸åŒ…å«æœåŠ¡å™¨çš„ä¿¡æ¯ï¼Œå­˜åœ¨å®‰å…¨éšæ‚£:\nå®¢æˆ·ç«¯Cå’ŒæœåŠ¡å™¨Sè¿›è¡Œé€šä¿¡ï¼Œä¸­é—´èŠ‚ç‚¹Mæˆªè·äº†äºŒè€…çš„é€šä¿¡; èŠ‚ç‚¹Mè‡ªå·±è®¡ç®—äº§ç”Ÿä¸€å¯¹å…¬é’¥pub_Må’Œç§é’¥pri_M; Cå‘Sè¯·æ±‚å…¬é’¥æ—¶ï¼ŒMæŠŠè‡ªå·±çš„å…¬é’¥pub_Må‘ç»™äº†C; Cä½¿ç”¨å…¬é’¥ pub_MåŠ å¯†çš„æ•°æ®èƒ½å¤Ÿè¢«Mè§£å¯†ï¼Œå› ä¸ºMæŒæ¡å¯¹åº”çš„ç§é’¥pri_Mï¼Œè€Œ Cæ— æ³•æ ¹æ®å…¬é’¥ä¿¡æ¯åˆ¤æ–­æœåŠ¡å™¨çš„èº«ä»½ï¼Œä»è€Œ Cå’Œ * Mä¹‹é—´å»ºç«‹äº†\u0026quot;å¯ä¿¡\u0026quot;åŠ å¯†è¿æ¥; ä¸­é—´èŠ‚ç‚¹ Må’ŒæœåŠ¡å™¨Sä¹‹é—´å†å»ºç«‹åˆæ³•çš„è¿æ¥ï¼Œå› æ­¤ Cå’Œ Sä¹‹é—´é€šä¿¡è¢«Må®Œå…¨æŒæ¡ï¼ŒMå¯ä»¥è¿›è¡Œä¿¡æ¯çš„çªƒå¬ã€ç¯¡æ”¹ç­‰æ“ä½œã€‚ å¦å¤–ï¼ŒæœåŠ¡å™¨ä¹Ÿå¯ä»¥å¯¹è‡ªå·±çš„å‘å‡ºçš„ä¿¡æ¯è¿›è¡Œå¦è®¤ï¼Œä¸æ‰¿è®¤ç›¸å…³ä¿¡æ¯æ˜¯è‡ªå·±å‘å‡ºã€‚ å› æ­¤è¯¥æ–¹æ¡ˆä¸‹è‡³å°‘å­˜åœ¨ä¸¤ç±»é—®é¢˜ï¼šä¸­é—´äººæ”»å‡»å’Œä¿¡æ¯æŠµèµ–ã€‚\nèº«ä»½éªŒè¯CAå’Œè¯ä¹¦ è§£å†³ä¸Šè¿°èº«ä»½éªŒè¯é—®é¢˜çš„å…³é”®æ˜¯ç¡®ä¿è·å–çš„å…¬é’¥é€”å¾„æ˜¯åˆæ³•çš„ï¼Œèƒ½å¤ŸéªŒè¯æœåŠ¡å™¨çš„èº«ä»½ä¿¡æ¯ï¼Œä¸ºæ­¤éœ€è¦å¼•å…¥æƒå¨çš„ç¬¬ä¸‰æ–¹æœºæ„CA(å¦‚æ²ƒé€šCA)ã€‚CA è´Ÿè´£æ ¸å®å…¬é’¥çš„æ‹¥æœ‰è€…çš„ä¿¡æ¯ï¼Œå¹¶é¢å‘è®¤è¯\u0026quot;è¯ä¹¦\u0026quot;ï¼ŒåŒæ—¶èƒ½å¤Ÿä¸ºä½¿ç”¨è€…æä¾›è¯ä¹¦éªŒè¯æœåŠ¡ï¼Œå³PKIä½“ç³»(PKIåŸºç¡€çŸ¥è¯†)ã€‚\nåŸºæœ¬çš„åŸç†ä¸ºï¼ŒCAè´Ÿè´£å®¡æ ¸ä¿¡æ¯ï¼Œç„¶åå¯¹å…³é”®ä¿¡æ¯åˆ©ç”¨ç§é’¥è¿›è¡Œ\u0026quot;ç­¾å\u0026quot;ï¼Œå…¬å¼€å¯¹åº”çš„å…¬é’¥ï¼Œå®¢æˆ·ç«¯å¯ä»¥åˆ©ç”¨å…¬é’¥éªŒè¯ç­¾åã€‚CAä¹Ÿå¯ä»¥åŠé”€å·²ç»ç­¾å‘çš„è¯ä¹¦ï¼ŒåŸºæœ¬çš„æ–¹å¼åŒ…æ‹¬ä¸¤ç±» CRL æ–‡ä»¶å’Œ OCSPã€‚CAä½¿ç”¨å…·ä½“çš„æµç¨‹å¦‚ä¸‹ï¼š\na.æœåŠ¡æ–¹Så‘ç¬¬ä¸‰æ–¹æœºæ„CAæäº¤å…¬é’¥ã€ç»„ç»‡ä¿¡æ¯ã€ä¸ªäººä¿¡æ¯(åŸŸå)ç­‰ä¿¡æ¯å¹¶ç”³è¯·è®¤è¯;\nb.CAé€šè¿‡çº¿ä¸Šã€çº¿ä¸‹ç­‰å¤šç§æ‰‹æ®µéªŒè¯ç”³è¯·è€…æä¾›ä¿¡æ¯çš„çœŸå®æ€§ï¼Œå¦‚ç»„ç»‡æ˜¯å¦å­˜åœ¨ã€ä¼ä¸šæ˜¯å¦åˆæ³•ï¼Œæ˜¯å¦æ‹¥æœ‰åŸŸåçš„æ‰€æœ‰æƒç­‰;\nc.å¦‚ä¿¡æ¯å®¡æ ¸é€šè¿‡ï¼ŒCAä¼šå‘ç”³è¯·è€…ç­¾å‘è®¤è¯æ–‡ä»¶-è¯ä¹¦ã€‚ è¯ä¹¦åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼šç”³è¯·è€…å…¬é’¥ã€ç”³è¯·è€…çš„ç»„ç»‡ä¿¡æ¯å’Œä¸ªäººä¿¡æ¯ã€ç­¾å‘æœºæ„ CAçš„ä¿¡æ¯ã€æœ‰æ•ˆæ—¶é—´ã€è¯ä¹¦åºåˆ—å·ç­‰ä¿¡æ¯çš„æ˜æ–‡ï¼ŒåŒæ—¶åŒ…å«ä¸€ä¸ªç­¾å; ç­¾åçš„äº§ç”Ÿç®—æ³•ï¼šé¦–å…ˆï¼Œä½¿ç”¨æ•£åˆ—å‡½æ•°è®¡ç®—å…¬å¼€çš„æ˜æ–‡ä¿¡æ¯çš„ä¿¡æ¯æ‘˜è¦ï¼Œç„¶åï¼Œé‡‡ç”¨ CAçš„ç§é’¥å¯¹ä¿¡æ¯æ‘˜è¦è¿›è¡ŒåŠ å¯†ï¼Œå¯†æ–‡å³ç­¾å;\nd.å®¢æˆ·ç«¯ C å‘æœåŠ¡å™¨ S å‘å‡ºè¯·æ±‚æ—¶ï¼ŒS è¿”å›è¯ä¹¦æ–‡ä»¶;\ne.å®¢æˆ·ç«¯ Cè¯»å–è¯ä¹¦ä¸­çš„ç›¸å…³çš„æ˜æ–‡ä¿¡æ¯ï¼Œé‡‡ç”¨ç›¸åŒçš„æ•£åˆ—å‡½æ•°è®¡ç®—å¾—åˆ°ä¿¡æ¯æ‘˜è¦ï¼Œç„¶åï¼Œåˆ©ç”¨å¯¹åº” CAçš„å…¬é’¥è§£å¯†ç­¾åæ•°æ®ï¼Œå¯¹æ¯”è¯ä¹¦çš„ä¿¡æ¯æ‘˜è¦ï¼Œå¦‚æœä¸€è‡´ï¼Œåˆ™å¯ä»¥ç¡®è®¤è¯ä¹¦çš„åˆæ³•æ€§ï¼Œå³å…¬é’¥åˆæ³•;\nf.å®¢æˆ·ç«¯ç„¶åéªŒè¯è¯ä¹¦ç›¸å…³çš„åŸŸåä¿¡æ¯ã€æœ‰æ•ˆæ—¶é—´ç­‰ä¿¡æ¯;\ng.å®¢æˆ·ç«¯ä¼šå†…ç½®ä¿¡ä»»CAçš„è¯ä¹¦ä¿¡æ¯(åŒ…å«å…¬é’¥)ï¼Œå¦‚æœCAä¸è¢«ä¿¡ä»»ï¼Œåˆ™æ‰¾ä¸åˆ°å¯¹åº” CAçš„è¯ä¹¦ï¼Œè¯ä¹¦ä¹Ÿä¼šè¢«åˆ¤å®šéæ³•ã€‚\nåœ¨è¿™ä¸ªè¿‡ç¨‹æ³¨æ„å‡ ç‚¹ï¼š\na.ç”³è¯·è¯ä¹¦ä¸éœ€è¦æä¾›ç§é’¥ï¼Œç¡®ä¿ç§é’¥æ°¸è¿œåªèƒ½æœåŠ¡å™¨æŒæ¡;\nb.è¯ä¹¦çš„åˆæ³•æ€§ä»ç„¶ä¾èµ–äºéå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œè¯ä¹¦ä¸»è¦æ˜¯å¢åŠ äº†æœåŠ¡å™¨ä¿¡æ¯ä»¥åŠç­¾å;\nc.å†…ç½® CA å¯¹åº”çš„è¯ä¹¦ç§°ä¸ºæ ¹è¯ä¹¦ï¼Œé¢å‘è€…å’Œä½¿ç”¨è€…ç›¸åŒï¼Œè‡ªå·±ä¸ºè‡ªå·±ç­¾åï¼Œå³è‡ªç­¾åè¯ä¹¦ï¼ˆä¸ºä»€ä¹ˆè¯´\u0026quot;éƒ¨ç½²è‡ªç­¾SSLè¯ä¹¦éå¸¸ä¸å®‰å…¨\u0026quot;ï¼‰\nd.è¯ä¹¦=å…¬é’¥+ç”³è¯·è€…ä¸é¢å‘è€…ä¿¡æ¯+ç­¾å;\nè¯ä¹¦é“¾ å¦‚ CAæ ¹è¯ä¹¦å’ŒæœåŠ¡å™¨è¯ä¹¦ä¸­é—´å¢åŠ ä¸€çº§è¯ä¹¦æœºæ„ï¼Œå³ä¸­é—´è¯ä¹¦ï¼Œè¯ä¹¦çš„äº§ç”Ÿå’ŒéªŒè¯åŸç†ä¸å˜ï¼Œåªæ˜¯å¢åŠ ä¸€å±‚éªŒè¯ï¼Œåªè¦æœ€åèƒ½å¤Ÿè¢«ä»»ä½•ä¿¡ä»»çš„CAæ ¹è¯ä¹¦éªŒè¯åˆæ³•å³å¯ã€‚\na.æœåŠ¡å™¨è¯ä¹¦ server.pem çš„ç­¾å‘è€…ä¸ºä¸­é—´è¯ä¹¦æœºæ„ interï¼Œinter æ ¹æ®è¯ä¹¦ inter.pem éªŒè¯ server.pem ç¡®å®ä¸ºè‡ªå·±ç­¾å‘çš„æœ‰æ•ˆè¯ä¹¦;\nb.ä¸­é—´è¯ä¹¦ inter.pem çš„ç­¾å‘ CA ä¸º rootï¼Œroot æ ¹æ®è¯ä¹¦ root.pem éªŒè¯ inter.pem ä¸ºè‡ªå·±ç­¾å‘çš„åˆæ³•è¯ä¹¦;\nc.å®¢æˆ·ç«¯å†…ç½®ä¿¡ä»» CA çš„ root.pem è¯ä¹¦ï¼Œå› æ­¤æœåŠ¡å™¨è¯ä¹¦ server.pem çš„è¢«ä¿¡ä»»ã€‚\næœåŠ¡å™¨è¯ä¹¦ã€ä¸­é—´è¯ä¹¦ä¸æ ¹è¯ä¹¦åœ¨ä¸€èµ·ç»„åˆæˆä¸€æ¡åˆæ³•çš„è¯ä¹¦é“¾ï¼Œè¯ä¹¦é“¾çš„éªŒè¯æ˜¯è‡ªä¸‹è€Œä¸Šçš„ä¿¡ä»»ä¼ é€’çš„è¿‡ç¨‹ã€‚ äºŒçº§è¯ä¹¦ç»“æ„å­˜åœ¨çš„ä¼˜åŠ¿ï¼š\na.å‡å°‘æ ¹è¯ä¹¦ç»“æ„çš„ç®¡ç†å·¥ä½œé‡ï¼Œå¯ä»¥æ›´é«˜æ•ˆçš„è¿›è¡Œè¯ä¹¦çš„å®¡æ ¸ä¸ç­¾å‘;\nb.æ ¹è¯ä¹¦ä¸€èˆ¬å†…ç½®åœ¨å®¢æˆ·ç«¯ä¸­ï¼Œç§é’¥ä¸€èˆ¬ç¦»çº¿å­˜å‚¨ï¼Œä¸€æ—¦ç§é’¥æ³„éœ²ï¼Œåˆ™åŠé”€è¿‡ç¨‹éå¸¸å›°éš¾ï¼Œæ— æ³•åŠæ—¶è¡¥æ•‘;\nc.ä¸­é—´è¯ä¹¦ç»“æ„çš„ç§é’¥æ³„éœ²ï¼Œåˆ™å¯ä»¥å¿«é€Ÿåœ¨çº¿åŠé”€ï¼Œå¹¶é‡æ–°ä¸ºç”¨æˆ·ç­¾å‘æ–°çš„è¯ä¹¦;\nd.è¯ä¹¦é“¾å››çº§ä»¥å†…ä¸€èˆ¬ä¸ä¼šå¯¹ HTTPS çš„æ€§èƒ½é€ æˆæ˜æ˜¾å½±å“ã€‚\nè¯ä¹¦é“¾æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š\na.åŒä¸€æœ¬æœåŠ¡å™¨è¯ä¹¦å¯èƒ½å­˜åœ¨å¤šæ¡åˆæ³•çš„è¯ä¹¦é“¾ã€‚ å› ä¸ºè¯ä¹¦çš„ç”Ÿæˆå’ŒéªŒè¯åŸºç¡€æ˜¯å…¬é’¥å’Œç§é’¥å¯¹ï¼Œå¦‚æœé‡‡ç”¨ç›¸åŒçš„å…¬é’¥å’Œç§é’¥ç”Ÿæˆä¸åŒçš„ä¸­é—´è¯ä¹¦ï¼Œé’ˆå¯¹è¢«ç­¾å‘è€…è€Œè¨€ï¼Œè¯¥ç­¾å‘æœºæ„éƒ½æ˜¯åˆæ³•çš„ CAï¼Œä¸åŒçš„æ˜¯ä¸­é—´è¯ä¹¦çš„ç­¾å‘æœºæ„ä¸åŒ;\nb.ä¸åŒè¯ä¹¦é“¾çš„å±‚çº§ä¸ä¸€å®šç›¸åŒï¼Œå¯èƒ½äºŒçº§ã€ä¸‰çº§æˆ–å››çº§è¯ä¹¦é“¾ã€‚ ä¸­é—´è¯ä¹¦çš„ç­¾å‘æœºæ„å¯èƒ½æ˜¯æ ¹è¯ä¹¦æœºæ„ä¹Ÿå¯èƒ½æ˜¯å¦ä¸€ä¸ªä¸­é—´è¯ä¹¦æœºæ„ï¼Œæ‰€ä»¥è¯ä¹¦é“¾å±‚çº§ä¸ä¸€å®šç›¸åŒã€‚\nè¯ä¹¦åŠé”€ CA æœºæ„èƒ½å¤Ÿç­¾å‘è¯ä¹¦ï¼ŒåŒæ ·ä¹Ÿå­˜åœ¨æœºåˆ¶å®£å¸ƒä»¥å¾€ç­¾å‘çš„è¯ä¹¦æ— æ•ˆã€‚è¯ä¹¦ä½¿ç”¨è€…ä¸åˆæ³•ï¼ŒCA éœ€è¦åºŸå¼ƒè¯¥è¯ä¹¦;æˆ–è€…ç§é’¥ä¸¢å¤±ï¼Œä½¿ç”¨è€…ç”³è¯·è®©è¯ä¹¦æ— æ•ˆã€‚ä¸»è¦å­˜åœ¨ä¸¤ç±»æœºåˆ¶ï¼šCRL ä¸ OCSPã€‚\nCRL Certificate Revocation List, è¯ä¹¦åŠé”€åˆ—è¡¨(ä»€ä¹ˆæ˜¯è¯ä¹¦åŠé”€åˆ—è¡¨(CRL)ï¼ŸåŠé”€åˆ—è¡¨èµ·ä»€ä¹ˆä½œç”¨)ï¼Œä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶åŒ…å«äº† CA å·²ç»åŠé”€çš„è¯ä¹¦åºåˆ—å·(å”¯ä¸€)ä¸åŠé”€æ—¥æœŸï¼ŒåŒæ—¶è¯¥æ–‡ä»¶åŒ…å«ç”Ÿæ•ˆæ—¥æœŸå¹¶é€šçŸ¥ä¸‹æ¬¡æ›´æ–°è¯¥æ–‡ä»¶çš„æ—¶é—´ï¼Œå½“ç„¶è¯¥æ–‡ä»¶å¿…ç„¶åŒ…å« CA ç§é’¥çš„ç­¾åä»¥éªŒè¯æ–‡ä»¶çš„åˆæ³•æ€§ã€‚ è¯ä¹¦ä¸­ä¸€èˆ¬ä¼šåŒ…å«ä¸€ä¸ª URL åœ°å€ CRL Distribution Pointï¼Œé€šçŸ¥ä½¿ç”¨è€…å»å“ªé‡Œä¸‹è½½å¯¹åº”çš„ CRL ä»¥æ ¡éªŒè¯ä¹¦æ˜¯å¦åŠé”€ã€‚è¯¥åŠé”€æ–¹å¼çš„ä¼˜ç‚¹æ˜¯ä¸éœ€è¦é¢‘ç¹æ›´æ–°ï¼Œä½†æ˜¯ä¸èƒ½åŠæ—¶åŠé”€è¯ä¹¦ï¼Œå› ä¸º CRL æ›´æ–°æ—¶é—´ä¸€èˆ¬æ˜¯å‡ å¤©ï¼Œè¿™æœŸé—´å¯èƒ½å·²ç»é€ æˆäº†æå¤§æŸå¤±ã€‚\nOCSP Online Certificate Status Protocol, è¯ä¹¦çŠ¶æ€åœ¨çº¿æŸ¥è¯¢åè®®ï¼Œä¸€ä¸ªå®æ—¶æŸ¥è¯¢è¯ä¹¦æ˜¯å¦åŠé”€çš„æ–¹å¼ã€‚è¯·æ±‚è€…å‘é€è¯ä¹¦çš„ä¿¡æ¯å¹¶è¯·æ±‚æŸ¥è¯¢ï¼ŒæœåŠ¡å™¨è¿”å›æ­£å¸¸ã€åŠé”€æˆ–æœªçŸ¥ä¸­çš„ä»»ä½•ä¸€ä¸ªçŠ¶æ€ã€‚è¯ä¹¦ä¸­ä¸€èˆ¬ä¹Ÿä¼šåŒ…å«ä¸€ä¸ª OCSP çš„ URL åœ°å€ï¼Œè¦æ±‚æŸ¥è¯¢æœåŠ¡å™¨å…·æœ‰è‰¯å¥½çš„æ€§èƒ½ã€‚éƒ¨åˆ† CA æˆ–å¤§éƒ¨åˆ†çš„è‡ªç­¾ CA (æ ¹è¯ä¹¦)éƒ½æ˜¯æœªæä¾› CRL æˆ– OCSP åœ°å€çš„ï¼Œå¯¹äºåŠé”€è¯ä¹¦ä¼šæ˜¯ä¸€ä»¶éå¸¸éº»çƒ¦çš„äº‹æƒ…ã€‚\næ€§èƒ½ä¼˜åŒ– æ€§èƒ½æŸè€— å‰æ–‡è®¨è®ºäº† HTTPS åŸç†ä¸ä¼˜åŠ¿ï¼šèº«ä»½éªŒè¯ã€ä¿¡æ¯åŠ å¯†ä¸å®Œæ•´æ€§æ ¡éªŒç­‰ï¼Œä¸”æœªå¯¹ TCP å’Œ HTTP åè®®åšä»»ä½•ä¿®æ”¹ã€‚ä½†é€šè¿‡å¢åŠ æ–°åè®®ä»¥å®ç°æ›´å®‰å…¨çš„é€šä¿¡å¿…ç„¶éœ€è¦ä»˜å‡ºä»£ä»·ï¼ŒHTTPS åè®®çš„æ€§èƒ½æŸè€—ä¸»è¦ä½“ç°å¦‚ä¸‹ï¼š\nå¢åŠ å»¶æ—¶ åˆ†æå‰é¢çš„æ¡æ‰‹è¿‡ç¨‹ï¼Œä¸€æ¬¡å®Œæ•´çš„æ¡æ‰‹è‡³å°‘éœ€è¦ä¸¤ç«¯ä¾æ¬¡æ¥å›ä¸¤æ¬¡é€šä¿¡ï¼Œè‡³å°‘å¢åŠ å»¶æ—¶ 2RTTï¼Œåˆ©ç”¨ä¼šè¯ç¼“å­˜ä»è€Œå¤ç”¨è¿æ¥ï¼Œå»¶æ—¶ä¹Ÿè‡³å°‘ 1RTT ã€‚\næ¶ˆè€—è¾ƒå¤šçš„ CPU èµ„æº é™¤æ•°æ®ä¼ è¾“ä¹‹å¤–ï¼ŒHTTPS é€šä¿¡ä¸»è¦åŒ…æ‹¬å¯¹å¯¹ç§°åŠ è§£å¯†ã€éå¯¹ç§°åŠ è§£å¯†(æœåŠ¡å™¨ä¸»è¦é‡‡ç”¨ç§é’¥è§£å¯†æ•°æ®)ï¼›å‹æµ‹ TS8 æœºå‹çš„å•æ ¸ CPUï¼šå¯¹ç§°åŠ å¯†ç®—æ³• AES-CBC-256 ååé‡ 600Mbps ï¼Œéå¯¹ç§° RSA ç§é’¥è§£å¯† 200æ¬¡/s ã€‚ä¸è€ƒè™‘å…¶å®ƒè½¯ä»¶å±‚é¢çš„å¼€é”€ï¼Œ10G ç½‘å¡ä¸ºå¯¹ç§°åŠ å¯†éœ€è¦æ¶ˆè€— CPU çº¦17æ ¸ï¼Œ24 æ ¸ CPU æœ€å¤šæ¥å…¥ HTTPS è¿æ¥ 4800ï¼› é™æ€èŠ‚ç‚¹å½“å‰10G ç½‘å¡çš„ TS8 æœºå‹çš„ HTTP å•æœºæ¥å…¥èƒ½åŠ›çº¦ä¸º10w/sï¼Œå¦‚æœå°†æ‰€æœ‰çš„ HTTP è¿æ¥å˜ä¸º HTTPS è¿æ¥ï¼Œåˆ™æ˜æ˜¾ RSA çš„è§£å¯†æœ€å…ˆæˆä¸ºç“¶é¢ˆã€‚å› æ­¤ï¼ŒRSA çš„è§£å¯†èƒ½åŠ›æ˜¯å½“å‰å›°æ‰° HTTPS æ¥å…¥çš„ä¸»è¦éš¾é¢˜ã€‚\nHTTPSæ¥å…¥ä¼˜åŒ– CDNæ¥å…¥ HTTPS å¢åŠ çš„å»¶æ—¶ä¸»è¦æ˜¯ä¼ è¾“å»¶æ—¶ RTTï¼ŒRTT çš„ç‰¹ç‚¹æ˜¯èŠ‚ç‚¹è¶Šè¿‘å»¶æ—¶è¶Šå°ï¼ŒCDN å¤©ç„¶ç¦»ç”¨æˆ·æœ€è¿‘ï¼Œå› æ­¤é€‰æ‹©ä½¿ç”¨ CDN ä½œä¸º HTTPS æ¥å…¥çš„å…¥å£ï¼Œå°†èƒ½å¤Ÿæå¤§å‡å°‘æ¥å…¥å»¶æ—¶ã€‚CDN èŠ‚ç‚¹é€šè¿‡å’Œä¸šåŠ¡æœåŠ¡å™¨ç»´æŒé•¿è¿æ¥ã€ä¼šè¯å¤ç”¨å’Œé“¾è·¯è´¨é‡ä¼˜åŒ–ç­‰å¯æ§æ–¹æ³•ï¼Œæå¤§å‡å°‘ HTTPS å¸¦æ¥çš„å»¶æ—¶ã€‚\nä¼šè¯ç¼“å­˜ è™½ç„¶å‰æ–‡æåˆ° HTTPS å³ä½¿é‡‡ç”¨ä¼šè¯ç¼“å­˜ä¹Ÿè¦è‡³å°‘1*RTTçš„å»¶æ—¶ï¼Œä½†æ˜¯è‡³å°‘å»¶æ—¶å·²ç»å‡å°‘ä¸ºåŸæ¥çš„ä¸€åŠï¼Œæ˜æ˜¾çš„å»¶æ—¶ä¼˜åŒ–;åŒæ—¶ï¼ŒåŸºäºä¼šè¯ç¼“å­˜å»ºç«‹çš„ HTTPS è¿æ¥ä¸éœ€è¦æœåŠ¡å™¨ä½¿ç”¨RSAç§é’¥è§£å¯†è·å– Pre-master ä¿¡æ¯ï¼Œå¯ä»¥çœå»CPU çš„æ¶ˆè€—ã€‚å¦‚æœä¸šåŠ¡è®¿é—®è¿æ¥é›†ä¸­ï¼Œç¼“å­˜å‘½ä¸­ç‡é«˜ï¼Œåˆ™HTTPSçš„æ¥å…¥èƒ½åŠ›è®²æ˜æ˜¾æå‡ã€‚å½“å‰TRPå¹³å°çš„ç¼“å­˜å‘½ä¸­ç‡é«˜å³°æ—¶æœŸå¤§äº30%ï¼Œ10k/sçš„æ¥å…¥èµ„æºå®é™…å¯ä»¥æ‰¿è½½13k/çš„æ¥å…¥ï¼Œæ”¶æ•ˆéå¸¸å¯è§‚ã€‚\nç¡¬ä»¶åŠ é€Ÿ ä¸ºæ¥å…¥æœåŠ¡å™¨å®‰è£…ä¸“ç”¨çš„SSLç¡¬ä»¶åŠ é€Ÿå¡ï¼Œä½œç”¨ç±»ä¼¼ GPUï¼Œé‡Šæ”¾ CPUï¼Œèƒ½å¤Ÿå…·æœ‰æ›´é«˜çš„ HTTPS æ¥å…¥èƒ½åŠ›ä¸”ä¸å½±å“ä¸šåŠ¡ç¨‹åºçš„ã€‚æµ‹è¯•æŸç¡¬ä»¶åŠ é€Ÿå¡å•å¡å¯ä»¥æä¾›35kçš„è§£å¯†èƒ½åŠ›ï¼Œç›¸å½“äº175æ ¸ CPUï¼Œè‡³å°‘ç›¸å½“äº7å°24æ ¸çš„æœåŠ¡å™¨ï¼Œè€ƒè™‘åˆ°æ¥å…¥æœåŠ¡å™¨å…¶å®ƒç¨‹åºçš„å¼€é”€ï¼Œä¸€å¼ ç¡¬ä»¶å¡å¯ä»¥å®ç°æ¥è¿‘10å°æœåŠ¡å™¨çš„æ¥å…¥èƒ½åŠ›ã€‚\nè¿œç¨‹è§£å¯† æœ¬åœ°æ¥å…¥æ¶ˆè€—è¿‡å¤šçš„ CPU èµ„æºï¼Œæµªè´¹äº†ç½‘å¡å’Œç¡¬ç›˜ç­‰èµ„æºï¼Œè€ƒè™‘å°†æœ€æ¶ˆè€— CPU èµ„æºçš„RSAè§£å¯†è®¡ç®—ä»»åŠ¡è½¬ç§»åˆ°å…¶å®ƒæœåŠ¡å™¨ï¼Œå¦‚æ­¤åˆ™å¯ä»¥å……åˆ†å‘æŒ¥æœåŠ¡å™¨çš„æ¥å…¥èƒ½åŠ›ï¼Œå……åˆ†åˆ©ç”¨å¸¦å®½ä¸ç½‘å¡èµ„æºã€‚è¿œç¨‹è§£å¯†æœåŠ¡å™¨å¯ä»¥é€‰æ‹© CPU è´Ÿè½½è¾ƒä½çš„æœºå™¨å……å½“ï¼Œå®ç°æœºå™¨èµ„æºå¤ç”¨ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸“é—¨ä¼˜åŒ–çš„é«˜è®¡ç®—æ€§èƒ½çš„æœåŠ¡å™¨ã€‚å½“å‰ä¹Ÿæ˜¯ CDN ç”¨äºå¤§è§„æ¨¡HTTPSæ¥å…¥çš„è§£å†³æ–¹æ¡ˆä¹‹ä¸€ã€‚\nSPDY/HTTP2 å‰é¢çš„æ–¹æ³•åˆ†åˆ«ä»å‡å°‘ä¼ è¾“å»¶æ—¶å’Œå•æœºè´Ÿè½½çš„æ–¹æ³•æé«˜ HTTPS æ¥å…¥æ€§èƒ½ï¼Œä½†æ˜¯æ–¹æ³•éƒ½åŸºäºä¸æ”¹å˜ HTTP åè®®çš„åŸºç¡€ä¸Šæå‡ºçš„ä¼˜åŒ–æ–¹æ³•ï¼ŒSPDY/HTTP2 åˆ©ç”¨ TLS/SSL å¸¦æ¥çš„ä¼˜åŠ¿ï¼Œé€šè¿‡ä¿®æ”¹åè®®çš„æ–¹æ³•æ¥æå‡ HTTPS çš„æ€§èƒ½ï¼Œæé«˜ä¸‹è½½é€Ÿåº¦ç­‰ã€‚\nè½®è¯¢ çŸ­è½®è¯¢ çŸ­è½®è¯¢çš„åŸºæœ¬æ€è·¯:\næµè§ˆå™¨æ¯éš”ä¸€æ®µæ—¶é—´å‘æµè§ˆå™¨å‘é€ HTTP è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯åœ¨æ”¶åˆ°è¯·æ±‚åï¼Œä¸è®ºæ˜¯å¦æœ‰æ•°æ®æ›´æ–°ï¼Œéƒ½ç›´æ¥è¿›è¡Œ å“åº” ã€‚ è¿™ç§æ–¹å¼å®ç°çš„å³æ—¶é€šä¿¡ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯æµè§ˆå™¨å‘é€è¯·æ±‚ï¼ŒæœåŠ¡å™¨æ¥å—è¯·æ±‚çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œé€šè¿‡è®©å®¢æˆ·ç«¯ä¸æ–­çš„è¿›è¡Œè¯·æ±‚ï¼Œä½¿å¾—å®¢æˆ·ç«¯èƒ½å¤Ÿæ¨¡æ‹Ÿå®æ—¶åœ°æ”¶åˆ°æœåŠ¡å™¨ç«¯çš„æ•°æ®çš„å˜åŒ–ã€‚ â˜•ï¸ ProsProsPros \u0026amp; ConsConsCons\nä¼˜ç‚¹æ˜¯æ¯”è¾ƒç®€å•ï¼Œæ˜“äºç†è§£ã€‚\nç¼ºç‚¹æ˜¯è¿™ç§æ–¹å¼ç”±äºéœ€è¦ä¸æ–­çš„å»ºç«‹ HTTP è¿æ¥ï¼Œä¸¥é‡æµªè´¹äº†æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯çš„èµ„æºã€‚å½“ç”¨æˆ·å¢åŠ æ—¶ï¼ŒæœåŠ¡å™¨ç«¯çš„å‹åŠ›å°±ä¼šå˜å¤§ï¼Œè¿™æ˜¯å¾ˆä¸åˆç†çš„ã€‚\né•¿è½®è¯¢ é•¿è½®è¯¢çš„åŸºæœ¬æ€è·¯:\né¦–å…ˆç”±å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œå½“æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚åï¼ŒæœåŠ¡å™¨ç«¯ä¸ä¼šç›´æ¥è¿›è¡Œå“åº”ï¼Œè€Œæ˜¯å…ˆå°†è¿™ä¸ªè¯·æ±‚ æŒ‚èµ· ï¼Œç„¶ååˆ¤æ–­æœåŠ¡å™¨ç«¯æ•°æ®æ˜¯å¦æœ‰æ›´æ–°ã€‚\nå¦‚æœæœ‰æ›´æ–°ï¼Œåˆ™è¿›è¡Œå“åº”ï¼Œå¦‚æœä¸€ç›´æ²¡æœ‰æ•°æ®ï¼Œåˆ™åˆ°è¾¾ä¸€å®šçš„æ—¶é—´é™åˆ¶æ‰è¿”å›ã€‚å®¢æˆ·ç«¯ JavaScript å“åº”å¤„ç†å‡½æ•°ä¼šåœ¨å¤„ç†å®ŒæœåŠ¡å™¨è¿”å›çš„ä¿¡æ¯åï¼Œå†æ¬¡å‘å‡ºè¯·æ±‚ï¼Œé‡æ–°å»ºç«‹è¿æ¥ã€‚\nâ˜•ï¸ ProsProsPros \u0026amp; ConsConsCons\né•¿è½®è¯¢å’ŒçŸ­è½®è¯¢æ¯”èµ·æ¥ï¼Œå®ƒçš„ä¼˜ç‚¹æ˜¯æ˜æ˜¾å‡å°‘äº†å¾ˆå¤šä¸å¿…è¦çš„ HTTP è¯·æ±‚æ¬¡æ•° ï¼Œç›¸æ¯”ä¹‹ä¸‹èŠ‚çº¦äº†èµ„æºã€‚\né•¿è½®è¯¢çš„ç¼ºç‚¹åœ¨äºï¼Œè¿æ¥æŒ‚èµ·ä¹Ÿä¼šå¯¼è‡´èµ„æºçš„æµªè´¹ã€‚\nğŸ—‘ Depreciated è½®è¯¢ ç°å·²è¢« WebSocket æ·˜æ±°ã€‚\nDNS DNS åè®®æä¾›çš„æ˜¯ä¸€ç§ä¸»æœºååˆ° IP åœ°å€çš„è½¬æ¢æœåŠ¡ï¼Œå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„åŸŸåç³»ç»Ÿã€‚æ˜¯åº”ç”¨å±‚åè®®ï¼Œé€šå¸¸è¯¥åè®®è¿è¡Œåœ¨ [UDP] ä¹‹ä¸Šï¼Œä½¿ç”¨çš„ç«¯å£å·æ˜¯ [53] ã€‚\næœ¬åœ° DNS æœåŠ¡å™¨å‘å…¶ä»–åŸŸåæœåŠ¡å™¨è¯·æ±‚çš„è¿‡ç¨‹æ˜¯ è¿­ä»£æŸ¥è¯¢ çš„è¿‡ç¨‹ã€‚\né€’å½’æŸ¥è¯¢ \u0026amp; è¿­ä»£æŸ¥è¯¢ é€’å½’æŸ¥è¯¢\næŒ‡çš„æ˜¯æŸ¥è¯¢è¯·æ±‚å‘å‡ºåï¼ŒåŸŸåæœåŠ¡å™¨ä»£ä¸ºå‘ä¸‹ä¸€çº§åŸŸåæœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œæœ€åå‘ç”¨æˆ·è¿”å›æŸ¥è¯¢çš„æœ€ç»ˆç»“æœã€‚ä½¿ç”¨é€’å½’ æŸ¥è¯¢ï¼Œç”¨æˆ·åªéœ€è¦å‘å‡ºä¸€æ¬¡æŸ¥è¯¢è¯·æ±‚ã€‚\nè¿­ä»£æŸ¥è¯¢\næŒ‡çš„æ˜¯æŸ¥è¯¢è¯·æ±‚åï¼ŒåŸŸåæœåŠ¡å™¨è¿”å›å•æ¬¡æŸ¥è¯¢çš„ç»“æœã€‚ä¸‹ä¸€çº§çš„æŸ¥è¯¢ç”±ç”¨æˆ·è‡ªå·±è¯·æ±‚ã€‚ä½¿ç”¨è¿­ä»£æŸ¥è¯¢ï¼Œç”¨æˆ·éœ€è¦å‘å‡º å¤šæ¬¡çš„æŸ¥è¯¢è¯·æ±‚ã€‚\næ‰€ä»¥ä¸€èˆ¬è€Œè¨€ï¼Œ [æœ¬åœ°æœåŠ¡å™¨æŸ¥è¯¢æ˜¯é€’å½’æŸ¥è¯¢] ï¼Œè€Œ [æœ¬åœ° DNS æœåŠ¡å™¨å‘å…¶ä»–åŸŸåæœåŠ¡å™¨è¯·æ±‚çš„è¿‡ç¨‹æ˜¯è¿­ä»£æŸ¥è¯¢çš„è¿‡ç¨‹] ã€‚\nDNSç¼“å­˜ ç¼“å­˜ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œåœ¨ä¸€ä¸ªè¯·æ±‚ä¸­ï¼Œå½“æŸä¸ªDNSæœåŠ¡å™¨æ”¶åˆ°ä¸€ä¸ªDNSå›ç­”åï¼Œå®ƒèƒ½å¤Ÿå›ç­”ä¸­çš„ä¿¡æ¯ç¼“å­˜åœ¨æœ¬åœ°å­˜å‚¨å™¨ä¸­ã€‚ [è¿”å›çš„èµ„æºè®°å½•ä¸­çš„ TTL ä»£è¡¨äº†è¯¥æ¡è®°å½•çš„ç¼“å­˜çš„æ—¶é—´ã€‚]\nDNSå®ç°è´Ÿè½½å¹³è¡¡ å®ƒæ˜¯å¦‚ä½•å®ç°è´Ÿè½½å‡è¡¡çš„å‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬å¾—æ¸…æ¥šDNS æ˜¯å¯ä»¥ç”¨äºåœ¨å†—ä½™çš„æœåŠ¡å™¨ä¸Šå®ç°è´Ÿè½½å¹³è¡¡ã€‚\n**åŸå› ï¼š**è¿™æ˜¯å› ä¸ºä¸€èˆ¬çš„å¤§å‹ç½‘ç«™ä½¿ç”¨å¤šå°æœåŠ¡å™¨æä¾›æœåŠ¡ï¼Œå› æ­¤ä¸€ä¸ªåŸŸåå¯èƒ½ä¼šå¯¹åº” å¤šä¸ªæœåŠ¡å™¨åœ°å€ã€‚\nä¸¾ä¸ªä¾‹å­æ¥è¯´ğŸ‘‡\nå½“ç”¨æˆ·å‘èµ·ç½‘ç«™åŸŸåçš„ DNS è¯·æ±‚çš„æ—¶å€™ï¼ŒDNS æœåŠ¡å™¨è¿”å›è¿™ä¸ªåŸŸåæ‰€å¯¹åº”çš„æœåŠ¡å™¨ IP åœ°å€çš„é›†åˆ åœ¨æ¯ä¸ªå›ç­”ä¸­ï¼Œä¼šå¾ªç¯è¿™äº› IP åœ°å€çš„é¡ºåºï¼Œç”¨æˆ·ä¸€èˆ¬ä¼šé€‰æ‹©æ’åœ¨å‰é¢çš„åœ°å€å‘é€è¯·æ±‚ã€‚ ä»¥æ­¤å°†ç”¨æˆ·çš„è¯·æ±‚å‡è¡¡çš„åˆ†é…åˆ°å„ä¸ªä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·æ¥å®ç°è´Ÿè½½å‡è¡¡ã€‚ æ€»ç»“ DNSåŸŸåç³»ç»Ÿï¼Œæ˜¯åº”ç”¨å±‚åè®®ï¼Œè¿è¡ŒUDPåè®®ä¹‹ä¸Šï¼Œä½¿ç”¨ç«¯å£43ã€‚ æŸ¥è¯¢è¿‡ç¨‹ï¼Œæœ¬åœ°æŸ¥è¯¢æ˜¯é€’å½’æŸ¥è¯¢ï¼Œä¾æ¬¡é€šè¿‡æµè§ˆå™¨ç¼“å­˜ â€”\u0026gt;\u0026gt; æœ¬åœ°hostsæ–‡ä»¶ â€”\u0026gt;\u0026gt; æœ¬åœ°DNSè§£æå™¨ â€”\u0026gt;\u0026gt;æœ¬åœ°DNSæœåŠ¡å™¨ â€”\u0026gt;\u0026gt; å…¶ä»–åŸŸåæœåŠ¡å™¨è¯·æ±‚ã€‚ æ¥ä¸‹æ¥çš„è¿‡ç¨‹å°±æ˜¯è¿­ä»£è¿‡ç¨‹ã€‚ é€’å½’æŸ¥è¯¢ä¸€èˆ¬è€Œè¨€ï¼Œå‘é€ä¸€æ¬¡è¯·æ±‚å°±å¤Ÿï¼Œè¿­ä»£è¿‡ç¨‹éœ€è¦ç”¨æˆ·å‘é€å¤šæ¬¡è¯·æ±‚ã€‚ ğŸ’¡ Trick DNS ä¸ºä»€ä¹ˆä½¿ç”¨ UDP åè®®ä½œä¸ºä¼ è¾“å±‚åè®®ï¼Ÿ\nA: DNS ä½¿ç”¨ UDP åè®®ä½œä¸ºä¼ è¾“å±‚åè®®çš„ä¸»è¦åŸå› æ˜¯ä¸ºäº†é¿å…ä½¿ç”¨ TCP åè®®æ—¶é€ æˆçš„è¿æ¥æ—¶å»¶ã€‚\nä¸ºäº†å¾—åˆ°ä¸€ä¸ªåŸŸåçš„ IP åœ°å€ï¼Œå¾€å¾€ä¼šå‘å¤šä¸ªåŸŸåæœåŠ¡å™¨æŸ¥è¯¢ï¼Œå¦‚æœä½¿ç”¨ TCP åè®®ï¼Œé‚£ä¹ˆæ¯æ¬¡è¯·æ±‚éƒ½ä¼šå­˜åœ¨è¿æ¥æ—¶å»¶ï¼Œè¿™æ ·ä½¿ DNS æœåŠ¡å˜å¾—å¾ˆæ…¢ã€‚ å¤§å¤šæ•°çš„åœ°å€æŸ¥è¯¢è¯·æ±‚ï¼Œéƒ½æ˜¯æµè§ˆå™¨è¯·æ±‚é¡µé¢æ—¶å‘å‡ºçš„ï¼Œè¿™æ ·ä¼šé€ æˆç½‘é¡µçš„ç­‰å¾…æ—¶é—´è¿‡é•¿ã€‚ ä»£ç† æ­£å‘ä»£ç† æˆ‘ä»¬å¸¸è¯´çš„ä»£ç†ä¹Ÿå°±æ˜¯æŒ‡æ­£å‘ä»£ç†ï¼Œæ­£å‘ä»£ç†çš„è¿‡ç¨‹ï¼Œå®ƒéšè—äº†çœŸå®çš„è¯·æ±‚å®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯ä¸çŸ¥é“çœŸå®çš„å®¢æˆ·ç«¯æ˜¯è°ï¼Œå®¢æˆ·ç«¯è¯·æ±‚çš„æœåŠ¡éƒ½è¢«ä»£ç†æœåŠ¡å™¨ä»£æ›¿æ¥è¯·æ±‚ã€‚\nåå‘ä»£ç† è¿™ç§ä»£ç†æ¨¡å¼ä¸‹ï¼Œå®ƒéšè—äº†çœŸå®çš„æœåŠ¡ç«¯ï¼Œå½“æˆ‘ä»¬å‘ä¸€ä¸ªç½‘ç«™å‘èµ·è¯·æ±‚çš„æ—¶å€™ï¼ŒèƒŒåå¯èƒ½æœ‰æˆåƒä¸Šä¸‡å°æœåŠ¡å™¨ä¸ºæˆ‘ä»¬æœåŠ¡ï¼Œå…·ä½“æ˜¯å“ªä¸€å°ï¼Œæˆ‘ä»¬ä¸æ¸…æ¥šï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“åå‘ä»£ç†æœåŠ¡å™¨æ˜¯è°å°±è¡Œï¼Œè€Œä¸”åå‘ä»£ç†æœåŠ¡å™¨ä¼šå¸®æˆ‘ä»¬æŠŠè¯·æ±‚è½¬å‘åˆ°çœŸå®çš„æœåŠ¡å™¨é‚£é‡Œå»ï¼Œä¸€èˆ¬è€Œè¨€åå‘ä»£ç†æœåŠ¡å™¨ä¸€èˆ¬ç”¨æ¥å®ç° è´Ÿè½½å¹³è¡¡ ã€‚\nè´Ÿè½½å¹³è¡¡ ä¸€ç§æ˜¯ä½¿ç”¨ åå‘ä»£ç† çš„æ–¹å¼ï¼Œç”¨æˆ·çš„è¯·æ±‚éƒ½å‘é€åˆ°åå‘ä»£ç†æœåŠ¡ä¸Šï¼Œç„¶åç”±åå‘ä»£ç†æœåŠ¡å™¨æ¥è½¬å‘è¯·æ±‚åˆ°çœŸå®çš„æœåŠ¡å™¨ä¸Šï¼Œä»¥æ­¤æ¥å®ç°é›†ç¾¤çš„è´Ÿè½½å¹³è¡¡ã€‚\nå¦ä¸€ç§æ˜¯ DNS çš„æ–¹å¼ï¼ŒDNS å¯ä»¥ç”¨äºåœ¨å†—ä½™çš„æœåŠ¡å™¨ä¸Šå®ç°è´Ÿè½½å¹³è¡¡ã€‚å› ä¸ºç°åœ¨ä¸€èˆ¬çš„å¤§å‹ç½‘ç«™ä½¿ç”¨å¤šå°æœåŠ¡å™¨æä¾›æœåŠ¡ï¼Œå› æ­¤ä¸€ä¸ªåŸŸåå¯èƒ½ä¼šå¯¹åº”å¤šä¸ªæœåŠ¡å™¨åœ°å€ã€‚å½“ç”¨æˆ·å‘ç½‘ç«™åŸŸåè¯·æ±‚çš„æ—¶å€™ï¼ŒDNS æœåŠ¡å™¨è¿”å›è¿™ä¸ªåŸŸåæ‰€å¯¹åº”çš„æœåŠ¡å™¨ IP åœ°å€çš„é›†åˆï¼Œä½†åœ¨æ¯ä¸ªå›ç­”ä¸­ï¼Œä¼šå¾ªç¯è¿™äº› IP åœ°å€çš„é¡ºåºï¼Œç”¨æˆ·ä¸€èˆ¬ä¼šé€‰æ‹©æ’åœ¨å‰é¢çš„åœ°å€å‘é€è¯·æ±‚ã€‚ä»¥æ­¤å°†ç”¨æˆ·çš„è¯·æ±‚å‡è¡¡çš„åˆ†é…åˆ°å„ä¸ªä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·æ¥å®ç°è´Ÿè½½å‡è¡¡ã€‚è¿™ç§æ–¹å¼æœ‰ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯ï¼Œç”±äº DNS æœåŠ¡å™¨ä¸­å­˜åœ¨ç¼“å­˜ï¼Œæ‰€ä»¥æœ‰å¯èƒ½ä¸€ä¸ªæœåŠ¡å™¨å‡ºç°æ•…éšœåï¼ŒåŸŸåè§£æä»ç„¶è¿”å›çš„æ˜¯é‚£ä¸ª IP åœ°å€ï¼Œå°±ä¼šé€ æˆè®¿é—®çš„é—®é¢˜ã€‚\nAJAX AJAX - Asynchronous JavaScript And XML^å¼‚æ­¥JSå’ŒXML^\né€šè¿‡ AJAX å¯ä»¥åœ¨æµè§ˆå™¨ä¸­å‘æœåŠ¡å™¨å‘é€å¼‚æ­¥è¯·æ±‚ï¼Œæœ€å¤§çš„ä¼˜åŠ¿æ˜¯ æ— åˆ·æ–°è·å–æ•°æ® ã€‚AJAX ä¸æ˜¯æ–°çš„ç¼–ç¨‹è¯­è¨€ï¼Œè€Œæ˜¯ä¸€ç§å°†ç°æœ‰çš„æ ‡å‡†ç»„åˆåœ¨ä¸€èµ·ä½¿ç”¨çš„æ–°æ–¹å¼ã€‚\nâ—ï¸ Warning AJAX åªèƒ½å‘åŒæºç½‘å€ï¼ˆåè®®ã€åŸŸåã€ç«¯å£éƒ½ç›¸åŒï¼‰å‘å‡º HTTP è¯·æ±‚ï¼Œå¦‚æœå‘å‡ºè·¨åŸŸè¯·æ±‚ï¼Œå°±ä¼šæŠ¥é”™\n:memo: Note\nAJAX çš„ä¼˜ç‚¹\nå¯ä»¥æ— éœ€åˆ·æ–°é¡µé¢è€Œä¸æœåŠ¡å™¨ç«¯è¿›è¡Œé€šä¿¡ å…è®¸ä½ æ ¹æ®ç”¨æˆ·äº‹ä»¶æ¥æ›´æ–°éƒ¨åˆ†é¡µé¢å†…å®¹ AJAX çš„ç¼ºç‚¹\næ²¡æœ‰æµè§ˆå†å²ï¼Œä¸èƒ½å›é€€ å­˜åœ¨è·¨åŸŸé—®é¢˜ï¼ˆåŒæºï¼‰ SEO ä¸å‹å¥½ XML XML - Extensible Markup Language å¯æ‰©å±•æ ‡è®°è¯­è¨€ XML è¢«è®¾è®¡ç”¨æ¥ ä¼ è¾“ å’Œ å­˜å‚¨ æ•°æ® XML å’Œ HTML ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯ HTML ä¸­éƒ½æ˜¯é¢„å®šä¹‰æ ‡ç­¾ï¼Œè€Œ XML ä¸­æ²¡æœ‰é¢„å®šä¹‰æ ‡ç­¾ï¼Œ å…¨éƒ½æ˜¯è‡ªå®šä¹‰æ ‡ç­¾ï¼Œç”¨æ¥è¡¨ç¤ºä¸€äº›æ•°æ® :page_with_curl: Example\næ¯”å¦‚è¯´æˆ‘æœ‰ä¸€ä¸ªå­¦ç”Ÿæ•°æ®ï¼š\nname = \u0026#34;å­™æ‚Ÿç©º\u0026#34; ; age = 18 ; gender = \u0026#34;ç”·\u0026#34; ; ç”¨ XML è¡¨ç¤ºï¼š\n\u0026lt;student\u0026gt; \u0026lt;name\u0026gt;å­™æ‚Ÿç©º\u0026lt;/name\u0026gt; \u0026lt;age\u0026gt;18\u0026lt;/age\u0026gt; \u0026lt;gender\u0026gt;ç”·\u0026lt;/gender\u0026gt; \u0026lt;/student\u0026gt; ç°åœ¨å·²ç»è¢« JSON æ‰€å–ä»£ï¼š\n{\u0026#34;name\u0026#34;:\u0026#34;å­™æ‚Ÿç©º\u0026#34;,\u0026#34;age\u0026#34;:18,\u0026#34;gender\u0026#34;:\u0026#34;ç”·\u0026#34;} XMLHttpRequest AJAX çš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯é€šè¿‡ XMLHTTPRequest è¿›è¡Œçš„ã€‚è¯¥å¯¹è±¡æ˜¯ AJAX çš„ä¸»è¦æ¥å£ï¼Œç”¨äºæµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ã€‚å°½ç®¡åå­—é‡Œé¢æœ‰ XML å’Œ Http ï¼Œä½†å®ƒå®é™…ä¸Šå¯ä»¥ä½¿ç”¨å¤šç§åè®®ï¼ˆæ¯”å¦‚ file æˆ– ftp ï¼‰ï¼Œå‘é€ä»»ä½•æ ¼å¼çš„æ•°æ®ï¼ˆåŒ…æ‹¬å­—ç¬¦ä¸²å’ŒäºŒè¿›åˆ¶ï¼‰\nå½“å‰ç«¯æƒ³è®¾ç½®è‡ªå®šä¹‰çš„ è¯·æ±‚å¤´ çš„æ—¶å€™ï¼Œéœ€è¦åœ¨åç«¯è®¾ç½® å“åº”å¤´ ã€‚\n//è¡¨ç¤ºæ¥æ”¶ä»»æ„ç±»å‹çš„è¯·æ±‚\tapp.all(\u0026#34;/server\u0026#34;, (request, response) =\u0026gt; { //å“åº”å¤´ å…è®¸è·¨åŸŸè¿è¡Œè‡ªå®šä¹‰å“åº”å¤´ response.setHeader(\u0026#34;Access-Control-Allow-Origin\u0026#34;, \u0026#34;*\u0026#34;); response.setHeader(\u0026#34;Access-Control-Allow-Headers\u0026#34;, \u0026#34;*\u0026#34;); }); :memo: Note AJAX XMLHTTPRequest.readyState\nThe XMLHTTPRequest.readyState property returns the state an XMLHTTPRequest client is in. An XHR client exists in one of the following states:\nValue State Description 0 UNSENT Client has been created. open() not called yet. 1 OPENED open() has been called. 2 HEADERS_RECEIVED send() has been called, and headers and status are available. 3 LOADING Downloading; responseText holds partial data. 4 DONE The operation is complete. åˆå§‹åŒ– XMLHttpRequest æœ¬èº«æ˜¯ä¸€ä¸ª æ„é€ å‡½æ•°^constructor^ ï¼Œå¯ä»¥ä½¿ç”¨ new å‘½ä»¤ç”Ÿæˆå®ä¾‹ã€‚å®ƒæ²¡æœ‰ä»»ä½•å‚æ•°ã€‚\nç„¶åï¼Œåœ¨ onreadystatechange æŒ‡å®šå›è°ƒå‡½æ•°ï¼Œç›‘å¬é€šä¿¡çŠ¶æ€ï¼ˆreadyStateå±æ€§ï¼‰çš„å˜åŒ–ã€‚\n// 1. é€šè¿‡åŸç”Ÿå¯¹è±¡åˆ›å»º XMLHTTPRequest å¯¹è±¡ const xhr = new XMLHTTPRequest(); // 2. è®¾ç½®è¯·æ±‚ä¿¡æ¯ xhr.open(\u0026#34;method\u0026#34;, \u0026#34;url\u0026#34;, \u0026#34;async\u0026#34;); /* å¯ä»¥è®¾ç½®è¯·æ±‚å¤´ï¼Œä¸€èˆ¬ä¸è®¾ç½® */ xhr.setRequestHeader(\u0026#34;Content-Type\u0026#34;, \u0026#34;application/x-www-form-urlencoded\u0026#34;); // 3. å‘é€è¯·æ±‚ xhr.send(\u0026#34;body\u0026#34;) //get è¯·æ±‚ä¸ä¼  body å‚æ•°ï¼Œåªæœ‰ post è¯·æ±‚ä½¿ç”¨ // 4. æ¥æ”¶å“åº” /* xhr.responseXML æ¥æ”¶ xml æ ¼å¼çš„å“åº”æ•°æ® */ /* xhr.responseText æ¥æ”¶æ–‡æœ¬æ ¼å¼çš„å“åº”æ•°æ® */ xhr.onreadystatechange = () =\u0026gt; { if (xhr.readyState === 4 \u0026amp;\u0026amp; xhr.status === 200) { const text = xhr.responseText; console.log(text); } } :memo: Note open() å’Œ send() æ–¹æ³•\n// xhr.open() XMLHTTPRequest.open( method: string, url: string | URL, async: boolean, username?: string | null, password?: string | null ): void // xhr.send() XMLHTTPRequest.send( body?: Document | XMLHTTPRequestBodyInit | null ): void æ–¹æ³• æè¿° open() è§„å®šè¯·æ±‚çš„ç±»å‹ã€URL ä»¥åŠæ˜¯å¦å¼‚æ­¥å¤„ç†è¯·æ±‚ã€‚\nmethodï¼šè¯·æ±‚çš„ç±»å‹ï¼›GET æˆ– POST\nurlï¼šæ–‡ä»¶åœ¨æœåŠ¡å™¨ä¸Šçš„ä½ç½®\nasyncï¼štrueï¼ˆå¼‚æ­¥ï¼‰æˆ– falseï¼ˆåŒæ­¥ï¼‰ send() å°†è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ã€‚\nstringï¼šä»…ç”¨äº POST è¯·æ±‚ Get //ç»‘å®šäº‹ä»¶ let btn = document.getElementById(\u0026#34;button\u0026#34;); let result = document.getElementById(\u0026#34;result\u0026#34;); btn.onclick = function () { // 1. åˆ›å»ºå¯¹è±¡ const xhr = new XMLHTTPRequest(); // 2. åˆå§‹åŒ– è®¾ç½®è¯·æ±‚æ–¹æ³•å’Œ url xhr.open(\u0026#34;GET\u0026#34;, \u0026#34;HTTP://127.0.0.1:8000/server?a=100\u0026amp;b=200\u0026amp;c=300\u0026#34;); // 3. å‘é€ xhr.send(); // 4. äº‹ä»¶ç»‘å®š å¤„ç†æœåŠ¡ç«¯è¿”å›çš„ç»“æœ /*on when å½“....æ—¶å€™ * readystate æ˜¯ xhr å¯¹è±¡ä¸­çš„å±æ€§, è¡¨ç¤ºçŠ¶æ€ 0 1 2 3 4 * change æ”¹å˜*/ xhr.onreadystatechange = function () { //åˆ¤æ–­ (æœåŠ¡ç«¯è¿”å›äº†æ‰€æœ‰çš„ç»“æœ) if (xhr.readyState === 4) { /*åˆ¤æ–­HTTPå“åº”çŠ¶æ€ç  200 404 403 401 500*/ /*2xx æˆåŠŸ*/ if (xhr.status \u0026gt;= 200 \u0026amp;\u0026amp; xhr.status \u0026lt; 300) { /*å¤„ç†ç»“æœ è¡Œ å¤´ ç©ºè¡Œ ä½“ * å“åº” * console.log(xhr.status); -\u0026gt; çŠ¶æ€ç  * console.log(xhr.statusText); -\u0026gt; çŠ¶æ€å­—ç¬¦ä¸² * console.log(xhr.getAllResponseHeaders()); -\u0026gt; æ‰€æœ‰å“åº”å¤´ * console.log(xhr.response); -\u0026gt; å“åº”ä½“ */ /*è®¾ç½® result çš„æ–‡æœ¬*/ result.innerHTML = xhr.response; } else { /*è¯·æ±‚å¤±è´¥å¤„ç†*/ } } } } Post // ç»‘å®šäº‹ä»¶ let btn = document.getElementById(\u0026#34;button\u0026#34;); let result = document.getElementById(\u0026#34;result\u0026#34;); btn.addEventListener(\u0026#34;click\u0026#34;, function () { // 1. åˆ›å»ºå¯¹è±¡ const xhr = new XMLHTTPRequest(); // 2. åˆå§‹åŒ– è®¾ç½®ç±»å‹ä¸ URL xhr.open(\u0026#34;POST\u0026#34;, \u0026#34;HTTP://127.0.0.1:8000/server\u0026#34;); /* è®¾ç½®è¯·æ±‚å¤´ */ xhr.setRequestHeader(\u0026#34;Content-Type\u0026#34;, \u0026#34;application/x-www-form-urlencoded\u0026#34;); // 3. å‘é€ xhr.send(\u0026#34;a=100\u0026amp;b=200\u0026amp;c=300\u0026#34;); // 4. äº‹ä»¶ç»‘å®š xhr.onreadystatechange = function () { /*åˆ¤æ–­*/ if (xhr.readyState === 4) { if (xhr.status \u0026gt;= 200 \u0026amp;\u0026amp; xhr.status \u0026lt; 300) { /*å¤„ç†æœåŠ¡ç«¯è¿”å›çš„ç»“æœ*/ result.innerHTML = xhr.response; } else { /*è¯·æ±‚å¤±è´¥å¤„ç†*/ } } } }); å±æ€§ readyState XMLHttpRequest.readyState è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºå®ä¾‹å¯¹è±¡çš„å½“å‰çŠ¶æ€ã€‚è¯¥å±æ€§åªè¯»ã€‚å®ƒå¯èƒ½è¿”å›ä»¥ä¸‹å€¼ã€‚\n0ï¼Œè¡¨ç¤º XMLHttpRequest å®ä¾‹å·²ç»ç”Ÿæˆï¼Œä½†æ˜¯å®ä¾‹çš„open()æ–¹æ³•è¿˜æ²¡æœ‰è¢«è°ƒç”¨ã€‚ 1ï¼Œè¡¨ç¤ºopen()æ–¹æ³•å·²ç»è°ƒç”¨ï¼Œä½†æ˜¯å®ä¾‹çš„send()æ–¹æ³•è¿˜æ²¡æœ‰è°ƒç”¨ï¼Œä»ç„¶å¯ä»¥ä½¿ç”¨å®ä¾‹çš„setRequestHeader()æ–¹æ³•ï¼Œè®¾å®š HTTP è¯·æ±‚çš„å¤´ä¿¡æ¯ã€‚ 2ï¼Œè¡¨ç¤ºå®ä¾‹çš„send()æ–¹æ³•å·²ç»è°ƒç”¨ï¼Œå¹¶ä¸”æœåŠ¡å™¨è¿”å›çš„å¤´ä¿¡æ¯å’ŒçŠ¶æ€ç å·²ç»æ”¶åˆ°ã€‚ 3ï¼Œè¡¨ç¤ºæ­£åœ¨æ¥æ”¶æœåŠ¡å™¨ä¼ æ¥çš„æ•°æ®ä½“ï¼ˆbody éƒ¨åˆ†ï¼‰ã€‚è¿™æ—¶ï¼Œå¦‚æœå®ä¾‹çš„responseTypeå±æ€§ç­‰äºtextæˆ–è€…ç©ºå­—ç¬¦ä¸²ï¼ŒresponseTextå±æ€§å°±ä¼šåŒ…å«å·²ç»æ”¶åˆ°çš„éƒ¨åˆ†ä¿¡æ¯ã€‚ 4ï¼Œè¡¨ç¤ºæœåŠ¡å™¨è¿”å›çš„æ•°æ®å·²ç»å®Œå…¨æ¥æ”¶ï¼Œæˆ–è€…æœ¬æ¬¡æ¥æ”¶å·²ç»å¤±è´¥ã€‚ é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œæ¯å½“å®ä¾‹å¯¹è±¡å‘ç”ŸçŠ¶æ€å˜åŒ–ï¼Œå®ƒçš„readyStateå±æ€§çš„å€¼å°±ä¼šæ”¹å˜ã€‚è¿™ä¸ªå€¼æ¯ä¸€æ¬¡å˜åŒ–ï¼Œéƒ½ä¼šè§¦å‘readyStateChangeäº‹ä»¶ã€‚\nlet xhr = new XMLHttpRequest(); if (xhr.readyState === 4) { // è¯·æ±‚ç»“æŸï¼Œå¤„ç†æœåŠ¡å™¨è¿”å›çš„æ•°æ® } else { // æ˜¾ç¤ºæç¤ºâ€œåŠ è½½ä¸­â€¦â€¦â€ } ä¸Šé¢ä»£ç ä¸­ï¼Œxhr.readyStateç­‰äº4æ—¶ï¼Œè¡¨æ˜è„šæœ¬å‘å‡ºçš„ HTTP è¯·æ±‚å·²ç»å®Œæˆã€‚å…¶ä»–æƒ…å†µï¼Œéƒ½è¡¨ç¤º HTTP è¯·æ±‚è¿˜åœ¨è¿›è¡Œä¸­ã€‚\nonreadystatechange XMLHttpRequest.onreadystatechangeå±æ€§æŒ‡å‘ä¸€ä¸ªç›‘å¬å‡½æ•°ã€‚readystatechangeäº‹ä»¶å‘ç”Ÿæ—¶ï¼ˆå®ä¾‹çš„readyStateå±æ€§å˜åŒ–ï¼‰ï¼Œå°±ä¼šæ‰§è¡Œè¿™ä¸ªå±æ€§ã€‚\nå¦å¤–ï¼Œå¦‚æœä½¿ç”¨å®ä¾‹çš„abort()æ–¹æ³•ï¼Œç»ˆæ­¢ XMLHttpRequest è¯·æ±‚ï¼Œä¹Ÿä¼šé€ æˆreadyStateå±æ€§å˜åŒ–ï¼Œå¯¼è‡´è°ƒç”¨XMLHttpRequest.onreadystatechangeå±æ€§ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚\nlet xhr = new XMLHttpRequest(); xhr.open( \u0026#39;GET\u0026#39;, \u0026#39;http://example.com\u0026#39; , true ); xhr.onreadystatechange = function () { if (xhr.readyState !== 4 || xhr.status !== 200) { return; } console.log(xhr.responseText); }; xhr.send(); response XMLHttpRequest.responseå±æ€§è¡¨ç¤ºæœåŠ¡å™¨è¿”å›çš„æ•°æ®ä½“ï¼ˆå³ HTTP å›åº”çš„ body éƒ¨åˆ†ï¼‰ã€‚å®ƒå¯èƒ½æ˜¯ä»»ä½•æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²ã€å¯¹è±¡ã€äºŒè¿›åˆ¶å¯¹è±¡ç­‰ç­‰ï¼Œå…·ä½“çš„ç±»å‹ç”±XMLHttpRequest.responseTypeå±æ€§å†³å®šã€‚XMLHttpRequest.responseå±æ€§æ˜¯åªè¯»çš„ã€‚\nå¦‚æœæœ¬æ¬¡è¯·æ±‚æ²¡æœ‰æˆåŠŸæˆ–è€…æ•°æ®ä¸å®Œæ•´ï¼Œè¯¥å±æ€§ç­‰äºnullã€‚ä½†æ˜¯ï¼Œå¦‚æœresponseTypeå±æ€§ç­‰äºtextæˆ–ç©ºå­—ç¬¦ä¸²ï¼Œåœ¨è¯·æ±‚æ²¡æœ‰ç»“æŸä¹‹å‰ï¼ˆreadyStateç­‰äº3çš„é˜¶æ®µï¼‰ï¼Œresponseå±æ€§åŒ…å«æœåŠ¡å™¨å·²ç»è¿”å›çš„éƒ¨åˆ†æ•°æ®ã€‚\nlet xhr = new XMLHttpRequest(); xhr.onreadystatechange = function () { if (xhr.readyState === 4) { handler(xhr.response); } } responseType XMLHttpRequest.responseTypeå±æ€§æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæœåŠ¡å™¨è¿”å›æ•°æ®çš„ç±»å‹ã€‚è¿™ä¸ªå±æ€§æ˜¯å¯å†™çš„ï¼Œå¯ä»¥åœ¨è°ƒç”¨open()æ–¹æ³•ä¹‹åã€è°ƒç”¨send()æ–¹æ³•ä¹‹å‰ï¼Œè®¾ç½®è¿™ä¸ªå±æ€§çš„å€¼ï¼Œå‘Šè¯‰æµè§ˆå™¨å¦‚ä½•è§£è¯»è¿”å›çš„æ•°æ®ã€‚å¦‚æœresponseTypeè®¾ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œå°±ç­‰åŒäºé»˜è®¤å€¼textã€‚\nXMLHttpRequest.responseTypeå±æ€§å¯ä»¥ç­‰äºä»¥ä¸‹å€¼ã€‚\n\u0026ldquo;\u0026quot;ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰ï¼šç­‰åŒäºtextï¼Œè¡¨ç¤ºæœåŠ¡å™¨è¿”å›æ–‡æœ¬æ•°æ®ã€‚ \u0026ldquo;arraybuffer\u0026rdquo;ï¼šArrayBuffer å¯¹è±¡ï¼Œè¡¨ç¤ºæœåŠ¡å™¨è¿”å›äºŒè¿›åˆ¶æ•°ç»„ã€‚ \u0026ldquo;blob\u0026rdquo;ï¼šBlob å¯¹è±¡ï¼Œè¡¨ç¤ºæœåŠ¡å™¨è¿”å›äºŒè¿›åˆ¶å¯¹è±¡ã€‚ \u0026ldquo;document\u0026rdquo;ï¼šDocument å¯¹è±¡ï¼Œè¡¨ç¤ºæœåŠ¡å™¨è¿”å›ä¸€ä¸ªæ–‡æ¡£å¯¹è±¡ã€‚ \u0026ldquo;json\u0026rdquo;ï¼šJSON å¯¹è±¡ã€‚ \u0026ldquo;text\u0026rdquo;ï¼šå­—ç¬¦ä¸²ã€‚ ä¸Šé¢å‡ ç§ç±»å‹ä¹‹ä¸­ï¼Œtextç±»å‹é€‚åˆå¤§å¤šæ•°æƒ…å†µï¼Œè€Œä¸”ç›´æ¥å¤„ç†æ–‡æœ¬ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ã€‚documentç±»å‹é€‚åˆè¿”å› HTML / XML æ–‡æ¡£çš„æƒ…å†µï¼Œè¿™æ„å‘³ç€ï¼Œå¯¹äºé‚£äº›æ‰“å¼€ CORS çš„ç½‘ç«™ï¼Œå¯ä»¥ç›´æ¥ç”¨ Ajax æŠ“å–ç½‘é¡µï¼Œç„¶åä¸ç”¨è§£æ HTML å­—ç¬¦ä¸²ï¼Œç›´æ¥å¯¹æŠ“å–å›æ¥çš„æ•°æ®è¿›è¡Œ DOM æ“ä½œã€‚blobç±»å‹é€‚åˆè¯»å–äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯”å¦‚å›¾ç‰‡æ–‡ä»¶ã€‚\nlet xhr = new XMLHttpRequest(); xhr.open(\u0026#39;GET\u0026#39;, \u0026#39;/path/to/image.png\u0026#39;, true); xhr.responseType = \u0026#39;blob\u0026#39;; xhr.onload = function(e) { if (this.status === 200) { let blob = new Blob([xhr.response], {type: \u0026#39;image/png\u0026#39;}); // æˆ–è€… let blob = xhr.response; } }; xhr.send(); å¦‚æœå°†è¿™ä¸ªå±æ€§è®¾ä¸ºArrayBufferï¼Œå°±å¯ä»¥æŒ‰ç…§æ•°ç»„çš„æ–¹å¼å¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚\nlet xhr = new XMLHttpRequest(); xhr.open(\u0026#39;GET\u0026#39;, \u0026#39;/path/to/image.png\u0026#39;, true); xhr.responseType = \u0026#39;arraybuffer\u0026#39;; xhr.onload = function(e) { let uInt8Array = new Uint8Array(this.response); for (let i = 0, len = uInt8Array.length; i \u0026lt; len; ++i) { // let byte = uInt8Array[i]; } }; xhr.send(); å¦‚æœå°†è¿™ä¸ªå±æ€§è®¾ä¸ºjsonï¼Œæµè§ˆå™¨å°±ä¼šè‡ªåŠ¨å¯¹è¿”å›æ•°æ®è°ƒç”¨JSON.parse()æ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»xhr.responseå±æ€§ï¼ˆæ³¨æ„ï¼Œä¸æ˜¯xhr.responseTextå±æ€§ï¼‰å¾—åˆ°çš„ä¸æ˜¯æ–‡æœ¬ï¼Œè€Œæ˜¯ä¸€ä¸ª JSON å¯¹è±¡ã€‚\nresponseText XMLHttpRequest.responseTextå±æ€§è¿”å›ä»æœåŠ¡å™¨æ¥æ”¶åˆ°çš„å­—ç¬¦ä¸²ï¼Œè¯¥å±æ€§ä¸ºåªè¯»ã€‚åªæœ‰ HTTP è¯·æ±‚å®Œæˆæ¥æ”¶ä»¥åï¼Œè¯¥å±æ€§æ‰ä¼šåŒ…å«å®Œæ•´çš„æ•°æ®ã€‚\nlet xhr = new XMLHttpRequest(); xhr.open(\u0026#39;GET\u0026#39;, \u0026#39;/server\u0026#39;, true); xhr.responseType = \u0026#39;text\u0026#39;; xhr.onload = function () { if (xhr.readyState === 4 \u0026amp;\u0026amp; xhr.status === 200) { console.log(xhr.responseText); } }; xhr.send(null); responseXML XMLHttpRequest.responseXMLå±æ€§è¿”å›ä»æœåŠ¡å™¨æ¥æ”¶åˆ°çš„ HTML æˆ– XML æ–‡æ¡£å¯¹è±¡ï¼Œè¯¥å±æ€§ä¸ºåªè¯»ã€‚å¦‚æœæœ¬æ¬¡è¯·æ±‚æ²¡æœ‰æˆåŠŸï¼Œæˆ–è€…æ”¶åˆ°çš„æ•°æ®ä¸èƒ½è¢«è§£æä¸º XML æˆ– HTMLï¼Œè¯¥å±æ€§ç­‰äºnullã€‚\nè¯¥å±æ€§ç”Ÿæ•ˆçš„å‰ææ˜¯ HTTP å›åº”çš„Content-Typeå¤´ä¿¡æ¯ç­‰äºtext/xmlæˆ–application/xmlã€‚è¿™è¦æ±‚åœ¨å‘é€è¯·æ±‚å‰ï¼ŒXMLHttpRequest.responseTypeå±æ€§è¦è®¾ä¸ºdocumentã€‚å¦‚æœ HTTP å›åº”çš„Content-Typeå¤´ä¿¡æ¯ä¸ç­‰äºtext/xmlå’Œapplication/xmlï¼Œä½†æ˜¯æƒ³ä»responseXMLæ‹¿åˆ°æ•°æ®ï¼ˆå³æŠŠæ•°æ®æŒ‰ç…§ DOM æ ¼å¼è§£æï¼‰ï¼Œé‚£ä¹ˆéœ€è¦æ‰‹åŠ¨è°ƒç”¨XMLHttpRequest.overrideMimeType()æ–¹æ³•ï¼Œå¼ºåˆ¶è¿›è¡Œ XML è§£æã€‚\nè¯¥å±æ€§å¾—åˆ°çš„æ•°æ®ï¼Œæ˜¯ç›´æ¥è§£æåçš„æ–‡æ¡£ DOM æ ‘ã€‚\nlet xhr = new XMLHttpRequest(); xhr.open(\u0026#39;GET\u0026#39;, \u0026#39;/server\u0026#39;, true); xhr.responseType = \u0026#39;document\u0026#39;; xhr.overrideMimeType(\u0026#39;text/xml\u0026#39;); xhr.onload = function () { if (xhr.readyState === 4 \u0026amp;\u0026amp; xhr.status === 200) { console.log(xhr.responseXML); } }; xhr.send(null); responseURL XMLHttpRequest.responseURLå±æ€§æ˜¯å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå‘é€æ•°æ®çš„æœåŠ¡å™¨çš„ç½‘å€ã€‚\nlet xhr = new XMLHttpRequest(); xhr.open(\u0026#39;GET\u0026#39;, \u0026#39;http://example.com/test\u0026#39;, true); xhr.onload = function () { // è¿”å› http://example.com/test console.log(xhr.responseURL); }; xhr.send(null); æ³¨æ„ï¼Œè¿™ä¸ªå±æ€§çš„å€¼ä¸open()æ–¹æ³•æŒ‡å®šçš„è¯·æ±‚ç½‘å€ä¸ä¸€å®šç›¸åŒã€‚å¦‚æœæœåŠ¡å™¨ç«¯å‘ç”Ÿè·³è½¬ï¼Œè¿™ä¸ªå±æ€§è¿”å›æœ€åå®é™…è¿”å›æ•°æ®çš„ç½‘å€ã€‚å¦å¤–ï¼Œå¦‚æœåŸå§‹ URL åŒ…æ‹¬é”šç‚¹ï¼ˆfragmentï¼‰ï¼Œè¯¥å±æ€§ä¼šæŠŠé”šç‚¹å‰¥ç¦»ã€‚\nstatus statusText XMLHttpRequest.statuså±æ€§è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å›åº”çš„ HTTP çŠ¶æ€ç ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœé€šä¿¡æˆåŠŸçš„è¯ï¼Œè¿™ä¸ªçŠ¶æ€ç æ˜¯200ï¼›å¦‚æœæœåŠ¡å™¨æ²¡æœ‰è¿”å›çŠ¶æ€ç ï¼Œé‚£ä¹ˆè¿™ä¸ªå±æ€§é»˜è®¤æ˜¯200ã€‚è¯·æ±‚å‘å‡ºä¹‹å‰ï¼Œè¯¥å±æ€§ä¸º0ã€‚è¯¥å±æ€§åªè¯»ã€‚\n200, OKï¼Œè®¿é—®æ­£å¸¸ 301, Moved Permanentlyï¼Œæ°¸ä¹…ç§»åŠ¨ 302, Moved temporarilyï¼Œæš‚æ—¶ç§»åŠ¨ 304, Not Modifiedï¼Œæœªä¿®æ”¹ 307, Temporary Redirectï¼Œæš‚æ—¶é‡å®šå‘ 401, Unauthorizedï¼Œæœªæˆæƒ 403, Forbiddenï¼Œç¦æ­¢è®¿é—® 404, Not Foundï¼Œæœªå‘ç°æŒ‡å®šç½‘å€ 500, Internal Server Errorï¼ŒæœåŠ¡å™¨å‘ç”Ÿé”™è¯¯ åŸºæœ¬ä¸Šï¼Œåªæœ‰2xxå’Œ304çš„çŠ¶æ€ç ï¼Œè¡¨ç¤ºæœåŠ¡å™¨è¿”å›æ˜¯æ­£å¸¸çŠ¶æ€ã€‚\nğŸ”— Href æŠ¥æ–‡å“åº”çŠ¶æ€ç \nif (xhr.readyState === 4) { if ( (xhr.status \u0026gt;= 200 \u0026amp;\u0026amp; xhr.status \u0026lt; 300) || (xhr.status === 304) ) { // å¤„ç†æœåŠ¡å™¨çš„è¿”å›æ•°æ® } else { // å‡ºé”™ } } XMLHttpRequest.statusTextå±æ€§è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å‘é€çš„çŠ¶æ€æç¤ºã€‚ä¸åŒäºstatuså±æ€§ï¼Œè¯¥å±æ€§åŒ…å«æ•´ä¸ªçŠ¶æ€ä¿¡æ¯ï¼Œæ¯”å¦‚â€œOKâ€å’Œâ€œNot Foundâ€ã€‚åœ¨è¯·æ±‚å‘é€ä¹‹å‰ï¼ˆå³è°ƒç”¨open()æ–¹æ³•ä¹‹å‰ï¼‰ï¼Œè¯¥å±æ€§çš„å€¼æ˜¯ç©ºå­—ç¬¦ä¸²ï¼›å¦‚æœæœåŠ¡å™¨æ²¡æœ‰è¿”å›çŠ¶æ€æç¤ºï¼Œè¯¥å±æ€§çš„å€¼é»˜è®¤ä¸ºâ€œOKâ€ã€‚è¯¥å±æ€§ä¸ºåªè¯»å±æ€§ã€‚\ntimeout ontimeout XMLHttpRequest.timeoutå±æ€§è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºå¤šå°‘æ¯«ç§’åï¼Œå¦‚æœè¯·æ±‚ä»ç„¶æ²¡æœ‰å¾—åˆ°ç»“æœï¼Œå°±ä¼šè‡ªåŠ¨ç»ˆæ­¢ã€‚å¦‚æœè¯¥å±æ€§ç­‰äº0ï¼Œå°±è¡¨ç¤ºæ²¡æœ‰æ—¶é—´é™åˆ¶ã€‚\nXMLHttpRequestEventTarget.ontimeoutå±æ€§ç”¨äºè®¾ç½®ä¸€ä¸ªç›‘å¬å‡½æ•°ï¼Œå¦‚æœå‘ç”Ÿ timeout äº‹ä»¶ï¼Œå°±ä¼šæ‰§è¡Œè¿™ä¸ªç›‘å¬å‡½æ•°ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚\nlet xhr = new XMLHttpRequest(); let url = \u0026#39;/server\u0026#39;; xhr.ontimeout = function () { console.error(\u0026#39;The request for \u0026#39; + url + \u0026#39; timed out.\u0026#39;); }; xhr.onload = function() { if (xhr.readyState === 4) { if (xhr.status === 200) { // å¤„ç†æœåŠ¡å™¨è¿”å›çš„æ•°æ® } else { console.error(xhr.statusText); } } }; xhr.open(\u0026#39;GET\u0026#39;, url, true); // æŒ‡å®š 10 ç§’é’Ÿè¶…æ—¶ xhr.timeout = 10 * 1000; xhr.send(null); é’©å­ onloadstart onprogress onabort onerror onload ontimeout loadend XMLHttpRequest å¯¹è±¡å¯ä»¥å¯¹ä»¥ä¸‹äº‹ä»¶æŒ‡å®šç›‘å¬å‡½æ•°ã€‚\nXMLHttpRequest.onloadstart: loadstart äº‹ä»¶ï¼ˆHTTP è¯·æ±‚å‘å‡ºï¼‰çš„ç›‘å¬å‡½æ•° XMLHttpRequest.onprogress: progressäº‹ä»¶ï¼ˆæ­£åœ¨å‘é€å’ŒåŠ è½½æ•°æ®ï¼‰çš„ç›‘å¬å‡½æ•° XMLHttpRequest.onabort: abort äº‹ä»¶ï¼ˆè¯·æ±‚ä¸­æ­¢ï¼Œæ¯”å¦‚ç”¨æˆ·è°ƒç”¨äº†abort()æ–¹æ³•ï¼‰çš„ç›‘å¬å‡½æ•° XMLHttpRequest.onerror: error äº‹ä»¶ï¼ˆè¯·æ±‚å¤±è´¥ï¼‰çš„ç›‘å¬å‡½æ•° XMLHttpRequest.onload: load äº‹ä»¶ï¼ˆè¯·æ±‚æˆåŠŸå®Œæˆï¼‰çš„ç›‘å¬å‡½æ•° XMLHttpRequest.ontimeout: timeout äº‹ä»¶ï¼ˆç”¨æˆ·æŒ‡å®šçš„æ—¶é™è¶…è¿‡äº†ï¼Œè¯·æ±‚è¿˜æœªå®Œæˆï¼‰çš„ç›‘å¬å‡½æ•° XMLHttpRequest.loadend: loadend äº‹ä»¶ï¼ˆè¯·æ±‚å®Œæˆï¼Œä¸ç®¡æˆåŠŸæˆ–å¤±è´¥ï¼‰çš„ç›‘å¬å‡½æ•° ğŸ“ƒ Example\nxhr.onload = function() { let responseText = xhr.responseText; console.log(responseText); // process the response. }; xhr.onabort = function () { console.log(\u0026#39;The request was aborted\u0026#39;); }; xhr.onprogress = function (event) { console.log(event.loaded); console.log(event.total); }; xhr.onerror = function() { console.log(\u0026#39;There was an error!\u0026#39;); }; progress äº‹ä»¶çš„ç›‘å¬å‡½æ•°æœ‰ä¸€ä¸ªäº‹ä»¶å¯¹è±¡å‚æ•°ï¼Œè¯¥å¯¹è±¡æœ‰ä¸‰ä¸ªå±æ€§ï¼šloadedå±æ€§è¿”å›å·²ç»ä¼ è¾“çš„æ•°æ®é‡ï¼Œtotal å±æ€§è¿”å›æ€»çš„æ•°æ®é‡ï¼ŒlengthComputable å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºåŠ è½½çš„è¿›åº¦æ˜¯å¦å¯ä»¥è®¡ç®—ã€‚æ‰€æœ‰è¿™äº›ç›‘å¬å‡½æ•°é‡Œé¢ï¼Œåªæœ‰ progress äº‹ä»¶çš„ç›‘å¬å‡½æ•°æœ‰å‚æ•°ï¼Œå…¶ä»–å‡½æ•°éƒ½æ²¡æœ‰å‚æ•°ã€‚\næ³¨æ„ï¼Œå¦‚æœå‘ç”Ÿç½‘ç»œé”™è¯¯ï¼ˆæ¯”å¦‚æœåŠ¡å™¨æ— æ³•è¿é€šï¼‰ï¼Œonerror äº‹ä»¶æ— æ³•è·å–æŠ¥é”™ä¿¡æ¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯èƒ½æ²¡æœ‰é”™è¯¯å¯¹è±¡ï¼Œæ‰€ä»¥è¿™æ ·åªèƒ½æ˜¾ç¤ºæŠ¥é”™çš„æç¤ºã€‚\nwithCredentials XMLHttpRequest.withCredentials å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè·¨åŸŸè¯·æ±‚æ—¶ï¼Œç”¨æˆ·ä¿¡æ¯ï¼ˆæ¯”å¦‚ Cookie å’Œè®¤è¯çš„ HTTP å¤´ä¿¡æ¯ï¼‰æ˜¯å¦ä¼šåŒ…å«åœ¨è¯·æ±‚ä¹‹ä¸­ï¼Œé»˜è®¤ä¸ºfalseï¼Œå³å‘ example.com å‘å‡ºè·¨åŸŸè¯·æ±‚æ—¶ï¼Œä¸ä¼šå‘é€ example.comè®¾ç½®åœ¨æœ¬æœºä¸Šçš„ Cookieï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚\nå¦‚æœéœ€è¦è·¨åŸŸ AJAX è¯·æ±‚å‘é€ Cookieï¼Œéœ€è¦withCredentialså±æ€§è®¾ä¸ºtrueã€‚æ³¨æ„ï¼ŒåŒæºçš„è¯·æ±‚ä¸éœ€è¦è®¾ç½®è¿™ä¸ªå±æ€§ã€‚\nlet xhr = new XMLHttpRequest(); xhr.open(\u0026#39;GET\u0026#39;, \u0026#39;http://example.com/\u0026#39;, true); xhr.withCredentials = true; xhr.send(null); ä¸ºäº†è®©è¿™ä¸ªå±æ€§ç”Ÿæ•ˆï¼ŒæœåŠ¡å™¨å¿…é¡»æ˜¾å¼è¿”å›Access-Control-Allow-Credentialsè¿™ä¸ªå¤´ä¿¡æ¯ã€‚\nAccess-Control-Allow-Credentials: true withCredentialså±æ€§æ‰“å¼€çš„è¯ï¼Œè·¨åŸŸè¯·æ±‚ä¸ä»…ä¼šå‘é€ Cookieï¼Œè¿˜ä¼šè®¾ç½®è¿œç¨‹ä¸»æœºæŒ‡å®šçš„ Cookieã€‚åä¹‹ä¹Ÿæˆç«‹ï¼Œå¦‚æœwithCredentialså±æ€§æ²¡æœ‰æ‰“å¼€ï¼Œé‚£ä¹ˆè·¨åŸŸçš„ AJAX è¯·æ±‚å³ä½¿æ˜ç¡®è¦æ±‚æµè§ˆå™¨è®¾ç½® Cookieï¼Œæµè§ˆå™¨ä¹Ÿä¼šå¿½ç•¥ã€‚\næ³¨æ„ï¼Œè„šæœ¬æ€»æ˜¯éµå®ˆåŒæºæ”¿ç­–ï¼Œæ— æ³•ä»document.cookieæˆ–è€… HTTP å›åº”çš„å¤´ä¿¡æ¯ä¹‹ä¸­ï¼Œè¯»å–è·¨åŸŸçš„ Cookieï¼ŒwithCredentialså±æ€§ä¸å½±å“è¿™ä¸€ç‚¹ã€‚\nupload XMLHttpRequest ä¸ä»…å¯ä»¥å‘é€è¯·æ±‚ï¼Œè¿˜å¯ä»¥å‘é€æ–‡ä»¶ï¼Œè¿™å°±æ˜¯ AJAX æ–‡ä»¶ä¸Šä¼ ã€‚å‘é€æ–‡ä»¶ä»¥åï¼Œé€šè¿‡XMLHttpRequest.uploadå±æ€§å¯ä»¥å¾—åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œé€šè¿‡è§‚å¯Ÿè¿™ä¸ªå¯¹è±¡ï¼Œå¯ä»¥å¾—çŸ¥ä¸Šä¼ çš„è¿›å±•ã€‚ä¸»è¦æ–¹æ³•å°±æ˜¯ç›‘å¬è¿™ä¸ªå¯¹è±¡çš„å„ç§äº‹ä»¶ï¼šloadstartã€loadendã€loadã€abortã€errorã€progressã€timeoutã€‚\nå‡å®šç½‘é¡µä¸Šæœ‰ä¸€ä¸ª\u0026lt;progress\u0026gt;å…ƒç´ ã€‚\n\u0026lt;progress min=\u0026#34;0\u0026#34; max=\u0026#34;100\u0026#34; value=\u0026#34;0\u0026#34;\u0026gt;0% complete\u0026lt;/progress\u0026gt; æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œå¯¹uploadå±æ€§æŒ‡å®šprogressäº‹ä»¶çš„ç›‘å¬å‡½æ•°ï¼Œå³å¯è·å¾—ä¸Šä¼ çš„è¿›åº¦ã€‚\nfunction upload(blobOrFile) { let xhr = new XMLHttpRequest(); xhr.open(\u0026#39;POST\u0026#39;, \u0026#39;/server\u0026#39;, true); xhr.onload = function (e) {}; let progressBar = document.querySelector(\u0026#39;progress\u0026#39;); xhr.upload.onprogress = function (e) { if (e.lengthComputable) { progressBar.value = (e.loaded / e.total) * 100; // å…¼å®¹ä¸æ”¯æŒ \u0026lt;progress\u0026gt; å…ƒç´ çš„è€å¼æµè§ˆå™¨ progressBar.textContent = progressBar.value; } }; xhr.send(blobOrFile); } upload(new Blob([\u0026#39;hello world\u0026#39;], {type: \u0026#39;text/plain\u0026#39;})); æ–¹æ³• open() XMLHttpRequest.open()æ–¹æ³•ç”¨äºæŒ‡å®š HTTP è¯·æ±‚çš„å‚æ•°ï¼Œæˆ–è€…è¯´åˆå§‹åŒ– XMLHttpRequest å®ä¾‹å¯¹è±¡ã€‚å®ƒä¸€å…±å¯ä»¥æ¥å—äº”ä¸ªå‚æ•°ã€‚\nvoid open( string method, string url, optional boolean async, optional string user, optional string password ); methodï¼šè¡¨ç¤º HTTP åŠ¨è¯æ–¹æ³•ï¼Œæ¯”å¦‚GETã€POSTã€PUTã€DELETEã€HEADç­‰ã€‚ url: è¡¨ç¤ºè¯·æ±‚å‘é€ç›®æ ‡ URLã€‚ async: å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯·æ±‚æ˜¯å¦ä¸ºå¼‚æ­¥ï¼Œé»˜è®¤ä¸ºtrueã€‚å¦‚æœè®¾ä¸ºfalseï¼Œåˆ™send()æ–¹æ³•åªæœ‰ç­‰åˆ°æ”¶åˆ°æœåŠ¡å™¨è¿”å›äº†ç»“æœï¼Œæ‰ä¼šè¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚è¯¥å‚æ•°å¯é€‰ã€‚ç”±äºåŒæ­¥ AJAX è¯·æ±‚ä¼šé€ æˆæµè§ˆå™¨å¤±å»å“åº”ï¼Œè®¸å¤šæµè§ˆå™¨å·²ç»ç¦æ­¢åœ¨ä¸»çº¿ç¨‹ä½¿ç”¨ï¼Œåªå…è®¸ Worker é‡Œé¢ä½¿ç”¨ã€‚æ‰€ä»¥ï¼Œè¿™ä¸ªå‚æ•°è½»æ˜“ä¸åº”è¯¥è®¾ä¸ºfalseã€‚ userï¼šè¡¨ç¤ºç”¨äºè®¤è¯çš„ç”¨æˆ·åï¼Œé»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²ã€‚è¯¥å‚æ•°å¯é€‰ã€‚ passwordï¼šè¡¨ç¤ºç”¨äºè®¤è¯çš„å¯†ç ï¼Œé»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²ã€‚è¯¥å‚æ•°å¯é€‰ã€‚ æ³¨æ„ï¼Œå¦‚æœå¯¹ä½¿ç”¨è¿‡open()æ–¹æ³•çš„ AJAX è¯·æ±‚ï¼Œå†æ¬¡ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œç­‰åŒäºè°ƒç”¨abort()ï¼Œå³ç»ˆæ­¢è¯·æ±‚ã€‚\nä¸‹é¢å‘é€ POST è¯·æ±‚çš„ä¾‹å­ã€‚\nlet xhr = new XMLHttpRequest(); xhr.open(\u0026#39;POST\u0026#39;, encodeURI(\u0026#39;someURL\u0026#39;)); send() XMLHttpRequest.send()æ–¹æ³•ç”¨äºå®é™…å‘å‡º HTTP è¯·æ±‚ã€‚å®ƒçš„å‚æ•°æ˜¯å¯é€‰çš„ï¼Œå¦‚æœä¸å¸¦å‚æ•°ï¼Œå°±è¡¨ç¤º HTTP è¯·æ±‚åªæœ‰ä¸€ä¸ª URLï¼Œæ²¡æœ‰æ•°æ®ä½“ï¼Œå…¸å‹ä¾‹å­å°±æ˜¯ GET è¯·æ±‚ï¼›å¦‚æœå¸¦æœ‰å‚æ•°ï¼Œå°±è¡¨ç¤ºé™¤äº†å¤´ä¿¡æ¯ï¼Œè¿˜å¸¦æœ‰åŒ…å«å…·ä½“æ•°æ®çš„ä¿¡æ¯ä½“ï¼Œå…¸å‹ä¾‹å­å°±æ˜¯ POST è¯·æ±‚ã€‚\nä¸‹é¢æ˜¯ GET è¯·æ±‚çš„ä¾‹å­ã€‚\nlet xhr = new XMLHttpRequest(); xhr.open(\u0026#39;GET\u0026#39;, \u0026#39;http://www.example.com/?id=\u0026#39; + encodeURIComponent(id), true ); xhr.send(null); ä¸Šé¢ä»£ç ä¸­ï¼ŒGETè¯·æ±‚çš„å‚æ•°ï¼Œä½œä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²é™„åŠ åœ¨ URL åé¢ã€‚\nä¸‹é¢æ˜¯å‘é€ POST è¯·æ±‚çš„ä¾‹å­ã€‚\nlet xhr = new XMLHttpRequest(); let data = \u0026#39;email=\u0026#39; + encodeURIComponent(email) + \u0026#39;\u0026amp;password=\u0026#39; + encodeURIComponent(password); xhr.open(\u0026#39;POST\u0026#39;, \u0026#39;http://www.example.com\u0026#39;, true); xhr.setRequestHeader(\u0026#39;Content-Type\u0026#39;, \u0026#39;application/x-www-form-urlencoded\u0026#39;); xhr.send(data); æ³¨æ„ï¼Œæ‰€æœ‰ XMLHttpRequest çš„ç›‘å¬äº‹ä»¶ï¼Œéƒ½å¿…é¡»åœ¨send()æ–¹æ³•è°ƒç”¨ä¹‹å‰è®¾å®šã€‚\nsendæ–¹æ³•çš„å‚æ•°å°±æ˜¯å‘é€çš„æ•°æ®ã€‚å¤šç§æ ¼å¼çš„æ•°æ®ï¼Œéƒ½å¯ä»¥ä½œä¸ºå®ƒçš„å‚æ•°ã€‚\nvoid send(); void send(ArrayBufferView data); void send(Blob data); void send(Document data); void send(String data); void send(FormData data); å¦‚æœsend()å‘é€ DOM å¯¹è±¡ï¼Œåœ¨å‘é€ä¹‹å‰ï¼Œæ•°æ®ä¼šå…ˆè¢«ä¸²è¡ŒåŒ–ã€‚å¦‚æœå‘é€äºŒè¿›åˆ¶æ•°æ®ï¼Œæœ€å¥½æ˜¯å‘é€ArrayBufferViewæˆ–Blobå¯¹è±¡ï¼Œè¿™ä½¿å¾—é€šè¿‡ Ajax ä¸Šä¼ æ–‡ä»¶æˆä¸ºå¯èƒ½ã€‚\nä¸‹é¢æ˜¯å‘é€è¡¨å•æ•°æ®çš„ä¾‹å­ã€‚FormDataå¯¹è±¡å¯ä»¥ç”¨äºæ„é€ è¡¨å•æ•°æ®ã€‚\nlet formData = new FormData(); formData.append(\u0026#39;username\u0026#39;, \u0026#39;å¼ ä¸‰\u0026#39;); formData.append(\u0026#39;email\u0026#39;, \u0026#39;zhangsan@example.com\u0026#39;); formData.append(\u0026#39;birthDate\u0026#39;, 1940); let xhr = new XMLHttpRequest(); xhr.open(\u0026#39;POST\u0026#39;, \u0026#39;/register\u0026#39;); xhr.send(formData); ä¸Šé¢ä»£ç ä¸­ï¼ŒFormDataå¯¹è±¡æ„é€ äº†è¡¨å•æ•°æ®ï¼Œç„¶åä½¿ç”¨send()æ–¹æ³•å‘é€ã€‚å®ƒçš„æ•ˆæœä¸å‘é€ä¸‹é¢çš„è¡¨å•æ•°æ®æ˜¯ä¸€æ ·çš„ã€‚\n\u0026lt;form id=\u0026#39;registration\u0026#39; name=\u0026#39;registration\u0026#39; action=\u0026#39;/register\u0026#39;\u0026gt; \u0026lt;input type=\u0026#39;text\u0026#39; name=\u0026#39;username\u0026#39; value=\u0026#39;å¼ ä¸‰\u0026#39;\u0026gt; \u0026lt;input type=\u0026#39;email\u0026#39; name=\u0026#39;email\u0026#39; value=\u0026#39;zhangsan@example.com\u0026#39;\u0026gt; \u0026lt;input type=\u0026#39;number\u0026#39; name=\u0026#39;birthDate\u0026#39; value=\u0026#39;1940\u0026#39;\u0026gt; \u0026lt;input type=\u0026#39;submit\u0026#39; onclick=\u0026#39;return sendForm(this.form);\u0026#39;\u0026gt; \u0026lt;/form\u0026gt; ä¸‹é¢çš„ä¾‹å­æ˜¯ä½¿ç”¨FormDataå¯¹è±¡åŠ å·¥è¡¨å•æ•°æ®ï¼Œç„¶åå†å‘é€ã€‚\nfunction sendForm(form) { let formData = new FormData(form); formData.append(\u0026#39;csrf\u0026#39;, \u0026#39;e69a18d7db1286040586e6da1950128c\u0026#39;); let xhr = new XMLHttpRequest(); xhr.open(\u0026#39;POST\u0026#39;, form.action, true); xhr.onload = function() { // ... }; xhr.send(formData); return false; } let form = document.querySelector(\u0026#39;#registration\u0026#39;); sendForm(form); setRequestHeader() XMLHttpRequest.setRequestHeader()æ–¹æ³•ç”¨äºè®¾ç½®æµè§ˆå™¨å‘é€çš„ HTTP è¯·æ±‚çš„å¤´ä¿¡æ¯ã€‚è¯¥æ–¹æ³•å¿…é¡»åœ¨open()ä¹‹åã€send()ä¹‹å‰è°ƒç”¨ã€‚å¦‚æœè¯¥æ–¹æ³•å¤šæ¬¡è°ƒç”¨ï¼Œè®¾å®šåŒä¸€ä¸ªå­—æ®µï¼Œåˆ™æ¯ä¸€æ¬¡è°ƒç”¨çš„å€¼ä¼šè¢«åˆå¹¶æˆä¸€ä¸ªå•ä¸€çš„å€¼å‘é€ã€‚\nè¯¥æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå¤´ä¿¡æ¯çš„å­—æ®µåï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å­—æ®µå€¼ã€‚\nxhr.setRequestHeader(\u0026#39;Content-Type\u0026#39;, \u0026#39;application/json\u0026#39;); xhr.setRequestHeader(\u0026#39;Content-Length\u0026#39;, JSON.stringify(data).length); xhr.send(JSON.stringify(data)); ä¸Šé¢ä»£ç é¦–å…ˆè®¾ç½®å¤´ä¿¡æ¯Content-Typeï¼Œè¡¨ç¤ºå‘é€ JSON æ ¼å¼çš„æ•°æ®ï¼›ç„¶åè®¾ç½®Content-Lengthï¼Œè¡¨ç¤ºæ•°æ®é•¿åº¦ï¼›æœ€åå‘é€ JSON æ•°æ®ã€‚\noverrideMimeType() XMLHttpRequest.overrideMimeType()æ–¹æ³•ç”¨æ¥æŒ‡å®š MIME ç±»å‹ï¼Œè¦†ç›–æœåŠ¡å™¨è¿”å›çš„çœŸæ­£çš„ MIME ç±»å‹ï¼Œä»è€Œè®©æµè§ˆå™¨è¿›è¡Œä¸ä¸€æ ·çš„å¤„ç†ã€‚ä¸¾ä¾‹æ¥è¯´ï¼ŒæœåŠ¡å™¨è¿”å›çš„æ•°æ®ç±»å‹æ˜¯text/xmlï¼Œç”±äºç§ç§åŸå› æµè§ˆå™¨è§£æä¸æˆåŠŸæŠ¥é”™ï¼Œè¿™æ—¶å°±æ‹¿ä¸åˆ°æ•°æ®äº†ã€‚ä¸ºäº†æ‹¿åˆ°åŸå§‹æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ MIME ç±»å‹æ”¹æˆtext/plainï¼Œè¿™æ ·æµè§ˆå™¨å°±ä¸ä¼šå»è‡ªåŠ¨è§£æï¼Œä»è€Œæˆ‘ä»¬å°±å¯ä»¥æ‹¿åˆ°åŸå§‹æ–‡æœ¬äº†ã€‚\nxhr.overrideMimeType(\u0026#39;text/plain\u0026#39;) æ³¨æ„ï¼Œè¯¥æ–¹æ³•å¿…é¡»åœ¨send()æ–¹æ³•ä¹‹å‰è°ƒç”¨ã€‚\nä¿®æ”¹æœåŠ¡å™¨è¿”å›çš„æ•°æ®ç±»å‹ï¼Œä¸æ˜¯æ­£å¸¸æƒ…å†µä¸‹åº”è¯¥é‡‡å–çš„æ–¹æ³•ã€‚å¦‚æœå¸Œæœ›æœåŠ¡å™¨è¿”å›æŒ‡å®šçš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥ç”¨responseTypeå±æ€§å‘Šè¯‰æœåŠ¡å™¨ï¼Œå°±åƒä¸‹é¢çš„ä¾‹å­ã€‚åªæœ‰åœ¨æœåŠ¡å™¨æ— æ³•è¿”å›æŸç§æ•°æ®ç±»å‹æ—¶ï¼Œæ‰ä½¿ç”¨overrideMimeType()æ–¹æ³•ã€‚\nlet xhr = new XMLHttpRequest(); xhr.onload = function(e) { let arraybuffer = xhr.response; // ... } xhr.open(\u0026#39;GET\u0026#39;, url); xhr.responseType = \u0026#39;arraybuffer\u0026#39;; xhr.send(); getResponseHeader() XMLHttpRequest.getResponseHeader()æ–¹æ³•è¿”å› HTTP å¤´ä¿¡æ¯æŒ‡å®šå­—æ®µçš„å€¼ï¼Œå¦‚æœè¿˜æ²¡æœ‰æ”¶åˆ°æœåŠ¡å™¨å›åº”æˆ–è€…æŒ‡å®šå­—æ®µä¸å­˜åœ¨ï¼Œè¿”å›nullã€‚è¯¥æ–¹æ³•çš„å‚æ•°ä¸åŒºåˆ†å¤§å°å†™ã€‚\nfunction getHeaderTime() { console.log(this.getResponseHeader(\u0026#34;Last-Modified\u0026#34;)); } let xhr = new XMLHttpRequest(); xhr.open(\u0026#39;HEAD\u0026#39;, \u0026#39;yourpage.html\u0026#39;); xhr.onload = getHeaderTime; xhr.send(); å¦‚æœæœ‰å¤šä¸ªå­—æ®µåŒåï¼Œå®ƒä»¬çš„å€¼ä¼šè¢«è¿æ¥ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå­—æ®µä¹‹é—´ä½¿ç”¨â€œé€—å·+ç©ºæ ¼â€åˆ†éš”ã€‚\ngetAllResponseHeaders() XMLHttpRequest.getAllResponseHeaders()æ–¹æ³•è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å‘æ¥çš„æ‰€æœ‰ HTTP å¤´ä¿¡æ¯ã€‚æ ¼å¼ä¸ºå­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå¤´ä¿¡æ¯ä¹‹é—´ä½¿ç”¨CRLFåˆ†éš”ï¼ˆå›è½¦+æ¢è¡Œï¼‰ï¼Œå¦‚æœæ²¡æœ‰æ”¶åˆ°æœåŠ¡å™¨å›åº”ï¼Œè¯¥å±æ€§ä¸ºnullã€‚å¦‚æœå‘ç”Ÿç½‘ç»œé”™è¯¯ï¼Œè¯¥å±æ€§ä¸ºç©ºå­—ç¬¦ä¸²ã€‚\nlet xhr = new XMLHttpRequest(); xhr.open(\u0026#39;GET\u0026#39;, \u0026#39;foo.txt\u0026#39;, true); xhr.send(); xhr.onreadystatechange = function () { if (this.readyState === 4) { let headers = xhr.getAllResponseHeaders(); } } ä¸Šé¢ä»£ç ç”¨äºè·å–æœåŠ¡å™¨è¿”å›çš„æ‰€æœ‰å¤´ä¿¡æ¯ã€‚å®ƒå¯èƒ½æ˜¯ä¸‹é¢è¿™æ ·çš„å­—ç¬¦ä¸²ã€‚\ndate: Fri, 08 Dec 2017 21:04:30 GMT\\r\\n content-encoding: gzip\\r\\n x-content-type-options: nosniff\\r\\n server: meinheld/0.6.1\\r\\n x-frame-options: DENY\\r\\n content-type: text/html; charset=utf-8\\r\\n connection: keep-alive\\r\\n strict-transport-security: max-age=63072000\\r\\n vary: Cookie, Accept-Encoding\\r\\n content-length: 6502\\r\\n x-xss-protection: 1; mode=block\\r\\n ç„¶åï¼Œå¯¹è¿™ä¸ªå­—ç¬¦ä¸²è¿›è¡Œå¤„ç†ã€‚\nlet arr = headers.trim().split(/[\\r\\n]+/); let headerMap = {}; arr.forEach(function (line) { let parts = line.split(\u0026#39;: \u0026#39;); let header = parts.shift(); let value = parts.join(\u0026#39;: \u0026#39;); headerMap[header] = value; }); headerMap[\u0026#39;content-length\u0026#39;] // \u0026#34;6502\u0026#34; abort() XMLHttpRequest.abort()æ–¹æ³•ç”¨æ¥ç»ˆæ­¢å·²ç»å‘å‡ºçš„ HTTP è¯·æ±‚ã€‚è°ƒç”¨è¿™ä¸ªæ–¹æ³•ä»¥åï¼ŒreadyStateå±æ€§å˜ä¸º4ï¼Œstatuså±æ€§å˜ä¸º0ã€‚\nlet xhr = new XMLHttpRequest(); xhr.open(\u0026#39;GET\u0026#39;, \u0026#39;http://www.example.com/page.php\u0026#39;, true); setTimeout(function () { if (xhr) { xhr.abort(); xhr = null; } }, 5000); ä¸Šé¢ä»£ç åœ¨å‘å‡º5ç§’ä¹‹åï¼Œç»ˆæ­¢ä¸€ä¸ª AJAX è¯·æ±‚ã€‚\nå¸è½½é¡µé¢ Navigator.sendBeacon()\nç”¨æˆ·å¸è½½ç½‘é¡µçš„æ—¶å€™ï¼Œæœ‰æ—¶éœ€è¦å‘æœåŠ¡å™¨å‘ä¸€äº›æ•°æ®ã€‚å¾ˆè‡ªç„¶çš„åšæ³•æ˜¯åœ¨unloadäº‹ä»¶æˆ–beforeunloadäº‹ä»¶çš„ç›‘å¬å‡½æ•°é‡Œé¢ï¼Œä½¿ç”¨XMLHttpRequestå¯¹è±¡å‘é€æ•°æ®ã€‚ä½†æ˜¯ï¼Œè¿™æ ·åšä¸æ˜¯å¾ˆå¯é ï¼Œå› ä¸ºXMLHttpRequestå¯¹è±¡æ˜¯å¼‚æ­¥å‘é€ï¼Œå¾ˆå¯èƒ½åœ¨å®ƒå³å°†å‘é€çš„æ—¶å€™ï¼Œé¡µé¢å·²ç»å¸è½½äº†ï¼Œä»è€Œå¯¼è‡´å‘é€å–æ¶ˆæˆ–è€…å‘é€å¤±è´¥ã€‚\nè§£å†³æ–¹æ³•å°±æ˜¯unloadäº‹ä»¶é‡Œé¢ï¼ŒåŠ ä¸€äº›å¾ˆè€—æ—¶çš„åŒæ­¥æ“ä½œã€‚è¿™æ ·å°±èƒ½ç•™å‡ºè¶³å¤Ÿçš„æ—¶é—´ï¼Œä¿è¯å¼‚æ­¥ AJAX èƒ½å¤Ÿå‘é€æˆåŠŸã€‚\nfunction log() { let xhr = new XMLHttpRequest(); xhr.open(\u0026#39;post\u0026#39;, \u0026#39;/log\u0026#39;, true); xhr.setRequestHeader(\u0026#39;Content-Type\u0026#39;, \u0026#39;application/x-www-form-urlencoded\u0026#39;); xhr.send(\u0026#39;foo=bar\u0026#39;); } window.addEventListener(\u0026#39;unload\u0026#39;, function(event) { log(); // a time-consuming operation for (let i = 1; i \u0026lt; 10000; i++) { for (let m = 1; m \u0026lt; 10000; m++) { continue; } } }); ä¸Šé¢ä»£ç ä¸­ï¼Œå¼ºåˆ¶æ‰§è¡Œäº†ä¸€æ¬¡åŒé‡å¾ªç¯ï¼Œæ‹–é•¿äº†unloadäº‹ä»¶çš„æ‰§è¡Œæ—¶é—´ï¼Œå¯¼è‡´å¼‚æ­¥ AJAX èƒ½å¤Ÿå‘é€æˆåŠŸã€‚\nç±»ä¼¼çš„è¿˜å¯ä»¥ä½¿ç”¨setTimeoutã€‚ä¸‹é¢æ˜¯è¿½è¸ªç”¨æˆ·ç‚¹å‡»çš„ä¾‹å­ã€‚\n// HTML ä»£ç å¦‚ä¸‹ // \u0026lt;a id=\u0026#34;target\u0026#34; href=\u0026#34;https://baidu.com\u0026#34;\u0026gt;click\u0026lt;/a\u0026gt; const clickTime = 350; const theLink = document.getElementById(\u0026#39;target\u0026#39;); function log() { let xhr = new XMLHttpRequest(); xhr.open(\u0026#39;post\u0026#39;, \u0026#39;/log\u0026#39;, true); xhr.setRequestHeader(\u0026#39;Content-Type\u0026#39;, \u0026#39;application/x-www-form-urlencoded\u0026#39;); xhr.send(\u0026#39;foo=bar\u0026#39;); } theLink.addEventListener(\u0026#39;click\u0026#39;, function (event) { event.preventDefault(); log(); setTimeout(function () { window.location.href = theLink.getAttribute(\u0026#39;href\u0026#39;); }, clickTime); }); ä¸Šé¢ä»£ç ä½¿ç”¨setTimeoutï¼Œæ‹–å»¶äº†350æ¯«ç§’ï¼Œæ‰è®©é¡µé¢è·³è½¬ï¼Œå› æ­¤ä½¿å¾—å¼‚æ­¥ AJAX æœ‰æ—¶é—´å‘å‡ºã€‚\nè¿™äº›åšæ³•çš„å…±åŒé—®é¢˜æ˜¯ï¼Œå¸è½½çš„æ—¶é—´è¢«ç¡¬ç”Ÿç”Ÿæ‹–é•¿äº†ï¼Œåé¢é¡µé¢çš„åŠ è½½è¢«æ¨è¿Ÿäº†ï¼Œç”¨æˆ·ä½“éªŒä¸å¥½ã€‚\nä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæµè§ˆå™¨å¼•å…¥äº†Navigator.sendBeacon()æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•è¿˜æ˜¯å¼‚æ­¥å‘å‡ºè¯·æ±‚ï¼Œä½†æ˜¯è¯·æ±‚ä¸å½“å‰é¡µé¢çº¿ç¨‹è„±é’©ï¼Œä½œä¸ºæµè§ˆå™¨è¿›ç¨‹çš„ä»»åŠ¡ï¼Œå› æ­¤å¯ä»¥ä¿è¯ä¼šæŠŠæ•°æ®å‘å‡ºå»ï¼Œä¸æ‹–å»¶å¸è½½æµç¨‹ã€‚\nwindow.addEventListener(\u0026#39;unload\u0026#39;, logData, false); function logData() { navigator.sendBeacon(\u0026#39;/log\u0026#39;, analyticsData); } Navigator.sendBeaconæ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç›®æ ‡æœåŠ¡å™¨çš„ URLï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ‰€è¦å‘é€çš„æ•°æ®ï¼ˆå¯é€‰ï¼‰ï¼Œå¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼ˆå­—ç¬¦ä¸²ã€è¡¨å•å¯¹è±¡ã€äºŒè¿›åˆ¶å¯¹è±¡ç­‰ç­‰ï¼‰ã€‚\nnavigator.sendBeacon(url, data) è¿™ä¸ªæ–¹æ³•çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæˆåŠŸå‘é€æ•°æ®ä¸ºtrueï¼Œå¦åˆ™ä¸ºfalseã€‚\nè¯¥æ–¹æ³•å‘é€æ•°æ®çš„ HTTP æ–¹æ³•æ˜¯ POSTï¼Œå¯ä»¥è·¨åŸŸï¼Œç±»ä¼¼äºè¡¨å•æäº¤æ•°æ®ã€‚å®ƒä¸èƒ½æŒ‡å®šå›è°ƒå‡½æ•°ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚\n// HTML ä»£ç å¦‚ä¸‹ // \u0026lt;body onload=\u0026#34;analytics(\u0026#39;start\u0026#39;)\u0026#34; onunload=\u0026#34;analytics(\u0026#39;end\u0026#39;)\u0026#34;\u0026gt; function analytics(state) { if (!navigator.sendBeacon) return; let URL = \u0026#39;http://example.com/analytics\u0026#39;; let data = \u0026#39;state=\u0026#39; + state + \u0026#39;\u0026amp;location=\u0026#39; + window.location; navigator.sendBeacon(URL, data); } Fetch Axios Axios æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºå‘é€ Ajax è¯·æ±‚çš„åº“ï¼Œå¯ä»¥åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è¿è¡Œã€‚å®ƒæ”¯æŒ ES6 Promise è¯­æ³•ã€è¯·æ±‚å’Œå“åº”æ‹¦æˆªå™¨ï¼Œä»¥åŠè‡ªåŠ¨è½¬æ¢ JSON æ•°æ®ã€‚\naxios({ url: \u0026#34;è¯·æ±‚åœ°å€\u0026#34;, method: \u0026#34;è¯·æ±‚æ–¹å¼\u0026#34;, params: { åç«¯å‚æ•°å: \u0026#34;å‰ç«¯è¦ä¼ é€’å€¼\u0026#34; }, // å‚æ•°åå’Œå€¼ä¼šè¢« axios æ‹¼æ¥åˆ° url? åé¢ï¼Œå³æŸ¥è¯¢å­—ç¬¦ä¸² data: { åç«¯å‚æ•°å: \u0026#34;å‰ç«¯è¦ä¼ é€’å€¼\u0026#34;, } // å‚æ•°åå’Œå€¼ä¼šè¢« axios æ‹¼æ¥åˆ°è¯·æ±‚ä½“å†… }) ğŸ“ƒ Example\naxios({ url: \u0026#34;\u0026#34;, method: \u0026#34;GET\u0026#34;, // é»˜è®¤ GET æ–¹å¼ï¼Œå¯ä»¥çœç•¥ä¸å†™ params: { bookname: this.bookName } }).then(res =\u0026gt; console.log(res)) // åŸåœ°å¾—åˆ° Promise å¯¹è±¡ axios({ url: \u0026#34;/api/addbook\u0026#34;, method: \u0026#34;POST\u0026#34;, data: { appkey: \u0026#34;uuid\u0026#34;, ...this.obj } }).then(res =\u0026gt; { console.log(res) }) ä½¿ç”¨æ—¶ï¼ŒAxios åŸåœ°è¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ then() / catch() æ–¹æ³•æ‹¿åˆ°ç»“æœã€‚\né»˜è®¤åœ°å€\naxios.defaults.baseurl=\u0026#34;localhost:8080\u0026#34; äº‹ä»¶ readyStateChange readyState å±æ€§çš„å€¼å‘ç”Ÿæ”¹å˜ï¼Œå°±ä¼šè§¦å‘ readyStateChange äº‹ä»¶ã€‚\næˆ‘ä»¬å¯ä»¥é€šè¿‡ onReadyStateChange å±æ€§ï¼ŒæŒ‡å®šè¿™ä¸ªäº‹ä»¶çš„ç›‘å¬å‡½æ•°ï¼Œå¯¹ä¸åŒçŠ¶æ€è¿›è¡Œä¸åŒå¤„ç†ã€‚å°¤å…¶æ˜¯å½“çŠ¶æ€å˜ä¸º 4 çš„æ—¶å€™ï¼Œè¡¨ç¤ºé€šä¿¡æˆåŠŸï¼Œè¿™æ—¶å›è°ƒå‡½æ•°å°±å¯ä»¥å¤„ç†æœåŠ¡å™¨ä¼ é€å›æ¥çš„æ•°æ®ã€‚\nprogress ä¸Šä¼ æ–‡ä»¶æ—¶ï¼ŒXMLHttpRequest å®ä¾‹å¯¹è±¡æœ¬èº«å’Œå®ä¾‹çš„uploadå±æ€§ï¼Œéƒ½æœ‰ä¸€ä¸ªprogressäº‹ä»¶ï¼Œä¼šä¸æ–­è¿”å›ä¸Šä¼ çš„è¿›åº¦ã€‚\nlet xhr = new XMLHttpRequest(); function updateProgress (oEvent) { if (oEvent.lengthComputable) { let percentComplete = oEvent.loaded / oEvent.total; } else { console.log(\u0026#39;æ— æ³•è®¡ç®—è¿›å±•\u0026#39;); } } xhr.addEventListener(\u0026#39;progress\u0026#39;, updateProgress); xhr.open(); load error abort load äº‹ä»¶è¡¨ç¤ºæœåŠ¡å™¨ä¼ æ¥çš„æ•°æ®æ¥æ”¶å®Œæ¯•ï¼Œerror äº‹ä»¶è¡¨ç¤ºè¯·æ±‚å‡ºé”™ï¼Œabort äº‹ä»¶è¡¨ç¤ºè¯·æ±‚è¢«ä¸­æ–­ï¼ˆæ¯”å¦‚ç”¨æˆ·å–æ¶ˆè¯·æ±‚ï¼‰ã€‚\nlet xhr = new XMLHttpRequest(); xhr.addEventListener(\u0026#39;load\u0026#39;, transferComplete); xhr.addEventListener(\u0026#39;error\u0026#39;, transferFailed); xhr.addEventListener(\u0026#39;abort\u0026#39;, transferCanceled); xhr.open(); function transferComplete() { console.log(\u0026#39;æ•°æ®æ¥æ”¶å®Œæ¯•\u0026#39;); } function transferFailed() { console.log(\u0026#39;æ•°æ®æ¥æ”¶å‡ºé”™\u0026#39;); } function transferCanceled() { console.log(\u0026#39;ç”¨æˆ·å–æ¶ˆæ¥æ”¶\u0026#39;); } loadend abortã€loadå’Œerrorè¿™ä¸‰ä¸ªäº‹ä»¶ï¼Œä¼šä¼´éšä¸€ä¸ªloadendäº‹ä»¶ï¼Œè¡¨ç¤ºè¯·æ±‚ç»“æŸï¼Œä½†ä¸çŸ¥é“å…¶æ˜¯å¦æˆåŠŸã€‚\nxhr.addEventListener(\u0026#39;loadend\u0026#39;, loadEnd); function loadEnd(e) { console.log(\u0026#39;è¯·æ±‚ç»“æŸï¼ŒçŠ¶æ€æœªçŸ¥\u0026#39;); } timeout æœåŠ¡å™¨è¶…è¿‡æŒ‡å®šæ—¶é—´è¿˜æ²¡æœ‰è¿”å›ç»“æœï¼Œå°±ä¼šè§¦å‘ timeout äº‹ä»¶ï¼Œå…·ä½“çš„ä¾‹å­å‚è§timeoutå±æ€§ä¸€èŠ‚ã€‚\næ§åˆ¶ è¯·æ±‚è¶…æ—¶ å½“è¯·æ±‚æ—¶é—´è¿‡é•¿æˆ–è€…æ— ç½‘ç»œæ—¶ï¼Œè¿›è¡Œçš„ç›¸åº”å¤„ç†ã€‚\nlet result = document.getElementById(\u0026#34;result\u0026#34;); document.getElementById(\u0026#34;button\u0026#34;).addEventListener(\u0026#34;click\u0026#34;, function () { const xhr = new XMLHTTPRequest(); //è¶…æ—¶è®¾ç½® 2s è®¾ç½® xhr.timeout = 2000; //è¶…æ—¶å›è°ƒ xhr.ontimeout = function () { result.innerText = \u0026#34;ç½‘ç»œå¼‚å¸¸, è¯·ç¨åé‡è¯•!\u0026#34;; } //ç½‘ç»œå¼‚å¸¸å›è°ƒ xhr.onerror = function () { result.innerText = \u0026#34;ä½ çš„ç½‘ç»œä¼¼ä¹å‡ºäº†ä¸€äº›é—®é¢˜!\u0026#34;; } xhr.open(\u0026#34;GET\u0026#34;, \u0026#34;HTTP://127.0.0.1:8000/delay\u0026#34;); xhr.send(); xhr.onreadystatechange = function () { if (xhr.readyState === 4) { if (xhr.status \u0026gt;= 200 \u0026amp;\u0026amp; xhr.status \u0026lt; 300) { result.innerHTML = xhr.response; } } } }) å–æ¶ˆè¯·æ±‚ åœ¨ ç­‰å¾…å“åº”è¿˜æœªè°ƒç”¨å›è°ƒå‡½æ•° é˜¶æ®µï¼Œå¯ä»¥è°ƒç”¨ abort() å–æ¶ˆè¯·æ±‚ã€‚\nconst buttons = document.querySelectorAll(\u0026#34;button\u0026#34;); let xhr; buttons[0].onclick = () =\u0026gt; { xhr = new XMLHTTPRequest(); xhr.open(\u0026#34;GET\u0026#34;, \u0026#34;HTTP://127.0.0.1:8000/delay\u0026#34;); xhr.send(); } // å–æ¶ˆ - abort() buttons[1].onclick = () =\u0026gt; { xhr.abort(); } é‡å¤è¯·æ±‚ åŸç†ç±»ä¼¼ è¿›ç¨‹é” ï¼Œå¢åŠ ä¸€ä¸ª å‘é€çŠ¶æ€æ ‡å¿—flag ã€‚å¦‚æœå†æ¬¡è°ƒç”¨æ—¶å‘ç°ä¹‹å‰è¯·æ±‚ä»ç„¶åœ¨å‘é€ä¸­ï¼Œåˆ™åœæ­¢è¯·æ±‚ã€‚\nlet xhr; let isSending = false; document.getElementsByTagName(\u0026#34;button\u0026#34;)[0].onclick = function () { // åˆ¤æ–­æ ‡è¯†å˜é‡ if (isSending) xhr.abort(); // å¦‚æœæ­£åœ¨å‘é€, åˆ™å–æ¶ˆè¯¥è¯·æ±‚ // åˆ›å»ºä¸€ä¸ªæ–°çš„è¯·æ±‚ xhr = new XMLHTTPRequest(); // ä¿®æ”¹æ ‡è¯†å˜é‡çš„å€¼ isSending = true; xhr.open(\u0026#34;GET\u0026#34;, \u0026#34;HTTP://127.0.0.1:8000/delay\u0026#34;); xhr.send(); xhr.onreadystatechange = () =\u0026gt; { if (xhr.readyState === 4) { // ä¿®æ”¹æ ‡è¯†å˜é‡ isSending = false; // å¤„ç†å‡½æ•° } } // å…¶å®ƒæƒ…å†µä¹Ÿéœ€è¦å…³é—­é” xhr.ontimeout = () =\u0026gt; { }; xhr.onerror = () =\u0026gt; { }; } æ‚é¡¹ IE ç¼“å­˜é—®é¢˜ é—®é¢˜ï¼šåœ¨ Internet Explorer ä¸­ï¼Œç”±äº ç¼“å­˜æœºåˆ¶ çš„å­˜åœ¨ï¼ŒAJAX åªä¼šå‘é€ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼Œè€Œå‰©ä½™çš„å¤šæ¬¡è¯·æ±‚éƒ½ä»ç¼“å­˜ä¸­åŠ è½½ï¼Œå¯¼è‡´æ•°æ®æ— æ³•æ›´æ–°ã€‚\nè§£å†³æ–¹å¼ï¼šæµè§ˆå™¨çš„ç¼“å­˜æ˜¯æ ¹æ® url åœ°å€æ¥è®°å½•çš„ã€‚æ¯æ¬¡é™„åŠ éšæœºå‚æ•°å³å¯ã€‚\nxhr.open(\u0026#34;GET\u0026#34;, \u0026#34;/testAJAX?t=\u0026#34; + Date.now()); GET ä¸ POST åŒºåˆ« ä¸ POST ç›¸æ¯”ï¼ŒGET æ›´ç®€å•ä¹Ÿæ›´å¿«ï¼Œå¹¶ä¸”åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½èƒ½ç”¨ã€‚\nç„¶è€Œï¼Œåœ¨ä»¥ä¸‹æƒ…å†µä¸­ï¼Œè¯·ä½¿ç”¨ POST è¯·æ±‚ï¼š\nä¸æ„¿ä½¿ç”¨ç¼“å­˜æ–‡ä»¶ï¼ˆæ›´æ–°æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶æˆ–æ•°æ®åº“ï¼‰ å‘æœåŠ¡å™¨å‘é€å¤§é‡æ•°æ®ï¼ˆPOST æ²¡æœ‰æ•°æ®é‡é™åˆ¶ï¼‰ å‘é€åŒ…å« æœªçŸ¥å­—ç¬¦ çš„ç”¨æˆ·è¾“å…¥æ—¶ï¼ŒPOST æ¯” GET æ›´ç¨³å®šä¹Ÿæ›´å¯é  // GET xmlHTTP.open(\u0026#34;GET\u0026#34;,\u0026#34;/example.php?key=value\u0026#34;,true); xmlHTTP.send(); // POST xmlHTTP.open(\u0026#34;POST\u0026#34;, \u0026#34;/example.php\u0026#34;, true); xmlHTTP.send(\u0026#34;body\u0026#34;); //ä¼ é€postçš„å‚æ•° æ¡†æ¶ åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¸€èˆ¬é€šè¿‡æ¡†æ¶å‘é€ AJAX è¯·æ±‚ã€‚\nJQuery $.get() $(\u0026#34;button\u0026#34;).eq(0).click(() =\u0026gt; { $.get(\u0026#34;HTTP://127.0.0.1:8000/jquery-server\u0026#34;, {a: 100, b: 200}, ret =\u0026gt; { console.log(ret); }, \u0026#34;json\u0026#34;); }); $.post() $(\u0026#34;button\u0026#34;).eq(1).click(() =\u0026gt; { $.post(\u0026#34;HTTP://127.0.0.1:8000/jquery-server\u0026#34;, {a: 100, b: 200}, ret =\u0026gt; { console.log(ret); }); }); $.ajax() $(\u0026#34;button\u0026#34;).eq(2).click(() =\u0026gt; { $.ajax({ //url url: \u0026#34;HTTP://127.0.0.1:8000/jquery-server\u0026#34;, //å‚æ•° data: {a: 100, b: 200}, //è¯·æ±‚ç±»å‹ type: \u0026#34;GET\u0026#34;, //å“åº”ä½“ç»“æœ dataType: \u0026#34;json\u0026#34;, //æˆåŠŸçš„å›è°ƒ success(ret) { console.log(ret); }, //è¶…æ—¶æ—¶é—´ timeout: 2000, //å¤±è´¥çš„å›è°ƒ error() { console.log(\u0026#34;å‡ºé”™å•¦!!\u0026#34;); }, //å¤´ä¿¡æ¯ headers: { c: 300, d: 400 } }); }); Axios Axios æ˜¯ä¸€ä¸ªåŸºäº promise çš„ç½‘ç»œè¯·æ±‚åº“ï¼Œä½œç”¨äº Node.js å’Œæµè§ˆå™¨ä¸­ã€‚ å®ƒæ˜¯ isomorphicå³åŒä¸€å¥—ä»£ç å¯ä»¥è¿è¡Œåœ¨æµè§ˆå™¨å’Œnode.jsä¸­ çš„ã€‚åœ¨ æœåŠ¡ç«¯ å®ƒä½¿ç”¨åŸç”Ÿ Node.js HTTP æ¨¡å—ï¼Œè€Œåœ¨ å®¢æˆ·ç«¯æµè§ˆç«¯ åˆ™ä½¿ç”¨ XMLHTTPRequests ã€‚\n.get() axios.get(url, data, params)\n//é…ç½® baseURL axios.defaults.baseURL = \u0026#39;HTTP://127.0.0.1:8000\u0026#39;; document.querySelector(\u0026#34;button\u0026#34;).onclick = () =\u0026gt; { //GET è¯·æ±‚ axios.get(\u0026#39;/axios-server\u0026#39;, { //url å‚æ•° params: { id: 100, vip: 7 }, //è¯·æ±‚å¤´ä¿¡æ¯ headers: { name: \u0026#39;atguigu\u0026#39;, age: 20 } }).then(value =\u0026gt; { console.log(value); }); } .post() axios.post(url, data, params)\n// é…ç½® baseURL axios.defaults.baseURL = \u0026#34;HTTP://127.0.0.1:8000\u0026#34;; document.querySelector(\u0026#34;button\u0026#34;).onclick = function () { axios.post(\u0026#34;/axios-server\u0026#34;, { username: \u0026#34;admin\u0026#34;, password: \u0026#34;admin\u0026#34; }, { //url params: { id: 200, vip: 9 }, //è¯·æ±‚å¤´å‚æ•° headers: { height: 180, weight: 180 } }); }; .axios() axios({})\n//é…ç½® baseURL axios.defaults.baseURL = \u0026#34;HTTP://127.0.0.1:8000\u0026#34;; btns[2].onclick = function () { axios({ //è¯·æ±‚æ–¹æ³• method: \u0026#34;POST\u0026#34;, //url url: \u0026#34;/axios-server\u0026#34;, //urlå‚æ•° params: { vip: 10, level: 30 }, //å¤´ä¿¡æ¯ï¼Œæ­¤éƒ¨åˆ†å¦‚æœä½¿ç”¨è‡ªå®šä¹‰çš„å¤´ä¿¡æ¯ï¼Œéœ€è¦æœåŠ¡ç«¯è¿›è¡Œç›¸åº”ä¿®æ”¹,æ­£å¸¸ä¸è®¾ç½® headers: { a: 100, b: 200 }, //è¯·æ±‚ä½“å‚æ•° data: { username: \u0026#34;admin\u0026#34;, password: \u0026#34;admin\u0026#34; } }).then(response =\u0026gt; { //å“åº”çŠ¶æ€ç  console.log(response.status); //å“åº”çŠ¶æ€å­—ç¬¦ä¸² console.log(response.statusText); //å“åº”å¤´ä¿¡æ¯ console.log(response.headers); //å“åº”ä½“ console.log(response.data); }) } Fetch btn.onclick = _ =\u0026gt; { fetch(\u0026#39;HTTP://127.0.0.1:8000/fetch-server?vip=10\u0026#39;, { //è¯·æ±‚æ–¹æ³• method: \u0026#39;POST\u0026#39;, //è¯·æ±‚å¤´ headers: { name: \u0026#39;atguigu\u0026#39; }, //è¯·æ±‚ä½“ body: \u0026#39;username=admin\u0026amp;password=admin\u0026#39; }).then(response =\u0026gt; { // return response.text(); return response.json(); }).then(response =\u0026gt; { console.log(response); }); }; è·¨åŸŸ ä»€ä¹ˆæ˜¯è·¨åŸŸï¼Ÿ å½“ä¸€ä¸ªç½‘é¡µå‘å¦ä¸€ä¸ªä¸åŒåŸŸå/åè®®/ç«¯å£çš„ç½‘é¡µè¯·æ±‚èµ„æºæ—¶å°±ä¼šå‘ç”Ÿè·¨åŸŸã€‚ è·¨åŸŸåŸå› äº§ç”Ÿï¼šåœ¨å½“å‰åŸŸåè¯·æ±‚ç½‘ç«™ä¸­ï¼Œé»˜è®¤ä¸å…è®¸é€šè¿‡ AJAX è¯·æ±‚å‘é€å…¶ä»–åŸŸåã€‚ :memo: Note è·¨åŸŸçš„ç•Œå®š\nåè®®ã€åŸŸåã€ç«¯å£å…¨éƒ¨ç›¸åŒæ‰ç®—åŒä¸€åŸŸä¸‹ï¼Œä¸‰ä¸ªæ¡ä»¶æœ‰ä¸€ä¸ªä¸ä¸€è‡´ï¼Œéƒ½ä¸ç®—åŒåŸŸã€‚\nå› æ­¤ï¼Œå³ä½¿æ˜¯æˆ‘ä»¬è‡ªå·±çš„åŸŸåæœåŠ¡å™¨ï¼Œè€Œ äºŒçº§åŸŸå æˆ– ä¸‰çº§åŸŸå ä¸ä¸€è‡´ï¼Œä¹Ÿä¼šå‡ºç°è·¨åŸŸï¼Œå¦‚ï¼šimg.baidu.com ä¸ www.baidu.com ä¹‹é—´éœ€è¦æ•°æ®äº¤äº’ï¼Œå°±å‘ç”Ÿäº† è·¨åŸŸ ã€‚\nä¸ºä»€ä¹ˆä¼šäº§ç”Ÿè·¨åŸŸè¯·æ±‚ï¼Ÿ æµè§ˆå™¨ä½¿ç”¨äº† åŒæºç­–ç•¥ ã€‚ ä»€ä¹ˆæ˜¯åŒæºç­–ç•¥ï¼Ÿ åŒæºç­–ç•¥æ˜¯ Netscape æå‡ºçš„ä¸€ä¸ªè‘—åçš„å®‰å…¨ç­–ç•¥ï¼Œç°åœ¨æ‰€æœ‰æ”¯æŒ JavaScript çš„æµè§ˆå™¨éƒ½ä¼šä½¿ç”¨è¿™ä¸ªç­–ç•¥ã€‚åŒæºç­–ç•¥æ˜¯æµè§ˆå™¨æœ€æ ¸å¿ƒä¹Ÿæœ€åŸºæœ¬çš„å®‰å…¨åŠŸèƒ½ï¼Œå¦‚æœç¼ºå°‘åŒæºç­–ç•¥ï¼Œæµè§ˆå™¨çš„æ­£å¸¸åŠŸèƒ½å¯èƒ½å—åˆ°å½±å“ã€‚\nå¯ä»¥è¯´ Web æ˜¯æ„å»ºåœ¨åŒæºç­–ç•¥çš„åŸºç¡€ä¹‹ä¸Šçš„ï¼Œæµè§ˆå™¨åªæ˜¯é’ˆå¯¹åŒæºç­–ç•¥çš„ä¸€ç§å®ç°ã€‚\nä¸ºä»€ä¹ˆæµè§ˆå™¨è¦ä½¿ç”¨åŒæºç­–ç•¥ï¼Ÿ æ˜¯ä¸ºäº†ä¿è¯ç”¨æˆ·çš„ä¿¡æ¯å®‰å…¨ï¼Œé˜²æ­¢æ¶æ„ç½‘ç«™çªƒå–æ•°æ®ï¼Œå¦‚æœç½‘é¡µä¹‹é—´ä¸æ»¡è¶³åŒæºè¦æ±‚ï¼Œå°†ä¸èƒ½ï¼š å…±äº« Cookieã€LocalStorageã€IndexDB è·å– DOM AJAX è¯·æ±‚ä¸èƒ½å‘é€ è·¨åŸŸçš„äº”ä¸ªè§£å†³æ–¹å¼ å‰ç«¯ä½¿ç”¨ JsonP ï¼ˆä¸æ¨èä½¿ç”¨ï¼‰ åå° HTTP è¯·æ±‚è½¬å‘ åå°é…ç½®åŒæº CORS ï¼ˆæ¨èï¼‰ ä½¿ç”¨ SpringCloud ç½‘å…³ ä½¿ç”¨ Nginx åšè½¬å‘ (æ¨è)d JsonP JsonP æ˜¯ä»€ä¹ˆ? JsonP - JSON with Paddingï¼Œæ˜¯ä¸€ä¸ªéå®˜æ–¹çš„è·¨åŸŸè§£å†³æ–¹æ¡ˆï¼Œåªæ”¯æŒ GET è¯·æ±‚ã€‚\nJSONP æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ åœ¨ç½‘é¡µæœ‰ä¸€äº›æ ‡ç­¾å¤©ç”Ÿå…·æœ‰è·¨åŸŸèƒ½åŠ›ï¼Œæ¯”å¦‚ï¼šimg link iframe\nscriptã€‚JSONP å°±æ˜¯åˆ©ç”¨ script æ ‡ç­¾çš„è·¨åŸŸèƒ½åŠ›æ¥å‘é€è¯·æ±‚çš„ã€‚\nä½¿ç”¨ // 1. åŠ¨æ€çš„åˆ›å»ºä¸€ä¸ª script æ ‡ç­¾ const script = document.createElement(\u0026#34;script\u0026#34;); // 2. è®¾ç½® script çš„ srcï¼Œå¹¶è®¾ç½®å›è°ƒå‡½æ•° script.src = \u0026#34;HTTP://localhost:3000/testAJAX?callback=abc\u0026#34;; function abc(data) { alert(data.name); }; // 3. å°† script æ·»åŠ åˆ° body ä¸­ document.body.appendChild(script); // 4. æœåŠ¡å™¨ä¸­è·¯ç”±çš„å¤„ç† router.get(\u0026#34;/testAJAX\u0026#34;, function (req, res) { console.log(\u0026#34;æ”¶åˆ°è¯·æ±‚\u0026#34;); const callback = req.query.callback; const obj = { name: \u0026#34;å­™æ‚Ÿç©º\u0026#34;, age: 18 }; res.send(callback + \u0026#34;(\u0026#34; + JSON.stringify(obj) + \u0026#34;)\u0026#34;); }); å‘é€ // 1. å‰ç«¯ä»£ç  $(\u0026#39;button\u0026#39;).eq(0).click(function () { $.getJSON(\u0026#39;HTTP://127.0.0.1:8000/jquery-jsonp-server?callback=?\u0026#39;, function (data) { $(\u0026#39;#result\u0026#39;).html(`åç§°: ${data.name}\u0026lt;br\u0026gt;æ ¡åŒº: ${data.city}`); }); }); // 2. æœåŠ¡ç«¯ä»£ç  app.all(\u0026#39;/jquery-jsonp-server\u0026#39;, (request, response) =\u0026gt; { // response.send(\u0026#39;console.log(\u0026#34;hello jsonp\u0026#34;)\u0026#39;); const data = { name: \u0026#39;å°šç¡…è°·\u0026#39;, city: [\u0026#39;åŒ—äº¬\u0026#39;, \u0026#39;ä¸Šæµ·\u0026#39;, \u0026#39;æ·±åœ³\u0026#39;] }; //å°†æ•°æ®è½¬åŒ–ä¸ºå­—ç¬¦ä¸² let str = JSON.stringify(data); //æ¥æ”¶ callback å‚æ•° let cb = request.query.callback; //è¿”å›ç»“æœ response.end(`${cb}(${str})`); }); æ’ä»¶ ä»£ä»·ï¼šéœ€è¦å‰åç«¯è”åŠ¨ ç²¾é«“ï¼šè‡ªåŠ¨çš„ç”±æ’ä»¶ç”Ÿæˆæ–¹æ³•åï¼Œå¹¶åœ¨å½“å‰çš„é¡µé¢åŠ¨æ€çš„ç”Ÿæˆå‡½æ•°ï¼Œç„¶åå†ç”Ÿæˆçš„å‡½æ•°é‡Œå¤´è°ƒç”¨ç”¨æˆ·é¢„ç•™çš„å›è°ƒå‡½æ•° æ’ä»¶ï¼šè‡ªåŠ¨åŒ–çš„å»æ¨¡æ‹ŸåŸºäº script å»å®ç°è·¨åŸŸè¯·æ±‚çš„è¿‡ç¨‹ï¼ˆå¯¹ç”¨æˆ·æ¥è¯´æ˜¯é»‘ç›’å­ï¼‰ å‚æ•°æ‹¼æ¥ï¼šurl å·²ç»æ˜¯å¸¦å‚çš„ï¼Œå’Œä¸å¸¦å‚çš„ id ä¼˜åŒ–ï¼šé¢å¯ä»¥æ·»åŠ ä¸€ä¸ªå®¹å™¨æ¥ç®¡ç† id å‰ç«¯è°ƒç”¨æµ‹è¯•å°è£…å¥½çš„ JsonP ä»£ç  //æµ‹è¯•è°ƒç”¨å‡½æ•° let test = () =\u0026gt; { jsonP.req({ url: \u0026#34;HTTP://localhost:3000/jsonpx\u0026#34;, data: { a: \u0026#34;111\u0026#34; }, callback: ret =\u0026gt; { alert(\u0026#34;æˆåŠŸ\u0026#34; + ret); } }); }; æœåŠ¡ç«¯æµ‹è¯•ä»£ç  router.get(\u0026#39;/jsonpx\u0026#39;, async function (req, resp, next) { let callback = req.query.callback; let data = req.query.a; if (!data) { resp.send(`${callback}(\u0026#39;æ´ªjl:æˆ‘æ˜¯æœåŠ¡ç«¯ä»£ç \u0026#39;)`) } resp.send(`${callback}(\u0026#39;æ´ªjl:æˆ‘æ˜¯æœåŠ¡ç«¯ä»£ç ` + data + `\u0026#39;)`) }) å°è£…åŸç”Ÿä»£ç  \u0026lt;script\u0026gt; /**author:@hongjilin * 1.å£°æ˜ä¸€ä¸ªjsonPæ’ä»¶å¯¹è±¡ * ä½œç”¨ï¼šéš”å¼€ä½œç”¨åŸŸ */ let jsonP = {}; /** *2.åœ¨æ’ä»¶å¯¹è±¡ä¸­åˆ›å»ºä¸¤ä¸ªåå­—å¤‡ç”¨ç¬¦æ•°ç»„ */ jsonP.char = { Number: \u0026#39;0123456789\u0026#39;, Letter: \u0026#39;qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM\u0026#39; } /** * é€šè¿‡éšæœºæ•°æŠ½å–å¤‡ç”¨å­—ç¬¦æ•°ç»„åº“æ‹¼å‡‘å‡½æ•°id * @param charLen * @param numLen */ jsonP.newFunId = function (charLen, numLen) { let id = \u0026#39;\u0026#39;; for (let i = 0; i \u0026lt; charLen; i++) { id += this.char.Letter.charAt(Math.random() * 52) } for (let j = 0; j \u0026lt; numLen; j++) { id += Math.floor(Math.random() * 10); } return id; } /** * æ‹¼æ¥è·¯å¾„ * @param url * @param key * @param value */ jsonP.jointUrl = function (url, key, value) { if (url \u0026amp;\u0026amp; key \u0026amp;\u0026amp; value) { let sign = \u0026#34;\u0026amp;\u0026#34; //å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡ if (url.indexOf(\u0026#39;?\u0026#39;) == -1) { sign = \u0026#39;?\u0026#39; } url += sign + key + \u0026#34;=\u0026#34; + value } return url; } /** å°è£…errå±æ€§æ–¹ä¾¿ */ jsonP.err = function (msg) { console.error(msg) } /** * å‘é€è¯·æ±‚å‡½æ•° * @param options */ jsonP.req = function (options) { let jsonId={}; //1.ç”Ÿæˆæ–¹æ³•å jsonId.funId = this.newFunId(4,8); let Userurl = options.url; let Userdata = options.data; if (!options) { this.err(\u0026#34;è¾“å…¥ä¸èƒ½ç©º\u0026#34;) return; } else if (!Userurl) { this.err(\u0026#34;urlä¸èƒ½ç©º\u0026#34;) return; } else if (!Userdata) { //å¦‚æœæ²¡æœ‰data,åˆå§‹åŒ– Userdata = {}; } //å°†å‡½æ•°åèµ‹å€¼ç»™userdataçš„å›è°ƒå‡½æ•°å±æ€§ä¸­ Userdata.callback = jsonId.funId; for (let key in Userdata) { Userurl = this.jointUrl(Userurl, key, Userdata[key]) } let script = document.createElement(\u0026#39;script\u0026#39;); script.setAttribute(\u0026#34;id\u0026#34; , jsonId.funId); script.setAttribute(\u0026#34;src\u0026#34; , Userurl); //åŠ¨æ€ç”Ÿæˆå‡½æ•° let callback=function (result) { console.log(\u0026#34;xxxxxxx\u0026#34;) //ä¸šåŠ¡é€»è¾‘å›è°ƒ if (options.callback){ try { options.callback(result) }catch (e) { this.err(e.message) } } //å–„å let tmp=document.getElementById(jsonId.funId) tmp.parentNode.removeChild(tmp); eval(jsonId.funId+\u0026#39;=null\u0026#39;) } eval(\u0026#34;window.\u0026#34;+jsonId.funId+\u0026#34;=function(result){ callback(result) }\u0026#34;) document.head.appendChild(script) } \u0026lt;/script\u0026gt; CORS CORS - Cross-Origin Resource Sharing ï¼Œè·¨åŸŸèµ„æºå…±äº«ã€‚CORS æ˜¯å®˜æ–¹çš„è·¨åŸŸè§£å†³æ–¹æ¡ˆï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ä¸éœ€è¦åœ¨å®¢æˆ·ç«¯åšä»»ä½•ç‰¹æ®Šçš„æ“ä½œï¼Œè€Œæ˜¯å®Œå…¨åœ¨æœåŠ¡å™¨ä¸­è¿›è¡Œå¤„ç†ï¼Œæ”¯æŒ GET å’Œ POST è¯·æ±‚ã€‚è·¨åŸŸèµ„æºå…±äº«æ ‡å‡†æ–°å¢äº†ä¸€ç»„ HTTP é¦–éƒ¨å­—æ®µï¼Œå…è®¸æœåŠ¡å™¨å£°æ˜å“ªäº›æºç«™é€šè¿‡æµè§ˆå™¨æœ‰æƒé™è®¿é—®å“ªäº›èµ„æºã€‚\nCORS æ˜¯é€šè¿‡è®¾ç½®ä¸€ä¸ª å“åº”å¤´ æ¥å‘Šè¯‰æµè§ˆå™¨ï¼Œè¯¥è¯·æ±‚ å…è®¸è·¨åŸŸ ï¼Œæµè§ˆå™¨æ”¶åˆ°è¯¥å“åº”ä»¥åå°±ä¼šå¯¹å“åº”æ”¾è¡Œã€‚\nImg ","date":"2023-03-20","section":"techs","summary":"Network ç½‘ç»œç¼–ç¨‹çš„æœ¬è´¨æ˜¯å¤šå°è®¡ç®—æœºä¹‹é—´çš„ æ•°æ®äº¤æ¢ ã€‚æ•°æ®ä¼ é€’æœ¬èº«æ²¡æœ‰å¤šå¤§çš„éš¾åº¦ï¼Œä¸å°±æ˜¯æŠŠä¸€ä¸ªè®¾å¤‡ä¸­çš„æ•°æ®å‘é€ç»™å…¶ä»–è®¾å¤‡ï¼Œç„¶åæ¥å—å¦å¤–ä¸€ä¸ªè®¾å¤‡åé¦ˆçš„æ•°æ®ã€‚ç°åœ¨çš„ç½‘ç»œç¼–ç¨‹åŸºæœ¬ä¸Šéƒ½æ˜¯åŸºäº è¯·æ±‚/å“åº” æ–¹å¼çš„ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªè®¾å¤‡å‘é€è¯·æ±‚æ•°æ®ç»™å¦å¤–ä¸€ä¸ªï¼Œç„¶åæ¥æ”¶å¦ä¸€ä¸ªè®¾å¤‡çš„åé¦ˆã€‚\nåœ¨ç½‘ç»œç¼–ç¨‹ä¸­ï¼Œå‘èµ·è¿æ¥ç¨‹åºï¼Œä¹Ÿå°±æ˜¯å‘é€ç¬¬ä¸€æ¬¡è¯·æ±‚çš„ç¨‹åºï¼Œè¢«ç§°ä½œ å®¢æˆ·ç«¯^Client^ï¼Œç­‰å¾…å…¶ä»–ç¨‹åºè¿æ¥çš„ç¨‹åºè¢«ç§°ä½œ æœåŠ¡å™¨^Server^ã€‚å®¢æˆ·ç«¯ç¨‹åºå¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™å¯åŠ¨ï¼Œè€ŒæœåŠ¡å™¨ä¸ºäº†èƒ½å¤Ÿæ—¶åˆ»ç›¸åº”è¿æ¥ï¼Œåˆ™éœ€è¦ä¸€ç›´å¯åŠ¨ã€‚\nä¾‹å¦‚ä»¥æ‰“ç”µè¯ä¸ºä¾‹ï¼Œé¦–å…ˆæ‹¨å·çš„äººç±»ä¼¼äºå®¢æˆ·ç«¯ï¼Œæ¥å¬ç”µè¯çš„äººå¿…é¡»ä¿æŒç”µè¯ç•…é€šç±»ä¼¼äºæœåŠ¡å™¨ã€‚è¿æ¥ä¸€æ—¦å»ºç«‹ä»¥åï¼Œå°±å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯å°±å¯ä»¥è¿›è¡Œæ•°æ®ä¼ é€’äº†ï¼Œè€Œä¸”ä¸¤è€…çš„èº«ä»½æ˜¯ç­‰ä»·çš„ã€‚åœ¨ä¸€äº›ç¨‹åºä¸­ï¼Œç¨‹åºæ—¢æœ‰å®¢æˆ·ç«¯åŠŸèƒ½ä¹Ÿæœ‰æœåŠ¡å™¨ç«¯åŠŸèƒ½ï¼Œæœ€å¸¸è§çš„è½¯ä»¶å°±æ˜¯ QQ ã€å¾®ä¿¡è¿™ç±»è½¯ä»¶äº†ã€‚\nğŸ“ Note ç½‘ç»œç¼–ç¨‹ä¸­ä¸¤ä¸ªä¸»è¦çš„é—®é¢˜\nä¸€ä¸ªæ˜¯å¦‚ä½•å‡†ç¡®çš„å®šä½ç½‘ç»œä¸Šä¸€å°æˆ–å¤šå°ä¸»æœºï¼Œ å¦ä¸€ä¸ªå°±æ˜¯æ‰¾åˆ°ä¸»æœºåå¦‚ä½•å¯é é«˜æ•ˆçš„è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚ åœ¨ TCP/IP åè®®ä¸­ [IP å±‚] ä¸»è¦è´Ÿè´£ç½‘ç»œä¸»æœºçš„å®šä½ï¼Œæ•°æ®ä¼ è¾“çš„è·¯ç”±ï¼Œç”±IPåœ°å€å¯ä»¥å”¯ä¸€åœ°ç¡®å®š Internet ä¸Šçš„ä¸€å°ä¸»æœºã€‚\nè€Œ TCP å±‚åˆ™æä¾›é¢å‘åº”ç”¨çš„ å¯é ^TCP^çš„æˆ– éå¯é ^UDP^ çš„æ•°æ®ä¼ è¾“æœºåˆ¶ï¼Œè¿™æ˜¯ç½‘ç»œç¼–ç¨‹çš„ä¸»è¦å¯¹è±¡ï¼Œä¸€èˆ¬ä¸éœ€è¦å…³å¿ƒ [IP å±‚] æ˜¯å¦‚ä½•å¤„ç†æ•°æ®çš„ã€‚\nç›®å‰è¾ƒä¸ºæµè¡Œçš„ç½‘ç»œç¼–ç¨‹æ¨¡å‹æ˜¯ å®¢æˆ·æœº/æœåŠ¡å™¨ï¼ˆC/Sï¼‰ç»“æ„ã€‚å³é€šä¿¡åŒæ–¹ä¸€æ–¹ä½œä¸ºæœåŠ¡å™¨ç­‰å¾…å®¢æˆ·æå‡ºè¯·æ±‚å¹¶äºˆä»¥å“åº”ã€‚å®¢æˆ·åˆ™åœ¨éœ€è¦æœåŠ¡æ—¶å‘æœåŠ¡å™¨æå‡ºç”³è¯·ã€‚æœåŠ¡å™¨ä¸€èˆ¬ä½œä¸º å®ˆæŠ¤è¿›ç¨‹^daemon^ å§‹ç»ˆè¿è¡Œï¼Œç›‘å¬ç½‘ç»œç«¯å£ï¼Œä¸€æ—¦æœ‰å®¢æˆ·è¯·æ±‚ï¼Œå°±ä¼šå¯åŠ¨ä¸€ä¸ªæœåŠ¡è¿›ç¨‹æ¥å“åº”è¯¥å®¢æˆ·ï¼ŒåŒæ—¶è‡ªå·±ç»§ç»­ç›‘å¬æœåŠ¡ç«¯å£ï¼Œä½¿åæ¥çš„å®¢æˆ·ä¹Ÿèƒ½åŠæ—¶å¾—åˆ°æœåŠ¡ã€‚\nç½‘ç»œåè®®æ˜¯ä»€ä¹ˆ\nåœ¨è®¡ç®—æœºç½‘ç»œè¦åšåˆ°äº•äº•æœ‰æ¡çš„äº¤æ¢æ•°æ®ï¼Œå°±å¿…é¡»éµå®ˆä¸€äº›äº‹å…ˆçº¦å®šå¥½çš„è§„åˆ™ï¼Œæ¯”å¦‚äº¤æ¢æ•°æ®çš„æ ¼å¼ã€æ˜¯å¦éœ€è¦å‘é€ä¸€ä¸ªåº”ç­”ä¿¡æ¯ã€‚è¿™äº›è§„åˆ™è¢«ç§°ä¸ºç½‘ç»œåè®®ã€‚ ä¸ºä»€ä¹ˆè¦å¯¹ç½‘ç»œåè®®åˆ†å±‚\nç®€åŒ–é—®é¢˜éš¾åº¦å’Œå¤æ‚åº¦ã€‚ç”±äºå„å±‚ä¹‹é—´ç‹¬ç«‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†å‰²å¤§é—®é¢˜ä¸ºå°é—®é¢˜ã€‚ çµæ´»æ€§å¥½ã€‚å½“å…¶ä¸­ä¸€å±‚çš„æŠ€æœ¯å˜åŒ–æ—¶ï¼Œåªè¦å±‚é—´æ¥å£å…³ç³»ä¿æŒä¸å˜ï¼Œå…¶ä»–å±‚ä¸å—å½±å“ã€‚ æ˜“äºå®ç°å’Œç»´æŠ¤ã€‚ ä¿ƒè¿›æ ‡å‡†åŒ–å·¥ä½œã€‚åˆ†å¼€åï¼Œæ¯å±‚åŠŸèƒ½å¯ä»¥ç›¸å¯¹ç®€å•åœ°è¢«æè¿° OSI OSI - Open System Interconnectï¼Œå³å¼€æ”¾å¼ç³»ç»Ÿäº’è”ã€‚ä¸€èˆ¬éƒ½å« OSI å‚è€ƒæ¨¡å‹ï¼Œæ˜¯ ISO^å›½é™…æ ‡å‡†åŒ–ç»„ç»‡^ åœ¨ 1985 å¹´ç ”ç©¶çš„ç½‘ç»œäº’è¿æ¨¡å‹ã€‚ISO ä¸ºäº†æ›´å¥½çš„ä½¿ç½‘ç»œåº”ç”¨æ›´ä¸ºæ™®åŠï¼Œæ¨å‡ºäº† OSI å‚è€ƒæ¨¡å‹ï¼Œè¿™æ ·æ‰€æœ‰çš„å…¬å¸éƒ½æŒ‰ç…§ç»Ÿä¸€çš„æ ‡å‡†æ¥æŒ‡å®šè‡ªå·±çš„ç½‘ç»œï¼Œå°±å¯ä»¥äº’é€šäº’è”äº†ã€‚\nç½‘ç»œåè®®é€šè¿‡ åˆ†å±‚ æ¥æ˜ç¡®å„å±‚å·¥ä½œèŒè´£ï¼Œé€šè¿‡å®šä¹‰æ˜ç¡®çš„æ¥å£æ¥ååŒå·¥ä½œï¼Œç¬¬ä¸€å±‚éƒ½å¯ä»¥ä½¿ç”¨ä¸‹é¢å„å±‚çš„åŠŸèƒ½ï¼Œè€Œä¸ç”¨æ‹…å¿ƒå„å±‚æ˜¯æ€ä¹ˆå®ç°çš„ã€‚å°±å¥½åƒæˆ‘ä»¬å¼€å‘å°è£…ç»„ä»¶ä¸€æ ·ï¼Œæ¯ä¸€ä¸ªç»„ä»¶å„è‡ªè´Ÿè´£å„è‡ªçš„äº‹ï¼Œäº’ä¸å¹²æ‰°ï¼Œä¹Ÿæé«˜äº†å¤ç”¨åº¦ã€‚æ ‡å‡†æ¨¡å‹ä¸º OSI ä¸ƒå±‚ç½‘ç»œæ¨¡å‹ï¼ŒåŒ…æ‹¬ï¼š\nç‰©ç†å±‚1. Physical, é“¾è·¯å±‚2. Data link, ç½‘ç»œå±‚3. Network, ä¼ è¾“å±‚4. Transport, ä¼šè¯å±‚5. Session, è¡¨ç¤ºå±‚6. Presentation, åº”ç”¨å±‚7. Application\n","title":"09 NetWork","url":"/techs/09-network/"},{"content":"Node Node.js ç”±å¤©æ‰ç¨‹åºå‘˜ Ryan Dahl åˆ›å»ºï¼Œå‰”é™¤äº†æµè§ˆå™¨ä¸­çš„ WebKit å¸ƒå±€å¼•æ“å’Œ WebAPI ï¼Œæ‰“ç ´äº†è¿‡å» JavaScript åªèƒ½åœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„å±€é¢ï¼Œå…·æœ‰ äº‹ä»¶é©±åŠ¨event driven å’Œ éé˜»å¡*^non-blocking^* I/O çš„ç‰¹ç‚¹ï¼Œæ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript åç«¯è¿è¡Œç¯å¢ƒã€‚Node ä»…ä»…æä¾›äº†åŸºç¡€çš„åŠŸèƒ½å’Œ API ï¼Œæ— æ³•è°ƒç”¨ DOM å’Œ BOM ç­‰æµè§ˆå™¨å†…ç½® API ï¼Œä½†å¯ä»¥é€šè¿‡ NPM åŒ…ç®¡ç†å™¨è¿›è¡Œæ‹“å±•ã€‚\n:link: Href å®˜ç½‘åœ°å€ï¼šnodejs.org\nç‰¹ç‚¹*^Characteristic^* ä¸åŒçš„æµè§ˆå™¨ä½¿ç”¨ä¸åŒçš„ JavaScript è§£æå¼•æ“ï¼š\nGoogle âŸ¹ V8 FireFox âŸ¹ SpiderMonkey Safari âŸ¹ JavaScriptCore Internet Explorer âŸ¹ Chakra è¿è¡Œç¯å¢ƒæ˜¯æŒ‡ä»£ç æ­£å¸¸è¿è¡Œæ‰€éœ€çš„å¿…è¦ç¯å¢ƒï¼Œä»¥ä¸‹ä¸º Chrome æµè§ˆå™¨çš„è¿è¡Œç¯å¢ƒï¼š\nV8 å¼•æ“è´Ÿè´£è§£æå’Œæ‰§è¡Œ JavaScript ä»£ç  å†…ç½® API æ˜¯ç”±è¿è¡Œç¯å¢ƒæä¾›çš„ç‰¹æ®Šæ¥å£ï¼Œåªèƒ½åœ¨æ‰€å±çš„è¿è¡Œç¯å¢ƒä¸­è¢«è°ƒç”¨ å¼‚æ­¥ ç†Ÿæ‚‰å¼‚æ­¥çš„ç”¨æˆ·å¿…ç„¶çŸ¥é“ï¼Œæˆ‘ä»¬åªçŸ¥é“å›è°ƒå‡½æ•°å°†åœ¨è¿™ä¸ªå¼‚æ­¥è¯·æ±‚ç»“æŸåæ‰§è¡Œï¼Œä½†å¹¶ä¸çŸ¥é“å…·ä½“çš„æ—¶é—´ç‚¹ã€‚å¼‚æ­¥è°ƒç”¨ä¸­å¯¹äºç»“æœå€¼çš„æ•è·æ˜¯ç¬¦åˆ \u0026ldquo;Don\u0026rsquo;t call me, I will call you\u0026rdquo; çš„åŸåˆ™çš„ï¼Œè¿™ä¹Ÿæ˜¯æ³¨é‡ç»“æœï¼Œä¸å…³å¿ƒè¿‡ç¨‹çš„ä¸€ç§è¡¨ç°ã€‚\nåœ¨ Node ä¸­ï¼Œç»å¤§å¤šæ•°çš„æ“ä½œéƒ½ä»¥ å¼‚æ­¥*^asynchronous^* çš„æ–¹å¼è¿›è¡Œè°ƒç”¨ï¼Œä»æ–‡ä»¶è¯»å–åˆ°ç½‘ç»œè¯·æ±‚ç­‰ï¼Œå‡æ˜¯å¦‚æ­¤ã€‚è¿™æ ·çš„æ„ä¹‰åœ¨äºï¼Œåœ¨ Node ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä»è¯­è¨€å±‚é¢å¾ˆè‡ªç„¶åœ°è¿›è¡Œå¹¶è¡Œ I/O æ“ä½œã€‚æ¯ä¸ªè°ƒç”¨ä¹‹é—´æ— é¡»ç­‰å¾…ä¹‹å‰çš„ I/O è°ƒç”¨ç»“æŸã€‚åœ¨ç¼–ç¨‹æ¨¡å‹ä¸Šå¯ä»¥æå¤§æå‡æ•ˆç‡ã€‚\nä¸‹é¢çš„ä¸¤ä¸ªæ–‡ä»¶è¯»å–ä»»åŠ¡çš„è€—æ—¶å–å†³äºæœ€æ…¢çš„é‚£ä¸ªæ–‡ä»¶è¯»å–çš„è€—æ—¶ï¼š\nfs.readFile(\u0026#39;/path1\u0026#39;, function (err, file) { console.log(\u0026#39;è¯»å–æ–‡ä»¶1å®Œæˆ\u0026#39;); }); fs.readFile(\u0026#39;/path2\u0026#39;, function (err, file) { console.log(\u0026#39;è¯»å–æ–‡ä»¶2å®Œæˆ\u0026#39;); }); è€Œå¯¹äº åŒæ­¥*^synchronous^* I/O è€Œè¨€ï¼Œå®ƒä»¬çš„è€—æ—¶æ˜¯ä¸¤ä¸ªä»»åŠ¡çš„è€—æ—¶ä¹‹å’Œã€‚è¿™é‡Œå¼‚æ­¥å¸¦æ¥çš„ä¼˜åŠ¿æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚\nå•çº¿ç¨‹ Node ä¿æŒäº† JavaScript åœ¨æµè§ˆå™¨ä¸­å•çº¿ç¨‹çš„ç‰¹ç‚¹ã€‚è€Œä¸”åœ¨ Node ä¸­ï¼Œ JavaScript ä¸å…¶ä½™çº¿ç¨‹æ˜¯æ— æ³•å…±äº«ä»»ä½•çŠ¶æ€çš„ã€‚å•çº¿ç¨‹çš„æœ€å¤§å¥½å¤„æ˜¯ä¸ç”¨åƒå¤šçº¿ç¨‹ç¼–ç¨‹é‚£æ ·å¤„å¤„åœ¨æ„çŠ¶æ€çš„åŒæ­¥é—®é¢˜ï¼Œè¿™é‡Œæ²¡æœ‰æ­»é”çš„å­˜åœ¨ï¼Œä¹Ÿæ²¡æœ‰çº¿ç¨‹ä¸Šä¸‹æ–‡äº¤æ¢æ‰€å¸¦æ¥çš„æ€§èƒ½ä¸Šçš„å¼€é”€ã€‚\nåŒæ ·ï¼Œå•çº¿ç¨‹ä¹Ÿæœ‰ä¸€ä¸‹å¼±ç‚¹ï¼š\næ— æ³•åˆ©ç”¨å¤šæ ¸ CPU é”™è¯¯ä¼šå¼•èµ·æ•´ä¸ªåº”ç”¨é€€å‡ºï¼Œåº”ç”¨çš„å¥å£®æ€§å€¼å¾—è€ƒéªŒã€‚ å¤§é‡è®¡ç®—å ç”¨ CPU å¯¼è‡´æ— æ³•ç»§ç»­è°ƒç”¨å¼‚æ­¥ I/O åƒæµè§ˆå™¨ä¸­ JavaScript ä¸ UI å…±ç”¨ä¸€ä¸ªçº¿ç¨‹ä¸€æ ·ï¼ŒJavaScript é•¿æ—¶é—´æ‰§è¡Œä¼šå¯¼è‡´ UI çš„æ¸²æŸ“å’Œå“åº”è¢«ä¸­æ–­ï¼ŒNode ä¸­ä¹Ÿæ˜¯åŒç†ã€‚\nHTML5 çš„ Web Workers èƒ½å¤Ÿåˆ›å»ºå·¥ä½œçº¿ç¨‹æ¥è¿›è¡Œè®¡ç®—ï¼Œä»¥è§£å†³ JavaScript å¤§è®¡ç®—é˜»å¡ UI æ¸²æŸ“çš„é—®é¢˜ã€‚ä¸è¿‡å·¥ä½œçº¿ç¨‹ä¸èƒ½è®¿é—®åˆ°ä¸»çº¿ç¨‹ä¸­çš„ UI ã€‚\nNode é‡‡ç”¨äº†ä¸ Web Workers ç›¸åŒçš„æ€è·¯æ¥è§£å†³å•çº¿ç¨‹ä¸­å¤§è®¡ç®—é‡çš„é—®é¢˜ï¼šå­è¿›ç¨‹*^child_process^* ã€‚é€šè¿‡å°†è®¡ç®—åˆ†å‘åˆ°å„ä¸ªå­è¿›ç¨‹ï¼Œå¯ä»¥å°†å¤§é‡è®¡ç®—åˆ†è§£æ‰ï¼Œç„¶åå†é€šè¿‡è¿›ç¨‹ä¹‹é—´çš„ äº‹ä»¶æ¶ˆæ¯*^event^* æ¥ä¼ é€’ç»“æœï¼Œè¿™å¯ä»¥å¾ˆå¥½åœ°ä¿æŒåº”ç”¨æ¨¡å‹çš„ç®€å•å’Œä½ä¾èµ–ã€‚\nè·¨å¹³å° å…¼å®¹ä¸åŒå¹³å°ä¸»è¦å¾—ç›Šäº Node åœ¨æ¶æ„å±‚é¢çš„æ”¹åŠ¨ï¼Œå®ƒåœ¨æ“ä½œç³»ç»Ÿä¸ Node ä¸Šå±‚æ¨¡å—ç³»ç»Ÿä¹‹é—´æ„å»ºäº†ä¸€å±‚å¹³å°å±‚æ¶æ„ï¼Œå³ libuv ã€‚C/C++ æ¨¡å—ä¹Ÿå¯ä»¥é€šè¿‡æ­¤ç§æ–¹å¼å®ç°è·¨å¹³å°çš„å…¼å®¹ã€‚\nI/O å¯†é›† Node é¢å‘ç½‘ç»œä¸”æ“…é•¿å¹¶è¡Œ I/O ï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°ç»„ç»‡èµ·æ›´å¤šçš„ç¡¬ä»¶èµ„æºï¼Œä»è€Œæä¾›æ›´å¤šå¥½çš„æœåŠ¡ï¼›I/O å¯†é›†çš„ä¼˜åŠ¿ä¸»è¦åœ¨äº Node åˆ©ç”¨äº‹ä»¶å¾ªç¯çš„å¤„ç†èƒ½åŠ›ï¼Œè€Œä¸æ˜¯å¯åŠ¨æ¯ä¸€ä¸ªçº¿ç¨‹ä¸ºæ¯ä¸€ä¸ªè¯·æ±‚æœåŠ¡ï¼Œèµ„æºå ç”¨æå°‘ã€‚\nå¦ä¸€æ–¹é¢ï¼ŒNode åˆå¯ä»¥é€šè¿‡ C/C++ æ‰©å±•æ¥å®ç°è®¡ç®—å¯†é›†å‹ä»»åŠ¡ã€‚è¿˜å¯ä»¥é€šè¿‡å­è¿›ç¨‹ï¼Œè®²ä¸€éƒ¨åˆ† Node è¿›ç¨‹ç”¨ä½œå¸¸é©»æœåŠ¡ç”¨äºè®¡ç®—ï¼Œå†åˆ©ç”¨è¿›ç¨‹é—´çš„æ¶ˆæ¯ä¼ é€’æ¥ä¼ é€’ç»“æœï¼Œåˆ†ç¦»è®¡ç®—ä¸ I/O ï¼Œä»¥åˆ©ç”¨å¤š CPU çš„ä¼˜åŠ¿ã€‚\nå®‰è£… å¦‚æœå¸Œæœ›é€šè¿‡ Node.js æ¥è¿è¡Œ JavaScript ä»£ç ï¼Œåˆ™å¿…é¡»åœ¨è®¡ç®—æœºä¸Šå®‰è£… Node.js ç¯å¢ƒæ‰è¡Œã€‚\nå®‰è£…åŒ…å¯ä»¥ä» Node.js çš„å®˜ç½‘é¦–é¡µç›´æ¥ä¸‹è½½ï¼Œè¿›å…¥åˆ° Node.js çš„å®˜ç½‘é¦–é¡µ ï¼Œä¸‹è½½æ‰€éœ€çš„ç‰ˆæœ¬åï¼ŒåŒå‡»ç›´æ¥å®‰è£…å³å¯ã€‚\nLTS long-time service ä¸ºé•¿æœŸç¨³å®šç‰ˆï¼Œå¯¹äºè¿½æ±‚ç¨³å®šæ€§çš„ä¼ä¸šçº§é¡¹ç›®æ¥è¯´ï¼Œæ¨èå®‰è£… LTS ç‰ˆæœ¬çš„ Node.js ã€‚ æŸ¥çœ‹å·²å®‰è£…çš„ Node.js çš„ç‰ˆæœ¬å·ï¼Œç»ˆç«¯è¾“å…¥å‘½ä»¤ node â€“v åœ¨ Node.js ç¯å¢ƒä¸­æ‰§è¡Œ JavaScript ä»£ç ï¼Œç»ˆç«¯è¾“å…¥ Node è¦æ‰§è¡Œçš„ js æ–‡ä»¶çš„è·¯å¾„ æ¨¡å—åŒ–*^Modular^* JavaScript ä¸æ–­è¢«ç±»èšå’ŒæŠ½è±¡ï¼Œä»¥æ›´å¥½åœ°ç»„ç»‡ä¸šåŠ¡é€»è¾‘ã€‚ä»å¦ä¸€ä¸ªè§’åº¦è€Œè¨€ï¼Œå®ƒä¹Ÿé“å‡ºäº† JavaScript å…ˆå¤©å°±ç¼ºä¹çš„ä¸€é¡¹åŠŸèƒ½ï¼šæ¨¡å—ã€‚\næ¨¡å—åŒ– æŒ‡çš„æ˜¯è§£å†³ä¸€ä¸ªå¤æ‚é—®é¢˜æ—¶ï¼Œè‡ªé¡¶å‘ä¸‹é€å±‚æŠŠç³»ç»Ÿåˆ’åˆ†ä¸ºè‹¥å¹²æ¨¡å—çš„è¿‡ç¨‹ã€‚å¯¹äºæ•´ä¸ªç³»ç»Ÿæ¥è¯´ï¼Œæ¨¡å—æ˜¯å¯ ç»„åˆã€åˆ†è§£ã€æ›´æ¢ çš„å•å…ƒã€‚ç¼–ç¨‹ä¸­çš„æ¨¡å—åŒ–åˆ™æ˜¯éµå®ˆå›ºå®šçš„è§„åˆ™ï¼ŒæŠŠä¸€ä¸ªå¤§æ–‡ä»¶æ‹†åˆ†æˆç‹¬ç«‹å¹¶ä¸”äº’ç›¸ä¾èµ–çš„å¤šä¸ªå°æ¨¡å—ã€‚\nå¥½å¤„ï¼š\næé«˜ä»£ç çš„ å¤ç”¨æ€§ æé«˜ä»£ç çš„ å¯ç»´æŠ¤æ€§ å¯ä»¥å®ç° æŒ‰éœ€åŠ è½½ Node.js ä¸­æ ¹æ®æ¨¡å—æ¥æºçš„ä¸åŒï¼Œå°†æ¨¡å—åˆ†ä¸º 3 å¤§ç±»ï¼š\nå†…ç½®æ¨¡å—ï¼šç”± Node å®˜æ–¹æä¾›ï¼Œä¾‹å¦‚ fs, path, http è‡ªå®šä¹‰æ¨¡å—ï¼šç”¨æˆ·åˆ›å»ºçš„æ¯ä¸ª .js/.ts æ–‡ä»¶ ç¬¬ä¸‰æ–¹æ¨¡å—ï¼šç”±ç¬¬ä¸‰æ–¹å¼€å‘å‡ºæ¥çš„æ¨¡å—ï¼Œä½¿ç”¨å‰éœ€å…ˆä¸‹è½½ æ¨¡å—ä½œç”¨åŸŸ\nå’Œ å‡½æ•°ä½œç”¨åŸŸ ç±»ä¼¼ï¼Œåœ¨è‡ªå®šä¹‰æ¨¡å—ä¸­å®šä¹‰çš„å˜é‡ã€æ–¹æ³•ç­‰æˆå‘˜ï¼Œæ™ºèƒ½åœ¨å½“å‰æ¨¡å—ä¸­è¢«è®¿é—®ï¼Œè¿™ç§æ¨¡å—çº§åˆ«çš„è®¿é—®é™åˆ¶ï¼Œå«åš æ¨¡å—ä½œç”¨åŸŸ ã€‚\nå†…ç½® Node å†…ç½®äº†ä¸€äº›æ¨¡å—ï¼ŒåŒ…æ‹¬ fs, path, http ç­‰ã€‚\nfs^æ–‡ä»¶æ§åˆ¶^ ä»€ä¹ˆæ˜¯ fs æ–‡ä»¶ç³»ç»Ÿæ¨¡å— fs æ¨¡å—æ˜¯ Node.js å®˜æ–¹æä¾›çš„ã€ç”¨æ¥æ“ä½œæ–‡ä»¶çš„æ¨¡å—ã€‚æä¾›äº†ä¸€ç³»åˆ—çš„æ–¹æ³•å’Œå±æ€§ï¼Œç”¨æ¥æ»¡è¶³å¯¹æ–‡ä»¶çš„æ“ä½œéœ€æ±‚\nå¦‚æœè¦åœ¨ JavaScript ä»£ç ä¸­ï¼Œä½¿ç”¨ fs æ¨¡å—æ¥æ“ä½œæ–‡ä»¶ï¼Œåˆ™éœ€è¦ä½¿ç”¨å¦‚ä¸‹çš„æ–¹å¼å…ˆå¯¼å…¥å®ƒï¼š\nconst fs = require(\u0026#34;fs\u0026#34;) // commonjs import * as fs from \u0026#39;fs\u0026#39; // es module readFile() fs.readFile(path[, options], callback) è¯»å–æŒ‡å®šæ–‡ä»¶ä¸­çš„å†…å®¹\npath\tå¿…é€‰å‚æ•°ï¼Œå­—ç¬¦ä¸²ï¼Œæ–‡ä»¶è·¯å¾„ option\tå¯é€‰å‚æ•°ï¼Œè®¾ç½®å­—ç¬¦é›† callback\tå¿…é€‰å‚æ•°ï¼Œæ–‡ä»¶è¯»å–å®Œæˆåçš„å›è°ƒå‡½æ•° // 1. å¯¼å…¥ fs æ¨¡å—ï¼Œæ¥æ“ä½œæ–‡ä»¶ const fs = require(\u0026#39;fs\u0026#39;) // 2. è°ƒç”¨ fs.readFile() æ–¹æ³•è¯»å–æ–‡ä»¶ // å‚æ•°1ï¼šè¯»å–æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ // å‚æ•°2ï¼šè¯»å–æ–‡ä»¶æ—¶å€™é‡‡ç”¨çš„ç¼–ç æ ¼å¼ï¼Œä¸€èˆ¬é»˜è®¤æŒ‡å®š utf8 // å‚æ•°3ï¼šå›è°ƒå‡½æ•°ï¼Œæ‹¿åˆ°è¯»å–å¤±è´¥å’ŒæˆåŠŸçš„ç»“æœ err dataStr fs.readFile(\u0026#39;./files/1.txt\u0026#39;, \u0026#39;utf8\u0026#39;, function(err, dataStr) { // 2.1 æ‰“å°å¤±è´¥çš„ç»“æœ // å¦‚æœè¯»å–æˆåŠŸï¼Œåˆ™ err çš„å€¼ä¸º null // å¦‚æœè¯»å–å¤±è´¥ï¼Œåˆ™ err çš„å€¼ä¸º é”™è¯¯å¯¹è±¡ï¼ŒdataStr çš„å€¼ä¸º undefined console.log(err) console.log(\u0026#39;-------\u0026#39;) // 2.2 æ‰“å°æˆåŠŸçš„ç»“æœ console.log(dataStr) }) fs.readFile(\u0026#39;./files/11.txt\u0026#39;, \u0026#39;utf8\u0026#39;, function(err, dataStr) { if (err) { return console.log(\u0026#39;è¯»å–æ–‡ä»¶å¤±è´¥ï¼\u0026#39; + err.message) } console.log(\u0026#39;è¯»å–æ–‡ä»¶æˆåŠŸï¼\u0026#39; + dataStr) }) writeFile() fs.writeFile(path, data[, option], callback) å‘æŒ‡å®šçš„æ–‡ä»¶ä¸­å†™å…¥å†…å®¹\npath\tå¿…é€‰å‚æ•°ï¼Œå­—ç¬¦ä¸²ï¼Œæ–‡ä»¶è·¯å¾„ data\tå¿…é€‰å‚æ•°ï¼Œå†™å…¥çš„å†…å®¹ option\tå¯é€‰å‚æ•°ï¼Œè®¾ç½®å­—ç¬¦é›†ï¼Œé»˜è®¤å€¼æ˜¯ utf8 callback\tå¿…é€‰å‚æ•°ï¼Œæ–‡ä»¶å†™å…¥å®Œæˆåçš„å›è°ƒå‡½æ•° :warning: Caution å†™å…¥ä¼šè¦†ç›–åŸå†…å®¹\nconst fs = require(\u0026#39;fs\u0026#39;) // 2. è°ƒç”¨ fs.writeFile() æ–¹æ³•ï¼Œå†™å…¥æ–‡ä»¶çš„å†…å®¹ // å‚æ•°1ï¼šè¡¨ç¤ºæ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ // å‚æ•°2ï¼šè¡¨ç¤ºè¦å†™å…¥çš„å†…å®¹ // å‚æ•°3ï¼šå›è°ƒå‡½æ•° fs.writeFile(\u0026#39;./files/3.txt\u0026#39;, \u0026#39;ok123\u0026#39;, function(err) { // 2.1 å¦‚æœæ–‡ä»¶å†™å…¥æˆåŠŸï¼Œåˆ™ err çš„å€¼ç­‰äº null // 2.2 å¦‚æœæ–‡ä»¶å†™å…¥å¤±è´¥ï¼Œåˆ™ err çš„å€¼ç­‰äºä¸€ä¸ª é”™è¯¯å¯¹è±¡ // console.log(err) if (err) { return console.log(\u0026#39;æ–‡ä»¶å†™å…¥å¤±è´¥ï¼\u0026#39; + err.message) } console.log(\u0026#39;æ–‡ä»¶å†™å…¥æˆåŠŸï¼\u0026#39;) }) __dirname è¡¨ç¤ºå½“å‰æ–‡ä»¶æ‰€å¤„çš„ç›®å½•\nconsole.log(__dirname); fs.readFile(__dirname + \u0026#39;/files/1.txt\u0026#39;, \u0026#39;utf8\u0026#39;, function(err, dataStr) { if (err) { return console.log(\u0026#39;è¯»å–æ–‡ä»¶å¤±è´¥ï¼\u0026#39; + err.message); } console.log(\u0026#39;è¯»å–æ–‡ä»¶æˆåŠŸï¼\u0026#39; + dataStr); }) æ˜“é”™ âš ï¸ Caution ä½¿ç”¨ fs æ¨¡å—æ“ä½œæ–‡ä»¶æ—¶ï¼Œå¦‚æœæä¾›çš„æ“ä½œè·¯å¾„æ˜¯ä»¥ ./ æˆ– ../ å¼€å¤´çš„ç›¸å¯¹è·¯å¾„æ—¶ï¼Œå¾ˆå®¹æ˜“å‡ºç°è·¯å¾„åŠ¨æ€æ‹¼æ¥é”™è¯¯çš„é—®é¢˜ã€‚\nåŸå› æ˜¯ä»£ç åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œæœ€å…ˆè®¿é—®çš„æ˜¯ node å‘½ä»¤æ‰€å¤„çš„ç›®å½•ï¼Œç„¶åå†åŠ¨æ€æ‹¼æ¥å‡ºè¢«æ“ä½œæ–‡ä»¶çš„å®Œæ•´åŠ¨æ€ã€‚\nğŸ§© Solution åœ¨ä½¿ç”¨ fs æ¨¡å—æ“ä½œæ–‡ä»¶æ—¶ï¼Œç›´æ¥æä¾›å®Œæ•´çš„è·¯å¾„ï¼Œä»è€Œé˜²æ­¢åŠ¨æ€æ‹¼æ¥é—®é¢˜ã€‚å¯¹äº\nimport * as fs from \u0026#39;fs\u0026#39; // è¯»å–æ–‡ä»¶å¤±è´¥ï¼ENOENT: no such file or directory, open \u0026#39;./files/11.txt\u0026#39; fs.readFile(\u0026#39;./files/11.txt\u0026#39;, \u0026#39;utf8\u0026#39;, function (err, dataStr) { if (err) { return console.log(\u0026#39;è¯»å–æ–‡ä»¶å¤±è´¥ï¼\u0026#39; + err.message) } console.log(\u0026#39;è¯»å–æ–‡ä»¶æˆåŠŸï¼\u0026#39; + dataStr) }) then-fs åŸºäº Node å®˜æ–¹æä¾›çš„ fs æ¨¡å—ä»…æ”¯æŒä»¥å›è°ƒå‡½æ•°çš„æ–¹å¼è¯»å–æ–‡ä»¶ï¼Œä¸æ”¯æŒ Promise çš„æ–¹å¼è°ƒç”¨æ–‡ä»¶ã€‚\nè°ƒç”¨ then-fs æä¾›çš„ readFile() æ–¹æ³•ï¼Œå¯ä»¥ï¼š\nimport thenFs from \u0026#39;then-fs\u0026#39; import fs from \u0026#39;fs\u0026#39; import {URL} from \u0026#39;url\u0026#39; const path = path=\u0026gt;new URL(path,import.meta.url) fs.readFile(path(\u0026#39;./files/1.txt\u0026#39;),\u0026#39;utf-8\u0026#39;,(err,res)=\u0026gt;{ console.log(res) // 111 }) thenFs.readFile(path(\u0026#39;./files/1.txt\u0026#39;), \u0026#39;utf8\u0026#39;).then((r1) =\u0026gt; {console.log(r1)}) // 111 thenFs.readFile(path(\u0026#39;./files/2.txt\u0026#39;), \u0026#39;utf8\u0026#39;).then((r2) =\u0026gt; {console.log(r2)}) // 222 thenFs.readFile(path(\u0026#39;./files/3.txt\u0026#39;), \u0026#39;utf8\u0026#39;).then((r3) =\u0026gt; {console.log(r3)}) // 333 âš ï¸ Caution ä¸Šè¿°ä»£ç æ— æ³•æ§åˆ¶è°ƒç”¨çš„é¡ºåºï¼Œéœ€è¦æ”¹è¿›\nğŸ“ Note å¦‚æœä¸Šä¸€ä¸ª .then() æ–¹æ³•ä¸­è¿”å›äº†ä¸€ä¸ªæ–°çš„ Promise ç¤ºä¾‹å¯¹è±¡ï¼Œåˆ™å¯ä»¥é€šè¿‡ä¸‹ä¸€ä¸ª .then() ç»§ç»­å¤„ç†ã€‚é€šè¿‡ .then() æ–¹æ³•çš„é“¾å¼è°ƒç”¨ï¼Œå°±è§£å†³äº†å›è°ƒåœ°ç‹±çš„é—®é¢˜ã€‚\nå¦‚æœä¸æƒ³å‰é¢çš„é”™è¯¯å¯¼è‡´åç»­çš„ .then() æ— æ³•ç»§ç»­æ‰§è¡Œï¼Œåˆ™å¯ä»¥å°† .catch() çš„è°ƒç”¨æå‰ã€‚\nimport thenFs from \u0026#39;then-fs\u0026#39; import path from \u0026#39;./path.js\u0026#39; thenFs .readFile(path(\u0026#39;./files/11.txt\u0026#39;), \u0026#39;utf8\u0026#39;) .catch((err) =\u0026gt; { console.log(err.message) }) .then((r1) =\u0026gt; { console.log(r1) return thenFs.readFile(path(\u0026#39;./files/2.txt\u0026#39;), \u0026#39;utf8\u0026#39;) }) .then((r2) =\u0026gt; { console.log(r2) return thenFs.readFile(path(\u0026#39;./files/3.txt\u0026#39;), \u0026#39;utf8\u0026#39;) }) .then((r3) =\u0026gt; { console.log(r3) }) ğŸ“ Note Promise çš„ then æ–¹æ³•å¯ä»¥è¯†åˆ«ä¸Šä¸€ä¸ª return è¿”å›çš„ Promise ï¼Œå¹¶ç­‰å¾…ç»“æœ\nğŸ”— Href [Promise çš„é“¾å¼è°ƒç”¨](06 EcmaScript B#Promise-then)\né‡‡ç”¨ é“¾å¼ çš„ then() ï¼Œå¯ä»¥æŒ‡å®šä¸€ç»„ æŒ‰ç…§æ¬¡åºè°ƒç”¨ çš„å›è°ƒå‡½æ•°ã€‚è¿™æ—¶ï¼Œå‰ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæœ‰å¯èƒ½è¿”å›çš„è¿˜æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼ˆå³æœ‰å¼‚æ­¥æ“ä½œï¼‰ï¼Œè¿™æ—¶åä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå°±ä¼šç­‰å¾…è¯¥ Promise å¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œæ‰ä¼šè¢«è°ƒç”¨ã€‚\nconst resolve = Promise.resolve(Promise.resolve(1)) console.log(resolve) // Promise { 1 } resolve.then(console.log) // 1 // NOTE: è‹¥ä¸Šä¸€ä¸ª Promise è¿”å›çš„è¿˜æ˜¯ Promiseï¼Œthen å°†ä¼šç­‰å¾…æ“ä½œç»“æœ å¯ä»¥ä½¿ç”¨ Promise.all æ–¹æ³•å‘èµ·å¹¶è¡Œçš„ Promise å¼‚æ­¥æ“ä½œï¼Œç­‰æ‰€æœ‰çš„å¼‚æ­¥æ“ä½œå…¨éƒ¨ç»“æŸåæ‰ä¼šæ‰§è¡Œä¸‹ä¸€æ­¥çš„ .then æ“ä½œï¼ˆç­‰å¾…æœºåˆ¶ï¼‰ã€‚\nconst promiseArr = [ thenFs.readFile(path(\u0026#39;./files/3.txt\u0026#39;), \u0026#39;utf8\u0026#39;), thenFs.readFile(path(\u0026#39;./files/2.txt\u0026#39;), \u0026#39;utf8\u0026#39;), thenFs.readFile(path(\u0026#39;./files/1.txt\u0026#39;), \u0026#39;utf8\u0026#39;) ] Promise.all(promiseArr).then(([r1, r2, r3]) =\u0026gt; console.log(r1, r2, r3)) // 333 222 111 // ç®€ç•¥å†™æ³•ï¼Œåªéœ€ä¼ å…¥å‡½æ•°æŒ‡é’ˆ Promise.all(promiseArr).then(console.log) // [ \u0026#39;333\u0026#39;, \u0026#39;222\u0026#39;, \u0026#39;111\u0026#39; ] Promise.race åˆ™æ˜¯åŒæ ·æ¥æ”¶æ•°ç»„ï¼Œä½†æœ‰ä¸€ä¸ª Promise å¾—åˆ°ç»“æœå³è¿”å›ï¼Œå› æ­¤å½“åŒæ—¶è°ƒç”¨ race å’Œ all ï¼Œrace æ–¹æ³•å°†é¦–å…ˆè¿”å›ã€‚\nPromise.race(promiseArr).then(console.log) // 333 å®ç° å¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ªåŸºäº Promise å¯¹è¯»æ–‡ä»¶è¿›è¡Œå°è£…çš„æ–¹æ³•ã€‚\næ–¹æ³•çš„å°è£…è¦æ±‚ï¼š\næ–¹æ³•çš„åç§°ä¸º getFile æ–¹æ³•æ¥å—ä¸€ä¸ªå½¢å‚ fpath ï¼Œè¡¨ç¤ºè¦å»è¯»å–æ–‡ä»¶çš„è·¯å¾„ æ–¹æ³•çš„è¿”å›å€¼ä¸º Promise ç¤ºä¾‹å¯¹è±¡ getFile(\u0026#39;./files/11.txt\u0026#39;) .then((r1) =\u0026gt; { console.log(r1) }) .catch((err) =\u0026gt; console.log(err.message)) // ä¹Ÿå¯ä»¥è¿™æ ·å†™ Promise.prototype.then(resolve, reject) getFile(\u0026#39;./files/11.txt\u0026#39;) .then((r1) =\u0026gt; { console.log(r1) }, (err) =\u0026gt; console.log(err.message)) ğŸ“ Note å…¶ä¸­ new Promise() åªæ˜¯åˆ›å»ºäº†ä¸€ä¸ªå½¢å¼ä¸Šçš„å¼‚æ­¥æ“ä½œã€‚å…·ä½“çš„å¼‚æ­¥æ“ä½œç”±ä¼ å…¥æ„é€ å‡½æ•°çš„ function å®ç°\nå¼•å…¥ async/await\nES7 å¼•å…¥çš„æ–°æ–¹æ³•ï¼Œå…è®¸å¼‚æ­¥æ“ä½œåœ¨ async å‡½æ•°ä¸­æ’é˜Ÿæ‰§è¡Œï¼Œä»è€Œå…è®¸ä½¿ç”¨åŒæ­¥çš„æ–¹å¼è¾¾åˆ°å¼‚æ­¥æ‰§è¡Œçš„æ•ˆæœã€‚\nimport thenFs from \u0026#39;then-fs\u0026#39; console.log(\u0026#39;A\u0026#39;) async function getAllFile () { console.log(\u0026#39;B\u0026#39;) // await ç›´æ¥è¿”å› Promise æ‰§è¡Œç»“æœ const r1 = await thenFs.readFile(\u0026#39;./files/1.txt\u0026#39;, \u0026#39;utf8\u0026#39;) console.log(r1) const r2 = await thenFs.readFile(\u0026#39;./files/2.txt\u0026#39;, \u0026#39;utf8\u0026#39;) console.log(r2) const r3 = await thenFs.readFile(\u0026#39;./files/3.txt\u0026#39;, \u0026#39;utf8\u0026#39;) console.log(r3) console.log(\u0026#39;D\u0026#39;) } getAllFile() console.log(\u0026#39;C\u0026#39;) path^è·¯å¾„^ path æ¨¡å—æ˜¯ Node.js å®˜æ–¹æä¾›çš„ã€ç”¨æ¥å¤„ç†è·¯å¾„çš„æ¨¡å—ã€‚æä¾›ä¸€ç³»åˆ—çš„æ–¹æ³•å’Œå±æ€§ï¼Œç”¨æ¥æ»¡è¶³å¯¹è·¯å¾„çš„å¤„ç†éœ€æ±‚ã€‚\nå¦‚æœè¦åœ¨ JavaScript ä»£ç ä¸­ï¼Œä½¿ç”¨ path æ¨¡å—æ¥å¤„ç†è·¯å¾„ï¼Œåˆ™éœ€è¦ä½¿ç”¨å¦‚ä¸‹çš„æ–¹å¼å…ˆå¯¼å…¥å®ƒï»¿ï¼š\nconst path = require(\u0026#34;path\u0026#34;) // commonjs import * as path from \u0026#39;path\u0026#39; // es module join path.join([...paths]) å¯ä»¥æŠŠå¤šä¸ªè·¯å¾„ç‰‡æ®µæ‹¼æ¥ä¸ºå®Œæ•´çš„è·¯å¾„å­—ç¬¦ä¸²\n...paths \u0026lt;string\u0026gt; è·¯å¾„ç‰‡æ®µçš„åºåˆ— è¿”å› \u0026lt;string\u0026gt; :memo: Note å‡¡æ˜¯æ¶‰åŠåˆ°è·¯å¾„æ‹¼æ¥çš„æ“ä½œï¼Œéƒ½è¦ä½¿ç”¨ path.join() æ–¹æ³•è¿›è¡Œå¤„ç†ï¼Œè€Œä¸èƒ½ç›´æ¥ä½¿ç”¨ + è¿ç®—ç¬¦è¿›è¡Œå­—ç¬¦ä¸²çš„æ‹¼æ¥\nconst path = require(\u0026#39;path\u0026#39;) const fs = require(\u0026#39;fs\u0026#39;) // æ³¨æ„ï¼š ../ ä¼šæŠµæ¶ˆå‰é¢çš„è·¯å¾„ const pathStr = path.join(\u0026#39;/a\u0026#39;, \u0026#39;/b/c\u0026#39;, \u0026#39;../\u0026#39;, \u0026#39;./d\u0026#39;, \u0026#39;e\u0026#39;) // ../ä¼šæŠµæ¶ˆä¸€å±‚è·¯å¾„ console.log(pathStr) // \\a\\b\\d\\e const pathStr = path.join(\u0026#39;/a\u0026#39;, \u0026#39;/b/c\u0026#39;, \u0026#39;../../\u0026#39;, \u0026#39;./d\u0026#39;, \u0026#39;e\u0026#39;) console.log(pathStr) // \\a\\d\\e // å–ä»£fs.readFile(__dirname + \u0026#39;/files/1.txt\u0026#39;, ...) fs.readFile(path.join(__dirname, \u0026#39;./files/1.txt\u0026#39;), \u0026#39;utf8\u0026#39;, function(err, dataStr) { if (err) { return console.log(err.message) } console.log(dataStr) }) âš ï¸ Caution ES module å¹¶ä¸æ”¯æŒ __filename å’Œ __dirname ï¼Œå› æ­¤ä½¿ç”¨è‡ªå¸¦çš„ import.meta ä»£æ›¿ï¼Œè€Œ import.meta.url è¿”å›çš„æ˜¯ url æ ¼å¼çš„åœ°å€ï¼Œå› æ­¤éœ€è¦ä¸€äº›è½¬åŒ–\nğŸ”— Href import.meta object exposes context-specific metadata to a JavaScript module. It contains information about the module, like the module\u0026rsquo;s URL.\nğŸ”— Href Node document #import meta url\n// æ–¹æ¡ˆ1 ä½¿ç”¨fileURLtoPathï¼Œä¾æ—§ä½¿ç”¨path.resolveç»„åˆ import {fileURLToPath} from \u0026#39;url\u0026#39; const __filename = fileURLToPath(import.meta.url) const __dirname = path.dirname(__filename) const __target = path.resolve(__dirname, \u0026#39;./files/1.txt\u0026#39;) fs.readFile(__target, \u0026#39;utf8\u0026#39;, function (err, dataStr) { // ... }) // æ–¹æ¡ˆ2 ä½¿ç”¨URL import { URL } from \u0026#39;url\u0026#39; const __target = new URL(\u0026#39;./files/1.txt\u0026#39;, import.meta.url) fs.readFile(__target, \u0026#39;utf8\u0026#39;, function (err, dataStr) { // ... }) // æ–¹æ¡ˆ3 å°†__dirnameæŒ‚è½½åˆ°å…¨å±€å˜é‡globalå¯¹è±¡ä¸Š // ä½†æ˜¯ï¼Œè¿™ç§æ–¹æ³•åªèƒ½è·å–å…¥å£å‡½æ•°index.jsæ‰€åœ¨çš„ç›®å½• // å› æ­¤åªèƒ½ç»„åˆå‡ºç›¸å¯¹äºå…¥å£æ–‡ä»¶çš„åœ°å€ Object.defineProperty(global, \u0026#39;__dirname\u0026#39;, { __proto__: null, get: () =\u0026gt; path.dirname( fileURLToPath(import.meta.url) ) }) basename path.basename(path[, ext]) å¯ä»¥è·å–è·¯å¾„ä¸­çš„æœ€åä¸€éƒ¨åˆ†ï¼Œç»å¸¸é€šè¿‡è¿™ä¸ªæ–¹æ³•è·å–è·¯å¾„ä¸­çš„æ–‡ä»¶åã€‚\npath \u0026lt;string\u0026gt; å¿…é€‰å‚æ•°ï¼Œè¡¨ç¤ºä¸€ä¸ªè·¯å¾„çš„å­—ç¬¦ä¸² ext \u0026lt;string\u0026gt; å¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºæ–‡ä»¶æ‰©å±•å è¿”å› \u0026lt;string\u0026gt; è·¯å¾„çš„æœ€åä¸€éƒ¨åˆ† const path = require(\u0026#39;path\u0026#39;) // å®šä¹‰æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ const fpath = \u0026#39;/a/b/c/index.html\u0026#39; const fullName = path.basename(fpath) console.log(fullName) const nameWithoutExt = path.basename(fpath, \u0026#39;.html\u0026#39;) console.log(nameWithoutExt) extname path.extname(path) å¯ä»¥è·å–è·¯å¾„ä¸­çš„æ‰©å±•åéƒ¨åˆ†\npath \u0026lt;string\u0026gt;\tå¿…é€‰å‚æ•°ï¼Œè¡¨ç¤ºä¸€ä¸ªè·¯å¾„çš„å­—ç¬¦ä¸² è¿”å› \u0026lt;string\u0026gt;\tè¿”å›å¾—åˆ°çš„æ‰©å±•åå­—ç¬¦ä¸² const path = require(\u0026#39;path\u0026#39;); // è¿™æ˜¯æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ const fpath = \u0026#39;/a/b/c/index.html\u0026#39;; const fext = path.extname(fpath); console.log(fext); http^æœåŠ¡^ http æ¨¡å—æ˜¯ Node.js å®˜æ–¹æä¾›çš„ç”¨æ¥åˆ›å»º web æœåŠ¡å™¨çš„æ¨¡å—\né€šè¿‡ http æ¨¡å—æä¾›çš„ http.createServer() æ–¹æ³•ï¼Œå°±èƒ½æ–¹ä¾¿çš„æŠŠä¸€å°æ™®é€šçš„ç”µè„‘ï¼Œå˜æˆä¸€å° web æœåŠ¡å™¨ï¼Œä»è€Œå¯¹å¤–æä¾› web èµ„æºæœåŠ¡ã€‚åœ¨ Node.js ä¸­ï¼Œä¸éœ€è¦ä½¿ç”¨ IISã€Apacheã€Nginx ç­‰ç¬¬ä¸‰æ–¹ web æœåŠ¡å™¨è½¯ä»¶ï¼Œè€Œæ˜¯åŸºäº Node.js æä¾›çš„ http æ¨¡å—ï¼Œé€šè¿‡å‡ è¡Œç®€å•çš„ä»£ç ï¼Œå°±èƒ½è½»æ¾çš„æ‰‹å†™ä¸€ä¸ªæœåŠ¡å™¨è½¯ä»¶ï¼Œä»è€Œå¯¹å¤–æä¾› web æœåŠ¡\nå¯¼å…¥ http æ¨¡å—åˆ›å»º Web æœåŠ¡å™¨\nconst http = require(\u0026#34;http\u0026#34;) // commonjs import * as http from \u0026#39;http\u0026#39; // es module æœåŠ¡å™¨ç›¸å…³çš„æ¦‚å¿µ IP åœ°å€ å°±æ˜¯äº’è”ç½‘ä¸Šæ¯å°è®¡ç®—æœºçš„å”¯ä¸€åœ°å€ï¼Œå› æ­¤ IP åœ°å€å…·æœ‰å”¯ä¸€æ€§ã€‚å¦‚æœæŠŠâ€œä¸ªäººç”µè„‘â€æ¯”ä½œâ€œä¸€å°ç”µè¯â€ï¼Œé‚£ä¹ˆâ€œIPåœ°å€â€å°±ç›¸å½“äºâ€œç”µè¯å·ç â€ï¼Œåªæœ‰åœ¨çŸ¥é“å¯¹æ–¹ IP åœ°å€çš„å‰æä¸‹ï¼Œæ‰èƒ½ä¸å¯¹åº”çš„ç”µè„‘ä¹‹é—´è¿›è¡Œæ•°æ®é€šä¿¡ã€‚\nIP åœ°å€çš„æ ¼å¼ï¼šé€šå¸¸ç”¨â€œç‚¹åˆ†åè¿›åˆ¶â€è¡¨ç¤ºæˆï¼ˆa.b.c.dï¼‰çš„å½¢å¼ï¼Œå…¶ä¸­ï¼Œa,b,c,déƒ½æ˜¯ 0~255 ä¹‹é—´çš„åè¿›åˆ¶æ•´æ•°ã€‚ä¾‹å¦‚ï¼šç”¨ç‚¹åˆ†åè¿›è¡¨ç¤ºçš„ IPåœ°å€ï¼ˆ192.168.1.1ï¼‰\n:memo: Note\näº’è”ç½‘ä¸­æ¯å° Web æœåŠ¡å™¨ï¼Œéƒ½æœ‰è‡ªå·±çš„ IP åœ°å€ï¼Œå¦‚ï¼šå¯ä»¥åœ¨ Windows çš„ç»ˆç«¯ä¸­è¿è¡Œ ping www.baidu.com å‘½ä»¤ï¼Œå³å¯æŸ¥çœ‹åˆ°ç™¾åº¦æœåŠ¡å™¨çš„ IP åœ°å€ã€‚\nåœ¨å¼€å‘æœŸé—´ï¼Œè‡ªå·±çš„ç”µè„‘æ—¢æ˜¯ä¸€å°æœåŠ¡å™¨ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œå¯ä»¥åœ¨è‡ªå·±çš„æµè§ˆå™¨ä¸­è¾“å…¥ 127.0.0.1 è¿™ä¸ª IP åœ°å€ï¼Œå°±èƒ½æŠŠè‡ªå·±çš„ç”µè„‘å½“åšä¸€å°æœåŠ¡å™¨è¿›è¡Œè®¿é—®äº†ã€‚\nåŸŸåå’ŒåŸŸåæœåŠ¡å™¨ å°½ç®¡ IP åœ°å€èƒ½å¤Ÿå”¯ä¸€åœ°æ ‡è®°ç½‘ç»œä¸Šçš„è®¡ç®—æœºï¼Œä½†IPåœ°å€æ˜¯ä¸€é•¿ä¸²æ•°å­—ï¼Œä¸ç›´è§‚ï¼Œè€Œä¸”ä¸ä¾¿äºè®°å¿†ï¼Œäºæ˜¯äººä»¬åˆå‘æ˜äº†å¦ä¸€å¥—å­—ç¬¦å‹çš„åœ°å€æ–¹æ¡ˆï¼Œå³æ‰€è°“çš„åŸŸåï¼ˆDomain Nameï¼‰åœ°å€ã€‚\nIPåœ°å€å’ŒåŸŸåæ˜¯ä¸€ä¸€å¯¹åº”çš„å…³ç³»ï¼Œè¿™ä»½å¯¹åº”å…³ç³»å­˜æ”¾åœ¨ä¸€ç§å«åšåŸŸåæœåŠ¡å™¨(DNSï¼ŒDomain name server)çš„ç”µè„‘ä¸­ã€‚ä½¿ç”¨è€…åªéœ€é€šè¿‡å¥½è®°çš„åŸŸåè®¿é—®å¯¹åº”çš„æœåŠ¡å™¨å³å¯ï¼Œå¯¹åº”çš„è½¬æ¢å·¥ä½œç”±åŸŸåæœåŠ¡å™¨å®ç°ã€‚å› æ­¤ï¼ŒåŸŸåæœåŠ¡å™¨å°±æ˜¯æä¾› IP åœ°å€å’ŒåŸŸåä¹‹é—´çš„è½¬æ¢æœåŠ¡çš„æœåŠ¡å™¨ã€‚\n:memo: Note\nå•çº¯ä½¿ç”¨ IP åœ°å€ï¼Œäº’è”ç½‘ä¸­çš„ç”µè„‘ä¹Ÿèƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚ä½†æ˜¯æœ‰äº†åŸŸåçš„åŠ æŒï¼Œèƒ½è®©äº’è”ç½‘çš„ä¸–ç•Œå˜å¾—æ›´åŠ æ–¹ä¾¿ã€‚\nåœ¨å¼€å‘æµ‹è¯•æœŸé—´ï¼Œ 127.0.0.1å¯¹åº”çš„åŸŸåæ˜¯ localhostï¼Œéƒ½ä»£è¡¨è‡ªå·±çš„è¿™å°ç”µè„‘ï¼Œåœ¨ä½¿ç”¨æ•ˆæœä¸Šæ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚\nç«¯å£å· è®¡ç®—æœºä¸­çš„ç«¯å£å·ï¼Œå°±å¥½åƒæ˜¯ç°å®ç”Ÿæ´»ä¸­çš„é—¨ç‰Œå·ä¸€æ ·ã€‚é€šè¿‡é—¨ç‰Œå·ï¼Œå¤–å–å°å“¥å¯ä»¥åœ¨æ•´æ ‹å¤§æ¥¼ä¼—å¤šçš„æˆ¿é—´ä¸­ï¼Œå‡†ç¡®æŠŠå¤–å–é€åˆ°ä½ çš„æ‰‹ä¸­ã€‚\nåŒæ ·çš„é“ç†ï¼Œåœ¨ä¸€å°ç”µè„‘ä¸­ï¼Œå¯ä»¥è¿è¡Œæˆç™¾ä¸Šåƒä¸ª web æœåŠ¡ã€‚æ¯ä¸ª web æœåŠ¡éƒ½å¯¹åº”ä¸€ä¸ªå”¯ä¸€çš„ç«¯å£å·ã€‚å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„ç½‘ç»œè¯·æ±‚ï¼Œé€šè¿‡ç«¯å£å·ï¼Œå¯ä»¥è¢«å‡†ç¡®åœ°äº¤ç»™å¯¹åº”çš„ web æœåŠ¡è¿›è¡Œå¤„ç†ã€‚\n:memo: Note\næ¯ä¸ªç«¯å£å·ä¸èƒ½åŒæ—¶è¢«å¤šä¸ª web æœåŠ¡å ç”¨ åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒURL ä¸­çš„ 80 ç«¯å£å¯ä»¥è¢«çœç•¥ åˆ›å»º web æœåŠ¡å™¨çš„åŸºæœ¬æ­¥éª¤ å¯¼å…¥ http æ¨¡å— åˆ›å»º web æœåŠ¡å™¨å®ä¾‹ server.on() ä¸ºæœåŠ¡å™¨å®ä¾‹ç»‘å®š request äº‹ä»¶ï¼Œç›‘å¬å®¢æˆ·ç«¯çš„è¯·æ±‚ å¯åŠ¨æœåŠ¡å™¨ // 1. å¯¼å…¥ http æ¨¡å— const http = require(\u0026#39;http\u0026#39;) // 2. åˆ›å»º web æœåŠ¡å™¨å®ä¾‹ const server = http.createServer() // 3. ä¸ºæœåŠ¡å™¨å®ä¾‹ç»‘å®š request äº‹ä»¶ï¼Œç›‘å¬å®¢æˆ·ç«¯çš„è¯·æ±‚ server.on(\u0026#39;request\u0026#39;, function (req, res) { console.log(\u0026#39;Someone visit our web server.\u0026#39;) }) // 4. å¯åŠ¨æœåŠ¡å™¨ server.listen(8080, function () { console.log(\u0026#39;server running at http://127.0.0.1:8080\u0026#39;) }) req^è¯·æ±‚å¯¹è±¡^ åªè¦æœåŠ¡å™¨æ¥æ”¶åˆ°äº†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå°±ä¼šè°ƒç”¨é€šè¿‡ server.on() ä¸ºæœåŠ¡å™¨ç»‘å®šçš„ request äº‹ä»¶å¤„ç†å‡½æ•°\nres^å“åº”å¯¹è±¡^ åœ¨æœåŠ¡å™¨ request äº‹ä»¶å¤„ç†å‡½æ•°ä¸­ï¼Œå¦‚æœæƒ³è®¿é—®ä¸æœåŠ¡å™¨ç›¸å…³çš„æ•°æ®æˆ–å±æ€§ï¼Œé€šè¿‡ res.end(data) æ–¹æ³•å“åº”\nimport * as http from \u0026#39;http\u0026#39; const server = http.createServer() // req æ˜¯è¯·æ±‚å¯¹è±¡ï¼ŒåŒ…å«äº†ä¸å®¢æˆ·ç«¯ç›¸å…³çš„æ•°æ®å’Œå±æ€§ server.on(\u0026#39;request\u0026#39;, (req, res) =\u0026gt; { // req.url æ˜¯å®¢æˆ·ç«¯è¯·æ±‚çš„ URL åœ°å€ const url = req.url // req.method æ˜¯å®¢æˆ·ç«¯è¯·æ±‚çš„ method ç±»å‹ const method = req.method const str = `Your request url is ${url}, and request method is ${method}` console.log(str) // è°ƒç”¨ res.end() æ–¹æ³•ï¼Œå‘å®¢æˆ·ç«¯å“åº”ä¸€äº›å†…å®¹ res.end(str) }) server.listen(80, () =\u0026gt; { console.log(\u0026#39;server running at http://127.0.0.1\u0026#39;) }) è§£å†³ä¸­æ–‡ä¹±ç é—®é¢˜ å½“è°ƒç”¨ res.end() æ–¹æ³•ï¼Œå‘å®¢æˆ·ç«¯å‘é€ä¸­æ–‡å†…å®¹çš„æ—¶å€™ï¼Œä¼šå‡ºç°ä¹±ç é—®é¢˜ï¼Œæ­¤æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨è®¾ç½®å†…å®¹çš„ç¼–ç æ ¼å¼\nserver.on(\u0026#39;request\u0026#39;, (req, res) =\u0026gt; { // å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒåŒ…å«ä¸­æ–‡çš„å†…å®¹ const str = `æ‚¨è¯·æ±‚çš„ URL åœ°å€æ˜¯ ${req.url}ï¼Œè¯·æ±‚çš„ method ç±»å‹ä¸º ${req.method}` // è°ƒç”¨ res.setHeader() æ–¹æ³•ï¼Œè®¾ç½® Content-Type å“åº”å¤´ï¼Œè§£å†³ä¸­æ–‡ä¹±ç çš„é—®é¢˜ res.setHeader(\u0026#39;Content-Type\u0026#39;, \u0026#39;text/html; charset=utf-8\u0026#39;) // res.end() å°†å†…å®¹å“åº”ç»™å®¢æˆ·ç«¯ res.end(str) }) å®ä¾‹ æ ¹æ®ä¸åŒçš„ url å“åº”ä¸åŒçš„ html å†…å®¹ æ­¥éª¤\nè·å–è¯·æ±‚çš„ urlåœ°å€ è®¾ç½®é»˜è®¤çš„å“åº”å†…å®¹ä¸º 404 Not found åˆ¤æ–­ç”¨æˆ·è¯·æ±‚çš„æ˜¯å¦ä¸º / æˆ– /index.html é¦–é¡µ åˆ¤æ–­ç”¨æˆ·è¯·æ±‚çš„æ˜¯å¦ä¸º /about.html å…³äºé¡µé¢ è®¾ç½® Content-Type å“åº”å¤´ï¼Œé˜²æ­¢ä¸­æ–‡ä¹±ç  ä½¿ç”¨ res.end() æŠŠå†…å®¹å“åº”ç»™å®¢æˆ·ç«¯ import * as http from \u0026#39;http\u0026#39; const server = http.createServer() server.on(\u0026#39;request\u0026#39;, (req, res) =\u0026gt; { // 1. è·å–è¯·æ±‚çš„ url åœ°å€ const url = req.url // 2. è®¾ç½®é»˜è®¤çš„å“åº”å†…å®¹ä¸º 404 Not found let content = \u0026#39;\u0026lt;h1\u0026gt;404 Not found!\u0026lt;/h1\u0026gt;\u0026#39; // 3. åˆ¤æ–­ç”¨æˆ·è¯·æ±‚çš„æ˜¯å¦ä¸º / æˆ– /index.html é¦–é¡µ // 4. åˆ¤æ–­ç”¨æˆ·è¯·æ±‚çš„æ˜¯å¦ä¸º /about.html å…³äºé¡µé¢ if (url === \u0026#39;/\u0026#39; || url === \u0026#39;/index.html\u0026#39;) { content = \u0026#39;\u0026lt;h1\u0026gt;é¦–é¡µ\u0026lt;/h1\u0026gt;\u0026#39; } else if (url === \u0026#39;/about.html\u0026#39;) { content = \u0026#39;\u0026lt;h1\u0026gt;å…³äºé¡µé¢\u0026lt;/h1\u0026gt;\u0026#39; } // 5. è®¾ç½® Content-Type å“åº”å¤´ï¼Œé˜²æ­¢ä¸­æ–‡ä¹±ç  res.setHeader(\u0026#39;Content-Type\u0026#39;, \u0026#39;text/html; charset=utf-8\u0026#39;) // 6. ä½¿ç”¨ res.end() æŠŠå†…å®¹å“åº”ç»™å®¢æˆ·ç«¯ res.end(content) }) server.listen(80, () =\u0026gt; { console.log(\u0026#39;server running at http://127.0.0.1\u0026#39;) }) å®ç° clock æ—¶é’Ÿçš„ web æœåŠ¡å™¨ æ€è·¯\nğŸ“ƒ è¯·æ±‚\næµè§ˆå™¨ âŸ¹ è¯·æ±‚\nåœ¨æµè§ˆå™¨ä¸­è®¿é—®å¦‚ä¸‹ç½‘å€ï¼š\n/clock/index.html /clock/index.css /clock/index.js å®¢æˆ·ç«¯è¯·æ±‚å›æ¥çš„ï¼Œä¸æ˜¯å…·ä½“çš„æ–‡ä»¶ï¼Œè€Œæ˜¯æ–‡ä»¶ä¸­æ‰€å­˜å‚¨çš„å­—ç¬¦ä¸²\nNode.js æœåŠ¡å™¨ âŸ¹ è¯»æ–‡ä»¶\næŠŠæ–‡ä»¶çš„å®é™…å­˜æ”¾è·¯å¾„ä½œä¸ºæ¯ä¸ªèµ„æºè¯·æ±‚ url åœ°å€ã€‚å› æ­¤ï¼Œå¯ä»¥ç›´æ¥æŠŠè¯·æ±‚çš„ url åœ°å€ï¼Œå½“ä½œè¯»å–æ–‡ä»¶çš„è·¯å¾„\nç£ç›˜ç›®å½•\né¡¹ç›®æ ¹ç›®å½• â””clock â”œindex.html â”œindex.css â””index.js ğŸ“ƒ å“åº”\nç£ç›˜ç›®å½• âŸ¹ è¯»å–å®Œæ¯•\né¡¹ç›®æ ¹ç›®å½•ä»¥ / è¡¨ç¤º å› æ­¤æ¯ä¸ªæ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ä¸ºï¼š /clock/index.html /clock/index.css /clock/index.js Node.js æœåŠ¡å™¨ âŸ¹ å“åº”\nå°†è¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼Œé€šè¿‡ res.end() å“åº”ç»™å®¢æˆ·ç«¯\nå“åº”\nå®¢æˆ·ç«¯è¯·æ±‚å›æ¥çš„ï¼Œä¸æ˜¯å…·ä½“çš„æ–‡ä»¶ï¼Œè€Œæ˜¯æ–‡ä»¶ä¸­æ‰€å­˜å‚¨çš„å­—ç¬¦ä¸²\nğŸ“ƒ å®ç°æ­¥éª¤\nå¯¼å…¥éœ€è¦çš„æ¨¡å— åˆ›å»ºåŸºæœ¬çš„ web æœåŠ¡å™¨ å°†èµ„æºçš„è¯·æ±‚ url åœ°å€æ˜ å°„ä¸ºæ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ è¯»å–æ–‡ä»¶å†…å®¹å¹¶å“åº”ç»™å®¢æˆ·ç«¯ ä¼˜åŒ–èµ„æºçš„è¯·æ±‚è·¯å¾„ // 1 å¯¼å…¥éœ€è¦çš„æ¨¡å— // 1.1 å¯¼å…¥ http æ¨¡å— import * as http from \u0026#39;http\u0026#39; // 1.2 å¯¼å…¥ fs æ¨¡å— import * as fs from \u0026#39;fs\u0026#39; // 1.3 å¯¼å…¥ path æ¨¡å— import { URL } from \u0026#39;url\u0026#39; // 2.1 åˆ›å»º web æœåŠ¡å™¨ const server = http.createServer() // 2.2 ç›‘å¬ web æœåŠ¡å™¨çš„ request äº‹ä»¶ server.on(\u0026#39;request\u0026#39;, (req, res) =\u0026gt; { // 3.1 è·å–åˆ°å®¢æˆ·ç«¯è¯·æ±‚çš„ URL åœ°å€ // /clock/index.html // /clock/index.css // /clock/index.js const url = req.url // 3.2 æŠŠè¯·æ±‚çš„ URL åœ°å€æ˜ å°„ä¸ºå…·ä½“æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ // const fpath = path.join(__dirname, url) // 5.1 é¢„å®šä¹‰ä¸€ä¸ªç©ºç™½çš„æ–‡ä»¶å­˜æ”¾è·¯å¾„ let fpath = \u0026#39;\u0026#39; if (url === \u0026#39;/\u0026#39;) { fpath = new URL(\u0026#39;./clock/index.html\u0026#39;, import.meta.url) } else { // /index.html // /index.css // /index.js console.log(`The request url is: ${url}`) fpath = new URL(\u0026#39;./clock\u0026#39; + url, import.meta.url) } // 4.1 æ ¹æ®â€œæ˜ å°„â€è¿‡æ¥çš„æ–‡ä»¶è·¯å¾„è¯»å–æ–‡ä»¶çš„å†…å®¹ fs.readFile(fpath, \u0026#39;utf8\u0026#39;, (err, dataStr) =\u0026gt; { // 4.2 è¯»å–å¤±è´¥ï¼Œå‘å®¢æˆ·ç«¯å“åº”å›ºå®šçš„â€œé”™è¯¯æ¶ˆæ¯â€ if (err) return res.end(\u0026#39;404 Not found.\u0026#39;) // 4.3 è¯»å–æˆåŠŸï¼Œå°†è¯»å–æˆåŠŸçš„å†…å®¹ï¼Œå“åº”ç»™å®¢æˆ·ç«¯ res.end(dataStr) }) }) // 2.3 å¯åŠ¨æœåŠ¡å™¨ server.listen(80, () =\u0026gt; { console.log(\u0026#39;server running at http://127.0.0.1\u0026#39;) }) å®ç° ç»“æ„ æ¯ä¸ªæ–‡ä»¶æ¨¡å—éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ console æ–¹æ³•å¯¼å‡ºæ¨¡å—çš„ç»“æ„ã€‚\nconsole.log(module); // ==\u0026gt; Module = { id: \u0026#39;.\u0026#39;, path: \u0026#39;~/...\u0026#39;, exports: {}, filename: \u0026#39;~/.../main.js\u0026#39;, loaded: false, children: [ { // ä½¿ç”¨ require å¯¼å…¥å…¶å®ƒæ¨¡å—æ—¶äº§ç”Ÿ id: \u0026#39;~/.../math.js\u0026#39;, path: \u0026#39;~/...\u0026#39;, exports: [Object], filename: \u0026#39;~/.../math.js\u0026#39;, loaded: true, children: [], paths: [Array] } ], paths: [ \u0026#39;~/.../node_modules\u0026#39;, /* â¤¡...â¤¡ */ \u0026#39;~/node_modules\u0026#39;, \u0026#39;/node_modules\u0026#39; ] }; ç¼–è¯‘å’Œæ‰§è¡Œæ˜¯å¼•å…¥æ–‡ä»¶æ¨¡å—çš„æœ€åä¸€ä¸ªé˜¶æ®µã€‚å®šä½åˆ°å…·ä½“æ–‡ä»¶åï¼ŒNode ä¼šå»ºç«‹ä¸€ä¸ªæ¨¡å—å¯¹è±¡ï¼Œç„¶åæ ¹æ®è·¯å¾„è½½å…¥å¹¶ç¼–è¯‘ã€‚å¯¹äºä¸åŒçš„æ–‡ä»¶æ‰©å±•åï¼Œè½½å…¥çš„æ–¹æ³•ä¹Ÿä¸åŒï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š\n.js - é€šè¿‡ fs æ¨¡å—åŒæ­¥è¯»å–æ–‡ä»¶åç¼–è¯‘æ‰§è¡Œ .node - C/C++ æ‰©å±•æ–‡ä»¶ï¼Œé€šè¿‡ dlopen() æ–¹æ³•åŠ è½½æœ€åç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶ .json - åŒæ­¥è¯»å–æ–‡ä»¶åï¼Œç”¨ JSON.parse() æ–¹æ³•è§£æè¿”å›ç»“æœ å…¶ä½™æ‰©å±•åæ–‡ä»¶å°†è¢«å½“åš .js æ–‡ä»¶è½½å…¥ :link: Href å…³äº CommonJS åŒ…çš„ç»“æ„ï¼Œå‚è§ åŒ…*^package^* ä¸€èŠ‚ã€‚\næŸ¥æ‰¾ Node æŸ¥æ‰¾æ¨¡å—çš„æ­¥éª¤ï¼šè·¯å¾„åˆ†æ âŸ¹ æ–‡ä»¶å®šä½ âŸ¹ ç¼–è¯‘æ‰§è¡Œã€‚\nrequire() æ”¯æŒåŠ è½½çš„æ¨¡å—åŒ…æ‹¬åŸç”Ÿæ¨¡å—ã€æ–‡ä»¶æ¨¡å—ã€ç¬¬ä¸‰æ–¹æ¨¡å—ã€‚\nå°è¯•è¿‡ç¨‹ä¸­éœ€è¦è°ƒç”¨ fs æ¨¡å—åŒæ­¥ é˜»å¡*^block^* åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå› ä¸ºæ˜¯å•çº¿ç¨‹ï¼Œä¼šå¼•èµ·æ€§èƒ½é—®é¢˜ã€‚å› æ­¤å¦‚æœè°ƒç”¨çš„æ˜¯ .node å’Œ .json æ–‡ä»¶ï¼Œå»ºè®®ä¼ é€’æ—¶å¸¦ä¸Šæ‰©å±•åã€‚\næ‰¾åˆ°æ¨¡å—åï¼ŒNode å°†ä¼šæŠŠæ¨¡å—ç¼“å­˜è‡³å†…å­˜ï¼›è‹¥æ¨¡å—è·¯å¾„æ•°ç»„éƒ½è¢«éå†å®Œæ¯•ï¼Œä¾ç„¶æ²¡æœ‰æŸ¥æ‰¾åˆ°ç›®æ ‡æ–‡ä»¶ï¼Œåˆ™ä¼šæŠ›å‡ºæŸ¥æ‰¾å¤±è´¥çš„å¼‚å¸¸ã€‚\nåŸç”Ÿæ¨¡å—\nhttpã€fsã€pathã€events ç­‰æ¨¡å—ï¼Œæ˜¯ Node æä¾›çš„åŸç”Ÿæ¨¡å—ï¼Œè¿™äº›æ¨¡å—åœ¨ Node æºä»£ç çš„ç¼–è¯‘è¿‡ç¨‹ä¸­è¢«ç¼–è¯‘æˆäºŒè¿›åˆ¶ã€‚åœ¨ Node è¿›ç¨‹å¯åŠ¨æ—¶ï¼Œéƒ¨åˆ†åŸç”Ÿä»£ç å°±è¢«ç›´æ¥åŠ è½½è¿›å†…å­˜ä¸­ï¼Œæ‰€ä»¥åŸç”Ÿæ¨¡å—å¼•å…¥æ—¶ï¼Œæ–‡ä»¶å®šä½*^locate^* å’Œ ç¼–è¯‘æ‰§è¡Œ*^compile^* è¿™ä¸ªä¸¤ä¸ªæ­¥éª¤å¯ä»¥çœç•¥æ‰ï¼Œå¹¶ä¸”åœ¨è·¯å¾„åˆ†æä¸­ä¼˜å…ˆåˆ¤æ–­ï¼Œæ‰€ä»¥åŠ è½½é€Ÿåº¦æœ€å¿«ã€‚åŸç”Ÿæ¨¡å—ç›´æ¥é€šè¿‡åç§°æ¥åŠ è½½ã€‚\næ–‡ä»¶æ¨¡å—\nä¿å­˜åœ¨ç¡¬ç›˜çš„æŸä¸ªä½ç½®ï¼Œåœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½ï¼Œéœ€è¦å®Œæˆ è·¯å¾„åˆ†æ*^analyze^* ã€æ–‡ä»¶å®šä½*^locate^* ã€ç¼–è¯‘æ‰§è¡Œ*^compile^* è¿‡ç¨‹ï¼Œé€Ÿåº¦æ¯”åŸç”Ÿæ¨¡å—æ…¢ã€‚\næ–‡ä»¶æ¨¡å—é€šè¿‡åç§°æˆ–è·¯å¾„æ¥åŠ è½½ï¼Œæ–‡ä»¶æ¨¡å—çš„åç¼€æœ‰ä¸‰ç§ï¼Œå¦‚ä¸‹ï¼š\n.js - éœ€è¦å…ˆè¯»å…¥å†…å­˜å†è¿è¡Œ .json - é€šè¿‡ fs^æ¨¡å—^ è¯»å…¥å†…å­˜å†è½¬åŒ–æˆ JSON å¯¹è±¡ .node - ç»è¿‡ç¼–è¯‘åçš„äºŒè¿›åˆ¶ C/C++ æ‰©å±•æ¨¡å—æ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ ç¬¬ä¸‰æ–¹æ¨¡å—\nå¦‚æœ require å‡½æ•°åªæŒ‡å®šåç§°åˆ™è§†ä¸ºä» node_modules æ–‡ä»¶å¤¹ä¸‹é¢åŠ è½½æ–‡ä»¶ï¼Œè¿™æ ·çš„è¯ä½ å¯ä»¥ç›´æ¥ç§»åŠ¨æ¨¡å—è€Œä¸éœ€è¦ä¿®æ”¹å¼•ç”¨çš„æ¨¡å—è·¯å¾„ï¼ŒæŸ¥è¯¢è·¯å¾„åŒ…æ‹¬ module.paths å’Œå…¨å±€ç›®å½•ã€‚\nè‹¥æ²¡æœ‰æŸ¥æ‰¾åˆ°å¯¹åº”æ–‡ä»¶ï¼ŒNode ä¼šå°†è¯¥ç›®å½•å½“åšä¸€ä¸ª åŒ…*^package^* æ¥å¤„ç†ï¼š\næ­¤æ—¶ï¼ŒNode ä¼šåœ¨å½“å‰ç›®å½•ä¸‹æŸ¥æ‰¾ package.json ï¼Œä»ä¸­å–å‡º main å±æ€§æŒ‡å®šçš„æ–‡ä»¶è¿›è¡Œå®šä½ã€‚ å¦‚æœæ–‡ä»¶ç¼ºå°‘æ‰©å±•åï¼Œå°†ä¼šè¿›å…¥æ‰©å±•ååˆ†æçš„æ­¥éª¤\nå¦‚æœ main å±æ€§æŒ‡å®šçš„æ–‡ä»¶åé”™è¯¯ï¼Œæˆ–è€…æ ¹æœ¬æ²¡æœ‰ package.json ï¼ŒNode ä¼šå°† index å½“åšé»˜è®¤æ–‡ä»¶åï¼Œç„¶åä¾æ¬¡æŸ¥æ‰¾ index.js ã€index.json ã€ index.node\nè§„åˆ™\nåŠ è½½ Node.js æŒ‰ç…§ä¼˜å…ˆçº§è¿›è¡ŒåŠ è½½ï¼Œå†…ç½®æ¨¡å—åŠ è½½çš„ä¼˜å…ˆçº§æœ€é«˜ã€‚è€Œåœ¨åŠ è½½è‡ªå®šä¹‰æ¨¡å—çš„æ—¶å€™ï¼Œå¿…é¡»æŒ‡å®šä»¥ ./ æˆ– ../ å¼€å¤´çš„è·¯å¾„æ ‡è¯†ç¬¦ï¼Œä¸”åœ¨ä½¿ç”¨ ES Module æ—¶éœ€è¦æ·»åŠ æ‹“å±•åï¼ˆä¼¼ä¹å¯ä»¥é€šè¿‡ä¿®æ”¹è¿è¡Œ Node çš„å‚æ•°æ¥å…³é—­ï¼‰å¦åˆ™ï¼Œå°†ä¼šè¢«å½“ä½œå†…ç½®æ¨¡å—æˆ–æ˜¯ç¬¬ä¸‰æ–¹æ¨¡å—ã€‚\nğŸ“ Note ä½¿ç”¨ require() å¯¼å…¥è‡ªå®šä¹‰æ¨¡å—æ—¶ï¼Œå¦‚æœçœç•¥äº†æ–‡ä»¶çš„æ‹“å±•åï¼Œåˆ™ä¼šæŒ‰ç…§ä»¥ä¸‹é¡ºåºè¿›è¡ŒåŠ è½½ï¼š\næŒ‰ç…§ç¡®åˆ‡çš„æ–‡ä»¶åè¿›è¡ŒåŠ è½½ è¡¥å…¨ .js æ‹“å±•ååŠ è½½ è¡¥å…¨ .json æ‰©å±•ååŠ è½½ è¡¥å…¨ .node æ‰©å±•ååŠ è½½ åŠ è½½å¤±è´¥ï¼Œç»ˆç«¯æŠ¥é”™ ç¬¬ä¸‰æ–¹æ¨¡å—\nå¦‚æœä¼ é€’ç»™ require() çš„æ¨¡å—æ ‡è¯†ç¬¦ä¸æ˜¯ä¸€ä¸ªå†…ç½®çš„æ¨¡å—ï¼Œä¹Ÿæ²¡æœ‰ ./ æˆ–æ˜¯ ../ å¼€å¤´ï¼Œåˆ™ Node ä¼šä»å½“å‰æ¨¡å—çš„çˆ¶ç›®å½•å¼€å§‹ï¼Œå°è¯•ä» /node_modules æ–‡ä»¶å¤¹ä¸­åŠ è½½ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œç›´åˆ°æ–‡ä»¶ç³»ç»Ÿæ ¹ç›®å½•ã€‚\nâš ï¸ Caution Node å¤„ç†å¯¼å…¥æ–‡ä»¶æ˜¯ä½¿ç”¨ CommonJS è¿˜æ˜¯ ES Module ä¼¼ä¹ä¼šæ ¹æ®å½“å‰ç›®å½•ä¸­ package.json çš„å€¼åˆ¤æ–­ã€‚\nJavaScript åœ¨åŠ è½½è¿‡ç¨‹ä¸­ï¼ŒNode å¯¹è·å–çš„ JS æ–‡ä»¶å†…å®¹è¿›è¡Œäº†å¤´å°¾åŒ…è£…ï¼Œè¿™æ ·ï¼Œæ¯ä¸ªæ–‡ä»¶æ¨¡å—ä¹‹é—´éƒ½è¿›è¡Œäº†ä½œç”¨åŸŸéš”ç¦»ã€‚å¦‚ä¸‹ï¼š\n(function(exports, require, module, __filename, __dirname){ }); æ¨¡æ‹Ÿ require æ–¹æ³•çš„åŸç†ï¼Œå¦‚ä¸‹ï¼š\n// nodeRequire() function nodeRequire(mod) { const fs = require(\u0026#39;fs\u0026#39;); const path = require(\u0026#39;path\u0026#39;); const filename = path.join(__dirname, mod); const dirname = __dirname; const content = fs.readFileSync(filename, \u0026#39;utf8\u0026#39;); const fn = new Function( \u0026#39;__exports\u0026#39;, \u0026#39;require\u0026#39;, \u0026#39;module\u0026#39;, \u0026#39;__filename\u0026#39;, \u0026#39;__dirname\u0026#39;, \u0026#39;const exports = __exports;\\n\u0026#39; + content + \u0026#39;\\n return module.exports;\u0026#39; ); // new Function (arg1, arg2, ... argN, functionBody); const module = { exports: {} }; const exports = module.exports; return fn(exports, nodeRequire, module, filename, dirname); } // main.js let nodeExports = nodeRequire(\u0026#39;./math.js\u0026#39;); console.log(nodeExports.log()); // main.js let nodeExports = nodeRequire(\u0026#39;./nodeRequire.js\u0026#39;); console.log(nodeExports.log()); // nodeRequire.call() // { log: [Function: log] } // nodeRequire.js console.log(exports) /* ä½¿ç”¨module.exportsçš„å†™æ³• */ module.exports = { log() { console.log(\u0026#39;nodeRequire.call()\u0026#39;); return this; }, }; /* ä½¿ç”¨exportsçš„å†™æ³• */ exports.log = function () { console.log(\u0026#39;nodeRequire.call()\u0026#39;); return this; } :memo: Note\nexports è¿”å›çš„æ˜¯æ¨¡å— å‡½æ•°*^function^* module.exports è¿”å›çš„æ˜¯æ¨¡å— å¯¹è±¡*^object^* æœ¬èº«ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ª ç±»*^class^* :warning: Caution æ— æ³•å¯¹ exports ç›´æ¥èµ‹å€¼è€Œå¿…é¡»é€šè¿‡ ç‚¹æ“ä½œç¬¦. é—´æ¥è®¿é—®æˆå‘˜ã€‚è¿™æ˜¯å› ä¸º exports è·å¾—çš„æ˜¯ module.exports æŒ‡å‘çš„ å¯¹è±¡*^pointer^* ï¼Œå¯¹å…¶èµ‹å€¼å°†ä¼šæ¸…é™¤åŸæ¥çš„å¼•ç”¨ï¼Œè€Œ require() æ–¹æ³•å¼•ç”¨çš„æ˜¯ module.exports ï¼Œæ•…è¿”å› ç©ºå¯¹è±¡*^{}^* ã€‚\nlet foo = { bar: {} }; let bar = foo.bar; // å¯¹barèµ‹å€¼æ—¶å°†ä¼šè¦†ç›–åŸæ¥çš„å¼•ç”¨ bar = () =\u0026gt; {}; console.log(foo.bar, bar === foo.bar); // {} false å› æ­¤æœ€å¥½çš„ä¼˜åŒ–åŠæ³•æ˜¯ä¸º bar åŠ ä¸Š const é™åˆ¶ï¼Œç¦æ­¢ä¿®æ”¹ï¼š\nconst bar = foo.bar; // TypeError: Assignment to constant variable. C/C++\nNode è°ƒç”¨ process.dlopen() æ–¹æ³•è¿›è¡ŒåŠ è½½å’Œæ‰§è¡Œã€‚åœ¨ Node çš„æ¶æ„ä¸‹ï¼Œdlopen() æ–¹æ³•åœ¨ Windows å’Œ *nix å¹³å°ä¸‹åˆ†åˆ«æœ‰ä¸åŒçš„å®ç°ï¼Œé€šè¿‡ libuv å…¼å®¹å±‚è¿›è¡Œäº†å°è£…ã€‚\nå®é™…ä¸Šï¼Œ.node çš„æ¨¡å—æ–‡ä»¶å¹¶ä¸éœ€è¦ç¼–è¯‘ï¼Œå› ä¸ºå®ƒæ˜¯ç¼–å†™ C/C++ æ¨¡å—ä¹‹åç¼–è¯‘ç”Ÿæˆçš„ï¼Œæ‰€ä»¥è¿™é‡Œåªæœ‰åŠ è½½å’Œæ‰§è¡Œçš„è¿‡ç¨‹ã€‚åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œæ¨¡å—é€šè¿‡ exports å¯¹è±¡ä¸ .node æ¨¡å—äº§ç”Ÿè”ç³»ï¼Œç„¶åè¿”å›ç»™è°ƒç”¨è€…ã€‚\nJSON\nNode åˆ©ç”¨ fs æ¨¡å—åŒæ­¥è¯»å– Json æ–‡ä»¶çš„å†…å®¹ä¹‹åï¼Œè°ƒç”¨ JSON.parse() æ–¹æ³•å¾—åˆ°å¯¹è±¡ï¼Œç„¶åå°†å®ƒèµ‹ç»™æ¨¡å—å¯¹è±¡çš„ exports ï¼Œä»¥ä¾›å¤–éƒ¨è°ƒç”¨ã€‚\nJSON æ–‡ä»¶åœ¨ç”¨ä½œé¡¹ç›®çš„é…ç½®æ–‡ä»¶æ—¶æ¯”è¾ƒæœ‰ç”¨ã€‚å¦‚æœä½ å®šä¹‰äº†ä¸€ä¸ª JSON æ–‡ä»¶ä½œä¸ºé…ç½®ï¼Œé‚£å°±ä¸å¿…è°ƒç”¨ fs æ¨¡å—å»å¼‚æ­¥è¯»å–å’Œè§£æï¼Œç›´æ¥è°ƒç”¨ require() å¼•å…¥å³å¯ã€‚\nç¼“å­˜ æ¨¡å—åœ¨ç¬¬ä¸€æ¬¡åŠ è½½åä¼šè¢« ç¼“å­˜ ã€‚è¿™ä¹Ÿæ„å‘³ç€å¤šæ¬¡è°ƒç”¨ require() ä¸ä¼šå¯¼è‡´æ¨¡å—çš„ä»£ç è¢«æ‰§è¡Œå¤šæ¬¡ã€‚\nğŸ“ƒ Example\nåœ¨ CommonJS ä¸­çš„æµ‹è¯•ï¼š\n// moduleA.cjs const B = require(\u0026#39;./moduleB.cjs\u0026#39;) // B is imported! const B2 = require(\u0026#39;./moduleB.cjs\u0026#39;) // C is imported! const C = require(\u0026#39;./moduleC.cjs\u0026#39;) // NO RESPONSE console.log(B, B2, C) // B B C // moduleB.cjs console.log(\u0026#39;B is imported!\u0026#39;) module.exports = \u0026#39;B\u0026#39; // moduleC.cjs console.log(\u0026#39;C is imported!\u0026#39;) module.exports = \u0026#39;C\u0026#39; åœ¨ ES Module ä¸­çš„æµ‹è¯•ï¼š\n// moduleA.mjs import { B, B as B2 } from \u0026#39;./moduleB.mjs\u0026#39; // B is imported! import { C } from \u0026#39;./moduleC.mjs\u0026#39; // C is imported! console.log(B, B2, C) // B B C const B_ = import(\u0026#39;./moduleB.mjs\u0026#39;) const B_2 = import(\u0026#39;./moduleB.mjs\u0026#39;) const C_ = import(\u0026#39;./moduleC.mjs\u0026#39;) // NO RESPONSE console.log(B_, B_2, C_) // Promise { \u0026lt;pending\u0026gt; } Promise { \u0026lt;pending\u0026gt; } Promise { \u0026lt;pending\u0026gt; } console.log(await B_, await B_2, await C_) // [Module: null prototype] { B: \u0026#39;B\u0026#39; } [Module: null prototype] { B: \u0026#39;B\u0026#39; } [Module: null prototype] { C: \u0026#39;C\u0026#39; } // moduleB.mjs console.log(\u0026#39;B is imported!\u0026#39;) export const B = \u0026#39;B\u0026#39; // moduleC.mjs console.log(\u0026#39;C is imported!\u0026#39;) export const C = \u0026#39;C\u0026#39; ç¼–è¯‘ Node çš„æ ¸å¿ƒæ¨¡å—åœ¨ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶çš„è¿‡ç¨‹ä¸­è¢«ç¼–è¯‘è¿›äº†äºŒè¿›åˆ¶æ–‡ä»¶ã€‚æ ¸å¿ƒæ¨¡å—å…¶å®åˆ†ä¸º C/C++ ç¼–å†™çš„å’Œ JavaScript ç¼–å†™çš„ä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­ C/C++ æ–‡ä»¶å­˜æ”¾åœ¨ Node é¡¹ç›®çš„ src ç›®å½•ä¸‹ï¼ŒJavaScript æ–‡ä»¶å­˜æ”¾åœ¨ lib ç›®å½•ä¸‹ã€‚\nC interface\nNode é‡‡ç”¨äº† V8 é™„å¸¦çš„ js2c.py å·¥å…·ï¼Œå°†æ‰€æœ‰å†…ç½®çš„ JavaScript ä»£ç src/node.js \u0026amp; *lib/`.js` æ¥å£è½¬æ¢æˆ C++ é‡Œçš„æ•°ç»„ï¼Œå¹¶ç”Ÿæˆ node_natives.h å¤´æ–‡ä»¶ï¼š\nnamespace node { const char node_native[] = { 47, 47, ..}; const char dgram_native[] = { 47, 47, ..}; const char console_native[] = { 47, 47, ..}; const char buffer_native[] = { 47, 47, ..}; const char querystring_native[] = { 47, 47, ..}; const char punycode_native[] = { 47, 42, ..}; ... struct _native { const char* name; const char* source; size_t source_len; }; static const struct _native natives[] = { { \u0026#34;node\u0026#34;, node_native, sizeof(node_native) - 1 }, { \u0026#34;dgram\u0026#34;, dgram_native, sizeof(dgram_native) - 1 }, ... }; } åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒJavaScript ä»£ç ä»¥å­—ç¬¦ä¸²çš„å½¢å¼å­˜å‚¨åœ¨ node å‘½åç©ºé—´ä¸­ï¼Œæ˜¯ä¸å¯ç›´æ¥æ‰§è¡Œçš„ã€‚åœ¨å¯åŠ¨ Node è¿›ç¨‹æ—¶ï¼ŒJavaScript ä»£ç ç›´æ¥åŠ è½½è¿›å†…å­˜ä¸­ã€‚åœ¨åŠ è½½çš„è¿‡ç¨‹ä¸­ï¼ŒJavaScript æ ¸å¿ƒæ¨¡å—ç»å†æ ‡è¯†ç¬¦åˆ†æåç›´æ¥å®šä½åˆ°å†…å­˜ä¸­ï¼Œæ¯”æ™®é€šçš„æ–‡ä»¶æ¨¡å—ä»ç£ç›˜ä¸­ä¸€å¤„ä¸€å¤„æŸ¥æ‰¾è¦å¿«å¾ˆå¤šã€‚\næ ¸å¿ƒæ¨¡å—\nlib ç›®å½•ä¸‹çš„æ‰€æœ‰æ¨¡å—æ–‡ä»¶ä¹Ÿæ²¡æœ‰å®šä¹‰ requireã€moduleã€exportsè¿™äº›å˜é‡ã€‚åœ¨å¼•å…¥ JavaScript æ ¸å¿ƒæ¨¡å—çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿç»å†äº†å¤´å°¾åŒ…è£…çš„è¿‡ç¨‹ï¼Œç„¶åæ‰æ‰§è¡Œå’Œå¯¼å‡ºäº†exportså¯¹è±¡ã€‚ä¸æ–‡ä»¶æ¨¡å—æœ‰åŒºåˆ«çš„åœ°æ–¹åœ¨äºï¼šè·å–æºä»£ç çš„æ–¹å¼ï¼ˆæ ¸å¿ƒæ¨¡å—æ˜¯ä»å†…å­˜ä¸­åŠ è½½çš„ï¼‰ä»¥åŠç¼“å­˜æ‰§è¡Œç»“æœçš„ä½ç½®ã€‚\nJavaScript æ ¸å¿ƒæ¨¡å—çš„å®šä¹‰å¦‚ä¸‹é¢çš„ä»£ç æ‰€ç¤ºï¼š\nfunction NativeModule(id) { this.filename = id + \u0026#39;.js\u0026#39;; this.id = id; this.exports = {}; this.loaded = false; } NativeModule._source = process.binding(\u0026#39;natives\u0026#39;); NativeModule._cache = {}; ä»¥ä¸‹å±•ç¤ºäº†å†…å»ºæ¨¡å—çš„è°ƒç”¨æµç¨‹ã€‚\nè·¨å¹³å°\nJavaScript çš„ä¸€ä¸ªå…¸å‹å¼±ç‚¹å°±æ˜¯ä½è¿ç®—ã€‚JavaScript çš„ä½è¿ç®—å‚ç…§ Java çš„ä½è¿ç®—å®ç°ï¼Œä½†æ˜¯ Java ä½è¿ç®—æ˜¯åœ¨ int å‹æ•°å­—çš„åŸºç¡€ä¸Šè¿›è¡Œçš„ï¼Œè€Œ JavaScript ä¸­åªæœ‰ double å‹çš„æ•°æ®ç±»å‹ï¼Œåœ¨è¿›è¡Œä½è¿ç®—çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å°† double å‹è½¬æ¢ä¸º int å‹ï¼Œç„¶åå†è¿›è¡Œã€‚æ‰€ä»¥ï¼Œåœ¨ JavaScript å±‚é¢ä¸Šåšä½è¿ç®—çš„æ•ˆç‡ä¸é«˜ã€‚\nåœ¨åº”ç”¨ä¸­ï¼Œä¼šé¢‘ç¹å‡ºç°ä½è¿ç®—çš„éœ€æ±‚ï¼ŒåŒ…æ‹¬è½¬ç ã€ç¼–ç ç­‰è¿‡ç¨‹ï¼Œå¦‚æœé€šè¿‡ JavaScript æ¥å®ç°ï¼ŒCPU èµ„æºå°†ä¼šè€—è´¹å¾ˆå¤šï¼Œè¿™æ—¶ç¼–å†™ C/C++ æ‰©å±•æ¨¡å—æ¥æå‡æ€§èƒ½çš„æœºä¼šæ¥äº†ã€‚\nC/C++ æ‰©å±•æ¨¡å—å±äºæ–‡ä»¶æ¨¡å—ä¸­çš„ä¸€ç±»ï¼Œé€šè¿‡é¢„å…ˆç¼–è¯‘ä¸º .node æ–‡ä»¶ï¼Œç„¶åè°ƒç”¨ process.dlopen() æ–¹æ³•åŠ è½½æ‰§è¡Œã€‚\næ—§ç‰ˆè§„èŒƒ*^Depreciated^* â—ï¸ Warning ğŸ—‘ Depreciated æœ¬èŠ‚æ˜¯ ES Module æ¨¡å—å®ç°ä¹‹å‰çš„æƒå®œä¹‹è®¡ï¼Œç°å·²è¢«é€æ¸æ·˜æ±°\nåœ¨å®é™…æƒ…å†µä¸­ï¼Œå‰åç«¯çš„ç¯å¢ƒæ˜¯ç•¥æœ‰å·®åˆ«çš„ã€‚å› æ­¤å½“ å‰åç«¯å…±ç”¨æ—¶ ï¼Œéœ€è¦åˆ†åˆ«è€ƒè™‘åŠ è½½é¡ºåºã€‚\nå‰åç«¯ JavaScript åˆ†åˆ«æç½®åœ¨ http çš„ä¸¤ç«¯ï¼Œå®ƒä»¬æ‰®æ¼”çš„è§’è‰²å¹¶ä¸åŒã€‚\næµè§ˆå™¨ç«¯çš„ JavaScript éœ€è¦ç»å†ä»åŒ ä¸€ä¸ª æœåŠ¡å™¨ç«¯åˆ†å‘åˆ° å¤šä¸ª å®¢æˆ·ç«¯æ‰§è¡Œ æœåŠ¡å™¨ç«¯ JavaScript åˆ™æ˜¯ç›¸åŒçš„ä»£ç éœ€è¦ å¤šæ¬¡ æ‰§è¡Œ å‰è€…çš„ç“¶é¢ˆåœ¨äº å¸¦å®½*^bandwidth^* ï¼Œåè€…çš„ç“¶é¢ˆåˆ™åœ¨äº CPU å’Œ å†…å­˜*^memory^* ç­‰èµ„æºã€‚å‰è€…éœ€è¦é€šè¿‡ ç½‘ç»œ*^network^* åŠ è½½ä»£ç ï¼Œåè€…ä» ç£ç›˜*^disk^* ä¸­åŠ è½½ï¼Œä¸¤è€…çš„åŠ è½½é€Ÿåº¦ä¸åœ¨ä¸€ä¸ªæ•°é‡çº§ä¸Šã€‚\nçºµè§‚ Node çš„æ¨¡å—å¼•å…¥è¿‡ç¨‹ï¼Œå‡ ä¹å…¨éƒ½æ˜¯ åŒæ­¥*^synchronous^* çš„ã€‚ä½†æ˜¯å¦‚æœå‰ç«¯æ¨¡å—ä¹Ÿé‡‡ç”¨åŒæ­¥çš„æ–¹å¼æ¥å¼•å…¥ï¼Œå°†å¯¼è‡´è„šæœ¬åŠ è½½å®Œæˆåæ‰èƒ½å¼€å§‹åŠ è½½ UI ï¼Œä¼šåœ¨ç”¨æˆ·ä½“éªŒä¸Šé€ æˆå¾ˆå¤§çš„é—®é¢˜ã€‚\nAMD ^Asynchronous-Module-Definition^ :link: Href AMD è§„èŒƒ\nAMD Asynchronous Module Definition - å¼‚æ­¥æ¨¡å—å®šä¹‰\nAMD è§„èŒƒæ˜¯ CommonJS æ¨¡å—è§„èŒƒçš„ä¸€ä¸ªå»¶ä¼¸ï¼Œéœ€è¦å¼•å…¥ç›¸åº”çš„åº“ RequireJS ï¼Œè¿™æ˜¯ CommonJS å‰ç«¯ AMD asynchronous æ¨¡å—è§„èŒƒçš„å®ç°ã€‚\nRequireJS è§£å†³å¦‚ä¸‹é—®é¢˜ï¼š\nå¤šä¸ª JS æ–‡ä»¶å¯èƒ½æœ‰ä¾èµ–å…³ç³»ï¼Œè¢«ä¾èµ–çš„æ–‡ä»¶éœ€è¦æ—©äºä¾èµ–å®ƒçš„æ–‡ä»¶åŠ è½½åˆ°æµè§ˆå™¨ JS åŠ è½½çš„æ—¶å€™æµè§ˆå™¨ä¼šåœæ­¢é¡µé¢æ¸²æŸ“ï¼ŒåŠ è½½æ–‡ä»¶è¶Šå¤šï¼Œé¡µé¢å¤±å»å“åº”æ—¶é—´è¶Šé•¿ï¼›ä¸ºäº†å‡å°‘ç­‰å¾…æ—¶é—´ï¼Œæé«˜åŠ è½½é€Ÿåº¦ï¼Œè„šæœ¬éœ€è¦è¢« å¼‚æ­¥^asychronous^ åŠ è½½ å¯¼å…¥*^require^* åœ¨é¡µé¢ä¸Šä½¿ç”¨ require å‡½æ•°åŠ è½½æ¨¡å—ï¼š\nrequire([dependencies], callback) require() å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°\nç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª æ•°ç»„*^moduleName[]^* ï¼Œè¡¨ç¤ºæ‰€ä¾èµ–çš„æ¨¡å— ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ª å›è°ƒå‡½æ•°*^callback^* ï¼Œå½“å‰é¢æŒ‡å®šçš„æ¨¡å—éƒ½åŠ è½½æˆåŠŸåï¼Œå®ƒå°†è¢«è°ƒç”¨ã€‚åŠ è½½çš„æ¨¡å—ä¼šä»¥ å‚æ•°*^param^* å½¢å¼ä¼ å…¥è¯¥å‡½æ•°ï¼Œä»è€Œä½¿å¾—å›è°ƒå‡½æ•°å†…éƒ¨å°±å¯ä»¥ä½¿ç”¨è¿™äº›æ¨¡å— å¯¼å‡º*^define\u0026amp;return^* å®ƒçš„æ¨¡å—å®šä¹‰å¦‚ä¸‹ï¼š\ndefine([id], [dependencies], factory) è€Œ factory æ¥å£å¦‚ä¸‹ï¼š\ntype factory = (...dependencies)=\u0026gt;object | object; å®ƒçš„æ¨¡å— id å’Œä¾èµ–æ˜¯å¯é€‰çš„ï¼Œä¸ Node æ¨¡å—ç›¸ä¼¼çš„åœ°æ–¹åœ¨äº factory çš„å†…å®¹å°±æ˜¯å®é™…ä»£ç çš„å†…å®¹ã€‚\nid: å¯é€‰å‚æ•°ï¼Œç”¨æ¥å®šä¹‰æ¨¡å—çš„æ ‡è¯†ï¼Œå¦‚æœæ²¡æœ‰æä¾›è¯¥å‚æ•°ï¼Œé»˜è®¤ä½¿ç”¨è„šæœ¬æ–‡ä»¶åï¼ˆå»æ‰æ‹“å±•åï¼‰\ndependencies: æ˜¯ä¸€ä¸ªå½“å‰æ¨¡å—ä¾èµ–çš„ æ¨¡å—åç§°æ•°ç»„*^moduleName[]^* ï¼ŒæŒ‰ç…§ä¾èµ–å…³ç³»åŠ è½½\nfactory: å·¥å‚æ–¹æ³•ï¼Œæ¨¡å—åˆå§‹åŒ–è¦æ‰§è¡Œçš„å‡½æ•°æˆ–å¯¹è±¡\nå¦‚æœä¸º å‡½æ•°*^function^* ï¼Œå®ƒåº”è¯¥åªè¢«æ‰§è¡Œä¸€æ¬¡\nå¦‚æœæ˜¯ å¯¹è±¡*^object^* ï¼Œæ­¤å¯¹è±¡åº”è¯¥ä¸ºæ¨¡å—çš„è¾“å‡ºå€¼\nåº”ç”¨*^usage^* ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº† RequireJS ç®€å•çš„åº”ç”¨ï¼š\n// dependency.js define(() =\u0026gt; { console.log(\u0026#39;dependency.js called\u0026#39;) return { foo: \u0026#39;bar\u0026#39; }; }); // requireModule.js define([\u0026#39;dependency\u0026#39;], dependency =\u0026gt; { console.log(\u0026#39;requireModule.js called\u0026#39;); return { dependency, printName() { console.log(\u0026#39;printName()\u0026#39;); } } }); \u0026lt;!-- index.html --\u0026gt; \u0026lt;script src=\u0026#34;require.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; // åŠ è½½æ¨¡å— require([\u0026#39;requireModule\u0026#39;], function (module) { module.printName(); console.log(module.dependency); }); // dependency.js called // requireModule.js called // printName() // {foo: \u0026#39;bar\u0026#39;} \u0026lt;/script\u0026gt; :memo: Note AMD ä¸ Node å®ç° CommonJS è§„èŒƒçš„åŒºåˆ«\nAMD: éœ€è¦ç”¨ define æ¥æ˜ç¡®å®šä¹‰ä¸€ä¸ªæ¨¡å—ã€ä½¿ç”¨ return å¯¼å‡º Node: éšå¼åŒ…è£…ã€ä½¿ç”¨ module.export å¯¼å‡º å®ƒä»¬çš„ç›®çš„éƒ½æ˜¯è¿›è¡Œä½œç”¨åŸŸéš”ç¦»ï¼Œä»…åœ¨éœ€è¦çš„æ—¶å€™è¢«å¼•å…¥ï¼Œä»è€Œé¿å…è¿‡å»é‚£ç§é€šè¿‡å…¨å±€å˜é‡æˆ–è€…å…¨å±€å‘½åç©ºé—´çš„æ–¹å¼ï¼Œä»¥å…å˜é‡æ±¡æŸ“å’Œä¸å°å¿ƒè¢«ä¿®æ”¹ã€‚\nCMD ^Common-Module-Definition^ CMD Common Module Definition é€šç”¨æ¨¡å—å®šä¹‰\nCMD è§„èŒƒä¸ AMD è§„èŒƒçš„ä¸»è¦åŒºåˆ«åœ¨äºå®šä¹‰æ¨¡å—å’Œä¾èµ–å¼•å…¥çš„éƒ¨åˆ†ã€‚\nåœ¨å‰ç«¯ä½¿ç”¨æ—¶ï¼Œéœ€è¦å¼•å…¥ç›¸åº”çš„åº“ SeaJS ã€‚\nå¯¼å…¥*^use\u0026amp;require^* Sea.js åˆ›å»ºä¸€ä¸ªå…¨å±€å˜é‡ seajs ï¼Œç»é…ç½®åï¼Œé€šè¿‡ä½¿ç”¨ use() å‡½æ•°åŠ è½½å…¥å£æ¨¡å—ï¼š\n:warning: Caution åœ¨ å…¥å£æ¨¡å—*^main^* å†…ï¼Œä»ç„¶ä½¿ç”¨ require() æ–¹æ³•åŠ è½½å…¶å®ƒæ¨¡å—ã€‚\n// seajs çš„ç®€å•é…ç½® seajs.config({ base: \u0026#34;../sea-modules/\u0026#34;, alias: { \u0026#34;jquery\u0026#34;: \u0026#34;jquery/jquery.js\u0026#34; } }); // åŠ è½½å…¥å£æ¨¡å— seajs.use(\u0026#34;../static/hello/src/main\u0026#34;); // main.js å…¥å£æ¨¡å— // æ‰€æœ‰æ¨¡å—éƒ½é€šè¿‡ define æ¥å®šä¹‰ define(function(require, exports, module) { const $ = require(\u0026#39;jquery\u0026#39;); }); å¯¼å‡º*^export^* Sea.js æ¨å´‡ä¸€ä¸ªæ¨¡å—ä¸€ä¸ªæ–‡ä»¶ï¼Œéµå¾ªç»Ÿä¸€çš„å†™æ³•ï¼š\nä¸€ä¸ªæ–‡ä»¶ä¸€ä¸ªæ¨¡å—ï¼Œæ‰€ä»¥ç»å¸¸å°±ç”¨æ–‡ä»¶åä½œä¸ºæ¨¡å— id CMD æ¨å´‡ä¾èµ–å°±è¿‘ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸åœ¨ define çš„å‚æ•°ä¸­å†™ä¾èµ–ï¼Œè€Œæ˜¯åœ¨ factory ä¸­å†™ define([id], [dependencies], factory) factory ^:function^ï¼Œä¼ å…¥ä¸‰ä¸ªå‚æ•°\ntype factory = (require:Function, exports:object, module:object) =\u0026gt; void; require æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œæ¥å— æ¨¡å—æ ‡è¯†*^id^* ä½œä¸ºå”¯ä¸€å‚æ•°ï¼Œç”¨æ¥è·å–å…¶ä»–æ¨¡å—æä¾›çš„æ¥å£\ne.g.: require(id)\nexports æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥å‘å¤–æä¾› æ¨¡å—æ¥å£*^interface^*\nmodule æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸Šé¢å­˜å‚¨äº†ä¸å½“å‰æ¨¡å—ç›¸å…³è”çš„ä¸€äº›å±æ€§å’Œæ–¹æ³•\nç”±äº SeaJS æ”¯æŒä¸ Node.js ç›¸åŒçš„ export å’Œ module.export ï¼Œå› æ­¤å¯ä»¥åƒå†™åç«¯ä»£ç é‚£æ ·å†™å‰ç«¯ä»£ç ã€‚\nåº”ç”¨*^usage^* ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº† SeaJS ç®€å•çš„åº”ç”¨ï¼š\n// æ‰€æœ‰æ¨¡å—éƒ½é€šè¿‡ define æ¥å®šä¹‰ define(function(require, exports, module) { // é€šè¿‡ require å¼•å…¥ä¾èµ– const $ = require(\u0026#39;jquery\u0026#39;); const Spinning = require(\u0026#39;./spinning\u0026#39;); // é€šè¿‡ exports å¯¹å¤–æä¾›æ¥å£ exports.doSomething = ... // æˆ–è€…é€šè¿‡ module.exports æä¾›æ•´ä¸ªæ¥å£ module.exports = ... }); å¼‚åŒ åŒï¼š\nä¸¤è€…åŠ è½½æ¨¡å—çš„æ–¹å¼éƒ½æ˜¯ å¼‚æ­¥*^asynchronous^* ã€‚\nå¼‚ï¼š\næ¨¡å—å®šä¹‰æ—¶å¯¹ä¾èµ–çš„å¤„ç†ä¸åŒ\nAMD æ¨å´‡ä¾èµ– å‰ç½®*^front^* ï¼Œåœ¨å®šä¹‰æ¨¡å—çš„æ—¶å€™å°±è¦å£°æ˜å…¶ä¾èµ–çš„æ¨¡å— CMD æ¨å´‡ä¾èµ– å°±è¿‘*^nearby^* ï¼Œåªæœ‰åœ¨ç”¨åˆ°æŸä¸ªæ¨¡å—çš„æ—¶å€™æ‰ require() å¼•å…¥ æ¨¡å—æ‰§è¡Œçš„æ—¶æœºä¸åŒ\nAMD åœ¨åŠ è½½æ¨¡å—å®Œæˆåå°±ä¼š æ‰§è¡Œ*^immediately-invoke^* è¯¥æ¨¡å—ï¼Œæ‰€æœ‰æ¨¡å—éƒ½ åŠ è½½*^loaded^* å¹¶ æ‰§è¡Œ*^invoke^* å®Œåä¼šè¿›å…¥ require çš„å›è°ƒå‡½æ•°\nå“ªä¸ªå…ˆä¸‹è½½ä¸‹æ¥ï¼Œå“ªä¸ªå…ˆæ‰§è¡Œï¼Œä½†æ˜¯ä¸»é€»è¾‘ä¸€å®šåœ¨æ‰€æœ‰ ä¾èµ–*^rely^* åŠ è½½å®Œæˆåæ‰æ‰§è¡Œ\nCMD åŠ è½½å®ŒæŸä¸ªä¾èµ–æ¨¡å—åå¹¶ä¸æ‰§è¡Œï¼Œåªæ˜¯ä¸‹è½½è€Œå·²ï¼Œåœ¨ æ‰€æœ‰*^promise.all()^* ä¾èµ–æ¨¡å—åŠ è½½å®Œæˆåè¿›å…¥ä¸»é€»è¾‘ï¼Œé‡åˆ° require è¯­å¥çš„æ—¶å€™æ‰æ‰§è¡Œå¯¹åº”çš„æ¨¡å—ï¼Œè¿™æ ·æ¨¡å—çš„æ‰§è¡Œé¡ºåºå’Œä¹¦å†™é¡ºåºæ˜¯å®Œå…¨ä¸€è‡´çš„\nğŸ§ª Experimental å¦‚æœ SeaJs çœŸçš„æ˜¯å¼‚æ­¥åŠ è½½ï¼Œé‚£ä¹ˆå¯èƒ½æ˜¯é€šè¿‡ config ä¸­çš„ alias æ¥åˆ¤æ–­å“ªäº›æ¨¡å—éœ€è¦å¼‚æ­¥åŠ è½½ï¼Œç„¶åè¿è¡Œç±»ä¼¼ Promise.all().then() çš„æœºç†è°ƒç”¨ä¸»æ¨¡å—ã€‚\nå› æ­¤æ¥è¯´ AMD ç›¸å¯¹ç”¨æˆ·ä½“éªŒæ›´å¥½ï¼Œä¸€æ—¦åŠ è½½å®Œæˆåä¾èµ–æ¨¡å—å³å¯æå‰æ‰§è¡Œã€‚\nCommonJS CommonJS è§„èŒƒçš„æå‡ºï¼Œä¸»è¦æ˜¯ä¸ºäº†å¼¥è¡¥å½“å‰ JavaScript æ²¡æœ‰æ ‡å‡†çš„ç¼ºé™·ï¼Œä»¥å…·å¤‡å¼€å‘å¤§å‹åº”ç”¨çš„åŸºç¡€èƒ½åŠ›ï¼Œè€Œä¸æ˜¯åœç•™åœ¨å°è„šæœ¬ç¨‹åºçš„é˜¶æ®µã€‚å®ƒå¯¹æ¨¡å—çš„å®šä¹‰ååˆ†ç®€å•ï¼Œæ¯ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œæœ‰è‡ªå·±çš„ä½œç”¨åŸŸã€‚åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œé¢å®šä¹‰çš„å˜é‡ã€å‡½æ•°ã€ç±»ï¼Œéƒ½æ˜¯ç§æœ‰çš„ï¼Œå¯¹å…¶ä»–æ–‡ä»¶ä¸å¯è§ã€‚\nåœ¨åç«¯ï¼ŒNode å€Ÿé‰´ CommonJS çš„ Modules è§„èŒƒå®ç°äº†ä¸€å¥—éå¸¸æ˜“ç”¨çš„æ¨¡å—ç³»ç»Ÿï¼Œè€Œ NPM å¯¹ Packages è§„èŒƒçš„å®Œå¥½æ”¯æŒä½¿å¾— Node åº”ç”¨åœ¨å¼€å‘è¿‡ç¨‹ä¸­äº‹åŠåŠŸå€ã€‚\nä¸»è¦åˆ†ä¸º æ¨¡å—å¼•ç”¨*^require^* ã€æ¨¡å—å®šä¹‰*^exports^* å’Œ æ¨¡å—æ ‡è¯†*^mark^* ï¼Œè€Œæ¯ä¸ªæ¨¡å—ä¸­åˆæš´éœ²äº†ä¸¤ä¸ªæ–¹æ³• require å’Œ module ã€‚\næ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡ require() æ–¹æ³•æ¥åŒæ­¥åœ°åŠ è½½ä¾èµ–çš„å…¶ä»–æ¨¡å—ï¼Œé€šè¿‡ module.exports å¯¼å‡ºéœ€è¦æš´éœ²çš„æ¥å£ã€‚\nå…¼å®¹ ESM åœ¨ type:\u0026quot;module\u0026quot; çš„ package.json è®¾ç½®ä¸­ï¼Œå°†éƒ¨åˆ†ä½¿ç”¨ CommonJS çš„æ–‡ä»¶æ‹“å±•åä¿®æ”¹ä¸º .cjs ï¼Œå³å¯åœ¨æœ¬æ–‡ä»¶ä¸­ä½¿ç”¨ require å’Œ module.export æ¥ä»£æ›¿ ES6 çš„ import å’Œ export ã€‚\n// 1. åŠ è½½å†…ç½®çš„fsæ¨¡å— const fs = require(\u0026#39;fs\u0026#39;) // 2. åŠ è½½ç”¨æˆ·çš„è‡ªå®šä¹‰æ¨¡å— const custom = require(\u0026#39;./custom.js\u0026#39;) // 3. åŠ è½½ç¬¬ä¸‰æ–¹æ¨¡å— const moment = require(\u0026#39;moment\u0026#39;) // å½“ä½¿ç”¨require()æ–¹æ³•åŠ è½½å…¶å®ƒæ¨¡å—æ—¶ï¼Œä¼šæ‰§è¡Œè¢«åŠ è½½æ¨¡å—ä¸­çš„ä»£ç  å¯¼å…¥*^require^* æ¨¡å—å¼•ç”¨çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\nconst math = require(\u0026#39;math\u0026#39;); åœ¨ CommonJS** ^CJS^ è§„èŒƒä¸­ï¼Œå­˜åœ¨ require() æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ¥å— æ¨¡å—æ ‡è¯† ï¼Œä»¥æ­¤å¼•å…¥ä¸€ä¸ªæ¨¡å—çš„ API åˆ°å½“å‰ä¸Šä¸‹æ–‡ä¸­ã€‚\n:memo: Note\nES Module ^ESM^ ç”¨çš„æ˜¯ require å’Œ export ï¼ŒäºŒè€…ä¸èƒ½æ··ç”¨ã€‚\næ¨¡å—æ ‡è¯†\nä¼ é€’ç»™ require() æ–¹æ³•çš„å‚æ•°ï¼Œå®ƒå¿…é¡»æ˜¯ç¬¦åˆå°é©¼å³°å‘½åçš„å­—ç¬¦ä¸²ï¼Œæˆ–è€…ä»¥./..å¼€å¤´çš„ç›¸å¯¹è·¯å¾„ï¼Œæˆ–è€…ç»å¯¹è·¯å¾„ã€‚å¯ä»¥æ²¡æœ‰æ–‡ä»¶ååç¼€ .js ã€‚\næ¯ä¸ªæ¨¡å—å…·æœ‰ç‹¬ç«‹çš„å‘½åç©ºé—´å¹¶äº’ä¸å¹²æ‰°ã€‚\n:link: Href å…³äº CommonJS å¦‚ä½•å®ç°å¯¼å…¥ï¼Œå‚è§ æŸ¥æ‰¾ ä¸€èŠ‚ã€‚\nå¯¼å‡º*^module.export^* åœ¨æ¨¡å—ä¸­ï¼Œä¸Šä¸‹æ–‡æä¾› require() æ–¹æ³•æ¥å¼•å…¥å¤–éƒ¨æ¨¡å—ã€‚å¯¹åº”å¼•å…¥çš„åŠŸèƒ½ï¼Œä¸Šä¸‹æ–‡æä¾›äº† exports å¯¹è±¡ç”¨äº å¯¼å‡º*^exports^* å½“å‰æ¨¡å—çš„æ–¹æ³•æˆ–è€…å˜é‡ï¼Œå¹¶ä¸”å®ƒæ˜¯ å”¯ä¸€ å¯¼å‡ºçš„å‡ºå£ã€‚é»˜è®¤ module.exports çš„å€¼ä¸º {} ï¼Œä¹Ÿå¯ä»¥å°†å…¶èµ‹ä¸ºå…¶å®ƒå€¼ã€‚ä¾‹å¦‚ 123 ã€‚\nâš ï¸ Caution è™½ç„¶ CommonJS æš´éœ²äº† exports ï¼Œä½†ä¸è¦å¯¹å…¶ç›´æ¥èµ‹å€¼ã€‚è¿™æ˜¯å› ä¸º exports åªæ˜¯ module.exports çš„å¼•ç”¨å¯¹è±¡ï¼Œä¿®æ”¹å®ƒå¹¶ä¸ä¼šä¿®æ”¹æ¨¡å—å¯¼å‡ºå†…å®¹ã€‚ä¸€ä¸ªå¯è¡Œçš„æ›¿ä»£æ–¹æ³•æ˜¯ä½¿ç”¨ exports. ... é“¾å¼èµ‹å€¼ã€‚\nåœ¨æ¨¡å—ä¸­ï¼Œè¿˜å­˜åœ¨ä¸€ä¸ª module å¯¹è±¡ï¼Œå®ƒä»£è¡¨æ¨¡å—è‡ªèº«ï¼Œè€Œ exports æ˜¯ module çš„å±æ€§ã€‚åœ¨ Node ä¸­ï¼Œä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œå°†æ–¹æ³•æŒ‚è½½åœ¨ module.exports å¯¹è±¡ä¸Šä½œä¸ºå±æ€§å³å¯å®šä¹‰å¯¼å‡ºçš„æ–¹å¼ï¼š\n// math.js /* same directory */ module.exports = { add(...args) { let sum = 0; for (const arg of args) { sum += arg; } return sum; } }; åœ¨å¦ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ require() æ–¹æ³•å¼•å…¥æ¨¡å—åï¼Œå°±èƒ½è°ƒç”¨å®šä¹‰çš„å±æ€§æˆ–æ–¹æ³•äº†ï¼š\n// main.js const math = require(\u0026#39;./math\u0026#39;); console.log(math.add(1, 2, 3, 4, 5)); // 15 :link: Href Es Module\nå…¼å®¹å¤šç§æ¨¡å—è§„èŒƒ ä¸ºäº†è®©åŒä¸€ä¸ªæ¨¡å—å¯ä»¥è¿è¡Œåœ¨å‰åç«¯ï¼Œåœ¨å†™ä½œè¿‡ç¨‹ä¸­éœ€è¦è€ƒè™‘å…¼å®¹å‰ç«¯ä¹Ÿå®ç°äº†æ¨¡å—è§„èŒƒçš„ç¯å¢ƒã€‚ä¸ºäº†ä¿æŒå‰åç«¯çš„ä¸€è‡´æ€§ï¼Œç±»åº“å¼€å‘è€…éœ€è¦å°†ç±»åº“ä»£ç åŒ…è£…åœ¨ä¸€ä¸ªé—­åŒ…å†…ã€‚ä»¥ä¸‹ä»£ç æ¼”ç¤ºå¦‚ä½•å°†æ–¹æ³•å®šä¹‰åˆ°ä¸åŒçš„è¿è¡Œç¯å¢ƒä¸­ï¼Œå®ƒèƒ½å¤Ÿå…¼å®¹ Node ã€AMD ã€CMD ä»¥åŠå¸¸è§çš„æµè§ˆå™¨ç¯å¢ƒä¸­ï¼š\n(function (commonJS, name) { const returnValue = commonJS(); // æ£€æµ‹ä¸Šä¸‹æ–‡ç¯å¢ƒæ˜¯å¦ä¸ºAMDæˆ–CMD const hasDefine = typeof define === \u0026#39;function\u0026#39;; // æ£€æŸ¥ä¸Šä¸‹æ–‡ç¯å¢ƒæ˜¯å¦ä¸ºNode const hasExports = typeof module !== \u0026#39;undefined\u0026#39; \u0026amp;\u0026amp; module.exports; if (hasDefine) { // AMDç¯å¢ƒæˆ–CMDç¯å¢ƒ if (typeof seajs !== \u0026#39;undefined\u0026#39;) { define((require, exports, module) =\u0026gt; { module.exports = returnValue; }); } else { define(returnValue); } } else if (hasExports) { // å®šä¹‰ä¸ºæ™®é€šNodeæ¨¡å— module.exports = returnValue; } else { // å°†æ¨¡å—çš„æ‰§è¡Œç»“æœæŒ‚åœ¨windowå˜é‡ä¸­ï¼Œåœ¨æµè§ˆå™¨ä¸­thisæŒ‡å‘windowå¯¹è±¡ this[name] = returnValue; } })( function commonJS() { // prepare code console.log(\u0026#39;prepare code\u0026#39;); /* ... */ return () =\u0026gt; { // function or object /* ... */ console.log(\u0026#39;returnFun called\u0026#39;); return \u0026#39;ret\u0026#39;; }; }, \u0026#39;test\u0026#39; ); æ²¡æœ‰æ¡†æ¶åœ¨æµè§ˆå™¨ç›´æ¥ä½¿ç”¨ï¼š\n\u0026lt;script src=\u0026#34;test.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; console.log(window.test()); /*...*/ \u0026lt;/script\u0026gt; ä½¿ç”¨ AMD è§„èŒƒçš„ RequireJS ï¼š\n\u0026lt;script src=\u0026#34;require.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; require([\u0026#39;test\u0026#39;],retValue=\u0026gt;{ console.log(retValue); /*...*/ }) \u0026lt;/script\u0026gt; åœ¨åç«¯ Node.js ï¼š\n// node.js const test = require(\u0026#39;./test\u0026#39;); console.log(test()); // prepare code // returnFun called // ret ES Module :link: Href æ¨¡å—æœ¬èº«çš„è¯­æ³•è§ EcmaScript [Module](06 EcmaScript C/#module-es6) ä¸€èŠ‚\nä» ES6 å¼€å§‹ï¼Œåœ¨è¯­è¨€æ ‡å‡†çš„å±‚é¢ä¸Šï¼Œå®ç°äº† æ¨¡å—åŒ–*^modular^* åŠŸèƒ½ï¼Œè€Œä¸”å®ç°å¾—ç›¸å½“ç®€å•ï¼Œå®Œå…¨å¯ä»¥å–ä»£ CommonJS, CMD, AMD è§„èŒƒï¼Œæˆä¸ºæµè§ˆå™¨å’ŒæœåŠ¡å™¨é€šç”¨çš„æ¨¡å—è§£å†³æ–¹æ¡ˆã€‚\n:memo: Note ES6 Module å’Œ CommonJS çš„åŒºåˆ«\nCommonJS åªèƒ½åœ¨è¿è¡Œæ—¶ç¡®å®šå¯¼å‡ºçš„æ¥å£ï¼Œå®é™…å¯¼å‡ºçš„å°±æ˜¯ä¸€ä¸ª å¯¹è±¡*^function^* ã€‚è€Œ ES6 Module çš„è®¾è®¡æ€æƒ³æ˜¯å°½é‡çš„ é™æ€åŒ–*^static^* ï¼Œä½¿å¾— ç¼–è¯‘*^compile^* æ—¶å°±èƒ½ç¡®å®šæ¨¡å—çš„ä¾èµ–å…³ç³»ï¼Œä»¥åŠå¯¼å…¥å’Œå¯¼å‡ºçš„å˜é‡ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„ ç¼–è¯‘æ—¶åŠ è½½load at complie ã€‚\næ­£å› ä¸ºå¦‚æ­¤ï¼Œimport å‘½ä»¤å…·æœ‰ æå‡*^promote^* æ•ˆæœï¼Œä¼šæå‡åˆ°æ•´ä¸ªæ¨¡å—çš„å¤´éƒ¨ï¼Œé¦–å…ˆ æ‰§è¡Œã€‚\nä¼ ç»Ÿæ–¹æ³• HTML ç½‘é¡µä¸­ï¼Œæµè§ˆå™¨é€šè¿‡ \u0026lt;script\u0026gt; æ ‡ç­¾åŠ è½½ JavaScript è„šæœ¬ã€‚\n\u0026lt;!-- é¡µé¢å†…åµŒçš„è„šæœ¬ --\u0026gt; \u0026lt;script\u0026gt; // module code \u0026lt;/script\u0026gt; \u0026lt;!-- å¤–éƒ¨è„šæœ¬ --\u0026gt; \u0026lt;script src=\u0026#34;path/to/myModule.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; é»˜è®¤æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨æ˜¯ åŒæ­¥*^synchronous^* åŠ è½½ JavaScript è„šæœ¬ï¼Œå³æ¸²æŸ“å¼•æ“é‡åˆ° \u0026lt;script\u0026gt; æ ‡ç­¾å°±ä¼šåœä¸‹æ¥ï¼Œç­‰åˆ°æ‰§è¡Œå®Œè„šæœ¬ï¼Œå†ç»§ç»­å‘ä¸‹æ¸²æŸ“ã€‚å¦‚æœæ˜¯å¤–éƒ¨è„šæœ¬ï¼Œè¿˜å¿…é¡»åŠ å…¥è„šæœ¬ä¸‹è½½çš„æ—¶é—´ã€‚\nå¦‚æœè„šæœ¬ä½“ç§¯å¾ˆå¤§ï¼Œä¸‹è½½å’Œæ‰§è¡Œçš„æ—¶é—´å°±ä¼šå¾ˆé•¿ï¼Œå› æ­¤é€ æˆæµè§ˆå™¨ å µå¡*^block^* ï¼Œç”¨æˆ·ä¼šæ„Ÿè§‰åˆ°æµè§ˆå™¨â€œå¡æ­»â€äº†ï¼Œæ²¡æœ‰ä»»ä½•å“åº”ã€‚è¿™æ˜¾ç„¶æ˜¯å¾ˆä¸å¥½çš„ä½“éªŒï¼Œæ‰€ä»¥æµè§ˆå™¨å…è®¸è„šæœ¬å¼‚æ­¥åŠ è½½ï¼Œä¸‹é¢å°±æ˜¯ä¸¤ç§å¼‚æ­¥åŠ è½½çš„è¯­æ³•ã€‚\n\u0026lt;script src=\u0026#34;path/to/myModule.js\u0026#34; defer\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;path/to/myModule.js\u0026#34; async\u0026gt;\u0026lt;/script\u0026gt; ä¸Šé¢ä»£ç ä¸­ï¼Œ\u0026lt;script\u0026gt; æ ‡ç­¾æ‰“å¼€ defer æˆ– async å±æ€§ï¼Œè„šæœ¬å°±ä¼š å¼‚æ­¥*^asynchronous^* åŠ è½½ã€‚æ¸²æŸ“å¼•æ“é‡åˆ°è¿™ä¸€è¡Œå‘½ä»¤ï¼Œå°±ä¼šå¼€å§‹ä¸‹è½½å¤–éƒ¨è„šæœ¬ï¼Œä½†ä¸ä¼šç­‰å®ƒä¸‹è½½å’Œæ‰§è¡Œï¼Œè€Œæ˜¯ç›´æ¥æ‰§è¡Œåé¢çš„å‘½ä»¤ã€‚\ndefer ä¸ async çš„åŒºåˆ«æ˜¯ï¼š\ndefer è¦ç­‰åˆ°æ•´ä¸ªé¡µé¢åœ¨å†…å­˜ä¸­æ­£å¸¸æ¸²æŸ“ç»“æŸï¼ˆ DOM ç»“æ„å®Œå…¨ç”Ÿæˆï¼Œä»¥åŠå…¶ä»–è„šæœ¬æ‰§è¡Œå®Œæˆï¼‰ï¼Œæ‰ä¼šæ‰§è¡Œï¼Œç±»ä¼¼äº window.onload\nasync ä¸€æ—¦ä¸‹è½½å®Œï¼Œæ¸²æŸ“å¼•æ“å°±ä¼š æš‚åœ*^pause^* æ¸²æŸ“ï¼Œæ‰§è¡Œè¿™ä¸ªè„šæœ¬ä»¥åï¼Œå†ç»§ç»­æ¸²æŸ“ã€‚ä¸€å¥è¯ï¼Œdefer æ˜¯â€œæ¸²æŸ“å®Œå†æ‰§è¡Œâ€ï¼Œasync æ˜¯â€œä¸‹è½½å®Œå°±æ‰§è¡Œâ€\nå¦å¤–ï¼Œå¦‚æœæœ‰å¤šä¸ª defer è„šæœ¬ï¼Œä¼šæŒ‰ç…§å®ƒä»¬åœ¨é¡µé¢å‡ºç°çš„é¡ºåºåŠ è½½ï¼Œè€Œå¤šä¸ª async è„šæœ¬æ˜¯ä¸èƒ½ä¿è¯åŠ è½½é¡ºåºçš„ã€‚\nscript æ ‡ç­¾ JS æ‰§è¡Œé¡ºåº æ˜¯å¦é˜»å¡è§£æ HTML \u0026lt;script\u0026gt; åœ¨ HTML ä¸­çš„é¡ºåº é˜»å¡ \u0026lt;script async\u0026gt; ç½‘ç»œè¯·æ±‚è¿”å›é¡ºåº å¯èƒ½é˜»å¡ï¼Œä¹Ÿå¯èƒ½ä¸é˜»å¡ \u0026lt;script defer\u0026gt; åœ¨ HTML ä¸­çš„é¡ºåº ä¸é˜»å¡ âš ï¸ Caution ä¸ç®¡æ˜¯ async è¿˜æ˜¯ defer æ ‡ç­¾ï¼Œä½¿ç”¨å‰éƒ½å¿…é¡»å…ˆå¸¦ä¸Š type=\u0026quot;module\u0026quot; ã€‚\nåŠ è½½è§„åˆ™ æµè§ˆå™¨ æµè§ˆå™¨åŠ è½½ ES6 æ¨¡å—ï¼Œä¹Ÿä½¿ç”¨ \u0026lt;script\u0026gt; æ ‡ç­¾ï¼Œä½†æ˜¯è¦åŠ å…¥ type=\u0026quot;module\u0026quot; å±æ€§ã€‚\n\u0026lt;script type=\u0026#34;module\u0026#34; src=\u0026#34;./foo.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; ä¸Šé¢ä»£ç åœ¨ç½‘é¡µä¸­æ’å…¥ä¸€ä¸ªæ¨¡å— foo.js ï¼Œç”±äº type å±æ€§è®¾ä¸ºmoduleï¼Œæ‰€ä»¥æµè§ˆå™¨çŸ¥é“è¿™æ˜¯ä¸€ä¸ª ES6 æ¨¡å—ã€‚\nâ­ï¸ Important æµè§ˆå™¨å¯¹äºå¸¦æœ‰ type=\u0026quot;module\u0026quot; çš„ \u0026lt;script\u0026gt; ï¼Œéƒ½æ˜¯å¼‚æ­¥åŠ è½½ï¼Œä¸ä¼šé€ æˆå µå¡æµè§ˆå™¨ï¼Œå³ç­‰åˆ°æ•´ä¸ªé¡µé¢æ¸²æŸ“å®Œï¼Œå†æ‰§è¡Œæ¨¡å—è„šæœ¬ï¼Œç­‰åŒäºæ‰“å¼€äº† \u0026lt;script\u0026gt; æ ‡ç­¾çš„ defer å±æ€§ ã€‚\n\u0026lt;script type=\u0026#34;module\u0026#34; src=\u0026#34;./foo.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;!-- ç­‰åŒäº --\u0026gt; \u0026lt;script type=\u0026#34;module\u0026#34; src=\u0026#34;./foo.js\u0026#34; defer\u0026gt;\u0026lt;/script\u0026gt; å¦‚æœç½‘é¡µæœ‰å¤šä¸ª \u0026lt;script type=\u0026quot;module\u0026quot;\u0026gt; ï¼Œå®ƒä»¬ä¼šåœ¨å¼‚æ­¥åŠ è½½å®Œæ¯•åï¼ŒæŒ‰ç…§åœ¨é¡µé¢å‡ºç°çš„é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚\n\u0026lt;script\u0026gt; æ ‡ç­¾çš„ async å±æ€§ä¹Ÿå¯ä»¥æ‰“å¼€ï¼Œè¿™æ—¶åªè¦åŠ è½½å®Œæˆï¼Œæ¸²æŸ“å¼•æ“å°±ä¼šä¸­æ–­æ¸²æŸ“ç«‹å³æ‰§è¡Œã€‚æ‰§è¡Œå®Œæˆåï¼Œå†æ¢å¤æ¸²æŸ“ã€‚\n\u0026lt;script type=\u0026#34;module\u0026#34; src=\u0026#34;./foo.js\u0026#34; async\u0026gt;\u0026lt;/script\u0026gt; ä¸€æ—¦ä½¿ç”¨äº† async å±æ€§ï¼Œ\u0026lt;script type=\u0026quot;module\u0026quot;\u0026gt; å°±ä¸ä¼šæŒ‰ç…§åœ¨é¡µé¢å‡ºç°çš„é¡ºåºæ‰§è¡Œï¼Œè€Œæ˜¯åªè¦è¯¥æ¨¡å—åŠ è½½å®Œæˆï¼Œå°±æ‰§è¡Œè¯¥æ¨¡å—ã€‚\nES6 æ¨¡å—ä¹Ÿå…è®¸å†…åµŒåœ¨ç½‘é¡µä¸­ï¼Œè¯­æ³•è¡Œä¸ºä¸åŠ è½½å¤–éƒ¨è„šæœ¬å®Œå…¨ä¸€è‡´ã€‚\n\u0026lt;script type=\u0026#34;module\u0026#34;\u0026gt; import utils from \u0026#34;./utils.js\u0026#34;; /*...*/ \u0026lt;/script\u0026gt; ä¸¾ä¾‹æ¥è¯´ï¼ŒjQuery å°±æ”¯æŒæ¨¡å—åŠ è½½ã€‚\n\u0026lt;script type=\u0026#34;module\u0026#34;\u0026gt; import $ from \u0026#34;./jquery/src/jquery.js\u0026#34;; $(\u0026#39;#message\u0026#39;).text(\u0026#39;Hi from jQuery!\u0026#39;); \u0026lt;/script\u0026gt; :memo: Note å¯¹äºå¤–éƒ¨çš„æ¨¡å—è„šæœ¬ï¼ˆä¸Šä¾‹æ˜¯ foo.js ï¼‰ï¼Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ã€‚\nä»£ç æ˜¯åœ¨æ¨¡å—ä½œç”¨åŸŸä¹‹ä¸­è¿è¡Œï¼Œè€Œä¸æ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸè¿è¡Œã€‚æ¨¡å—å†…éƒ¨çš„é¡¶å±‚å˜é‡ï¼Œå¤–éƒ¨ä¸å¯è§ æ¨¡å—è„šæœ¬è‡ªåŠ¨é‡‡ç”¨ä¸¥æ ¼æ¨¡å¼ï¼Œä¸ç®¡æœ‰æ²¡æœ‰å£°æ˜ use strict æ¨¡å—ä¹‹ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ import å‘½ä»¤åŠ è½½å…¶ä»–æ¨¡å—ï¼ˆ .js åç¼€ä¸å¯çœç•¥ï¼Œéœ€è¦æä¾›ç»å¯¹ URL æˆ–ç›¸å¯¹ URLï¼‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ export å‘½ä»¤è¾“å‡ºå¯¹å¤–æ¥å£ æ¨¡å—ä¹‹ä¸­ï¼Œé¡¶å±‚çš„ this å…³é”®å­—è¿”å› undefined ï¼Œè€Œä¸æ˜¯æŒ‡å‘ window ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ¨¡å—é¡¶å±‚ä½¿ç”¨ this å…³é”®å­—ï¼Œæ˜¯æ— æ„ä¹‰çš„ åŒä¸€ä¸ªæ¨¡å—å¦‚æœåŠ è½½å¤šæ¬¡ï¼Œå°†åªæ‰§è¡Œä¸€æ¬¡ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹æ¨¡å—ã€‚\nimport utils from \u0026#39;https://example.com/js/utils.js\u0026#39;; const x = 1; console.log(x === window.x); //false console.log(this === undefined); // true åˆ©ç”¨é¡¶å±‚çš„ this æŒ‡å‘ undefined è¿™ä¸ªè¯­æ³•ç‚¹ï¼Œå¯ä»¥ä¾¦æµ‹å½“å‰ä»£ç æ˜¯å¦åœ¨ ES6 æ¨¡å—ä¹‹ä¸­ã€‚\nconst isNotModuleScript = this !== undefined; Node.js Node.js è¦æ±‚ ES6 æ¨¡å—é‡‡ç”¨ .mjs åç¼€æ–‡ä»¶åã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦è„šæœ¬æ–‡ä»¶é‡Œé¢ä½¿ç”¨ import æˆ–è€… export å‘½ä»¤ï¼Œé‚£ä¹ˆå°±å¿…é¡»é‡‡ç”¨ .mjs åç¼€åã€‚Node.js é‡åˆ° .mjs æ–‡ä»¶ï¼Œå°±è®¤ä¸ºå®ƒæ˜¯ ES6 æ¨¡å—ï¼Œé»˜è®¤å¯ç”¨ä¸¥æ ¼æ¨¡å¼ï¼Œä¸å¿…åœ¨æ¯ä¸ªæ¨¡å—æ–‡ä»¶é¡¶éƒ¨æŒ‡å®š 'use strict' ã€‚\nå¦‚æœä¸å¸Œæœ›å°†åç¼€åæ”¹æˆ .mjs ï¼Œå¯ä»¥åœ¨é¡¹ç›®çš„ package.json æ–‡ä»¶ä¸­ï¼ŒæŒ‡å®š type å­—æ®µä¸º module ã€‚æ­¤æ—¶å³å¯ä½¿ç”¨ import å’Œ export æ–¹æ³•ã€‚\n/* package.json */ { \u0026#34;type\u0026#34;: \u0026#34;module\u0026#34; } å¦‚æœè¿™æ—¶è¿˜è¦ä½¿ç”¨ CommonJS æ¨¡å—ï¼Œé‚£ä¹ˆéœ€è¦å°† CommonJS è„šæœ¬çš„åç¼€åéƒ½æ”¹æˆ .cjs ã€‚å¦‚æœæ²¡æœ‰ type å­—æ®µï¼Œæˆ–è€… type å­—æ®µä¸º commonjs ï¼Œåˆ™ .js è„šæœ¬é»˜è®¤è¢«è§£é‡Šæˆ CommonJS æ¨¡å—ã€‚\nç›¸äº’å…¼å®¹*^Mutually^* ^Compatible^ è™½ç„¶ ES Module å·²é€æ¸æˆä¸ºä¸»æµï¼Œä½†å¸‚é¢ä¸Šä»å­˜åœ¨è®¸å¤šä½¿ç”¨ CommonJS çš„åŒ…ï¼Œéœ€è¦è½¬æ¢å…¼å®¹ã€‚\nè½¬æ¢ ^CommonJS^ âŸ¹ ^ES6^ CommonJS çš„ require() å‘½ä»¤ä¸èƒ½åŠ è½½ ES6 æ¨¡å—ï¼Œä¼šæŠ¥é”™ï¼Œåªèƒ½ä½¿ç”¨ import() è¿™ä¸ªæ–¹æ³•åŠ è½½ã€‚\n(async () =\u0026gt; { await import(\u0026#39;./my-app.mjs\u0026#39;); })(); ä¸Šé¢ä»£ç å¯ä»¥åœ¨ CommonJS æ¨¡å—ä¸­è¿è¡Œã€‚\nrequire() ä¸æ”¯æŒ ES6 æ¨¡å—çš„ä¸€ä¸ªåŸå› æ˜¯ï¼Œå®ƒæ˜¯ åŒæ­¥åŠ è½½ ï¼Œè€Œ ES6 æ¨¡å—å†…éƒ¨å¯ä»¥ä½¿ç”¨é¡¶å±‚ await å‘½ä»¤ï¼Œå¯¼è‡´æ— æ³•è¢«åŒæ­¥åŠ è½½ã€‚\n^ES6^ âŸ¹ ^CommonJS^ ES6 æ¨¡å—çš„ import å‘½ä»¤å¯ä»¥åŠ è½½ CommonJS æ¨¡å—ï¼Œä½†æ˜¯åªèƒ½æ•´ä½“åŠ è½½ï¼Œä¸èƒ½åªåŠ è½½å•ä¸€çš„è¾“å‡ºé¡¹ã€‚\n// æ­£ç¡® import packageMain from \u0026#39;commonjs-package\u0026#39;; // æŠ¥é”™ import { method } from \u0026#39;commonjs-package\u0026#39;; è¿™æ˜¯å› ä¸º ES6 æ¨¡å—éœ€è¦æ”¯æŒé™æ€ä»£ç åˆ†æï¼Œè€Œ CommonJS æ¨¡å—çš„è¾“å‡ºæ¥å£æ˜¯ module.exports ï¼Œæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ— æ³•è¢«é™æ€åˆ†æï¼Œæ‰€ä»¥åªèƒ½æ•´ä½“åŠ è½½ã€‚\nåŠ è½½å•ä¸€çš„è¾“å‡ºé¡¹ï¼Œå¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ã€‚\nimport packageMain from \u0026#39;commonjs-package\u0026#39;; const { method } = packageMain; è¿˜æœ‰ä¸€ç§å˜é€šçš„åŠ è½½æ–¹æ³•ï¼Œå°±æ˜¯ä½¿ç”¨ Node.js å†…ç½®çš„ module.createRequire() æ–¹æ³•ã€‚\n// cjs.cjs module.exports = \u0026#39;cjs\u0026#39;; // esm.mjs import { createRequire } from \u0026#39;module\u0026#39;; const require = createRequire(import.meta.url); const cjs = require(\u0026#39;./cjs.cjs\u0026#39;); cjs === \u0026#39;cjs\u0026#39;; // true ä¸Šé¢ä»£ç ä¸­ï¼ŒES6 æ¨¡å—é€šè¿‡ module.createRequire() æ–¹æ³•å¯ä»¥åŠ è½½ CommonJS æ¨¡å—ã€‚ä½†æ˜¯ï¼Œè¿™ç§å†™æ³•ç­‰äºå°† ES6 å’Œ CommonJS æ··åœ¨ä¸€èµ·äº†ï¼Œæ‰€ä»¥ä¸å»ºè®®ä½¿ç”¨ã€‚\nåŒæ—¶æ”¯æŒä¸¤ç§æ ¼å¼çš„æ¨¡å— ä¸€ä¸ªæ¨¡å—åŒæ—¶è¦æ”¯æŒ CommonJS å’Œ ES6 ä¸¤ç§æ ¼å¼ï¼Œä¹Ÿå¾ˆå®¹æ˜“ã€‚\nå¦‚æœåŸå§‹æ¨¡å—æ˜¯ ES6 æ ¼å¼ï¼Œé‚£ä¹ˆéœ€è¦ç»™å‡ºä¸€ä¸ªæ•´ä½“è¾“å‡ºæ¥å£ï¼Œæ¯”å¦‚ export default objï¼Œä½¿å¾— CommonJS å¯ä»¥ç”¨ import() è¿›è¡ŒåŠ è½½ã€‚\nå¦‚æœåŸå§‹æ¨¡å—æ˜¯ CommonJS æ ¼å¼ï¼Œé‚£ä¹ˆå¯ä»¥åŠ ä¸€ä¸ª åŒ…è£…å±‚*^wrapper^* ã€‚\nimport cjsModule from \u0026#39;../index.js\u0026#39;; export const foo = cjsModule.foo; ä¸Šé¢ä»£ç å…ˆæ•´ä½“è¾“å…¥ CommonJS æ¨¡å—ï¼Œç„¶åå†æ ¹æ®éœ€è¦è¾“å‡ºå…·åæ¥å£ã€‚\nä½ å¯ä»¥æŠŠè¿™ä¸ªæ–‡ä»¶çš„åç¼€åæ”¹ä¸º .mjs ï¼Œæˆ–è€…å°†å®ƒæ”¾åœ¨ä¸€ä¸ªå­ç›®å½•ï¼Œå†åœ¨è¿™ä¸ªå­ç›®å½•é‡Œé¢æ”¾ä¸€ä¸ªå•ç‹¬çš„ package.json æ–‡ä»¶ï¼ŒæŒ‡æ˜ { type: \u0026quot;module\u0026quot; } ã€‚\nå¦ä¸€ç§åšæ³•æ˜¯åœ¨ package.json æ–‡ä»¶çš„ exports å­—æ®µï¼ŒæŒ‡æ˜ä¸¤ç§æ ¼å¼æ¨¡å—å„è‡ªçš„åŠ è½½å…¥å£ã€‚\n\u0026#34;exports\u0026#34;ï¼š{ \u0026#34;require\u0026#34;: \u0026#34;./index.js\u0026#34;, \u0026#34;import\u0026#34;: \u0026#34;./esm/wrapper.js\u0026#34; } ä¸Šé¢ä»£ç æŒ‡å®š require() å’Œ import ï¼ŒåŠ è½½è¯¥æ¨¡å—ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°ä¸ä¸€æ ·çš„å…¥å£æ–‡ä»¶ã€‚\nNode.js çš„å†…ç½®æ¨¡å— Node.js çš„å†…ç½®æ¨¡å—å¯ä»¥æ•´ä½“åŠ è½½ï¼Œä¹Ÿå¯ä»¥åŠ è½½æŒ‡å®šçš„è¾“å‡ºé¡¹ã€‚\n// æ•´ä½“åŠ è½½ import EventEmitter from \u0026#39;events\u0026#39;; const e = new EventEmitter(); // åŠ è½½æŒ‡å®šçš„è¾“å‡ºé¡¹ import { readFile } from \u0026#39;fs\u0026#39;; readFile(\u0026#39;./foo.txt\u0026#39;, (err, source) =\u0026gt; { if (err) { console.error(err); } else { console.log(source); } }); åŠ è½½è·¯å¾„ â­ï¸ Important\nES6 æ¨¡å—çš„åŠ è½½è·¯å¾„å¿…é¡»ç»™å‡ºè„šæœ¬çš„ å®Œæ•´è·¯å¾„ ï¼Œä¸èƒ½çœç•¥è„šæœ¬çš„åç¼€åã€‚ ä½¿ç”¨ åŒ…*^package^* æ—¶ï¼Œéœ€åœ¨ main/exports å­—æ®µ import å‘½ä»¤å’Œ package.json æ–‡ä»¶çš„ main å­—æ®µå¦‚æœçœç•¥è„šæœ¬çš„åç¼€åï¼Œä¼šæŠ¥é”™ã€‚\n// ES6 æ¨¡å—ä¸­å°†æŠ¥é”™ import { something } from \u0026#39;./index\u0026#39;; ä¸ºäº†ä¸æµè§ˆå™¨çš„ import åŠ è½½è§„åˆ™ç›¸åŒï¼ŒNode.js çš„ .mjs æ–‡ä»¶æ”¯æŒ URL è·¯å¾„ã€‚\nimport \u0026#39;./foo.mjs?query=1\u0026#39;; // åŠ è½½ ./foo ä¼ å…¥å‚æ•° ?query=1 ä¸Šé¢ä»£ç ä¸­ï¼Œè„šæœ¬è·¯å¾„å¸¦æœ‰å‚æ•° ?query=1 ï¼ŒNode ä¼šæŒ‰ URL è§„åˆ™è§£è¯»ã€‚åŒä¸€ä¸ªè„šæœ¬åªè¦å‚æ•°ä¸åŒï¼Œå°±ä¼šè¢«åŠ è½½å¤šæ¬¡ï¼Œå¹¶ä¸”ä¿å­˜æˆä¸åŒçš„ç¼“å­˜ã€‚ç”±äºè¿™ä¸ªåŸå› ï¼Œåªè¦æ–‡ä»¶åä¸­å«æœ‰ :ã€%ã€#ã€? ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œæœ€å¥½å¯¹è¿™äº›å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚\nç›®å‰ï¼ŒNode.js çš„ import å‘½ä»¤åªæ”¯æŒåŠ è½½æœ¬åœ°æ¨¡å—ï¼ˆfile: åè®®ï¼‰å’Œ data:åè®®ï¼Œä¸æ”¯æŒåŠ è½½è¿œç¨‹æ¨¡å—ã€‚å¦å¤–ï¼Œè„šæœ¬è·¯å¾„åªæ”¯æŒç›¸å¯¹è·¯å¾„ï¼Œä¸æ”¯æŒç»å¯¹è·¯å¾„ï¼ˆå³ä»¥/æˆ–//å¼€å¤´çš„è·¯å¾„ï¼‰ã€‚\nå†…éƒ¨å˜é‡ ES6 æ¨¡å—åº”è¯¥æ˜¯é€šç”¨çš„ï¼ŒåŒä¸€ä¸ªæ¨¡å—ä¸ç”¨ä¿®æ”¹ï¼Œå°±å¯ä»¥ç”¨åœ¨æµè§ˆå™¨ç¯å¢ƒå’ŒæœåŠ¡å™¨ç¯å¢ƒã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®æ ‡ï¼ŒNode.js è§„å®š ES6 æ¨¡å—ä¹‹ä¸­ä¸èƒ½ä½¿ç”¨ CommonJS æ¨¡å—çš„ç‰¹æœ‰çš„ä¸€äº›å†…éƒ¨å˜é‡ã€‚\né¦–å…ˆï¼Œå°±æ˜¯ this å…³é”®å­—ã€‚ES6 æ¨¡å—ä¹‹ä¸­ï¼Œé¡¶å±‚çš„ this æŒ‡å‘ undefined ï¼›CommonJS æ¨¡å—çš„é¡¶å±‚ this æŒ‡å‘å½“å‰æ¨¡å—ï¼Œè¿™æ˜¯ä¸¤è€…çš„ä¸€ä¸ªé‡å¤§å·®å¼‚ã€‚\nå…¶æ¬¡ï¼Œarguments, require, module, exports, __filename,__dirnameè¿™äº›é¡¶å±‚å˜é‡åœ¨ ES6 æ¨¡å—ä¹‹ä¸­éƒ½æ˜¯ä¸å­˜åœ¨çš„ã€‚\nå¾ªç¯åŠ è½½*^Circular^* ^Dependency^ å¾ªç¯åŠ è½½Circular Dependency æŒ‡çš„æ˜¯ï¼Œa è„šæœ¬çš„æ‰§è¡Œä¾èµ– b è„šæœ¬ï¼Œè€Œ b è„šæœ¬çš„æ‰§è¡Œåˆä¾èµ– a è„šæœ¬ã€‚\n// a.js const b = require(\u0026#39;b\u0026#39;); // b.js const a = require(\u0026#39;a\u0026#39;); é€šå¸¸ï¼Œâ€œå¾ªç¯åŠ è½½â€è¡¨ç¤ºå­˜åœ¨å¼ºè€¦åˆï¼Œå¦‚æœå¤„ç†ä¸å¥½ï¼Œè¿˜å¯èƒ½å¯¼è‡´é€’å½’åŠ è½½ï¼Œä½¿å¾—ç¨‹åºæ— æ³•æ‰§è¡Œï¼Œå› æ­¤åº”è¯¥é¿å…å‡ºç°ã€‚\nä½†æ˜¯å®é™…ä¸Šï¼Œè¿™æ˜¯å¾ˆéš¾é¿å…çš„ï¼Œå°¤å…¶æ˜¯ä¾èµ–å…³ç³»å¤æ‚çš„å¤§é¡¹ç›®ï¼Œå¾ˆå®¹æ˜“å‡ºç° aä¾ èµ– b ï¼Œb ä¾èµ– c ï¼Œc åˆä¾èµ– a è¿™æ ·çš„æƒ…å†µã€‚è¿™æ„å‘³ç€ï¼Œæ¨¡å—åŠ è½½æœºåˆ¶å¿…é¡»è€ƒè™‘â€œå¾ªç¯åŠ è½½â€çš„æƒ…å†µã€‚\nå¯¹äº JavaScript è¯­è¨€æ¥è¯´ï¼Œç›®å‰æœ€å¸¸è§çš„ä¸¤ç§æ¨¡å—æ ¼å¼ CommonJS å’Œ ES6ï¼Œå¤„ç†â€œå¾ªç¯åŠ è½½â€çš„æ–¹æ³•æ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿”å›çš„ç»“æœä¹Ÿä¸ä¸€æ ·ã€‚\nåŠ è½½åŸç† ä»‹ç» ES6 å¦‚ä½•å¤„ç†â€œå¾ªç¯åŠ è½½â€ä¹‹å‰ï¼Œå…ˆä»‹ç»ç›®å‰æœ€æµè¡Œçš„ CommonJS æ¨¡å—æ ¼å¼çš„åŠ è½½åŸç†ã€‚\nCommonJS çš„ä¸€ä¸ªæ¨¡å—ï¼Œå°±æ˜¯ä¸€ä¸ªè„šæœ¬æ–‡ä»¶ã€‚requireå‘½ä»¤ç¬¬ä¸€æ¬¡åŠ è½½è¯¥è„šæœ¬ï¼Œå°±ä¼šæ‰§è¡Œæ•´ä¸ªè„šæœ¬ï¼Œç„¶ååœ¨å†…å­˜ç”Ÿæˆä¸€ä¸ªå¯¹è±¡ã€‚\n{ id: \u0026#39;...\u0026#39;, exports: { ... }, loaded: true, ... } ä¸Šé¢ä»£ç å°±æ˜¯ Node å†…éƒ¨åŠ è½½æ¨¡å—åç”Ÿæˆçš„ä¸€ä¸ªå¯¹è±¡ã€‚è¯¥å¯¹è±¡çš„idå±æ€§æ˜¯æ¨¡å—åï¼Œexportså±æ€§æ˜¯æ¨¡å—è¾“å‡ºçš„å„ä¸ªæ¥å£ï¼Œloadedå±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥æ¨¡å—çš„è„šæœ¬æ˜¯å¦æ‰§è¡Œå®Œæ¯•ã€‚å…¶ä»–è¿˜æœ‰å¾ˆå¤šå±æ€§ï¼Œè¿™é‡Œéƒ½çœç•¥äº†ã€‚\nä»¥åéœ€è¦ç”¨åˆ°è¿™ä¸ªæ¨¡å—çš„æ—¶å€™ï¼Œå°±ä¼šåˆ°exportså±æ€§ä¸Šé¢å–å€¼ã€‚å³ä½¿å†æ¬¡æ‰§è¡Œrequireå‘½ä»¤ï¼Œä¹Ÿä¸ä¼šå†æ¬¡æ‰§è¡Œè¯¥æ¨¡å—ï¼Œè€Œæ˜¯åˆ°ç¼“å­˜ä¹‹ä¸­å–å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒCommonJS æ¨¡å—æ— è®ºåŠ è½½å¤šå°‘æ¬¡ï¼Œéƒ½åªä¼šåœ¨ç¬¬ä¸€æ¬¡åŠ è½½æ—¶è¿è¡Œä¸€æ¬¡ï¼Œä»¥åå†åŠ è½½ï¼Œå°±è¿”å›ç¬¬ä¸€æ¬¡è¿è¡Œçš„ç»“æœï¼Œé™¤éæ‰‹åŠ¨æ¸…é™¤ç³»ç»Ÿç¼“å­˜ã€‚\nCommonJS CommonJS æ¨¡å—çš„é‡è¦ç‰¹æ€§æ˜¯åŠ è½½æ—¶æ‰§è¡Œï¼Œå³è„šæœ¬ä»£ç åœ¨requireçš„æ—¶å€™ï¼Œå°±ä¼šå…¨éƒ¨æ‰§è¡Œã€‚ä¸€æ—¦å‡ºç°æŸä¸ªæ¨¡å—è¢«\u0026quot;å¾ªç¯åŠ è½½\u0026quot;ï¼Œå°±åªè¾“å‡ºå·²ç»æ‰§è¡Œçš„éƒ¨åˆ†ï¼Œè¿˜æœªæ‰§è¡Œçš„éƒ¨åˆ†ä¸ä¼šè¾“å‡ºã€‚\nè®©æˆ‘ä»¬æ¥çœ‹ï¼ŒNode å®˜æ–¹æ–‡æ¡£é‡Œé¢çš„ä¾‹å­ã€‚è„šæœ¬æ–‡ä»¶a.jsä»£ç å¦‚ä¸‹ã€‚\nexports.done = false; var b = require(\u0026#39;./b.js\u0026#39;); console.log(\u0026#39;åœ¨ a.js ä¹‹ä¸­ï¼Œb.done = %j\u0026#39;, b.done); exports.done = true; console.log(\u0026#39;a.js æ‰§è¡Œå®Œæ¯•\u0026#39;); ä¸Šé¢ä»£ç ä¹‹ä¸­ï¼Œa.jsè„šæœ¬å…ˆè¾“å‡ºä¸€ä¸ªdoneå˜é‡ï¼Œç„¶ååŠ è½½å¦ä¸€ä¸ªè„šæœ¬æ–‡ä»¶b.jsã€‚æ³¨æ„ï¼Œæ­¤æ—¶a.jsä»£ç å°±åœåœ¨è¿™é‡Œï¼Œç­‰å¾…b.jsæ‰§è¡Œå®Œæ¯•ï¼Œå†å¾€ä¸‹æ‰§è¡Œã€‚\nå†çœ‹b.jsçš„ä»£ç ã€‚\nexports.done = false; var a = require(\u0026#39;./a.js\u0026#39;); console.log(\u0026#39;åœ¨ b.js ä¹‹ä¸­ï¼Œa.done = %j\u0026#39;, a.done); exports.done = true; console.log(\u0026#39;b.js æ‰§è¡Œå®Œæ¯•\u0026#39;); ä¸Šé¢ä»£ç ä¹‹ä¸­ï¼Œb.jsæ‰§è¡Œåˆ°ç¬¬äºŒè¡Œï¼Œå°±ä¼šå»åŠ è½½a.jsï¼Œè¿™æ—¶ï¼Œå°±å‘ç”Ÿäº†â€œå¾ªç¯åŠ è½½â€ã€‚ç³»ç»Ÿä¼šå»a.jsæ¨¡å—å¯¹åº”å¯¹è±¡çš„exportså±æ€§å–å€¼ï¼Œå¯æ˜¯å› ä¸ºa.jsè¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼Œä»exportså±æ€§åªèƒ½å–å›å·²ç»æ‰§è¡Œçš„éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯æœ€åçš„å€¼ã€‚\na.jså·²ç»æ‰§è¡Œçš„éƒ¨åˆ†ï¼Œåªæœ‰ä¸€è¡Œã€‚\nexports.done = false; å› æ­¤ï¼Œå¯¹äºb.jsæ¥è¯´ï¼Œå®ƒä»a.jsåªè¾“å…¥ä¸€ä¸ªå˜é‡doneï¼Œå€¼ä¸ºfalseã€‚\nç„¶åï¼Œb.jsæ¥ç€å¾€ä¸‹æ‰§è¡Œï¼Œç­‰åˆ°å…¨éƒ¨æ‰§è¡Œå®Œæ¯•ï¼Œå†æŠŠæ‰§è¡Œæƒäº¤è¿˜ç»™a.jsã€‚äºæ˜¯ï¼Œa.jsæ¥ç€å¾€ä¸‹æ‰§è¡Œï¼Œç›´åˆ°æ‰§è¡Œå®Œæ¯•ã€‚æˆ‘ä»¬å†™ä¸€ä¸ªè„šæœ¬main.jsï¼ŒéªŒè¯è¿™ä¸ªè¿‡ç¨‹ã€‚\nvar a = require(\u0026#39;./a.js\u0026#39;); var b = require(\u0026#39;./b.js\u0026#39;); console.log(\u0026#39;åœ¨ main.js ä¹‹ä¸­, a.done=%j, b.done=%j\u0026#39;, a.done, b.done); æ‰§è¡Œmain.jsï¼Œè¿è¡Œç»“æœå¦‚ä¸‹ã€‚\n$ node main.js åœ¨ b.js ä¹‹ä¸­ï¼Œa.done = false b.js æ‰§è¡Œå®Œæ¯• åœ¨ a.js ä¹‹ä¸­ï¼Œb.done = true a.js æ‰§è¡Œå®Œæ¯• åœ¨ main.js ä¹‹ä¸­, a.done=true, b.done=true ä¸Šé¢çš„ä»£ç è¯æ˜äº†ä¸¤ä»¶äº‹ã€‚ä¸€æ˜¯ï¼Œåœ¨b.jsä¹‹ä¸­ï¼Œa.jsæ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œåªæ‰§è¡Œäº†ç¬¬ä¸€è¡Œã€‚äºŒæ˜¯ï¼Œmain.jsæ‰§è¡Œåˆ°ç¬¬äºŒè¡Œæ—¶ï¼Œä¸ä¼šå†æ¬¡æ‰§è¡Œb.jsï¼Œè€Œæ˜¯è¾“å‡ºç¼“å­˜çš„b.jsçš„æ‰§è¡Œç»“æœï¼Œå³å®ƒçš„ç¬¬å››è¡Œã€‚\nexports.done = true; æ€»ä¹‹ï¼ŒCommonJS è¾“å…¥çš„æ˜¯è¢«è¾“å‡ºå€¼çš„æ‹·è´ï¼Œä¸æ˜¯å¼•ç”¨ã€‚\nå¦å¤–ï¼Œç”±äº CommonJS æ¨¡å—é‡åˆ°å¾ªç¯åŠ è½½æ—¶ï¼Œè¿”å›çš„æ˜¯å½“å‰å·²ç»æ‰§è¡Œçš„éƒ¨åˆ†çš„å€¼ï¼Œè€Œä¸æ˜¯ä»£ç å…¨éƒ¨æ‰§è¡Œåçš„å€¼ï¼Œä¸¤è€…å¯èƒ½ä¼šæœ‰å·®å¼‚ã€‚æ‰€ä»¥ï¼Œè¾“å…¥å˜é‡çš„æ—¶å€™ï¼Œå¿…é¡»éå¸¸å°å¿ƒã€‚\nvar a = require(\u0026#39;a\u0026#39;); // å®‰å…¨çš„å†™æ³• var foo = require(\u0026#39;a\u0026#39;).foo; // å±é™©çš„å†™æ³• exports.good = function (arg) { return a.foo(\u0026#39;good\u0026#39;, arg); // ä½¿ç”¨çš„æ˜¯ a.foo çš„æœ€æ–°å€¼ }; exports.bad = function (arg) { return foo(\u0026#39;bad\u0026#39;, arg); // ä½¿ç”¨çš„æ˜¯ä¸€ä¸ªéƒ¨åˆ†åŠ è½½æ—¶çš„å€¼ }; ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœå‘ç”Ÿå¾ªç¯åŠ è½½ï¼Œrequire('a').foo çš„å€¼å¾ˆå¯èƒ½åé¢ä¼šè¢«æ”¹å†™ï¼Œæ”¹ç”¨require('a')ä¼šæ›´ä¿é™©ä¸€ç‚¹ã€‚\nES6 æ¨¡å— ES6 å¤„ç†â€œå¾ªç¯åŠ è½½â€ä¸ CommonJS æœ‰æœ¬è´¨çš„ä¸åŒã€‚ES6 æ¨¡å—æ˜¯åŠ¨æ€å¼•ç”¨ï¼Œå¦‚æœä½¿ç”¨importä»ä¸€ä¸ªæ¨¡å—åŠ è½½å˜é‡ï¼ˆå³import foo from 'foo'ï¼‰ï¼Œé‚£äº›å˜é‡ä¸ä¼šè¢«ç¼“å­˜ï¼Œè€Œæ˜¯æˆä¸ºä¸€ä¸ªæŒ‡å‘è¢«åŠ è½½æ¨¡å—çš„å¼•ç”¨ï¼Œéœ€è¦å¼€å‘è€…è‡ªå·±ä¿è¯ï¼ŒçœŸæ­£å–å€¼çš„æ—¶å€™èƒ½å¤Ÿå–åˆ°å€¼ã€‚\nè¯·çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ã€‚\n// a.mjs import {bar} from \u0026#39;./b\u0026#39;; console.log(\u0026#39;a.mjs\u0026#39;); console.log(bar); export let foo = \u0026#39;foo\u0026#39;; // b.mjs import {foo} from \u0026#39;./a\u0026#39;; console.log(\u0026#39;b.mjs\u0026#39;); console.log(foo); export let bar = \u0026#39;bar\u0026#39;; ä¸Šé¢ä»£ç ä¸­ï¼Œa.mjsåŠ è½½b.mjsï¼Œb.mjsåˆåŠ è½½a.mjsï¼Œæ„æˆå¾ªç¯åŠ è½½ã€‚æ‰§è¡Œa.mjsï¼Œç»“æœå¦‚ä¸‹ã€‚\n$ node --experimental-modules a.mjs b.mjs ReferenceError: foo is not defined ä¸Šé¢ä»£ç ä¸­ï¼Œæ‰§è¡Œa.mjsä»¥åä¼šæŠ¥é”™ï¼Œfooå˜é‡æœªå®šä¹‰ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ\nè®©æˆ‘ä»¬ä¸€è¡Œè¡Œæ¥çœ‹ï¼ŒES6 å¾ªç¯åŠ è½½æ˜¯æ€ä¹ˆå¤„ç†çš„ã€‚é¦–å…ˆï¼Œæ‰§è¡Œa.mjsä»¥åï¼Œå¼•æ“å‘ç°å®ƒåŠ è½½äº†b.mjsï¼Œå› æ­¤ä¼šä¼˜å…ˆæ‰§è¡Œb.mjsï¼Œç„¶åå†æ‰§è¡Œa.mjsã€‚æ¥ç€ï¼Œæ‰§è¡Œb.mjsçš„æ—¶å€™ï¼Œå·²çŸ¥å®ƒä»a.mjsè¾“å…¥äº†fooæ¥å£ï¼Œè¿™æ—¶ä¸ä¼šå»æ‰§è¡Œa.mjsï¼Œè€Œæ˜¯è®¤ä¸ºè¿™ä¸ªæ¥å£å·²ç»å­˜åœ¨äº†ï¼Œç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚æ‰§è¡Œåˆ°ç¬¬ä¸‰è¡Œconsole.log(foo)çš„æ—¶å€™ï¼Œæ‰å‘ç°è¿™ä¸ªæ¥å£æ ¹æœ¬æ²¡å®šä¹‰ï¼Œå› æ­¤æŠ¥é”™ã€‚\nè§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•ï¼Œå°±æ˜¯è®©b.mjsè¿è¡Œçš„æ—¶å€™ï¼Œfooå·²ç»æœ‰å®šä¹‰äº†ã€‚è¿™å¯ä»¥é€šè¿‡å°†fooå†™æˆå‡½æ•°æ¥è§£å†³ã€‚\n// a.mjs import {bar} from \u0026#39;./b\u0026#39;; console.log(\u0026#39;a.mjs\u0026#39;); console.log(bar()); function foo() { return \u0026#39;foo\u0026#39; } export {foo}; // b.mjs import {foo} from \u0026#39;./a\u0026#39;; console.log(\u0026#39;b.mjs\u0026#39;); console.log(foo()); function bar() { return \u0026#39;bar\u0026#39; } export {bar}; è¿™æ—¶å†æ‰§è¡Œa.mjså°±å¯ä»¥å¾—åˆ°é¢„æœŸç»“æœã€‚\n$ node --experimental-modules a.mjs b.mjs foo a.mjs bar è¿™æ˜¯å› ä¸ºå‡½æ•°å…·æœ‰æå‡ä½œç”¨ï¼Œåœ¨æ‰§è¡Œimport {bar} from './b'æ—¶ï¼Œå‡½æ•°fooå°±å·²ç»æœ‰å®šä¹‰äº†ï¼Œæ‰€ä»¥b.mjsåŠ è½½çš„æ—¶å€™ä¸ä¼šæŠ¥é”™ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œå¦‚æœæŠŠå‡½æ•°fooæ”¹å†™æˆå‡½æ•°è¡¨è¾¾å¼ï¼Œä¹Ÿä¼šæŠ¥é”™ã€‚\n// a.mjs import {bar} from \u0026#39;./b\u0026#39;; console.log(\u0026#39;a.mjs\u0026#39;); console.log(bar()); const foo = () =\u0026gt; \u0026#39;foo\u0026#39;; export {foo}; ä¸Šé¢ä»£ç çš„ç¬¬å››è¡Œï¼Œæ”¹æˆäº†å‡½æ•°è¡¨è¾¾å¼ï¼Œå°±ä¸å…·æœ‰æå‡ä½œç”¨ï¼Œæ‰§è¡Œå°±ä¼šæŠ¥é”™ã€‚\næˆ‘ä»¬å†æ¥çœ‹ ES6 æ¨¡å—åŠ è½½å™¨SystemJSç»™å‡ºçš„ä¸€ä¸ªä¾‹å­ã€‚\n// even.js import { odd } from \u0026#39;./odd\u0026#39; export var counter = 0; export function even(n) { counter++; return n === 0 || odd(n - 1); } // odd.js import { even } from \u0026#39;./even\u0026#39;; export function odd(n) { return n !== 0 \u0026amp;\u0026amp; even(n - 1); } ä¸Šé¢ä»£ç ä¸­ï¼Œeven.jsé‡Œé¢çš„å‡½æ•°evenæœ‰ä¸€ä¸ªå‚æ•°nï¼Œåªè¦ä¸ç­‰äº 0ï¼Œå°±ä¼šå‡å» 1ï¼Œä¼ å…¥åŠ è½½çš„odd()ã€‚odd.jsä¹Ÿä¼šåšç±»ä¼¼æ“ä½œã€‚\nè¿è¡Œä¸Šé¢è¿™æ®µä»£ç ï¼Œç»“æœå¦‚ä¸‹ã€‚\n$ babel-node \u0026gt; import * as m from \u0026#39;./even.js\u0026#39;; \u0026gt; m.even(10); true \u0026gt; m.counter 6 \u0026gt; m.even(20) true \u0026gt; m.counter 17 ä¸Šé¢ä»£ç ä¸­ï¼Œå‚æ•°nä» 10 å˜ä¸º 0 çš„è¿‡ç¨‹ä¸­ï¼Œeven()ä¸€å…±ä¼šæ‰§è¡Œ 6 æ¬¡ï¼Œæ‰€ä»¥å˜é‡counterç­‰äº 6ã€‚ç¬¬äºŒæ¬¡è°ƒç”¨even()æ—¶ï¼Œå‚æ•°nä» 20 å˜ä¸º 0ï¼Œeven()ä¸€å…±ä¼šæ‰§è¡Œ 11 æ¬¡ï¼ŒåŠ ä¸Šå‰é¢çš„ 6 æ¬¡ï¼Œæ‰€ä»¥å˜é‡counterç­‰äº 17ã€‚\nè¿™ä¸ªä¾‹å­è¦æ˜¯æ”¹å†™æˆ CommonJSï¼Œå°±æ ¹æœ¬æ— æ³•æ‰§è¡Œï¼Œä¼šæŠ¥é”™ã€‚\n// even.js var odd = require(\u0026#39;./odd\u0026#39;); var counter = 0; exports.counter = counter; exports.even = function (n) { counter++; return n == 0 || odd(n - 1); } // odd.js var even = require(\u0026#39;./even\u0026#39;).even; module.exports = function (n) { return n != 0 \u0026amp;\u0026amp; even(n - 1); } ä¸Šé¢ä»£ç ä¸­ï¼Œeven.jsåŠ è½½odd.jsï¼Œè€Œodd.jsåˆå»åŠ è½½even.jsï¼Œå½¢æˆâ€œå¾ªç¯åŠ è½½â€ã€‚è¿™æ—¶ï¼Œæ‰§è¡Œå¼•æ“å°±ä¼šè¾“å‡ºeven.jså·²ç»æ‰§è¡Œçš„éƒ¨åˆ†ï¼ˆä¸å­˜åœ¨ä»»ä½•ç»“æœï¼‰ï¼Œæ‰€ä»¥åœ¨odd.jsä¹‹ä¸­ï¼Œå˜é‡evenç­‰äºundefinedï¼Œç­‰åˆ°åé¢è°ƒç”¨even(n - 1)å°±ä¼šæŠ¥é”™ã€‚\n$ node \u0026gt; var m = require(\u0026#39;./even\u0026#39;); \u0026gt; m.even(10) TypeError: even is not a function åŒ…*^Package^* JavaScript ä¸ä¼¼ Java æˆ–è€…å…¶ä»–è¯­è¨€é‚£æ ·ï¼Œå…·æœ‰ æ¨¡å—*^module^* å’Œ åŒ…*^package^* ç»“æ„ã€‚\nNode ç»„ç»‡äº†è‡ªèº«çš„æ ¸å¿ƒæ¨¡å—ï¼Œä¹Ÿä½¿å¾—ç¬¬ä¸‰æ–¹æ–‡ä»¶æ¨¡å—å¯ä»¥æœ‰åºåœ°ç¼–å†™å’Œä½¿ç”¨ã€‚ä½†æ˜¯åœ¨ç¬¬ä¸‰æ–¹æ¨¡å—ä¸­ï¼Œæ¨¡å—ä¸æ¨¡å—ä¹‹é—´ä»ç„¶æ˜¯æ•£åˆ—åœ¨å„åœ°çš„ï¼Œç›¸äº’ä¹‹é—´ä¸èƒ½ç›´æ¥å¼•ç”¨ã€‚è€Œåœ¨æ¨¡å—ä¹‹å¤–ï¼ŒåŒ…å’Œ NPM åˆ™æ˜¯å°†æ¨¡å—è”ç³»èµ·æ¥çš„ä¸€ç§æœºåˆ¶ã€‚åŒ…çš„å‡ºç°ï¼Œåœ¨æ¨¡å—çš„åŸºç¡€ä¸Šè¿›ä¸€æ­¥ç»„ç»‡ JavaScript ä»£ç ã€‚\n:memo: Note ä¸€ä¸ª åŒ…*^package^* ç”± åŒ…ç»“æ„folder tree å’Œ åŒ…æè¿°æ–‡ä»¶*^package.json^* ç»„æˆã€‚ä¸€ä¸ªè§„èŒƒçš„åŒ…ï¼Œå®ƒçš„ç»„æˆç»“æ„ï¼Œå¿…é¡»æ»¡è¶³ä»¥ä¸‹ä¸‰ç‚¹éœ€æ±‚ï¼š\nåŒ…å¿…é¡»ä»¥ å•ç‹¬çš„ç›®å½• å­˜åœ¨ åŒ…çš„é¡¶çº§ç›®å½•ä¸‹å¿…é¡»åŒ…å« package.json è¿™ä¸ªæ–‡ä»¶ package.json ä¸­å¿…é¡»åŒ…å« name^åŒ…å^, version^ç‰ˆæœ¬å·^, main^åŒ…çš„å…¥å£^ è¿™ä¸‰ä¸ªå±æ€§ã€‚å½“ç„¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ npm init è¿›è¡Œåˆå§‹åŒ– NPM ğŸ”— Href npmjs å…¨çƒæœ€å¤§çš„åŒ…å…±äº«å¹³å°\nNPMNode Package Manager æ˜¯ npm, inc. å…¬å¸çš„äº§å“ï¼Œéšç€ Node.js ä¸€åŒè¢«å®‰è£…åˆ°ç”¨æˆ·çš„ç”µè„‘ä¸Šã€‚å¯¹äº Node è€Œè¨€ï¼ŒNPM å¸®åŠ©å®Œæˆäº†ç¬¬ä¸‰æ–¹æ¨¡å—çš„å‘å¸ƒã€å®‰è£…å’Œä¾èµ–ç­‰ã€‚å€ŸåŠ© NPM ï¼ŒNode ä¸ç¬¬ä¸‰æ–¹æ¨¡å—ä¹‹é—´å½¢æˆäº†å¾ˆå¥½çš„ä¸€ä¸ªç”Ÿæ€ç³»ç»Ÿã€‚\nå‘½ä»¤ npm #æ˜¾ç¤ºå¸®åŠ© npm -v #æŸ¥çœ‹ç‰ˆæœ¬ npm install \u0026lt;PACKAGE\u0026gt; #å®‰è£…ä¾èµ–åŒ… \u0026lt;tarball file\u0026gt; #æœ¬åœ°å®‰è£… \u0026lt;tarball url\u0026gt; \u0026lt;folder\u0026gt; npm install \u0026lt;PACKAGE\u0026gt; -g #å…¨å±€å®‰è£… -\u0026gt; å˜ä¸ºå¯æ‰§è¡Œå‘½ä»¤ npm install \u0026lt;PACKAGE\u0026gt;@Version #å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„åŒ… npm i \u0026lt;PACKAGE\u0026gt; #ç®€ç•¥å†™æ³• npm init #ç”Ÿæˆpackage.jsonæè¿°æ–‡ä»¶ npm publish \u0026lt;folder\u0026gt; npm owner #ç®¡ç†åŒ…æƒé™ npm ls #æ‰“å°åŒ…åˆ—è¡¨ run\nâ˜•ï¸ QQ~\u0026amp;~AA\nğŸ§ [Q] è¿è¡Œ npm run xxx çš„æ—¶å€™ï¼Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ\nğŸ¤” [A] æˆ‘ä»¬åœ¨å®‰è£…ä¾èµ–çš„æ—¶å€™ï¼Œæ˜¯é€šè¿‡ npm i xxx æ¥æ‰§è¡Œçš„\nä¾‹å¦‚ npm i @vue/cli-service ï¼Œnpm åœ¨å®‰è£…è¿™ä¸ªä¾èµ–çš„æ—¶å€™ï¼Œå°±ä¼šåœ¨ node_modules/.bin/ ç›®å½•ä¸­åˆ›å»º vue-cli-service ä¸ºåçš„å‡ ä¸ªå¯æ‰§è¡Œæ–‡ä»¶\n.bin ç›®å½•ï¼Œè¿™ä¸ªç›®å½•ä¸æ˜¯ä»»ä½•ä¸€ä¸ª npm åŒ…ã€‚ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªä¸ªè½¯é“¾æ¥ï¼Œæ‰“å¼€æ–‡ä»¶å¯ä»¥çœ‹åˆ°æ–‡ä»¶é¡¶éƒ¨å†™ç€ #!/bin/sh ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªè„šæœ¬\nç”±æ­¤æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå½“ä½¿ç”¨ npm run serve æ‰§è¡Œ vue-cli-service serve æ—¶ï¼Œè™½ç„¶æ²¡æœ‰å®‰è£… vue-cli-service çš„å…¨å±€å‘½ä»¤ï¼Œä½†æ˜¯ npm ä¼šåˆ° ./node_modules/.bin ä¸­æ‰¾åˆ° vue-cli-service æ–‡ä»¶ä½œä¸º è„šæœ¬æ¥æ‰§è¡Œï¼Œåˆ™ç›¸å½“äºæ‰§è¡Œäº† ./node_modules/.bin/vue-cli-service serveserve å¹¶ä¼ å…¥ serve å‚æ•°\nğŸ§ [Q] é‚£è¿™ä¸ª .bin ç›®å½•ä¸‹çš„é‚£äº›è½¯è¿æ¥æ–‡ä»¶æ˜¯å“ªé‡Œæ¥çš„å‘¢ï¼Ÿå®ƒåˆæ˜¯æ€ä¹ˆçŸ¥é“è¿™æ¡è½¯è¿æ¥æ˜¯æ‰§è¡Œå“ªé‡Œçš„å‘¢ï¼Ÿ\nğŸ¤” [A] æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æ–°å»ºçš„ vue é¡¹ç›®é‡Œé¢æœç´¢ vue-cli-service\n{ \u0026#34;name\u0026#34;: \u0026#34;h5\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;1.0.7\u0026#34;, \u0026#34;private\u0026#34;: true, \u0026#34;scripts\u0026#34;: { \u0026#34;serve\u0026#34;: \u0026#34;vue-cli-service serve\u0026#34; }, } å¯ä»¥çœ‹åˆ°ï¼Œå®ƒå­˜åœ¨é¡¹ç›®æœ€å¤–å±‚çš„ package-lock.json æ–‡ä»¶ä¸­\nä» package-lock.json ä¸­å¯çŸ¥ï¼Œå½“æˆ‘ä»¬ npm i æ•´ä¸ªæ–°å»ºçš„ vue é¡¹ç›®çš„æ—¶å€™ï¼Œnpm å°† package-lock.json ä¸­ scripts: {serve:...} æŒ‡å‘çš„ bin/vue-cli-service.js ä½œä¸º .bin å£°æ˜\næ‰€ä»¥åœ¨ npm install æ—¶ï¼Œnpm è¯»åˆ°è¯¥é…ç½®åï¼Œå°±å°†è¯¥æ–‡ä»¶ è½¯é“¾æ¥ åˆ° ./node_modules/.bin ç›®å½•ä¸‹ï¼Œè€Œ npm è¿˜ä¼šè‡ªåŠ¨æŠŠ node_modules/.bin åŠ å…¥ $PATH ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥ä½œä¸ºå‘½ä»¤è¿è¡Œä¾èµ–ç¨‹åºå’Œå¼€å‘ä¾èµ–ç¨‹åºï¼Œè€Œä¸ç”¨å…¨å±€å®‰è£…\nå‡å¦‚æˆ‘ä»¬åœ¨å®‰è£…åŒ…æ—¶ï¼Œä½¿ç”¨ npm install -g xxx æ¥å®‰è£…ï¼Œé‚£ä¹ˆä¼šå°†å…¶ä¸­çš„ .bin ç›®å½•ä¸‹æ–‡ä»¶åŠ å…¥åˆ°å…¨å±€ï¼Œæ¯”å¦‚ create-react-app å’Œ vue-cli ï¼Œåœ¨å…¨å±€å®‰è£…åï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨å¦‚ vue-cli projectName è¿™æ ·çš„å‘½ä»¤æ¥åˆ›å»ºé¡¹ç›®äº†ã€‚\nğŸ§ [Q] ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰§è¡Œnpm i çš„æ—¶å€™ï¼Œnpm å°±å¸®æˆ‘ä»¬æŠŠè¿™ç§è½¯è¿æ¥é…ç½®å¥½äº†ï¼Œå…¶å®è¿™ç§è½¯è¿æ¥ç›¸å½“äºä¸€ç§æ˜ å°„ï¼Œæ‰§è¡Œnpm run xxx çš„æ—¶å€™ï¼Œå°±ä¼šåˆ° node_modules/binä¸­æ‰¾å¯¹åº”çš„æ˜ å°„æ–‡ä»¶ï¼Œç„¶åå†æ‰¾åˆ°ç›¸åº”çš„jsæ–‡ä»¶æ¥æ‰§è¡Œã€‚\nğŸ¤” [A] æ˜¯çš„\nğŸ§ [Q] åœ¨node_modules/.bin ä¸­ æœ‰ä¸‰ä¸ª vue-cli-service æ–‡ä»¶ã€‚ä¸ºä»€ä¹ˆä¼šæœ‰ä¸‰ä¸ªæ–‡ä»¶å‘¢\nğŸ¤” [A] å¦‚æœæˆ‘ä»¬åœ¨ cmd é‡Œè¿è¡Œçš„æ—¶å€™ï¼Œwindows ä¸€èˆ¬æ˜¯è°ƒç”¨äº† vue-cli-service.cmd ï¼Œè¿™ä¸ªæ–‡ä»¶ï¼Œè¿™æ˜¯ windows ä¸‹çš„æ‰¹å¤„ç†è„šæœ¬ï¼š\n@ECHO off GOTO start :find_dp0 SET dp0=%~dp0 EXIT /b :start SETLOCAL CALL :find_dp0 IF EXIST \u0026#34;%dp0%\\node.exe\u0026#34; ( SET \u0026#34;_prog=%dp0%\\node.exe\u0026#34; ) ELSE ( SET \u0026#34;_prog=node\u0026#34; SET PATHEXT=%PATHEXT:;.JS;=;% ) endLocal \u0026amp; goto #_undefined_# 2\u0026gt;NUL || title %COMSPEC% \u0026amp; \u0026#34;%_prog%\u0026#34; \u0026#34;%dp0%\\..\\@vue\\cli-service\\bin\\vue-cli-service.js\u0026#34; %* æ‰€ä»¥å½“æˆ‘ä»¬è¿è¡Œ vue-cli-service serve è¿™æ¡å‘½ä»¤çš„æ—¶å€™ï¼Œå°±ç›¸å½“äºè¿è¡Œ node_modules/.bin/vue-cli-service.cmd serve\nç„¶åè¿™ä¸ªè„šæœ¬ä¼šä½¿ç”¨ node å»è¿è¡Œ vue-cli-service.js è¿™ä¸ª js æ–‡ä»¶\nç”±äº node ä¸­å¯ä»¥ä½¿ç”¨ä¸€ç³»åˆ—ç³»ç»Ÿç›¸å…³çš„ api ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ª js ä¸­å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œä¾‹å¦‚è¯»å–å¹¶åˆ†æè¿è¡Œè¿™æ¡å‘½ä»¤çš„ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œæ ¹æ®æ¨¡æ¿ç”Ÿæˆæ–‡ä»¶ç­‰ã€‚\n# unix ç³»é»˜è®¤çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¿…é¡»è¾“å…¥å®Œæ•´æ–‡ä»¶å vue-cli-service # windows cmd ä¸­é»˜è®¤çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå½“æˆ‘ä»¬ä¸æ·»åŠ åç¼€åæ—¶ï¼Œè‡ªåŠ¨æ ¹æ® pathext æŸ¥æ‰¾æ–‡ä»¶ vue-cli-service.cmd # Windows PowerShell ä¸­å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥è·¨å¹³å° vue-cli-service.ps1 ğŸ“ Note æ€»ç»“\nè¿è¡Œ npm run xxx çš„æ—¶å€™ï¼Œnpm ä¼šå…ˆåœ¨å½“å‰ç›®å½•çš„ node_modules/.bin ä¸‹æŸ¥æ‰¾è¦æ‰§è¡Œçš„ç¨‹åºï¼Œå¦‚æœæ‰¾åˆ°åˆ™è¿è¡Œ æ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ä»å…¨å±€çš„ node_modules/.bin ä¸­æŸ¥æ‰¾ï¼Œå°±æ˜¯å®‰è£…åˆ°åˆ°å…¨å±€ç›®å½• å¦‚æœå…¨å±€ç›®å½•è¿˜æ˜¯æ²¡æ‰¾åˆ°ï¼Œé‚£ä¹ˆå°±ä» path ç¯å¢ƒå˜é‡ä¸­æŸ¥æ‰¾æœ‰æ²¡æœ‰å…¶ä»–åŒåçš„å¯æ‰§è¡Œç¨‹åº æ¢æº åœ¨ç»ˆç«¯ä¿®æ”¹ï¼š # æŸ¥çœ‹å½“å‰ä¸‹è½½é•œåƒæº npm config get registry # ä¿®æ”¹ä¸ºç›®æ ‡åœ°å€ npm config set registry=\u0026lt;è¦ä¿®æ”¹çš„åŸåœ°å€\u0026gt; # ä¿®æ”¹ä¸ºæ·˜å®é•œåƒ npm config set registry=https://registry.npm.taobao.org ä¿®æ”¹ ~/.npmrc é…ç½® registry=https://registry.npm.taobao.org ä½¿ç”¨ nrm ç®¡ç† registry åœ°å€ # å®‰è£…nrm npm install -g nrm # æŸ¥çœ‹é•œåƒåˆ—è¡¨ nrm ls * npm ---------- https://registry.npmjs.org/ yarn --------- https://registry.yarnpkg.com/ tencent ------ https://mirrors.cloud.tencent.com/npm/ cnpm --------- https://r.cnpmjs.org/ taobao ------- https://registry.npmmirror.com/ npmMirror ---- https://skimdb.npmjs.com/registry/ # ä½¿ç”¨æ·˜å®æº nrm use taobao åŒ… ä¸Šä¼ \nnpm è´¦å·æ³¨å†Œå®Œæˆåï¼Œå¯ä»¥åœ¨ç»ˆç«¯æ‰§è¡Œ npm login å‘½ä»¤ï¼Œä¾æ¬¡è¾“å…¥ç”¨æˆ·åã€å¯†ç ã€é‚®ç®±åï¼Œå³å¯ç™»å½•æˆåŠŸã€‚å°†ç»ˆç«¯åˆ‡æ¢åˆ°åŒ…çš„æ ¹ç›®å½•åï¼Œè¿è¡Œ npm publish å‘½ä»¤ï¼Œå³å¯å°†åŒ…å‘å¸ƒåˆ° npm ä¸Šã€‚åŒ…åä¸å¯ä¸å®˜æ–¹ä»“åº“å†…å·²æœ‰åŒ…åå†²çªã€‚\nğŸ“ Note åœ¨è¿è¡Œ npm login å‰ï¼Œå¿…é¡»å…ˆæŠŠ ä¸‹åŒ…çš„æœåŠ¡å™¨ åˆ‡æ¢ä¼š npm çš„å®˜æ–¹æœåŠ¡å™¨ï¼Œå¦åˆ™ä¼šå¯¼è‡´å‘å¸ƒå¤±è´¥ã€‚\nåˆ é™¤\nè¿è¡Œ npm unpublish åŒ…å --force å‘½ä»¤ï¼Œå³å¯ä» nom åˆ é™¤å·²ç»å‘å¸ƒçš„åŒ…ã€‚\nğŸ“ Note npm unpublish å‘½ä»¤åªèƒ½åˆ é™¤ 72 å°æ—¶å†…åˆ é™¤çš„åŒ…ï¼Œä¸”åˆ é™¤çš„åŒ…åœ¨ 24 å°æ—¶å†…ä¸å…è®¸é‡å¤å‘å¸ƒã€‚\nå±€åŸŸç½‘å®‰è£… åœ¨ä¼ä¸šçš„å†…éƒ¨åº”ç”¨ä¸­ä½¿ç”¨ NPM ä¸å¼€æºç¤¾åŒºä¸­ä½¿ç”¨æœ‰ä¸€å®šçš„å·®åˆ«ã€‚ä¼ä¸šçš„é™åˆ¶åœ¨äºï¼š\näº«å—åˆ°æ¨¡å—å¼€å‘å¸¦æ¥çš„ä½è€¦åˆå’Œé¡¹ç›®ç»„ç»‡ä¸Šçš„å¥½å¤„ è¦è€ƒè™‘åˆ°æ¨¡å—ä¿å¯†æ€§çš„é—®é¢˜ æ‰€ä»¥ï¼Œé€šè¿‡ NPM å…±äº«å’Œå‘å¸ƒå­˜åœ¨æ½œåœ¨çš„é£é™©ã€‚ä¸ºäº†åŒæ—¶èƒ½å¤Ÿäº«å—åˆ° NPM ä¸Šä¼—å¤šçš„åŒ…ï¼ŒåŒæ—¶å¯¹è‡ªå·±çš„åŒ…è¿›è¡Œä¿å¯†å’Œé™åˆ¶ï¼Œç°æœ‰çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯ä¼ä¸šæ­å»ºè‡ªå·±çš„ NPM ä»“åº“ã€‚\nå±€åŸŸ NPM ä»“åº“çš„æ­å»ºæ–¹æ³•ä¸æ­å»ºé•œåƒç«™çš„æ–¹å¼å‡ ä¹ä¸€æ ·ï¼Œä½†ä¸é•œåƒä»“åº“ä¸åŒçš„åœ°æ–¹åœ¨äºï¼Œä¼ä¸šå±€åŸŸ NPM å¯ä»¥é€‰æ‹©ä¸åŒæ­¥å®˜æ–¹æºä»“åº“ä¸­çš„åŒ…ã€‚\nç›®å½•ç»“æ„*^Directory^* ^Structure^ åŒ…å®é™…ä¸Šæ˜¯ä¸€ä¸ªå­˜æ¡£æ–‡ä»¶ï¼Œå³ä¸€ä¸ªç›®å½•ç›´æ¥æ‰“åŒ…ä¸º .zip æˆ– tar.gz æ ¼å¼çš„æ–‡ä»¶ï¼Œå®‰è£…åè§£å‹è¿˜åŸä¸ºç›®å½•ã€‚å®Œå…¨ç¬¦åˆ CommonJS è§„èŒƒçš„åŒ…ç›®å½•åº”è¯¥åŒ…å«å¦‚ä¸‹è¿™äº›æ–‡ä»¶ã€‚\npackage.jsonï¼šåŒ…æè¿°æ–‡ä»¶ binï¼š ç”¨äºå­˜æ”¾å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„ç›®å½• libï¼šç”¨äºå­˜æ”¾ JavaScript ä»£ç çš„ç›®å½• docï¼šç”¨äºå­˜æ”¾æ–‡æ¡£çš„ç›®å½• testï¼šç”¨äºå­˜æ”¾å•å…ƒæµ‹è¯•ç”¨ä¾‹çš„ä»£ç  åœ¨é¡¹ç›®ä¸­è£…åŒ…å®Œæˆåï¼Œä¼šå¢åŠ ä¸€ä¸ª node_modules çš„æ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾å·²å®‰è£…çš„åŒ…ã€‚åŒæ—¶ï¼Œé¡¹ç›®é—®ä»·å¤¹ä¸­ä¹Ÿç”Ÿæˆäº† package.json å’Œ package-lock.json ã€‚\nğŸ“ Note package-lock.jsonï¼šnpm æ›´æ”¹ node_modules ç›®å½•æ ‘ æˆ–è€… package.json æ—¶è‡ªåŠ¨ç”Ÿæˆï¼Œå®ƒå‡†ç¡®çš„æè¿°äº†å½“å‰é¡¹ç›® npm åŒ…çš„ä¾èµ–æ ‘ï¼Œå¹¶ä¸”åœ¨éšåçš„å®‰è£…ä¸­ä¼šæ ¹æ® package-lock.json æ¥å®‰è£…ï¼Œä¿è¯æ˜¯ç›¸åŒçš„ä¸€ä¸ªä¾èµ–æ ‘ï¼Œä¸è€ƒè™‘è¿™ä¸ªè¿‡ç¨‹ä¸­æ˜¯å¦æœ‰æŸä¸ªä¾èµ–æœ‰å°ç‰ˆæœ¬çš„æ›´æ–°ã€‚\nâš ï¸ Caution ä¸è¦æ‰‹åŠ¨ä¿®æ”¹node_modules æˆ– package-lock.json ä¸­çš„ä»»ä½•ä»£ç ï¼Œnpm åŒ…ç®¡ç†å·¥å…·ä¼šè‡ªåŠ¨ç»´æŠ¤å®ƒä»¬ã€‚\nğŸ“ Note åŒ…çš„ç‰ˆæœ¬å·ä»¥ç‚¹åˆ†åè¿›åˆ¶å½¢å¼å®šä¹‰ï¼Œæ€»å…±æœ‰ä¸‰ä½æ•°ç»„ï¼Œä¾‹å¦‚ 2.24.0ï¼ˆå¤§ç‰ˆæœ¬ - åŠŸèƒ½ç‰ˆæœ¬ - Bugä¿®å¤ç‰ˆæœ¬ï¼‰ã€‚æå‡è§„åˆ™ï¼šåªè¦å‰é¢ç‰ˆæœ¬å·å¢é•¿äº†ï¼Œåˆ™åé¢ç‰ˆæœ¬å·å½’é›¶ã€‚\nåˆ†ç±» é¡¹ç›®åŒ… é‚£äº›è¢«å®‰è£…åˆ° é¡¹ç›® çš„ node_modules ç›®å½•ä¸­çš„åŒ…ï¼Œéƒ½æ˜¯é¡¹ç›®åŒ…ã€‚\né¡¹ç›®åŒ…åˆåˆ†ä¸ºä¸¤ç±»ï¼š\nå¼€å‘ä¾èµ–åŒ… devDependencies -D --save-devï¼šå¼€å‘æœŸé—´ä½¿ç”¨\næ ¸å¿ƒä¾èµ–åŒ… dependenciesï¼šå¼€å‘æœŸé—´å’Œé¡¹ç›®ä¸Šçº¿ä¹‹åéƒ½ä¼šç”¨åˆ°\nå…¨å±€åŒ… æ‰§è¡Œ npm install æ—¶ï¼Œå¦‚æœæä¾›äº† -g å‚æ•°ï¼Œåˆ™ä¼šæŠŠåŒ…å®‰è£…åˆ°å…¨å±€ã€‚\nåªæœ‰å·¥å…·æ€§è´¨çš„åŒ…ï¼Œæ‰æœ‰å…¨å±€å®‰è£…çš„å¿…è¦æ€§ã€‚\npackage.json npm è§„å®šï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­ï¼Œå¿…é¡»æä¾›ä¸€ä¸ªå«åš package.json çš„åŒ…ç®¡ç†é…ç½®æ–‡ä»¶ï¼Œç”¨æ¥è®°å½•ä¸é¡¹ç›®æœ‰å…³çš„ä¸€äº›é…ç½®ä¿¡æ¯ã€‚å¯ä»¥ä½¿ç”¨ nm init -y å‘½ä»¤è¿›è¡Œå¿«é€Ÿåˆå§‹åŒ–ã€‚\nğŸ“ Note åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œéœ€è¦æŠŠ node_modules æ–‡ä»¶å¤¹æ·»åŠ åˆ° .gitignore å¿½ç•¥æ–‡ä»¶ä¸­ã€‚\n:link: Href [Vue ä¸­è‡ªå¸¦çš„ .gitignore æ–‡ä»¶](01 ToolSet#vue-ignore)\nå­—æ®µ*^fields^* :link: Href package.json å­—æ®µçš„å…·ä½“å®šä¹‰\nå…¥å£æ–‡ä»¶*^entry^* main package.json æ–‡ä»¶æœ‰ä¸¤ä¸ªå­—æ®µå¯ä»¥æŒ‡å®šæ¨¡å—çš„å…¥å£æ–‡ä»¶ï¼šmain å’Œ exports ã€‚æ¯”è¾ƒç®€å•çš„æ¨¡å—ï¼Œå¯ä»¥åªä½¿ç”¨ main å­—æ®µï¼ŒæŒ‡å®šæ¨¡å—åŠ è½½çš„å…¥å£æ–‡ä»¶ã€‚\n// ./node_modules/es-module-package/package.json { \u0026#34;type\u0026#34;: \u0026#34;module\u0026#34;, \u0026#34;main\u0026#34;: \u0026#34;./src/index.js\u0026#34; } ä¸Šé¢ä»£ç æŒ‡å®šé¡¹ç›®çš„å…¥å£è„šæœ¬ä¸º ./src/index.js ï¼Œå®ƒçš„æ ¼å¼ä¸º ES6 æ¨¡å—ã€‚å¦‚æœæ²¡æœ‰ type å­—æ®µï¼Œindex.js å°±ä¼šè¢«è§£é‡Šä¸º CommonJS æ¨¡å—ã€‚\nç„¶åï¼Œ import å‘½ä»¤å°±å¯ä»¥åŠ è½½è¿™ä¸ªæ¨¡å—ã€‚\n:page_with_curl: Example\n// ./my-app.mjs import { something } from \u0026#39;es-module-package\u0026#39;; // å®é™…åŠ è½½çš„æ˜¯ ./node_modules/es-module-package/src/index.js ä¸Šé¢ä»£ç ä¸­ï¼Œè¿è¡Œè¯¥è„šæœ¬ä»¥åï¼ŒNode.js å°±ä¼šåˆ° ./node_modules ç›®å½•ä¸‹é¢ï¼Œå¯»æ‰¾ es-module-package æ¨¡å—ï¼Œç„¶åæ ¹æ®è¯¥æ¨¡å— package.json çš„ main å­—æ®µå»æ‰§è¡Œå…¥å£æ–‡ä»¶ã€‚\nè¿™æ—¶ï¼Œå¦‚æœç”¨ CommonJS æ¨¡å—çš„ require() å‘½ä»¤å»åŠ è½½ es-module-package æ¨¡å—ä¼šæŠ¥é”™ï¼Œå› ä¸º CommonJS æ¨¡å—ä¸èƒ½å¤„ç† export å‘½ä»¤ã€‚\nexports ç”¨äºæŒ‡å®šæ¨¡å—å¯¹å¤–æš´éœ²çš„ æ¥å£*^interface^* ï¼Œå­—æ®µçš„ä¼˜å…ˆçº§é«˜äº main ã€‚\nmain\nexports å­—æ®µçš„ key å¦‚æœæ˜¯ . ï¼Œå°±ä»£è¡¨æ¨¡å—çš„ä¸»å…¥å£ï¼Œä¸”ä¼˜å…ˆçº§é«˜äº main å­—æ®µï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥ç®€å†™æˆ exports å­—æ®µçš„å€¼ã€‚\n{ \u0026#34;exports\u0026#34;: { \u0026#34;.\u0026#34;: \u0026#34;./main.js\u0026#34; } } // ç­‰åŒäº { \u0026#34;exports\u0026#34;: \u0026#34;./main.js\u0026#34; } ğŸ›‘ Depreciated å…¼å®¹æ—§ç‰ˆæœ¬çš„ Node.js\nğŸ—‘ Obsolete exports å­—æ®µè‡ª Node.js v12.7.0 å¼•å…¥ï¼Œä½ç‰ˆæœ¬ä¸èƒ½è¯»å–\n:page_with_curl: Example\n{ \u0026#34;main\u0026#34;: \u0026#34;./main-legacy.cjs\u0026#34;, \u0026#34;exports\u0026#34;: { \u0026#34;.\u0026#34;: \u0026#34;./main-modern.cjs\u0026#34; } } ä¸Šé¢ä»£ç ä¸­ï¼Œè€ç‰ˆæœ¬çš„ Node.js ï¼ˆä¸æ”¯æŒ ES6 æ¨¡å—ï¼‰çš„å…¥å£æ–‡ä»¶æ˜¯main-legacy.cjsï¼Œæ–°ç‰ˆæœ¬çš„ Node.js çš„å…¥å£æ–‡ä»¶æ˜¯ main-modern.cjsã€‚\næ¡ä»¶åŠ è½½\nåˆ©ç”¨ . è¿™ä¸ªåˆ«åï¼Œå¯ä»¥ä¸º ES6 æ¨¡å—å’Œ CommonJS æŒ‡å®šä¸åŒçš„å…¥å£ã€‚\nğŸ—‘ Obsolete Node.js v13.7.0 ä¸­å·²ç»å–æ¶ˆäº†æŒ‡å®š --experimental-conditional-exports æ ‡å¿—æ‰“å¼€æ¡ä»¶åŠ è½½åŠŸèƒ½ã€‚\n{ \u0026#34;type\u0026#34;: \u0026#34;module\u0026#34;, \u0026#34;exports\u0026#34;: { \u0026#34;.\u0026#34;: { \u0026#34;require\u0026#34;: \u0026#34;./main.cjs\u0026#34;, \u0026#34;default\u0026#34;: \u0026#34;./main.js\u0026#34; } } } ä¸Šé¢ä»£ç ä¸­ï¼Œåˆ«å . çš„ require æ¡ä»¶æŒ‡å®š require() å‘½ä»¤çš„å…¥å£æ–‡ä»¶ï¼ˆå³ CommonJS çš„å…¥å£ï¼‰ï¼Œdefault æ¡ä»¶æŒ‡å®šå…¶ä»–æƒ…å†µçš„å…¥å£ï¼ˆå³ ES6 çš„å…¥å£ï¼‰ã€‚\nä¸Šé¢çš„å†™æ³•å¯ä»¥ç®€å†™å¦‚ä¸‹ã€‚\n{ \u0026#34;exports\u0026#34;: { \u0026#34;require\u0026#34;: \u0026#34;./main.cjs\u0026#34;, \u0026#34;default\u0026#34;: \u0026#34;./main.js\u0026#34; } } æ³¨æ„ï¼Œå¦‚æœåŒæ—¶è¿˜æœ‰å…¶ä»–åˆ«åï¼Œå°±ä¸èƒ½é‡‡ç”¨ç®€å†™ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚\n{ // æŠ¥é”™ \u0026#34;exports\u0026#34;: { \u0026#34;./feature\u0026#34;: \u0026#34;./lib/feature.js\u0026#34;, \u0026#34;require\u0026#34;: \u0026#34;./main.cjs\u0026#34;, \u0026#34;default\u0026#34;: \u0026#34;./main.js\u0026#34; } } å­ç›®å½•\npackage.json æ–‡ä»¶çš„ exports å­—æ®µå¯ä»¥æŒ‡å®šè„šæœ¬æˆ–å­ç›®å½•çš„åˆ«åã€‚\n:page_with_curl: Example\n// ./my-app.mjs import { something } from \u0026#39;es-module-package\u0026#39;; // å®é™…åŠ è½½çš„æ˜¯ ./node_modules/es-module-package/src/index.js ä¸Šé¢ä»£ç ä¸­ï¼Œè¿è¡Œè¯¥è„šæœ¬ä»¥åï¼ŒNode.js å°±ä¼šåˆ° ./node_modules ç›®å½•ä¸‹é¢ï¼Œå¯»æ‰¾ es-module-package æ¨¡å—ï¼Œç„¶åæ ¹æ®è¯¥æ¨¡å— package.json çš„ main å­—æ®µå»æ‰§è¡Œå…¥å£æ–‡ä»¶ã€‚\n:page_with_curl: Example\n// ./node_modules/es-module-package/package.json { \u0026#34;exports\u0026#34;: { \u0026#34;./submodule\u0026#34;: \u0026#34;./src/submodule.js\u0026#34; } } ä¸Šé¢çš„ä»£ç æŒ‡å®šsrc/submodule.jsåˆ«åä¸ºsubmoduleï¼Œç„¶åå°±å¯ä»¥ä»åˆ«ååŠ è½½è¿™ä¸ªæ–‡ä»¶ã€‚\nimport submodule from \u0026#39;es-module-package/submodule\u0026#39;; // åŠ è½½ ./node_modules/es-module-package/src/submodule.js ä¸‹é¢æ˜¯å­ç›®å½•åˆ«åçš„ä¾‹å­ã€‚\n:page_with_curl: Example\n// ./node_modules/es-module-package/package.json { \u0026#34;exports\u0026#34;: { \u0026#34;./features/\u0026#34;: \u0026#34;./src/features/\u0026#34; } } import feature from \u0026#39;es-module-package/features/x.js\u0026#39;; // åŠ è½½ ./node_modules/es-module-package/src/features/x.js å¦‚æœæ²¡æœ‰åœ¨ module å­—æ®µæŒ‡å®šåˆ«åï¼Œå°±ä¸èƒ½ç”¨â€œæ¨¡å—+è„šæœ¬åâ€è¿™ç§å½¢å¼åŠ è½½è„šæœ¬ã€‚\n// æŠ¥é”™ import submodule from \u0026#39;es-module-package/private-module.js\u0026#39;; // ä¸æŠ¥é”™ import submodule from \u0026#39;./node_modules/es-module-package/private-module.js\u0026#39;; depandencies ç”¨äºè®°å½•å®‰è£…äº†å“ªäº›åŒ…ã€‚é€šè¿‡è¿™é‡Œçš„è®°å½•ï¼Œnpm install å¯ä»¥ä¸€æ¬¡æ€§å®‰è£…æ‰€æœ‰åŒ…ã€‚\ndevDepandencies å¦‚æœæŸäº›åŒ…åªåœ¨ é¡¹ç›®å¼€å‘é˜¶æ®µ ä¼šç”¨åˆ°ï¼Œè€Œåœ¨ é¡¹ç›®ä¸Šçº¿ä¹‹å ä¸ä¼šç”¨åˆ°ï¼Œåˆ™å¯ä»¥å°†è¿™äº›åŒ…å®‰è£…åˆ°æ­¤ã€‚\nnpm i \u0026lt;PACKAGE\u0026gt; -D npm install \u0026lt;PACKAGE\u0026gt; --save-dev ç»“æ„*^structure^* Node.js è§„èŒƒå’Œ NPM è§„èŒƒå¯¹äº package.json çš„å®šä¹‰ç•¥æœ‰ä¸åŒï¼ŒNPM çš„å¯é€‰é¡¹æ›´ä¸ºä¸°å¯Œã€‚\nNode Node.js çš„ package.json åŒ…ç»“æ„å®šä¹‰å¦‚ä¸‹ï¼š\n// package.json type packageJsonNode = { \u0026#34;name\u0026#34;: string, /* åŒ…å…¥å£ */ \u0026#34;main\u0026#34;: string, /* Stability: 1 - Experimental */ \u0026#34;packageManager\u0026#34;?: string, \u0026#34;type\u0026#34;?: \u0026#34;module\u0026#34; | \u0026#34;commonjs\u0026#34;, /* export å­—æ®µçš„è¯¦ç»†é…ç½®ï¼Œè§ä¸‹èŠ‚ NPM */ \u0026#34;exports\u0026#34;?: object | string | string[], \u0026#34;imports\u0026#34;?: object, [others: string]: object | string | string[] }; const packageJsonNode: packageJsonNode = { \u0026#34;name\u0026#34;: \u0026#34;package-name\u0026#34;, \u0026#34;main\u0026#34;: \u0026#34;./main.js\u0026#34;, \u0026#34;packageManager\u0026#34;: \u0026#34;\u0026lt;package manager name\u0026gt;@\u0026lt;version\u0026gt;\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;module\u0026#34;, \u0026#34;exports\u0026#34;: \u0026#34;./index.js\u0026#34;, \u0026#34;imports\u0026#34;: { \u0026#34;#dep\u0026#34;: { \u0026#34;node\u0026#34;: \u0026#34;dep-node-native\u0026#34;, \u0026#34;default\u0026#34;: \u0026#34;./dep-polyfill.js\u0026#34; } }, \u0026#34;dependencies\u0026#34;: { \u0026#34;dep-node-native\u0026#34;: \u0026#34;^1.0.0\u0026#34; } }; NPM :star: Important NPM åŒ…ç»“æ„å®šä¹‰å¦‚ä¸‹ï¼š\n// package.json /* |=========== åŒ…çš„æ¥å£ ===========| */ type packageJsonNPM = { // |== 1. å¿…éœ€å±æ€§ ==| /* |\u0026gt; é¡¹ç›®åç§° non-url-safe */ name: string, /* |\u0026gt; ç‰ˆæœ¬å· -\u0026gt; ä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å· */ version: version, /* |\u0026gt; åŒ…ç®¡ç†æ–¹å¼ -\u0026gt; CJS / ESM */ type?: \u0026#34;module\u0026#34; | \u0026#34;commonjs\u0026#34;, /* |\u0026gt; ç¨‹åºå…¥å£ -\u0026gt; é»˜è®¤ index .js/.json/.node */ main?: filePath, /* |\u0026gt; æš´éœ²æ¥å£ -\u0026gt; ä¼˜å…ˆçº§é«˜äº main */ exports?: { \u0026#39;.\u0026#39;?: filePath | { require: filePath, default: filePath }, require?: filePath, default?: filePath, [packageName: string]: filePath | { require: filePath, default: filePath } }, // |== 2. æè¿°ä¿¡æ¯ ==| /* |\u0026gt; æè¿° */ description?: string, /* |\u0026gt; å…³é”®è¯ */ keywords?: string[], /* |\u0026gt; ä½œè€… */ author?: string | userInfo, /* |\u0026gt; è´¡çŒ®è€… */ contributions?: string[] | userInfo[] /* |\u0026gt; ä¸»é¡µåœ°å€ */ homepage?: url, /* |\u0026gt; ä»£ç ä»“åº“ */ repository?: url | { type: versionController, url: url }, /* |\u0026gt; é—®é¢˜åé¦ˆ */ bugs?: url | { url: url, email: email }, // |== 3. å¤–éƒ¨ä¾èµ– ==| /* |\u0026gt; ç”Ÿäº§ç¯å¢ƒä¾èµ–\u0026lt;br\u0026gt; * npm install --save \u0026lt;PACKAGE NAME\u0026gt; */ dependencies?: packageList, /* |\u0026gt; å¼€å‘ç¯å¢ƒä¾èµ–\u0026lt;br\u0026gt; * npm install --dev \u0026lt;PACKAGE NAME\u0026gt; */ devDependencies?: packageList, /* |\u0026gt; æŒ‡å®šç‰ˆæœ¬ e.g.: 1.x */ peerDependencies?: packageList, /* |\u0026gt; å¯é€‰ä¾èµ–:\u0026lt;br\u0026gt;å®‰è£…å¤±è´¥ä»èƒ½ç»§ç»­è¿è¡Œ */ optionalDependencies?: packageList, /* |\u0026gt; æ‰“åŒ…ä¾èµ– */ bundledDependencies?: packageList, /* |\u0026gt; ç‰ˆæœ¬è¦æ±‚\u0026lt;br\u0026gt;ä»…èµ·è¯´æ˜ä½œç”¨ */ engines?: object, // |== 4. è„šæœ¬é…ç½® ==| /* |\u0026gt; å®‰è£…å¸è½½æ—¶è¿è¡Œçš„é’©å­è„šæœ¬\u0026lt;br\u0026gt; * åŒ npm run\u0026lt;br\u0026gt; * key-value å¯æ‰§è¡Œå‘½ä»¤-å‚æ•° */ script?: script, /* |\u0026gt; è¿è¡Œæ—¶é…ç½®å‚æ•° */ config?: string, // |== 5. æ–‡ä»¶ç›®å½• ==| // NOTE: 1. ä½¿ç”¨requireåŠ è½½CJS âŸ¹ é¡ºåºä¸º main â†’ module â†’ browser // 2. ä½¿ç”¨loaderåŠ è½½ESM âŸ¹ é¡ºåºä¸º browser â†’ module â†’ main /* |\u0026gt; æµè§ˆå™¨å…¥å£\u0026lt;br\u0026gt; * Browser only */ browser?: filePath, /* |\u0026gt; ESM è§„èŒƒå…¥å£\u0026lt;br\u0026gt; * EcmaScript module\u0026lt;br\u0026gt; * ä½¿ç”¨ import \u0026amp; export è¯­æ³• */ module?: filePath, /* |\u0026gt; å‘½ä»¤è¡Œå…¥å£ */ bin?: { [name: string]: filePath }[], /* |\u0026gt; æŒ‡å®šå‘å¸ƒæ–‡ä»¶ \u0026#39;/\u0026#39;åç¼€è¡¨ç¤ºç›®å½•\u0026lt;br\u0026gt; * å¦å¯ä»¥åœ¨ç›®å½•ä¸‹å»ºç«‹ .npmignore\u0026lt;br\u0026gt;æ•ˆæœç±»ä¼¼ .gitignore */ files?: string[], // /* |\u0026gt; æŒ‡å®šå¸®åŠ©æ–‡æ¡£åœ°å€\u0026lt;br\u0026gt; * man ä¸º linux å¸®åŠ©æŒ‡ä»¤ */ man?: filePath[], /* |\u0026gt; æŒ‡å®šåº“ä½ç½® */ directories?: directories, // // |== 6. å‘å¸ƒé…ç½® ==| /* |\u0026gt; æ˜¯å¦é™åˆ¶å‘å¸ƒåˆ°npmæœåŠ¡å™¨ */ private?: boolean, /* |\u0026gt; å…¨å±€å®‰è£…å»ºè®® ä»…æ˜¾ç¤ºè­¦å‘Š */ preferGlobal?: boolean, /* |\u0026gt; é™åˆ¶å‘å¸ƒä»“åº“/ç‰ˆæœ¬ */ publishConfig?: object, /* |\u0026gt; ç³»ç»Ÿé™åˆ¶\u0026lt;br\u0026gt;!è¡¨ç¤ºé»‘åå•\u0026lt;br\u0026gt;e.g.: !win32 */ os?: os[], /* |\u0026gt; CPUé™åˆ¶ */ cpu?: cpu[], /* |\u0026gt; å‘å¸ƒåè®®\u0026lt;br\u0026gt;e.g.:MIT/Apache/GPL/etc... */ license?: string, // |== 7. ç¬¬ä¸‰æ–¹é…ç½® ==| /* |\u0026gt; TypeScript å…¥å£æ–‡ä»¶ åŒ main æ•ˆæœ */ typings?: filePath, /* |\u0026gt; ESLint\u0026lt;br\u0026gt;å¯å•ç‹¬å†™åœ¨ .eslintrc.json ä¸Š*/ eslintConfig?: object, /* |\u0026gt; Babel ç¼–è¯‘é…ç½® */ babel?: string, /* |\u0026gt; CDN æœåŠ¡ */ unpkg?: filePath, /* |\u0026gt; Linter */ \u0026#34;lint-staged\u0026#34;?: string, /* |\u0026gt; é’©å­ æäº¤å‰ ESLintæ£€æŸ¥ */ gitHooks?: string, /* |\u0026gt; æµè§ˆå™¨æ”¯æŒç‰ˆæœ¬ */ browserslist?: browserslist }; /* |=========== åŸºç¡€ç±»å‹ ===========| */ /* |\u0026gt; ç½‘å€ */ type url = `${string}://${string}`; /* |\u0026gt; é‚®ç®± */ type email = `${string}@${string}`; /* |\u0026gt; ç‰ˆæœ¬ */ type version = `${number}.${number | \u0026#39;x\u0026#39;}.${number | \u0026#39;x\u0026#39;}${\u0026#39;\u0026#39; | \u0026#39;alpha\u0026#39; | \u0026#39;beta\u0026#39; | \u0026#39;rc\u0026#39;}`; /* |\u0026gt; ç‰ˆæœ¬æ§åˆ¶ */ type versionController = \u0026#39;git\u0026#39; | string; /* |\u0026gt; ç”¨æˆ·ä¿¡æ¯ */ type userInfo = { name: string | string[], email?: email, url?: url } /* |\u0026gt; åŒ…åˆ—è¡¨ */ type packageList = { [name: string]: version }; /* |\u0026gt; é’©å­è„šæœ¬ */ type script = { preinstall?: filePath, install?: filePath, uninstall?: filePath, test?: filePath }; /* |\u0026gt; æ–‡ä»¶åœ°å€ */ type filePath = string; /* |\u0026gt; æ–‡ä»¶ç›®å½• ç›®å‰æ²¡æœ‰ä½œç”¨ */ type directories = { /* .nodeç›®å½• */ bin?: filePath, /* .jsä»£ç ç›®å½• */ lib?: filePath, /* æ–‡æ¡£ç›®å½• */ doc?: filePath, /* æµ‹è¯•ä»£ç ç›®å½• */ test?: filePath, [name: string]: filePath }; /* |\u0026gt; æ“ä½œç³»ç»Ÿ */ type os = `${\u0026#39;!\u0026#39; | \u0026#39;\u0026#39;}${string}`; /* |\u0026gt; CPU */ type cpu = `${\u0026#39;!\u0026#39; | \u0026#39;\u0026#39;}${string}`; /* |\u0026gt; æµè§ˆå™¨åˆ—è¡¨ */ type browserslist = { production: string[], development: string[] }; /* |=========== ç¤ºèŒƒå®ä¾‹ ===========| */ const packageJsonNPM: packageJsonNPM = { \u0026#34;name\u0026#34;: \u0026#34;xmlhttprequest\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;XMLHttpRequest for Node\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;1.8.0 \u0026#34;, \u0026#34;author\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;Dan DeFelippi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://driverdan.com\u0026#34;, }, \u0026#34;keywords\u0026#34;: [\u0026#34;xhr\u0026#34;, \u0026#34;ajax\u0026#34;], \u0026#34;license\u0026#34;: \u0026#34;MIT\u0026#34;, \u0026#34;repository\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;git\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;git://github.com/driverdan/node-XMLHttpRequest.git\u0026#34;, }, \u0026#34;bugs\u0026#34;: \u0026#34;https://github.com/driverdan/node-XMLHttpRequest/issues\u0026#34;, \u0026#34;engines\u0026#34;: { \u0026#34;node\u0026#34;: \u0026#34;\u0026gt;=0.4.0\u0026#34; }, \u0026#34;directories\u0026#34;: { \u0026#34;lib\u0026#34;: \u0026#34;./lib\u0026#34;, \u0026#34;example\u0026#34;: \u0026#34;./example\u0026#34; }, \u0026#34;main\u0026#34;: \u0026#34;./lib/XMLHttpRequest.js\u0026#34; } å¼‚æ­¥*^Asynchronous^* \u0026ldquo;å¼‚æ­¥\u0026quot;è¿™ä¸ªåè¯å…¶å®å¾ˆæ—©å°±è¯ç”Ÿäº†ï¼Œä½†å®ƒçš„å¤§è§„æ¨¡æµè¡Œå´æ˜¯åœ¨ Web 2.0 æµªæ½®ä¸­ï¼Œå®ƒä¼´éšç€ AJAX çš„ç¬¬ä¸€ä¸ª Aï¼ˆAsynchronousï¼‰å¸­å·äº† web ã€‚Node åœ¨å‡ºç°ä¹‹å‰ï¼Œæœ€ä¹ æƒ¯å¼‚æ­¥ç¼–ç¨‹çš„ç¨‹åºå‘˜è«è¿‡äºå‰ç«¯å·¥ç¨‹å¸ˆäº†ã€‚å‰ç«¯ç¼–ç¨‹ç®— GUI ç¼–ç¨‹çš„ä¸€ç§ï¼Œå…¶ä¸­å……æ–¥äº†å„ç§ Ajax å’Œäº‹ä»¶ï¼Œè¿™äº›éƒ½æ˜¯å…¸å‹çš„å¼‚æ­¥åº”ç”¨åœºæ™¯ã€‚\nä½†äº‹å®ä¸Šï¼Œå¼‚æ­¥æ—©å°±å­˜åœ¨äºæ“ä½œç³»ç»Ÿçš„åº•å±‚ã€‚åœ¨åº•å±‚ç³»ç»Ÿä¸­ï¼Œå¼‚æ­¥é€šè¿‡ä¿¡å·é‡ã€æ¶ˆæ¯ç­‰æ–¹å¼æœ‰äº†å¹¿æ³›çš„åº”ç”¨ã€‚æ„å¤–çš„æ˜¯ï¼Œåœ¨ç»å¤§å¤šæ•°é«˜çº§ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå¼‚æ­¥å¹¶ä¸å¤šè§ï¼Œç–‘ä¼¼è¢«å±è”½äº†ä¸€èˆ¬ã€‚é€ æˆè¿™ä¸ªç°è±¡çš„ä¸»è¦åŸå› ä¹Ÿè®¸ä»¤äººæƒŠè®¶ï¼šç¨‹åºå‘˜ä¸å¤ªé€‚åˆé€šè¿‡å¼‚æ­¥æ¥è¿›è¡Œç¨‹åºè®¾è®¡ã€‚\nPHP è¿™é—¨è¯­è¨€çš„è®¾è®¡æœ€èƒ½ä½“ç°è¿™ä¸ªè§‚ç‚¹ã€‚å®ƒå¯¹è°ƒç”¨å±‚ä¸ä»…å±è”½äº†å¼‚æ­¥ï¼Œç”šè‡³è¿å¤šçº¿ç¨‹éƒ½ä¸æä¾›ã€‚PHP è¯­è¨€ä»å¤´åˆ°è„šéƒ½æ˜¯ä»¥ åŒæ­¥é˜»å¡ çš„æ–¹å¼æ¥æ‰§è¡Œçš„ã€‚å®ƒçš„ä¼˜ç‚¹ååˆ†æ˜æ˜¾ï¼Œåˆ©äºç¨‹åºå‘˜é¡ºåºç¼–å†™ä¸šåŠ¡é€»è¾‘ï¼›å®ƒçš„ç¼ºç‚¹åœ¨å°è§„æ¨¡ç«™ç‚¹ä¸­åŸºæœ¬ä¸å­˜åœ¨ï¼Œä½†æ˜¯åœ¨å¤æ‚çš„ç½‘ç»œåº”ç”¨ä¸­ï¼Œé˜»å¡å¯¼è‡´å®ƒæ— æ³•æ›´å¥½åœ° å¹¶å‘*^concurrency^* ã€‚\nè€Œåœ¨å…¶ä»–è¯­è¨€ä¸­ï¼Œå°½ç®¡å¯èƒ½å­˜åœ¨å¼‚æ­¥çš„ API ï¼Œä½†æ˜¯ç¨‹åºå‘˜è¿˜æ˜¯ä¹ æƒ¯é‡‡ç”¨åŒæ­¥çš„æ–¹å¼æ¥ç¼–å†™åº”ç”¨ã€‚åœ¨ä¼—å¤šé«˜çº§ç¼–ç¨‹è¯­è¨€æˆ–è¿è¡Œå¹³å°ä¸­ï¼Œå°†å¼‚æ­¥ä½œä¸ºä¸»è¦ç¼–ç¨‹æ–¹å¼å’Œè®¾è®¡ç†å¿µçš„ï¼ŒNode æ˜¯é¦–ä¸ªã€‚\nä¼´éšç€å¼‚æ­¥ I/O çš„è¿˜æœ‰äº‹ä»¶é©±åŠ¨å’Œå•çº¿ç¨‹ï¼Œå®ƒä»¬æ„æˆ Node çš„åŸºè°ƒï¼ŒRyan Dahl æ­£æ˜¯åŸºäºè¿™å‡ ä¸ªå› ç´ è®¾è®¡äº†Nodeã€‚Ryan Dahl æœ€åˆæœŸæœ›è®¾è®¡å‡ºä¸€ä¸ªé«˜æ€§èƒ½çš„ web æœåŠ¡å™¨ï¼Œåæ¥åˆ™æ¼”å˜ä¸ºä¸€ä¸ªå¯ä»¥åŸºäºå®ƒæ„å»ºå„ç§é«˜é€Ÿã€å¯ä¼¸ç¼©ç½‘ç»œåº”ç”¨çš„å¹³å°ï¼Œå› ä¸ºä¸€ä¸ª web æœåŠ¡å™¨å·²ç»æ— æ³•å®Œå…¨æ¶µç›–å’Œä»£è¡¨å®ƒçš„èƒ½åŠ›äº†ã€‚å°½ç®¡å®ƒä¸å†æ˜¯ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä½†æ˜¯å¯ä»¥åŸºäºå®ƒæ­å»ºæ›´å¤šæ›´ä¸°å¯Œã€æ›´å¼ºå¤§çš„ç½‘ç»œåº”ç”¨ã€‚\nä¸ Node çš„äº‹ä»¶é©±åŠ¨ã€å¼‚æ­¥ I/O è®¾è®¡ç†å¿µæ¯”è¾ƒç›¸è¿‘çš„ä¸€ä¸ªçŸ¥åäº§å“ä¸º Nginx ã€‚Nginx é‡‡ç”¨çº¯ C ç¼–å†™ï¼Œæ€§èƒ½è¡¨ç°éå¸¸ä¼˜å¼‚ã€‚å®ƒä»¬çš„åŒºåˆ«åœ¨äºï¼ŒNginx å…·å¤‡é¢å‘å®¢æˆ·ç«¯ç®¡ç†è¿æ¥çš„å¼ºå¤§èƒ½åŠ›ï¼Œä½†æ˜¯å®ƒçš„èƒŒåä¾ç„¶å—é™äºå„ç§åŒæ­¥æ–¹å¼çš„ç¼–ç¨‹è¯­è¨€ã€‚ä½† Node å´æ˜¯å…¨æ–¹ä½çš„ï¼Œæ—¢å¯ä»¥ä½œä¸ºæœåŠ¡å™¨ç«¯å»å¤„ç†å®¢æˆ·ç«¯å¸¦æ¥çš„å¤§é‡å¹¶å‘è¯·æ±‚ï¼Œä¹Ÿèƒ½ä½œä¸ºå®¢æˆ·ç«¯å‘ç½‘ç»œä¸­çš„å„ä¸ªåº”ç”¨å‘èµ·å¹¶å‘è¯·æ±‚ã€‚\nå•çº¿ç¨‹ åœ¨æµè§ˆå™¨ä¸­ JavaScript åœ¨å•çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œè€Œä¸”å®ƒè¿˜ä¸ UI æ¸²æŸ“å…±ç”¨ä¸€ä¸ªçº¿ç¨‹ã€‚è¿™æ„å‘³ç€ JavaScript åœ¨æ‰§è¡Œçš„æ—¶å€™ UI æ¸²æŸ“å’Œå“åº”æ˜¯å¤„äºåœæ»çŠ¶æ€çš„ã€‚å¦‚æœè„šæœ¬çš„æ‰§è¡Œæ—¶é—´è¶…è¿‡ 100 æ¯«ç§’ï¼Œç”¨æˆ·å°±ä¼šæ„Ÿåˆ°é¡µé¢å¡é¡¿ï¼Œä»¥ä¸ºç½‘é¡µåœæ­¢å“åº”ã€‚\nå› æ­¤ï¼Œå‰ç«¯é€šè¿‡å¼‚æ­¥å¯ä»¥æ¶ˆé™¤æ‰ UI é˜»å¡çš„ç°è±¡ã€‚\nå¼‚æ­¥ I/O Node é€šè¿‡å¤šçº¿ç¨‹çš„æ–¹å¼å®ç°å¼‚æ­¥ I/O ã€‚é€šè¿‡è®©éƒ¨åˆ†çº¿ç¨‹è¿›è¡Œé˜»å¡ I/O æˆ–è€…éé˜»å¡ I/O åŠ è½®è¯¢æŠ€æœ¯æ¥å®Œæˆæ•°æ®è·å–ï¼Œè®©ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œè®¡ç®—å¤„ç†ï¼Œé€šè¿‡çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡å°† I/O å¾—åˆ°çš„æ•°æ®è¿›è¡Œä¼ é€’ï¼Œè¿™å°±è½»æ¾å®ç°äº†å¼‚æ­¥ I/O ã€‚ï¼ˆå°½ç®¡å®ƒæ˜¯æ¨¡æ‹Ÿçš„ï¼‰\nNode åœ¨ *nix å¹³å°ä¸‹é‡‡ç”¨äº† libeio é…åˆ libev å®ç° I/O éƒ¨åˆ†ï¼Œå®ç°äº†å¼‚æ­¥ I/O ã€‚\nåœ¨ Windows ä¸‹åˆ™ä½¿ç”¨ç³»ç»Ÿé’©å­ IOCP ï¼Œå®ƒåœ¨æŸç§ç¨‹åº¦ä¸Šæä¾›äº†ç†æƒ³çš„å¼‚æ­¥I/Oï¼šè°ƒç”¨å¼‚æ­¥æ–¹æ³•ï¼Œç­‰å¾…I/Oå®Œæˆä¹‹åçš„é€šçŸ¥ï¼Œæ‰§è¡Œå›è°ƒï¼Œç”¨æˆ·æ— é¡»è€ƒè™‘è½®è¯¢ã€‚ä½†æ˜¯å®ƒçš„å†…éƒ¨å…¶å®ä»ç„¶æ˜¯çº¿ç¨‹æ± åŸç†ï¼Œä¸åŒä¹‹å¤„åœ¨äºè¿™äº›çº¿ç¨‹æ± ç”±ç³»ç»Ÿå†…æ ¸æ¥æ‰‹ç®¡ç†ã€‚\näº‹ä»¶å¾ªç¯*^EventLoop^* åœ¨è¿›ç¨‹å¯åŠ¨æ—¶ï¼ŒNode ä¾¿ä¼šåˆ›å»ºä¸€ä¸ªç±»ä¼¼äº while(true) çš„å¾ªç¯ï¼Œæ¯æ‰§è¡Œä¸€æ¬¡å¾ªç¯ä½“çš„è¿‡ç¨‹æˆ‘ä»¬ç§°ä¸º Tick ã€‚æ¯ä¸ª Tick çš„è¿‡ç¨‹å°±æ˜¯æŸ¥çœ‹æ˜¯å¦æœ‰äº‹ä»¶å¾…å¤„ç†ï¼Œå¦‚æœæœ‰ï¼Œå°±å–å‡ºäº‹ä»¶åŠå…¶ç›¸å…³çš„å›è°ƒå‡½æ•°ã€‚å¦‚æœå­˜åœ¨å…³è”çš„å›è°ƒå‡½æ•°ï¼Œå°±æ‰§è¡Œå®ƒä»¬ã€‚ç„¶åè¿›å…¥ä¸‹ä¸ªå¾ªç¯ï¼Œå¦‚æœä¸å†æœ‰äº‹ä»¶å¤„ç†ï¼Œå°±é€€å‡ºè¿›ç¨‹ã€‚\næµè§ˆå™¨é‡‡ç”¨äº†ç±»ä¼¼çš„æœºåˆ¶ã€‚äº‹ä»¶å¯èƒ½æ¥è‡ªç”¨æˆ·çš„ç‚¹å‡»æˆ–è€…åŠ è½½æŸäº›æ–‡ä»¶æ—¶äº§ç”Ÿï¼Œè€Œè¿™äº›äº§ç”Ÿçš„äº‹ä»¶éƒ½æœ‰å¯¹åº”çš„è§‚å¯Ÿè€…ã€‚åœ¨ Node ä¸­ï¼Œäº‹ä»¶ä¸»è¦æ¥æºäºç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶ I/O ç­‰ï¼Œè¿™äº›äº‹ä»¶å¯¹åº”çš„è§‚å¯Ÿè€…æœ‰æ–‡ä»¶ I/O è§‚å¯Ÿè€…ã€ç½‘ç»œ I/O è§‚å¯Ÿè€…ç­‰ã€‚è§‚å¯Ÿè€…å°†äº‹ä»¶è¿›è¡Œäº†åˆ†ç±»ã€‚\näº‹ä»¶å¾ªç¯æ˜¯ä¸€ä¸ªå…¸å‹çš„ç”Ÿäº§è€…/æ¶ˆè´¹è€…æ¨¡å‹ã€‚å¼‚æ­¥ I/Oã€ç½‘ç»œè¯·æ±‚ç­‰åˆ™æ˜¯äº‹ä»¶çš„ ç”Ÿäº§è€…*^producer^* ï¼Œæºæºä¸æ–­ä¸º Node æä¾›ä¸åŒç±»å‹çš„äº‹ä»¶ï¼Œè¿™äº›äº‹ä»¶è¢«ä¼ é€’åˆ°å¯¹åº”çš„è§‚å¯Ÿè€…é‚£é‡Œï¼Œäº‹ä»¶å¾ªç¯*^consumer^* åˆ™ä»è§‚å¯Ÿè€…é‚£é‡Œå–å‡ºäº‹ä»¶å¹¶å¤„ç†ã€‚\nåœ¨ Windows ä¸‹ï¼Œè¿™ä¸ªå¾ªç¯åŸºäº IOCP åˆ›å»ºï¼Œè€Œåœ¨ *nix ä¸‹åˆ™åŸºäºå¤šçº¿ç¨‹åˆ›å»ºã€‚\nåœ¨ Node ä¸­ï¼Œé™¤äº† JavaScript æ˜¯å•çº¿ç¨‹å¤–ï¼ŒNode è‡ªèº«å…¶å®æ˜¯å¤šçº¿ç¨‹çš„ï¼Œåªæ˜¯ I/O çº¿ç¨‹ä½¿ç”¨çš„ CPU è¾ƒå°‘ã€‚å¦ä¸€ä¸ªéœ€è¦é‡è§†çš„è§‚ç‚¹åˆ™æ˜¯ï¼Œé™¤äº†ç”¨æˆ·ä»£ç æ— æ³•å¹¶è¡Œæ‰§è¡Œå¤–ï¼Œæ‰€æœ‰çš„ I/O ï¼ˆç£ç›˜ I/O å’Œç½‘ç»œ I/O ç­‰ï¼‰åˆ™æ˜¯å¯ä»¥å¹¶è¡Œèµ·æ¥çš„ã€‚\nJS æ˜¯ä¸€é—¨ å•çº¿ç¨‹ æ‰§è¡Œçš„è¯­è¨€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒä¸€æ—¶é—´åªèƒ½åšä¸€ä»¶äº‹æƒ…ã€‚å¦‚æœå‰ä¸€ä¸ªä»»åŠ¡éå¸¸è€—æ—¶ï¼Œåˆ™åç»­çš„ä»»åŠ¡ä¸å¾—ä¸ä¸€ç›´ç­‰å¾…ï¼Œä»è€Œå¯¼è‡´ç¨‹åºå‡æ­»çš„é—®é¢˜ã€‚\nä¸ºäº†é˜²æ­¢æŸä¸ª è€—æ—¶ä»»åŠ¡ å¯¼è‡´ ç¨‹åºå‡æ­» çš„é—®é¢˜ï¼Œå¼•æ“æŠŠä»»åŠ¡åˆ†ä¸ºäº†ä¸¤å¤§ç±»ï¼š\nåŒæ­¥ä»»åŠ¡^Synchronous^ åˆå«éè€—æ—¶ä»»åŠ¡ï¼ŒæŒ‡çš„æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸Šæ’é˜Ÿæ‰§è¡Œçš„é‚£äº›ä»»åŠ¡ åªæœ‰å‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæ‰èƒ½æ‰§è¡Œåä¸€ä¸ªä»»åŠ¡ å¼‚æ­¥ä»»åŠ¡^Asynchronous^ åˆå«è€—æ—¶ä»»åŠ¡ï¼Œå§”æ‰˜ç»™å®¿ä¸»ç¯å¢ƒæ‰§è¡Œ å½“å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œä¼šé€šçŸ¥ä¸»çº¿ç¨‹æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡çš„å›è°ƒå‡½æ•° æ‰§è¡Œè¿‡ç¨‹ï¼š\nåŒæ­¥ä»»åŠ¡äº¤ç”± JavaScript ä¸»çº¿ç¨‹æ¬¡åºæ‰§è¡Œ å¼‚æ­¥ä»»åŠ¡ å§”æ‰˜ ç»™å®¿ä¸»ç¯å¢ƒæ‰§è¡Œ å·²å®Œæˆçš„å¼‚æ­¥ä»»åŠ¡å¯¹åº”çš„å›è°ƒå‡½æ•°ï¼Œä¼šè¢«åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œ JavaScript ä¸»çº¿ç¨‹çš„ æ‰§è¡Œæ ˆ è¢«æ¸…ç©ºåï¼Œä¼šè¯»å–ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„å›è°ƒå‡½æ•°ä¾æ¬¡æ‰§è¡Œ ä¸»çº¿ç¨‹é€šè¿‡å¾ªç¯æœºåˆ¶ï¼Œä¸æ–­ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­è·å–æ–°çš„ä»»åŠ¡ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯å¾ªç¯ä¸æ–­çš„ï¼Œæ‰€ä»¥æ•´ä¸ªè¿è¡Œæœºåˆ¶åˆè¢«ç§°ä¸º EventLoop ã€‚\nå®å¾®ä»»åŠ¡ JS æŠŠå¼‚æ­¥ä»»åŠ¡åˆåšäº†è¿›ä¸€æ­¥çš„åˆ’åˆ†ï¼ŒåŒ…æ‹¬ï¼š\nå®ä»»åŠ¡^Macrotask^ å¼‚æ­¥ AJAX è¯·æ±‚ setTimeout, setInterval æ–‡ä»¶æ“ä½œ \u0026hellip; å¾®ä»»åŠ¡^Microtask^ Promise.then, catch, finally process.nextTick \u0026hellip; æ¯ä¸€ä¸ªå®ä»»åŠ¡æ‰§è¡Œå®Œä¹‹åï¼Œéƒ½ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ç›¸åº”çš„å¾®ä»»åŠ¡ã€‚å¦‚æœæœ‰ï¼Œåˆ™åœ¨æ‰§è¡Œå®Œæ‰€æœ‰å¾®ä»»åŠ¡ä¹‹åï¼Œå†ç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªå®ä»»åŠ¡ã€‚\näº‹ä»¶æ¥å£ Process.nextTick() â—ï¸ Warning è¿™æ˜¯ Node ç‹¬æœ‰çš„ API\nâš ï¸ Caution WebStrom ä¼¼ä¹æ— æ³•è¯†åˆ« process å˜é‡ï¼Œä½†å¯å®é™…è¿è¡Œ\nåœ¨æœªäº†è§£ process.nextTick()ä¹‹å‰ï¼Œå¾ˆå¤šäººä¹Ÿè®¸ä¸ºäº†ç«‹å³å¼‚æ­¥æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œä¼šè¿™æ ·è°ƒç”¨ setTimeout() æ¥è¾¾åˆ°æ‰€éœ€çš„æ•ˆæœï¼š\nsetTimeout(function () { // TODO }, 0); ç”±äºäº‹ä»¶å¾ªç¯è‡ªèº«çš„ç‰¹ç‚¹ï¼Œå®šæ—¶å™¨çš„ç²¾ç¡®åº¦ä¸å¤Ÿã€‚è€Œäº‹å®ä¸Šï¼Œé‡‡ç”¨å®šæ—¶å™¨éœ€è¦åŠ¨ç”¨çº¢é»‘æ ‘ï¼Œåˆ›å»ºå®šæ—¶å™¨å¯¹è±¡å’Œè¿­ä»£ç­‰æ“ä½œï¼Œè€Œ setTimeout(fn, 0) çš„æ–¹å¼è¾ƒä¸ºæµªè´¹æ€§èƒ½ã€‚å®é™…ä¸Šï¼Œprocess.nextTick() æ–¹æ³•çš„æ“ä½œç›¸å¯¹è¾ƒä¸ºè½»é‡ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š\nprocess.nextTick = function(callback) { // on the way out, don\u0026#39;t bother. // it won\u0026#39;t get fired anyway if (process._exiting) return; if (tickDepth \u0026gt;= process.maxTickDepth) maxTickWarn(); var tock = { callback: callback }; if (process.domain) tock.domain = process.domain; nextTickQueue.push(tock); if (nextTickQueue.length) { process._needTickCallback(); } }; æ¯æ¬¡è°ƒç”¨ process.nextTick() æ–¹æ³•ï¼Œåªä¼šå°†å›è°ƒå‡½æ•°æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œåœ¨ä¸‹ä¸€è½® Tick æ—¶å–å‡ºæ‰§è¡Œã€‚å®šæ—¶å™¨ä¸­é‡‡ç”¨çº¢é»‘æ ‘çš„æ“ä½œæ—¶é—´å¤æ‚åº¦ä¸º O(lg(n)) ï¼ŒnextTick() çš„æ—¶é—´å¤æ‚åº¦ä¸º O(1) ã€‚ç›¸è¾ƒä¹‹ä¸‹ï¼Œprocess.nextTick() æ›´é«˜æ•ˆã€‚\nSetImmediate() â—ï¸ Warning è¿™æ˜¯ Node ç‹¬æœ‰çš„ API\nâš ï¸ Caution æµè§ˆå™¨å‰ç«¯æ²¡æœ‰æ­¤æ–¹æ³•ï¼Œå†™å‰åç«¯å…±ç”¨çš„åŒ…æ˜¯ï¼Œä¸å»ºè®®ä½¿ç”¨\nsetImmediate() æ–¹æ³•ä¸ process.nextTick() æ–¹æ³•ååˆ†ç±»ä¼¼ï¼Œéƒ½æ˜¯å°†å›è°ƒå‡½æ•°å»¶è¿Ÿæ‰§è¡Œã€‚åœ¨ Node v0.9.1 ä¹‹å‰ï¼ŒsetImmediate() è¿˜æ²¡æœ‰å®ç°ï¼Œé‚£æ—¶å€™å®ç°ç±»ä¼¼çš„åŠŸèƒ½ä¸»è¦æ˜¯é€šè¿‡ process.nextTick() æ¥å®Œæˆï¼Œè¯¥æ–¹æ³•çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š\nprocess.nextTick(function () { console.log(\u0026#39;å»¶è¿Ÿæ‰§è¡Œ\u0026#39;); }); console.log(\u0026#39;æ­£å¸¸æ‰§è¡Œ\u0026#39;); ä¸Šè¿°ä»£ç çš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š\næ­£å¸¸æ‰§è¡Œ å»¶è¿Ÿæ‰§è¡Œ è€Œç”¨ setImmediate() å®ç°æ—¶ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹ï¼š\nsetImmediate(function () { console.log(\u0026#39;å»¶è¿Ÿæ‰§è¡Œ\u0026#39;); }); console.log(\u0026#39;æ­£å¸¸æ‰§è¡Œ\u0026#39;); å…¶ç»“æœå®Œå…¨ä¸€æ ·ï¼š\næ­£å¸¸æ‰§è¡Œ å»¶è¿Ÿæ‰§è¡Œ ä½†æ˜¯ä¸¤è€…ä¹‹é—´å…¶å®æ˜¯æœ‰ç»†å¾®å·®åˆ«çš„ã€‚å°†å®ƒä»¬æ”¾åœ¨ä¸€èµ·æ—¶ï¼Œåˆä¼šæ˜¯æ€æ ·çš„ä¼˜å…ˆçº§å‘¢ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\nprocess.nextTick(function () { console.log(\u0026#39;nextTickå»¶è¿Ÿæ‰§è¡Œ\u0026#39;); }); setImmediate(function () { console.log(\u0026#39;setImmediateå»¶è¿Ÿæ‰§è¡Œ\u0026#39;); }); console.log(\u0026#39;æ­£å¸¸æ‰§è¡Œ\u0026#39;); å…¶æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š\næ­£å¸¸æ‰§è¡Œ nextTickå»¶è¿Ÿæ‰§è¡Œ setImmediateå»¶è¿Ÿæ‰§è¡Œ ä»ç»“æœé‡Œå¯ä»¥çœ‹åˆ°ï¼Œprocess.nextTick() ä¸­çš„å›è°ƒå‡½æ•°æ‰§è¡Œçš„ä¼˜å…ˆçº§è¦é«˜äºsetImmediate()ã€‚è¿™é‡Œçš„åŸå› åœ¨äºäº‹ä»¶å¾ªç¯å¯¹è§‚å¯Ÿè€…çš„æ£€æŸ¥æ˜¯æœ‰å…ˆåé¡ºåºçš„ï¼Œprocess.nextTick() å±äº idle è§‚å¯Ÿè€…ï¼ŒsetImmediate() å±äº check è§‚å¯Ÿè€…ã€‚åœ¨æ¯ä¸€ä¸ªè½®å¾ªç¯æ£€æŸ¥ä¸­ï¼Œidle è§‚å¯Ÿè€…å…ˆäº I/O è§‚å¯Ÿè€…ï¼ŒI/O è§‚å¯Ÿè€…å…ˆäº check è§‚å¯Ÿè€…ã€‚\nåœ¨å…·ä½“å®ç°ä¸Šï¼Œprocess.nextTick() çš„å›è°ƒå‡½æ•°ä¿å­˜åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ï¼ŒsetImmediate() çš„ç»“æœåˆ™æ˜¯ä¿å­˜åœ¨é“¾è¡¨ä¸­ã€‚åœ¨è¡Œä¸ºä¸Šï¼Œprocess.nextTick() åœ¨æ¯è½®å¾ªç¯ä¸­ä¼šå°†æ•°ç»„ä¸­çš„å›è°ƒå‡½æ•°å…¨éƒ¨æ‰§è¡Œå®Œï¼Œè€Œ setImmediate() åœ¨æ¯è½®å¾ªç¯ä¸­æ‰§è¡Œé“¾è¡¨ä¸­çš„ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚å¦‚ä¸‹çš„ç¤ºä¾‹ä»£ç å¯ä»¥ä½è¯ï¼š\n// åŠ å…¥ä¸¤ä¸ªnextTick()çš„å›è°ƒå‡½æ•° process.nextTick(function () { console.log(\u0026#39;nextTickå»¶è¿Ÿæ‰§è¡Œ1\u0026#39;); }); process.nextTick(function () { console.log(\u0026#39;nextTickå»¶è¿Ÿæ‰§è¡Œ2\u0026#39;); }); // åŠ å…¥ä¸¤ä¸ªsetImmediate()çš„å›è°ƒå‡½æ•° setImmediate(function () { console.log(\u0026#39;setImmediateå»¶è¿Ÿæ‰§è¡Œ1\u0026#39;); // è¿›å…¥ä¸‹æ¬¡å¾ªç¯ process.nextTick(function () { console.log(\u0026#39;å¼ºåŠ¿æ’å…¥\u0026#39;); }); }); setImmediate(function () { console.log(\u0026#39;setImmediateå»¶è¿Ÿæ‰§è¡Œ2\u0026#39;); }); console.log(\u0026#39;æ­£å¸¸æ‰§è¡Œ\u0026#39;); å…¶æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š\næ­£å¸¸æ‰§è¡Œ nextTickå»¶è¿Ÿæ‰§è¡Œ1 nextTickå»¶è¿Ÿæ‰§è¡Œ2 setImmediateå»¶è¿Ÿæ‰§è¡Œ1 å¼ºåŠ¿æ’å…¥ setImmediateå»¶è¿Ÿæ‰§è¡Œ2 ä»æ‰§è¡Œç»“æœä¸Šå¯ä»¥çœ‹å‡ºï¼Œå½“ç¬¬ä¸€ä¸ª setImmediate() çš„å›è°ƒå‡½æ•°æ‰§è¡Œåï¼Œå¹¶æ²¡æœ‰ç«‹å³æ‰§è¡Œç¬¬äºŒä¸ªï¼Œè€Œæ˜¯è¿›å…¥äº†ä¸‹ä¸€è½®å¾ªç¯ï¼Œå†æ¬¡æŒ‰ process.nextTick() ä¼˜å…ˆã€setImmediate() æ¬¡åçš„é¡ºåºæ‰§è¡Œã€‚ä¹‹æ‰€ä»¥è¿™æ ·è®¾è®¡ï¼Œæ˜¯ä¸ºäº†ä¿è¯æ¯è½®å¾ªç¯èƒ½å¤Ÿè¾ƒå¿«åœ°æ‰§è¡Œç»“æŸï¼Œé˜²æ­¢ CPU å ç”¨è¿‡å¤šè€Œé˜»å¡åç»­ I/O è°ƒç”¨çš„æƒ…å†µã€‚\næœåŠ¡å™¨æ¨¡å‹ ä¸‹é¢ä¸ºå‡ ç§ç»å…¸çš„æœåŠ¡å™¨æ¨¡å‹ï¼Œè¿™é‡Œå¯¹æ¯”ä¸‹å®ƒä»¬çš„ä¼˜ç¼ºç‚¹ã€‚\nåŒæ­¥å¼\nå¯¹äºåŒæ­¥å¼çš„æœåŠ¡ï¼Œä¸€æ¬¡åªèƒ½å¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼Œå¹¶ä¸”å…¶ä½™è¯·æ±‚éƒ½å¤„äºç­‰å¾…çŠ¶æ€\næ¯ è¿›ç¨‹*^process^* / æ¯è¯·æ±‚\nä¸ºæ¯ä¸ªè¯·æ±‚å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œè¿™æ ·å¯ä»¥å¤„ç†å¤šä¸ªè¯·æ±‚ï¼Œä½†æ˜¯å®ƒä¸å…·å¤‡æ‰©å±•æ€§ï¼Œå› ä¸ºç³»ç»Ÿèµ„æºåªæœ‰é‚£ä¹ˆå¤š\næ¯ çº¿ç¨‹*^thread^* / æ¯è¯·æ±‚\nä¸ºæ¯ä¸ªè¯·æ±‚å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†ã€‚å°½ç®¡çº¿ç¨‹æ¯”è¿›ç¨‹è¦è½»é‡ï¼Œä½†æ˜¯ç”±äºæ¯ä¸ªçº¿ç¨‹éƒ½å ç”¨ä¸€å®šå†…å­˜ï¼Œå½“å¤§å¹¶å‘è¯·æ±‚åˆ°æ¥æ—¶ï¼Œå†…å­˜å°†ä¼šå¾ˆå¿«ç”¨å…‰ï¼Œå¯¼è‡´æœåŠ¡å™¨ç¼“æ…¢ã€‚æ¯çº¿ç¨‹/æ¯è¯·æ±‚çš„æ‰©å±•æ€§æ¯”æ¯è¿›ç¨‹/æ¯è¯·æ±‚çš„æ–¹å¼è¦å¥½ï¼Œä½†å¯¹äºå¤§å‹ç«™ç‚¹è€Œè¨€ä¾ç„¶ä¸å¤Ÿ\næ¯çº¿ç¨‹/æ¯è¯·æ±‚çš„æ–¹å¼ç›®å‰è¿˜è¢« Apache æ‰€é‡‡ç”¨ã€‚\nåœ¨ Node ä¸­ï¼Œå¼‚æ­¥ I/O ä¸ä»…ä»…åº”ç”¨åœ¨æ–‡ä»¶æ“ä½œä¸­ã€‚å¯¹äºç½‘ç»œå¥—æ¥å­—çš„å¤„ç†ï¼ŒNode ä¹Ÿåº”ç”¨åˆ°äº†å¼‚æ­¥ I/O ï¼Œç½‘ç»œå¥—æ¥å­—ä¸Šä¾¦å¬åˆ°çš„è¯·æ±‚éƒ½ä¼šå½¢æˆ äº‹ä»¶*^event^* äº¤ç»™ I/O è§‚å¯Ÿè€…*^watcher^* ã€‚äº‹ä»¶å¾ªç¯ä¼šä¸åœåœ°å¤„ç†è¿™äº›ç½‘ç»œ I/O äº‹ä»¶ã€‚å¦‚æœ JavaScript æœ‰ä¼ å…¥å›è°ƒå‡½æ•°ï¼Œè¿™äº›äº‹ä»¶å°†ä¼šæœ€ç»ˆä¼ é€’åˆ°ä¸šåŠ¡é€»è¾‘å±‚è¿›è¡Œå¤„ç†ã€‚åˆ©ç”¨ Node æ„å»º web æœåŠ¡å™¨ï¼Œæ­£æ˜¯åœ¨è¿™æ ·ä¸€ä¸ªåŸºç¡€ä¸Šå®ç°çš„ï¼Œ\nNode é€šè¿‡äº‹ä»¶é©±åŠ¨çš„æ–¹å¼å¤„ç†è¯·æ±‚ï¼Œæ— é¡»ä¸ºæ¯ä¸€ä¸ªè¯·æ±‚åˆ›å»ºé¢å¤–çš„å¯¹åº”çº¿ç¨‹ï¼Œå¯ä»¥çœæ‰åˆ›å»ºçº¿ç¨‹å’Œé”€æ¯çº¿ç¨‹çš„å¼€é”€ï¼ŒåŒæ—¶æ“ä½œç³»ç»Ÿåœ¨è°ƒåº¦ä»»åŠ¡æ—¶å› ä¸ºçº¿ç¨‹è¾ƒå°‘ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢çš„ä»£ä»·å¾ˆä½ã€‚è¿™ä½¿å¾—æœåŠ¡å™¨èƒ½å¤Ÿæœ‰æ¡ä¸ç´Šåœ°å¤„ç†è¯·æ±‚ï¼Œå³ä½¿åœ¨å¤§é‡è¿æ¥çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¸å—çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€çš„å½±å“ï¼Œè¿™æ˜¯ Node é«˜æ€§èƒ½çš„ä¸€ä¸ªåŸå› ã€‚\näº‹ä»¶é©±åŠ¨å¸¦æ¥çš„é«˜æ•ˆå·²ç»æ¸æ¸å¼€å§‹ä¸ºä¸šç•Œæ‰€é‡è§†ã€‚çŸ¥åæœåŠ¡å™¨ Nginx ï¼Œä¹Ÿæ‘’å¼ƒäº†å¤šçº¿ç¨‹çš„æ–¹å¼ï¼Œé‡‡ç”¨äº†å’Œ Node ç›¸åŒçš„äº‹ä»¶é©±åŠ¨ã€‚å¦‚ä»Šï¼ŒNginx å¤§æœ‰å–ä»£ Apache ä¹‹åŠ¿ã€‚Node å…·æœ‰ä¸ Nginx ç›¸åŒçš„ç‰¹æ€§ï¼Œä¸åŒä¹‹å¤„åœ¨äº Nginx é‡‡ç”¨çº¯ C å†™æˆï¼Œæ€§èƒ½è¾ƒé«˜ï¼Œä½†æ˜¯å®ƒä»…é€‚åˆäºåš web æœåŠ¡å™¨ï¼Œä»¥åŠç”¨äºåå‘ä»£ç†æˆ–è´Ÿè½½å‡è¡¡ç­‰æœåŠ¡ï¼Œåœ¨å¤„ç†å…·ä½“ä¸šåŠ¡æ–¹é¢è¾ƒä¸ºæ¬ ç¼ºã€‚\nNode åˆ™æ˜¯ä¸€å¥—é«˜æ€§èƒ½çš„å¹³å°ï¼Œå¯ä»¥åˆ©ç”¨å®ƒæ„å»ºä¸ Nginx ç›¸åŒçš„åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥å¤„ç†å„ç§å…·ä½“ä¸šåŠ¡ï¼Œè€Œä¸”ä¸èƒŒåçš„ç½‘ç»œä¿æŒå¼‚æ­¥ç•…é€šã€‚ä¸¤è€…ç›¸æ¯”ï¼ŒNode æ²¡æœ‰ Nginx åœ¨ web æœåŠ¡å™¨æ–¹é¢é‚£ä¹ˆä¸“ä¸šï¼Œä½†åœºæ™¯æ›´å¤§ï¼Œè‡ªèº«æ€§èƒ½ä¹Ÿä¸é”™ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç»“åˆå®ƒä»¬å„è‡ªä¼˜ç‚¹ï¼Œä»¥è¾¾åˆ°åº”ç”¨çš„æœ€ä¼˜æ€§èƒ½ã€‚\nç”±äºäº‹ä»¶å¾ªç¯æ¨¡å‹éœ€è¦åº”å¯¹æµ·é‡è¯·æ±‚ï¼Œæµ·é‡è¯·æ±‚åŒæ—¶ä½œç”¨åœ¨å•çº¿ç¨‹ä¸Šï¼Œå°±éœ€è¦é˜²æ­¢ä»»ä½•ä¸€ä¸ªè®¡ç®—è€—è´¹è¿‡å¤šçš„ CPU æ—¶é—´ç‰‡ã€‚è‡³äºæ˜¯è®¡ç®—å¯†é›†å‹ï¼Œè¿˜æ˜¯ I/O å¯†é›†å‹ï¼Œåªè¦è®¡ç®—ä¸å½±å“å¼‚æ­¥I/Oçš„è°ƒåº¦ï¼Œé‚£å°±ä¸æ„æˆé—®é¢˜ã€‚å»ºè®®å¯¹ CPU çš„è€—ç”¨ä¸è¦è¶…è¿‡ 10 ms ï¼Œæˆ–è€…å°†å¤§é‡çš„è®¡ç®—åˆ†è§£ä¸ºè¯¸å¤šçš„å°é‡è®¡ç®—ï¼Œé€šè¿‡ setImmediate() è¿›è¡Œè°ƒåº¦ã€‚åªè¦åˆç†åˆ©ç”¨ Node çš„å¼‚æ­¥æ¨¡å‹ä¸ V8 çš„é«˜æ€§èƒ½ï¼Œå°±å¯ä»¥å……åˆ†å‘æŒ¥ CPU å’Œ I/O èµ„æºçš„ä¼˜åŠ¿ã€‚\nå¼‚æ­¥ç¼–ç¨‹ Node åœ¨å¤„ç†å¼‚å¸¸ä¸Šå½¢æˆäº†ä¸€ç§çº¦å®šï¼Œå°†å¼‚å¸¸ä½œä¸ºå›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå®å‚ä¼ å›ï¼Œå¦‚æœä¸ºç©ºå€¼ï¼Œåˆ™è¡¨æ˜å¼‚æ­¥è°ƒç”¨æ²¡æœ‰å¼‚å¸¸æŠ›å‡ºï¼š\nasync(function (err, results) { // TODO }); åœ¨æˆ‘ä»¬è‡ªè¡Œç¼–å†™çš„å¼‚æ­¥æ–¹æ³•ä¸Šï¼Œä¹Ÿéœ€è¦å»éµå¾ªè¿™æ ·ä¸€äº›åŸåˆ™ï¼š\nå¿…é¡»æ‰§è¡Œè°ƒç”¨è€…ä¼ å…¥çš„å›è°ƒå‡½æ•° æ­£ç¡®ä¼ é€’å›å¼‚å¸¸ä¾›è°ƒç”¨è€…åˆ¤æ–­ ç›®å‰ï¼Œå¼‚æ­¥ç¼–ç¨‹çš„ä¸»è¦è§£å†³æ–¹æ¡ˆä¸»è¦æœ‰ï¼š\näº‹ä»¶å‘å¸ƒ/è®¢é˜…æ¨¡å¼ Promise/Deferred æ¨¡å¼ æµç¨‹æ§åˆ¶åº“ äº‹ä»¶å‘å¸ƒ/è®¢é˜…æ¨¡å¼ ğŸ”— Href äº‹ä»¶å‘å¸ƒè®¢é˜…åŸç† [Pubsub](08 Async/#async-pubsub-es6)\nNode è‡ªèº«æä¾›çš„ events æ¨¡å—ï¼Œæ˜¯å‘å¸ƒè®¢é˜…äº‹ä»¶çš„ä¸€ä¸ªç®€å•å®ç°ã€‚\nå’Œ DOM äº‹ä»¶ç›¸æ¯”ï¼Œevents ä¸å­˜åœ¨äº‹ä»¶å†’æ³¡ï¼Œä¹Ÿä¸å­˜åœ¨ preventDefault(), stopPropagation(), stopImmediatePropagation() ç­‰æ§åˆ¶äº‹ä»¶ä¼ é€’çš„æ–¹æ³•ã€‚å®ƒå…·æœ‰ addListener/on(), once(), removeListener(), removeAllListeners(), emit()ç­‰åŸºæœ¬çš„äº‹ä»¶ç›‘å¬æ¨¡å¼çš„æ–¹æ³•å®ç°ã€‚\näº‹ä»¶å‘å¸ƒ/è®¢é˜…æ¨¡å¼çš„æ“ä½œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\nimport EventEmitter from \u0026#39;node:events\u0026#39;; const emitter = new EventEmitter; // è®¢é˜… emitter.on(\u0026#39;event\u0026#39;, (message) =\u0026gt; console.log(message)); // å‘å¸ƒ emitter.emit(\u0026#39;event\u0026#39;, \u0026#39;I am message!\u0026#39;); å¦å¤–ï¼Œç”±äº Node æ˜¯å•çº¿ç¨‹è¿è¡Œçš„ï¼Œå› æ­¤ï¼Œå¦‚æœä¾¦å¬å™¨å¤ªå¤šï¼Œæ¯”æ–¹è¯´è¶…è¿‡10ä¸ªï¼Œå°±ä¼šå¾—åˆ°ä¸€æ¡è­¦å‘Šã€‚\nå¦å¤–ï¼Œevent æ¨¡å—å¯ä»¥é€šè¿‡æ·»åŠ  error ä¾¦å¬å™¨å¤„ç†é”™è¯¯ï¼Œå¦åˆ™è¿™ä¸ªé”™è¯¯å°†ä¼šä½œä¸ºå¼‚å¸¸æŠ›å‡ºã€‚å¦‚æœå¤–éƒ¨æ²¡æœ‰æ•è·è¿™ä¸ªå¼‚å¸¸ï¼Œå°†ä¼šå¼•èµ·çº¿ç¨‹é€€å‡ºã€‚\næ¨¡å—ç»§æ‰¿ ä½¿ç”¨ ES6 çš„ extends è¯­æ³•å®ç°ç±»ç»§æ‰¿ï¼Œå¹¶ä½¿ç”¨ super è°ƒç”¨ events çš„ç›¸å…³æ–¹æ³•ã€‚\nimport EventEmitter from \u0026#39;node:events\u0026#39;; class MyEmitter extends EventEmitter { constructor() { super(); console.log(this); // MyEmitter { // _events: [Object: null prototype] {}, // _eventsCount: 0, // _maxListeners: undefined, // [Symbol(kCapture)]: false // } } } const myEmitter = new MyEmitter(); myEmitter.on(\u0026#39;event\u0026#39;, () =\u0026gt; { console.log(\u0026#39;an event occurred!\u0026#39;); }); myEmitter.emit(\u0026#39;event\u0026#39;); // an event occurred! äº‹ä»¶é˜Ÿåˆ— åœ¨äº‹ä»¶è®¢é˜…/å‘å¸ƒæ¨¡å¼ä¸­ï¼Œé€šå¸¸ä¹Ÿæœ‰ä¸€ä¸ª once() æ–¹æ³•ï¼Œé€šè¿‡å®ƒæ·»åŠ çš„ä¾¦å¬å™¨åªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œåœ¨æ‰§è¡Œä¹‹åå°±ä¼šå°†å®ƒä¸äº‹ä»¶çš„å…³è”ç§»é™¤ã€‚è¿™ä¸ªç‰¹æ€§å¸¸å¸¸å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¿‡æ»¤ä¸€äº›é‡å¤æ€§çš„äº‹ä»¶å“åº”ã€‚ä¸‹é¢æˆ‘ä»¬ä»‹ç»ä¸€ä¸‹å¦‚ä½•é‡‡ç”¨ once() æ¥è§£å†³é›ªå´©é—®é¢˜ã€‚\nåœ¨è®¡ç®—æœºä¸­ï¼Œç¼“å­˜ç”±äºå­˜æ”¾åœ¨å†…å­˜ä¸­ï¼Œè®¿é—®é€Ÿåº¦ååˆ†å¿«ï¼Œå¸¸å¸¸ç”¨äºåŠ é€Ÿæ•°æ®è®¿é—®ï¼Œè®©ç»å¤§å¤šæ•°çš„è¯·æ±‚ä¸å¿…é‡å¤å»åšä¸€äº›ä½æ•ˆçš„æ•°æ®è¯»å–ã€‚æ‰€è°“é›ªå´©é—®é¢˜ï¼Œå°±æ˜¯åœ¨é«˜è®¿é—®é‡ã€å¤§å¹¶å‘é‡çš„æƒ…å†µä¸‹ç¼“å­˜å¤±æ•ˆçš„æƒ…æ™¯ï¼Œæ­¤æ—¶å¤§é‡çš„è¯·æ±‚åŒæ—¶æ¶Œå…¥æ•°æ®åº“ä¸­ï¼Œæ•°æ®åº“æ— æ³•åŒæ—¶æ‰¿å—å¦‚æ­¤å¤§çš„æŸ¥è¯¢è¯·æ±‚ï¼Œè¿›è€Œå¾€å‰å½±å“åˆ°ç½‘ç«™æ•´ä½“çš„å“åº”é€Ÿåº¦ã€‚\nä»¥ä¸‹æ˜¯ä¸€æ¡æ•°æ®åº“æŸ¥è¯¢è¯­å¥çš„è°ƒç”¨ï¼š\n/* operator.ts */ import Db from \u0026#39;./db\u0026#39;; // ä¸åŠ .jså‰ç¼€ï¼Œå°±ä¸ä¼šæŠ¥TS7016é”™è¯¯ // éœ€è¦åœ¨package.jsonä¸­é…ç½®exports:{\u0026#34;./db\u0026#34;: \u0026#34;./db.js\u0026#34;} const db: Db = new Db; const map = new Map([ [\u0026#39;read\u0026#39;, \u0026#39;SQL read\u0026#39;], [\u0026#39;write\u0026#39;, \u0026#39;SQL write\u0026#39;] ]); export default class Operator { query(instructor: string, name: string) { return new Promise((resolve, reject) =\u0026gt; db.select(map.get(instructor), name, function (err: any, results: any) { err ? reject(err) : resolve(results); })); } } /* index.js */ import Db from \u0026#39;./db/main.js\u0026#39; const db = new Db; let result = await db.query(\u0026#39;read\u0026#39;, \u0026#39;db1\u0026#39;); console.log(result); // name: db1 // query: SQL read å¦‚æœç«™ç‚¹åˆšå¥½å¯åŠ¨ï¼Œè¿™æ—¶ç¼“å­˜ä¸­æ˜¯ä¸å­˜åœ¨æ•°æ®çš„ï¼Œè€Œå¦‚æœè®¿é—®é‡å·¨å¤§ï¼ŒåŒä¸€å¥SQL ä¼šè¢«å‘é€åˆ°æ•°æ®åº“ä¸­åå¤æŸ¥è¯¢ï¼Œä¼šå½±å“æœåŠ¡çš„æ•´ä½“æ€§èƒ½ã€‚ä¸€ç§æ”¹è¿›æ–¹æ¡ˆæ˜¯æ·»åŠ ä¸€ä¸ªçŠ¶æ€é”ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹ï¼š\n/* query() */ const enum flag { \u0026#39;ready\u0026#39;, \u0026#39;pending\u0026#39;} let status = flag.ready; function query(instructor: string, name: string) { if (status !== flag.ready) return; status = flag.pending; // db.select... } ä½†æ˜¯åœ¨è¿™ç§æƒ…æ™¯ä¸‹ï¼Œè¿ç»­åœ°å¤šæ¬¡è°ƒç”¨æ—¶ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡è°ƒç”¨æ˜¯ç”Ÿæ•ˆçš„ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥å¼•å…¥äº‹ä»¶é˜Ÿåˆ—ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹ï¼š\nâš ï¸ Caution è¿™åªæ˜¯ä¸€ä¸ªç¤ºèŒƒï¼Œå¹¶æ²¡æœ‰å¾ˆå¥½çš„åˆ†ç¦» operator å’Œ db å±‚ã€‚\n/* index.js */ import Db from \u0026#39;./db/main.js\u0026#39; const db = new Db; let callTimes = 0; for (callTimes; callTimes \u0026lt; 3; callTimes++) { db.querySync(\u0026#39;read\u0026#39;, \u0026#39;db1\u0026#39;).then( ret =\u0026gt; console.log(`write success, data:{${ret}}`) ); db.querySync(\u0026#39;write\u0026#39;, \u0026#39;db2\u0026#39;).then( ret =\u0026gt; { if (ret) console.log(`write success`); } ); } /* operator.ts */ import Db from \u0026#39;./db.js\u0026#39;; import EventEmitter from \u0026#34;node:events\u0026#34;; const db = new Db; const instructionMap = new Map([ [\u0026#39;read\u0026#39;, \u0026#39;SQL read\u0026#39;], [\u0026#39;write\u0026#39;, \u0026#39;SQL write\u0026#39;] ]); // ready = 1, pending = 0 export default class Operator extends EventEmitter { statusList = new Map; instructionList = []; getStatus = (instruction) =\u0026gt; this.statusList.get(instruction); setStatus = (instruction, status) =\u0026gt; this.statusList.set(instruction, status); querySync(instruction, table, data) { const instructionList = this.instructionList; const getStatus = this.getStatus; const setStatus = this.setStatus; if (!instructionList.includes(instruction)) { // ç¬¬ä¸€æ¬¡æ·»åŠ æŒ‡ä»¤æ—¶è®¾ä¸ºreadyæ ‡å¿— setStatus(instruction, \u0026#39;ready\u0026#39;); instructionList.push(instruction); } console.log(Array.from(this.statusList)); // è·å–éœ€è¦å®é™…æ‰§è¡Œçš„sqlè¯­å¥ const emit = (eventName, ...args) =\u0026gt; super.emit(eventName, ...args), once = (...args) =\u0026gt; super.once(...args); return new Promise(resolve =\u0026gt; { once(instruction, results =\u0026gt; { resolve(results); }); if (getStatus(instruction) === \u0026#39;ready\u0026#39;) { setStatus(instruction, \u0026#39;pending\u0026#39;); const command = this.commandBuilder(instruction, table, data); switch (instruction) { case \u0026#39;read\u0026#39;: db.select(command, (err, results) =\u0026gt; { setStatus(instruction, \u0026#39;ready\u0026#39;); emit(instruction, results); }); break; case \u0026#39;write\u0026#39;: db.write(command, data, (err, results) =\u0026gt; { setStatus(instruction, \u0026#39;ready\u0026#39;); emit(instruction, results); }); break; } } }); } commandBuilder(instruction, table, data) { return instructionMap.get(instruction) + table + `${data ? data : \u0026#39;\u0026#39;}`; } } /* db.ts */ let queryTimes = 0; /** * db query * @param sql Form query statement. * @param callback The callback function. when query is finished, the callback function is called. */ export default class Db { select(sql, callback) { queryTimes++; console.log(`queryTimes: ${queryTimes}`); setTimeout(() =\u0026gt; callback(null, `query: ${sql}`, 500)); } write(sql,data, callback){ queryTimes++; console.log(`queryTimes: ${queryTimes}`); setTimeout(() =\u0026gt; callback(null, true, 1200)); } } è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨äº† once() æ–¹æ³•ï¼Œå°†æ‰€æœ‰è¯·æ±‚çš„å›è°ƒéƒ½å‹å…¥äº‹ä»¶é˜Ÿåˆ—ä¸­ï¼Œåˆ©ç”¨å…¶æ‰§è¡Œä¸€æ¬¡å°±ä¼šå°†ç›‘è§†å™¨ç§»é™¤çš„ç‰¹ç‚¹ï¼Œä¿è¯æ¯ä¸€ä¸ªå›è°ƒåªä¼šè¢«æ‰§è¡Œä¸€æ¬¡ã€‚\nå¯¹äºç›¸åŒçš„ SQL è¯­å¥ï¼Œä¿è¯åœ¨åŒä¸€ä¸ªæŸ¥è¯¢å¼€å§‹åˆ°ç»“æŸçš„è¿‡ç¨‹ä¸­æ°¸è¿œåªæœ‰ ä¸€æ¬¡ ï¼ˆå¯ä»¥åœ¨å†™å…¥æ—¶ï¼Œæ¸…é™¤ç›¸åº”è¯»å–çš„ç¼“å­˜ï¼‰ã€‚ SQL åœ¨è¿›è¡ŒæŸ¥è¯¢æ—¶ï¼Œæ–°åˆ°æ¥çš„ç›¸åŒè°ƒç”¨åªéœ€åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…æ•°æ®å°±ç»ªå³å¯ï¼Œä¸€æ—¦æŸ¥è¯¢ç»“æŸï¼Œå¾—åˆ°çš„ç»“æœå¯ä»¥è¢«è¿™äº›è°ƒç”¨å…±åŒä½¿ç”¨ã€‚\nè¿™ç§æ–¹å¼èƒ½èŠ‚çœé‡å¤çš„æ•°æ®åº“è°ƒç”¨äº§ç”Ÿçš„å¼€é”€ã€‚ç”±äº Node å•çº¿ç¨‹æ‰§è¡Œçš„åŸå› ï¼Œæ­¤å¤„æ— é¡»æ‹…å¿ƒçŠ¶æ€åŒæ­¥é—®é¢˜ã€‚è¿™ç§æ–¹å¼å…¶å®ä¹Ÿå¯ä»¥åº”ç”¨åˆ°å…¶ä»–è¿œç¨‹è°ƒç”¨çš„åœºæ™¯ä¸­ï¼Œå³ä½¿å¤–éƒ¨æ²¡æœ‰ç¼“å­˜ç­–ç•¥ï¼Œä¹Ÿèƒ½æœ‰æ•ˆèŠ‚çœé‡å¤å¼€é”€ã€‚\næ­¤å¤„å¯èƒ½å› ä¸ºå­˜åœ¨ä¾¦å¬å™¨è¿‡å¤šå¼•å‘çš„è­¦å‘Šï¼Œéœ€è¦è°ƒç”¨ setMaxListeners(0) ç§»é™¤æ‰è­¦å‘Šï¼Œæˆ–è€…è®¾æ›´å¤§çš„è­¦å‘Šé˜ˆå€¼ã€‚\nonce() æ–¹æ³•äº§ç”Ÿçš„æ•ˆæœï¼Œä¹Ÿå¯ä»¥åœ¨è‘—åçš„ Gearman å¼‚æ­¥åº”ç”¨æ¡†æ¶ä¸­å®ç°ã€‚ä½†åœ¨ JavaScript ä¸­ï¼Œå®ç°è¿™ä¸ªæ•ˆæœååˆ†å®¹æ˜“ã€‚\nå¤šç»§æ‰¿ ğŸ’¡ Trick ç°åœ¨ä½¿ç”¨ ES6 æ–°å¢çš„ [Promise.all()](06 EcmaScript B/#promise-all-es6) ä»¥åŠ ES8 æ–°å¢çš„ [async](06 EcmaScript C#async-es8) è¯­æ³•ï¼Œå¯ä»¥è½»æ˜“æ§åˆ¶å¼‚æ­¥æ‰§è¡Œçš„é¡ºåºäº†ã€‚\näº‹ä»¶å‘å¸ƒ/è®¢é˜…æ¨¡å¼æœ‰ç€å®ƒçš„ä¼˜ç‚¹ã€‚åˆ©ç”¨ é«˜é˜¶å‡½æ•° çš„ä¼˜åŠ¿ï¼Œä¾¦å¬å™¨ä½œä¸ºå›è°ƒå‡½æ•°å¯ä»¥éšæ„æ·»åŠ å’Œåˆ é™¤ï¼Œå®ƒå¸®åŠ©å¼€å‘è€…è½»æ¾å¤„ç†éšæ—¶å¯èƒ½æ·»åŠ çš„ä¸šåŠ¡é€»è¾‘ã€‚ä¹Ÿå¯ä»¥éš”ç¦»ä¸šåŠ¡é€»è¾‘ï¼Œä¿æŒä¸šåŠ¡é€»è¾‘å•å…ƒçš„èŒè´£å•ä¸€ã€‚\nä¸€èˆ¬è€Œè¨€ï¼Œäº‹ä»¶ä¸ä¾¦å¬å™¨çš„å…³ç³»æ˜¯ä¸€å¯¹å¤šï¼Œä½†åœ¨å¼‚æ­¥ç¼–ç¨‹ä¸­ï¼Œä¹Ÿä¼šå‡ºç°äº‹ä»¶ä¸ä¾¦å¬å™¨çš„å…³ç³»æ˜¯å¤šå¯¹ä¸€çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªä¸šåŠ¡é€»è¾‘å¯èƒ½ä¾èµ– ä¸¤ä¸ª é€šè¿‡å›è°ƒæˆ–äº‹ä»¶ä¼ é€’çš„ç»“æœã€‚å‰é¢æåŠçš„å›è°ƒåµŒå¥—è¿‡æ·±çš„åŸå› å³æ˜¯å¦‚æ­¤ã€‚\næˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ—¢è¦äº«å—å¼‚æ­¥I/Oå¸¦æ¥çš„æ€§èƒ½æå‡ï¼Œä¹Ÿè¦ä¿æŒè‰¯å¥½çš„ç¼–ç é£æ ¼ã€‚è¿™é‡Œä»¥æ¸²æŸ“é¡µé¢æ‰€éœ€è¦çš„æ¨¡æ¿è¯»å–ã€æ•°æ®è¯»å–å’Œæœ¬åœ°åŒ–èµ„æºè¯»å–ä¸ºä¾‹ç®€è¦ä»‹ç»ä¸€ä¸‹ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹ï¼š\n/* index.js */ import Db from \u0026#39;./main.js\u0026#39;; import L10n from \u0026#39;./l10n.js\u0026#39; import fs from \u0026#39;fs\u0026#39;; const db = new Db; const l10n = new L10n; function render(data) { console.log(`render ${JSON.stringify(data)}!`); } let results = {vue: \u0026#34;vue component\u0026#34;}; const template_path = \u0026#39;./template.vue\u0026#39;; const fsResult = new Promise(done =\u0026gt; fs.readFile(template_path, function (err, template) { done({template}); })); const l10nResult = db.querySync(\u0026#39;read\u0026#39;, \u0026#39;q1\u0026#39;).then(data =\u0026gt; { return ({data}); }); const dbResult = l10n.get().then(resources =\u0026gt; { return ({resources}); }); Promise.all([fsResult, l10nResult, dbResult]) .then((args) =\u0026gt; { // Promise.all()è¿”å›çš„å·²ç»æ˜¯æ•°ç»„äº†ï¼Œä¸éœ€è¦ const ret = {}; // console.log(JSON.stringify(args)); for (const item of args) { for (const [key,value] of Object.entries(item)) { ret[key]=value; } } console.log(ret) // æ¸²æŸ“é¡µé¢ render(results); }); // [ [ \u0026#39;read\u0026#39;, \u0026#39;ready\u0026#39; ] ] // queryTimes: 1 // { // template: \u0026lt;Buffer 3c 74 65 6d 70 6c 61 74 65 3e 0a 0a 3c 2f 74 65 6d 70 6c 61 74 65 3e 0a 0a 3c 73 63 72 69 70 74 3e 0a 65 78 70 6f 72 74 20 64 65 66 61 75 6c 74 20 7b ... 57 more bytes\u0026gt;, // data: \u0026#39;query: SQL read q1 \u0026#39;, // resources: \u0026#39;language undefined pack\u0026#39; // } // render {\u0026#34;vue\u0026#34;:\u0026#34;vue component\u0026#34;}! Promise/Deferred æ¨¡å¼ Promise/Deferred æ¨¡å¼æœ€æ—©å‡ºç°äº jQuery 1.5 ï¼Œè¯¥ç‰ˆæœ¬å‡ ä¹é‡å†™äº† Ajax éƒ¨åˆ†ï¼Œä½¿å¾—è°ƒç”¨Ajaxæ—¶å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å½¢å¼è¿›è¡Œï¼š\n$.get(\u0026#39;/api\u0026#39;) .success(onSuccess) .error(onError) .complete(onComplete); è¿™ä½¿å¾—å³ä½¿ä¸è°ƒç”¨ success()ã€error() ç­‰æ–¹æ³•ï¼ŒAjax ä¹Ÿä¼šæ‰§è¡Œï¼Œè¿™æ ·çš„è°ƒç”¨æ–¹å¼æ¯”é¢„å…ˆä¼ å…¥å›è°ƒè®©äººè§‰å¾—èˆ’é€‚ä¸€äº›ã€‚åœ¨åŸå§‹çš„ API ä¸­ï¼Œä¸€ä¸ªäº‹ä»¶åªèƒ½å¤„ç†ä¸€ä¸ªå›è°ƒï¼Œè€Œé€šè¿‡ Deferred å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡ é“¾å¼å¼•ç”¨*^chained-reference^* å¯¹äº‹ä»¶åŠ å…¥ä»»æ„çš„ä¸šåŠ¡å¤„ç†é€»è¾‘ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\n$.get(\u0026#39;/api\u0026#39;) .success(onSuccess1) .success(onSuccess2); Promise/Deferred æ˜¯ä¸€ç§å…ˆæ‰§è¡Œå¼‚æ­¥è°ƒç”¨ï¼Œå»¶è¿Ÿä¼ é€’å¤„ç†çš„æ¨¡å¼ã€‚åæ¥ï¼ŒCommonJS å·²ç»æŠ½è±¡å‡ºäº† Promises/A, Promises/B, Promises/D è¿™æ ·å…¸å‹çš„å¼‚æ­¥ Promise/Deferred æ¨¡å‹ï¼Œè¿™ä½¿å¾—å¼‚æ­¥æ“ä½œå¯ä»¥ä»¥ä¸€ç§ä¼˜é›…çš„æ–¹å¼å‡ºç°ã€‚\nES6 æœ€ç»ˆåœ¨è¯­è¨€å±‚é¢å®ç°äº† Promise() ã€‚\nå¼‚æ­¥çš„å¹¿åº¦ä½¿ç”¨ä½¿å¾—å›è°ƒã€åµŒå¥—å‡ºç°ï¼Œä½†æ˜¯ä¸€æ—¦å‡ºç°æ·±åº¦çš„åµŒå¥—ï¼Œå°±ä¼šè®©ç¼–ç¨‹çš„ä½“éªŒå˜å¾—ä¸æ„‰å¿«ï¼Œè€Œ Promise/Deferred æ¨¡å¼åœ¨ä¸€å®šç¨‹åº¦ä¸Šç¼“è§£äº†è¿™ä¸ªé—®é¢˜ã€‚è¿™é‡Œæˆ‘ä»¬å°†ç€é‡ä»‹ç» Promises/A æ¥ä»¥ç‚¹ä»£é¢ä»‹ç» Promise/Deferred æ¨¡å¼ã€‚\nPromises/A\nPromise/Deferred æ¨¡å¼åŒ…å«ä¸¤ç§çŠ¶æ€ï¼Œå³ Promise å’Œ Deferred ã€‚\nPromises/A æè®®å¯¹å•ä¸ªå¼‚æ­¥æ“ä½œåšå‡ºäº†è¿™æ ·çš„æŠ½è±¡å®šä¹‰ï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š\nPromise æ“ä½œåªä¼šå¤„åœ¨3ç§çŠ¶æ€çš„ä¸€ç§ï¼šæœªå®Œæˆæ€*^deferred^* ã€å®Œæˆæ€*^resolved^* å’Œ å¤±è´¥æ€*^rejected^* Promise çš„çŠ¶æ€åªä¼šå‡ºç°ä»æœªå®Œæˆæ€å‘å®Œæˆæ€æˆ–å¤±è´¥æ€è½¬åŒ–ï¼Œä¸èƒ½é€†åã€‚å®Œæˆæ€å’Œå¤±è´¥æ€ä¸èƒ½äº’ç›¸è½¬åŒ– Promise çš„çŠ¶æ€ä¸€æ—¦è½¬åŒ–ï¼Œå°†ä¸èƒ½è¢«æ›´æ”¹ åœ¨ API çš„å®šä¹‰ä¸Šï¼ŒPromises/A æè®®æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚ä¸€ä¸ª Promise å¯¹è±¡åªè¦å…·å¤‡ then() æ–¹æ³•å³å¯ï¼Œå…·ä½“å¦‚ä¸‹ï¼š\næ¥å— å®Œæˆæ€*^resolved^*ã€é”™è¯¯æ€çš„å›è°ƒæ–¹æ³•ã€‚åœ¨æ“ä½œå®Œæˆæˆ–å‡ºç°é”™è¯¯æ—¶ï¼Œå°†ä¼šè°ƒç”¨å¯¹åº”æ–¹æ³• å¯é€‰åœ°æ”¯æŒ progress äº‹ä»¶å›è°ƒä½œä¸ºç¬¬ä¸‰ä¸ªæ–¹æ³• then() æ–¹æ³•åªæ¥å— function å¯¹è±¡ï¼Œå…¶ä½™å¯¹è±¡å°†è¢«å¿½ç•¥ then() æ–¹æ³•ç»§ç»­è¿”å› Promise å¯¹è±¡ï¼Œä»¥å®ç° é“¾å¼è°ƒç”¨ then() æ–¹æ³•çš„å®šä¹‰å¦‚ä¸‹ï¼š\nthen(fulfilledHandler, errorHandler, progressHandler) ç”¨ Node çš„ events æ¨¡å—å¯¹ Promise/A çš„ä¸€ä¸ªå®ç°ï¼š\nimport * as events from \u0026#34;events\u0026#34;; const isFunction = fun =\u0026gt; typeof fun === \u0026#39;function\u0026#39;; class PromiseA extends events { then(fulfilledHandler, errorHandler, progressHandler) { // åˆ©ç”¨once()æ–¹æ³•ï¼Œä¿è¯æˆåŠŸå›è°ƒåªæ‰§è¡Œä¸€æ¬¡ if (isFunction(fulfilledHandler)) super.once(\u0026#39;success\u0026#39;, fulfilledHandler); // åˆ©ç”¨once()æ–¹æ³•ï¼Œä¿è¯å¼‚å¸¸å›è°ƒåªæ‰§è¡Œä¸€æ¬¡ if (isFunction(errorHandler)) super.once(\u0026#39;error\u0026#39;, errorHandler); if (isFunction(progressHandler)) super.on(\u0026#39;progress\u0026#39;, progressHandler); return this; }; } è¿™é‡Œçœ‹åˆ° then() æ–¹æ³•æ‰€åšçš„äº‹æƒ…æ˜¯å°†å›è°ƒå‡½æ•°å­˜æ”¾èµ·æ¥ã€‚ä¸ºäº†å®Œæˆæ•´ä¸ªæµç¨‹ï¼Œè¿˜éœ€è¦è§¦å‘æ‰§è¡Œè¿™äº›å›è°ƒå‡½æ•°çš„åœ°æ–¹ï¼Œå®ç°è¿™äº›åŠŸèƒ½çš„å¯¹è±¡é€šå¸¸è¢«ç§°ä¸º Deferred ï¼Œå³å»¶è¿Ÿå¯¹è±¡ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\nclass Deferred extends PromiseA { state = \u0026#39;unfulfilled\u0026#39;; resolve(obj) { this.state = \u0026#39;fulfilled\u0026#39;; super.emit(\u0026#39;success\u0026#39;, obj); }; reject(err) { this.state = \u0026#39;failed\u0026#39;; super.emit(\u0026#39;error\u0026#39;, err); }; progress(data) { super.emit(\u0026#39;progress\u0026#39;, data); }; } åˆ©ç”¨ Promises/A æè®®çš„æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ä¸€ä¸ªå…¸å‹çš„å“åº”å¯¹è±¡è¿›è¡Œå°è£…ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹ï¼š\n/* RespondObject */ class RespondObject { encoding; instructorMap = new Map([ [\u0026#39;data\u0026#39;, () =\u0026gt; \u0026#39;data\u0026#39;], [\u0026#39;end\u0026#39;, () =\u0026gt; colorLog(\u0026#39;FgBlue\u0026#39;, \u0026#39;Done\u0026#39;)], [\u0026#39;error\u0026#39;, () =\u0026gt; colorize(\u0026#39;Error\u0026#39;, \u0026#39;Error\u0026#39;)] ]); setEncoding(encoding) { this.encoding = encoding; console.log(`encoding is set to ${colorize(\u0026#39;FgRed\u0026#39;, encoding)}`); } on(instructor, callback) { console.log(`instructor is set to ${instructor}`); const instructorFn = this.instructorMap.get(instructor); setImmediate(() =\u0026gt; callback(instructorFn())); } } /* respond */ const res = new RespondObject; res.setEncoding(\u0026#39;utf8\u0026#39;); res.on(\u0026#39;data\u0026#39;, function (chunk) { console.log(\u0026#39;BODY:\u0026#39;, chunk); }); res.on(\u0026#39;end\u0026#39;, function () { console.log(\u0026#39;the progress is ended.\u0026#39;); // Done }); res.on(\u0026#39;error\u0026#39;, function (err) { console.log(\u0026#39;progress is on error: \u0026#39; + err ? err.toString() : \u0026#39;\u0026#39; + \u0026#39;.\u0026#39;); // Error }); è¦å®ç° Promise.then() å½¢å¼çš„ API ï¼Œåªéœ€è¦ç®€å•åœ°æ”¹é€ ä¸€ä¸‹å³å¯ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹ï¼š\n/* Promisify */ class Promisify extends Deferred { constructor(res) { super(); let result = \u0026#39;\u0026#39;; res.setEncoding(\u0026#39;utf8\u0026#39;); res.on(\u0026#39;data\u0026#39;, chunk =\u0026gt; { result += chunk; this.progress(chunk); // æ­¤å¤„åªèƒ½ç”¨thisè€Œä¸èƒ½ç”¨super // ç®­å¤´å‡½æ•°çš„thisæŒ‡å‘ä¸Šä¸‹æ–‡ }); res.on(\u0026#39;end\u0026#39;, () =\u0026gt; { this.resolve(result); }); res.on(\u0026#39;error\u0026#39;, err =\u0026gt; { this.reject(err); }); } } æ›´æ”¹å†…éƒ¨çŠ¶æ€çš„è¡Œä¸ºäº¤ç”±å®šä¹‰è€…å¤„ç†ã€‚ä¸‹é¢ä¸ºå®šä¹‰å¥½ Promise åçš„è°ƒç”¨ç¤ºä¾‹ï¼š\nconst res = new RespondObject; new Promisify(res).then( // class PromiseA () =\u0026gt; {}, // fulfilledHandler () =\u0026gt; {}, // errorHandler () =\u0026gt; {} // progressHandler ) è¿™é‡Œå›åˆ° Promise å’Œ Deferred çš„å·®åˆ«ä¸Šã€‚ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼š\nDeferred ä¸»è¦æ˜¯ç”¨äºå†…éƒ¨ï¼Œç”¨äºç»´æŠ¤å¼‚æ­¥æ¨¡å‹çš„ çŠ¶æ€status Promise åˆ™ä½œç”¨äºå¤–éƒ¨ï¼Œé€šè¿‡then()æ–¹æ³•æš´éœ²ç»™å¤–éƒ¨ä»¥æ·»åŠ è‡ªå®šä¹‰é€»è¾‘ã€‚ ä¸ äº‹ä»¶å‘å¸ƒ/è®¢é˜… æ¨¡å¼ç›¸æ¯”ï¼ŒPromise/Deferred æ¨¡å¼çš„APIæ¥å£å’ŒæŠ½è±¡æ¨¡å‹éƒ½ååˆ†ç®€æ´ã€‚ä»å›¾4-6ä¸­ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œå®ƒå°†ä¸šåŠ¡ä¸­ä¸å¯å˜çš„éƒ¨åˆ†å°è£…åœ¨äº†Deferredä¸­ï¼Œå°†å¯å˜çš„éƒ¨åˆ†äº¤ç»™äº†Promiseã€‚æ­¤æ—¶é—®é¢˜å°±æ¥äº†ï¼Œå¯¹äºä¸åŒçš„åœºæ™¯ï¼Œéƒ½éœ€è¦å»å°è£…å’Œæ”¹é€ å…¶Deferredéƒ¨åˆ†ï¼Œç„¶åæ‰èƒ½å¾—åˆ°ç®€æ´çš„æ¥å£ã€‚å¦‚æœåœºæ™¯ä¸å¸¸ç”¨ï¼Œå°è£…èŠ±è´¹çš„æ—¶é—´ä¸å¸¦æ¥çš„ç®€æ´ç›¸æ¯”å¹¶ä¸ä¸€å®šåˆ’ç®—ã€‚\nPromise æ˜¯ é«˜çº§æ¥å£ ï¼Œäº‹ä»¶æ˜¯ ä½çº§æ¥å£ ã€‚\nä½çº§æ¥å£å¯ä»¥æ„æˆæ›´å¤šæ›´å¤æ‚çš„åœºæ™¯ï¼Œé«˜çº§æ¥å£ä¸€æ—¦å®šä¹‰ï¼Œä¸å¤ªå®¹æ˜“å˜åŒ–ï¼Œä¸å†æœ‰ä½çº§æ¥å£çš„çµæ´»æ€§ï¼Œä½†å¯¹äºè§£å†³å…¸å‹é—®é¢˜éå¸¸æœ‰æ•ˆã€‚Promises/A çš„æ¨¡å‹æŠ½è±¡åœ¨å‡ ç§ Promise æè®®ä¸­ç›¸å¯¹ç®€æ´ã€‚\næµç¨‹æ§åˆ¶åº“ äº‹ä»¶å‘å¸ƒ/è®¢é˜…æ¨¡å¼ å’Œ Promise/Deferred æ¨¡å¼ï¼Œè¿™äº›æ˜¯ç»å…¸çš„æ¨¡å¼æˆ–è€…æ˜¯å†™è¿›è§„èŒƒé‡Œçš„è§£å†³æ–¹æ¡ˆï¼Œä½†ä¸€æ—¦æ¶‰åŠæ¨¡å¼æˆ–è€…è§„èŒƒï¼Œå°±éœ€è¦ä¸ºå®ƒä»¬åšè¾ƒå¤šçš„å‡†å¤‡å·¥ä½œã€‚è¿™ä¸€èŠ‚å°†ä¼šä»‹ç»ä¸€äº›éæ¨¡å¼åŒ–çš„åº”ç”¨ï¼Œè™½éè§„èŒƒï¼Œä½†æ›´çµæ´»ã€‚\nå°¾è§¦å‘ä¸Next é™¤äº†äº‹ä»¶å’Œ Promise å¤–ï¼Œè¿˜æœ‰ä¸€ç±»æ–¹æ³•æ˜¯éœ€è¦ æ‰‹å·¥è°ƒç”¨ æ‰èƒ½æŒç»­æ‰§è¡Œåç»­è°ƒç”¨çš„ï¼Œæˆ‘ä»¬å°†æ­¤ç±»æ–¹æ³•å«åš å°¾è§¦å‘ ï¼Œå¸¸è§çš„å…³é”®è¯æ˜¯ next ã€‚\næ¯ä¸ªä¸­é—´ä»¶ä¼ é€’è¯·æ±‚å¯¹è±¡ã€å“åº”å¯¹è±¡å’Œå°¾è§¦å‘å‡½æ•°ï¼Œé€šè¿‡é˜Ÿåˆ—å½¢æˆä¸€ä¸ªå¤„ç†æµã€‚\nå†…å­˜*^Memory^* åŸºäºæ— é˜»å¡ã€äº‹ä»¶é©±åŠ¨å»ºç«‹çš„ Node æœåŠ¡ï¼Œå…·æœ‰å†…å­˜æ¶ˆè€—ä½çš„ä¼˜ç‚¹ï¼Œéå¸¸é€‚åˆå¤„ç†æµ·é‡çš„ç½‘ç»œè¯·æ±‚ã€‚åœ¨æµ·é‡è¯·æ±‚çš„å‰æä¸‹ï¼Œå¦‚ä½•åˆç†é«˜æ•ˆåœ°ä½¿ç”¨å†…å­˜å°±éœ€è¦è°¨æ…è€ƒè™‘äº†ã€‚\nå†…å­˜é™åˆ¶ åœ¨ä¸€èˆ¬çš„åç«¯å¼€å‘è¯­è¨€ä¸­ï¼Œåœ¨åŸºæœ¬çš„å†…å­˜ä½¿ç”¨ä¸Šæ²¡æœ‰ä»€ä¹ˆé™åˆ¶ï¼Œç„¶è€Œåœ¨ Node ä¸­é€šè¿‡ JavaScript ä½¿ç”¨å†…å­˜æ—¶å°±ä¼šå‘ç°åªèƒ½ä½¿ç”¨éƒ¨åˆ†å†…å­˜ï¼ˆ 64 ä½ç³»ç»Ÿä¸‹çº¦ä¸º 1.4 GB ï¼Œ32 ä½ç³»ç»Ÿä¸‹çº¦ä¸º 0.7 GB ï¼‰ã€‚åœ¨è¿™æ ·çš„é™åˆ¶ä¸‹ï¼Œå°†ä¼šå¯¼è‡´ Node æ— æ³•ç›´æ¥æ“ä½œå¤§å†…å­˜å¯¹è±¡ï¼Œæ¯”å¦‚æ— æ³•å°†ä¸€ä¸ª 2 GB çš„æ–‡ä»¶è¯»å…¥å†…å­˜ä¸­è¿›è¡Œå­—ç¬¦ä¸²åˆ†æå¤„ç†ï¼Œå³ä½¿ç‰©ç†å†…å­˜æœ‰ 32 GB ã€‚è¿™æ ·åœ¨å•ä¸ª Node è¿›ç¨‹çš„æƒ…å†µä¸‹ï¼Œè®¡ç®—æœºçš„å†…å­˜èµ„æºæ— æ³•å¾—åˆ°å……è¶³çš„ä½¿ç”¨ã€‚\né€ æˆè¿™ä¸ªé—®é¢˜çš„ä¸»è¦åŸå› åœ¨äº Node åŸºäº V8 æ„å»ºï¼Œæ‰€ä»¥åœ¨ Node ä¸­ä½¿ç”¨çš„ JavaScript å¯¹è±¡åŸºæœ¬ä¸Šéƒ½æ˜¯é€šè¿‡ V8 è‡ªå·±çš„æ–¹å¼æ¥è¿›è¡Œåˆ†é…å’Œç®¡ç†çš„ã€‚\nV8 çš„è¿™å¥—å†…å­˜ç®¡ç†æœºåˆ¶åœ¨æµè§ˆå™¨çš„åº”ç”¨åœºæ™¯ä¸‹ä½¿ç”¨èµ·æ¥ç»°ç»°æœ‰ä½™ï¼Œè¶³ä»¥èƒœä»»å‰ç«¯é¡µé¢ä¸­çš„æ‰€æœ‰éœ€æ±‚ã€‚ä½†åœ¨ Node ä¸­ï¼Œè¿™å´é™åˆ¶äº†å¼€å‘è€…éšå¿ƒæ‰€æ¬²ä½¿ç”¨å¤§å†…å­˜çš„æƒ³æ³•ã€‚\nå°½ç®¡åœ¨æœåŠ¡å™¨ç«¯æ“ä½œå¤§å†…å­˜ä¹Ÿä¸æ˜¯å¸¸è§çš„éœ€æ±‚åœºæ™¯ï¼Œä½†æœ‰äº†é™åˆ¶ä¹‹åï¼Œæˆ‘ä»¬çš„è¡Œä¸ºå°±å¦‚åŒå¸¦ç€é•£é“è·³èˆï¼Œå¦‚æœåœ¨å®é™…çš„åº”ç”¨ä¸­ä¸å°å¿ƒè§¦ç¢°åˆ°è¿™ä¸ªç•Œé™ï¼Œä¼šé€ æˆè¿›ç¨‹é€€å‡ºã€‚\nè¦çŸ¥æ™“ V8 ä¸ºä½•é™åˆ¶äº†å†…å­˜çš„ç”¨é‡ï¼Œåˆ™éœ€è¦å›å½’åˆ° V8 åœ¨å†…å­˜ä½¿ç”¨ä¸Šçš„ç­–ç•¥ã€‚çŸ¥æ™“å…¶åŸç†åï¼Œæ‰èƒ½é¿å…é—®é¢˜å¹¶æ›´å¥½åœ°è¿›è¡Œå†…å­˜ç®¡ç†ã€‚\nå¯¹è±¡åˆ†é… åœ¨ V8 ä¸­ï¼Œæ‰€æœ‰çš„ JavaScript å¯¹è±¡éƒ½æ˜¯é€šè¿‡å †æ¥è¿›è¡Œåˆ†é…çš„ã€‚Nodeæä¾›äº† V8 ä¸­å†…å­˜ä½¿ç”¨é‡çš„æŸ¥çœ‹æ–¹å¼ï¼Œæ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œå°†å¾—åˆ°è¾“å‡ºçš„å†…å­˜ä¿¡æ¯ï¼š\nconsole.log(...colorize(\u0026#39;Info\u0026#39;, \u0026#39;process.memoryUsage():\u0026#39;), process.memoryUsage()); //=\u0026gt; process.memoryUsage = { rss: 22892544, heapTotal: 4882432, heapUsed: 4198840, external: 273199, arrayBuffers: 28422 } åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼ŒheapTotal å’Œ heapUsed æ˜¯ V8 çš„å †å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œå‰è€…æ˜¯å·²ç”³è¯·åˆ°çš„å †å†…å­˜ï¼Œåè€…æ˜¯å½“å‰ä½¿ç”¨çš„é‡ã€‚\nåƒåœ¾å›æ”¶ V8 çš„åƒåœ¾å›æ”¶ç­–ç•¥ä¸»è¦åŸºäº åˆ†ä»£å¼ åƒåœ¾å›æ”¶æœºåˆ¶ã€‚\nåœ¨è‡ªåŠ¨åƒåœ¾å›æ”¶çš„æ¼”å˜è¿‡ç¨‹ä¸­ï¼Œäººä»¬å‘ç°æ²¡æœ‰ä¸€ç§åƒåœ¾å›æ”¶ç®—æ³•èƒ½å¤Ÿèƒœä»»æ‰€æœ‰çš„åœºæ™¯ã€‚å› ä¸ºåœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œå¯¹è±¡çš„ç”Ÿå­˜å‘¨æœŸé•¿çŸ­ä¸ä¸€ï¼Œä¸åŒçš„ç®—æ³•åªèƒ½é’ˆå¯¹ç‰¹å®šæƒ…å†µå…·æœ‰æœ€å¥½çš„æ•ˆæœã€‚\nä¸ºæ­¤ï¼Œç»Ÿè®¡å­¦åœ¨åƒåœ¾å›æ”¶ç®—æ³•çš„å‘å±•ä¸­äº§ç”Ÿäº†è¾ƒå¤§çš„ä½œç”¨ï¼Œç°ä»£çš„åƒåœ¾å›æ”¶ç®—æ³•ä¸­æŒ‰å¯¹è±¡çš„å­˜æ´»æ—¶é—´å°†å†…å­˜çš„åƒåœ¾å›æ”¶è¿›è¡Œä¸åŒçš„åˆ†ä»£ï¼Œç„¶ååˆ†åˆ«å¯¹ä¸åŒåˆ†ä»£çš„å†…å­˜æ–½ä»¥æ›´é«˜æ•ˆçš„ç®—æ³•ã€‚\nå†…å­˜åˆ†ä»£ åœ¨V8ä¸­ï¼Œä¸»è¦å°†å†…å­˜åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€ç”Ÿä»£ä¸¤ä»£ã€‚æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡ä¸ºå­˜æ´»æ—¶é—´è¾ƒçŸ­çš„å¯¹è±¡ï¼Œè€ç”Ÿä»£ä¸­çš„å¯¹è±¡ä¸ºå­˜æ´»æ—¶é—´è¾ƒé•¿æˆ–å¸¸é©»å†…å­˜çš„å¯¹è±¡ã€‚\nå †çš„æ•´ä½“å¤§å°å°±æ˜¯æ–°ç”Ÿä»£æ‰€ç”¨å†…å­˜ç©ºé—´åŠ ä¸Šè€ç”Ÿä»£çš„å†…å­˜ç©ºé—´ï¼š\n--max-old-space-size - è€ç”Ÿä»£æœ€å¤§å€¼ --max-new-space-size - æ–°ç”Ÿä»£æœ€å¤§å€¼ ğŸ“ Note è¿™ä¸¤ä¸ªæœ€å¤§å€¼éœ€è¦åœ¨å¯åŠ¨æ—¶å°±æŒ‡å®šï¼Œè‹¥ä¸æŒ‡å®šï¼Œåˆ™ V8 å †å†…å­˜çš„æœ€å¤§å€¼åœ¨ 64 ä½ç³»ç»Ÿä¸Šä¸º 1464 MB ï¼Œ32 ä½ç³»ç»Ÿä¸Šä¸º 732 MB ã€‚\nè¿™æ„å‘³ç€ V8 ä½¿ç”¨çš„å†…å­˜æ²¡æœ‰åŠæ³•æ ¹æ®ä½¿ç”¨æƒ…å†µè‡ªåŠ¨æ‰©å……ï¼Œå½“å†…å­˜åˆ†é…è¿‡ç¨‹ä¸­è¶…è¿‡æé™å€¼æ—¶ï¼Œå°±ä¼šå¼•èµ·è¿›ç¨‹å‡ºé”™ã€‚\nScavenge åœ¨åˆ†ä»£çš„åŸºç¡€ä¸Šï¼Œæ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡ä¸»è¦é€šè¿‡ Scavenge ç®—æ³•è¿›è¡Œåƒåœ¾å›æ”¶ã€‚åœ¨ Scavenge çš„å…·ä½“å®ç°ä¸­ï¼Œä¸»è¦é‡‡ç”¨äº† Cheney ç®—æ³•ï¼Œè¯¥ç®—æ³•ç”± C. J. Cheney äº1970 å¹´é¦–æ¬¡å‘è¡¨åœ¨ ACM è®ºæ–‡ä¸Šã€‚\nCheney ç®—æ³•æ˜¯ä¸€ç§é‡‡ç”¨å¤åˆ¶çš„æ–¹å¼å®ç°çš„åƒåœ¾å›æ”¶ç®—æ³•ã€‚å®ƒå°†å †å†…å­˜ä¸€åˆ†ä¸ºäºŒï¼Œæ¯ä¸€éƒ¨åˆ†ç©ºé—´ç§°ä¸º semispace ã€‚åœ¨è¿™ä¸¤ä¸ª semispace ç©ºé—´ä¸­ï¼Œåªæœ‰ä¸€ä¸ªå¤„äºä½¿ç”¨ä¸­ï¼Œå¦ä¸€ä¸ªå¤„äºé—²ç½®çŠ¶æ€ã€‚å¤„äºä½¿ç”¨çŠ¶æ€çš„ semispace ç©ºé—´ç§°ä¸º From ç©ºé—´ï¼Œå¤„äºé—²ç½®çŠ¶æ€çš„ç©ºé—´ç§°ä¸º To ç©ºé—´ã€‚å½“æˆ‘ä»¬åˆ†é…å¯¹è±¡æ—¶ï¼Œå…ˆæ˜¯åœ¨ From ç©ºé—´ä¸­è¿›è¡Œåˆ†é…ã€‚å½“å¼€å§‹è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œä¼šæ£€æŸ¥ From ç©ºé—´ä¸­çš„å­˜æ´»å¯¹è±¡ï¼Œè¿™äº›å­˜æ´»å¯¹è±¡å°†è¢«å¤åˆ¶åˆ° To ç©ºé—´ä¸­ï¼Œè€Œéå­˜æ´»å¯¹è±¡å ç”¨çš„ç©ºé—´å°†ä¼šè¢«é‡Šæ”¾ã€‚å®Œæˆå¤åˆ¶åï¼ŒFrom ç©ºé—´å’Œ To ç©ºé—´çš„è§’è‰²å‘ç”Ÿå¯¹æ¢ã€‚ç®€è€Œè¨€ä¹‹ï¼Œåœ¨åƒåœ¾å›æ”¶çš„è¿‡ç¨‹ä¸­ï¼Œå°±æ˜¯é€šè¿‡å°†å­˜æ´»å¯¹è±¡åœ¨ä¸¤ä¸ª semispace ç©ºé—´ä¹‹é—´è¿›è¡Œå¤åˆ¶ã€‚\nScavenge çš„ç¼ºç‚¹æ˜¯åªèƒ½ä½¿ç”¨å †å†…å­˜ä¸­çš„ä¸€åŠï¼Œè¿™æ˜¯ç”±åˆ’åˆ†ç©ºé—´å’Œå¤åˆ¶æœºåˆ¶æ‰€å†³å®šçš„ã€‚ä½† Scavenge ç”±äºåªå¤åˆ¶å­˜æ´»çš„å¯¹è±¡ï¼Œå¹¶ä¸”å¯¹äºç”Ÿå‘½å‘¨æœŸçŸ­çš„åœºæ™¯å­˜æ´»å¯¹è±¡åªå å°‘éƒ¨åˆ†ï¼Œæ‰€ä»¥å®ƒåœ¨æ—¶é—´æ•ˆç‡ä¸Šæœ‰ä¼˜å¼‚çš„è¡¨ç°ã€‚\nç”±äº Scavenge æ˜¯å…¸å‹çš„ç‰ºç‰²ç©ºé—´æ¢å–æ—¶é—´çš„ç®—æ³•ï¼Œæ‰€ä»¥æ— æ³•å¤§è§„æ¨¡åœ°åº”ç”¨åˆ°æ‰€æœ‰çš„åƒåœ¾å›æ”¶ä¸­ã€‚ä½†å¯ä»¥å‘ç°ï¼ŒScavenge éå¸¸é€‚åˆåº”ç”¨åœ¨æ–°ç”Ÿä»£ä¸­ï¼Œå› ä¸ºæ–°ç”Ÿä»£ä¸­å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸè¾ƒçŸ­ï¼Œæ°æ°é€‚åˆè¿™ä¸ªç®—æ³•ã€‚\næ˜¯æ•…ï¼ŒV8 çš„å †å†…å­˜ç¤ºæ„å›¾åº”å½“å¦‚å›¾æ‰€ç¤ºã€‚\nå®é™…ä½¿ç”¨çš„å †å†…å­˜æ˜¯æ–°ç”Ÿä»£ä¸­çš„ä¸¤ä¸ª semispace ç©ºé—´å¤§å°å’Œè€ç”Ÿä»£æ‰€ç”¨å†…å­˜å¤§å°ä¹‹å’Œã€‚\nå½“ä¸€ä¸ªå¯¹è±¡ç»è¿‡å¤šæ¬¡å¤åˆ¶ä¾ç„¶å­˜æ´»æ—¶ï¼Œå®ƒå°†ä¼šè¢«è®¤ä¸ºæ˜¯ç”Ÿå‘½å‘¨æœŸè¾ƒé•¿çš„å¯¹è±¡ã€‚è¿™ç§è¾ƒé•¿ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡éšåä¼šè¢«ç§»åŠ¨åˆ°è€ç”Ÿä»£ä¸­ï¼Œé‡‡ç”¨æ–°çš„ç®—æ³•è¿›è¡Œç®¡ç†ã€‚å¯¹è±¡ä»æ–°ç”Ÿä»£ä¸­ç§»åŠ¨åˆ°è€ç”Ÿä»£ä¸­çš„è¿‡ç¨‹ç§°ä¸º æ™‹å‡*^promote^* ã€‚\nåœ¨å•çº¯çš„ Scavenge è¿‡ç¨‹ä¸­ï¼ŒFrom ç©ºé—´ä¸­çš„å­˜æ´»å¯¹è±¡ä¼šè¢«å¤åˆ¶åˆ° To ç©ºé—´ä¸­å»ï¼Œç„¶åå¯¹ From ç©ºé—´å’Œ To ç©ºé—´è¿›è¡Œè§’è‰²å¯¹æ¢ï¼ˆåˆç§° ç¿»è½¬*^filp^* ï¼‰ã€‚ä½†åœ¨åˆ†ä»£å¼åƒåœ¾å›æ”¶çš„å‰æä¸‹ï¼ŒFrom ç©ºé—´ä¸­çš„å­˜æ´»å¯¹è±¡åœ¨å¤åˆ¶åˆ° To ç©ºé—´ä¹‹å‰éœ€è¦è¿›è¡Œæ£€æŸ¥ã€‚åœ¨ä¸€å®šæ¡ä»¶ä¸‹ï¼Œéœ€è¦å°†å­˜æ´»å‘¨æœŸé•¿çš„å¯¹è±¡ç§»åŠ¨åˆ°è€ç”Ÿä»£ä¸­ï¼Œä¹Ÿå°±æ˜¯å®Œæˆå¯¹è±¡æ™‹å‡ã€‚\nå¯¹è±¡æ™‹å‡çš„æ¡ä»¶ä¸»è¦æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯å¯¹è±¡æ˜¯å¦ç»å†è¿‡ Scavenge å›æ”¶ï¼Œä¸€ä¸ªæ˜¯ To ç©ºé—´çš„å†…å­˜å ç”¨æ¯”è¶…è¿‡é™åˆ¶ã€‚\nåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒV8 çš„å¯¹è±¡åˆ†é…ä¸»è¦é›†ä¸­åœ¨ From ç©ºé—´ä¸­ã€‚å¯¹è±¡ä» From ç©ºé—´ä¸­å¤åˆ¶åˆ° To ç©ºé—´æ—¶ï¼Œä¼šæ£€æŸ¥å®ƒçš„å†…å­˜åœ°å€æ¥åˆ¤æ–­è¿™ä¸ªå¯¹è±¡æ˜¯å¦å·²ç»ç»å†è¿‡ä¸€æ¬¡ Scavenge å›æ”¶ã€‚å¦‚æœå·²ç»ç»å†è¿‡äº†ï¼Œä¼šå°†è¯¥å¯¹è±¡ä» From ç©ºé—´å¤åˆ¶åˆ°è€ç”Ÿä»£ç©ºé—´ä¸­ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™å¤åˆ¶åˆ° To ç©ºé—´ä¸­ã€‚\nå¦ä¸€ä¸ªåˆ¤æ–­æ¡ä»¶æ˜¯ To ç©ºé—´çš„å†…å­˜å ç”¨æ¯”ã€‚å½“è¦ä» From ç©ºé—´å¤åˆ¶ä¸€ä¸ªå¯¹è±¡åˆ° To ç©ºé—´æ—¶ï¼Œå¦‚æœ To ç©ºé—´å·²ç»ä½¿ç”¨äº†è¶…è¿‡ 25% ï¼Œåˆ™è¿™ä¸ªå¯¹è±¡ç›´æ¥æ™‹å‡åˆ°è€ç”Ÿä»£ç©ºé—´ä¸­ã€‚\nè®¾ç½® 25% è¿™ä¸ªé™åˆ¶å€¼çš„åŸå› æ˜¯å½“è¿™æ¬¡ Scavenge å›æ”¶å®Œæˆåï¼Œè¿™ä¸ª To ç©ºé—´å°†å˜æˆ From ç©ºé—´ï¼Œæ¥ä¸‹æ¥çš„å†…å­˜åˆ†é…å°†åœ¨è¿™ä¸ªç©ºé—´ä¸­è¿›è¡Œã€‚å¦‚æœå æ¯”è¿‡é«˜ï¼Œä¼šå½±å“åç»­çš„å†…å­˜åˆ†é…ã€‚\nå¯¹è±¡æ™‹å‡åï¼Œå°†ä¼šåœ¨è€ç”Ÿä»£ç©ºé—´ä¸­ä½œä¸ºå­˜æ´»å‘¨æœŸè¾ƒé•¿çš„å¯¹è±¡æ¥å¯¹å¾…ï¼Œæ¥å—æ–°çš„å›æ”¶ç®—æ³•å¤„ç†ã€‚\nMark-Sweep å¯¹äºè€ç”Ÿä»£ä¸­çš„å¯¹è±¡ï¼Œç”±äºå­˜æ´»å¯¹è±¡å è¾ƒå¤§æ¯”é‡ï¼Œå†é‡‡ç”¨ Scavenge çš„æ–¹å¼ä¼šæœ‰ä¸¤ä¸ªé—®é¢˜ï¼šä¸€ä¸ªæ˜¯å­˜æ´»å¯¹è±¡è¾ƒå¤šï¼Œå¤åˆ¶å­˜æ´»å¯¹è±¡çš„æ•ˆç‡å°†ä¼šå¾ˆä½ï¼›å¦ä¸€ä¸ªé—®é¢˜ä¾ç„¶æ˜¯æµªè´¹ä¸€åŠç©ºé—´çš„é—®é¢˜ã€‚è¿™ä¸¤ä¸ªé—®é¢˜å¯¼è‡´åº”å¯¹ç”Ÿå‘½å‘¨æœŸè¾ƒé•¿çš„å¯¹è±¡æ—¶ Scavenge ä¼šæ˜¾å¾—æ‰è¥Ÿè§è‚˜ã€‚ä¸ºæ­¤ï¼ŒV8 åœ¨è€ç”Ÿä»£ä¸­ä¸»è¦é‡‡ç”¨äº† Mark-Sweep å’ŒMark-Compact ç›¸ç»“åˆçš„æ–¹å¼è¿›è¡Œåƒåœ¾å›æ”¶ã€‚\nMark-Sweep æ˜¯æ ‡è®°æ¸…é™¤çš„æ„æ€ï¼Œå®ƒåˆ†ä¸ºæ ‡è®°å’Œæ¸…é™¤ä¸¤ä¸ªé˜¶æ®µã€‚ä¸ Scavenge ç›¸æ¯”ï¼ŒMark-Sweep å¹¶ä¸å°†å†…å­˜ç©ºé—´åˆ’åˆ†ä¸ºä¸¤åŠï¼Œæ‰€ä»¥ä¸å­˜åœ¨æµªè´¹ä¸€åŠç©ºé—´çš„è¡Œä¸ºã€‚ä¸ Scavenge å¤åˆ¶æ´»ç€çš„å¯¹è±¡ä¸åŒï¼ŒMark-Sweep åœ¨æ ‡è®°é˜¶æ®µéå†å †ä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼Œå¹¶æ ‡è®°æ´»ç€çš„å¯¹è±¡ï¼Œåœ¨éšåçš„æ¸…é™¤é˜¶æ®µä¸­ï¼Œåªæ¸…é™¤æ²¡æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ã€‚å¯ä»¥çœ‹å‡ºï¼ŒScavenge ä¸­åªå¤åˆ¶æ´»ç€çš„å¯¹è±¡ï¼Œè€Œ Mark-Sweep åªæ¸…ç†æ­»äº¡å¯¹è±¡ã€‚æ´»å¯¹è±¡åœ¨æ–°ç”Ÿä»£ä¸­åªå è¾ƒå°éƒ¨åˆ†ï¼Œæ­»å¯¹è±¡åœ¨è€ç”Ÿä»£ä¸­åªå è¾ƒå°éƒ¨åˆ†ï¼Œè¿™æ˜¯ä¸¤ç§å›æ”¶æ–¹å¼èƒ½é«˜æ•ˆå¤„ç†çš„åŸå› ã€‚\nä¸‹å›¾ä¸º Mark-Sweep åœ¨è€ç”Ÿä»£ç©ºé—´ä¸­æ ‡è®°åçš„ç¤ºæ„å›¾ï¼Œé»‘è‰²éƒ¨åˆ†æ ‡è®°ä¸ºæ­»äº¡çš„å¯¹è±¡ã€‚\nMark-Sweep æœ€å¤§çš„é—®é¢˜æ˜¯åœ¨è¿›è¡Œä¸€æ¬¡æ ‡è®°æ¸…é™¤å›æ”¶åï¼Œå†…å­˜ç©ºé—´ä¼šå‡ºç° ä¸è¿ç»­*^in-consistent^* çš„çŠ¶æ€ã€‚è¿™ç§å†…å­˜ç¢ç‰‡ä¼šå¯¹åç»­çš„å†…å­˜åˆ†é…é€ æˆé—®é¢˜ï¼Œå› ä¸ºå¾ˆå¯èƒ½å‡ºç°éœ€è¦åˆ†é…ä¸€ä¸ªå¤§å¯¹è±¡çš„æƒ…å†µï¼Œè¿™æ—¶æ‰€æœ‰çš„ç¢ç‰‡ç©ºé—´éƒ½æ— æ³•å®Œæˆæ­¤æ¬¡åˆ†é…ï¼Œå°±ä¼šæå‰è§¦å‘åƒåœ¾å›æ”¶ï¼Œè€Œè¿™æ¬¡å›æ”¶æ˜¯ä¸å¿…è¦çš„ã€‚\nMark-Compact ä¸ºäº†è§£å†³ Mark-Sweep çš„å†…å­˜ç¢ç‰‡é—®é¢˜ï¼ŒMark-Compact è¢«æå‡ºæ¥ã€‚Mark-Compact æ˜¯æ ‡è®°æ•´ç†çš„æ„æ€ï¼Œæ˜¯åœ¨ Mark-Sweep çš„åŸºç¡€ä¸Šæ¼”å˜è€Œæ¥çš„ã€‚å®ƒä»¬çš„å·®åˆ«åœ¨äºå¯¹è±¡åœ¨æ ‡è®°ä¸ºæ­»äº¡åï¼Œåœ¨æ•´ç†çš„è¿‡ç¨‹ä¸­ï¼Œå°†æ´»ç€çš„å¯¹è±¡å¾€ä¸€ç«¯ç§»åŠ¨ï¼Œç§»åŠ¨å®Œæˆåï¼Œç›´æ¥æ¸…ç†æ‰è¾¹ç•Œå¤–çš„å†…å­˜ã€‚\nä¸‹å›¾ä¸º Mark-Compact å®Œæˆæ ‡è®°å¹¶ç§»åŠ¨å­˜æ´»å¯¹è±¡åçš„ç¤ºæ„ï¼Œå…¶ä¸­ç™½è‰²æ ¼å­ä¸ºå­˜æ´»å¯¹è±¡ï¼Œæ·±è‰²æ ¼å­ä¸ºæ­»äº¡å¯¹è±¡ï¼Œæµ…è‰²æ ¼å­ä¸ºå­˜æ´»å¯¹è±¡ç§»åŠ¨åç•™ä¸‹çš„ç©ºæ´ã€‚\nå®Œæˆç§»åŠ¨åï¼Œå°±å¯ä»¥ç›´æ¥æ¸…é™¤æœ€å³è¾¹çš„å­˜æ´»å¯¹è±¡åé¢çš„å†…å­˜åŒºåŸŸå®Œæˆå›æ”¶ã€‚\nåœ¨ V8 çš„å›æ”¶ç­–ç•¥ä¸­ï¼ŒMark-Sweep å’Œ Mark-Compact æ˜¯ç»“åˆä½¿ç”¨çš„ã€‚\nå›æ”¶ç®—æ³• Mark-Sweep Mark-Compact Scavenge é€Ÿåº¦ ä¸­ç­‰ æœ€æ…¢ æœ€å¿« ç©ºé—´å¼€é”€ å°‘ï¼ˆæœ‰ç¢ç‰‡ï¼‰ å°‘ï¼ˆæ— ç¢ç‰‡ï¼‰ åŒå€ç©ºé—´ï¼ˆæ— ç¢ç‰‡ï¼‰ æ˜¯å¦ç§»åŠ¨å¯¹è±¡ å¦ æ˜¯ æ˜¯ åœ¨ Mark-Sweep å’Œ Mark-Compact ä¹‹é—´ï¼Œç”±äº Mark-Compact éœ€è¦ç§»åŠ¨å¯¹è±¡ï¼Œæ‰€ä»¥å®ƒçš„æ‰§è¡Œé€Ÿåº¦ä¸å¯èƒ½å¾ˆå¿«ï¼Œæ‰€ä»¥åœ¨å–èˆä¸Šï¼ŒV8 ä¸»è¦ä½¿ç”¨ Mark-Sweep ï¼Œåœ¨ç©ºé—´ä¸è¶³ä»¥å¯¹ä»æ–°ç”Ÿä»£ä¸­æ™‹å‡è¿‡æ¥çš„å¯¹è±¡è¿›è¡Œåˆ†é…æ—¶æ‰ä½¿ç”¨ Mark-Compact ã€‚\nå¢é‡æ ‡è®°*^Incremental^ ^Marking^* ä¸ºäº†é¿å…å‡ºç° JavaScript åº”ç”¨é€»è¾‘ä¸åƒåœ¾å›æ”¶å™¨çœ‹åˆ°çš„ä¸ä¸€è‡´çš„æƒ…å†µï¼Œåƒåœ¾å›æ”¶çš„ 3 ç§åŸºæœ¬ç®—æ³•éƒ½éœ€è¦å°†åº”ç”¨é€»è¾‘æš‚åœä¸‹æ¥ï¼Œå¾…æ‰§è¡Œå®Œåƒåœ¾å›æ”¶åå†æ¢å¤æ‰§è¡Œåº”ç”¨é€»è¾‘ï¼Œè¿™ç§è¡Œä¸ºè¢«ç§°ä¸º å…¨åœé¡¿*^stop-the-world^* ã€‚åœ¨ V8 çš„åˆ†ä»£å¼åƒåœ¾å›æ”¶ä¸­ï¼Œä¸€æ¬¡å°åƒåœ¾å›æ”¶åªæ”¶é›†æ–°ç”Ÿä»£ï¼Œç”±äºæ–°ç”Ÿä»£é»˜è®¤é…ç½®å¾—è¾ƒå°ï¼Œä¸”å…¶ä¸­å­˜æ´»å¯¹è±¡é€šå¸¸è¾ƒå°‘ï¼Œæ‰€ä»¥å³ä¾¿å®ƒæ˜¯å…¨åœé¡¿çš„å½±å“ä¹Ÿä¸å¤§ã€‚ä½† V8 çš„è€ç”Ÿä»£é€šå¸¸é…ç½®å¾—è¾ƒå¤§ï¼Œä¸”å­˜æ´»å¯¹è±¡è¾ƒå¤šï¼Œå…¨å †åƒåœ¾å›æ”¶full-heap GC çš„æ ‡è®°ã€æ¸…ç†ã€æ•´ç†ç­‰åŠ¨ä½œé€ æˆçš„åœé¡¿å°±ä¼šæ¯”è¾ƒå¯æ€•ï¼Œéœ€è¦è®¾æ³•æ”¹å–„ã€‚\nä¸ºäº†é™ä½å…¨å †åƒåœ¾å›æ”¶å¸¦æ¥çš„åœé¡¿æ—¶é—´ï¼ŒV8 å…ˆä»æ ‡è®°é˜¶æ®µå…¥æ‰‹ï¼Œå°†åŸæœ¬è¦ä¸€å£æ°”åœé¡¿å®Œæˆçš„åŠ¨ä½œæ”¹ä¸º å¢é‡æ ‡è®°incremental marking ï¼Œä¹Ÿå°±æ˜¯æ‹†åˆ†ä¸ºè®¸å¤šå°\u0026quot;æ­¥è¿›\u0026rdquo;ï¼Œæ¯åšå®Œä¸€\u0026quot;æ­¥è¿›\u0026quot;å°±è®© JavaScript åº”ç”¨é€»è¾‘æ‰§è¡Œä¸€å°ä¼šå„¿ï¼Œåƒåœ¾å›æ”¶ä¸åº”ç”¨é€»è¾‘äº¤æ›¿æ‰§è¡Œç›´åˆ°æ ‡è®°é˜¶æ®µå®Œæˆã€‚å›¾5-8ä¸ºå¢é‡æ ‡è®°ç¤ºæ„å›¾ã€‚\nV8 åœ¨ç»è¿‡å¢é‡æ ‡è®°çš„æ”¹è¿›åï¼Œåƒåœ¾å›æ”¶çš„æœ€å¤§åœé¡¿æ—¶é—´å¯ä»¥å‡å°‘åˆ°åŸæœ¬çš„1/6å·¦å³ã€‚\nV8 åç»­è¿˜å¼•å…¥äº† å»¶è¿Ÿæ¸…ç†lazy sweeping ä¸ å¢é‡å¼æ•´ç†incremental compaction ï¼Œè®©æ¸…ç†ä¸æ•´ç†åŠ¨ä½œä¹Ÿå˜æˆå¢é‡å¼çš„ã€‚åŒæ—¶è¿˜å¼•å…¥å¹¶è¡Œæ ‡è®°ä¸å¹¶è¡Œæ¸…ç†ï¼Œè¿›ä¸€æ­¥åˆ©ç”¨å¤šæ ¸æ€§èƒ½é™ä½æ¯æ¬¡åœé¡¿çš„æ—¶é—´ã€‚\nä» V8 çš„è‡ªåŠ¨åƒåœ¾å›æ”¶æœºåˆ¶çš„è®¾è®¡è§’åº¦å¯ä»¥çœ‹åˆ°ï¼Œ V8 å¯¹å†…å­˜ä½¿ç”¨è¿›è¡Œé™åˆ¶çš„ç¼˜ç”±ã€‚æ–°ç”Ÿä»£è®¾è®¡ä¸ºä¸€ä¸ªè¾ƒå°çš„å†…å­˜ç©ºé—´æ˜¯åˆç†çš„ï¼Œè€Œè€ç”Ÿä»£ç©ºé—´è¿‡å¤§å¯¹äºåƒåœ¾å›æ”¶å¹¶æ— ç‰¹åˆ«æ„ä¹‰ã€‚ V8 å¯¹å†…å­˜é™åˆ¶çš„è®¾ç½®å¯¹äº Chrome æµè§ˆå™¨è¿™ç§æ¯ä¸ªé€‰é¡¹å¡é¡µé¢ä½¿ç”¨ä¸€ä¸ª V8 å®ä¾‹è€Œè¨€ï¼Œå†…å­˜çš„ä½¿ç”¨æ˜¯ç»°ç»°æœ‰ä½™äº†ã€‚å¯¹äº Node ç¼–å†™çš„æœåŠ¡å™¨ç«¯æ¥è¯´ï¼Œå†…å­˜é™åˆ¶ä¹Ÿå¹¶ä¸å½±å“æ­£å¸¸åœºæ™¯ä¸‹çš„ä½¿ç”¨ã€‚ä½†æ˜¯å¯¹äº V8 çš„åƒåœ¾å›æ”¶ç‰¹ç‚¹å’Œ JavaScript åœ¨å•çº¿ç¨‹ä¸Šçš„æ‰§è¡Œæƒ…å†µï¼Œåƒåœ¾å›æ”¶æ˜¯å½±å“æ€§èƒ½çš„å› ç´ ä¹‹ä¸€ã€‚æƒ³è¦é«˜æ€§èƒ½çš„æ‰§è¡Œæ•ˆç‡ï¼Œéœ€è¦æ³¨æ„è®©åƒåœ¾å›æ”¶ å°½é‡å°‘ åœ°è¿›è¡Œï¼Œå°¤å…¶æ˜¯å…¨å †åƒåœ¾å›æ”¶ã€‚\nä»¥ web æœåŠ¡å™¨ä¸­çš„ä¼šè¯å®ç°ä¸ºä¾‹ï¼Œä¸€èˆ¬é€šè¿‡å†…å­˜æ¥å­˜å‚¨ï¼Œä½†åœ¨è®¿é—®é‡å¤§çš„æ—¶å€™ä¼šå¯¼è‡´è€ç”Ÿä»£ä¸­çš„å­˜æ´»å¯¹è±¡éª¤å¢ï¼Œä¸ä»…é€ æˆæ¸…ç†/æ•´ç†è¿‡ç¨‹è´¹æ—¶ï¼Œè¿˜ä¼šé€ æˆå†…å­˜ç´§å¼ ï¼Œç”šè‡³æº¢å‡ºã€‚\næ³„æ¼æ§åˆ¶ Node å¯¹å†…å­˜æ³„æ¼ååˆ†æ•æ„Ÿï¼Œä¸€æ—¦çº¿ä¸Šåº”ç”¨æœ‰æˆåƒä¸Šä¸‡çš„æµé‡ï¼Œé‚£æ€•æ˜¯ä¸€ä¸ªå­—èŠ‚çš„å†…å­˜æ³„æ¼ä¹Ÿä¼šé€ æˆå †ç§¯ï¼Œåƒåœ¾å›æ”¶è¿‡ç¨‹ä¸­å°†ä¼šè€—è´¹æ›´å¤šæ—¶é—´è¿›è¡Œå¯¹è±¡æ‰«æï¼Œåº”ç”¨å“åº”ç¼“æ…¢ï¼Œç›´åˆ°è¿›ç¨‹å†…å­˜æº¢å‡ºï¼Œåº”ç”¨å´©æºƒã€‚\nåœ¨ V8 çš„åƒåœ¾å›æ”¶æœºåˆ¶ä¸‹ï¼Œåœ¨é€šå¸¸çš„ä»£ç ç¼–å†™ä¸­ï¼Œå¾ˆå°‘ä¼šå‡ºç°å†…å­˜æ³„æ¼çš„æƒ…å†µã€‚ä½†æ˜¯å†…å­˜æ³„æ¼é€šå¸¸äº§ç”Ÿäºæ— æ„é—´ï¼Œè¾ƒéš¾æ’æŸ¥ã€‚å°½ç®¡å†…å­˜æ³„æ¼çš„æƒ…å†µä¸å°½ç›¸åŒï¼Œä½†å…¶å®è´¨åªæœ‰ä¸€ä¸ªï¼Œé‚£å°±æ˜¯åº”å½“å›æ”¶çš„å¯¹è±¡å‡ºç°æ„å¤–è€Œæ²¡æœ‰è¢«å›æ”¶ï¼Œå˜æˆäº†å¸¸é©»åœ¨è€ç”Ÿä»£ä¸­çš„å¯¹è±¡ã€‚\né€šå¸¸ï¼Œé€ æˆå†…å­˜æ³„æ¼çš„åŸå› æœ‰å¦‚ä¸‹å‡ ä¸ªã€‚\nç¼“å­˜ã€‚\né˜Ÿåˆ—æ¶ˆè´¹ä¸åŠæ—¶ã€‚\nä½œç”¨åŸŸæœªé‡Šæ”¾ã€‚\nç¼“å­˜ ç¼“å­˜åœ¨åº”ç”¨ä¸­çš„ä½œç”¨ä¸¾è¶³è½»é‡ï¼Œå¯ä»¥ååˆ†æœ‰æ•ˆåœ°èŠ‚çœèµ„æºã€‚å› ä¸ºå®ƒçš„è®¿é—®æ•ˆç‡è¦æ¯” I/O çš„æ•ˆç‡é«˜ï¼Œä¸€æ—¦å‘½ä¸­ç¼“å­˜ï¼Œå°±å¯ä»¥èŠ‚çœä¸€æ¬¡ I/O çš„æ—¶é—´ã€‚\nä½†æ˜¯åœ¨ Node ä¸­ï¼Œç¼“å­˜å¹¶éç‰©ç¾ä»·å»‰ã€‚ä¸€æ—¦ä¸€ä¸ªå¯¹è±¡è¢«å½“åšç¼“å­˜æ¥ä½¿ç”¨ï¼Œé‚£å°±æ„å‘³ç€å®ƒå°†ä¼šå¸¸é©»åœ¨è€ç”Ÿä»£ä¸­ã€‚ç¼“å­˜ä¸­å­˜å‚¨çš„é”®è¶Šå¤šï¼Œé•¿æœŸå­˜æ´»çš„å¯¹è±¡ä¹Ÿå°±è¶Šå¤šï¼Œè¿™å°†å¯¼è‡´åƒåœ¾å›æ”¶åœ¨è¿›è¡Œæ‰«æå’Œæ•´ç†æ—¶ï¼Œå¯¹è¿™äº›å¯¹è±¡åšæ— ç”¨åŠŸã€‚\nå¦ä¸€ä¸ªé—®é¢˜åœ¨äºï¼ŒJavaScript å¼€å‘è€…é€šå¸¸å–œæ¬¢ç”¨å¯¹è±¡çš„é”®å€¼å¯¹æ¥ç¼“å­˜ä¸œè¥¿ï¼Œä½†è¿™ä¸ä¸¥æ ¼æ„ä¹‰ä¸Šçš„ç¼“å­˜åˆæœ‰ç€åŒºåˆ«ï¼Œä¸¥æ ¼æ„ä¹‰çš„ç¼“å­˜æœ‰ç€å®Œå–„çš„è¿‡æœŸç­–ç•¥ï¼Œè€Œæ™®é€šå¯¹è±¡çš„é”®å€¼å¯¹å¹¶æ²¡æœ‰ã€‚\nå¦‚ä¸‹ä»£ç è™½ç„¶åˆ©ç”¨ JavaScript å¯¹è±¡ååˆ†å®¹æ˜“åˆ›å»ºä¸€ä¸ªç¼“å­˜å¯¹è±¡ï¼Œä½†æ˜¯å—åƒåœ¾å›æ”¶æœºåˆ¶çš„å½±å“ï¼Œåªèƒ½å°é‡ä½¿ç”¨ï¼š\nclass Cache { map = new Map; get(key) { if (this.map.has(key)) { return this.map.get(key); } else { // get from otherwise } }; set(key, value) { this.map.set(key, value); }; } const cache = new Cache; ä¸Šè¿°ç¤ºä¾‹åœ¨è§£é‡ŠåŸç†åï¼Œååˆ†å®¹æ˜“ç†è§£ï¼Œå¦‚æœéœ€è¦ï¼Œåªè¦é™å®šç¼“å­˜å¯¹è±¡çš„å¤§å°ï¼ŒåŠ ä¸Šå®Œå–„çš„è¿‡æœŸç­–ç•¥ä»¥é˜²æ­¢å†…å­˜æ— é™åˆ¶å¢é•¿ï¼Œè¿˜æ˜¯å¯ä»¥ä¸€ç”¨çš„ã€‚\næ‰€ä»¥åœ¨ Node ä¸­ï¼Œä»»ä½•è¯•å›¾æ‹¿å†…å­˜å½“ç¼“å­˜çš„è¡Œä¸ºéƒ½åº”å½“è¢«é™åˆ¶ã€‚å½“ç„¶ï¼Œè¿™ç§é™åˆ¶å¹¶ä¸æ˜¯ä¸å…è®¸ä½¿ç”¨çš„æ„æ€ï¼Œè€Œæ˜¯è¦å°å¿ƒä¸ºä¹‹ã€‚\nä¸ºäº†è§£å†³ç¼“å­˜ä¸­çš„å¯¹è±¡æ°¸è¿œæ— æ³•é‡Šæ”¾çš„é—®é¢˜ï¼Œéœ€è¦åŠ å…¥ä¸€ç§ç­–ç•¥æ¥é™åˆ¶ç¼“å­˜çš„æ— é™å¢é•¿ã€‚ä¸ºæ­¤æˆ‘æ›¾å†™è¿‡ä¸€ä¸ªæ¨¡å— limitablemap ï¼Œå®ƒå¯ä»¥å®ç°å¯¹é”®å€¼æ•°é‡çš„é™åˆ¶ã€‚ä¸‹é¢æ˜¯å…¶å®ç°ï¼š\nexport default LimitableMap; class LimitableMap { map = new Map; keys = []; constructor(limit = 10) { this.limit = limit; } set(key, value) { const map = this.map; const keys = this.keys; if (!map.has(key)) { if (keys.length === this.limit) { const firstKey = keys.shift(); // removes the first element from an array // and returns that removed element map.delete(firstKey); } keys.push(key); } map.set(key, value); }; get(key) { return this.map[key]; }; } å¯ä»¥çœ‹åˆ°ï¼Œå®ç°è¿‡ç¨‹è¿˜æ˜¯éå¸¸ç®€å•çš„ã€‚è®°å½•é”®åœ¨æ•°ç»„ä¸­ï¼Œä¸€æ—¦è¶…è¿‡æ•°é‡ï¼Œå°±ä»¥å…ˆè¿›å…ˆå‡ºçš„æ–¹å¼è¿›è¡Œæ·˜æ±°ã€‚\nå½“ç„¶ï¼Œè¿™ç§æ·˜æ±°ç­–ç•¥å¹¶ä¸æ˜¯ååˆ†é«˜æ•ˆï¼Œåªèƒ½åº”ä»˜å°å‹åº”ç”¨åœºæ™¯ã€‚\nå¦‚æœéœ€è¦æ›´é«˜æ•ˆçš„ç¼“å­˜ï¼Œå¯ä»¥å‚è§ Isaac Z. Schlueter é‡‡ç”¨ LRU ç®—æ³•çš„ç¼“å­˜ã€‚ç»“åˆæœ‰é™åˆ¶çš„ç¼“å­˜ï¼Œmemoize è¿˜æ˜¯å¯ç”¨çš„ã€‚\nğŸ”— Href LRU-cache\nå¦ä¸€ä¸ªæ¡ˆä¾‹åœ¨äºæ¨¡å—æœºåˆ¶ã€‚åœ¨ç¬¬2ç« çš„æ¨¡å—ä»‹ç»ä¸­ï¼Œä¸ºäº†åŠ é€Ÿæ¨¡å—çš„å¼•å…¥ï¼Œæ‰€æœ‰æ¨¡å—éƒ½ä¼šé€šè¿‡ç¼–è¯‘æ‰§è¡Œï¼Œç„¶åè¢«ç¼“å­˜èµ·æ¥ã€‚ç”±äºé€šè¿‡exportså¯¼å‡ºçš„å‡½æ•°ï¼Œå¯ä»¥è®¿é—®æ–‡ä»¶æ¨¡å—ä¸­çš„ç§æœ‰å˜é‡ï¼Œè¿™æ ·æ¯ä¸ªæ–‡ä»¶æ¨¡å—åœ¨ç¼–è¯‘æ‰§è¡Œåå½¢æˆçš„ä½œç”¨åŸŸå› ä¸ºæ¨¡å—ç¼“å­˜çš„åŸå› ï¼Œä¸ä¼šè¢«é‡Šæ”¾ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š\n(function (exports, require, module, __filename, __dirname) { var local = \u0026#34;å±€éƒ¨å˜é‡\u0026#34;; exports.get = function () { return local; }; }); ç”±äºæ¨¡å—çš„ç¼“å­˜æœºåˆ¶ï¼Œæ¨¡å—æ˜¯å¸¸é©»è€ç”Ÿä»£çš„ã€‚åœ¨è®¾è®¡æ¨¡å—æ—¶ï¼Œè¦ååˆ†å°å¿ƒå†…å­˜æ³„æ¼çš„å‡ºç°ã€‚åœ¨ä¸‹é¢çš„ä»£ç ï¼Œæ¯æ¬¡è°ƒç”¨leak()æ–¹æ³•æ—¶ï¼Œéƒ½å¯¼è‡´å±€éƒ¨å˜é‡leakArrayä¸åœå¢åŠ å†…å­˜çš„å ç”¨ï¼Œä¸”ä¸è¢«é‡Šæ”¾ï¼š\nvar leakArray = []; exports.leak = function () { leakArray.push(\u0026#34;leak\u0026#34; + Math.random()); }; å¦‚æœæ¨¡å—ä¸å¯é¿å…åœ°éœ€è¦è¿™ä¹ˆè®¾è®¡ï¼Œé‚£ä¹ˆè¯·æ·»åŠ æ¸…ç©ºé˜Ÿåˆ—çš„ç›¸åº”æ¥å£ï¼Œä»¥ä¾›è°ƒç”¨è€…é‡Šæ”¾å†…å­˜ã€‚\nç›´æ¥å°†å†…å­˜ä½œä¸ºç¼“å­˜çš„æ–¹æ¡ˆè¦ååˆ†æ…é‡ã€‚é™¤äº†é™åˆ¶ç¼“å­˜çš„å¤§å°å¤–ï¼Œå¦å¤–è¦è€ƒè™‘çš„äº‹æƒ…æ˜¯ï¼Œè¿›ç¨‹ä¹‹é—´æ— æ³•å…±äº«å†…å­˜ã€‚å¦‚æœåœ¨è¿›ç¨‹å†…ä½¿ç”¨ç¼“å­˜ï¼Œè¿™äº›ç¼“å­˜ä¸å¯é¿å…åœ°æœ‰é‡å¤ï¼Œå¯¹ç‰©ç†å†…å­˜çš„ä½¿ç”¨æ˜¯ä¸€ç§æµªè´¹ã€‚\nå¦‚ä½•ä½¿ç”¨å¤§é‡ç¼“å­˜ï¼Œç›®å‰æ¯”è¾ƒå¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯é‡‡ç”¨è¿›ç¨‹å¤–çš„ç¼“å­˜ï¼Œè¿›ç¨‹è‡ªèº«ä¸å­˜å‚¨çŠ¶æ€ã€‚å¤–éƒ¨çš„ç¼“å­˜è½¯ä»¶æœ‰ç€è‰¯å¥½çš„ç¼“å­˜è¿‡æœŸæ·˜æ±°ç­–ç•¥ä»¥åŠè‡ªæœ‰çš„å†…å­˜ç®¡ç†ï¼Œä¸å½±å“Nodeè¿›ç¨‹çš„æ€§èƒ½ã€‚å®ƒçš„å¥½å¤„å¤šå¤šï¼Œåœ¨Nodeä¸­ä¸»è¦å¯ä»¥è§£å†³ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ã€‚\nå°†ç¼“å­˜è½¬ç§»åˆ°å¤–éƒ¨ï¼Œå‡å°‘å¸¸é©»å†…å­˜çš„å¯¹è±¡çš„æ•°é‡ï¼Œè®©åƒåœ¾å›æ”¶æ›´é«˜æ•ˆã€‚\nè¿›ç¨‹ä¹‹é—´å¯ä»¥å…±äº«ç¼“å­˜ã€‚\nç›®å‰ï¼Œå¸‚é¢ä¸Šè¾ƒå¥½çš„ç¼“å­˜æœ‰Rediså’ŒMemcachedã€‚Nodeæ¨¡å—çš„ç”Ÿæ€ç³»ç»Ÿååˆ†å®Œå–„ï¼Œè¿™ä¸¤ä¸ªäº§å“çš„å®¢æˆ·ç«¯éƒ½æœ‰ï¼Œé€šè¿‡ä»¥ä¸‹åœ°å€å¯ä»¥æŸ¥çœ‹å…·ä½“ä½¿ç”¨è¯¦æƒ…ã€‚\nğŸ”— Href Redis\nğŸ”— Href Memcached\né˜Ÿåˆ— åœ¨è§£å†³äº†ç¼“å­˜å¸¦æ¥çš„å†…å­˜æ³„æ¼é—®é¢˜åï¼Œå¦ä¸€ä¸ªä¸ç»æ„äº§ç”Ÿçš„å†…å­˜æ³„æ¼åˆ™æ˜¯é˜Ÿåˆ—ã€‚é˜Ÿåˆ—åœ¨ ç”Ÿäº§è€… - æ¶ˆè´¹è€…æ¨¡å‹Producer-consumer problem ä¸­ç»å¸¸å……å½“ä¸­é—´äº§ç‰©ï¼Œå¯ä»¥é€šè¿‡é˜Ÿåˆ—ï¼ˆæ•°ç»„å¯¹è±¡ï¼‰æ¥å®Œæˆè®¸å¤šç‰¹æ®Šçš„éœ€æ±‚ã€‚\nè¿™æ˜¯ä¸€ä¸ªå®¹æ˜“å¿½ç•¥çš„æƒ…å†µï¼Œå› ä¸ºåœ¨å¤§å¤šæ•°åº”ç”¨åœºæ™¯ä¸‹ï¼Œæ¶ˆè´¹çš„é€Ÿåº¦è¿œè¿œå¤§äºç”Ÿäº§çš„é€Ÿåº¦ï¼Œå†…å­˜æ³„æ¼ä¸æ˜“äº§ç”Ÿã€‚ä½†æ˜¯ä¸€æ—¦æ¶ˆè´¹é€Ÿåº¦ä½äºç”Ÿäº§é€Ÿåº¦ï¼Œå°†ä¼šå½¢æˆå †ç§¯ã€‚\nä¸¾ä¸ªå®é™…çš„ä¾‹å­ï¼Œæœ‰çš„åº”ç”¨ä¼šæ”¶é›†æ—¥å¿—ã€‚å¦‚æœæ¬ ç¼ºè€ƒè™‘ï¼Œä¹Ÿè®¸ä¼šé‡‡ç”¨æ•°æ®åº“æ¥è®°å½•æ—¥å¿—ã€‚æ—¥å¿—é€šå¸¸ä¼šæ˜¯æµ·é‡çš„ï¼Œæ•°æ®åº“æ„å»ºåœ¨æ–‡ä»¶ç³»ç»Ÿä¹‹ä¸Šï¼Œå†™å…¥æ•ˆç‡è¿œè¿œä½äºæ–‡ä»¶ç›´æ¥å†™å…¥ï¼Œäºæ˜¯ä¼šå½¢æˆæ•°æ®åº“å†™å…¥æ“ä½œçš„å †ç§¯ï¼Œè€Œ JavaScript ä¸­ç›¸å…³çš„ä½œç”¨åŸŸä¹Ÿä¸ä¼šå¾—åˆ°é‡Šæ”¾ï¼Œå†…å­˜å ç”¨ä¸ä¼šå›è½ï¼Œä»è€Œå‡ºç°å†…å­˜æ³„æ¼ã€‚\né‡åˆ°è¿™ç§åœºæ™¯ï¼Œè¡¨å±‚çš„è§£å†³æ–¹æ¡ˆæ˜¯æ¢ç”¨æ¶ˆè´¹é€Ÿåº¦æ›´é«˜çš„æŠ€æœ¯ã€‚åœ¨æ—¥å¿—æ”¶é›†çš„æ¡ˆä¾‹ä¸­ï¼Œæ¢ç”¨æ–‡ä»¶å†™å…¥æ—¥å¿—çš„æ–¹å¼ä¼šæ›´é«˜æ•ˆã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœç”Ÿäº§é€Ÿåº¦å› ä¸ºæŸäº›åŸå› çªç„¶æ¿€å¢ï¼Œæˆ–è€…æ¶ˆè´¹é€Ÿåº¦å› ä¸ºçªç„¶çš„ç³»ç»Ÿæ•…éšœé™ä½ï¼Œå†…å­˜æ³„æ¼è¿˜æ˜¯å¯èƒ½å‡ºç°çš„ã€‚\næ·±åº¦çš„è§£å†³æ–¹æ¡ˆåº”è¯¥æ˜¯ç›‘æ§é˜Ÿåˆ—çš„é•¿åº¦ï¼Œä¸€æ—¦å †ç§¯ï¼Œåº”å½“é€šè¿‡ç›‘æ§ç³»ç»Ÿäº§ç”ŸæŠ¥è­¦å¹¶é€šçŸ¥ç›¸å…³äººå‘˜ã€‚å¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯ä»»æ„å¼‚æ­¥è°ƒç”¨éƒ½åº”è¯¥åŒ…å«è¶…æ—¶æœºåˆ¶ï¼Œä¸€æ—¦åœ¨é™å®šçš„æ—¶é—´å†…æœªå®Œæˆå“åº”ï¼Œé€šè¿‡å›è°ƒå‡½æ•°ä¼ é€’è¶…æ—¶å¼‚å¸¸ï¼Œä½¿å¾—ä»»æ„å¼‚æ­¥è°ƒç”¨çš„å›è°ƒéƒ½å…·å¤‡å¯æ§çš„å“åº”æ—¶é—´ï¼Œç»™æ¶ˆè´¹é€Ÿåº¦ä¸€ä¸ªä¸‹é™å€¼ã€‚\nå¯ç”¨è¶…æ—¶æ¨¡å¼æ—¶ï¼Œè°ƒç”¨åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­å°±å¼€å§‹è®¡æ—¶ï¼Œè¶…æ—¶å°±ç›´æ¥å“åº”ä¸€ä¸ªè¶…æ—¶é”™è¯¯ã€‚å¯ç”¨æ‹’ç»æ¨¡å¼æ—¶ï¼Œå½“é˜Ÿåˆ—æ‹¥å¡æ—¶ï¼Œæ–°åˆ°æ¥çš„è°ƒç”¨ä¼šç›´æ¥å“åº”æ‹¥å¡é”™è¯¯ã€‚è¿™ä¸¤ç§æ¨¡å¼éƒ½èƒ½å¤Ÿæœ‰æ•ˆåœ°é˜²æ­¢é˜Ÿåˆ—æ‹¥å¡å¯¼è‡´çš„å†…å­˜æ³„æ¼é—®é¢˜ã€‚\nç¼“å­˜*^Buffer^* Buffer æ˜¯ä¸€ä¸ªåƒ Array çš„å¯¹è±¡ï¼Œæ— éœ€å¼•å…¥æ¨¡å—å³å¯ä½¿ç”¨ã€‚ å¯ä»¥ç†è§£ Buffer æ˜¯åœ¨å†…å­˜ä¸­å¼€è¾Ÿçš„ä¸€ç‰‡åŒºåŸŸï¼Œç”¨äºå­˜æ”¾äºŒè¿›åˆ¶æ•°æ®ã€‚Buffer æ‰€å¼€è¾Ÿçš„æ˜¯å †å¤–å†…å­˜ï¼Œä¸å— V8 å†…å­˜é™åˆ¶å½±å“ã€‚\nåº”ç”¨ æµ æµæ˜¯æ•°æ®çš„é›†åˆï¼ˆä¸æ•°æ®ã€å­—ç¬¦ä¸²ç±»ä¼¼ï¼‰ï¼Œä½†æ˜¯æµçš„æ•°æ®ä¸èƒ½ä¸€æ¬¡æ€§è·å–åˆ°ï¼Œæ•°æ®ä¹Ÿä¸ä¼šå…¨éƒ¨ load åˆ°å†…å­˜ä¸­ï¼Œå› æ­¤æµéå¸¸é€‚åˆå¤§æ•°æ®å¤„ç†ä»¥åŠæ–­æ–­ç»­ç»­è¿”å› chunk çš„å¤–éƒ¨æºã€‚æµçš„ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…ä¹‹é—´çš„é€Ÿåº¦é€šå¸¸æ˜¯ä¸ä¸€è‡´çš„ï¼Œå› æ­¤éœ€è¦ buffer æ¥æš‚å­˜ä¸€äº›æ•°æ®ã€‚buffer å¤§å°é€šè¿‡ highWaterMark å‚æ•°æŒ‡å®šï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ 16Kb ã€‚\nå­˜å‚¨éœ€è¦å ç”¨å¤§é‡å†…å­˜çš„æ•°æ® Buffer å¯¹è±¡å ç”¨çš„å†…å­˜ç©ºé—´æ˜¯ä¸è®¡ç®—åœ¨ Node.js è¿›ç¨‹å†…å­˜ç©ºé—´é™åˆ¶ä¸Šçš„ï¼Œæ‰€ä»¥å¯ä»¥ç”¨æ¥å­˜å‚¨å¤§å¯¹è±¡ï¼Œä½†æ˜¯å¯¹è±¡çš„å¤§å°è¿˜æ˜¯æœ‰é™åˆ¶çš„ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ 32 ä½ç³»ç»Ÿå¤§çº¦æ˜¯ 1G ï¼Œ64 ä½ç³»ç»Ÿå¤§çº¦æ˜¯ 2G ã€‚\næ–¹æ³• åœ¨æµè‡ªåŠ¨éšå¼åˆ›å»º Buffer ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨åˆ›å»º Buffer ï¼Œæ–¹å¼å¦‚ä¸‹ï¼š\nfrom() Buffer.from(obj) obj æ”¯æŒçš„ç±»å‹ string, buffer, arrayBuffer, array, array-like object\nâš ï¸ Caution Buffer.from ä¸æ”¯æŒä¼ å…¥æ•°å­—ï¼š\nBuffer.from(1234); -\u0026gt; TypeError [ERR_INVALID_ARG_TYPE]: The first argument must be of type string or an instance of Buffer, ArrayBuffer, or Array or an Array-like Object. Received type number (1234) è‹¥è¦ä¼ å…¥æ•°å­—å¯ä»¥é‡‡ç”¨ä¼ å…¥æ•°ç»„çš„æ–¹å¼ï¼Œä½†ç”±äºä½¿ç”¨çš„æ˜¯ readUInt8 æ–¹æ³•ï¼Œå› æ­¤ï¼š\nconst buf = Buffer.from([1, 2, 3, 4]); console.log(buf); // \u0026lt;Buffer 01 02 03 04\u0026gt; ä½†æ˜¯è¿™ç§æ–¹å¼å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå½“å­˜å…¥ä¸åŒçš„æ•°å€¼çš„æ—¶å€™ buffer ä¸­è®°å½•çš„äºŒè¿›åˆ¶æ•°æ®ä¼šç›¸åŒï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\nconst buf2 = Buffer.from([127, -1]); console.log(buf2); // \u0026lt;Buffer 7f ff\u0026gt; const buf3 = Buffer.from([127, 255]); console.log(buf3); // \u0026lt;Buffer 7f ff\u0026gt; console.log(buf3.equals(buf2)); // true å› æ­¤ä¸€èˆ¬ä¸æ¨èä½¿ç”¨ Buffer.from() æ¥ä¿å­˜ä¸€ç»„æ•°ã€‚\nalloc() allocUnsafe() allocUnsafeSlow() Buffer.alloc ä¼šç”¨ 0 å€¼å¡«å……å·²åˆ†é…çš„å†…å­˜ï¼Œæ‰€ä»¥ç›¸æ¯”åä¸¤è€…é€Ÿåº¦ä¸Šè¦æ…¢ï¼Œä½†æ˜¯ä¹Ÿè¾ƒä¸ºå®‰å…¨ã€‚\nğŸ“ Note\nå¯åŠ¨æ—¶å¯ä»¥æ·»åŠ  --zero-fill-buffers flag ä½¿ allocUnsafe, allocUnsafeSlow åœ¨åˆ†é…å®Œå†…å­˜åä¹Ÿè¿›è¡Œ 0 å€¼å¡«å……ã€‚\nnode --zero-fill-buffers test.js å½“åˆ†é…çš„ç©ºé—´å°äº 4KB çš„æ—¶å€™ï¼ŒallocUnsafe ä¼šç›´æ¥ä»ä¹‹å‰é¢„åˆ†é…çš„ Buffer é‡Œé¢ slice ç©ºé—´ï¼Œå› æ­¤é€Ÿåº¦æ¯” allocUnsafeSlow è¦å¿«ï¼Œå½“å¤§äºç­‰äº4KBçš„æ—¶å€™äºŒè€…é€Ÿåº¦ç›¸å·®æ— å¼‚ã€‚\n// åˆ†é…ç©ºé—´ç­‰äº4KB function createBuffer(fn, size) { console.time(\u0026#39;buf-\u0026#39; + fn); for (let i = 0; i \u0026lt; 100000; i++) { Buffer[fn](size); } console.timeEnd(\u0026#39;buf-\u0026#39; + fn); } createBuffer(\u0026#39;alloc\u0026#39;, 4096); createBuffer(\u0026#39;allocUnsafe\u0026#39;, 4096); createBuffer(\u0026#39;allocUnsafeSlow\u0026#39;, 4096); -\u0026gt; è¾“å‡º buf-alloc: 197.397ms buf-allocUnsafe: 158.336ms buf-allocUnsafeSlow: 150.171ms ğŸ—‘ Obsolete ä¸æ¨èä½¿ç”¨ new Buffer()\nnew Buffer(100); -\u0026gt; (node:33139) [DEP0005] DeprecationWarning: Buffer() is deprecated due to security and usability issues. Please use the Buffer.alloc(), Buffer.allocUnsafe(), or Buffer.from() methods instead. -\u0026gt; (Use `node --trace-deprecation ...` to show where the warning was created) toString() toJson() Buffer å¯¹è±¡å¯ä»¥ä¸ å­—ç¬¦ä¸²*^string^* ä¹‹é—´ç›¸äº’è½¬æ¢ï¼Œä½†åªæ”¯æŒ ASCII, UTF-8, UTF-16LE/UCS-2, Base64, Binary, Hex ã€‚\nbuf.toString([encoding], [start], [end]) å¯ä»¥è®¾ç½® encodingï¼ˆé»˜è®¤ä¸ºUTF-8ï¼‰ã€startã€ end è¿™ 3 ä¸ªå‚æ•°å®ç°æ•´ä½“æˆ–å±€éƒ¨çš„è½¬æ¢ã€‚å¦‚æœ Buffer å¯¹è±¡ç”±å¤šç§ç¼–ç å†™å…¥ï¼Œå°±éœ€è¦åœ¨å±€éƒ¨æŒ‡å®šä¸åŒçš„ç¼–ç ï¼Œæ‰èƒ½è½¬æ¢å›æ­£å¸¸çš„ç¼–ç ã€‚\nconst buf = Buffer.from(\u0026#39;test\u0026#39;); console.log(buf.toString(\u0026#39;utf8\u0026#39;)); // test console.log(buf.toString(\u0026#39;utf8\u0026#39;, 0, 2)); // te const buf = Buffer.from([0x1, 0x2, 0x3, 0x4, 0x5]); console.log(buf.toJSON()); // {type:\u0026#39;Buffer\u0026#39;, data:[ 1, 2, 3, 4, 5 ]} slice() è£å‰ªåè¿”å›çš„æ–°çš„ buffer ä¸åŸ buffer æŒ‡å‘åŒä¸€å—å†…å­˜ã€‚\nbuf.slice([start[, end]]); -\u0026gt; start èµ·å§‹ä½ç½® end ç»“æŸä½ç½®(ä¸åŒ…å«) ğŸ“ƒ Example\nconst buf1 = Buffer.from(\u0026#39;test\u0026#39;); const buf2 = buf1.slice(1, 3).fill(\u0026#39;x\u0026#39;); console.log(\u0026#34;buf2 content: \u0026#34; + buf2.toString()); // xx console.log(\u0026#34;buf1 content: \u0026#34; + buf1.toString()); // txxt copy() buffer ä¸æ•°ç»„ä¸åŒï¼Œbuffer çš„é•¿åº¦ä¸€æ—¦ç¡®å®šå°±ä¸å†å˜åŒ–ï¼Œå› æ­¤å½“æ‹·è´çš„æº buffer æ¯”ç›®æ ‡ buffer å¤§æ—¶åªä¼šå¤åˆ¶éƒ¨åˆ†çš„å€¼ã€‚\nbuf.copy(target[, targetStart[, sourceStart[, sourceEnd]]]) ğŸ“ƒ Example\nconst buf1 = Buffer.from(\u0026#39;abcdefghijkl\u0026#39;); const buf2 = Buffer.from(\u0026#39;ABCDEF\u0026#39;); buf1.copy(buf2, 1); log(buf2.toString()); //Aabcde equals() æ ¹æ® äºŒè¿›åˆ¶å€¼ æ˜¯å¦ä¸€è‡´åˆ¤æ–­ä¸¤å— Buffer æ˜¯å¦ç›¸åŒã€‚\nbuf.equals(otherBuffer) ğŸ“ƒ Example\nconst buf1 = Buffer.from(\u0026#39;ABC\u0026#39;); const buf2 = Buffer.from(\u0026#39;414243\u0026#39;, \u0026#39;hex\u0026#39;); log(buf1.equals(buf2)); // true é™¤äº† equals ä¹‹å¤–ï¼Œcompare å…¶å®ä¹Ÿå¯ä»¥ç”¨äºåˆ¤æ–­æ˜¯å¦ç›¸ç­‰ï¼ˆå½“ç»“æœä¸º 0 åˆ™ç›¸ç­‰ï¼‰ï¼Œä¸è¿‡ compare æ›´ä¸»è¦çš„ä½œç”¨æ˜¯ç”¨äºå¯¹æ•°ç»„å†…çš„ buffer å®ä¾‹æ’åºã€‚\nincludes indexof buf.includes(value[, byteOffset][, encoding]) buf.indexOf(value[, byteOffset][, encoding]) ğŸ“ƒ Example\nconst buf = Buffer.from(\u0026#39;this is a buffer\u0026#39;); console.log(buf.includes(\u0026#39;this\u0026#39;)); // true console.log(buf.indexOf(\u0026#39;this\u0026#39;)); // 0 read \u0026amp; write å†™å…¥æ–¹æ³•ï¼š\nä½æ•°å›ºå®šä¸”è¶…è¿‡1ä¸ªå­—èŠ‚çš„ï¼š write{Double| Float | Int16 | Int32| UInt16 | UInt32 }{BE|LE}(value, offset)\nä½æ•°ä¸å›ºå®šçš„ï¼š write{Int | UInt}{BE | LE}(value, offset, bytelength) //æ­¤æ–¹æ³•æä¾›äº†æ›´çµæ´»çš„ä½æ•°è¡¨ç¤ºæ•°æ®ï¼ˆæ¯”å¦‚3ä½ã€5ä½ï¼‰\nä½æ•°å›ºå®šæ˜¯1ä¸ªå­—èŠ‚çš„ï¼š write{Int8 | Unit8}(value, offset)\nè¯»å–æ–¹æ³•ï¼š\nä½æ•°å›ºå®šä¸”è¶…è¿‡1ä¸ªå­—èŠ‚çš„ï¼š read{Double| Float | Int16 | Int32 | UInt16 | UInt32 }{BE|LE}ï¼ˆoffset)\nä½æ•°ä¸å›ºå®šçš„ï¼š read{Int | UInt}{BE | LE}(offset, byteLength)\nä½æ•°å›ºå®šæ˜¯1ä¸ªå­—èŠ‚çš„ï¼š read{Int8 | Unit8}(offset)\nDoubleã€Floatã€Int16ã€Int32ã€UInt16ã€UInt32æ—¢ç¡®å®šäº†è¡¨å¾æ•°å­—çš„ä½æ•°ï¼Œä¹Ÿç¡®å®šäº†æ˜¯å¦åŒ…å«è´Ÿæ•°ï¼Œå› æ­¤å®šä¹‰äº†ä¸åŒçš„æ•°æ®èŒƒå›´ã€‚åŒæ—¶ç”±äºè¡¨å¾æ•°å­—çš„ä½æ•°éƒ½è¶…è¿‡8ä½ï¼Œæ— æ³•ç”¨ä¸€ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºï¼Œå› æ­¤å°±æ¶‰åŠåˆ°äº†è®¡ç®—æœºçš„å­—èŠ‚åºåŒºåˆ†ï¼ˆå¤§ç«¯å­—èŠ‚åºä¸å°ç«¯å­—èŠ‚åºï¼‰\nå…³äºå¤§ç«¯å°ç«¯çš„åŒºåˆ«å¯ä»¥è¿™ä¹ˆç†è§£ï¼šæ•°å€¼çš„é«˜ä½åœ¨bufferçš„èµ·å§‹ä½ç½®çš„æ˜¯å¤§ç«¯ï¼Œæ•°å€¼çš„ä½ä½bufferçš„èµ·å§‹ä½ç½®åˆ™æ˜¯å°ç«¯\nconst buf = Buffer.allocUnsafe(2); buf.writeInt16BE(256, 0) console.log(buf); // \u0026lt;Buffer 01 00\u0026gt; buf.writeInt16LE(256, 0) console.log(buf); // \u0026lt;Buffer 00 01\u0026gt; https://tool.lu/hexconvert/ è¿™é‡Œå¯ä»¥æŸ¥çœ‹æ•°å€¼çš„ä¸åŒè¿›åˆ¶ä¹‹é—´çš„è½¬æ¢ï¼Œå¦‚æœæ˜¯å¤§ç«¯çš„è¯ï¼Œåˆ™ç›´æ¥æŒ‰é¡ºåºï¼ˆ0100ï¼‰æ‹¼æ¥16è¿›åˆ¶å³å¯ï¼Œå¦‚æœæ˜¯å°ç«¯åˆ™éœ€è¦è°ƒæ¢ä¸€ä¸‹é¡ºåºæ‰æ˜¯æ­£ç¡®çš„è¡¨ç¤ºæ–¹å¼ã€‚\nconcat() Buffer.concat(list[, totalLength]) //totalLengthéå¿…é¡»ï¼Œä½†å¦‚æœä¸æä¾›ä¼šä¸ºäº†è®¡ç®—totalLengthä¼šå¤šä¸€æ¬¡éå† ğŸ“ƒ Example\nconst buf1 = Buffer.from(\u0026#39;this is\u0026#39;); const buf2 = Buffer.from(\u0026#39; funny\u0026#39;); console.log(Buffer.concat([buf1, buf2], buf1.length + buf2.length)); // \u0026lt;Buffer 74 68 69 73 20 69 73 20 66 75 6e 6e 79\u0026gt; fill(0) æ¸…ç©º buffer æ•°æ®æœ€å¿«çš„åŠæ³•æ˜¯ buffer.fill(0)\nbuffer Buffer æ˜¯å…¨å±€ global ä¸Šçš„ä¸€ä¸ªå¼•ç”¨ï¼ŒæŒ‡å‘çš„å…¶å®æ˜¯ buffer.Buffer\nimport buffer from \u0026#34;buffer\u0026#34;; log(buffer.Buffer === Buffer); // true buffer æ¨¡å—ä¸Šè¿˜æœ‰å…¶ä»–ä¸€äº›å±æ€§å’Œæ–¹æ³•\nimport log from \u0026#34;colorconsole\u0026#34;; import buffer from \u0026#34;buffer\u0026#34;; log(buffer); /* { Blob: [class Blob], resolveObjectURL: [Function: resolveObjectURL], Buffer: [Function: Buffer] { poolSize: 8192, from: [Function: from], of: [Function: of], alloc: [Function: alloc], allocUnsafe: [Function: allocUnsafe], allocUnsafeSlow: [Function: allocUnsafeSlow], isBuffer: [Function: isBuffer], compare: [Function: compare], isEncoding: [Function: isEncoding], concat: [Function: concat], byteLength: [Function: byteLength], [Symbol(kIsEncodingSymbol)]: [Function: isEncoding] }, SlowBuffer: [Function: SlowBuffer], transcode: [Function: transcode], kMaxLength: 4294967296, kStringMaxLength: 536870888, btoa: [Function: btoa], atob: [Function: atob], constants: { MAX_LENGTH: 4294967296, MAX_STRING_LENGTH: 536870888 }, INSPECT_MAX_BYTES: [Getter/Setter] } */ ğŸ“ Note å…¶ä¸­ kMaxLength ä¸ MAX_LENGTH ä»£è¡¨äº†æ–°å»º buffer æ—¶å†…å­˜å¤§å°çš„æœ€å¤§å€¼ï¼Œå½“è¶…è¿‡é™åˆ¶å€¼åå°±ä¼šæŠ¥é”™ã€‚\n32 ä½æœºå™¨ä¸Šæ˜¯ (2^30)-1 (~1GB)\n64 ä½æœºå™¨ä¸Šæ˜¯ (2^31)-1 (~2GB)\né‡Šæ”¾ æˆ‘ä»¬æ— æ³•æ‰‹åŠ¨å¯¹ buffer å®ä¾‹è¿›è¡Œ GC ï¼Œåªèƒ½ä¾é  Node å›æ”¶ï¼Œå› æ­¤å¯ä»¥è§£é™¤å¯¹ buffer å®ä¾‹çš„å¼•ç”¨ä»¥ä½¿å…¶è‡ªåŠ¨é‡Šæ”¾ã€‚\nå®ç° ç»“æ„ æ¨¡å— Buffer æ˜¯ä¸€ä¸ªå…¸å‹çš„ JavaScript ä¸ C++ ç»“åˆçš„æ¨¡å—ï¼Œå®ƒå°†æ€§èƒ½ç›¸å…³éƒ¨åˆ†ç”¨ C++ å®ç°ï¼Œå°†éæ€§èƒ½ç›¸å…³çš„éƒ¨åˆ†ç”¨ JavaScript å®ç°ã€‚\nç”±äº V8 åƒåœ¾å›æ”¶æ€§èƒ½çš„å½±å“ï¼Œå°†å¸¸ç”¨çš„æ“ä½œå¯¹è±¡ç”¨æ›´é«˜æ•ˆå’Œä¸“æœ‰çš„å†…å­˜åˆ†é…å›æ”¶ç­–ç•¥æ¥ç®¡ç†æ˜¯ä¸ªä¸é”™çš„æ€è·¯ã€‚å› æ­¤ Buffer æ‰€å ç”¨çš„å†…å­˜ä¸æ˜¯é€šè¿‡ V8 åˆ†é…çš„ï¼Œå±äº å †å¤–å†…å­˜ ã€‚\nå¯¹è±¡ Buffer å¯¹è±¡ç±»ä¼¼äº Array ï¼Œå®ƒçš„å…ƒç´ ä¸º 16 è¿›åˆ¶çš„ä¸¤ä½æ•°ï¼Œå³ 0 åˆ° 255 çš„æ•°å€¼ã€‚\nconst str = \u0026#34;æ·±å…¥æµ…å‡ºnode.js\u0026#34;; const buf = Buffer.from(str, \u0026#39;utf-8\u0026#39;); console.log(buf); //=\u0026gt; \u0026lt;Buffer e6 b7 b1 e5 85 a5 e6 b5 85 e5 87 ba 6e 6f 64 65 2e 6a 73\u0026gt; ç”±ä¸Šé¢çš„ç¤ºä¾‹å¯è§ï¼Œä¸åŒç¼–ç çš„å­—ç¬¦ä¸²å ç”¨çš„å…ƒç´ ä¸ªæ•°å„ä¸ç›¸åŒï¼Œä¸Šé¢ä»£ç ä¸­çš„ä¸­æ–‡å­—åœ¨ UTF-8 ç¼–ç ä¸‹å ç”¨ 3 ä¸ªå…ƒç´ ï¼Œå­—æ¯å’ŒåŠè§’æ ‡ç‚¹ç¬¦å·å ç”¨ 1 ä¸ªå…ƒç´ ã€‚\nBuffer å— Array ç±»å‹çš„å½±å“å¾ˆå¤§ï¼Œå¯ä»¥è®¿é—® length å±æ€§å¾—åˆ°é•¿åº¦ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¸‹æ ‡è®¿é—®å…ƒç´ ï¼Œåœ¨æ„é€ å¯¹è±¡æ—¶ä¹Ÿååˆ†ç›¸ä¼¼ï¼Œä»£ç å¦‚ä¸‹ï¼š\nconst buf = Buffer.alloc(100); colorLog(\u0026#39;Info\u0026#39;,buf.length); //=\u0026gt; 100 ä¸Šè¿°ä»£ç åˆ†é…äº†ä¸€ä¸ªé•¿ 100 å­—èŠ‚çš„ Buffer å¯¹è±¡ã€‚å¯ä»¥é€šè¿‡ä¸‹æ ‡è®¿é—®åˆšåˆå§‹åŒ–çš„Bufferçš„å…ƒç´ ï¼Œä»£ç å¦‚ä¸‹ï¼š\nconsole.log(buf[10]); è¿™é‡Œä¼šå¾—åˆ°ä¸€ä¸ªæ¯”è¾ƒå¥‡æ€ªçš„ç»“æœï¼Œå®ƒçš„å…ƒç´ å€¼æ˜¯ä¸€ä¸ª0åˆ°255çš„éšæœºå€¼ã€‚\nåŒæ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä¸‹æ ‡å¯¹å®ƒè¿›è¡Œèµ‹å€¼ï¼š\nbuf[10] = 100; console.log(buf[10]); // =\u0026gt; 100 å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœç»™å…ƒç´ èµ‹å€¼ä¸æ˜¯0åˆ°255çš„æ•´æ•°è€Œæ˜¯å°æ•°æ—¶ä¼šæ€æ ·å‘¢ï¼Ÿç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š\nbuf[20] = -100; console.log(buf[20]); // 156 buf[21] = 300; console.log(buf[21]); // 44 buf[22] = 3.1415; console.log(buf[22]); // 3 ç»™å…ƒç´ çš„èµ‹å€¼å¦‚æœå°äº 0 ï¼Œå°±å°†è¯¥å€¼é€æ¬¡åŠ  256 ï¼Œç›´åˆ°å¾—åˆ°ä¸€ä¸ª 0 åˆ° 255 ä¹‹é—´çš„æ•´æ•°ã€‚å¦‚æœå¾—åˆ°çš„æ•°å€¼å¤§äº 255 ï¼Œå°±é€æ¬¡å‡ 256 ï¼Œç›´åˆ°å¾—åˆ° 0~255 åŒºé—´å†…çš„æ•°å€¼ã€‚å¦‚æœæ˜¯å°æ•°ï¼Œèˆå¼ƒå°æ•°éƒ¨åˆ†ï¼Œåªä¿ç•™æ•´æ•°éƒ¨åˆ†ã€‚\nç®—æ³• Buffer å¯¹è±¡çš„å†…å­˜åˆ†é…ä¸æ˜¯åœ¨ V8 çš„å †å†…å­˜ä¸­ï¼Œè€Œæ˜¯åœ¨ Node çš„ C++ å±‚é¢å®ç°å†…å­˜çš„ç”³è¯·çš„ã€‚å› ä¸ºå¤„ç†å¤§é‡çš„å­—èŠ‚æ•°æ®ä¸èƒ½é‡‡ç”¨éœ€è¦ä¸€ç‚¹å†…å­˜å°±å‘æ“ä½œç³»ç»Ÿç”³è¯·ä¸€ç‚¹å†…å­˜çš„æ–¹å¼ï¼Œè¿™å¯èƒ½é€ æˆå¤§é‡çš„å†…å­˜ç”³è¯·çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå¯¹æ“ä½œç³»ç»Ÿæœ‰ä¸€å®šå‹åŠ›ã€‚ä¸ºæ­¤Nodeåœ¨å†…å­˜çš„ä½¿ç”¨ä¸Šåº”ç”¨çš„æ˜¯åœ¨C++å±‚é¢ç”³è¯·å†…å­˜ã€åœ¨JavaScriptä¸­åˆ†é…å†…å­˜çš„ç­–ç•¥ã€‚\nä¸ºäº†é«˜æ•ˆåœ°ä½¿ç”¨ç”³è¯·æ¥çš„å†…å­˜ï¼ŒNode é‡‡ç”¨äº† slab åˆ†é…æœºåˆ¶ã€‚\nç®€å•è€Œè¨€ï¼Œslabå°±æ˜¯ä¸€å—ç”³è¯·å¥½çš„å›ºå®šå¤§å°çš„å†…å­˜åŒºåŸŸã€‚slabå…·æœ‰å¦‚ä¸‹3ç§çŠ¶æ€ã€‚\nfullï¼šå®Œå…¨åˆ†é…çŠ¶æ€ã€‚\npartialï¼šéƒ¨åˆ†åˆ†é…çŠ¶æ€ã€‚\nemptyï¼šæ²¡æœ‰è¢«åˆ†é…çŠ¶æ€ã€‚\nå½“æˆ‘ä»¬éœ€è¦ä¸€ä¸ª Buffer å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ†é…æŒ‡å®šå¤§å°çš„ Buffer å¯¹è±¡ï¼š\nnew Buffer(size); Node ä»¥ 8 KB ä¸ºç•Œé™æ¥åŒºåˆ† Buffer æ˜¯å¤§å¯¹è±¡è¿˜æ˜¯å°å¯¹è±¡ï¼š\nBuffer.poolSize = 8 * 1024; è¿™ä¸ª8 KBçš„å€¼ä¹Ÿå°±æ˜¯æ¯ä¸ª slab çš„å¤§å°å€¼ï¼Œåœ¨ JavaScript å±‚é¢ï¼Œä»¥å®ƒä½œä¸ºå•ä½å•å…ƒè¿›è¡Œå†…å­˜çš„åˆ†é…ã€‚\nåˆ†é…å°Bufferå¯¹è±¡\nå¦‚æœæŒ‡å®š Buffer çš„å¤§å°å°‘äº 8 KB ï¼ŒNode ä¼šæŒ‰ç…§å°å¯¹è±¡çš„æ–¹å¼è¿›è¡Œåˆ†é…ã€‚Bufferçš„åˆ†é…è¿‡ç¨‹ä¸­ä¸»è¦ä½¿ç”¨ä¸€ä¸ªå±€éƒ¨å˜é‡ pool ä½œä¸ºä¸­é—´å¤„ç†å¯¹è±¡ï¼Œå¤„äºåˆ†é…çŠ¶æ€çš„slabå•å…ƒéƒ½æŒ‡å‘å®ƒã€‚ä»¥ä¸‹æ˜¯åˆ†é…ä¸€ä¸ªå…¨æ–°çš„slabå•å…ƒçš„æ“ä½œï¼Œå®ƒä¼šå°†æ–°ç”³è¯·çš„SlowBufferå¯¹è±¡æŒ‡å‘å®ƒï¼š\nvar pool; function allocPool() { pool = new SlowBuffer(Buffer.poolSize); pool.used = 0; } å›¾6-2ä¸ºä¸€ä¸ªæ–°æ„é€ çš„slabå•å…ƒç¤ºä¾‹ã€‚\nå›¾6-2ã€€æ–°æ„é€ çš„slabå•å…ƒç¤ºä¾‹\nåœ¨å›¾6-2ä¸­ï¼Œ slabå¤„äºemptyçŠ¶æ€ã€‚\næ„é€ å°Bufferå¯¹è±¡æ—¶çš„ä»£ç å¦‚ä¸‹ï¼š\nnew Buffer(1024); è¿™æ¬¡æ„é€ å°†ä¼šå»æ£€æŸ¥poolå¯¹è±¡ï¼Œå¦‚æœpoolæ²¡æœ‰è¢«åˆ›å»ºï¼Œå°†ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„slabå•å…ƒæŒ‡å‘å®ƒï¼š\nif (!pool || pool.length - pool.used \u0026lt; this.length) allocPool(); åŒæ—¶å½“å‰Bufferå¯¹è±¡çš„parentå±æ€§æŒ‡å‘è¯¥slabï¼Œå¹¶è®°å½•ä¸‹æ˜¯ä»è¿™ä¸ªslabçš„å“ªä¸ªä½ç½®ï¼ˆoffsetï¼‰å¼€å§‹ä½¿ç”¨çš„ï¼Œslabå¯¹è±¡è‡ªèº«ä¹Ÿè®°å½•è¢«ä½¿ç”¨äº†å¤šå°‘å­—èŠ‚ï¼Œä»£ç å¦‚ä¸‹ï¼š\nthis.parent = pool; this.offset = pool.used; pool.used += this.length; if (pool.used \u0026amp; 7) pool.used = (pool.used + 8) \u0026amp; ~7; å›¾6-3ä¸ºä»ä¸€ä¸ªæ–°çš„slabå•å…ƒä¸­åˆæ¬¡åˆ†é…ä¸€ä¸ªBufferå¯¹è±¡çš„ç¤ºæ„å›¾ã€‚\nå›¾6-3ã€€ä»ä¸€ä¸ªæ–°çš„slabå•å…ƒä¸­åˆæ¬¡åˆ†é…ä¸€ä¸ªBufferå¯¹è±¡\nè¿™æ—¶å€™çš„slabçŠ¶æ€ä¸ºpartialã€‚\nå½“å†æ¬¡åˆ›å»ºä¸€ä¸ªBufferå¯¹è±¡æ—¶ï¼Œæ„é€ è¿‡ç¨‹ä¸­å°†ä¼šåˆ¤æ–­è¿™ä¸ªslabçš„å‰©ä½™ç©ºé—´æ˜¯å¦è¶³å¤Ÿã€‚å¦‚æœè¶³å¤Ÿï¼Œä½¿ç”¨å‰©ä½™ç©ºé—´ï¼Œå¹¶æ›´æ–°slabçš„åˆ†é…çŠ¶æ€ã€‚ä¸‹é¢çš„ä»£ç åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„Bufferå¯¹è±¡ï¼Œå®ƒä¼šå¼•èµ·ä¸€æ¬¡slabåˆ†é…ï¼š\nnew Buffer(3000); å›¾6-4ä¸ºå†æ¬¡åˆ†é…çš„ç¤ºæ„å›¾ã€‚\nå›¾6-4ã€€ä»slabå•å…ƒä¸­å†æ¬¡åˆ†é…ä¸€ä¸ªBufferå¯¹è±¡\nå¦‚æœslabå‰©ä½™çš„ç©ºé—´ä¸å¤Ÿï¼Œå°†ä¼šæ„é€ æ–°çš„slabï¼ŒåŸslabä¸­å‰©ä½™çš„ç©ºé—´ä¼šé€ æˆæµªè´¹ã€‚ä¾‹å¦‚ï¼Œç¬¬ä¸€æ¬¡æ„é€ 1å­—èŠ‚çš„Bufferå¯¹è±¡ï¼Œç¬¬äºŒæ¬¡æ„é€ 8192å­—èŠ‚çš„Bufferå¯¹è±¡ï¼Œç”±äºç¬¬äºŒæ¬¡åˆ†é…æ—¶slabä¸­çš„ç©ºé—´ä¸å¤Ÿï¼Œæ‰€ä»¥åˆ›å»ºå¹¶ä½¿ç”¨æ–°çš„slabï¼Œç¬¬ä¸€ä¸ªslabçš„8 KBå°†ä¼šè¢«ç¬¬ä¸€ä¸ª1å­—èŠ‚çš„Bufferå¯¹è±¡ç‹¬å ã€‚ä¸‹é¢çš„ä»£ç ä¸€å…±ä½¿ç”¨äº†ä¸¤ä¸ªslabå•å…ƒï¼š\nnew Buffer(1); new Buffer(8192); è¿™é‡Œè¦æ³¨æ„çš„äº‹é¡¹æ˜¯ï¼Œç”±äºåŒä¸€ä¸ªslabå¯èƒ½åˆ†é…ç»™å¤šä¸ªBufferå¯¹è±¡ä½¿ç”¨ï¼Œåªæœ‰è¿™äº›å°Bufferå¯¹è±¡åœ¨ä½œç”¨åŸŸé‡Šæ”¾å¹¶éƒ½å¯ä»¥å›æ”¶æ—¶ï¼Œslabçš„8 KBç©ºé—´æ‰ä¼šè¢«å›æ”¶ã€‚å°½ç®¡åˆ›å»ºäº†1ä¸ªå­—èŠ‚çš„Bufferå¯¹è±¡ï¼Œä½†æ˜¯å¦‚æœä¸é‡Šæ”¾å®ƒï¼Œå®é™…å¯èƒ½æ˜¯8 KBçš„å†…å­˜æ²¡æœ‰é‡Šæ”¾ã€‚\nåˆ†é…å¤§Bufferå¯¹è±¡\nå¦‚æœéœ€è¦è¶…è¿‡8 KBçš„Bufferå¯¹è±¡ï¼Œå°†ä¼šç›´æ¥åˆ†é…ä¸€ä¸ªSlowBufferå¯¹è±¡ä½œä¸ºslabå•å…ƒï¼Œè¿™ä¸ªslabå•å…ƒå°†ä¼šè¢«è¿™ä¸ªå¤§Bufferå¯¹è±¡ç‹¬å ã€‚\n// Big buffer, just alloc one this.parent = new SlowBuffer(this.length); this.offset = 0; è¿™é‡Œçš„SlowBufferç±»æ˜¯åœ¨C++ä¸­å®šä¹‰çš„ï¼Œè™½ç„¶å¼•ç”¨bufferæ¨¡å—å¯ä»¥è®¿é—®åˆ°å®ƒï¼Œä½†æ˜¯ä¸æ¨èç›´æ¥æ“ä½œå®ƒï¼Œè€Œæ˜¯ç”¨Bufferæ›¿ä»£ã€‚\nä¸Šé¢æåˆ°çš„Bufferå¯¹è±¡éƒ½æ˜¯JavaScriptå±‚é¢çš„ï¼Œèƒ½å¤Ÿè¢«V8çš„åƒåœ¾å›æ”¶æ ‡è®°å›æ”¶ã€‚ä½†æ˜¯å…¶å†…éƒ¨çš„parentå±æ€§æŒ‡å‘çš„SlowBufferå¯¹è±¡å´æ¥è‡ªäºNodeè‡ªèº«C++ä¸­çš„å®šä¹‰ï¼Œæ˜¯C++å±‚é¢ä¸Šçš„Bufferå¯¹è±¡ï¼Œæ‰€ç”¨å†…å­˜ä¸åœ¨V8çš„å †ä¸­ã€‚\nå°ç»“\nç®€å•è€Œè¨€ï¼ŒçœŸæ­£çš„å†…å­˜æ˜¯åœ¨Nodeçš„C++å±‚é¢æä¾›çš„ï¼ŒJavaScriptå±‚é¢åªæ˜¯ä½¿ç”¨å®ƒã€‚å½“è¿›è¡Œå°è€Œé¢‘ç¹çš„Bufferæ“ä½œæ—¶ï¼Œé‡‡ç”¨slabçš„æœºåˆ¶è¿›è¡Œé¢„å…ˆç”³è¯·å’Œäº‹ååˆ†é…ï¼Œä½¿å¾—JavaScriptåˆ°æ“ä½œç³»ç»Ÿä¹‹é—´ä¸å¿…æœ‰è¿‡å¤šçš„å†…å­˜ç”³è¯·æ–¹é¢çš„ç³»ç»Ÿè°ƒç”¨ã€‚å¯¹äºå¤§å—çš„Bufferè€Œè¨€ï¼Œåˆ™ç›´æ¥ä½¿ç”¨C++å±‚é¢æä¾›çš„å†…å­˜ï¼Œè€Œæ— éœ€ç»†è…»çš„åˆ†é…æ“ä½œã€‚\n","date":"2023-03-20","section":"techs","summary":"Node Node.js ç”±å¤©æ‰ç¨‹åºå‘˜ Ryan Dahl åˆ›å»ºï¼Œå‰”é™¤äº†æµè§ˆå™¨ä¸­çš„ WebKit å¸ƒå±€å¼•æ“å’Œ WebAPI ï¼Œæ‰“ç ´äº†è¿‡å» JavaScript åªèƒ½åœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„å±€é¢ï¼Œå…·æœ‰ äº‹ä»¶é©±åŠ¨event driven å’Œ éé˜»å¡*^non-blocking^* I/O çš„ç‰¹ç‚¹ï¼Œæ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript åç«¯è¿è¡Œç¯å¢ƒã€‚Node ä»…ä»…æä¾›äº†åŸºç¡€çš„åŠŸèƒ½å’Œ API ï¼Œæ— æ³•è°ƒç”¨ DOM å’Œ BOM ç­‰æµè§ˆå™¨å†…ç½® API ï¼Œä½†å¯ä»¥é€šè¿‡ NPM åŒ…ç®¡ç†å™¨è¿›è¡Œæ‹“å±•ã€‚\n:link: Href å®˜ç½‘åœ°å€ï¼šnodejs.org\nç‰¹ç‚¹*^Characteristic^* ä¸åŒçš„æµè§ˆå™¨ä½¿ç”¨ä¸åŒçš„ JavaScript è§£æå¼•æ“ï¼š\nGoogle âŸ¹ V8 FireFox âŸ¹ SpiderMonkey Safari âŸ¹ JavaScriptCore Internet Explorer âŸ¹ Chakra è¿è¡Œç¯å¢ƒæ˜¯æŒ‡ä»£ç æ­£å¸¸è¿è¡Œæ‰€éœ€çš„å¿…è¦ç¯å¢ƒï¼Œä»¥ä¸‹ä¸º Chrome æµè§ˆå™¨çš„è¿è¡Œç¯å¢ƒï¼š\nV8 å¼•æ“è´Ÿè´£è§£æå’Œæ‰§è¡Œ JavaScript ä»£ç  å†…ç½® API æ˜¯ç”±è¿è¡Œç¯å¢ƒæä¾›çš„ç‰¹æ®Šæ¥å£ï¼Œåªèƒ½åœ¨æ‰€å±çš„è¿è¡Œç¯å¢ƒä¸­è¢«è°ƒç”¨ å¼‚æ­¥ ç†Ÿæ‚‰å¼‚æ­¥çš„ç”¨æˆ·å¿…ç„¶çŸ¥é“ï¼Œæˆ‘ä»¬åªçŸ¥é“å›è°ƒå‡½æ•°å°†åœ¨è¿™ä¸ªå¼‚æ­¥è¯·æ±‚ç»“æŸåæ‰§è¡Œï¼Œä½†å¹¶ä¸çŸ¥é“å…·ä½“çš„æ—¶é—´ç‚¹ã€‚å¼‚æ­¥è°ƒç”¨ä¸­å¯¹äºç»“æœå€¼çš„æ•è·æ˜¯ç¬¦åˆ \u0026ldquo;Don\u0026rsquo;t call me, I will call you\u0026rdquo; çš„åŸåˆ™çš„ï¼Œè¿™ä¹Ÿæ˜¯æ³¨é‡ç»“æœï¼Œä¸å…³å¿ƒè¿‡ç¨‹çš„ä¸€ç§è¡¨ç°ã€‚\n","title":"10 Node","url":"/techs/10-node/"},{"content":"Express Express æ˜¯åŸºäºNode.js å¹³å°çš„ä¸€ä¸ªå¿«é€Ÿã€å¼€æ”¾ã€æç®€çš„ Web å¼€å‘æ¡†æ¶ï¼ŒåŸºäºå†…ç½®çš„ http æ¨¡å—è¿›ä¸€æ­¥å°è£…å‡ºæ¥ï¼Œèƒ½å¤Ÿæå¤§åœ°æé«˜å¼€å‘æ•ˆç‡ã€‚å…¶æœ¬è´¨å°±æ˜¯ä¸€ä¸ª npm ä¸Šçš„ç¬¬ä¸‰æ–¹åŒ…ï¼Œæä¾›äº†å¿«é€Ÿåˆ›å»º Web æœåŠ¡å™¨çš„ä¾¿æ·æ–¹æ³•ã€‚\nå¯¹äºå‰ç«¯ç¨‹åºå‘˜æ¥è¯´ï¼Œæœ€å¸¸è§çš„ä¸¤ç§æœåŠ¡å™¨ï¼Œåˆ†åˆ«æ˜¯\nWeb ç½‘ç«™ æœåŠ¡å™¨ï¼šä¸“é—¨å¯¹å¤–æä¾› Web ç½‘é¡µèµ„æºçš„æœåŠ¡å™¨ API æ¥å£ æœåŠ¡å™¨ï¼šä¸“é—¨å¯¹å¤–æä¾› API æ¥å£çš„æœåŠ¡å™¨ ä½¿ç”¨ Express ï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿ã€å¿«é€Ÿçš„åˆ›å»º Web ç½‘ç«™çš„æœåŠ¡å™¨æˆ– API æ¥å£çš„æœåŠ¡å™¨ã€‚\nä½¿ç”¨ å®‰è£… å®‰è£… Express å¹¶å°†å…¶ä¿å­˜åˆ°ä¾èµ–åˆ—è¡¨ä¸­ã€‚å¦‚ä¸‹ï¼š\n$ npm install express åˆ›å»º const express = require(\u0026#39;express\u0026#39;); // å¯¼å…¥express const app = express(); // åˆ›å»ºwebæœåŠ¡å™¨ app.listen(80, () =\u0026gt; { // è°ƒç”¨listen() å¯åŠ¨æœåŠ¡å™¨ console.log(\u0026#39;express server running at http://127.0.0.1\u0026#39;) ); å¤„ç† /** * å‚æ•°1: å®¢æˆ·è¯·æ±‚çš„urlåœ°å€ * å‚æ•°2: è¯·æ±‚å¯¹åº”çš„å¤„ç†å™¨ * req: è¯·æ±‚å¯¹è±¡ * res: å“åº”å¯¹è±¡ ä¸¤è€…åŒ…å«äº†ä¸å“åº”ç›¸å…³çš„å±æ€§ä¸æ–¹æ³• */ app.get(\u0026#39;url\u0026#39;, function(req, res) { /*å¤„ç†å‡½æ•°*/ }) // ç›‘å¬ GET è¯·æ±‚ app.post(\u0026#39;url\u0026#39;, function(req, res) { /*å¤„ç†å‡½æ•°*/ }) // ç›‘å¬ POST è¯·æ±‚ app.post(\u0026#39;url\u0026#39;, function(req, res) { // é€šè¿‡ req.query å¯¹è±¡ï¼Œå¯ä»¥è®¿é—®åˆ°å®¢æˆ·ç«¯é€šè¿‡æŸ¥è¯¢å­—ç¬¦ä¸²çš„å½¢å¼ï¼Œå‘é€åˆ°æœåŠ¡å™¨çš„å‚æ•° console.log(req.query); // é€šè¿‡ req.params å¯¹è±¡ï¼Œå¯ä»¥è®¿é—®åˆ° URL ä¸­ï¼Œé€šè¿‡ : åŒ¹é…åˆ°çš„åŠ¨æ€å‚æ•° console.log(req.params); // å“åº”å®¢æˆ·ç«¯ // é€šè¿‡ res.send()æ–¹æ³•ï¼ŒæŠŠå¤„ç†å¥½çš„å†…å®¹å‘é€ç»™å®¢æˆ·ç«¯ res.send(data); }) const express = require(\u0026#39;express\u0026#39;) // 1. å¯¼å…¥ express const app = express() // 2. åˆ›å»º web æœåŠ¡å™¨ // 4. ç›‘å¬å®¢æˆ·ç«¯çš„ GET å’Œ POST è¯·æ±‚ï¼Œå¹¶å‘å®¢æˆ·ç«¯å“åº”å…·ä½“çš„å†…å®¹ app.get(\u0026#39;/user\u0026#39;, (req, res) =\u0026gt; { // è°ƒç”¨ express æä¾›çš„ res.send() æ–¹æ³•ï¼Œå‘å®¢æˆ·ç«¯å“åº”ä¸€ä¸ª JSON å¯¹è±¡ res.send({ name: \u0026#39;zs\u0026#39;, age: 20, gender: \u0026#39;ç”·\u0026#39; }) }) app.post(\u0026#39;/user\u0026#39;, (req, res) =\u0026gt; { // è°ƒç”¨ express æä¾›çš„ res.send() æ–¹æ³•ï¼Œå‘å®¢æˆ·ç«¯å“åº”ä¸€ä¸ª æ–‡æœ¬å­—ç¬¦ä¸² res.send(\u0026#39;è¯·æ±‚æˆåŠŸ\u0026#39;) }) app.get(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; { // é€šè¿‡ req.query å¯ä»¥è·å–åˆ°å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„ æŸ¥è¯¢å‚æ•° // æ³¨æ„ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œreq.query æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ console.log(req.query) res.send(req.query) }) // æ³¨æ„ï¼šè¿™é‡Œçš„ :id æ˜¯ä¸€ä¸ªåŠ¨æ€çš„å‚æ•° app.get(\u0026#39;/user/:ids/:username\u0026#39;, (req, res) =\u0026gt; { // req.params æ˜¯åŠ¨æ€åŒ¹é…åˆ°çš„ URL å‚æ•°ï¼Œé»˜è®¤ä¹Ÿæ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ console.log(req.params) res.send(req.params) }) // 3. å¯åŠ¨ web æœåŠ¡å™¨ app.listen(80, () =\u0026gt; { console.log(\u0026#39;express server running at http://127.0.0.1\u0026#39;) }) nodemon åœ¨ç¼–å†™è°ƒè¯• Node.js é¡¹ç›®çš„æ—¶å€™ï¼Œå¦‚æœä¿®æ”¹äº†é¡¹ç›®çš„ä»£ç ï¼Œéœ€è¦é¢‘ç¹çš„æ‰‹åŠ¨é‡æ–°å¯åŠ¨æœåŠ¡ï¼Œä½¿ç”¨ nodemon https://www.npmjs.com/package/nodemon å·¥å…·ï¼Œå®ƒèƒ½å¤Ÿç›‘å¬é¡¹ç›®æ–‡ä»¶çš„å˜åŠ¨ï¼Œå½“ä»£ç è¢«ä¿®æ”¹åï¼Œnodemon ä¼šè‡ªåŠ¨é‡å¯é¡¹ç›®ï¼Œæå¤§æ–¹ä¾¿äº†å¼€å‘å’Œè°ƒè¯•ã€‚\nnpm i -g nodemon ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°† node å‘½ä»¤æ›¿æ¢ä¸º nodemon å‘½ä»¤ï¼Œä½¿ç”¨ nodemon app.js æ¥å¯åŠ¨é¡¹ç›®ã€‚\nnodemon app.js æ–¹æ³• req query é€šè¿‡ req.query å¯¹è±¡ï¼Œå¯ä»¥è®¿é—®åˆ°å®¢æˆ·ç«¯é€šè¿‡ æŸ¥è¯¢å­—ç¬¦ä¸²*^get^* çš„å½¢å¼ï¼Œå‘é€åˆ°æœåŠ¡å™¨çš„å‚æ•°ã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼Œreq.query æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ã€‚\napp.get(\u0026#39;/search\u0026#39;, (req, res) =\u0026gt; { // req.query é»˜è®¤æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ // å®¢æˆ·ç«¯ä½¿ç”¨ ?word=abc\u0026amp;pages=20 å‘é€getè¯·æ±‚ // å¯ä»¥é€šè¿‡ req.query å¯¹è±¡è®¿é—®åˆ° // e.g. req.query.name res.send({ name: req.query.name, query: req.query, test: undefined // ä¼¼ä¹å¹¶ä¸ä¼šè¿”å›ç©ºçš„é”®å€¼ }) // http://127.0.0.1/search?word=abc\u0026amp;pages=20 // {\u0026#34;query\u0026#34;:{\u0026#34;word\u0026#34;:\u0026#34;abc\u0026#34;,\u0026#34;pages\u0026#34;:\u0026#34;20\u0026#34;}} }) param ä½¿ç”¨ : æ”¯æŒåŠ¨æ€å‚æ•°ï¼Œé€šè¿‡ req.param è®¿é—®ã€‚å¦‚ /user/:id åŒ¹é… /user/3 ã€/user/:ids/:name åŒ¹é… /user/3/jack â‡’ {ids:'3', name:jack} ã€‚\n// æ³¨æ„ï¼šè¿™é‡Œçš„ :id æ˜¯ä¸€ä¸ªåŠ¨æ€çš„å‚æ•° app.get(\u0026#39;/user/:ids/:username\u0026#39;, (req, res) =\u0026gt; { // req.params æ˜¯åŠ¨æ€åŒ¹é…åˆ°çš„ URL å‚æ•°ï¼Œé»˜è®¤æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ console.log(req.params) res.send(req.params) }) express static æ‰˜ç®¡é™æ€èµ„æº\nExpress æä¾›äº†ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å‡½æ•°ï¼Œå«åš express.static() ï¼Œé€šè¿‡å®ƒï¼Œæˆ‘ä»¬å¯ä»¥éå¸¸æ–¹ä¾¿åœ°åˆ›å»ºä¸€ä¸ªé™æ€èµ„æºæœåŠ¡å™¨ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡å¦‚ä¸‹ä»£ç å°±å¯ä»¥å°† public ç›®å½•ä¸‹çš„å›¾ç‰‡ã€CSS æ–‡ä»¶ã€JavaScript æ–‡ä»¶å¯¹å¤–å¼€æ”¾è®¿é—®äº†ã€‚\napp.use(express.statis(\u0026#39;public\u0026#39;)) ç°åœ¨ï¼Œä½ å°±å¯ä»¥è®¿é—® public ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶äº†ã€‚\nhttp://localhost/images/bg.jpg http://localhost/css/style.css http://localhost/js/login.js :memo: Note Express åœ¨æŒ‡å®šçš„é™æ€ç›®å½•ä¸­æŸ¥æ‰¾æ–‡ä»¶ï¼Œå¯¹å¤–æä¾›èµ„æºè®¿é—®è·¯å¾„ï¼Œç›®å½•å ä¸ä¼š å‡ºç°åœ¨ URL ä¸­\næ‰˜ç®¡å¤šä¸ªé™æ€èµ„æºç›®å½•\nè®¿é—®é™æ€èµ„æºæ–‡ä»¶æ—¶ï¼Œexpress.static() å‡½æ•°ä¼šæ ¹æ®ç›®å½•çš„æ·»åŠ é¡ºåºæŸ¥æ‰¾æ‰€éœ€çš„æ–‡ä»¶ï¼Œå¦‚ä¸‹åŒååˆ™å…ˆè®¿é—® public æ–‡ä»¶å¤¹ã€‚\napp.use(express.statis(\u0026#39;public\u0026#39;)); app.use(express.statis(\u0026#39;files\u0026#39;)); æŒ‚è½½è·¯å¾„å‰ç¼€\nå¦‚æœå¸Œæœ›åœ¨æ‰˜ç®¡çš„é™æ€èµ„æºè®¿é—®è·¯å¾„ä¹‹å‰ï¼ŒæŒ‚è½½è·¯å¾„å‰ç¼€ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹å¼ã€‚\napp.use(\u0026#39;/public\u0026#39;, express.statis(\u0026#39;public\u0026#39;)) // ?å¯ä»¥ç†è§£ä¸º app.method(path, handler()) // æ­¤æ—¶ express.statis åªå¯¹æŒ‡å®šçš„ path ç”Ÿæ•ˆ ç°åœ¨ï¼Œä½ å°±å¯ä»¥é€šè¿‡å¸¦æœ‰ /public å‰ç¼€åœ°å€æ¥è®¿é—® public ç›®å½•ä¸­çš„æ–‡ä»¶äº†\nhttp://localhost:3000/public/images/kitten.jpg http://localhost:3000/public/css/style.css http://localhost:3000/public/js/app.js const express = require(\u0026#39;express\u0026#39;) const app = express() // åœ¨è¿™é‡Œï¼Œè°ƒç”¨ express.static() æ–¹æ³•ï¼Œå¿«é€Ÿçš„å¯¹å¤–æä¾›é™æ€èµ„æº app.use(\u0026#39;/files\u0026#39;, express.static(\u0026#39;./files\u0026#39;)) app.use(express.static(\u0026#39;./clock\u0026#39;)) app.listen(80, () =\u0026gt; { console.log(\u0026#39;express server running at http://127.0.0.1\u0026#39;) }) è·¯ç”± å¹¿ä¹‰ä¸Šæ¥è®²ï¼Œè·¯ç”±å°±æ˜¯ æ˜ å°„å…³ç³»*^Mapping^* ã€‚åœ¨ Express ä¸­ï¼Œè·¯ç”±æŒ‡çš„æ˜¯ å®¢æˆ·ç«¯*^client^* çš„è¯·æ±‚ä¸ æœåŠ¡å™¨*^server^* å¤„ç†å‡½æ•°ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚\nExpress ä¸­çš„è·¯ç”±åˆ† 3 éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ è¯·æ±‚çš„ç±»å‹*^Method^* ã€è¯·æ±‚çš„ URL åœ°å€*^Path^ã€å¤„ç†å‡½æ•°^Handle^* ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š\napp.method(path, handler()) // method å…·ä½“ä¸º get post ç­‰ åŒ¹é… æ¯å½“ä¸€ä¸ªè¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ä¹‹åï¼Œéœ€è¦å…ˆç»è¿‡è·¯ç”±çš„åŒ¹é…ï¼Œåªæœ‰åŒ¹é…æˆåŠŸä¹‹åï¼Œæ‰ä¼šè°ƒç”¨å¯¹åº”çš„å¤„ç†å‡½æ•°ã€‚\nåœ¨åŒ¹é…æ—¶ï¼Œä¼šæŒ‰ç…§è·¯ç”±çš„é¡ºåºè¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœè¯·æ±‚ç±»å‹å’Œè¯·æ±‚çš„ URL åŒæ—¶åŒ¹é…æˆåŠŸï¼Œåˆ™ Express ä¼šå°†è¿™æ¬¡è¯·æ±‚ï¼Œè½¬äº¤ç»™å¯¹åº”çš„ function å‡½æ•°è¿›è¡Œå¤„ç†ã€‚\n:memo: Note åŒ¹é…è§„åˆ™\næŒ‰ç…§å®šä¹‰çš„å…ˆåé¡ºåºè¿›è¡ŒåŒ¹é… è¯·æ±‚ç±»å‹å’Œè¯·æ±‚çš„ URL åŒæ—¶åŒ¹é…æˆåŠŸï¼Œæ‰ä¼šè°ƒç”¨å¯¹åº”çš„å¤„ç†å‡½æ•° ä½¿ç”¨ åœ¨ Express ä¸­ä½¿ç”¨è·¯ç”±æœ€ç®€å•çš„æ–¹å¼ï¼Œå°±æ˜¯æŠŠè·¯ç”±æŒ‚è½½åˆ° app ä¸Šï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\nconst express = require(\u0026#39;express\u0026#39;); const app = express(); // æŒ‚è½½è·¯ç”± app.get(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; {res.send(\u0026#39;hello world.\u0026#39;)}); app.post(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; {res.send(\u0026#39;Post Request.\u0026#39;)}); app.listen(80, () =\u0026gt; {console.log(\u0026#39;express server running at http://127.0.0.1\u0026#39;)}); æ¨¡å—åŒ– ä¸ºäº†æ–¹ä¾¿å¯¹è·¯ç”±è¿›è¡Œæ¨¡å—åŒ–çš„ç®¡ç†ï¼ŒExpress ä¸å»ºè®®å°†è·¯ç”±ç›´æ¥æŒ‚è½½åˆ° app ä¸Šï¼Œè€Œæ˜¯æ¨èå°†è·¯ç”±æŠ½ç¦»ä¸ºå•ç‹¬çš„æ¨¡å—ã€‚å°†è·¯ç”±æŠ½ç¦»ä¸ºå•ç‹¬æ¨¡å—çš„æ­¥éª¤å¦‚ä¸‹ï¼š\nåˆ›å»ºè·¯ç”±æ¨¡å—å¯¹åº”çš„ .js æ–‡ä»¶ è°ƒç”¨ express.Router() å‡½æ•°åˆ›å»ºè·¯ç”±å¯¹è±¡ å‘è·¯ç”±å¯¹è±¡ä¸ŠæŒ‚è½½å…·ä½“çš„è·¯ç”± ä½¿ç”¨ module.exports å‘å¤–å…±äº«è·¯ç”±å¯¹è±¡ ä½¿ç”¨ app.use() å‡½æ•°æ³¨å†Œè·¯ç”±æ¨¡å— // è·¯ç”±æ¨¡å— router.js const express = require(\u0026#39;express\u0026#39;) // 1. å¯¼å…¥ express const router = express.Router() // 2. åˆ›å»ºè·¯ç”±å¯¹è±¡ // 3. æŒ‚è½½å…·ä½“çš„è·¯ç”± router.get(\u0026#39;/user/list\u0026#39;, (req, res) =\u0026gt; {res.send(\u0026#39;Get user list.\u0026#39;)}) router.post(\u0026#39;/user/add\u0026#39;, (req, res) =\u0026gt; {res.send(\u0026#39;Add new user.\u0026#39;)}) // 4. å‘å¤–å¯¼å‡ºè·¯ç”±å¯¹è±¡ module.exports = router const express = require(\u0026#39;express\u0026#39;) const router = require(\u0026#39;./router\u0026#39;) // 1. å¯¼å…¥è·¯ç”±æ¨¡å— const app = express() // æ³¨æ„ï¼š app.use() å‡½æ•°çš„ä½œç”¨ï¼Œå°±æ˜¯æ¥æ³¨å†Œå…¨å±€ä¸­é—´ä»¶ // app.use(\u0026#39;/files\u0026#39;, express.static(\u0026#39;./files\u0026#39;)) app.use(\u0026#39;/api\u0026#39;, router) // è®¿é—®ï¼š/api/user/list // 2. æ³¨å†Œè·¯ç”±æ¨¡å—ï¼Œè·Ÿä½¿ç”¨é™æ€èµ„æºä¸€æ ·å¯ä»¥åŠ ç»Ÿä¸€çš„è®¿é—®å‰ç¼€ app.listen(80, () =\u0026gt; {console.log(\u0026#39;http://127.0.0.1\u0026#39;)}) ä¸­é—´ä»¶ ä¸­é—´ä»¶*^Middleware^* ï¼Œç‰¹æŒ‡ä¸šåŠ¡æµç¨‹çš„ä¸­é—´å¤„ç†ç¯èŠ‚ã€‚\næµç¨‹ å½“ä¸€ä¸ªè¯·æ±‚åˆ°è¾¾ Express çš„æœåŠ¡å™¨ä¹‹åï¼Œå¯ä»¥è¿ç»­è°ƒç”¨å¤šä¸ªä¸­é—´ä»¶ï¼Œä»è€Œå¯¹è¿™æ¬¡è¯·æ±‚è¿›è¡Œ é¢„å¤„ç† ^preprocessing^ ã€‚\næ ¼å¼ Express çš„ä¸­é—´ä»¶ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª function å¤„ç†å‡½æ•°ï¼ŒExpress ä¸­é—´ä»¶çš„æ ¼å¼å¦‚ä¸‹ï¼š\napp.get(\u0026#39;/\u0026#39;, function(req, res, next){ next(); }); get - ä¸­é—´ä»¶åº”ç”¨çš„æ–¹æ³• \u0026rsquo;/\u0026rsquo; - åº”ç”¨çš„åœ°å€ï¼Œä½¿ç”¨é€šé…ç¬¦ handler - å¤„ç†å‡½æ•° req - è¯·æ±‚å‚æ•°*^request^* res - å“åº”å‚æ•°*^response^* next - å›è°ƒå‡½æ•°ï¼Œç”¨äºå°†æµè½¬å…³ç³»è½¬äº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶æˆ–è·¯ç”±ï¼Œå¿…é¡» :memo: Note ä¸­é—´ä»¶å‡½æ•°çš„å½¢å‚åˆ—è¡¨ä¸­ï¼Œå¿…é¡» åŒ…å« next å‚æ•°ï¼Œè€Œè·¯ç”±å¤„ç†å‡½æ•°ä¸­åªåŒ…å« req å’Œ res ã€‚ä½¿ç”¨ next() å°†æ§åˆ¶æƒäº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ã€‚\nâ“ Question ç›´æ¥ä½¿ç”¨ app.use() æ—¶å¹¶æ²¡æœ‰è°ƒç”¨ next() å‡½æ•°ï¼Œæ˜¯ res.send() æ–¹æ³•è‡ªåŠ¨ç»ˆæ­¢è¿›ç¨‹äº†å—ï¼Ÿ\nå…¨å±€ç”Ÿæ•ˆçš„ä¸­é—´ä»¶ï¼šæ˜¯æŒ‡å®¢æˆ·ç«¯å‘èµ·çš„ä»»ä½•è¯·æ±‚ï¼Œè¾¾åˆ°æœåŠ¡å™¨ä¹‹åï¼Œéƒ½ä¼šè§¦å‘çš„ä¸­é—´ä»¶ï¼›é€šè¿‡ app.use^ä¸­é—´ä»¶å‡½æ•°^ ï¼Œå³å¯å®šä¹‰ä¸€ä¸ªå…¨å±€ç”Ÿæ•ˆçš„ä¸­é—´ä»¶ï¼Œå…¼å®¹ get ä¸ post æ–¹æ³•ã€‚\nconst express = require(\u0026#39;express\u0026#39;); const app = express(); // å®šä¹‰ä¸€ä¸ªæœ€ç®€å•çš„ä¸­é—´ä»¶å‡½æ•° const mw = function (req, res, next) { console.log(\u0026#39;è¿™æ˜¯æœ€ç®€å•çš„ä¸­é—´ä»¶å‡½æ•°\u0026#39;); // æŠŠæµè½¬å…³ç³»ï¼Œè½¬äº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶æˆ–è·¯ç”± next() } // å°† mw æ³¨å†Œä¸ºå…¨å±€ç”Ÿæ•ˆçš„ä¸­é—´ä»¶ app.use(mw); // è¿™æ˜¯å®šä¹‰å…¨å±€ä¸­é—´ä»¶çš„ç®€åŒ–å½¢å¼ // app.use((req, res, next) =\u0026gt; { // console.log(\u0026#39;è¿™æ˜¯æœ€ç®€å•çš„ä¸­é—´ä»¶å‡½æ•°\u0026#39;) // next() // }) app.get(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; { console.log(\u0026#39;è°ƒç”¨äº† / è¿™ä¸ªè·¯ç”±\u0026#39;); res.send(\u0026#39;Home page.\u0026#39;); // ç¬¬ä¸€æ¬¡å‘é€å“åº”æ—¶æµç¨‹å³ç»“æŸ }) app.get(\u0026#39;/user\u0026#39;, (req, res) =\u0026gt; { console.log(\u0026#39;è°ƒç”¨äº† /user è¿™ä¸ªè·¯ç”±\u0026#39;); res.send(\u0026#39;User page.\u0026#39;); }) app.listen(80, () =\u0026gt; { console.log(\u0026#39;http://127.0.0.1\u0026#39;); }) å…±ç”¨ å¤šä¸ªä¸­é—´ä»¶ä¹‹é—´ï¼Œå…±äº«åŒä¸€ä»½ req å’Œ res ã€‚åŸºäºè¿™æ ·çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸Šæ¸¸çš„ä¸­é—´ä»¶ä¸­ï¼Œç»Ÿä¸€ä¸º req æˆ– res å¯¹è±¡æ·»åŠ è‡ªå®šä¹‰çš„å±æ€§æˆ–æ–¹æ³•ï¼Œä¾›ä¸‹æ¸¸çš„ä¸­é—´ä»¶æˆ–è·¯ç”±è¿›è¡Œä½¿ç”¨ã€‚\napp.use((req, res, next) =\u0026gt; { // ä¸Šæ¸¸ä¸­é—´ä»¶ const time = Date.now(); // è·å–åˆ°è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨çš„æ—¶é—´ req.startTime = time; // ä¸º req å¯¹è±¡ï¼ŒæŒ‚è½½è‡ªå®šä¹‰å±æ€§ï¼Œä»è€ŒæŠŠæ—¶é—´å…±äº«ç»™åé¢çš„æ‰€æœ‰è·¯ç”± next() }) app.get(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; {res.send(\u0026#39;Home page.\u0026#39; + req.startTime)}); app.get(\u0026#39;/user\u0026#39;, (req, res) =\u0026gt; {res.send(\u0026#39;User page.\u0026#39; + req.startTime)}); app.listen(80, () =\u0026gt; {console.log(\u0026#39;http://127.0.0.1\u0026#39;)}); å®šä¹‰å¤šä¸ªå…¨å±€ä¸­é—´ä»¶ï»¿\napp.use((req, res, next) =\u0026gt; { // å®šä¹‰ç¬¬ä¸€ä¸ªå…¨å±€ä¸­é—´ä»¶ console.log(\u0026#39;è°ƒç”¨äº†ç¬¬1ä¸ªå…¨å±€ä¸­é—´ä»¶\u0026#39;); next(); }) app.use((req, res, next) =\u0026gt; { // å®šä¹‰ç¬¬äºŒä¸ªå…¨å±€ä¸­é—´ä»¶ console.log(\u0026#39;è°ƒç”¨äº†ç¬¬2ä¸ªå…¨å±€ä¸­é—´ä»¶\u0026#39;); next(); }) app.get(\u0026#39;/user\u0026#39;, (req, res) =\u0026gt; {res.send(\u0026#39;User page.\u0026#39;)}); app.listen(80, () =\u0026gt; {console.log(\u0026#39;http://127.0.0.1\u0026#39;)}); æ¥æ”¶åˆ°è®¿é—®è¯·æ±‚æ—¶ï¼Œä¸­é—´ä»¶æŒ‰æŒ‚è½½é¡ºåºæ‰§è¡Œï¼Œå…ˆæ‰“å°ç¬¬ä¸€å¥è¯ï¼Œå†æ‰“å°ç¬¬äºŒå¥è¯ã€‚\nå±€éƒ¨ ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥ä¼ å…¥è·¯å¾„ï¼Œæ­¤æ—¶ä¸­é—´ä»¶å±€åœ¨éƒ¨ç”Ÿæ•ˆã€‚å®šä¹‰å¤šä¸ªå±€éƒ¨ä¸­é—´ä»¶ï¼š\n// 1. å®šä¹‰ä¸­é—´ä»¶å‡½æ•° const mw1 = (req, res, next) =\u0026gt; { console.log(\u0026#39;è°ƒç”¨äº†å±€éƒ¨ç”Ÿæ•ˆçš„ä¸­é—´ä»¶\u0026#39;); next(); } const mw2 = (req, res, next) =\u0026gt; { console.log(\u0026#39;è°ƒç”¨äº†ç¬¬äºŒä¸ªå±€éƒ¨ç”Ÿæ•ˆçš„ä¸­é—´ä»¶\u0026#39;); next(); } // 2. åˆ›å»ºè·¯ç”± app.get(\u0026#39;/\u0026#39;, mw1, nw2, (req, res) =\u0026gt; {res.send(\u0026#39;Home page.\u0026#39;)}); app.get(\u0026#39;/user\u0026#39;, [mw1, mw2],(req, res) =\u0026gt; {res.send(\u0026#39;User page.\u0026#39;)}); app.listen(80, function () {console.log(\u0026#39;Express server running at http://127.0.0.1\u0026#39;)}); ğŸ“ Note æ³¨æ„äº‹é¡¹\nä¸€å®šè¦åœ¨è·¯ç”±ä¹‹å‰æ³¨å†Œä¸­é—´ä»¶ å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚ï¼Œå¯ä»¥è¿ç»­è°ƒç”¨å¤šä¸ªä¸­é—´ä»¶è¿›è¡Œå¤„ç† æ‰§è¡Œå®Œä¸­é—´ä»¶çš„ä¸šåŠ¡ä»£ç ä¹‹åï¼Œä¸è¦å¿˜è®°è°ƒç”¨ next() å‡½æ•° ä¸ºäº†é˜²æ­¢ä»£ç é€»è¾‘æ··ä¹±ï¼Œè°ƒç”¨ next() å‡½æ•°åä¸è¦å†å†™é¢å¤–çš„ä»£ç  è¿ç»­è°ƒç”¨å¤šä¸ªä¸­é—´ä»¶æ—¶ï¼Œå¤šä¸ªä¸­é—´ä»¶ä¹‹é—´ï¼Œå…±äº« req å’Œ res å¯¹è±¡ åˆ†ç±» ä¸ºäº†æ–¹ä¾¿å¤§å®¶ç†è§£å’Œè®°å¿†ä¸­é—´ä»¶çš„ä½¿ç”¨ï¼ŒExpress å®˜æ–¹æŠŠå¸¸è§çš„ä¸­é—´ä»¶ç”¨æ³•ï¼Œåˆ†æˆäº† 5 å¤§ç±»ï¼š\nåº”ç”¨çº§åˆ«çš„ä¸­é—´ä»¶ è·¯ç”±çº§åˆ«çš„ä¸­é—´ä»¶ é”™è¯¯çº§åˆ«çš„ä¸­é—´ä»¶ Express å†…ç½®çš„ä¸­é—´ä»¶ ç¬¬ä¸‰æ–¹çš„ä¸­é—´ä»¶ åº”ç”¨\né€šè¿‡ app.method()^use/get/post^ ï¼Œç»‘å®šåˆ° app å®ä¾‹ä¸Šçš„ä¸­é—´ä»¶ï¼Œå«åšåº”ç”¨çº§åˆ«çš„ä¸­é—´ä»¶ã€‚\nè·¯ç”±\nç»‘å®šåˆ° express.Router() å®ä¾‹ä¸Šçš„ä¸­é—´ä»¶ï¼Œå«åšè·¯ç”±çº§åˆ«çš„ä¸­é—´ä»¶ã€‚\nå®ƒçš„ç”¨æ³•å’Œåº”ç”¨çº§åˆ«ä¸­é—´ä»¶æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚åªä¸è¿‡ï¼Œåº”ç”¨çº§åˆ«ä¸­é—´ä»¶æ˜¯ç»‘å®šåˆ° app å®ä¾‹ä¸Šï¼Œè·¯ç”±çº§åˆ«ä¸­é—´ä»¶å…ˆæ˜¯ç»‘å®šåˆ° app.Router() åˆ›å»ºçš„ router å®ä¾‹ä¸Šï¼Œå†é€šè¿‡ app.use ç»‘å®šåˆ°ä¸»æµç¨‹ä¸Šã€‚\nconst express = require(\u0026#39;express\u0026#39;) const router = express.Router() // è·¯ç”±çº§åˆ«çš„ä¸­é—´ä»¶ router.use((req, res, next)=\u0026gt;{ console.log(\u0026#39;Time:\u0026#39; + Date.now()) next() }) module.experts = router é”™è¯¯æ•è·\né”™è¯¯çº§åˆ«ä¸­é—´ä»¶çš„ä½œç”¨ï¼šä¸“é—¨ç”¨æ¥æ•è·æ•´ä¸ªé¡¹ç›®ä¸­å‘ç”Ÿçš„å¼‚å¸¸é”™è¯¯ï¼Œä»è€Œé˜²æ­¢é¡¹ç›®å¼‚å¸¸å´©æºƒçš„é—®é¢˜ã€‚æ ¼å¼ï¼šé”™è¯¯çº§åˆ«ä¸­é—´ä»¶çš„ function å¤„ç†å‡½æ•°ä¸­ï¼Œå¿…é¡»æœ‰ 4 ä¸ªå½¢å‚ï¼Œå½¢å‚é¡ºåºä»å‰åˆ°åï¼Œåˆ†åˆ«æ˜¯ err, req, res, next ã€‚\nâ—ï¸ Warning é”™è¯¯çº§åˆ«çš„ä¸­é—´ä»¶å¿…é¡»æ³¨å†Œåœ¨æ‰€æœ‰è·¯ç”±ä¹‹å\nconst express = require(\u0026#39;express\u0026#39;) const app = express() // 1. å®šä¹‰è·¯ç”± app.get(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; { // 1.1 äººä¸ºçš„åˆ¶é€ é”™è¯¯ throw new Error(\u0026#39;æœåŠ¡å™¨å†…éƒ¨å‘ç”Ÿäº†é”™è¯¯ï¼\u0026#39;) res.send(\u0026#39;Home page.\u0026#39;) }) // 2. å®šä¹‰é”™è¯¯çº§åˆ«çš„ä¸­é—´ä»¶ï¼Œæ•è·æ•´ä¸ªé¡¹ç›®çš„å¼‚å¸¸é”™è¯¯ï¼Œä»è€Œé˜²æ­¢ç¨‹åºçš„å´©æºƒ app.use((err, req, res, next) =\u0026gt; { console.log(\u0026#39;å‘ç”Ÿäº†é”™è¯¯ï¼\u0026#39; + err.message) res.send(\u0026#39;Errorï¼š\u0026#39; + err.message) }) app.listen(80, function () {console.log(\u0026#39;Express server running at http://127.0.0.1\u0026#39;)}) Express å†…ç½®çš„ä¸­é—´ä»¶\nè‡ª Express 4.16.0 ç‰ˆæœ¬å¼€å§‹ï¼ŒExpress å†…ç½®äº† 3 ä¸ªå¸¸ç”¨çš„ä¸­é—´ä»¶ï¼Œæå¤§æé«˜äº† Express é¡¹ç›®çš„å¼€å‘æ•ˆç‡å’Œä½“éªŒã€‚\nexpress.static() - å¿«é€Ÿæ‰˜ç®¡ é™æ€èµ„æº*^static^* çš„å†…ç½®ä¸­é—´ä»¶ï¼Œä¾‹å¦‚ï¼š HTML æ–‡ä»¶ã€å›¾ç‰‡ã€CSS æ ·å¼ç­‰ express.json() 4.16.0+ - è§£æ JSON æ ¼å¼çš„è¯·æ±‚ä½“æ•°æ® express.urlencoded(option) 4.16.0+ - è§£æ URL-encoded æ ¼å¼çš„è¯·æ±‚ä½“æ•°æ® - å³ POST çš„è¡¨å•å†…å®¹ ğŸ“ Note å®ç°ä¸Šï¼Œ2 å’Œ 3 è¿™ä¸¤ä¸ªä¸­é—´ä»¶éƒ½æŠŠè§£æçš„ç»“æœæŒ‚è½½åœ¨äº† req.body è¿™ä¸ªä¸­é—´ä»¶ä¸Šã€‚å› æ­¤ï¼Œä¸é…ç½®ä¸­é—´ä»¶æ—¶ï¼Œreq.body é»˜è®¤ä¸º undefined ï¼›æ²¡æœ‰ä»»ä½•æ•°æ®å¯ä»¥è¢«è¿™ä¸¤ä¸ªä¸­é—´ä»¶è§£æçš„æ—¶å€™ï¼Œreq.body é»˜è®¤ä¸º {} ã€‚\nâš ï¸ Caution å¦‚æœè¦è·å– URL-encoded æ ¼å¼çš„è¯·æ±‚ä½“æ•°æ®ï¼Œå¿…é¡»é…ç½®ä¸­é—´ä»¶ app.use(express.urlencoded({extended:false})) ã€‚\n// æ³¨æ„ï¼šé™¤äº†é”™è¯¯çº§åˆ«çš„ä¸­é—´ä»¶ï¼Œå…¶ä»–çš„ä¸­é—´ä»¶ï¼Œå¿…é¡»åœ¨è·¯ç”±ä¹‹å‰è¿›è¡Œé…ç½® // 1. è§£æ application/json æ ¼å¼æ•°æ®çš„å†…ç½®ä¸­é—´ä»¶ // 2. è§£æ application/x-www-form-urlencoded æ ¼å¼æ•°æ®çš„å†…ç½®ä¸­é—´ä»¶ // ä¸¤ä¸ªä¸­é—´ä»¶éƒ½ä¼šæŠŠ app.use(express.json()) app.use(express.urlencoded({ extended: false })) app.post(\u0026#39;/user\u0026#39;, (req, res) =\u0026gt; { // åœ¨æœåŠ¡å™¨ï¼Œå¯ä»¥ä½¿ç”¨ req.body è¿™ä¸ªå±æ€§ï¼Œæ¥æ¥æ”¶å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚ä½“æ•°æ® // é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä¸é…ç½®è§£æè¡¨å•æ•°æ®çš„ä¸­é—´ä»¶ï¼Œåˆ™ req.body é»˜è®¤ç­‰äº undefined // send: [name:zhangsan] Content Type: application/x-www-form-urlencoded console.log(req.body) // [Object: null prototype] { name: \u0026#39;zhangsan\u0026#39; } res.send(\u0026#39;ok\u0026#39;) }) app.post(\u0026#39;/book\u0026#39;, (req, res) =\u0026gt; { // åœ¨æœåŠ¡å™¨ç«¯ï¼Œå¯ä»¥é€šè¿‡ req,body æ¥è·å– JSON æ ¼å¼çš„è¡¨å•æ•°æ®å’Œ url-encoded æ ¼å¼çš„æ•°æ® // send: { \u0026#34;name\u0026#34;: \u0026#34;book1\u0026#34; }, Content Type: application/x-www-form-urlencoded console.log(req.body) // { name: \u0026#39;book1\u0026#39; } res.send(\u0026#39;ok\u0026#39;) }) // è°ƒç”¨ app.listen æ–¹æ³•ï¼ŒæŒ‡å®šç«¯å£å·å¹¶å¯åŠ¨webæœåŠ¡å™¨ app.listen(80, function () { console.log(\u0026#39;Express server running at http://127.0.0.1\u0026#39;) }) ğŸ“ Note å¯ä»¥é€šè¿‡ Object.create(null) åˆ›å»ºæ²¡æœ‰åŸå‹çš„å¯¹è±¡ä»¥èŠ‚çœèµ„æº\nç¬¬ä¸‰æ–¹çš„ä¸­é—´ä»¶\næŒ‡çš„æ˜¯é Express å®˜æ–¹å†…ç½®çš„ï¼Œç”±ç¬¬ä¸‰æ–¹å¼€å‘å‡ºæ¥çš„ä¸­é—´ä»¶ã€‚é¡¹ç›®ä¸­ï¼Œå¯ä»¥æŒ‰éœ€ä¸‹è½½å¹¶é…ç½®ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶ï¼Œä»è€Œæé«˜é¡¹ç›®çš„å¼€å‘æ•ˆç‡ã€‚\nconst parser = require(\u0026#39;body-parser\u0026#39;); // 1. å¯¼å…¥è§£æè¡¨å•æ•°æ®çš„ä¸­é—´ä»¶ body-parser app.use(parser.urlencoded({ extended: false })); // 2. ä½¿ç”¨ app.use() æ³¨å†Œä¸­é—´ä»¶ // app.use(express.urlencoded({ extended: false })) æ–°ç‰ˆ express ç›´æ¥ä½¿ç”¨ app.post(\u0026#39;/user\u0026#39;, (req, res) =\u0026gt; { // å¦‚æœæ²¡æœ‰é…ç½®ä»»ä½•è§£æè¡¨å•æ•°æ®çš„ä¸­é—´ä»¶ï¼Œåˆ™ req.body é»˜è®¤ç­‰äº undefined console.log(req.body); res.send(\u0026#39;ok\u0026#39;); }) ğŸ“ Note Express å†…ç½®çš„ express.urlencoded ä¸­é—´ä»¶ï¼Œå°±æ˜¯åŸºäº body-parser è¿™ä¸ªç¬¬ä¸‰æ–¹ä¸­é—´ä»¶è¿›ä¸€æ­¥å°è£…å‡ºæ¥çš„ã€‚\nè‡ªå®šä¹‰ä¸­é—´ä»¶\nè‡ªå·±æ‰‹åŠ¨æ¨¡æ‹Ÿä¸€ä¸ªç±»ä¼¼äº express.urlencoded è¿™æ ·çš„ä¸­é—´ä»¶ï¼Œæ¥è§£æ POST æäº¤åˆ°æœåŠ¡å™¨çš„è¡¨å•æ•°æ®ï¼Œå®ç°æ­¥éª¤ï¼š\nå®šä¹‰ä¸­é—´ä»¶\nç›‘å¬ req çš„ data äº‹ä»¶ - è·å–å®¢æˆ·ç«¯å‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®\nå¦‚æœæ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œæ— æ³•ä¸€æ¬¡æ€§å‘é€å®Œæ¯•ï¼Œåˆ™å®¢æˆ·ç«¯ä¼šæŠŠæ•°æ®åˆ‡å‰²åï¼Œåˆ†æ‰¹å‘é€åˆ°æœåŠ¡å™¨ã€‚æ‰€ä»¥ data äº‹ä»¶å¯èƒ½ä¼šè§¦å‘å¤šæ¬¡ï¼Œæ¯ä¸€æ¬¡è§¦å‘ data äº‹ä»¶æ—¶ï¼Œè·å–åˆ°æ•°æ®åªæ˜¯å®Œæ•´æ•°æ®çš„ä¸€éƒ¨åˆ†ï¼Œéœ€è¦ æ‰‹åŠ¨å¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œæ‹¼æ¥ ã€‚\nç›‘å¬ req çš„ end äº‹ä»¶\nå½“è¯·æ±‚ä½“æ•°æ®æ¥æ”¶å®Œæ¯•ä¹‹åï¼Œä¼šè‡ªåŠ¨è§¦å‘ req çš„ end äº‹ä»¶ï¼Œå¯ä»¥åœ¨ req çš„ end äº‹ä»¶ä¸­ï¼Œæ‹¿åˆ°å¹¶å¤„ç†å®Œæ•´çš„è¯·æ±‚ä½“æ•°æ®\nNode.js å†…ç½®äº†ä¸€ä¸ª querystring æ¨¡å—ï¼Œä¸“é—¨ç”¨æ¥å¤„ç†æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚é€šè¿‡è¿™ä¸ªæ¨¡å—æä¾›çš„ parse() å‡½æ•°ï¼Œå¯ä»¥è½»æ¾æŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£ææˆå¯¹è±¡çš„æ ¼å¼\nä½¿ç”¨ querystring æ¨¡å—è§£æè¯·æ±‚ä½“æ•°æ®\nå°†è§£æå‡ºæ¥çš„æ•°æ®å¯¹è±¡æŒ‚è½½ä¸º req.body\nå°†è‡ªå®šä¹‰ä¸­é—´ä»¶å°è£…ä¸ºæ¨¡å—\nconst bodyParser = (req, res, next) =\u0026gt; { // å®šä¹‰ä¸­é—´ä»¶å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ // 1. å®šä¹‰ä¸€ä¸ª str å­—ç¬¦ä¸²ï¼Œä¸“é—¨ç”¨æ¥å­˜å‚¨å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚ä½“æ•°æ® let str = \u0026#39;\u0026#39; // 2. ç›‘å¬ req çš„ data äº‹ä»¶ req.on(\u0026#39;data\u0026#39;, chunk =\u0026gt; { str += chunk }) // 3. ç›‘å¬ req çš„ end äº‹ä»¶ req.on(\u0026#39;end\u0026#39;, () =\u0026gt; { // åœ¨ str ä¸­å­˜æ”¾çš„æ˜¯å®Œæ•´çš„è¯·æ±‚ä½“æ•°æ® // console.log(str) // TODO: æŠŠå­—ç¬¦ä¸²æ ¼å¼çš„è¯·æ±‚ä½“æ•°æ®ï¼Œè§£ææˆå¯¹è±¡æ ¼å¼ const body = qs.parse(str) req.body = body next() }) } module.exports = bodyParser // 1. å¯¼å…¥è‡ªå·±å°è£…çš„ä¸­é—´ä»¶æ¨¡å— const customBodyParser = require(\u0026#39;./14.custom-body-parser\u0026#39;) // 2. å°†è‡ªå®šä¹‰çš„ä¸­é—´ä»¶å‡½æ•°ï¼Œæ³¨å†Œä¸ºå…¨å±€å¯ç”¨çš„ä¸­é—´ä»¶ app.use(customBodyParser) app.post(\u0026#39;/user\u0026#39;, (req, res) =\u0026gt; { res.send(req.body) }) è·¨åŸŸ æµè§ˆå™¨ä»ä¸€ä¸ªåŸŸåçš„ç½‘é¡µå»è¯·æ±‚å¦ä¸€ä¸ªåŸŸåçš„èµ„æºæ—¶ï¼ŒåŸŸåã€ç«¯å£ã€åè®®ä»»ä¸€ä¸åŒï¼Œéƒ½æ˜¯è·¨åŸŸã€‚æµè§ˆå™¨çš„ åŒæºå®‰å…¨ç­–ç•¥ é»˜è®¤ä¼šç»„ç»‡ç½‘é¡µ è·¨åŸŸ è·å–èµ„æºã€‚ä½†å¦‚æœæ¥å£æœåŠ¡å™¨é…ç½®äº† CORS ç›¸å…³çš„ HTTP å“åº”å¤´ ï¼Œå³å¯è§£å†³æµè§ˆå™¨ç«¯çš„è·¨åŸŸè®¿é—®é™åˆ¶ã€‚\nè§£å†³æ¥å£è·¨åŸŸé—®é¢˜çš„æ–¹æ¡ˆä¸»è¦æœ‰ä¸¤ç§ï¼š\nCORSCross-Origin Resource Sharingï¼Œè·¨åŸŸèµ„æºå…±äº« - ä¸»æµè§£å†³æ–¹æ¡ˆ JSONP - åªæ”¯æŒ GET è¯·æ±‚ CORS ä¸­é—´ä»¶ ä½¿ç”¨ CORS ä¸­é—´ä»¶è§£å†³è·¨åŸŸé—®é¢˜\ncors æ˜¯ Express çš„ä¸€ä¸ªç¬¬ä¸‰æ–¹ä¸­é—´ä»¶ï¼Œæ˜¯å¯¹ä¸€ç³»åˆ— HTTP å“åº”å¤´çš„å°è£…ã€‚è¿™äº› HTTP å“åº”å¤´å†³å®šæµè§ˆå™¨æ˜¯å¦é˜»æ­¢å‰ç«¯ JS ä»£ç è·¨åŸŸè·å–èµ„æºï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°è§£å†³è·¨åŸŸé—®é¢˜ã€‚ä½¿ç”¨æ­¥éª¤åˆ†ä¸ºå¦‚ä¸‹ 3 æ­¥ï¼š\nè¿è¡Œ npm install cors å®‰è£…ä¸­é—´ä»¶ ä½¿ç”¨ const cors = require('cors') å¯¼å…¥ä¸­é—´ä»¶ åœ¨ è·¯ç”±*^Router^* ä¹‹å‰è°ƒç”¨ app.use(cors()) é…ç½®ä¸­é—´ä»¶ // ä¸€å®šè¦åœ¨è·¯ç”±ä¹‹å‰ï¼Œé…ç½® cors è¿™ä¸ªä¸­é—´ä»¶ï¼Œä»è€Œè§£å†³æ¥å£è·¨åŸŸçš„é—®é¢˜ const cors = require(\u0026#39;cors\u0026#39;) app.use(cors()) ğŸ“ Note\nCORS åœ¨ æœåŠ¡å™¨ç«¯ è¿›è¡Œé…ç½®ï¼Œå®¢æˆ·ç«¯æµè§ˆå™¨æ— é¡»åšä»»ä½•é¢å¤–çš„é…ç½®ï¼Œå³å¯è¯·æ±‚å¼€å¯äº† CORS çš„æ¥å£ã€‚ åªæœ‰æ”¯æŒ XMLHttpRequest Level2 çš„æµè§ˆå™¨ï¼Œæ‰èƒ½æ­£å¸¸è®¿é—®å¼€å¯äº† CORS çš„æœåŠ¡ç«¯æ¥å£ï¼ˆå¦‚ï¼šIE10+ã€Chrome4+ã€FireFox3.5+ï¼‰ æœåŠ¡ç«¯ åœ¨æœåŠ¡å™¨ç«¯é€šè¿‡ res.setHeader çš„ Access-Control-Allow-* ç³»åˆ—å‚æ•°æ¥å†³å®šå®¢æˆ·ç«¯å¯ä»¥å‘é€çš„å†…å®¹ã€‚\nOrigin Access-Control-Allow-Origin: \u0026lt;origin\u0026gt; | * è®¾ç½®ï¼š\nres.setHeader(\u0026#34;Access-Control-Allow-Origin\u0026#34;, \u0026#34;\u0026lt;origin\u0026gt;\u0026#34;) å…¶ä¸­ï¼Œ origin å‚æ•°æŒ‡å®šäº†å…è®¸è®¿é—®è¯¥èµ„æºçš„å¤–åŸŸ URL ã€‚\nHeaders Access-Control-Allow-Headers é»˜è®¤æƒ…å†µä¸‹ï¼ŒCORS ä»…æ”¯æŒå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€å¦‚ä¸‹çš„ 9 ä¸ªè¯·æ±‚å¤´ï¼š\nAcceptã€Accept-Languageã€Content-Languageã€DPRã€Downlinkã€Save-Dataã€Viewport-Widthã€Width ã€Content-Type ï¼ˆå€¼ä»…é™äº text/plainã€multipart/form-dataã€application/x-www-form-urlencodedï¼‰\nå¦‚æœå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€äº†é¢å¤–çš„è¯·æ±‚å¤´ä¿¡æ¯ï¼Œåˆ™éœ€è¦åœ¨æœåŠ¡å™¨ç«¯ï¼Œé€šè¿‡ Access-Control-Allow-Headers å¯¹é¢å¤–çš„è¯·æ±‚å¤´è¿›è¡Œå£°æ˜ï¼Œå¦åˆ™è¿™æ¬¡è¯·æ±‚ä¼šå¤±è´¥ã€‚\nres.setHeader(\u0026#39;Access-Control-Allow-Headers\u0026#39;, \u0026#39;Content-Type, X-custom-Header\u0026#39;) Methods é»˜è®¤æƒ…å†µä¸‹ï¼ŒCORS ä»…æ”¯æŒå®¢æˆ·ç«¯å‘èµ· GETã€POSTã€HEAD è¯·æ±‚ã€‚\nå¦‚æœå®¢æˆ·ç«¯å¸Œæœ›é€šè¿‡ PUTã€DELETE ç­‰æ–¹å¼è¯·æ±‚æœåŠ¡å™¨çš„èµ„æºï¼Œåˆ™éœ€è¦åœ¨æœåŠ¡å™¨ç«¯ï¼Œé€šè¿‡ Access-Control-Alow-Methods æ¥æŒ‡æ˜å®é™…è¯·æ±‚æ‰€å…è®¸ä½¿ç”¨çš„ HTTP æ–¹æ³•ã€‚\nğŸ“ Note * ä»£è¡¨é€šé…ç¬¦\nres.setHeader(\u0026#39;Access-Control-Allow-Methods\u0026#39;, \u0026#39;POST, GET, PUT, DELETE\u0026#39;) res.setHeader(\u0026#39;Access-Control-Allow-Methods\u0026#39;, \u0026#39;*\u0026#39;) // æ”¯æŒæ‰€æœ‰è¯·æ±‚ å®¢æˆ·ç«¯ å®¢æˆ·ç«¯åœ¨è¯·æ±‚æ¥å£æ—¶ï¼Œæ ¹æ® è¯·æ±‚æ–¹å¼ å’Œ è¯·æ±‚å¤´ çš„ä¸åŒï¼Œå¯ä»¥å°†å…¶åˆ†ä¸ºä¸¤å¤§ç±»ï¼š\nç®€å•è¯·æ±‚ åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤å¤§æ¡ä»¶çš„è¯·æ±‚ï¼Œå°±å±äºç®€å•è¯·æ±‚ï¼š\nè¯·æ±‚æ–¹å¼ï¼šGETã€POSTã€HEAD ä¸‰è€…ä¹‹ä¸€ HTTP å¤´éƒ¨ä¿¡æ¯ä¸è¶…è¿‡ä»¥ä¸‹å‡ ç§å­—æ®µï¼šæ— è‡ªå®šä¹‰å¤´éƒ¨å­—æ®µã€Acceptã€Accept-Languageã€Content-Languageã€DPRã€Downlinkã€Save-Dataã€Viewport-Widthã€Width ã€Content-Typeï¼ˆåŒ…æ‹¬ application/x-www-form-urlencodedã€multipart/form-dataã€text/plainï¼‰ æ­¤æ—¶å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´åªä¼šå‘ç”Ÿä¸€æ¬¡è¯·æ±‚ã€‚\né¢„æ£€è¯·æ±‚ åªè¦ç¬¦åˆä»¥ä¸‹ä»»ä½•ä¸€ä¸ªæ¡ä»¶çš„è¯·æ±‚ï¼Œéƒ½éœ€è¦è¿›è¡Œé¢„æ£€è¯·æ±‚ï¼š\nè¯·æ±‚æ–¹å¼ä¸º GETã€POSTã€HEAD ä¹‹å¤–çš„è¯·æ±‚ Method ç±»å‹ è¯·æ±‚å¤´ä¸­åŒ…å« è‡ªå®šä¹‰å¤´éƒ¨å­—æ®µ å‘æœåŠ¡å™¨å‘é€äº† Content-Type ä¸º application/json æ ¼å¼çš„æ•°æ® åœ¨æµè§ˆå™¨ä¸æœåŠ¡å™¨æ­£å¼é€šä¿¡ä¹‹å‰ï¼Œæµè§ˆå™¨ä¼šå…ˆå‘é€ OPTION è¯·æ±‚è¿›è¡Œé¢„æ£€ï¼Œä»¥è·çŸ¥æœåŠ¡å™¨æ˜¯å¦å…è®¸è¯¥å®é™…è¯·æ±‚ï¼Œè¿™ä¸€æ¬¡çš„ OPTION è¯·æ±‚ç§°ä¸ºé¢„æ£€è¯·æ±‚ã€‚\næœåŠ¡å™¨æˆåŠŸå“åº”é¢„æ£€è¯·æ±‚åï¼Œæ‰ä¼šå‘é€çœŸæ­£çš„è¯·æ±‚ï¼Œå¹¶ä¸”æºå¸¦çœŸå®æ•°æ®ã€‚\n// apiRouter.js const express = require(\u0026#39;express\u0026#39;); const router = express.Router(); // GET æ¥å£ router.get(\u0026#39;/get\u0026#39;, (req, res) =\u0026gt; { // é€šè¿‡ req.query è·å–å®¢æˆ·ç«¯å‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ® const query = req.query; res.send({ status: 0, // 0 è¡¨ç¤ºå¤„ç†æˆåŠŸï¼Œ1 è¡¨ç¤ºå¤„ç†å¤±è´¥ msg: \u0026#39;GET è¯·æ±‚æˆåŠŸï¼\u0026#39;, // çŠ¶æ€çš„æè¿° data: query, // éœ€è¦å“åº”ç»™å®¢æˆ·ç«¯çš„æ•°æ® }); }); // POST æ¥å£ router.post(\u0026#39;/post\u0026#39;, (req, res) =\u0026gt; { // é€šè¿‡ req.body è·å–è¯·æ±‚ä½“ä¸­åŒ…å«çš„ url-encoded æ ¼å¼çš„æ•°æ® const body = req.body; res.send({ status: 0, msg: \u0026#39;POST è¯·æ±‚æˆåŠŸï¼\u0026#39;, data: body, }); }); // DELETE æ¥å£ router.delete(\u0026#39;/delete\u0026#39;, (req, res) =\u0026gt; { res.send({ status: 0, msg: \u0026#39;DELETEè¯·æ±‚æˆåŠŸ\u0026#39;, }); }); module.exports = router; const express = require(\u0026#39;express\u0026#39;); const app = express(); // é…ç½®è§£æè¡¨å•æ•°æ®çš„ä¸­é—´ä»¶ app.use(express.urlencoded({extended: false})); // å¿…é¡»åœ¨é…ç½® cors ä¸­é—´ä»¶ä¹‹å‰ï¼Œé…ç½® *JSONP* çš„æ¥å£ app.get(\u0026#39;/api/jsonp\u0026#39;, (req, res) =\u0026gt; { // å®šä¹‰ *JSONP* æ¥å£å…·ä½“çš„å®ç°è¿‡ç¨‹ /* 1. å¾—åˆ°å‡½æ•°çš„åç§° */ const funcName = req.query.callback; /* 2. å®šä¹‰è¦å‘é€åˆ°å®¢æˆ·ç«¯çš„æ•°æ®å¯¹è±¡ */ const data = {name: \u0026#39;zs\u0026#39;, age: 22}; /* 3. æ‹¼æ¥å‡ºä¸€ä¸ªå‡½æ•°çš„è°ƒç”¨ */ const scriptStr = `${funcName}(${JSON.stringify(data)})`; /* 4. æŠŠæ‹¼æ¥çš„å­—ç¬¦ä¸²ï¼Œå“åº”ç»™å®¢æˆ·ç«¯ */ res.send(scriptStr); }) // ä¸€å®šè¦åœ¨è·¯ç”±ä¹‹å‰ï¼Œé…ç½® cors è¿™ä¸ªä¸­é—´ä»¶ï¼Œä»è€Œè§£å†³æ¥å£è·¨åŸŸçš„é—®é¢˜ const cors = require(\u0026#39;cors\u0026#39;); app.use(cors()); // å¯¼å…¥è·¯ç”±æ¨¡å— const router = require(\u0026#39;apiRouter\u0026#39;); // æŠŠè·¯ç”±æ¨¡å—ï¼Œæ³¨å†Œåˆ° app ä¸Š app.use(\u0026#39;/api\u0026#39;, router); app.listen(80, () =\u0026gt; { console.log(\u0026#39;express server running at http://127.0.0.1\u0026#39;) }) \u0026lt;button id=\u0026#34;btnGET\u0026#34;\u0026gt;GET\u0026lt;/button\u0026gt; \u0026lt;button id=\u0026#34;btnPOST\u0026#34;\u0026gt;POST\u0026lt;/button\u0026gt; \u0026lt;button id=\u0026#34;btnDelete\u0026#34;\u0026gt;DELETE\u0026lt;/button\u0026gt; \u0026lt;button id=\u0026#34;btnJSONP\u0026#34;\u0026gt;JSONP\u0026lt;/button\u0026gt; \u0026lt;script\u0026gt; $(function () { // 1. æµ‹è¯•GETæ¥å£ $(\u0026#39;#btnGET\u0026#39;).on(\u0026#39;click\u0026#39;, function () { $.ajax({ type: \u0026#39;GET\u0026#39;, url: \u0026#39;http://127.0.0.1/api/get\u0026#39;, data: {name: \u0026#39;cess\u0026#39;, age: 18}, success: function (res) { console.log(res); }, }); }); // 2. æµ‹è¯•POSTæ¥å£ $(\u0026#39;#btnPOST\u0026#39;).on(\u0026#39;click\u0026#39;, function () { $.ajax({ type: \u0026#39;POST\u0026#39;, url: \u0026#39;http://127.0.0.1/api/post\u0026#39;, data: {bookname: \u0026#39;å¼€ç«¯\u0026#39;, author: \u0026#39;ç¥ˆç¥·å›\u0026#39;}, success: function (res) { console.log(res); }, }); }); // 3. ä¸ºåˆ é™¤æŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶å¤„ç†å‡½æ•° $(\u0026#39;#btnDelete\u0026#39;).on(\u0026#39;click\u0026#39;, function () { $.ajax({ type: \u0026#39;DELETE\u0026#39;, url: \u0026#39;http://127.0.0.1/api/delete\u0026#39;, success: function (res) { console.log(res); }, }); }); // 4. ä¸º *JSONP* æŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶å¤„ç†å‡½æ•° $(\u0026#39;#btnJSONP\u0026#39;).on(\u0026#39;click\u0026#39;, function () { $.ajax({ type: \u0026#39;GET\u0026#39;, url: \u0026#39;http://127.0.0.1/api/jsonp\u0026#39;, dataType: \u0026#39;jsonp\u0026#39;, success: function (res) { console.log(res); }, }); }); }); \u0026lt;/script\u0026gt; JSONP æ¦‚å¿µï¼šæµè§ˆå™¨ç«¯é€šè¿‡ \u0026lt;script\u0026gt; æ ‡ç­¾çš„ src å±æ€§ï¼Œè¯·æ±‚æœåŠ¡å™¨ä¸Šçš„æ•°æ®ï¼ŒåŒæ—¶ï¼ŒæœåŠ¡å™¨è¿”å›ä¸€ä¸ª å‡½æ•°çš„è°ƒç”¨ ã€‚è¿™ç§è¯·æ±‚æ•°æ®çš„æ–¹å¼å«åš JSONP ã€‚\nç‰¹ç‚¹\nJSONP ä¸å±äºçœŸæ­£çš„ Ajax è¯·æ±‚ï¼Œå› ä¸ºå®ƒæ²¡æœ‰ä½¿ç”¨ XMLHttpRequest è¿™ä¸ªå¯¹è±¡ JSONP ä»…æ”¯æŒ GET è¯·æ±‚ï¼Œä¸æ”¯æŒ POSTã€PUTã€DELETE ç­‰è¯·æ±‚ å¦‚æœé¡¹ç›®ä¸­å·²ç»é…ç½®äº† CORS è·¨åŸŸèµ„æºå…±äº«ï¼Œä¸ºäº†é˜²æ­¢å†²çªï¼Œå¿…é¡»åœ¨é…ç½® CORS ä¸­é—´ä»¶ ä¹‹å‰ å£°æ˜ JSONP çš„æ¥å£ã€‚å¦åˆ™ JSONP æ¥å£ä¼šè¢«å¤„ç†æˆå¼€å¯äº† CORS çš„æ¥å£\nå®ç° JSONP æ¥å£çš„æ­¥éª¤ï¼š\nè·å–å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„å›è°ƒå‡½æ•°çš„åå­— å¾—åˆ°è¦é€šè¿‡ JSONP å½¢å¼å‘é€ç»™å®¢æˆ·ç«¯çš„æ•°æ® æ ¹æ®å‰ä¸¤æ­¥å¾—åˆ°çš„æ•°æ®ï¼Œæ‹¼æ¥å‡ºä¸€ä¸ªå‡½æ•°è°ƒç”¨çš„å­—ç¬¦ä¸² æŠŠä¸Šä¸€æ­¥æ‹¼æ¥å¾—åˆ°çš„å­—ç¬¦ä¸²ï¼Œå“åº”ç»™å®¢æˆ·ç«¯çš„ \u0026lt;script\u0026gt; æ ‡ç­¾è¿›è¡Œè§£ææ‰§è¡Œ // æœåŠ¡ç«¯ // å¿…é¡»åœ¨é…ç½® cors ä¸­é—´ä»¶ä¹‹å‰ï¼Œé…ç½® JSONP çš„æ¥å£ app.get(\u0026#39;/api/jsonp\u0026#39;, (req, res) =\u0026gt; { // TODO: å®šä¹‰ JSONP æ¥å£å…·ä½“çš„å®ç°è¿‡ç¨‹ // 1. è·å–å®¢æˆ·ç«¯å‘æ¥çš„ä¼šæ‰å‡½æ•°åç§° const funcName = req.query.callback // 2. å®šä¹‰è¦å‘é€åˆ°å®¢æˆ·ç«¯çš„æ•°æ®å¯¹è±¡ const data = { name: \u0026#39;zs\u0026#39;, age: 22 } // 3. æ‹¼æ¥å‡ºä¸€ä¸ªå‡½æ•°çš„è°ƒç”¨ const scriptStr = `${funcName}(${JSON.stringify(data)})` // 4. æŠŠæ‹¼æ¥çš„å­—ç¬¦ä¸²ï¼Œå“åº”ç»™å®¢æˆ·ç«¯ res.send(scriptStr) }) // å®¢æˆ·ç«¯ // 4. ä¸º JSONP æŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶å¤„ç†å‡½æ•° $(\u0026#39;#btnJSONP\u0026#39;).on(\u0026#39;click\u0026#39;, function () { $.ajax({ type: \u0026#39;GET\u0026#39;, url: \u0026#39;http://127.0.0.1/api/jsonp\u0026#39;, dataType: \u0026#39;jsonp\u0026#39;, success: function (res) { console.log(res) // {name: \u0026#39;zs\u0026#39;, age: 22} }, }) }) // å®¢æˆ·ç«¯ - ä½¿ç”¨åŸç”ŸJSå®ç° // æ³¨æ„è¿™é‡Œåªèƒ½ç”¨functionè€Œä¸èƒ½ç”¨()=\u0026gt;{}åŒ¿åå‡½æ•°ä¸ç„¶è·å–ä¸åˆ°å‡½æ•°å function callFun(data) { console.log(data, typeof data) // callFun({\u0026#34;name\u0026#34;:\u0026#34;zs\u0026#34;,\u0026#34;age\u0026#34;:22}) } const callHandle = document.createElement(\u0026#39;script\u0026#39;) callHandle.innerHTML = callFun.toString() document.body.appendChild(callHandle) const config = { url: \u0026#39;http://127.0.0.1/api/jsonp\u0026#39;, // æœåŠ¡ç«¯jsonpæ¥å£ callback: \u0026#39;callFun\u0026#39; // æŒ‡å®šå®¢æˆ·ç«¯ä¸Šçš„å›è°ƒå¤„ç†å‡½æ•° } const script = document.createElement(\u0026#39;script\u0026#39;) script.setAttribute(\u0026#39;src\u0026#39;, `${config.url}?callback=${config.callback}`) document.body.appendChild(script) script.onload = e =\u0026gt; { console.log(script) // 1. åœ¨æ–‡æ¡£ä¸­åˆ›å»º \u0026lt;script src=\u0026#34;${config.url}?callback=${config.callback}\u0026#34; // 2. DOMåŠ è½½å¹¶è°ƒç”¨æŒ‚è½½çš„å‡½æ•°ï¼Œå³ç”±æœåŠ¡å™¨æ‹¼æ¥çš„å‡½æ•°callFun({\u0026#34;name\u0026#34;:\u0026#34;zs\u0026#34;,\u0026#34;age\u0026#34;:22}) // 3. è°ƒç”¨å®¢æˆ·ç«¯åˆ›å»ºçš„\u0026lt;script\u0026gt;... fucntion callfn(data)\u0026lt;/script\u0026gt; document.body.removeChild(script) } è®¤è¯ å¼€å‘æ¨¡å¼ ç›®å‰ä¸»æµçš„ Web å¼€å‘æ¨¡å¼æœ‰ä¸¤ç§ï¼š\nåŸºäº æœåŠ¡ç«¯æ¸²æŸ“ çš„ä¼ ç»Ÿ Web å¼€å‘æ¨¡å¼\nä¼ ç»Ÿ PHP ï¼ŒæœåŠ¡å™¨å‘é€ç»™å®¢æˆ·ç«¯çš„ HTML çš„é¡µé¢ï¼Œæ˜¯åœ¨æœåŠ¡å™¨é€šè¿‡å­—ç¬¦ä¸²çš„æ‹¼æ¥ï¼ŒåŠ¨æ€ç”Ÿæˆçš„ã€‚å› æ­¤ï¼Œå®¢æˆ·ç«¯ä¸éœ€è¦ç±»ä¼¼ AJAX æŠ€æœ¯é¢å¤–è¯·æ±‚é¡µé¢çš„æ•°æ®ã€‚\napp.get(\u0026#39;/index.html\u0026#39;, (req, res) =\u0026gt; { // 1. è¦æ¸²æŸ“çš„æ•°æ® const user = { name: \u0026#39;zs\u0026#39;, age: 20 } // 2. æœåŠ¡é€šè¿‡å­—ç¬¦ä¸²çš„æ‹¼æ¥åŠ¨æ€ç”Ÿæˆ HTML å†…å®¹ const html = `\u0026lt;h1\u0026gt;å§“åï¼š${user.name}ï¼Œå¹´é¾„ï¼š${user.age}\u0026lt;/h1\u0026gt;` // 3. æŠŠé¢„æ¸²æŸ“é¡µé¢å†…å®¹å“åº”ç»™å®¢æˆ·ç«¯ res.send(html) }) â˜•ï¸ Pros \u0026amp; Cons æœåŠ¡ç«¯æ¸²æŸ“çš„ä¼˜ç¼ºç‚¹\nä¼˜ç‚¹ï¼š\nå‰ç«¯è€—æ—¶å°‘ æœ‰åˆ©äº SEO ç¼ºç‚¹ï¼š\nå ç”¨æœåŠ¡å™¨èµ„æº ä¸åˆ©äºå‰åç«¯åˆ†ç¦» - å‰ååˆ†ç¦»éš¾ä»¥åˆ†å·¥åˆä½œï¼Œå°¤å…¶æ˜¯å‰ç«¯å¤æ‚åº¦é«˜çš„æ—¶å€™ åŸºäº å‰åç«¯åˆ†ç¦» çš„æ–°å‹ Web å¼€å‘æ¨¡å¼\nåç«¯åªè´Ÿè´£æä¾› API æ¥å£ï¼Œå‰ç«¯ä½¿ç”¨ AJAX è°ƒç”¨\nâ˜•ï¸ Pros \u0026amp; Cons æœåŠ¡ç«¯æ¸²æŸ“çš„ä¼˜ç¼ºç‚¹\nä¼˜ç‚¹ï¼š\nå¼€å‘ä½“éªŒå¥½ - å‰ç«¯ä¸“æ³¨äº UI é¡µé¢çš„å¼€å‘ï¼Œåç«¯ä¸“æ³¨äº API çš„å¼€å‘ æé«˜åŠ è½½é€Ÿåº¦ å‡å°‘æœåŠ¡ç«¯æ¸²æŸ“å‹åŠ› ç¼ºç‚¹ï¼š\nå ç”¨æœåŠ¡å™¨èµ„æº\nä¸åˆ©äº SEO - å®Œæ•´çš„ HTML éœ€è¦åœ¨å®¢æˆ·ç«¯åŠ¨æ€æ‹¼æ¥å®Œæˆï¼Œæ‰€ä»¥çˆ¬è™«æ— æ³•çˆ¬å–é¡µé¢çš„æœ‰æ•ˆä¿¡æ¯\nğŸ“ Note Nuxt.js å¯ä»¥å®ç° æœåŠ¡ç«¯æ¸²æŸ“SSR, Server Side Render ï¼Œä»¥è§£å†³ SEO é—®é¢˜\nğŸ“ Note é€‰æ‹© Web å¼€å‘æ¨¡å¼\nä¼ä¸šçº§ç½‘ç«™ - ä¸»è¦æ˜¯å±•ç¤ºè€Œæ²¡æœ‰å¤æ‚çš„äº¤äº’ï¼Œå¹¶ä¸”éœ€è¦è‰¯å¥½çš„ SEO - æœåŠ¡ç«¯æ¸²æŸ“ åå°ç®¡ç†é¡¹ç›® - äº¤äº’æ€§å¼ºï¼Œä¸éœ€è¦è€ƒè™‘ SEO - å‰åç«¯åˆ†ç¦» å¦å¤–ï¼Œä¸ºäº†æé«˜ç”¨æˆ·ä½“éªŒï¼Œä¸€äº›ç½‘ç«™é‡‡ç”¨äº†é¦–å±æœåŠ¡å™¨æ¸²æŸ“+å…¶ä»–é¡µé¢å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼\nèº«ä»½è®¤è¯ å¯¹äºæœåŠ¡ç«¯æ¸²æŸ“å’Œç”¨æˆ·ç«¯æ¸²æŸ“ä¸¤ç§å¼€å‘æ¨¡å¼è€Œè¨€ï¼Œåˆ†åˆ«æœ‰ä¸åŒçš„è®¤è¯æ–¹æ¡ˆï¼š\næœåŠ¡ç«¯æ¸²æŸ“ä½¿ç”¨ Session è®¤è¯æœºåˆ¶ å‰åç«¯åˆ†ç¦»é‡‡ç”¨ JWT è®¤è¯æœºåˆ¶ Cookie å­˜å‚¨åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­çš„ä¸€æ®µä¸è¶…è¿‡ 4KB çš„å­—ç¬¦ä¸²ã€‚å®ƒç”±ä¸€ä¸ª åç§°*^Name^* ã€å€¼*^Value^* å’Œå…¶å®ƒå‡ ä¸ªç”¨äºæ§åˆ¶ Cookie æœ‰æ•ˆæœŸã€å®‰å…¨æ€§ã€ä½¿ç”¨èŒƒå›´çš„å¯é€‰å±æ€§ç»„æˆã€‚\nä¸åŒåŸŸåä¸‹çš„ Cookie å„è‡ªç‹¬ç«‹ã€‚å½“å‘èµ·è¯·æ±‚æ—¶ï¼Œè‡ªåŠ¨æŠŠå½“å‰åŸŸåä¸‹æ‰€æœ‰æœªè¿‡æœŸçš„ Cookie ä¸€åŒå‘é€åˆ°æœåŠ¡å™¨ã€‚\nğŸ“ Note Cookie çš„å‡ å¤§ç‰¹æ€§\nè‡ªåŠ¨å‘é€ åŸŸåç‹¬ç«‹ è¿‡æœŸæ—¶é™ 4KB é™åˆ¶ ç”±äº Cookie æ˜¯å­˜å‚¨åœ¨æµè§ˆå™¨ä¸­çš„ï¼Œè€Œä¸”æµè§ˆå™¨ä¹Ÿæä¾›äº†è¯»å†™ Cookie çš„ API ï¼Œå› æ­¤ Cookie å¾ˆå®¹æ˜“è¢«ä¼ªé€ ï¼Œä¸å…·æœ‰å®‰å…¨æ€§ã€‚å› æ­¤ä¸å»ºè®®æœåŠ¡å™¨é‡è¦çš„éšç§æ•°æ®é€šè¿‡ Cookie çš„å½¢å¼å‘é€ç»™æµè§ˆå™¨ã€‚\nSession åœ¨è®¡ç®—æœºç§‘å­¦é¢†åŸŸæ¥è¯´ï¼Œå°¤å…¶æ˜¯åœ¨ç½‘ç»œé¢†åŸŸï¼Œä¼šè¯æ˜¯ä¸€ç§æŒä¹…ç½‘ç»œåè®®ï¼Œåœ¨ç”¨æˆ·/ç”¨æˆ·ä»£ç†ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¹‹é—´å»ºç«‹å…³è”ï¼Œä»è€Œèµ·åˆ°äº¤æ¢æ•°æ®åŒ…çš„ä½œç”¨æœºåˆ¶ï¼Œsession åœ¨ç½‘ç»œåè®®telnet, FTP, etc\u0026hellip;ä¸­æ˜¯éå¸¸é‡è¦çš„éƒ¨åˆ†ã€‚\nåœ¨ä¸åŒ…å« ä¼šè¯å±‚e.g, UDP æˆ–è€…æ˜¯æ— æ³•é•¿æ—¶é—´é©»ç•™ä¼šè¯å±‚e.g, HTTP çš„ä¼ è¾“åè®®ä¸­ï¼Œä¼šè¯*^Session^* çš„ç»´æŒéœ€è¦ä¾é åœ¨ä¼ è¾“æ•°æ®ä¸­çš„é«˜çº§åˆ«ç¨‹åºã€‚ä¾‹å¦‚ï¼Œåœ¨æµè§ˆå™¨å’Œè¿œç¨‹ä¸»æœºä¹‹é—´çš„ HTTP ä¼ è¾“ä¸­ï¼ŒHTTP cookie å°±ä¼šè¢«ç”¨æ¥åŒ…å«ä¸€äº›ç›¸å…³çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ session IDï¼Œå‚æ•°å’Œæƒé™ä¿¡æ¯ç­‰ã€‚\nexpress-session åœ¨ Express é¡¹ç›®ä¸­ï¼Œåªéœ€å®‰è£… express-session ä¸­é—´ä»¶ï¼Œå³å¯åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ Session è®¤è¯ã€‚\n// 1. å¯¼å…¥ Session ä¸­é—´ä»¶ const session = require(\u0026#39;express-session\u0026#39;) // 2. é…ç½® Session ä¸­é—´ä»¶ app.use( session({ secret: \u0026#39;keyboard cat\u0026#39;, // secret å±æ€§å¯ä»¥ä¸ºä»»æ„å­—ç¬¦ä¸² reSave: false, // å›ºå®šå†™æ³• saveUninitialized: true // å›ºå®šå†™æ³• }) ) å½“ express-session ä¸­é—´ä»¶é…ç½®æˆåŠŸåï¼Œå³å¯é€šè¿‡ req.session æ¥è®¿é—®å’Œä½¿ç”¨ session å¯¹è±¡ï¼Œä»è€Œå­˜å‚¨ç”¨æˆ·çš„ç›¸å…³ä¿¡æ¯ã€‚\napp.post(\u0026#39;/api/login\u0026#39;, (req, res) =\u0026gt; { // åˆ¤æ–­ç”¨æˆ·æäº¤çš„ç™»å½•ä¿¡æ¯æ˜¯å¦æ­£ç¡® if (req.body.username !== \u0026#39;admin\u0026#39; || req.body.password !== \u0026#39;000000\u0026#39;) { return res.send({ status: 1, msg: \u0026#39;ç™»å½•å¤±è´¥\u0026#39; }) } // NOTE: å°†ç™»å½•æˆåŠŸåçš„ç”¨æˆ·ä¿¡æ¯ï¼Œä¿å­˜åˆ° Session ä¸­ // æ³¨æ„ï¼šåªæœ‰æˆåŠŸé…ç½®äº† express-session è¿™ä¸ªä¸­é—´ä»¶ä¹‹åï¼Œæ‰èƒ½å¤Ÿé€šè¿‡ req ç‚¹å‡ºæ¥ session è¿™ä¸ªå±æ€§ req.session.user = req.body // ç”¨æˆ·çš„ä¿¡æ¯ req.session.isLogin = true // ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ res.send({ status: 0, msg: \u0026#39;ç™»å½•æˆåŠŸ\u0026#39; }) }) è¿™æ ·ï¼Œç”¨æˆ·ä¸‹æ¬¡è®¿é—®çš„æ—¶å€™ï¼Œå°±å¯ä»¥ä» req.session æŒ‚è½½çš„å¯¹è±¡ä¸Šè·å–ä¹‹å‰å­˜å‚¨çš„æ•°æ®ï¼š\n// è·å–ç”¨æˆ·å§“åçš„æ¥å£ app.get(\u0026#39;/api/username\u0026#39;, (req, res) =\u0026gt; { // NOTE: ä» Session ä¸­è·å–ç”¨æˆ·çš„åç§°ï¼Œå“åº”ç»™å®¢æˆ·ç«¯ if (!req.session.isLogin) { return res.send({ status: 1, msg: \u0026#39;fail\u0026#39; }) } res.send({ status: 0, msg: \u0026#39;success\u0026#39;, username: req.session.user.username }) }) å¤„ç†ç”¨æˆ·ç™»å‡ºæ—¶ï¼Œè°ƒç”¨ req.session.destory() å‡½æ•°ï¼Œå³å¯æ¸…ç©ºæœåŠ¡å™¨ä¿å­˜çš„ session ä¿¡æ¯ã€‚\n// é€€å‡ºç™»å½•çš„æ¥å£ app.post(\u0026#39;/api/logout\u0026#39;, (req, res) =\u0026gt; { // NOTE: æ¸…ç©º Session ä¿¡æ¯ req.session.destroy() res.send({ status: 0, msg: \u0026#39;é€€å‡ºç™»å½•æˆåŠŸ\u0026#39; }) }) å±€é™æ€§ Session æœºåˆ¶éœ€è¦é…åˆ Cookie æ‰èƒ½å®ç°ã€‚ç”±äº Cookie é»˜è®¤ä¸æ”¯æŒè·¨åŸŸè®¿é—®ï¼Œæ‰€ä»¥ï¼Œå½“æ¶‰åŠå‰ç«¯è·¨åŸŸè¯·æ±‚åç«¯æ¥å£æ—¶ï¼Œéœ€è¦å¾ˆå¤šé¢å¤–çš„è®¾ç½®ï¼Œæ‰èƒ½å®ç°è·¨åŸŸ Session è®¤è¯ã€‚\nğŸ“ Note\nå½“å‰ç«¯è¯·æ±‚åç«¯æ¥å£ä¸å­˜åœ¨è·¨åŸŸé—®é¢˜æ—¶ï¼Œæ¨èä½¿ç”¨ Session èº«ä»½è®¤è¯æœºåˆ¶ å½“å‰ç«¯éœ€è¦è·¨åŸŸè¯·æ±‚æ—¶ï¼Œæ¨èä½¿ç”¨ JWT è®¤è¯æœºåˆ¶ JWT JWTJSON Web Token æ˜¯ç›®å‰æœ€æµè¡Œçš„è·¨åŸŸè®¤è¯è§£å†³æ–¹æ¡ˆã€‚\nJWT é€šå¸¸ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ Header^å¤´éƒ¨^ ã€Payload^æœ‰æ•ˆè·è½½^ ã€Signature^ç­¾å^ ã€‚ä¸‰è€…ä¹‹é—´ä½¿ç”¨ . åˆ†éš”ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š\nHeader.Payload.Signature Payload - çœŸæ­£çš„ç”¨æˆ·ä¿¡æ¯ï¼Œç»è¿‡åŠ å¯†åç”Ÿæˆçš„å­—ç¬¦ä¸² Header, Signature - å®‰å…¨æ€§ç›¸å…³çš„éƒ¨åˆ†ï¼Œåªæ˜¯ä¸ºäº†ä¿éšœ Token çš„å®‰å…¨æ€§ å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨è¿”å›çš„ JWT åï¼Œé€šå¸¸ä¼šå°†å®ƒå‚¨å­˜åœ¨ localStorage æˆ– sessionStorage ä¸­ã€‚\næ­¤åï¼Œå®¢æˆ·ç«¯æ¯æ¬¡äºæœåŠ¡å™¨é€šä¿¡ï¼Œéƒ½è¦å¸¦ä¸Šè¿™ä¸ª JWT å­—æ®µï¼Œä»è€Œè¿›è¡Œèº«ä»½è®¤è¯ã€‚æ¨èçš„åšæ³•æ˜¯æŠŠ JWT æ”¾åœ¨ HTTP è¯·æ±‚å¤´çš„ Authorization å­—æ®µä¸­ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š\nAuthorization: Bearer \u0026lt;token\u0026gt; ä½¿ç”¨ è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå®‰è£…ä¸¤ä¸ª JWT ç›¸å…³çš„åŒ…ï¼š\nnpm i jsonwebtoken express-jwt jsonwebtoken - ç”Ÿæˆ JWT å­—ç¬¦ä¸² express-jwt - å°† JWT è§£æè¿˜åŸæˆ JSON å¯¹è±¡ // å®‰è£…å¹¶å¯¼å…¥ JWT ç›¸å…³çš„ä¸¤ä¸ªåŒ…ï¼Œåˆ†åˆ«æ˜¯ jsonwebtoken å’Œ express-jwt const jwt = require(\u0026#39;jsonwebtoken\u0026#39;) const expressJWT = require(\u0026#39;express-jwt\u0026#39;) ä¸ºäº†ä¿éšœ JWT å­—ç¬¦ä¸²çš„å®‰å…¨æ€§ï¼Œé˜²æ­¢å­—ç¬¦ä¸²åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«åˆ«äººç ´è§£ï¼Œéœ€è¦ä¸“é—¨å®šä¹‰ä¸€ä¸ªç”¨äº åŠ å¯† å’Œ è§£å¯† çš„ secret å¯†é’¥ï¼š\nå½“ç”Ÿæˆ JWT å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨ secret å¯†é’¥å¯¹ç”¨æˆ·çš„ä¿¡æ¯è¿›è¡ŒåŠ å¯†ï¼Œæœ€ç»ˆå¾—åˆ°åŠ å¯†å¥½çš„ JWT å­—ç¬¦ä¸² è¿˜åŸ JWT å­—ç¬¦ä¸²ä¸º JSON å¯¹è±¡æ—¶ï¼Œéœ€è¦ä½¿ç”¨ secret å¯†é’¥è¿›è¡Œè§£å¯† const secretKey = \u0026#39;random key\u0026#39; jsonwebtoken è¯¥ npm åŒ…ç”¨äº åŠ å¯† JWT å­—ç¬¦ä¸²ï¼Œä»¥åœ¨å®¢æˆ·ç«¯è¿›è¡Œä¿å­˜ã€‚ï¼ˆç™»å½•åå‡å°‘æ•°æ®åº“çš„è°ƒç”¨ï¼Ÿï¼‰\nè°ƒç”¨ jsonwebtoken åŒ…æä¾›çš„ sign() æ–¹æ³•ï¼Œå°†ç”¨æˆ·çš„ä¿¡æ¯åŠ å¯†æˆ JWT å­—ç¬¦ä¸²ï¼Œå“åº”ç»™å®¢æˆ·ç«¯ï¼š\n// ç™»å½•æ¥å£ app.post(\u0026#39;/api/login\u0026#39;, function (req, res) { // å°† req.body è¯·æ±‚ä½“ä¸­çš„æ•°æ®ï¼Œè½¬å­˜ä¸º userinfo å¸¸é‡ const userinfo = req.body // ç™»å½•å¤±è´¥ if (userinfo.username !== \u0026#39;admin\u0026#39; || userinfo.password !== \u0026#39;000000\u0026#39;) { return res.send({ status: 400, message: \u0026#39;ç™»å½•å¤±è´¥ï¼\u0026#39; }) } // ç™»å½•æˆåŠŸ // NOTE: // åœ¨ç™»å½•æˆåŠŸä¹‹åï¼Œè°ƒç”¨ jwt.sign() æ–¹æ³•ç”Ÿæˆ JWT å­—ç¬¦ä¸²ã€‚å¹¶é€šè¿‡ token å±æ€§å‘é€ç»™å®¢æˆ·ç«¯ // å‚æ•°1ï¼šç”¨æˆ·çš„ä¿¡æ¯å¯¹è±¡ // å‚æ•°2ï¼šåŠ å¯†çš„ç§˜é’¥ // å‚æ•°3ï¼šé…ç½®å¯¹è±¡ï¼Œå¯ä»¥é…ç½®å½“å‰ token çš„æœ‰æ•ˆæœŸ // è®°ä½ï¼šåƒä¸‡ä¸è¦æŠŠå¯†ç åŠ å¯†åˆ° token å­—ç¬¦ä¸­ const tokenStr = jwt.sign({ username: userinfo.username }, secretKey, { expiresIn: \u0026#39;30s\u0026#39; }) res.send({ status: 200, message: \u0026#39;ç™»å½•æˆåŠŸï¼\u0026#39;, token: tokenStr // è¦å‘é€ç»™å®¢æˆ·ç«¯çš„ token å­—ç¬¦ä¸² }) }) ç”Ÿæˆ JWT\nâš ï¸ Caution ç”Ÿæˆ JWT çš„ Token å­—ç¬¦ä¸²æ—¶å€™ï¼Œä¸€å®šè¦å‰”é™¤ å¯†ç  å’Œ å¤´åƒ çš„å€¼\né€šè¿‡ ES6 çš„å¯¹è±¡å­—é¢é‡ï¼Œå¿«é€Ÿå‰”é™¤å¯†ç å’Œå¤´åƒçš„å€¼ï¼š // å‰”é™¤å®Œæ¯•ä¹‹åï¼Œuser ä¸­åªä¿ç•™äº†ç”¨æˆ·çš„ id, username, nickname, email è¿™å››ä¸ªå±æ€§çš„å€¼ const user = { ...results[0], password: \u0026#39;\u0026#39;, user_pic: \u0026#39;\u0026#39; } // åé¢è¦†ç›–å‰é¢çš„å€¼ è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼Œå®‰è£…ç”Ÿæˆ Token å­—ç¬¦ä¸²çš„åŒ…ï¼š npm i jsonwebtoken åœ¨ /router_handler/user.js æ¨¡å—çš„å¤´éƒ¨åŒºåŸŸï¼Œå¯¼å…¥ jsonwebtoken åŒ…ï¼š // ç”¨è¿™ä¸ªåŒ…æ¥ç”Ÿæˆ Token å­—ç¬¦ä¸² const jwt = require(\u0026#39;jsonwebtoken\u0026#39;) åˆ›å»º config.js æ–‡ä»¶ï¼Œå¹¶å‘å¤–å…±äº« åŠ å¯† å’Œ è¿˜åŸ Token çš„ jwtSecretKey å­—ç¬¦ä¸²ï¼š module.exports = { jwtSecretKey: \u0026#39;randon key string\u0026#39; } å°†ç”¨æˆ·ä¿¡æ¯å¯¹è±¡åŠ å¯†æˆ Token å­—ç¬¦ä¸²ï¼š // å¯¼å…¥é…ç½®æ–‡ä»¶ const config = require(\u0026#39;../config\u0026#39;) // ç”Ÿæˆ Token å­—ç¬¦ä¸² const tokenStr = jwt.sign(user, config.jwtSecretKey, { expiresIn: \u0026#39;10h\u0026#39; // token æœ‰æ•ˆæœŸä¸º 10 ä¸ªå°æ—¶ }) å°†ç”Ÿæˆçš„ Token å­—ç¬¦ä¸²å“åº”ç»™å®¢æˆ·ç«¯ï¼š res.send({ status: 0, message: \u0026#39;ç™»å½•æˆåŠŸï¼\u0026#39;, // ä¸ºäº†æ–¹ä¾¿å®¢æˆ·ç«¯ä½¿ç”¨ Tokenï¼Œåœ¨æœåŠ¡å™¨ç«¯ç›´æ¥æ‹¼æ¥ä¸Š Bearer çš„å‰ç¼€ token: \u0026#39;Bearer \u0026#39; + tokenStr, }) express-jwt è¯¥ npm åŒ…ç”¨äº è§£æ JWT å­—ç¬¦ä¸²ï¼Œä»¥åœ¨æœåŠ¡ç«¯è¿›è¡Œåˆ†æã€‚\nâ­ï¸ Important è¢«è§£æçš„å­—ç¬¦ä¸²æŒ‚è½½åœ¨ req.user å­—æ®µä¸Š\nå®¢æˆ·ç«¯æ¯æ¬¡åœ¨è®¿é—®é‚£äº›æœ‰æƒé™æ¥å£çš„æ—¶å€™ï¼Œéƒ½éœ€è¦ä¸»åŠ¨é€šè¿‡è¯·æ±‚å¤´ä¸­çš„ Authorization å­—æ®µï¼Œå°† Token å­—ç¬¦ä¸²å‘é€åˆ°æœåŠ¡å™¨è¿›è¡Œèº«ä»½è®¤è¯ã€‚æ­¤æ—¶ï¼ŒæœåŠ¡å™¨å¯ä»¥é€šè¿‡ express-jwt è¿™ä¸ªä¸­é—´ä»¶ï¼Œè‡ªåŠ¨å°†å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„ Token è§£æè¿˜åŸæˆ JSON å¯¹è±¡ï¼š\n// NOTE æ³¨å†Œå°† JWT å­—ç¬¦ä¸²è§£æè¿˜åŸæˆ JSON å¯¹è±¡çš„ä¸­é—´ä»¶ // æ³¨æ„ï¼šåªè¦é…ç½®æˆåŠŸäº† express-jwt è¿™ä¸ªä¸­é—´ä»¶ï¼Œå°±å¯ä»¥æŠŠè§£æå‡ºæ¥çš„ç”¨æˆ·ä¿¡æ¯ï¼ŒæŒ‚è½½åˆ° req.user å±æ€§ä¸Š app.use( expressJWT({ // è§£æ JWT çš„ä¸­é—´ä»¶ secret: secretKey }).unless({ // ç”¨æ¥æ ‡æ³¨å“ªäº›æ¥å£ä¸éœ€è¦è®¿é—®æƒé™ path: [/^\\/api\\//] }) ) âš ï¸ Caution è°ƒè¯•æ¥å£æ¨¡æ‹Ÿå‘é€ JWT çš„ token æ—¶ï¼Œéœ€è¦åœ¨åŸå§‹å­—ç¬¦ä¸²å‰åŠ  Bearer å¹¶æ¢è¡Œ/æ·»åŠ æ§è‚¡ï¼Œå¦åˆ™æ— æ³•è¢«æ­£ç¡®è§£æ\nğŸ“ Note æ•è·è§£æå¤±è´¥åäº§ç”Ÿçš„é”™è¯¯\nå½“ä½¿ç”¨ express-jwt è§£æ Token å­—ç¬¦ä¸²æ—¶ï¼Œå¦‚æœå®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„ Token å­—ç¬¦ä¸² è¿‡æœŸ æˆ– ä¸åˆæ³• ï¼Œä¼šäº§ç”Ÿä¸€ä¸ª è§£æå¤±è´¥ çš„é”™è¯¯ï¼Œå½±å“é¡¹ç›®çš„æ­£å¸¸è¿è¡Œã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ Express çš„é”™è¯¯å¤„ç†ä¸­é—´ä»¶ï¼Œæ•è·é”™è¯¯å¹¶è¿›è¡Œç›¸å…³çš„å¤„ç†ã€‚\nå¯ä»¥é˜»æ­¢æœªç™»å½•ç”¨æˆ·è®¿é—®éƒ¨åˆ†ç”»é¢ï¼Ÿ\n// NOTE: ä½¿ç”¨å…¨å±€é”™è¯¯å¤„ç†ä¸­é—´ä»¶ï¼Œæ•è·è§£æ JWT å¤±è´¥åäº§ç”Ÿçš„é”™è¯¯ app.use((err, req, res, next) =\u0026gt; { // è¿™æ¬¡é”™è¯¯æ˜¯ç”± token è§£æå¤±è´¥å¯¼è‡´çš„ if (err.name === \u0026#39;UnauthorizedError\u0026#39;) { return res.send({ status: 401, message: \u0026#39;æ— æ•ˆçš„token\u0026#39; }) } res.send({ status: 500, message: \u0026#39;æœªçŸ¥çš„é”™è¯¯\u0026#39; }) }) // è°ƒç”¨ app.listen æ–¹æ³•ï¼ŒæŒ‡å®šç«¯å£å·å¹¶å¯åŠ¨webæœåŠ¡å™¨ app.listen(8888, function () { console.log(\u0026#39;Express server running at http://127.0.0.1:8888\u0026#39;) }) è§£æ Token\nè¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼Œå®‰è£…è§£æ Token çš„ä¸­é—´ä»¶ï¼š npm i express-jwt åœ¨ app.js ä¸­æ³¨å†Œè·¯ç”±ä¹‹å‰ï¼Œé…ç½®è§£æ Token çš„ä¸­é—´ä»¶ï¼š // å¯¼å…¥é…ç½®æ–‡ä»¶ const config = require(\u0026#39;./config\u0026#39;) // è§£æ token çš„ä¸­é—´ä»¶ const expressJWT = require(\u0026#39;express-jwt\u0026#39;) // ä½¿ç”¨ .unless({ path: [/^\\/api\\//] }) æŒ‡å®šå“ªäº›æ¥å£ä¸éœ€è¦è¿›è¡Œ Token çš„èº«ä»½è®¤è¯ app.use(expressJWT({ secret: config.jwtSecretKey }).unless({ path: [/^\\/api\\//] })) åœ¨ app.js ä¸­çš„ é”™è¯¯çº§åˆ«ä¸­é—´ä»¶ é‡Œé¢ï¼Œæ•è·å¹¶å¤„ç† Token è®¤è¯å¤±è´¥åçš„é”™è¯¯ï¼š // é”™è¯¯ä¸­é—´ä»¶ app.use(function (err, req, res, next) { // çœç•¥å…¶å®ƒä»£ç ... // æ•è·èº«ä»½è®¤è¯å¤±è´¥çš„é”™è¯¯ if (err.name === \u0026#39;UnauthorizedError\u0026#39;) return res.cc(\u0026#39;èº«ä»½è®¤è¯å¤±è´¥ï¼\u0026#39;) // æœªçŸ¥é”™è¯¯... }) åŠ å¯† ä¸ºäº†ä¿è¯å¯†ç çš„å®‰å…¨æ€§ï¼Œä¸å»ºè®®åœ¨æ•°æ®åº“ç”¨æ˜æ–‡çš„å½¢å¼ä¿å­˜ç”¨æˆ·å¯†ç ï¼Œæ¨èå¯¹å¯†ç è¿›è¡ŒåŠ å¯†å­˜å‚¨ã€‚å¯ä»¥ä½¿ç”¨ bcrypt å¯¹ç”¨æˆ·å¯†ç è¿›è¡ŒåŠ å¯†ã€‚ä¼˜ç‚¹ï¼š\nåŠ å¯†ä¹‹åçš„å¯†ç æ— æ³•è¢«ç”¨æˆ·ç ´è§£ åŒä¸€æ˜æ–‡å¯†ç å¤šæ¬¡åŠ å¯†ï¼Œå¾—åˆ°çš„åŠ å¯†ç»“æœå„ä¸ç›¸åŒï¼Œä¿è¯äº†å®‰å…¨æ€§ åœ¨å¤„ç†ç”¨æˆ·çš„å‡½æ•°ä¸­ï¼Œç¡®è®¤ç”¨æˆ·åå¯ç”¨ï¼Œè°ƒç”¨ bcrypt.hashSync(æ˜æ–‡å¯†ç , éšæœºç›çš„é•¿åº¦) è¿›è¡ŒåŠ å¯†ã€‚\n// æ³¨å†Œæ–°ç”¨æˆ·çš„å¤„ç†å‡½æ•° exports.regUser = (req, res) =\u0026gt; { // è·å–å®¢æˆ·ç«¯æäº¤åˆ°æœåŠ¡å™¨çš„ç”¨æˆ·ä¿¡æ¯ const userinfo = req.body // å¯¹è¡¨å•ä¸­çš„æ•°æ®ï¼Œè¿›è¡Œåˆæ³•æ€§çš„æ ¡éªŒ // if (!userinfo.username || !userinfo.password) { // return res.send({ status: 1, message: \u0026#39;ç”¨æˆ·åæˆ–å¯†ç ä¸åˆæ³•ï¼\u0026#39; }) // } // å®šä¹‰ SQL è¯­å¥ï¼ŒæŸ¥è¯¢ç”¨æˆ·åæ˜¯å¦è¢«å ç”¨ const sqlStr = \u0026#39;select * from ev_users where username=?\u0026#39; db.query(sqlStr, userinfo.username, (err, results) =\u0026gt; { // æ‰§è¡Œ SQL è¯­å¥å¤±è´¥ if (err) { // return res.send({ status: 1, message: err.message }) return res.cc(err) } // åˆ¤æ–­ç”¨æˆ·åæ˜¯å¦è¢«å ç”¨ if (results.length \u0026gt; 0) { // return res.send({ status: 1, message: \u0026#39;ç”¨æˆ·åè¢«å ç”¨ï¼Œè¯·æ›´æ¢å…¶ä»–ç”¨æˆ·åï¼\u0026#39; }) return res.cc(\u0026#39;ç”¨æˆ·åè¢«å ç”¨ï¼Œè¯·æ›´æ¢å…¶ä»–ç”¨æˆ·åï¼\u0026#39;) } // è°ƒç”¨ bcrypt.hashSync() å¯¹å¯†ç è¿›è¡ŒåŠ å¯† userinfo.password = bcrypt.hashSync(userinfo.password, 10) // å®šä¹‰æ’å…¥æ–°ç”¨æˆ·çš„ SQL è¯­å¥ const sql = \u0026#39;insert into ev_users set ?\u0026#39; // è°ƒç”¨ db.query() æ‰§è¡Œ SQL è¯­å¥ db.query(sql, { username: userinfo.username, password: userinfo.password }, (err, results) =\u0026gt; { // åˆ¤æ–­ SQL è¯­å¥æ˜¯å¦æ‰§è¡ŒæˆåŠŸ // if (err) return res.send({ status: 1, message: err.message }) if (err) return res.cc(err) // åˆ¤æ–­å½±å“è¡Œæ•°æ˜¯å¦ä¸º 1 // if (results.affectedRows !== 1) return res.send({ status: 1, message: \u0026#39;æ³¨å†Œç”¨æˆ·å¤±è´¥ï¼Œè¯·ç¨åå†è¯•ï¼\u0026#39; }) if (results.affectedRows !== 1) return res.cc(\u0026#39;æ³¨å†Œç”¨æˆ·å¤±è´¥ï¼Œè¯·ç¨åå†è¯•ï¼\u0026#39;) // æ³¨å†Œç”¨æˆ·æˆåŠŸ // res.send({ status: 0, message: \u0026#39;æ³¨å†ŒæˆåŠŸï¼\u0026#39; }) res.cc(\u0026#39;æ³¨å†ŒæˆåŠŸï¼\u0026#39;, 0) }) }) } // ç™»å½•çš„å¤„ç†å‡½æ•° exports.login = (req, res) =\u0026gt; { res.send(\u0026#39;login OK\u0026#39;) } ğŸ“ Note clg æ˜¯ console.log() çš„ emmit ã€‚\néªŒè¯å¯†ç æ—¶ï¼Œè°ƒç”¨ bcrypt.compareSync(ç”¨æˆ·æäº¤çš„å¯†ç , æ•°æ®åº“ä¸­çš„å¯†ç ) æ–¹æ³•æ¯”è¾ƒå¯†ç æ˜¯å¦ä¸€è‡´ã€‚è¿”å› boolean ã€‚\n// æ‹¿ç€ç”¨æˆ·è¾“å…¥çš„å¯†ç ,å’Œæ•°æ®åº“ä¸­å­˜å‚¨çš„å¯†ç è¿›è¡Œå¯¹æ¯” const compareResult = bcrypt.compareSync(userinfo.password, results[0].password) // å¦‚æœå¯¹æ¯”çš„ç»“æœç­‰äº false, åˆ™è¯æ˜ç”¨æˆ·è¾“å…¥çš„å¯†ç é”™è¯¯ if (!compareResult) { return res.cc(\u0026#39;ç™»å½•å¤±è´¥ï¼\u0026#39;) } // TODOï¼šç™»å½•æˆåŠŸï¼Œç”Ÿæˆ Token å­—ç¬¦ä¸² éªŒè¯ è¡¨å•éªŒè¯çš„åŸåˆ™æ˜¯å‰ç«¯éªŒè¯ä¸ºè¾…ã€åç«¯éªŒè¯ä¸ºä¸»ï¼Œåç«¯æ°¸è¿œä¸è¦ç›¸ä¿¡å‰ç«¯æäº¤è¿‡æ¥çš„è®¤å¯å†…å®¹ã€‚\nå•çº¯ä½¿ç”¨ if...else... å¯¹åˆæ³•æ€§è¿›è¡ŒéªŒè¯ï¼Œæ•ˆç‡ä½ä¸‹ã€å‡ºé”™ç‡é«˜ã€ç»´æŠ¤æ€§å·®ï¼Œå› æ­¤ï¼Œæ¨èä½¿ç”¨ç¬¬ä¸‰æ–¹æ•°æ®éªŒè¯æ¨¡å—ï¼Œæ¥é™ä½å‡ºé”™ç‡ï¼Œè®©åç«¯ç¨‹åºå‘˜æ›´å¤šæŠŠç²¾åŠ›æ”¾åœ¨æ ¸å¿ƒä¸šåŠ¡é€»è¾‘çš„å¤„ç†ä¸Šã€‚\nå®‰è£… @hapi/joi åŒ…ï¼Œä¸ºè¡¨å•ä¸­æºå¸¦æ¯ä¸ªæ•°æ®é¡¹ï¼Œå®šä¹‰éªŒè¯è§„åˆ™ npm install @hapi/joi å®‰è£… @escook/express-joi ä¸­é—´ä»¶ï¼Œå®ç°è‡ªåŠ¨å¯¹è¡¨å•æ•°æ®éªŒè¯çš„åŠŸèƒ½ npm install @escook/express-joi æ–°å»º /schema/user.js ç”¨æˆ·ä¿¡æ¯éªŒè¯æ¨¡å— // å¯¼å…¥å®šä¹‰éªŒè¯è§„åˆ™çš„åŒ… /** * string() å€¼å¿…é¡»æ˜¯å­—ç¬¦ä¸² * alphanum() å€¼åªèƒ½æ˜¯åŒ…å« a-zA-Z0-9 çš„å­—ç¬¦ä¸² * min(length) æœ€å°é•¿åº¦ * max(length) æœ€å¤§é•¿åº¦ * required() å€¼æ˜¯å¿…é¡»é¡¹ï¼Œä¸èƒ½ä¸º undefined * email() å€¼å¿…é¡»æ˜¯é‚®ç®± * pattern(æ­£åˆ™è¡¨è¾¾å¼) å€¼å¿…é¡»ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„è§„åˆ™ */ const joi = require(\u0026#39;@hapi/joi\u0026#39;) // å®šä¹‰ç”¨æˆ·åå’Œå¯†ç çš„éªŒè¯è§„åˆ™ const username = joi.string().alphanum().min(1).max(10).required() const password = joi .string() .pattern(/^[\\S]{6,12}$/) .required() // å®šä¹‰éªŒè¯æ³¨å†Œå’Œç™»å½•è¡¨å•æ•°æ®çš„è§„åˆ™å¯¹è±¡ exports.reg_login_schema = { body: { username, password } } å¯¼å…¥ç”¨æˆ·è‡ªå®šä¹‰è§„åˆ™ï¼Œä½¿ç”¨ @escook-exoress-joi éªŒè¯ éªŒè¯é€šè¿‡ï¼Œåˆ™æŠŠè·¯ç”±å…³ç³»è½¬äº¤ç»™åé¢çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼›\néªŒè¯å¤±è´¥åˆ™æŠ¥å…¨å±€é”™è¯¯ï¼Œéœ€åœ¨æœ€åçš„é”™è¯¯æ•è·ä¸­é—´ä»¶å¤„ç†ã€‚\nconst express = require(\u0026#39;express\u0026#39;) const router = express.Router() const user_handler = require(\u0026#39;../router_handler/user\u0026#39;) // å¯¼å…¥ç”¨æˆ·è·¯ç”±å¤„ç†å‡½æ•°å¯¹åº”çš„æ¨¡å— const expressJoi = require(\u0026#39;@escook/express-joi\u0026#39;) // 1. å¯¼å…¥éªŒè¯æ•°æ®çš„ä¸­é—´ä»¶ const { reg_login_schema } = require(\u0026#39;../schema/user\u0026#39;) // 2. å¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡ // æ³¨å†Œæ–°ç”¨æˆ· router.post(\u0026#39;/reguser\u0026#39;, expressJoi(reg_login_schema), user_handler.regUser) // ç™»å½• router.post(\u0026#39;/login\u0026#39;, expressJoi(reg_login_schema), user_handler.login) module.exports = router é”™è¯¯å¤„ç†å‡½æ•° // å®šä¹‰é”™è¯¯çº§åˆ«çš„ä¸­é—´ä»¶ app.use((err, req, res, next) =\u0026gt; { // åˆ¤æ–­æ˜¯å¦æ˜¯éªŒè¯å¤±è´¥å¯¼è‡´çš„é”™è¯¯ if (err instanceof joi.ValidationError) return res.cc(err) // èº«ä»½è®¤è¯å¤±è´¥åçš„é”™è¯¯ if (err.name === \u0026#39;UnauthorizedError\u0026#39;) return res.cc(\u0026#39;èº«ä»½è®¤è¯å¤±è´¥ï¼\u0026#39;) // æœªçŸ¥çš„é”™è¯¯ res.cc(err) }) âš ï¸ Caution å¯¹åˆ†æ”¯å¤„ç†éœ€è¦ä½¿ç”¨ return æå‰ç»ˆæ­¢ï¼Œå¦åˆ™æŠ¥é”™ã€‚\nğŸ“ Note é‡ç½®å¯†ç \né‡ç½®å¯†ç  3.3.0 å®ç°æ­¥éª¤ å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•° éªŒè¯è¡¨å•æ•°æ® å®ç°é‡ç½®å¯†ç çš„åŠŸèƒ½ 3.3.1 å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•° åœ¨ /router/userinfo.js æ¨¡å—ä¸­ï¼Œæ–°å¢ é‡ç½®å¯†ç  çš„è·¯ç”±ï¼š // é‡ç½®å¯†ç çš„è·¯ç”± router.post(\u0026#39;/updatepwd\u0026#39;, userinfo_handler.updatePassword) åœ¨ /router_handler/userinfo.js æ¨¡å—ä¸­ï¼Œå®šä¹‰å¹¶å‘å¤–å…±äº« é‡ç½®å¯†ç  çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼š // é‡ç½®å¯†ç çš„å¤„ç†å‡½æ•° exports.updatePassword = (req, res) =\u0026gt; { res.send(\u0026#39;ok\u0026#39;) } 3.3.2 éªŒè¯è¡¨å•æ•°æ® æ ¸å¿ƒéªŒè¯æ€è·¯ï¼šæ—§å¯†ç ä¸æ–°å¯†ç ï¼Œå¿…é¡»ç¬¦åˆå¯†ç çš„éªŒè¯è§„åˆ™ï¼Œå¹¶ä¸”æ–°å¯†ç ä¸èƒ½ä¸æ—§å¯†ç ä¸€è‡´ï¼\nåœ¨ /schema/user.js æ¨¡å—ä¸­ï¼Œä½¿ç”¨ exports å‘å¤–å…±äº«å¦‚ä¸‹çš„ éªŒè¯è§„åˆ™å¯¹è±¡ ï¼š // éªŒè¯è§„åˆ™å¯¹è±¡ - é‡ç½®å¯†ç  exports.update_password_schema = { body: { // ä½¿ç”¨ password è¿™ä¸ªè§„åˆ™ï¼ŒéªŒè¯ req.body.oldPwd çš„å€¼ oldPwd: password, // ä½¿ç”¨ joi.not(joi.ref(\u0026#39;oldPwd\u0026#39;)).concat(password) è§„åˆ™ï¼ŒéªŒè¯ req.body.newPwd çš„å€¼ // è§£è¯»ï¼š // 1. joi.ref(\u0026#39;oldPwd\u0026#39;) è¡¨ç¤º newPwd çš„å€¼å¿…é¡»å’Œ oldPwd çš„å€¼ä¿æŒä¸€è‡´ // 2. joi.not(joi.ref(\u0026#39;oldPwd\u0026#39;)) è¡¨ç¤º newPwd çš„å€¼ä¸èƒ½ç­‰äº oldPwd çš„å€¼ // 3. .concat() ç”¨äºåˆå¹¶ joi.not(joi.ref(\u0026#39;oldPwd\u0026#39;)) å’Œ password è¿™ä¸¤æ¡éªŒè¯è§„åˆ™ newPwd: joi.not(joi.ref(\u0026#39;oldPwd\u0026#39;)).concat(password), }, } åœ¨ /router/userinfo.js æ¨¡å—ä¸­ï¼Œå¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡ï¼š // å¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡ const { update_userinfo_schema, update_password_schema } = require(\u0026#39;../schema/user\u0026#39;) å¹¶åœ¨ é‡ç½®å¯†ç çš„è·¯ç”± ä¸­ï¼Œä½¿ç”¨ update_password_schema è§„åˆ™éªŒè¯è¡¨å•çš„æ•°æ®ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š router.post(\u0026#39;/updatepwd\u0026#39;, expressJoi(update_password_schema), userinfo_handler.updatePassword) å®ç°é‡ç½®å¯†ç \næ ¹æ® id æŸ¥è¯¢ç”¨æˆ·æ˜¯å¦å­˜åœ¨ï¼š // å®šä¹‰æ ¹æ® id æŸ¥è¯¢ç”¨æˆ·æ•°æ®çš„ SQL è¯­å¥ const sql = `select * from ev_users where id=?` // æ‰§è¡Œ SQL è¯­å¥æŸ¥è¯¢ç”¨æˆ·æ˜¯å¦å­˜åœ¨ // express-jwt å°†è§£æåˆ°çš„æ•°æ®æŒ‚è½½åœ¨ req.user ä¸Š db.query(sql, req.user.id, (err, results) =\u0026gt; { // æ‰§è¡Œ SQL è¯­å¥å¤±è´¥ if (err) return res.cc(err) // æ£€æŸ¥æŒ‡å®š id çš„ç”¨æˆ·æ˜¯å¦å­˜åœ¨ if (results.length !== 1) return res.cc(\u0026#39;ç”¨æˆ·ä¸å­˜åœ¨ï¼\u0026#39;) // TODOï¼šåˆ¤æ–­æäº¤çš„æ—§å¯†ç æ˜¯å¦æ­£ç¡® }) åˆ¤æ–­æäº¤çš„ æ—§å¯†ç  æ˜¯å¦æ­£ç¡®ï¼š // åœ¨å¤´éƒ¨åŒºåŸŸå¯¼å…¥ bcryptjs åï¼Œ // å³å¯ä½¿ç”¨ bcrypt.compareSync(æäº¤çš„å¯†ç ï¼Œæ•°æ®åº“ä¸­çš„å¯†ç ) æ–¹æ³•éªŒè¯å¯†ç æ˜¯å¦æ­£ç¡® // compareSync() å‡½æ•°çš„è¿”å›å€¼ä¸ºå¸ƒå°”å€¼ï¼Œtrue è¡¨ç¤ºå¯†ç æ­£ç¡®ï¼Œfalse è¡¨ç¤ºå¯†ç é”™è¯¯ const bcrypt = require(\u0026#39;bcryptjs\u0026#39;) // åˆ¤æ–­æäº¤çš„æ—§å¯†ç æ˜¯å¦æ­£ç¡® const compareResult = bcrypt.compareSync(req.body.oldPwd, results[0].password) if (!compareResult) return res.cc(\u0026#39;åŸå¯†ç é”™è¯¯ï¼\u0026#39;) å¯¹æ–°å¯†ç è¿›è¡Œ bcrypt åŠ å¯†ä¹‹åï¼Œæ›´æ–°åˆ°æ•°æ®åº“ä¸­ï¼š // å®šä¹‰æ›´æ–°ç”¨æˆ·å¯†ç çš„ SQL è¯­å¥ const sql = `update ev_users set password=? where id=?` // å¯¹æ–°å¯†ç è¿›è¡Œ bcrypt åŠ å¯†å¤„ç† const newPwd = bcrypt.hashSync(req.body.newPwd, 10) // æ‰§è¡Œ SQL è¯­å¥ï¼Œæ ¹æ® id æ›´æ–°ç”¨æˆ·çš„å¯†ç  db.query(sql, [newPwd, req.user.id], (err, results) =\u0026gt; { // SQL è¯­å¥æ‰§è¡Œå¤±è´¥ if (err) return res.cc(err) // SQL è¯­å¥æ‰§è¡ŒæˆåŠŸï¼Œä½†æ˜¯å½±å“è¡Œæ•°ä¸ç­‰äº 1 if (results.affectedRows !== 1) return res.cc(\u0026#39;æ›´æ–°å¯†ç å¤±è´¥ï¼\u0026#39;) // æ›´æ–°å¯†ç æˆåŠŸ res.cc(\u0026#39;æ›´æ–°å¯†ç æˆåŠŸï¼\u0026#39;, 0) }) ","date":"2023-03-20","section":"techs","summary":"Express Express æ˜¯åŸºäºNode.js å¹³å°çš„ä¸€ä¸ªå¿«é€Ÿã€å¼€æ”¾ã€æç®€çš„ Web å¼€å‘æ¡†æ¶ï¼ŒåŸºäºå†…ç½®çš„ http æ¨¡å—è¿›ä¸€æ­¥å°è£…å‡ºæ¥ï¼Œèƒ½å¤Ÿæå¤§åœ°æé«˜å¼€å‘æ•ˆç‡ã€‚å…¶æœ¬è´¨å°±æ˜¯ä¸€ä¸ª npm ä¸Šçš„ç¬¬ä¸‰æ–¹åŒ…ï¼Œæä¾›äº†å¿«é€Ÿåˆ›å»º Web æœåŠ¡å™¨çš„ä¾¿æ·æ–¹æ³•ã€‚\nå¯¹äºå‰ç«¯ç¨‹åºå‘˜æ¥è¯´ï¼Œæœ€å¸¸è§çš„ä¸¤ç§æœåŠ¡å™¨ï¼Œåˆ†åˆ«æ˜¯\nWeb ç½‘ç«™ æœåŠ¡å™¨ï¼šä¸“é—¨å¯¹å¤–æä¾› Web ç½‘é¡µèµ„æºçš„æœåŠ¡å™¨ API æ¥å£ æœåŠ¡å™¨ï¼šä¸“é—¨å¯¹å¤–æä¾› API æ¥å£çš„æœåŠ¡å™¨ ä½¿ç”¨ Express ï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿ã€å¿«é€Ÿçš„åˆ›å»º Web ç½‘ç«™çš„æœåŠ¡å™¨æˆ– API æ¥å£çš„æœåŠ¡å™¨ã€‚\nä½¿ç”¨ å®‰è£… å®‰è£… Express å¹¶å°†å…¶ä¿å­˜åˆ°ä¾èµ–åˆ—è¡¨ä¸­ã€‚å¦‚ä¸‹ï¼š\n$ npm install express åˆ›å»º const express = require(\u0026#39;express\u0026#39;); // å¯¼å…¥express const app = express(); // åˆ›å»ºwebæœåŠ¡å™¨ app.listen(80, () =\u0026gt; { // è°ƒç”¨listen() å¯åŠ¨æœåŠ¡å™¨ console.log(\u0026#39;express server running at http://127.0.0.1\u0026#39;) ); å¤„ç† /** * å‚æ•°1: å®¢æˆ·è¯·æ±‚çš„urlåœ°å€ * å‚æ•°2: è¯·æ±‚å¯¹åº”çš„å¤„ç†å™¨ * req: è¯·æ±‚å¯¹è±¡ * res: å“åº”å¯¹è±¡ ä¸¤è€…åŒ…å«äº†ä¸å“åº”ç›¸å…³çš„å±æ€§ä¸æ–¹æ³• */ app.get(\u0026#39;url\u0026#39;, function(req, res) { /*å¤„ç†å‡½æ•°*/ }) // ç›‘å¬ GET è¯·æ±‚ app.post(\u0026#39;url\u0026#39;, function(req, res) { /*å¤„ç†å‡½æ•°*/ }) // ç›‘å¬ POST è¯·æ±‚ app.post(\u0026#39;url\u0026#39;, function(req, res) { // é€šè¿‡ req.query å¯¹è±¡ï¼Œå¯ä»¥è®¿é—®åˆ°å®¢æˆ·ç«¯é€šè¿‡æŸ¥è¯¢å­—ç¬¦ä¸²çš„å½¢å¼ï¼Œå‘é€åˆ°æœåŠ¡å™¨çš„å‚æ•° console.log(req.query); // é€šè¿‡ req.params å¯¹è±¡ï¼Œå¯ä»¥è®¿é—®åˆ° URL ä¸­ï¼Œé€šè¿‡ : åŒ¹é…åˆ°çš„åŠ¨æ€å‚æ•° console.log(req.params); // å“åº”å®¢æˆ·ç«¯ // é€šè¿‡ res.send()æ–¹æ³•ï¼ŒæŠŠå¤„ç†å¥½çš„å†…å®¹å‘é€ç»™å®¢æˆ·ç«¯ res.send(data); }) const express = require(\u0026#39;express\u0026#39;) // 1. å¯¼å…¥ express const app = express() // 2. åˆ›å»º web æœåŠ¡å™¨ // 4. ç›‘å¬å®¢æˆ·ç«¯çš„ GET å’Œ POST è¯·æ±‚ï¼Œå¹¶å‘å®¢æˆ·ç«¯å“åº”å…·ä½“çš„å†…å®¹ app.get(\u0026#39;/user\u0026#39;, (req, res) =\u0026gt; { // è°ƒç”¨ express æä¾›çš„ res.send() æ–¹æ³•ï¼Œå‘å®¢æˆ·ç«¯å“åº”ä¸€ä¸ª JSON å¯¹è±¡ res.send({ name: \u0026#39;zs\u0026#39;, age: 20, gender: \u0026#39;ç”·\u0026#39; }) }) app.post(\u0026#39;/user\u0026#39;, (req, res) =\u0026gt; { // è°ƒç”¨ express æä¾›çš„ res.send() æ–¹æ³•ï¼Œå‘å®¢æˆ·ç«¯å“åº”ä¸€ä¸ª æ–‡æœ¬å­—ç¬¦ä¸² res.send(\u0026#39;è¯·æ±‚æˆåŠŸ\u0026#39;) }) app.get(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; { // é€šè¿‡ req.query å¯ä»¥è·å–åˆ°å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„ æŸ¥è¯¢å‚æ•° // æ³¨æ„ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œreq.query æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ console.log(req.query) res.send(req.query) }) // æ³¨æ„ï¼šè¿™é‡Œçš„ :id æ˜¯ä¸€ä¸ªåŠ¨æ€çš„å‚æ•° app.get(\u0026#39;/user/:ids/:username\u0026#39;, (req, res) =\u0026gt; { // req.params æ˜¯åŠ¨æ€åŒ¹é…åˆ°çš„ URL å‚æ•°ï¼Œé»˜è®¤ä¹Ÿæ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ console.log(req.params) res.send(req.params) }) // 3. å¯åŠ¨ web æœåŠ¡å™¨ app.listen(80, () =\u0026gt; { console.log(\u0026#39;express server running at http://127.0.0.1\u0026#39;) }) nodemon åœ¨ç¼–å†™è°ƒè¯• Node.js é¡¹ç›®çš„æ—¶å€™ï¼Œå¦‚æœä¿®æ”¹äº†é¡¹ç›®çš„ä»£ç ï¼Œéœ€è¦é¢‘ç¹çš„æ‰‹åŠ¨é‡æ–°å¯åŠ¨æœåŠ¡ï¼Œä½¿ç”¨ nodemon https://www.npmjs.com/package/nodemon å·¥å…·ï¼Œå®ƒèƒ½å¤Ÿç›‘å¬é¡¹ç›®æ–‡ä»¶çš„å˜åŠ¨ï¼Œå½“ä»£ç è¢«ä¿®æ”¹åï¼Œnodemon ä¼šè‡ªåŠ¨é‡å¯é¡¹ç›®ï¼Œæå¤§æ–¹ä¾¿äº†å¼€å‘å’Œè°ƒè¯•ã€‚\n","title":"11 Express","url":"/techs/11-express/"},{"content":"Database æ•°æ®åº“æ˜¯ä»¥ä¸€å®šæ–¹å¼å‚¨å­˜åœ¨ä¸€èµ·ã€èƒ½äºˆå¤šä¸ªç”¨æˆ·å…±äº«ã€å…·æœ‰å°½å¯èƒ½å°çš„å†—ä½™åº¦ã€ä¸åº”ç”¨ç¨‹åºå½¼æ­¤ç‹¬ç«‹çš„æ•°æ®é›†åˆã€‚ä¸€ä¸ªæ•°æ®åº“ç”±å¤šä¸ª è¡¨ç©ºé—´*^Tablespace^* æ„æˆã€‚\nå¸¸è§çš„æ•°æ®åº“æœ‰ï¼š\nMySQL - ç›®å‰ä½¿ç”¨æœ€å¹¿æ³›ã€æµè¡Œåº¦æœ€é«˜çš„å¼€æºå…è´¹æ•°æ®åº“ - Community + Enterprise\nMariaDB - MySQL çš„ fork\nOracle - ç”²éª¨æ–‡å…¬å¸æ•°æ®åº“äº§å“\nSQL Server\nMongodb - Community + Enterprise\nMySQL, Oracle, SQL Server æ•°æ®åº“å±äº ä¼ ç»Ÿå‹æ•°æ®åº“ ï¼Œåˆè¢«ç§°ä¸ºå…³ç³»å‹æ•°æ®åº“æˆ– SQL æ•°æ®åº“ï¼Œè¿™ä¸‰è€…çš„è®¾è®¡ç†å¿µç›¸åŒï¼Œç”¨æ³•ä¹Ÿæ¯”è¾ƒç±»ä¼¼ã€‚è€Œ Mongodb å±äº æ–°å‹æ•°æ®åº“ï¼Œåˆè¢«ç§°ä¸ºéå…³ç³»å‹æ•°æ®åº“æˆ– NoSQL æ•°æ®åº“ï¼Œå®ƒä»¬åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¼¥è¡¥äº†ä¼ ç»Ÿå‹æ•°æ®åº“çš„ç¼ºé™·ã€‚\næ¦‚å¿µ åœ¨ä¼ ç»Ÿå‹æ•°æ®åº“ä¸­ï¼Œæ•°æ®åº“çš„ç»„ç»‡ç»“æ„åˆ†ä¸º æ•°æ®åº“*^Database^* ã€æ•°æ®è¡¨*^Table^ã€æ•°æ®è¡Œ^Row^ã€å­—æ®µ^Field^* å››ä¸ªéƒ¨åˆ†ã€‚ä¸ Excel å¯¹åº”ï¼Œåˆ™æ˜¯ å·¥ä½œç°¿*^Workbook^ã€å·¥ä½œè¡¨^Worksheet^ã€æ¯ä¸€è¡Œæ•°æ®^Row^ã€åˆ—^Column^* ã€‚\nğŸ“ Note å®é™…å¼€å‘ä¸­åº“ã€è¡¨ã€è¡Œå’Œå­—æ®µçš„å…³ç³»\nåœ¨å®é™…é¡¹ç›®å¼€å‘ä¸­ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ¯ä¸ªé¡¹ç›®éƒ½å¯¹åº” ç‹¬ç«‹çš„æ•°æ®åº“ ä¸åŒçš„æ•°æ®ï¼Œè¦å­˜å‚¨åˆ°æ•°æ®åº“çš„ä¸åŒè¡¨ä¸­ã€‚ä¾‹å¦‚ï¼šç”¨æˆ·æ•°æ®å­˜å‚¨åˆ° users è¡¨ä¸­ï¼Œå›¾ä¹¦æ•°æ®å­˜å‚¨åˆ° books è¡¨ä¸­ æ¯ä¸ªè¡¨ä¸­å…·ä½“å­˜å‚¨å“ªäº›ä¿¡æ¯ï¼Œç”±å­—æ®µæ¥å†³å®šã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä¸º user è¡¨è®¾è®¡ id, username, password è¿™ä¸‰ä¸ªå­—æ®µ è¡¨ä¸­çš„è¡Œï¼Œä»£è¡¨æ¯ä¸€æ¡å…·ä½“çš„æ•°æ® MySQL å¯¹å¼€å‘äººå‘˜å¼€å§‹ï¼Œåªéœ€è¦å®‰è£… MySQL Server å’Œ MySQL Workbench è¿™ä¸¤ä¸ªè½¯ä»¶ï¼Œå³å¯æ»¡è¶³å¼€å‘éœ€è¦ã€‚\nMySQL Server - ä¸“é—¨ç”¨æ¥æä¾›æ•°æ®å­˜å‚¨å’ŒæœåŠ¡çš„è½¯ä»¶ My SQL Workbench - å¯è§†åŒ–çš„ MySQL ç®¡ç†å·¥å…·ï¼Œé€šè¿‡å®ƒå¯ä»¥æŸ¥çœ‹ç®¡ç†å­˜å‚¨çš„æ•°æ® ğŸ“ Note DataType æ•°æ®ç±»å‹ï¼š\nint - æ•´æ•° varchar(len) - å­—ç¬¦ä¸² tinyint(1) - å¸ƒå°”å€¼ ğŸ“ Note å­—æ®µçš„ç‰¹æ®Šæ ‡è¯†ï¼š\nPKPrimary Key - ä¸»é”®ï¼Œå”¯ä¸€æ ‡è¯† NNNot Null - å€¼ä¸å…è®¸ä¸ºç©º UQUnique - å€¼å”¯ä¸€ AIAuto Increment - è‡ªåŠ¨å¢é•¿ SQL SQLStructed Query Language æ˜¯ç»“æ„åŒ–æ•°æ®åº“ï¼Œä¸“é—¨ç”¨æ¥è®¿é—®å’Œå¤„ç†æ•°æ®åº“çš„ç¼–ç¨‹è¯­è¨€ï¼Œèƒ½å¤Ÿè®©æˆ‘ä»¬ä»¥ç¼–è¾‘çš„å½¢å¼ï¼Œæ“ä½œæ•°æ®åº“é‡Œé¢çš„æ•°æ®ã€‚æ³¨æ„åªèƒ½åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­ä½¿ç”¨ã€‚\nä¿®æ”¹æ•°æ®åº“ä¸»è¦æ˜¯ å¢INSERT INTOã€åˆ DELETE FROMã€æ”¹UPDATEã€æŸ¥SELECT ã€‚è¯­æ³•åŒ…æ‹¬ where æ¡ä»¶ã€and å’Œ or è¿ç®—ç¬¦ã€order by æ’åºã€count(*) å‡½æ•°ã€‚\nå¢åˆ æ”¹æŸ¥ æŸ¥ - SELECTÂ \u0026amp; from... -- è¿™æ˜¯æ³¨é‡Š -- ä» FROM æŒ‡å®šçš„ \u0026lt;è¡¨åç§°\u0026gt; ä¸­ï¼Œé€‰æ‹©å‡º \u0026lt;æ‰€æœ‰çš„\u0026gt; å‡½æ•°ã€‚ * è¡¨ç¤º \u0026lt;æ‰€æœ‰åˆ—\u0026gt; SELECT * FROM è¡¨åç§° -- ä» FROM æŒ‡å®šçš„ \u0026lt;è¡¨åç§°\u0026gt; ä¸­ï¼ŒæŸ¥è¯¢æŒ‡å®šåˆ—åç§°ï¼ˆå­—æ®µï¼‰çš„æ•°æ® SELECT åˆ—åç§°1, åˆ—åç§°2... FROM è¡¨åç§° -- é™åˆ¶è¾“å‡º 1000 è¡Œ SELECT åˆ—åç§°1, åˆ—åç§°2... FROM è¡¨åç§° LIMIT 0,1000 ğŸ“ Note SQL è¯­å¥ä¸­çš„å…³é”®å­—å¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼Œå³ SELECT ç­‰æ•ˆä¸º select\n-- å®é™…åº”ç”¨ -- é€šè¿‡ * æŠŠ users è¡¨ä¸­çš„æ‰€æœ‰æ•°æ®æŸ¥è¯¢å‡ºæ¥ SELECT * FROM users -- ä» users è¡¨ä¸­æŠŠ username å’Œ password å¯¹åº”çš„æ•°æ®æŸ¥è¯¢å‡ºæ¥ SELECT username, password FROM users å¢ - INSERT INTOÂ \u0026amp; values... -- å‘æŒ‡å®šçš„è¡¨ä¸­æ’å…¥å¦‚ä¸‹çš„å‡ åˆ—æ•°æ® -- åˆ—å’Œå€¼é€šè¿‡ table__name ä¸ values å¯¹åº” INSERT INTO table__name (åˆ—1. åˆ—2...) VALUES (å€¼1, å€¼2...) å®é™…åº”ç”¨ï¼š\n-- å‘ user è¡¨ä¸­æ’å…¥æ–°æ•°æ® -- å…¶ä¸­ username ä¸º tony stack ï¼Œpassword çš„å€¼ä¸º 123 INSERT INTO users (username, password) values (\u0026#39;tony stack\u0026#39;, 123) æ”¹ - UPDATEÂ \u0026amp; set...where... -- è¯­æ³•æ ‡è¯† -- 1. ç”¨ UPDATE æŒ‡å®šæ›´æ–°å“ªä¸ªè¡¨ä¸­çš„æ•°æ® -- 2. ç”¨ SET æŒ‡å®šåˆ—å¯¹åº”çš„æ–°å€¼ -- 3. ç”¨ WHERE æŒ‡å®šæ›´æ–°çš„æ¡ä»¶ UPDATE è¡¨åç§° SET åˆ—åç§° = æ–°å€¼ WHERE åˆ—åç§° = æŸå€¼ å®é™…åº”ç”¨ï¼š\n-- æŠŠ users è¡¨ä¸­ id ä¸º 7 çš„ç”¨æˆ·å¯†ç ï¼Œæ›´æ–°ä¸º 888888 UPDATE users SET password=\u0026#39;888888\u0026#39; WHERE id=7 â—ï¸ Warning å¦‚æœå¿˜è®° WHERE çš„é™åˆ¶æ¡ä»¶ï¼Œå°†ä¼šå¯¼è‡´æ•´å¼ è¡¨è¢«æ›´æ–°ã€‚\nåˆ  - DELETEÂ FROMÂ \u0026amp; where... -- åˆ é™¤ç¬¦åˆ WHERE æŒ‡å®šæ¡ä»¶çš„è¡¨ DELETE FROM è¡¨åç§° WHERE åˆ—åç§° = å€¼ å®é™…åº”ç”¨ï¼š\n-- åˆ é™¤ users è¡¨ä¸­ id ä¸º 4 çš„ç”¨æˆ· DELETE FROM users WHERE id=4 WHERE WHERE å­å¥ç”¨äºé™å®šé€‰æ‹©çš„æ ‡å‡†ã€‚åœ¨ SELECT, UPDATE, DELETE è¯­å¥ä¸­ï¼Œçš†å¯ä½¿ç”¨ WHERE å­å¥æ¥é™å®šé€‰æ‹©çš„æ ‡å‡†ã€‚\n-- æŸ¥è¯¢è¯­å¥ä¸­ WHERE æ¡ä»¶ SELECT åˆ—åç§° FROM è¡¨åç§° WHERE åˆ— è¿ç®—ç¬¦ å€¼ -- æ›´æ–°è¯­å¥ä¸­ WHERE æ¡ä»¶ UPDATE è¡¨åç§° SET åˆ—=æ–°å€¼ WHERE åˆ— è¿ç®—ç¬¦ å€¼ -- åˆ é™¤è¯­å¥ä¸­ WHERE æ¡ä»¶ DELETE FROM è¡¨åç§° WHERE åˆ— è¿ç®—ç¬¦ å€¼ ä½¿ç”¨ç¤ºä¾‹ï¼š\n-- æŸ¥è¯¢ username ä¸ç­‰äº admin çš„æ‰€æœ‰ç”¨æˆ· SELECT * FROM users WHERE name \u0026lt;\u0026gt; \u0026#39;admin\u0026#39; ğŸ“ Note ä»¥ä¸‹ è¿ç®—ç¬¦ å¯åœ¨ WHERE å­å¥ä¸­ä½¿ç”¨ç”¨æ¥é™å®šé€‰æ‹©çš„æ ‡å‡†ï¼š\næ“ä½œç¬¦ æè¿° = ç­‰äº \u0026lt;\u0026gt; ä¸ç­‰äº != ä¸ç­‰äº \u0026gt; å¤§äº \u0026lt; å°äº \u0026gt;= å¤§äºç­‰äº \u0026lt;= å°äºç­‰äº BETWEEN åœ¨æŸä¸ªèŒƒå›´å†… LIKE æœç´¢æŸç§æ¨¡å¼ ğŸ’¡ Trick Difference between SQL Not Equal Operator \u0026lt;\u0026gt; and !=\nWe can use both SQL Not Equal operators \u0026lt;\u0026gt; and != to do inequality test between two expressions. Both operators give the same output. The only difference is that \u0026lt;\u0026gt; is in line with the ISO standard while != does not follow ISO standard. You should use \u0026lt;\u0026gt; operator as it follows the ISO standard.\nAND \u0026amp; OR AND å’Œ OR å¯åœ¨ WHERE å­è¯­å¥ä¸­æŠŠä¸¤ä¸ªæˆ–å¤šä¸ªæ¡ä»¶ç»“åˆèµ·æ¥ã€‚\nAND è¡¨ç¤ºå¿…é¡»åŒæ—¶æ»¡è¶³å¤šä¸ªæ¡ä»¶ï¼Œç›¸å½“äº Javascript ä¸­çš„ \u0026amp;\u0026amp; è¿ç®—ç¬¦ã€‚ OR è¡¨ç¤ºåªéœ€æ»¡è¶³ä»»æ„ä¸€ä¸ªæ¡ä»¶å³å¯ï¼Œç›¸å½“äº Javascript ä¸­çš„ || è¿ç®—ç¬¦ã€‚ SELECT * FROM users NAME status=0 AND id\u0026lt;3 ORDERÂ BY ç”¨äºæ ¹æ®æŒ‡å®šçš„åˆ—å¯¹ç»“æœè¿›è¡Œæ’åºï¼Œé»˜è®¤æŒ‰ç…§ å‡åº æ’åºï¼Œå¯ä»¥çœç•¥ ASC å…³é”®å­— ã€‚ä½¿ç”¨ DESC å…³é”®å­—åˆ™è¿›è¡Œé™åºæ’åºã€‚\n-- ä»¥ä¸‹ä¸¤æ¡è¯­å¥é»˜è®¤ç­‰ä»· -- ORDER BY é»˜è®¤è¿›è¡Œå‡åºæ’åº -- ASC å…³é”®å­—ä»£è¡¨ç”Ÿåºæ’åº SELECT * FROM users ORDER BY status; SELECT * FROM users ORDER BY status ASC; ORDER BY æ”¯æŒå¤šé‡æ’åºï¼š\n-- å¯¹ users è¡¨ä¸­çš„æ•°æ®ï¼Œå…ˆæŒ‰ç…§ status è¿›è¡Œé™åºæ’åºï¼Œå†æŒ‰ç…§ username å­—æ¯çš„é¡ºåºï¼Œè¿›è¡Œå‡åºæ’åº -- DSC å…³é”®å­—ä»£è¡¨é™åºæ’åº SELECT * FROM users ORDER BY staus DESC, username ASC COUNT(*) æŸ¥è¯¢ user è¡¨ä¸­ status ä¸º 0 çš„æ€»æ•°æ®æ¡æ•°ï¼š\nSELECT COUNT(*) FROM users WHERE count=0 -- \u0026gt;\u0026gt; 2 ä½¿ç”¨ AS ç»™æŸ¥è¯¢å‡ºæ¥çš„åˆ—åè®¾ç½®åˆ«åï¼š\nSELECT COUNT(*) as total FROM users WHERE status=0 æ“ä½œ åœ¨ Express ä¸­è¯»å–æ•°æ®åº“ï¼š\nnpm install å®‰è£…æ“ä½œ MySQL æ•°æ®åº“ä¸­çš„ç¬¬ä¸‰æ–¹æ¨¡å— mysql é€šè¿‡ mysql æ¨¡å—è¿æ¥åˆ°æ•°æ®åº“ é€šè¿‡ mysql æ‰§è¡Œ SQL è¯­å¥ åœ¨æ“ä½œæ•°æ®åº“ä¹‹å‰ï¼Œå¿…é¡»å…ˆå¯¹ mysql æ¨¡å—è¿›è¡Œå¿…è¦çš„é…ç½®ï¼Œä¸»è¦çš„é…ç½®æ­¥éª¤å¦‚ä¸‹ï¼š\n// 1. å¯¼å…¥ mysql æ¨¡å— const mysql = require(\u0026#39;mysql\u0026#39;) // 2. å»ºç«‹ä¸ MySQL æ•°æ®åº“çš„è¿æ¥å…³ç³» const db = mysql.createPool({ host: \u0026#39;127.0.0.1\u0026#39;, // æ•°æ®åº“çš„ IP åœ°å€ user: \u0026#39;root\u0026#39;, // ç™»å½•æ•°æ®åº“çš„è´¦å· password: \u0026#39;admin123\u0026#39;, // ç™»å½•æ•°æ®åº“çš„å¯†ç  database: \u0026#39;my_db_01\u0026#39; // æŒ‡å®šè¦æ“ä½œå“ªä¸ªæ•°æ®åº“ }) æµ‹è¯• mysql æ¨¡å—èƒ½å¦æ­£å¸¸å·¥ä½œï¼š\ndb.query(\u0026#39;select 1\u0026#39;, (err, results) =\u0026gt; { // mysql æ¨¡å—å·¥ä½œæœŸé—´æŠ¥é”™äº† if (err) return console.log(err.message) // èƒ½å¤ŸæˆåŠŸçš„æ‰§è¡Œ SQL è¯­å¥ console.log(results) // [ RowDataPacket { \u0026#39;1\u0026#39;: 1 } ] }) æŸ¥ï¼š\n// 2. æŸ¥è¯¢ users è¡¨ä¸­æ‰€æœ‰çš„æ•°æ® sqlStr = \u0026#39;select * from users\u0026#39; db.query(sqlStr, (err, results) =\u0026gt; { // æŸ¥è¯¢æ•°æ®å¤±è´¥ if (err) return console.log(err.message) // æŸ¥è¯¢æ•°æ®æˆåŠŸ // æ³¨æ„ï¼šå¦‚æœæ‰§è¡Œçš„æ˜¯ select æŸ¥è¯¢è¯­å¥ï¼Œåˆ™æ‰§è¡Œçš„ç»“æœæ˜¯æ•°ç»„ console.log(results) /** * [ * RowDataPacket { * id: 1, * username: \u0026#39;zhangsan\u0026#39;, * password: \u0026#39;123456\u0026#39;, * status: 0 * }, * RowDataPacket { * id: 2, * username: \u0026#39;lisi\u0026#39;, * password: \u0026#39;abc123\u0026#39;, * status: 0 * } * ] */ }) å¢ï¼š\n// 3. å‘ users è¡¨ä¸­ï¼Œæ–°å¢ä¸€æ¡æ•°æ®ï¼Œå…¶ä¸­ username çš„å€¼ä¸º Spider-Manï¼Œpassword çš„å€¼ä¸º pcc123 let user user = { username: \u0026#39;Spider-Man\u0026#39;, password: \u0026#39;pcc123\u0026#39; } // å®šä¹‰å¾…æ‰§è¡Œçš„ SQL è¯­å¥ï¼Œå…¶ä¸­ ? è¡¨ç¤ºå ä½ç¬¦ sqlStr = \u0026#39;insert into users (username, password) values (?, ?)\u0026#39; // æ‰§è¡Œ SQL è¯­å¥ï¼Œä½¿ç”¨æ•°ç»„çš„å½¢å¼ä¼ å…¥ ? å ä½ç¬¦å…·ä½“å€¼ db.query(sqlStr, [user.username, user.password], (err, results) =\u0026gt; { // æ‰§è¡Œ SQL è¯­å¥å¤±è´¥äº† if (err) return console.log(err.message) // æˆåŠŸäº† // æ³¨æ„ï¼šå¦‚æœæ‰§è¡Œçš„æ˜¯ insert into æ’å…¥è¯­å¥ï¼Œåˆ™ results æ˜¯ä¸€ä¸ªå¯¹è±¡ // å¯ä»¥é€šè¿‡ affectedRows å±æ€§ï¼Œæ¥åˆ¤æ–­æ˜¯å¦æ’å…¥æ•°æ®æˆåŠŸ if (results.affectedRows === 1) { console.log(\u0026#39;æ’å…¥æ•°æ®æˆåŠŸ!\u0026#39;) // æ’å…¥æ•°æ®æˆåŠŸ! } }) // æ¼”ç¤ºæ’å…¥æ•°æ®çš„ä¾¿æ·æ–¹å¼ user = { username: \u0026#39;Spider-Man2\u0026#39;, password: \u0026#39;pcc4321\u0026#39; } // å®šä¹‰å¾…æ‰§è¡Œçš„ SQL è¯­å¥ sqlStr = \u0026#39;insert into users set ?\u0026#39; // æ‰§è¡Œ SQL è¯­å¥ db.query(sqlStr, user, (err, results) =\u0026gt; { if (err) return console.log(err.message) if (results.affectedRows === 1) { console.log(\u0026#39;æ‰¹é‡æ’å…¥æ•°æ®æˆåŠŸ\u0026#39;) } }) æ”¹ï¼š\n// 4. æ¼”ç¤ºå¦‚ä½•æ›´æ–°ç”¨æˆ·çš„ä¿¡æ¯ user = { id: 6, username: \u0026#39;aaa\u0026#39;, password: \u0026#39;000\u0026#39; } // å®šä¹‰ SQL è¯­å¥ sqlStr = \u0026#39;update users set username=?, password=? where id=?\u0026#39; // æ‰§è¡Œ SQL è¯­å¥ db.query(sqlStr, [user.username, user.password, user.id], (err, results) =\u0026gt; { if (err) return console.log(err.message) // æ³¨æ„ï¼šæ‰§è¡Œäº† update è¯­å¥ä¹‹åï¼Œæ‰§è¡Œçš„ç»“æœï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡ affectedRows åˆ¤æ–­æ˜¯å¦æ›´æ–°æˆåŠŸ if (results.affectedRows === 1) { console.log(\u0026#39;æ›´æ–°æˆåŠŸ\u0026#39;) } }) // æ¼”ç¤ºæ›´æ–°æ•°æ®çš„ä¾¿æ·æ–¹å¼ user = { id: 6, username: \u0026#39;aaaa\u0026#39;, password: \u0026#39;0000\u0026#39; } // å®šä¹‰ SQL è¯­å¥ sqlStr = \u0026#39;update users set ? where id=?\u0026#39; // æ‰§è¡Œ SQL è¯­å¥ db.query(sqlStr, [user, user.id], (err, results) =\u0026gt; { if (results.affectedRows === 1) { console.log(\u0026#39;æ‰¹é‡æ›´æ–°æ•°æ®æˆåŠŸ\u0026#39;) } else { console.log(\u0026#39;æ‰¹é‡æ›´æ–°æ•°æ®å¤±è´¥\u0026#39;) if (err) return console.log(err.message) } }) åˆ ï¼š\n// 5. åˆ é™¤ id ä¸º 5 çš„ç”¨æˆ· sqlStr = \u0026#39;delete from users where id=?\u0026#39; db.query(sqlStr, 5, (err, results) =\u0026gt; { if (err) return console.log(err.message) // æ³¨æ„ï¼šæ‰§è¡Œ delete è¯­å¥ä¹‹åï¼Œç»“æœä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿä¼šåŒ…å« affectedRows å±æ€§ if (results.affectedRows === 1) { console.log(\u0026#39;åˆ é™¤æ•°æ®æˆåŠŸ\u0026#39;) } else { console.log(\u0026#39;æ›´æ–°æ•°æ®å¤±è´¥\u0026#39;) if (err) return console.log(err.message) } }) ä½¿ç”¨ DELETE è¯­å¥ï¼Œä¼šçœŸæ­£æŠŠæ•°æ®ä»è¡¨ä¸­åˆ é™¤ã€‚ä¸ºäº†ä¿é™©èµ·è§ï¼Œæ¨èä½¿ç”¨æ ‡è®°åˆ é™¤çš„å½¢å¼ï¼Œæ¥æ¨¡æ‹Ÿåˆ é™¤çš„åŠ¨ä½œã€‚æ‰€è°“çš„æ ‡è®°åˆ é™¤ï¼Œæ—¢æ˜¯åœ¨è¡¨ä¸­è®¾ç½® status è¿™æ ·çš„çŠ¶æ€å­—æ®µï¼Œæ¥æ ‡è®°å½“å‰å­—æ®µæ˜¯å¦è¢«è½¯åˆ é™¤ã€‚\nå½“ç”¨æˆ·æ‰§è¡Œåˆ é™¤çš„åŠ¨ä½œæ—¶ï¼Œå®é™…æ‰§è¡Œçš„æ˜¯ UPDATEÂ è¯­å¥ï¼Œå°†å¯¹åº”å­—æ®µ statusÂ æ ‡è®°ä¸ºåˆ é™¤ã€‚\n// æ ‡è®°åˆ é™¤ sqlStr = \u0026#39;update users set status=? where id=?\u0026#39; db.query(sqlStr, [1, 6], (err, results) =\u0026gt; { if (err) return console.log(err.message) if (results.affectedRows === 1) { console.log(\u0026#39;æ ‡è®°åˆ é™¤æˆåŠŸ\u0026#39;) } }) ","date":"2023-03-20","section":"techs","summary":"Database æ•°æ®åº“æ˜¯ä»¥ä¸€å®šæ–¹å¼å‚¨å­˜åœ¨ä¸€èµ·ã€èƒ½äºˆå¤šä¸ªç”¨æˆ·å…±äº«ã€å…·æœ‰å°½å¯èƒ½å°çš„å†—ä½™åº¦ã€ä¸åº”ç”¨ç¨‹åºå½¼æ­¤ç‹¬ç«‹çš„æ•°æ®é›†åˆã€‚ä¸€ä¸ªæ•°æ®åº“ç”±å¤šä¸ª è¡¨ç©ºé—´*^Tablespace^* æ„æˆã€‚\nå¸¸è§çš„æ•°æ®åº“æœ‰ï¼š\nMySQL - ç›®å‰ä½¿ç”¨æœ€å¹¿æ³›ã€æµè¡Œåº¦æœ€é«˜çš„å¼€æºå…è´¹æ•°æ®åº“ - Community + Enterprise\nMariaDB - MySQL çš„ fork\nOracle - ç”²éª¨æ–‡å…¬å¸æ•°æ®åº“äº§å“\nSQL Server\nMongodb - Community + Enterprise\nMySQL, Oracle, SQL Server æ•°æ®åº“å±äº ä¼ ç»Ÿå‹æ•°æ®åº“ ï¼Œåˆè¢«ç§°ä¸ºå…³ç³»å‹æ•°æ®åº“æˆ– SQL æ•°æ®åº“ï¼Œè¿™ä¸‰è€…çš„è®¾è®¡ç†å¿µç›¸åŒï¼Œç”¨æ³•ä¹Ÿæ¯”è¾ƒç±»ä¼¼ã€‚è€Œ Mongodb å±äº æ–°å‹æ•°æ®åº“ï¼Œåˆè¢«ç§°ä¸ºéå…³ç³»å‹æ•°æ®åº“æˆ– NoSQL æ•°æ®åº“ï¼Œå®ƒä»¬åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¼¥è¡¥äº†ä¼ ç»Ÿå‹æ•°æ®åº“çš„ç¼ºé™·ã€‚\næ¦‚å¿µ åœ¨ä¼ ç»Ÿå‹æ•°æ®åº“ä¸­ï¼Œæ•°æ®åº“çš„ç»„ç»‡ç»“æ„åˆ†ä¸º æ•°æ®åº“*^Database^* ã€æ•°æ®è¡¨*^Table^ã€æ•°æ®è¡Œ^Row^ã€å­—æ®µ^Field^* å››ä¸ªéƒ¨åˆ†ã€‚ä¸ Excel å¯¹åº”ï¼Œåˆ™æ˜¯ å·¥ä½œç°¿*^Workbook^ã€å·¥ä½œè¡¨^Worksheet^ã€æ¯ä¸€è¡Œæ•°æ®^Row^ã€åˆ—^Column^* ã€‚\nğŸ“ Note å®é™…å¼€å‘ä¸­åº“ã€è¡¨ã€è¡Œå’Œå­—æ®µçš„å…³ç³»\nåœ¨å®é™…é¡¹ç›®å¼€å‘ä¸­ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ¯ä¸ªé¡¹ç›®éƒ½å¯¹åº” ç‹¬ç«‹çš„æ•°æ®åº“ ä¸åŒçš„æ•°æ®ï¼Œè¦å­˜å‚¨åˆ°æ•°æ®åº“çš„ä¸åŒè¡¨ä¸­ã€‚ä¾‹å¦‚ï¼šç”¨æˆ·æ•°æ®å­˜å‚¨åˆ° users è¡¨ä¸­ï¼Œå›¾ä¹¦æ•°æ®å­˜å‚¨åˆ° books è¡¨ä¸­ æ¯ä¸ªè¡¨ä¸­å…·ä½“å­˜å‚¨å“ªäº›ä¿¡æ¯ï¼Œç”±å­—æ®µæ¥å†³å®šã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä¸º user è¡¨è®¾è®¡ id, username, password è¿™ä¸‰ä¸ªå­—æ®µ è¡¨ä¸­çš„è¡Œï¼Œä»£è¡¨æ¯ä¸€æ¡å…·ä½“çš„æ•°æ® MySQL å¯¹å¼€å‘äººå‘˜å¼€å§‹ï¼Œåªéœ€è¦å®‰è£… MySQL Server å’Œ MySQL Workbench è¿™ä¸¤ä¸ªè½¯ä»¶ï¼Œå³å¯æ»¡è¶³å¼€å‘éœ€è¦ã€‚\n","title":"12 Database","url":"/techs/12-database/"},{"content":"","date":"2023-03-20","section":"techs","summary":"","title":"13 BootStrap","url":"/techs/13-bootstrap/"},{"content":"JQuery JavaScript åº“ï¼šå³ library ï¼Œæ˜¯ä¸€ä¸ª å°è£… å¥½çš„ç‰¹å®šçš„ é›†åˆ ï¼ˆæ–¹æ³•å’Œå‡½æ•°ï¼‰ã€‚ä»å°è£…çš„è§’åº¦ç†è§£ï¼Œå°±æ˜¯å¯¹åŸç”Ÿ js ä»£ç å°è£…ï¼Œä½¿ç”¨æ—¶ç›´æ¥è°ƒç”¨å³å¯ã€‚\njQuery æ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´çš„ JavaScript åº“ï¼Œå…¶è®¾è®¡çš„å®—æ—¨æ˜¯ â€œWrite less, do moreâ€ ã€‚å®ƒå°è£…äº†å¸¸ç”¨çš„åŠŸèƒ½ä»£ç ï¼Œä¼˜åŒ–äº† DOM æ“ä½œã€äº‹ä»¶å¤„ç†ã€åŠ¨ç”»è®¾è®¡å’Œ AJAX äº¤äº’ã€‚\nå­¦ä¹  JQuery æœ¬è´¨å°±æ˜¯å­¦ä¹ è°ƒç”¨è¿™äº›å‡½æ•°çš„æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥éå¸¸æ–¹ä¾¿åœ°è°ƒç”¨å’Œä½¿ç”¨å®ƒï¼Œä»è€Œæé«˜å¼€å‘æ•ˆç‡ã€‚\nå¼ºå¤§çš„é€‰æ‹©å™¨\nå‡ºè‰²çš„ DOM æ“ä½œçš„å°è£…\nå¯é çš„äº‹ä»¶å¤„ç†æœºåˆ¶\nå®Œå–„çš„ Ajax\nä¸æ±¡æŸ“é¡¶çº§å˜é‡\nå‡ºè‰²çš„æµè§ˆå™¨å…¼å®¹æ€§\né“¾å¼æ“ä½œæ–¹å¼\néšå¼è¿­ä»£\nè¡Œä¸ºå±‚ä¸ç»“æ„å±‚åˆ†ç¦»\nä¸°å¯Œçš„æ’ä»¶æ”¯æŒ\nå®Œå–„çš„æ–‡æ¡£\nå¼€æº\nä¸æ±¡æŸ“é¡¶çº§å˜é‡\njQuery åªå»ºç«‹ä¸€ä¸ªåä¸º jQuery çš„å¯¹è±¡ï¼Œå…¶æ‰€æœ‰çš„å‡½æ•°æ–¹æ³•éƒ½åœ¨è¿™ä¸ªå¯¹è±¡ä¹‹ä¸‹ã€‚å…¶åˆ«å $ ä¹Ÿå¯ä»¥éšæ—¶äº¤å‡ºæ§åˆ¶æƒï¼Œç»å¯¹ä¸ä¼šæ±¡æŸ“å…¶ä»–å˜é‡ã€‚è¯¥ç‰¹æ€§ä½¿ jQuery å¯ä»¥ä¸å…¶ä»– JavaScript åº“å…±å­˜ã€‚\né“¾å¼æ“ä½œæ–¹å¼\njQuery çš„é“¾å¼æ“ä½œæ–¹å¼ï¼šå¯¹æ”¾ç”Ÿåœ¨åŒä¸€ä¸ª jQuery å¯¹è±¡ä¸Šçš„ä¸€ç»„åŠ¨ä½œï¼Œå¯ä»¥ç›´æ¥ è¿å†™ è€Œæ— éœ€é‡å¤è·å–å¯¹è±¡ã€‚ï¼ˆç”±è¿”å› this æŒ‡é’ˆå®ç°ï¼‰\néšå¼è¿­ä»£\nå½“ç”¨ jQuery æ‰¾åˆ°å¸¦æœ‰ â€œ.myClassâ€ ç±»çš„å…¨éƒ¨å…ƒç´ ï¼Œç„¶åéšè—å®ƒä»¬æ—¶ï¼Œæ— éœ€å¾ªç¯éå†æ¯ä¸€ä¸ªè¿”å›çš„å…ƒç´ ã€‚jQuery é‡Œçš„æ–¹æ³•éƒ½è¢«è®¾è®¡æˆè‡ªåŠ¨æ“ä½œå¯¹è±¡ é›†åˆ*^set^* ï¼Œè€Œä¸æ˜¯å•ç‹¬çš„å¯¹è±¡ã€‚\nä½¿ç”¨ jQuery 4 ä½¿ç”¨ esmodule è¿›è¡Œäº†é‡å†™ã€‚ä½¿ç”¨ npm è¿›è¡Œç®¡ç†çš„æ–¹æ³•ï¼Œå¯è§æ­¤ Gist ã€‚\nåœ¨ jQuery åº“ä¸­ï¼Œ$ å°±æ˜¯ jQuery çš„ä¸€ä¸ªç®€å†™å½¢å¼ï¼Œä¾‹å¦‚ $(#.foo) ä¸ jQuery(#.foo) æ˜¯ç­‰ä»·çš„ã€‚\nå…¥å£å‡½æ•° $(function (){ ...// æ­¤å¤„æ˜¯é¡µé¢DOMåŠ è½½å®Œæˆçš„å…¥å£ }) $(document).ready(function (){ ...// æ­¤å¤„æ˜¯é¡µé¢DOMåŠ è½½å®Œæˆçš„å…¥å£ }) ç­‰ç€ DOM ç»“æ„æ¸²æŸ“å®Œæ¯•å³å¯æ‰§è¡Œå†…éƒ¨ä»£ç ï¼Œä¸å¿…ç­‰åˆ°æ‰€æœ‰å¤–éƒ¨èµ„æºåŠ è½½å®Œæˆï¼ŒjQuery å¸®æˆ‘ä»¬å®Œæˆäº†å°è£… ç›¸å½“äºåŸç”Ÿ js ä¸­çš„ DOMContentLoaded ä¸åŒäºåŸç”Ÿ js ä¸­çš„ load äº‹ä»¶æ˜¯ç­‰é¡µé¢æ–‡æ¡£ã€å¤–éƒ¨çš„ js æ–‡ä»¶ã€css æ–‡ä»¶ã€å›¾ç‰‡åŠ è½½å®Œæ¯•æ‰æ‰§è¡Œå†…éƒ¨ä»£ç  :memo: Note window.onload å’Œ $(document).ready() å¯¹æ¯”\nwindow.onload $(document).ready() æ‰§è¡Œæ—¶é—´ å¿…é¡»ç­‰å¾…ç½‘é¡µä¸­æ‰€æœ‰çš„å†…å®¹åŠ è½½å®Œæ¯•ï¼ˆï¼‰åŒ…æ‹¬å›¾ç‰‡æ‰æ‰§è¡Œ åªéœ€è¦ DOM åŠ è½½å®Œå°±æ‰§è¡Œï¼ˆä¸åŒ…æ‹¬å›¾ç‰‡ç­‰ï¼‰ ç¼–å†™ä¸ªæ•° ä¸èƒ½åŒæ—¶ç¼–å†™å¤šä¸ª èƒ½åŒæ—¶ç¼–å†™å¤šä¸ª ç®€åŒ–å†™æ³• æ—  $(document).ready(function(){})* å¯ä»¥ç®€å†™æˆ *$(function(){}) é“¾å¼æ“ä½œ jQuery çš„é“¾å¼æ“ä½œæ–¹å¼ï¼šå¯¹å‘ç”Ÿåœ¨åŒä¸€ä¸ª jQuery å¯¹è±¡ä¸Šçš„ä¸€ç»„åŠ¨ä½œï¼Œå¯ä»¥ç›´æ¥ è¿å†™ è€Œæ— éœ€é‡å¤è·å–å¯¹è±¡ã€‚ ä¾‹å¦‚ï¼š\n$(this).addClass(\u0026#34;current\u0026#34;).next().show().parent().siblings().children(\u0026#34;a\u0026#34;).removeClass(\u0026#34;current\u0026#34;).next().hide(); ä¸ºäº†é˜…è¯»æ–¹ä¾¿ï¼Œä¹Ÿå¯ä»¥å°†ä»£ç æ”¹ä¸ºå¦‚ä¸‹æ ¼å¼ï¼š\n$(this).addClass(\u0026#34;current\u0026#34;) // ç»™å½“å‰å…ƒç´ æ·»åŠ  \u0026#34;current\u0026#34; æ ·å¼ .next().show() // ä¸‹ä¸€ä¸ªå…ƒç´ æ˜¾ç¤º .parent().siblings().children(\u0026#34;a\u0026#34;).removeClass(\u0026#34;current\u0026#34;) // çˆ¶å…ƒç´ çš„åŒè¾ˆå…ƒç´ çš„å­å…ƒç´  \u0026lt;a\u0026gt; ç§»é™¤ \u0026#34;current\u0026#34; æ ·å¼ .next().hide(); // ä»–ä»¬çš„ä¸‹ä¸€ä¸ªå…ƒç´ éšè— jQuery \u0026amp; DOM DOM å¯¹è±¡å°±æ˜¯ DOM æ ‘çš„èŠ‚ç‚¹ï¼Œé€šè¿‡åŸç”Ÿ JavaScript çš„ document.getElementsByTagName() æˆ–è€… getElementsByTagId() ç­‰è·å–ï¼ŒDOM å¯¹è±¡å¯ä»¥ä½¿ç”¨ JavaScript ä¸­çš„æ–¹æ³•ã€‚\njQuery å¯¹è±¡æ˜¯é€šè¿‡ jQuery åŒ…è£… DOM è¿‡åçš„å¯¹è±¡ã€‚\nåœ¨ jQuery å¯¹è±¡ä¸Šæ— æ³•ä½¿ç”¨ DOM å¯¹è±¡çš„ä»»ä½•æ–¹æ³•ï¼ŒåŒç†ï¼Œä¹Ÿä¸èƒ½åœ¨ DOM å¯¹è±¡ä¸Šä½¿ç”¨ä»»ä½• jQuery çš„æ–¹æ³•ã€‚æ‰€ä»¥æˆ‘ä»¬è¦åŒºåˆ†ä»€ä¹ˆæ˜¯ jQuery çš„æ–¹æ³•ï¼Œä»€ä¹ˆæ˜¯ JS åŸç”Ÿçš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢è¿™äº›éƒ½æ˜¯é”™è¯¯çš„ï¼š\n$(\u0026#34;#id\u0026#34;).innerHTML $(\u0026#34;#id\u0026#34;).checked document.getElementById(\u0026#34;id\u0026#34;).html() ä¸ºäº†èƒ½æ›´å¥½çš„åŒºåˆ†å“ªäº›æ˜¯ jQuery å“ªäº›æ˜¯ DOM å¯¹è±¡ï¼Œæˆ‘ä»¬çº¦å®šä¿—æˆä½¿ç”¨ jQuery è·å–çš„å¯¹è±¡æˆ‘ä»¬åœ¨å˜é‡å‰é¢åŠ ä¸Š $ ç¬¦å·ã€‚\njQuery =\u0026gt; DOM [index]æ–¹æ³•\nå°±æ˜¯åœ¨ jQuery å¯¹è±¡åé¢åŠ ä¸Š ç´¢å¼•[ ] ï¼Œæ¯”å¦‚ï¼š\nlet $cr = $(â€™#crâ€˜); // jQuery å¯¹è±¡ let cr = $cr[0]; // å°† jQuery è½¬åŒ–ä¸º DOM å¯¹è±¡ alert( cr.checked ); // æ£€æŸ¥æ˜¯å¦è½¬åŒ–æˆåŠŸ get(index) æ–¹æ³•\nvar $cr = $(â€™#crâ€˜); // jQuery å¯¹è±¡ var cr = $cr.get(0); // å°† jQuery è½¬åŒ–ä¸º DOM å¯¹è±¡ alert( cr.checked ); // æ£€æŸ¥æ˜¯å¦è½¬åŒ–æˆåŠŸ DOM =\u0026gt; jQuery DOM å¯¹è±¡è½¬åŒ–ä¸º jQuery å¯¹è±¡å¾ˆç®€å•ï¼Œåªéœ€è¦ç”¨ $() å°† DOM å¯¹è±¡åŒ…è£…èµ·æ¥å°±å¥½ã€‚\nvar cr = document.getElmentByID(\u0026#34;cr\u0026#34;); // DOM å¯¹è±¡ var $cr = $(cr) // å°† DOM å¯¹è±¡è½¬ä¸º jQuery å¯¹è±¡ è§£å†³ jQuery å’Œå…¶ä»–åº“çš„å†²çª ä¹‹å‰é‡åˆ°è¿‡ç±»ä¼¼çš„é—®é¢˜ï¼Œæ˜¯ä½¿ç”¨çš„æ’ä»¶éœ€è¦è¾ƒä½ç‰ˆæœ¬çš„ jQueryï¼ˆå› ä¸ºä¸è¿›è¡Œç»´æŠ¤äº†ï¼‰ï¼Œç„¶åå’Œé¡¹ç›®ä¸­ä½¿ç”¨çš„è¾ƒé«˜ç‰ˆæœ¬çš„ jQuery ä¸å…¼å®¹ï¼Œæ‰€ä»¥åœ¨ç½‘ä¸ŠæŸ¥åˆ°äº†ä¸€ä¸ªé¡¹ç›®ä¸­æ˜¯å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªä¸åŒç‰ˆæœ¬çš„ jQuery çš„ã€‚\nåœ¨ jQuery åº“ä¸­ï¼Œå‡ ä¹æ‰€æœ‰çš„æ’ä»¶éƒ½è¢«é™åˆ¶åœ¨å®ƒçš„ å‘½åç©ºé—´*^namespace^* é‡Œã€‚é€šå¸¸ï¼Œå…¨å±€å¯¹è±¡éƒ½è¢«å¾ˆå¥½åœ°å‚¨å­˜åœ¨ jQuery çš„å‘½åç©ºé—´é‡Œã€‚å› æ­¤å’Œå…¶ä»–åº“ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œä¸ä¼šå¼•èµ·å†²çªã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼ŒjQuery ç”¨ $ ä½œä¸ºè‡ªèº«çš„ å¿«æ·æ–¹å¼*^alias^* ã€‚\njQuery åº“åœ¨å…¶ä»–åº“ä¹‹åå¯¼å…¥\nåœ¨å…¶ä»–åº“å’Œ jQuery åº“éƒ½è¢«åŠ è½½å®Œæ¯•åï¼Œå¯ä»¥åœ¨ä»»ä½•æ—¶å€™è°ƒç”¨ jQuery.noConflict() å‡½æ¥å°†å˜é‡ $ çš„æ§åˆ¶æƒç§»äº¤ç»™å…¶ä»– JavaScript åº“ã€‚\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;script src=\u0026#34;jQuery.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; // å¼•å…¥ å…¶ä»– JS åº“ // å¼•å…¥ jQuery jQuery(function () { jQuery.noConflict(); // å°†å˜é‡ $ çš„æ§åˆ¶æƒç§»äº¤ç»™å…¶ä»– JS åº“ jQuery(\u0026#34;p\u0026#34;).click(function () { document.querySelector(\u0026#34;p\u0026#34;).innerText = `$ = ${$}`; }); }) document.querySelector(\u0026#34;p\u0026#34;).innerText = `$ = ${$}`; \u0026lt;/script\u0026gt; \u0026lt;!-- $ = function( selector, context ) { // The jQuery object is actually just the init constructor \u0026#39;enhanced\u0026#39; // Need init if jQuery is called (just allow error to be thrown if not included) return new jQuery.fn.init( selector, context ); } ==\u0026gt; jQuery.noConflict(); ==\u0026gt; $ = undefined --\u0026gt; ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªå¿«æ·æ–¹å¼ï¼š\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;script src=\u0026#34;jQuery.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; // å¼•å…¥ å…¶ä»– JS åº“ // å¼•å…¥ jQuery const $j = jQuery; $j.noConflict(); // å°†å˜é‡ $ çš„æ§åˆ¶æƒç§»äº¤ç»™å…¶ä»– JS åº“ $j(function () { $j(\u0026#34;p\u0026#34;).text(\u0026#39;changing inner text!\u0026#39;); }) \u0026lt;/script\u0026gt; å¦‚æœä½ è¿˜æƒ³ç»§ç»­ä½¿ç”¨ $ è€Œä¸ç®¡å…¶ä»–å‡½æ•°çš„ $() æ–¹æ³•ï¼ŒåŒæ—¶åˆä¸æƒ³ä¸å…¶ä»–åº“å†²çªï¼Œé‚£ä¹ˆä½ å¯ä»¥ï¼š\nconsole.log(jQuery.noConflict() === jQuery); // true // å°†å˜é‡ $ çš„æ§åˆ¶æƒç§»äº¤ç»™å…¶ä»– JS åº“ (function ($) { // å®šä¹‰åŒ¿åå‡½æ•°å¹¶è®¾ç½®å½¢å‚ $ $(\u0026#34;p\u0026#34;).click(function () { alert($(this).text()); }); }(jQuery)); // æ‰§è¡ŒåŒ¿åå‡½æ•°å¹¶ä¼ å…¥å½¢å‚ jQuery jQuery åº“åœ¨å…¶ä»–åº“ä¹‹å‰å¯¼å…¥\nå¦‚æœ jQuery åº“åœ¨å…¶ä»–åº“ä¹‹å‰å¯¼å…¥ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ jQuery æ¥åšä¸€äº› jQuery çš„å·¥ä½œï¼ŒåŒæ—¶å¯ä»¥ä½¿ç”¨ $() æ–¹æ³•ä½œä¸ºå…¶ä»–åº“çš„å¿«æ·æ–¹å¼ï¼ˆä¹Ÿå°±æ˜¯è¯´ä¸éœ€è¦å†™ jQuery.noConflict();ï¼‰\né€‰æ‹©å™¨ åŸºæœ¬é€‰æ‹©å™¨ é€‰æ‹©å™¨ æè¿° è¿”å› #id æ ¹æ®ç»™å®šçš„ ID åŒ¹é…ä¸€ä¸ªå…ƒç´  å•ä¸ªå…ƒç´  .class æ ¹æ®ç»™å®šçš„ç±»ååŒ¹é…ä¸€ä¸ªå…ƒç´  é›†åˆå…ƒç´  element æ ¹æ®ç»™å®šçš„å…ƒç´ ååŒ¹é…ä¸€ä¸ªå…ƒç´ ï¼ˆç›¸å½“äº tagName ï¼‰ é›†åˆå…ƒç´  * åŒ¹é…æ‰€æœ‰å…ƒç´  é›†åˆå…ƒç´  select1,select2,select3 å°†æ¯ä¸€ä¸ªé€‰æ‹©å™¨åŒ¹é…åˆ°çš„å…ƒç´ åˆå¹¶åä¸€èµ·è¿”å› é›†åˆå…ƒç´  å±‚æ¬¡é€‰æ‹©å™¨ é€‰æ‹©å™¨ æè¿° è¿”å› ancestor descendant^(ç©ºæ ¼)^ é€‰å– ancestor å…ƒç´ é‡Œæ‰€æœ‰çš„ descendantï¼ˆåä»£ï¼‰å…ƒç´  é›†åˆå…ƒç´  parent \u0026gt; child é€‰å–å­å…ƒç´  é›†åˆå…ƒç´  prev + next é€‰å–ç´§æ¥åœ¨ prev å…ƒç´ åé¢çš„ next å…ƒç´  é›†åˆå…ƒç´  prev + siblings é€‰å– prev å…ƒç´ ä¹‹åçš„æ‰€æœ‰ siblings å…ƒç´  é›†åˆå…ƒç´  è¿‡æ»¤é€‰æ‹©å™¨ ç±»ä¼¼ CSS :pseudo classã€‚\né€‰æ‹©å™¨ æè¿° è¿”å› :first é€‰å–ç¬¬ä¸€ä¸ªå…ƒç´  å•ä¸ªå…ƒç´  :last é€‰å–æœ€åä¸€ä¸ªå…ƒç´  å•ä¸ªå…ƒç´  :not(selector) å»é™¤æ‰€æœ‰ä¸ç»™å®šé€‰æ‹©å™¨åŒ¹é…çš„å…ƒç´  é›†åˆå…ƒç´  :even ç´¢å¼•ä¸ºå¶æ•°ï¼ˆç´¢å¼•ä» 0 å¼€å§‹ï¼‰ é›†åˆå…ƒç´  :odd ç´¢å¼•ä¸ºå¥‡æ•°ï¼ˆç´¢å¼•ä» 0 å¼€å§‹ï¼‰ é›†åˆå…ƒç´  :eq(index) ç´¢å¼•ç­‰äº index çš„å…ƒç´ ï¼ˆindex ä» 0 å¼€å§‹ï¼‰ å•ä¸ªå…ƒç´  :gt(index) ç´¢å¼•å¤§äº index é›†åˆå…ƒç´  :lt(index) ç´¢å¼•å°äº index é›†åˆå…ƒç´  :header(index) æ‰€æœ‰çš„æ ‡é¢˜å…ƒç´  h1ã€h2ã€h3 ç­‰ é›†åˆå…ƒç´  :animated æ­£åœ¨æ‰§è¡ŒåŠ¨ç”»çš„æ‰€æœ‰å…ƒç´  é›†åˆå…ƒç´  :focus å½“å‰è·å–ç„¦ç‚¹çš„å…ƒç´  é›†åˆå…ƒç´  å†…å®¹è¿‡æ»¤é€‰æ‹©å™¨ é€‰æ‹©å™¨ æè¿° è¿”å› :contains(text) æ–‡æœ¬ä¸­å«æœ‰ â€œtextâ€ çš„å…ƒç´  é›†åˆå…ƒç´  :empty ä¸åŒ…å«å­å…ƒç´ æˆ–è€…æ–‡æœ¬çš„ç©ºå…ƒç´  é›†åˆå…ƒç´  :has(selector) å«æœ‰é€‰æ‹©å™¨æ‰€åŒ¹é…çš„å…ƒç´  é›†åˆå…ƒç´  :parent å«æœ‰å­å…ƒç´ æˆ–æ–‡æœ¬ é›†åˆå…ƒç´  :hidden é€‰å–æ‰€æœ‰ä¸å¯è§çš„å…ƒç´  é›†åˆå…ƒç´  :visible é€‰å–æ‰€æœ‰å¯è§çš„å…ƒç´  é›†åˆå…ƒç´  å±æ€§è¿‡æ»¤é€‰æ‹©å™¨ åŒ CSS [attribute]ã€‚\né€‰æ‹©å™¨ æè¿° è¿”å› ç¤ºä¾‹ [attribute] æ‹¥æœ‰æ­¤å±æ€§çš„å…ƒç´  é›†åˆå…ƒç´  $(\u0026quot;div[id]\u0026quot;) é€‰æ‹©æ‰€æœ‰æ‹¥æœ‰ id å±æ€§çš„ div [attribute=value] å±æ€§çš„å€¼ä¸º value çš„å…ƒç´  é›†åˆå…ƒç´  $(\u0026quot;div[tittle = test]\u0026quot;) å±æ€§ title ä¸º test çš„ div [attribute!=value] å±æ€§çš„å€¼ä¸ä¸º value çš„å…ƒç´  é›†åˆå…ƒç´  $(\u0026quot;div[tittle != test]\u0026quot;) å±æ€§ title ä¸ä¸º test çš„ div [attribute^=value] å±æ€§çš„å€¼ä»¥ value å¼€å§‹çš„å…ƒç´  é›†åˆå…ƒç´  $(\u0026quot;div[tittle^ = test]\u0026quot;) å±æ€§ title ä»¥ test å¼€å§‹çš„ div [attribute$=value] å±æ€§çš„å€¼ä¸º value ç»“æŸçš„å…ƒç´  é›†åˆå…ƒç´  [attribute*=value] å±æ€§çš„å€¼å«æœ‰ value çš„å…ƒç´  é›†åˆå…ƒç´  [attributeï½œ=value] å±æ€§çš„å€¼ç­‰äºæˆ–è€…ä»¥è¯¥å­—ç¬¦ä¸²ä¸ºå‰ç¼€ï¼ˆè¯¥å­—ç¬¦åè·Ÿ - å­—ç¬¦ï¼‰çš„å…ƒç´  value çš„å…ƒç´  é›†åˆå…ƒç´  [attribute~=value] å±æ€§çš„ç”¨ç©ºæ ¼åˆ†éš”çš„å€¼ä¸­åŒ…å«ä¸€ä¸ªç»™å®šçš„ value é›†åˆå…ƒç´  [attribute][attrubute][attribute] ç”¨å±æ€§é€‰æ‹©å™¨åˆå¹¶æˆä¸€ä¸ªå¤åˆå±æ€§é€‰æ‹©å™¨ï¼Œæ»¡è¶³å¤šä¸ªæ¡ä»¶ï¼Œæ¯é€‰æ‹©ä¸€æ¬¡ï¼Œç¼©å°ä¸€æ¬¡èŒƒå›´ é›†åˆå…ƒç´  å­å…ƒç´ è¿‡æ»¤é€‰æ‹©å™¨ é€‰æ‹©å™¨ æè¿° è¿”å› :nth-child(index/even/odd/equation) é€‰å–æ¯ä¸ªçˆ¶å…ƒç´ ä¸‹çš„ç¬¬ index ä¸ªå­å…ƒ ç´ æˆ–è€…å¥‡å¶å…ƒç´ ï¼ˆindex ä» 1 å¼€å§‹ï¼‰ é›†åˆå…ƒç´  :first-child é€‰å–æ¯ä¸ªçˆ¶å…ƒç´ ç¬¬ä¸€ä¸ªå­å…ƒç´  é›†åˆå…ƒç´  :last-child é€‰å–æ¯ä¸ªçˆ¶å…ƒç´ æœ€åä¸€ä¸ªå­å…ƒç´  é›†åˆå…ƒç´  :only-child å¦‚æœæŸä¸ªå…ƒç´ æ˜¯å®ƒçˆ¶å…ƒç´ ä¸­å”¯ä¸€çš„å­å…ƒç´ ï¼Œåˆ™ä¼šè¢«åŒ¹é… é›†åˆå…ƒç´  è¡¨å•è¿‡æ»¤é€‰æ‹©å™¨ é€‰æ‹©å™¨ æè¿° è¿”å› :enabled é€‰å–æ‰€æœ‰å¯ç”¨å…ƒç´  é›†åˆå…ƒç´  :disable é€‰å–æ‰€æœ‰ä¸å¯ç”¨å…ƒç´  é›†åˆå…ƒç´  :checked é€‰å–æ‰€æœ‰è¢«é€‰ä¸­å…ƒç´ ï¼ˆå¤é€‰æ¡†ã€å•é€‰æ¡†ï¼‰ é›†åˆå…ƒç´  :selected é€‰å–æ‰€æœ‰è¢«é€‰ä¸­å…ƒç´ ï¼ˆä¸‹æ‹‰åˆ—è¡¨ï¼‰ é›†åˆå…ƒç´  è¡¨å•é€‰æ‹©å™¨ é€‰æ‹©å™¨ æè¿° è¿”å› :input é€‰å–æ‰€æœ‰çš„ \u0026lt;input\u0026gt; \u0026lt;textarea\u0026gt; \u0026lt;select\u0026gt; \u0026lt;button\u0026gt; é›†åˆå…ƒç´  :text é€‰æ‹©æ‰€æœ‰å•è¡Œæ–‡æœ¬æ¡† é›†åˆå…ƒç´  :password é€‰æ‹©æ‰€æœ‰çš„å¯†ç æ¡† é›†åˆå…ƒç´  :radio é€‰æ‹©æ‰€æœ‰çš„å•é€‰æ¡† é›†åˆå…ƒç´  :checkout é€‰æ‹©æ‰€æœ‰çš„å¤šé€‰æ¡† é›†åˆå…ƒç´  :submit é€‰æ‹©æ‰€æœ‰çš„æäº¤æŒ‰é’® é›†åˆå…ƒç´  :image é€‰æ‹©æ‰€æœ‰çš„å›¾åƒæŒ‰é’® é›†åˆå…ƒç´  :reset é€‰æ‹©æ‰€æœ‰çš„é‡ç½®æŒ‰é’® é›†åˆå…ƒç´  :button é€‰æ‹©æ‰€æœ‰çš„æŒ‰é’® é›†åˆå…ƒç´  :file é€‰æ‹©æ‰€æœ‰çš„ä¸Šä¼ åŸŸ é›†åˆå…ƒç´  :hidden é€‰æ‹©æ‰€æœ‰çš„ä¸å¯è§å…ƒç´  é›†åˆå…ƒç´  :memo: Note jQuery é€‰æ‹©å™¨å®Œå–„çš„å¤„ç†æœºåˆ¶\nå¦‚æœå…ƒç´ ä¸å­˜åœ¨æ—¶ï¼ŒJS ä¸ä¼šä¿å­˜é˜»å¡å…¶ä»–ä»£ç çš„è¿è¡Œã€‚\n$(#ID) æˆ–è€…å…¶ä»–é€‰æ‹©å™¨è·å–çš„æ°¸è¿œæ˜¯å¯¹è±¡ï¼Œå³ä½¿ç½‘é¡µä¸Šæ²¡æœ‰æ­¤å…ƒç´ ã€‚ä½¿ç”¨ jQuery æ£€æŸ¥æŸä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨è¦ä¸èƒ½ä½¿ç”¨\n// error if ($(#tt)) { dosomething } è€Œæ˜¯æ ¹æ®å…ƒç´ æ˜¯å¦æœ‰é•¿åº¦åˆ¤æ–­ï¼š\nif ($(#tt).length \u0026gt; 0) { dosomething } æˆ–è€…è½¬åŒ–ä¸º DOM å…ƒç´ æ¥åˆ¤æ–­\nif ($(#tt)[0]) { dosomething } DOM HTML æ’å…¥èŠ‚ç‚¹ æ–¹æ³• æè¿° ç¤ºä¾‹ append() å‘æ¯ä¸ªåŒ¹é…çš„å…ƒç´ å†…éƒ¨è¿½åŠ å†…å®¹ $(A).append(B) å°† B è¿½åŠ åˆ° A ä¸­ appendTo() å°†æ‰€æœ‰åŒ¹é…çš„å…ƒç´ è¿½åŠ åˆ°æŒ‡å®šå…ƒç´ ä¸­ $(B).appendTo(A) å°† B è¿½åŠ åˆ° A ä¸­ prepend() å‘æ¯ä¸ªåŒ¹é…çš„å…ƒç´ å†…éƒ¨å‰ç½®å†…å®¹ after() åœ¨æ¯ä¸ªåŒ¹é…çš„å…ƒç´ ä¹‹åæ’å…¥å†…å®¹ $(A).after(B) å°† B æ’å…¥åˆ° A åé¢ insertAfter() å°†æ‰€æœ‰åŒ¹é…çš„å…ƒç´ æ’å…¥åˆ°æŒ‡å®šå…ƒç´ çš„åé¢ $(B).insert After(A) å°† B æ’å…¥åˆ° A å before() åœ¨æ¯ä¸ªåŒ¹é…çš„å…ƒç´ ä¹‹å‰æ’å…¥å†…å®¹ $(A).before(B) å°† B æ’å…¥åœ¨ A çš„å‰é¢ insertBefore() å°†æ‰€æœ‰åŒ¹é…çš„å…ƒç´ æ’å…¥åˆ°æŒ‡å®šå…ƒç´ çš„å‰é¢ $(B).insertBefore(A) å°† B æ’å…¥åœ¨ A çš„å‰é¢ åˆ é™¤èŠ‚ç‚¹ \u0010Remove() ä» DOM ä¸­åˆ é™¤æ‰€æœ‰åŒ¹é…çš„å…ƒç´ ï¼Œä¼ å…¥çš„å‚æ•°ç”¨äºæ ¹æ® jQuery è¡¨è¾¾å¼æ¥åˆ é€‰å…ƒç´ ã€‚\n\u0026lt;ul\u0026gt; \u0026lt;li\u0026gt;1\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;2\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;script src=\u0026#34;../test.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; let $li = $(\u0026#34;ul li:eq(1)\u0026#34;).remove(); // è·å–ç¬¬äºŒä¸ª \u0026lt;li\u0026gt; å…ƒç´ èŠ‚ç‚¹åï¼Œå°†å®ƒä»ç½‘é¡µä¸­åˆ é™¤ $li.appendTo(\u0026#34;ul li\u0026#34;); // æŠŠåˆšæ‰åˆ é™¤çš„å…ƒç´ æ·»åŠ åˆ° \u0026lt;ul\u0026gt; å…ƒç´ ä¸­ console.log($li) \u0026lt;/script\u0026gt; è¿™ä¸ªæ–¹æ³•çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªæŒ‡å‘å·²è¢«åˆ é™¤çš„èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œå› æ­¤å¯ä»¥å°†å…¶ä¿å­˜åœ¨ä¸€ä¸ªå˜é‡ä¸­ï¼Œä»¥åè¿˜å¯ä»¥ä½¿ç”¨ã€‚\ndetach() detach() å’Œ delete() ä¸€æ ·ï¼Œä¹Ÿæ˜¯ä» DOM ä¸­å»æ‰æ‰€æœ‰åŒ¹é…çš„å…ƒç´ ï¼Œä½†æ˜¯ä¸¤è€…çš„åŒºåˆ«æ˜¯ï¼Œè¿™ä¸ªæ–¹æ³•ä¸ä¼šæŠŠåŒ¹é…çš„å…ƒç´ ä» jQuery å¯¹è±¡ä¸­åˆ é™¤ï¼Œå»æ‰çš„å…ƒç´ çš„æ‰€æœ‰ç»‘å®šçš„äº‹ä»¶ã€é™„åŠ çš„æ•°æ®ç­‰éƒ½ä¼šä¿ç•™ä¸‹æ¥ã€‚\nempty() æ¸…ç©ºå…ƒç´ ä¸­æ‰€æœ‰çš„ åä»£*^children^* èŠ‚ç‚¹ã€‚æ³¨æ„æ˜¯æ¸…ç©ºå…ƒç´ å†…çš„æ‰€æœ‰åä»£èŠ‚ç‚¹ï¼Œå¹¶ä¸æ¸…é™¤é€‰ä¸­çš„å…ƒç´ æœ¬èº«ã€‚\nå¤åˆ¶èŠ‚ç‚¹ å¤åˆ¶èŠ‚ç‚¹å¯ä»¥ä½¿ç”¨ clone() æ–¹æ³•\n$(\u0026#34;ul li\u0026#34;).click(function () { $(this).clone().appendTo(\u0026#34;ul\u0026#34;); }) ä½†æ˜¯è¿™æ ·å¤åˆ¶çš„èŠ‚ç‚¹ï¼Œè¢«å¤åˆ¶çš„æ–°å…ƒç´ å¹¶ä¸å…·æœ‰ä»»ä½•è¡Œä¸ºï¼Œå¦‚æœéœ€è¦æ–°å…ƒç´ ä¹Ÿå…·æœ‰ç›¸åŒçš„è¡Œä¸ºï¼Œé‚£ä¹ˆå°±éœ€è¦åœ¨ clone() æ–¹æ³•ä¸­ä¼ å…¥å‚æ•° true ã€‚\n$(\u0026#34;ul li\u0026#34;).click(function () { $(this).clone(true).appendTo(\u0026#34;ul\u0026#34;); }) å…¶ä»–æ–¹æ³• æ–¹æ³•å æè¿° replaceWith() å°†æ‰€æœ‰åŒ¹é…çš„å…ƒç´ éƒ½æ›¿æ¢æˆ HTML æˆ–è€… DOM å…ƒç´ ï¼Œç»‘å®šçš„äº‹ä»¶å°†ä¼šæ¶ˆå¤± replaceAll() å’Œ replaceWith() ç›¸å wrap() å°†æ‰€æœ‰çš„å…ƒç´ å•ç‹¬åŒ…è£¹ wrapAll() å°†æ‰€æœ‰åŒ¹é…çš„å…ƒç´ ç”¨ä¸€ä¸ªå…ƒç´ æ¥åŒ…è£¹\nå¦‚æœè¢«åŒ…è£¹çš„å…ƒç´ ä¸­é—´æœ‰å…¶ä»–çš„å…ƒç´ ï¼Œé‚£ä¹ˆå…¶ä»–çš„å…ƒç´ ä¼šè¢«æ”¾åˆ°åŒ…è£¹å…ƒç´ ä¹‹å wrapInner() å°†æ¯ä¸€ä¸ªåŒ¹é…çš„å…ƒç´ çš„å­—å†…å®¹ï¼ˆåŒ…æ‹¬æ–‡æœ¬èŠ‚ç‚¹ï¼‰ç”¨å…¶ä»–ç»“æ„åŒ–çš„æ ‡è®°åŒ…è£¹èµ·æ¥ attr() è·å–å’Œè®¾ç½®å…ƒç´ å±æ€§ï¼Œä¼ é€’ä¸€ä¸ªå‚æ•°ä¸ºè·å–å…ƒç´ å±æ€§ï¼Œä¼ é€’ä¸¤ä¸ªå‚æ•°ä¸ºè®¾ç½®å…ƒç´ å±æ€§ removeAttr() åˆ é™¤æ–‡æ¡£ä¸­æŸä¸ªå…ƒç´ çš„ç‰¹å®šå±æ€§ addClass() è¿½åŠ æ ·å¼ removeClass() ç§»é™¤æ ·å¼\nå¦‚æœå‚æ•°ä¸ºç©ºï¼Œåˆ™æ¸…ç©ºè¯¥å…ƒç´ çš„æ‰€æœ‰ class toggleClass() åˆ‡æ¢æ ·å¼\nå¦‚æœç±»åå­˜åœ¨åˆ™åˆ é™¤ï¼Œå¦‚æœç±»åä¸å­˜åœ¨åˆ™æ·»åŠ  hasClass() æ˜¯å¦å«æœ‰æŸä¸ªæ ·å¼ï¼Œè¿”å›å¸ƒå°”å€¼ html() è¯»å–æˆ–è€…è®¾ç½®æŸä¸ªå…ƒç´ ä¸­çš„ HTML å†…å®¹\nä¸å¸¦å‚æ•°ä¸ºè·å– HTML ä¸­çš„å†…å®¹ï¼Œä¼ é€’å‚æ•°ä¸ºè®¾ç½® HTML çš„å†…å®¹ text() è¯»å–æˆ–è€…è®¾ç½®æŸä¸ªå…ƒç´ ä¸­çš„æ–‡æœ¬å†…å®¹\nä¸å¸¦å‚æ•°ä¸ºè·å–æ–‡æœ¬ä¸­çš„å†…å®¹ï¼Œä¼ é€’å‚æ•°ä¸ºè®¾ç½®æ–‡æœ¬çš„å†…å®¹ val() è¯»å–æˆ–è®¾ç½®å…ƒç´ çš„å€¼\nåœ¨ç”¨äºè¡¨å•å…ƒç´ æ—¶ï¼Œå¯ä»¥è®¾ç½®ç›¸åº”çš„å…ƒç´ è¢«é€‰ä¸­ children() è·å¾—åŒ¹é…å…ƒç´ çš„å­å…ƒç´ çš„é›†åˆ ï¼ˆå­å…ƒç´ éåä»£å…ƒç´ ï¼‰ next() è·å¾—åŒ¹é…å…ƒç´ åé¢ç´§é‚»çš„åŒè¾ˆå…ƒç´  prev() è·å¾—åŒ¹é…å…ƒç´ å‰é¢ç´§é‚»çš„åŒè¾ˆå…ƒç´  siblings() è·å¾—åŒ¹é…å…ƒç´ å‰åé¢ç´§é‚»çš„åŒè¾ˆå…ƒç´  closest() å–å¾—æœ€è¿‘çš„åŒ¹é…å…ƒç´  parent() è·å¾—é›†åˆä¸­æ¯ä¸ªå…ƒç´ çš„çˆ¶çº§å…ƒç´  parents() è·å¾—é›†åˆä¸­æ¯ä¸ªå…ƒç´ çš„ç¥–å…ˆå…ƒç´  closest() ä»å…ƒç´ æœ¬èº«å¼€å§‹ï¼Œé€çº§å‘ä¸Šçº§å…ƒç´ åŒ¹é…ï¼Œå¹¶è¿”å›æœ€å…ˆåŒ¹é…çš„ç¥–å…ˆå…ƒç´  CSS åŸç”Ÿ JS ä¸­ className ä¼šè¦†ç›–å…ƒç´ åŸå…ˆçš„ç±»åï¼Œè€Œ jQuery åˆ™å¯ä»¥åªå¯¹æŒ‡å®šç±»è¿›è¡Œæ“ä½œè€Œä¸å½±å“åŸå…ˆçš„ç±»åã€‚\næ–¹æ³• æè¿° css() è¯»å–å’Œè®¾ç½® style å¯¹è±¡çš„å„ç§å±æ€§\n1. å¦‚æœå€¼æ˜¯æ•°å­—ï¼Œå°†ä¼šè‡ªåŠ¨è½¬åŒ–ä¸º åƒç´ å€¼*^px^*\n2. åœ¨ css() æ–¹æ³•ä¸­ï¼Œå¦‚æœå±æ€§å¸¦æœ‰ - ç¬¦å·ï¼Œä¾‹å¦‚ font-size / background-color ï¼Œå¦‚æœè®¾ç½®å±æ€§å€¼çš„æ—¶å€™ä¸å¸¦å¼•å·ï¼Œé‚£ä¹ˆå°±è¦ç”¨é©¼å³°å¼å†™æ³•ï¼š\ne.g.: $p.css({fontSize: \u0026ldquo;30px\u0026rdquo;, backgroundColor: \u0026ldquo;#888888\u0026rdquo;})\nå¦‚æœå¸¦ä¸Šå¼•å·ï¼Œåˆ™æ—¢å¯ä»¥å†™æˆ font-size ï¼Œä¹Ÿå¯ä»¥å†™æˆ fontSize\nè¿™æ˜¯å› ä¸º JSON è§„èŒƒä¸­ï¼Œé”®åæ˜¯ä¸èƒ½å‡ºç°çŸ­æ¨ªçš„ height()/\nwidth() è·å–å…ƒç´ çš„é«˜åº¦å’Œå®½åº¦\n1. è·å–çš„æ˜¯å®é™…å€¼ï¼Œå’Œæ ·å¼çš„è®¾ç½®æ— å…³ï¼Œå¹¶ä¸”ä¸å¸¦å•ä½\n2. å¯ä»¥è·å– window å’Œ document çš„å®½åº¦å’Œé«˜åº¦ offset() ä½œç”¨æ˜¯è·å–å…ƒç´ åœ¨å½“å‰è§†çª—ä¸­çš„ç›¸å¯¹åç§»\nè¿”å› top å’Œ left å±æ€§ position() è·å–å…ƒç´ ç›¸å¯¹ä¸Šä¸€ä¸ªå…·æœ‰ å®šä½ ^relative/absolute/fixed^ çš„å…ƒç´ çš„è·ç¦» scroolTop()/\nscroolleft() è·å–å…ƒç´ çš„æ»šåŠ¨æ¡çš„è· é¡¶ç«¯*^top^* çš„è·ç¦»å’Œ å·¦ä¾§*^left^* çš„è·ç¦» äº‹ä»¶*^event^* äº‹ä»¶ç»‘å®š $(\u0026#39;selector\u0026#39;).bind(type [, data], fn); ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯äº‹ä»¶ç±»å‹ï¼Œç±»å‹åŒ…æ‹¬ï¼šblur focus load resize scroll unload cliock dblclick mousedown mouseup mouseover mouseout mouseenter mouseleave change select submit keyup keydown keypress keyup error ç¬¬äºŒä¸ªå‚æ•°ä¸ºå¯é€‰å‚æ•°ï¼Œä½œä¸º event.data å±æ€§å€¼ä¼ é€’ç»™äº‹ä»¶å¯¹è±¡çš„é¢å¤–æ•°æ®å¯¹è±¡ ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ç”¨æ¥ç»‘å®šçš„å¤„ç†å‡½æ•° jQuery çš„äº‹ä»¶å¤„ç†å‡½æ•°æ¯” JS åŸç”Ÿçš„äº‹ä»¶å¤„ç†å‡½æ•°å°‘äº†ä¸ª on ã€‚\nåƒ click mouseover mouseout è¿™ç±»äº‹ä»¶ï¼Œå¯ä»¥ç›´æ¥ç®€å†™\n$(\u0026#39;#panel h5.head\u0026#39;).bind(\u0026#39;click\u0026#39;,_=\u0026gt;{ $(this).next().show(); // æ˜¾ç¤ºåŒçº§ä¸‹ä¸€ä¸ªå…ƒç´  }) åˆæˆäº‹ä»¶ jQuery ä¸­æœ‰ä¸¤ä¸ªåˆæˆäº‹ä»¶ï¼Œhover() toggle()\nhover() hover([enter], leave) hover(fn1,fn2,...fnN) æ–¹æ³•ç”¨äºæ¨¡æ‹Ÿå…‰æ ‡æ‚¬åœäº‹ä»¶ï¼Œå½“å…‰æ ‡ç§»åŠ¨åˆ°å…ƒç´ ä¸Šæ—¶ï¼Œä¼šè§¦å‘ç¬¬ä¸€ä¸ªå‡½æ•°*^enter^* ï¼Œå½“å…‰æ ‡ç§»å‡ºè¿™ä¸ªå…ƒç´ æ—¶ä¼šè§¦å‘ç¬¬äºŒä¸ªå‡½æ•°*^leave^* ã€‚\ntoggle() toggle() æ–¹æ³•ç”¨äºæ¨¡æ‹Ÿé¼ æ ‡çš„è¿ç»­ç‚¹å‡»äº‹ä»¶ï¼Œç¬¬ä¸€æ¬¡å•å‡»å…ƒç´ ï¼Œè§¦å‘ç¬¬ä¸€ä¸ªå‡½æ•°ï¼Œç¬¬äºŒæ¬¡å•å‡»åŒä¸€ä¸ªå…ƒç´ ï¼Œä¼šè§¦å‘ç¬¬äºŒä¸ªå‡½æ•°ï¼Œå¦‚æœæœ‰æ›´å¤šçš„å‡½æ•°ï¼Œåˆ™ä¾æ¬¡è§¦å‘ï¼Œç›´åˆ°æœ€åä¸€ä¸ªã€‚\näº‹ä»¶å†’æ³¡ å‡è®¾ç½‘é¡µä¸Šæœ‰ä¸¤ä¸ªå…ƒç´ ï¼Œå…¶ä¸­ä¸€ä¸ªåµŒå¥—åœ¨å¦ä¸€ä¸ªå…ƒç´ é‡Œé¢ï¼Œå¹¶ä¸”éƒ½è¢«ç»‘å®šäº† click äº‹ä»¶ã€‚åŒæ—¶ \u0026lt;body\u0026gt; å…ƒç´ ä¸Šä¹Ÿç»‘å®šäº† click äº‹ä»¶ï¼Œè¿™æ ·çš„è¯ï¼Œç‚¹å‡»æœ€å†…å±‚çš„å…ƒç´ ï¼Œä¼šè§¦å‘ä¸‰æ¬¡ click äº‹ä»¶ã€‚è¿™æ˜¯å› ä¸º JavaScript çš„äº‹ä»¶å†’æ³¡æœºåˆ¶ã€‚\nåœ¨ jQuery ä¸­ï¼Œæä¾›äº† stopPropagation() æ–¹æ³•æ¥åœæ­¢å†’æ³¡ã€‚\né˜»æ­¢é»˜è®¤è¡Œä¸º ç½‘é¡µä¸­æœ‰è‡ªå·±çš„é»˜è®¤è¡Œä¸ºï¼Œä¾‹å¦‚å•å‡»è¶…é“¾æ¥ä¼šè·³è½¬ï¼Œå•å‡»â€œæäº¤â€æŒ‰é’®åè¡¨å•ä¼šæäº¤ï¼Œæœ‰æ—¶éœ€è¦é˜»æ­¢é»˜è®¤è¡Œä¸ºã€‚\njQuery æä¾›äº† preventDefault() æ–¹æ³•æ¥é˜»æ­¢å…ƒç´ çš„é»˜è®¤è¡Œä¸ºã€‚\näº‹ä»¶å¯¹è±¡çš„å±æ€§ jQuery åœ¨éµå®ˆ W3C è§„èŒƒçš„æƒ…å†µä¸‹ï¼Œå¯¹äº‹ä»¶å¯¹è±¡çš„å¸¸ç”¨å±æ€§è¿›è¡Œäº†å°è£…ã€‚ä»¥ä¸‹æ˜¯ä¼ å…¥äº‹ä»¶å¤„ç†å‡½æ•° å‚æ•°*^e^* çš„å±æ€§ï¼š\n$(\u0026#39;ul li:first\u0026#39;).next().hide().prev() .click(function (e){ $(this).next().show().html( JSON.stringify(e) ); }) { \u0026#34;originalEvent\u0026#34;: { \u0026#34;isTrusted\u0026#34;: true }, \u0026#34;type\u0026#34;: \u0026#34;click\u0026#34;, \u0026#34;target\u0026#34;: { \u0026#34;jQuery360070762021604439211\u0026#34;: { \u0026#34;events\u0026#34;: { \u0026#34;click\u0026#34;: [{ \u0026#34;type\u0026#34;: \u0026#34;click\u0026#34;, \u0026#34;origType\u0026#34;: \u0026#34;click\u0026#34;, \u0026#34;data\u0026#34;: null, \u0026#34;guid\u0026#34;: 1, \u0026#34;namespace\u0026#34;: \u0026#34;\u0026#34; }] } } }, \u0026#34;currentTarget\u0026#34;: { \u0026#34;jQuery360070762021604439211\u0026#34;: { \u0026#34;events\u0026#34;: { \u0026#34;click\u0026#34;: [{ \u0026#34;type\u0026#34;: \u0026#34;click\u0026#34;, \u0026#34;origType\u0026#34;: \u0026#34;click\u0026#34;, \u0026#34;data\u0026#34;: null, \u0026#34;guid\u0026#34;: 1, \u0026#34;namespace\u0026#34;: \u0026#34;\u0026#34; }] } } }, \u0026#34;relatedTarget\u0026#34;: null, \u0026#34;timeStamp\u0026#34;: 1349.8999999761581, \u0026#34;jQuery36007076202160443921\u0026#34;: true, \u0026#34;delegateTarget\u0026#34;: { \u0026#34;jQuery360070762021604439211\u0026#34;: { \u0026#34;events\u0026#34;: { \u0026#34;click\u0026#34;: [{ \u0026#34;type\u0026#34;: \u0026#34;click\u0026#34;, \u0026#34;origType\u0026#34;: \u0026#34;click\u0026#34;, \u0026#34;data\u0026#34;: null, \u0026#34;guid\u0026#34;: 1, \u0026#34;namespace\u0026#34;: \u0026#34;\u0026#34; }] } } }, \u0026#34;handleObj\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;click\u0026#34;, \u0026#34;origType\u0026#34;: \u0026#34;click\u0026#34;, \u0026#34;data\u0026#34;: null, \u0026#34;guid\u0026#34;: 1, \u0026#34;namespace\u0026#34;: \u0026#34;\u0026#34; }, \u0026#34;data\u0026#34;: null } æ–¹æ³•åç§° æè¿° event.type è·å–åˆ°äº‹ä»¶çš„ç±»å‹ event.preventDefault() é˜»æ­¢é»˜è®¤çš„äº‹ä»¶è¡Œä¸º stopPropagation() é˜»æ­¢äº‹ä»¶å†’æ³¡ event.tagent() è·å–åˆ°è§¦å‘äº‹ä»¶çš„å…ƒç´  event.relatedTarget() mousover å’Œ mouseout æ‰€å‘ç”Ÿçš„å…ƒç´  event.pageX event.pageY è·å–åˆ°å…‰æ ‡ç›¸å¯¹äºé¡µé¢çš„ x åæ ‡å’Œ y åæ ‡ event.which() é¼ æ ‡å•å‡»äº‹ä»¶ä¸­è·å–åˆ°çš„å·¦ã€ä¸­ã€å³é”®ï¼Œåœ¨é”®ç›˜äº‹ä»¶ä¸­è·å–é”®ç›˜çš„æŒ‰é”® event.metaKey() ä¸ºé”®ç›˜äº‹ä»¶è·å– ctrl é”® ç§»é™¤äº‹ä»¶ unbind([type], [data]) ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯äº‹ä»¶ç±»å‹ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¦ç§»é™¤çš„å‡½æ•°ã€‚ å¦‚æœæ²¡æœ‰å‚æ•°ï¼Œåˆ™åˆ é™¤æ‰€æœ‰çš„ç»‘å®šäº‹ä»¶\none() å¯¹äºåªè¦è§¦å‘ä¸€æ¬¡ï¼Œéšåè¦ç«‹å³è§£é™¤ç»‘å®šçš„æƒ…å†µï¼ŒjQuery æä¾›äº†ä¸€æ¬¡æ€§è´¨ one() æ–¹æ³•ã€‚ å½“å¤„ç†å‡½æ•°è§¦å‘ä¸€æ¬¡åï¼Œç«‹å³è¢«åˆ é™¤ã€‚\næ¨¡æ‹Ÿæ“ä½œ trigger() æ–¹æ³•å®Œæˆæ¨¡æ‹Ÿæ“ä½œï¼Œ\ntrigger(type, [data]) ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦è§¦å‘çš„äº‹ä»¶ç±»å‹ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¦ä¼ é€’ç»™äº‹ä»¶å¤„ç†å‡½æ•°çš„é™„åŠ å‚æ•°ï¼Œå¯ä»¥é€šè¿‡ä¼ é€’çš„å‚æ•°æ¥åŒºåˆ†è¿™æ¬¡äº‹ä»¶æ˜¯ä»£ç è§¦å‘è¿˜æ˜¯ç”¨æˆ·è§¦å‘çš„ã€‚\néƒ¨åˆ†æ¨¡æ‹Ÿæ‹¥æœ‰ç±»ä¼¼ click() çš„ç®€åŒ–å†™æ³•ï¼›ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å†™æ³•ï¼š\n$(\u0026#39;#btn\u0026#39;).bind(\u0026#39;myClick\u0026#39;, function(){ $(\u0026#39;#test\u0026#39;).append(\u0026#39;\u0026lt;p\u0026gt;æˆ‘çš„è‡ªå®šä¹‰äº‹ä»¶\u0026lt;/p\u0026gt;\u0026#39;); }); // è§¦å‘è¿™ä¸ªäº‹ä»¶ $(\u0026#39;#btn\u0026#39;).trigger(\u0026#39;myClick\u0026#39;); :memo: Note trigger() æ–¹æ³•åœ¨è§¦å‘äº‹ä»¶åï¼Œä¼šæ‰§è¡Œæµè§ˆå™¨é»˜è®¤æ“ä½œã€‚è‹¥ä¸æƒ³æ‰§è¡Œé»˜è®¤æ–¹æ³•ï¼Œå¯ä»¥ï¼š\nå¯¹ä¼ å…¥çš„ äº‹ä»¶å¯¹è±¡*^event^* ï¼Œä½¿ç”¨ event.preventDefault() é˜»æ­¢é»˜è®¤æ“ä½œ æˆ–ï¼Œä½¿ç”¨ triggerHandler() åªè§¦å‘ç›¸åº”ç»‘å®šçš„äº‹ä»¶ åŠ¨ç”» æ–¹æ³•å è¯´æ˜ hide() show() åŒæ—¶ä¿®æ”¹å¤šä¸ªæ ·å¼å±æ€§ï¼Œå³é«˜åº¦ã€å®½åº¦å’Œä¸é€æ˜åº¦ fadeIn() fadeOut() åªæ”¹å˜ä¸é€æ˜åº¦ slideUp() slideDown() åªæ”¹å˜é«˜åº¦ toggle() ç”¨æ¥ä»£æ›¿ hide() å’Œ show() æ–¹æ³• slideToggle() ç”¨æ¥ä»£æ›¿ slideUp() å’Œ slideDown() fadeToggle() ç”¨æ¥ä»£æ›¿ fadeIn() å’Œ fadeOut() animate() å±äºè‡ªå®šä¹‰åŠ¨ç”»çš„æ–¹æ³• jQuery ä¸­çš„ä»»ä½•åŠ¨ç”»æ•ˆæœï¼Œéƒ½å¯ä»¥æŒ‡å®šä¸‰ç§é€Ÿåº¦å‚æ•°ï¼Œslowã€normalã€fastï¼Œå¯¹åº”çš„æ—¶é—´é•¿åº¦åˆ†åˆ«æ˜¯ 0.6 ç§’ï¼Œ0.4 ç§’å’Œ 0.2 ç§’ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥å‚æ•°ï¼Œä¼ å…¥æ•°å­—ä½œä¸ºå‚æ•°ä¸éœ€è¦åŠ å¼•å·ï¼Œä½¿ç”¨å…³é”®å­—éœ€è¦åŠ å¼•å·ã€‚\n:memo: Note ç°åœ¨çš„å¤§éƒ¨åˆ†åŠ¨ç”»ï¼Œéƒ½å¯ä»¥ç”¨ CSS çš„ Animation ä¸­çš„ @keyframe æ¥å®ç°ã€‚\nanimate() å¯ä»¥ä½¿ç”¨ animate() æ–¹æ³•æ¥è‡ªå®šä¹‰åŠ¨ç”»ï¼Œè¯­æ³•ç»“æ„ä¸ºï¼š\ndeclare type animate = ( params: object, speed?: number | string, callback?: Function ) =\u0026gt; Function å‚æ•°å¦‚ä¸‹ï¼š\nparams: ä¸€ä¸ªåŒ…å«æ ·å¼å±æ€§ä»¥åŠå€¼çš„æ˜ å°„ï¼Œæ¯”å¦‚ {property1:\u0026lsquo;value1\u0026rsquo;, property2:\u0026lsquo;value2\u0026rsquo;} ^css-style^\n* æ ·å¼å€¼ä¼ å…¥ -=/+= å¯ä»¥åœ¨å½“å‰ä½ç½®ç´¯åŠ æˆ–ç´¯å‡\nspeed?: é€Ÿåº¦å‚æ•°\ncallback?: å›è°ƒå‡½æ•°\nåŠ¨ç”»é˜Ÿåˆ— å½“ä¸€ä¸ª animate() æ–¹æ³•ä¸­åº”ç”¨å¤šä¸ªå±æ€§æ—¶ï¼ŒåŠ¨ç”»æ˜¯ åŒæ—¶ å‘ç”Ÿçš„ã€‚ å½“ä»¥é“¾å¼æ–¹æ³•è°ƒç”¨æ—¶ï¼ŒåŠ¨ç”»æ˜¯æŒ‰é¡ºåºå‘ç”Ÿï¼ˆé™¤é queue é€‰é¡¹ä¸º falseï¼‰ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŠ¨ç”»éƒ½æ˜¯åŒæ—¶å‘ç”Ÿçš„ã€‚ å½“ä»¥å›è°ƒçš„å½¢å¼åº”ç”¨åŠ¨ç”»æ–¹å¼æ—¶ï¼ŒæŒ‰ç…§å›è°ƒé¡ºåºå‘ç”Ÿã€‚\n/* 1. åŒæ—¶å‘ç”Ÿ */ $(this).animate({left: \u0026#39;500px\u0026#39;, height: \u0026#39;200px\u0026#39;}, 3000); /* 2. å…ˆåå‘ç”Ÿ */ $(this).animate({left: \u0026#39;500px\u0026#39;}, 3000); $(this).animate({height: \u0026#39;200px\u0026#39;}, 3000); // æˆ–é“¾å¼å†™æ³• $(this).animate({left: \u0026#39;500px\u0026#39;}, 3000) .animate({height: \u0026#39;200px\u0026#39;}, 3000); åœæ­¢åŠ¨ç”» stop(clearQueue?ï¼šboolean, gotoEnd?: boolean) å‚æ•°å¦‚ä¸‹ï¼š\nclearQueue^boolean^: æ˜¯å¦è¦æ¸…ç©ºæœªæ‰§è¡Œçš„åŠ¨ç”»é˜Ÿåˆ— gotoEnd^boolean^: æ˜¯å¦ç›´æ¥è·³è½¬åˆ°æœ«çŠ¶æ€ åˆ¤æ–­å…ƒç´ æ˜¯å¦å¤„äºåŠ¨ç”»çŠ¶æ€ è¦å§‹ç»ˆé¿å…åŠ¨ç”»ç´¯è®¡è€Œå¯¼è‡´çš„åŠ¨ç”»ä¸ç”¨æˆ·è¡Œä¸ºä¸ä¸€æ ·çš„æƒ…å†µã€‚å½“ç”¨æˆ·å¿«é€Ÿåœ¨æŸä¸ªå…ƒç´ ä¸Šæ‰§è¡Œ animate() æ—¶ï¼Œå°±ä¼šå‡ºç°åŠ¨ç”»ç´¯åŠ ã€‚\nè§£å†³æ–¹æ³•æ˜¯åˆ¤æ–­å…ƒç´ æ˜¯å¦å¤„äºåŠ¨ç”»çŠ¶æ€ï¼Œå¦‚æœç”¨æˆ·ä¸å¤„äºåŠ¨ç”»çŠ¶æ€ï¼Œæ‰ä¸ºå…ƒç´ æ·»åŠ æ–°çš„åŠ¨ç”»ï¼Œå¦åˆ™ä¸æ·»åŠ ã€‚\nå»¶è¿ŸåŠ¨ç”» åœ¨åŠ¨ç”»æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæƒ³å¯¹åŠ¨ç”»è¿›è¡Œå»¶è¿Ÿæ“ä½œï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ delay() æ–¹æ³•ã€‚\nAjax pros:\nä¸éœ€è¦æ’ä»¶çš„æ”¯æŒ ä¼˜ç§€çš„ç”¨æˆ·ä½“éªŒ æé«˜ Web ç¨‹åºçš„æ€§èƒ½ å‡è½»æœåŠ¡å™¨å’Œå¸¦å®½çš„è´Ÿæ‹… cons:\næµè§ˆå™¨å¯¹ XMLHttpRequest å¯¹è±¡çš„æ”¯æŒåº¦ä¸è¶³ ç ´åæµè§ˆå™¨å‰è¿›åé€€æŒ‰é’®çš„æ­£å¸¸åŠŸèƒ½ å¯¹æœç´¢å¼•æ“çš„æ”¯æŒç¨‹åº¦ä¸å¤Ÿ å¼€å‘å’Œè°ƒè¯•å·¥å…·çš„ç¼ºä¹ åŸç”Ÿ å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œé€šè¿‡è¯¥å‡½æ•°æ¥è·å–å¼‚æ­¥ä¿¡æ¯\nfunction Ajax(){ // å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œé€šè¿‡è¯¥å‡½æ•°æ¥è·å–å¼‚æ­¥ä¿¡æ¯ } å£°æ˜ä¸€ä¸ªç©ºå¯¹è±¡æ¥è£…å…¥ XMLHttpRequest å¯¹è±¡\nvar xmlHttpReq = null; // å£°æ˜ä¸€ä¸ªç©ºå¯¹è±¡æ¥è£…å…¥ XMLHttpRequest å¯¹è±¡ å®ä¾‹åŒ–ä¸€ä¸ª XMLHttpRequest å¯¹è±¡\nif(window.XMLHttpRequest){ xmlHttpReq = new XMLHttpRequest(); // å®ä¾‹åŒ–ä¸€ä¸ª XMLHttpRequest å¯¹è±¡ } ä½¿ç”¨ open() æ–¹æ³•åˆå§‹åŒ– XMLHttpRequest å¯¹è±¡ï¼ŒæŒ‡å®š HTTP æ–¹æ³•å’Œè¦ä½¿ç”¨çš„æœåŠ¡å™¨ URL;\nxmlHttpReq.open(\u0026#34;GET\u0026#34;,\u0026#34;test.php\u0026#34;,true); // è°ƒç”¨ open() æ–¹æ³•å¹¶é‡‡ç”¨å¼‚æ­¥æ–¹å¼ ä½¿ç”¨ onreadystatechange å±æ€§æ¥æ³¨å†Œè¯¥å›è°ƒäº‹ä»¶å¤„ç†å™¨ï¼Œå½“ readystatus çŠ¶æ€æ”¹å˜æ—¶ï¼Œä¼šæ¿€å‘ onreadystatechange äº‹ä»¶ç„¶åè°ƒç”¨å›è°ƒå‡½æ•°ã€‚\nxmlHttpReq.onreadystatechange = RequestCallBack; ä½¿ç”¨ send() æ–¹æ³•å‘é€è¯·æ±‚ï¼Œä½¿ç”¨ GET æ–¹å¼å¯ä»¥ä¸æŒ‡å®šå‚æ•°æˆ–è€…ä½¿ç”¨ null å‚æ•°\nxmlHttpReq.send(null); å½“è¯·æ±‚çŠ¶æ€æ”¹å˜æ—¶ï¼ŒXMLHttpRequest å¯¹è±¡è°ƒç”¨ onreadystatechange å±æ€§æ³¨å†Œçš„äº‹ä»¶å¤„ç†å™¨ï¼Œåœ¨å¤„ç†å“åº”ä¹‹å‰ï¼Œäº‹ä»¶å¤„ç†å™¨åº”è¯¥é¦–å…ˆæ£€æŸ¥ readyStatus çš„å€¼å’Œ HTTP çŠ¶æ€ã€‚å½“è¯·æ±‚å®ŒæˆåŠ è½½ï¼ˆreadyStatus == 4ï¼‰å¹¶ä¸”å“åº”å·²ç»æˆåŠŸï¼ˆHTTP çŠ¶æ€å€¼ä¸º 200ï¼‰ï¼Œå°±å¯ä»¥å¤„ç†å“åº”å†…å®¹ï¼›\nfunction RequestCallBack() { if(xmlHttpReq.readyState == 4){ if(xmlHttpReq.status == 200){ document.getElementById(\u0026#34;resText\u0026#34;).innerHTML = xmlHttpReq.responseText; } } } jQuery jQuery å¯¹ Ajax æ“ä½œè¿›è¡Œå°è£…ï¼Œåœ¨ jQuery ä¸­ï¼Œ$.ajax() æ˜¯æœ€åº•å±‚çš„æ–¹æ³•ï¼Œç¬¬äºŒå±‚æ˜¯ load()ã€$.get()ã€$.post()ã€$.grtJSON()ã€‚\nload() è½½å…¥ HTML æ–‡æ¡£ interface load(url: string, data?:object, callback?: Function): JQuery.jqXHR; å‚æ•°åˆ—è¡¨ ç±»å‹ è¯´æ˜ url String è¯·æ±‚ HTML é¡µé¢çš„ URL åœ°å€ data Object å‘é€è‡³æœåŠ¡å™¨çš„ key/value æ•°æ® callback Function è¯·æ±‚å®Œæˆæ—¶çš„å›è°ƒå‡½æ•°ï¼Œæ— è®ºè¯·æ±‚å¤±è´¥æˆ–æˆåŠŸ æ¯”å¦‚è¯´æˆ‘ä»¬è¦å°†ä¸€ä¸ªé¡µé¢è¿½åŠ åˆ°å¦ä¸€ä¸ªé¡µé¢ï¼Œè¢«è¿½åŠ çš„æ–‡ä»¶ä¸º inner.htmlï¼Œå†…å®¹å¦‚ä¸‹\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Title\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;æµ‹è¯•\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; å†…å®¹åªæœ‰ä¸€ä¸ª \u0026lt;p\u0026gt; æ ‡ç­¾ï¼Œç„¶åæˆ‘ä»¬åˆ›å»ºå¦ä¸€ä¸ªé¡µé¢ï¼Œç”¨æ¥è§¦å‘ Ajax äº‹ä»¶ï¼Œå¹¶ç”¨æ¥æ˜¾ç¤ºè¿½åŠ çš„ HTML ï¼Œé¡µé¢å†…å®¹å¦‚ä¸‹ï¼š\n\u0026lt;input type=\u0026#34;button\u0026#34; id=\u0026#34;send\u0026#34; value=\u0026#34;è·å–\u0026#34;\u0026gt; \u0026lt;div id=\u0026#34;resText\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; $(function () { $(\u0026#39;#send\u0026#39;).click(function () { $(\u0026#39;#resText\u0026#39;).load(\u0026#39;inner.html\u0026#39;); }); }); \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; è½½å…¥éƒ¨åˆ† HTML æ–‡æ¡£ å¦‚æœåªéœ€è¦åŠ è½½é¡µé¢ä¸­çš„æŸäº›å…ƒç´ ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ url å‚æ•°é‡ŒåŠ ä¸Šé€‰æ‹©å™¨ï¼Œè¯­æ³•ï¼š\nurl: \u0026#34;url selector\u0026#34; e.g.:\n$(\u0026#39;#resText\u0026#39;).load(\u0026#39;inner.html .test\u0026#39;) ä¼ é€’æ–¹å¼ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®ä¼ é€’æ–¹å¼ï¼Œé‚£ä¹ˆä½¿ç”¨ GET æ–¹å¼ï¼Œå¦‚æœæœ‰ä¼ é€’å‚æ•°ï¼Œé‚£ä¹ˆä¸º POST æ–¹å¼ã€‚\n:memo: Note åœ¨ load() æ–¹æ³•ä¸­ï¼Œæ— è®º AJAX æ˜¯å¦è¯·æ±‚æˆåŠŸï¼Œåªè¦å½“è¯·æ±‚ å®Œæˆ*^complete^* åï¼Œå›è°ƒå‡½æ•°*^callback^* å°±è¢«è§¦å‘ã€‚\nå›è°ƒ $(\u0026#39;#resText\u0026#39;).load(\u0026#39;inner.html .test\u0026#39;, functiong(responseText,textStatus,XMLHttpRequest){ // responseText : è¯·æ±‚è¿”å›çš„å†…å®¹ // textStatus : successã€errorã€notmodifiedã€timeout // XMLHttpRequest : XMLHttpRequest å¯¹è±¡ }); get() $.get() æ–¹æ³•ä½¿ç”¨ GET æ–¹å¼æ¥è¿›è¡Œå¼‚æ­¥è¯·æ±‚ã€‚\ninterface get = (url: string, data?: object, callback?: Function, type?: string): JQuery.jqXHR; å‚æ•°åç§° ç±»å‹ è¯´æ˜ url String è¯·æ±‚ HTML é¡µçš„ URL åœ°å€ data? Object å‘é€è‡³æœåŠ¡å™¨çš„ key/value æ•°æ®ä¼šä½œä¸º QueryString é™„åŠ åˆ°è¯·æ±‚ URL ä¸­ callback? Function è½½å…¥æˆåŠŸæ—¶å›è°ƒå‡½æ•°ï¼ˆåªæœ‰å½“ Response çš„è¿”å›çŠ¶æ€æ˜¯ success æ‰è°ƒç”¨ï¼‰è‡ªåŠ¨å°†è¯·æ±‚çš„ç»“æœå’ŒçŠ¶æ€ä¼ é€’ç»™æ–¹æ³• type? String æœåŠ¡å™¨ç«¯è¿”å›å†…å®¹çš„æ ¼å¼ï¼ŒåŒ…æ‹¬ xml,html,script,json,text,_default post() $.post() æ–¹æ³•ä½¿ç”¨ POST æ–¹å¼æ¥è¿›è¡Œå¼‚æ­¥è¯·æ±‚ã€‚\ninterface post = (url: string, data?: object, callback?: Function, type?: string): JQuery.jqXHR; :memo: Note GET æ–¹å¼å’Œ POST ä¸¤ç§æ–¹æ³•çš„ç»“æ„å’Œä½¿ç”¨æ–¹å¼éƒ½ç›¸åŒè¯·æ±‚ï¼Œä½†ä»æœ‰äº›è®¸ä¸åŒï¼š\nGET è¯·æ±‚å°†å‚æ•°è·Ÿåœ¨ URL åè¿›è¡Œä¼ é€’ï¼ŒPOST åˆ™ä½œä¸º HTTP æ¶ˆæ¯çš„ å®ä½“*^enteties^* å†…å®¹å‘é€ç»™ web æœåŠ¡å™¨ GET æ–¹å¼å¯¹ä¼ é€’çš„æ•°æ®æœ‰é™åˆ¶ â‰¤2kb ï¼Œè€Œ POST æ–¹å¼ç†è®ºä¸Šæ²¡æœ‰é™åˆ¶ GET æ–¹å¼è¯·æ±‚çš„æ•°æ®ä¼šè¢«æµè§ˆå™¨ç¼“å­˜èµ·æ¥ï¼Œå› æ­¤ä¼ é€’çš„æ¶ˆæ¯èƒ½ä»æµè§ˆå™¨çš„å†å²è®°å½•ä¸­æ‰¾å‡ºï¼Œä»è€Œäº§ç”Ÿä¸¥é‡çš„å®‰å…¨æ€§é—®é¢˜ ajax() $.ajax() æ–¹æ³•æ˜¯ jQuery æœ€åº•å±‚çš„ Ajax å®ç°ï¼Œ\n$.ajax(option) å‚æ•°åç§° ç±»å‹ è¯´æ˜ url String å‘é€è¯·æ±‚çš„ URLï¼ˆé»˜è®¤ä¸ºå½“å‰é¡µé¢ï¼‰ type String è¯·æ±‚æ–¹å¼ï¼Œé»˜è®¤ä¸º GET timeout Number è®¾ç½®è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ data Object æˆ– String å‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ® dataTpye String é¢„æœŸæœåŠ¡å™¨è¿”å›çš„æ•°æ®ç±»å‹ beforeSend Function å‘é€è¯·æ±‚å‰å¯ä»¥ä¿®æ”¹ XMLHttpResponse å¯¹è±¡çš„å‡½æ•° complete Function è¯·æ±‚å®Œæˆåè°ƒç”¨çš„å›è°ƒå‡½æ•°ï¼ˆè¯·æ±‚å¤±è´¥æˆ–è€…æˆåŠŸå‡è°ƒç”¨ï¼‰ success Function è¯·æ±‚æˆåŠŸåè°ƒç”¨çš„å›è°ƒå‡½æ•° error Function è¯·æ±‚å¤±è´¥åè°ƒç”¨çš„å›è°ƒå‡½æ•° global Function é»˜è®¤ä¸º trueã€‚æ˜¯å¦è§¦å‘å…¨å±€ Ajax äº‹ä»¶ åºåˆ—åŒ–å…ƒç´  serialze() serialize() æ–¹æ³•èƒ½å¤Ÿå°† DOM å…ƒç´ å†…å®¹åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œç”¨äº Ajax è¯·æ±‚ã€‚å³ä½¿åœ¨è¡¨å•ä¸­å†å¢åŠ å­—æ®µï¼Œè„šæœ¬ä»ç„¶èƒ½å¤Ÿä½¿ç”¨ã€‚å¹¶ä¸”ä¸éœ€è¦åšå…¶ä»–å¤šä½™å·¥ä½œã€‚\n\u0026lt;form is=\u0026#34;form1\u0026#34; action=\u0026#34;#\u0026#34;\u0026gt; \u0026lt;p\u0026gt;è¯„è®ºï¼š\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;å§“åï¼š\u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34; id=\u0026#34;username\u0026#34;\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;å†…å®¹ï¼š\u0026lt;textarea name=\u0026#34;content\u0026#34; id=\u0026#34;content\u0026#34; rows=\u0026#34;2\u0026#34; cols=\u0026#34;20\u0026#34;\u0026gt;\u0026lt;/textarea\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;\u0026lt;input type=\u0026#34;button\u0026#34; id=\u0026#34;send\u0026#34; value=\u0026#34;æäº¤\u0026#34;\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;/form\u0026gt; ä¸ºäº†è·å–å§“åå’Œå†…å®¹ï¼Œå¿…é¡»å°†å­—æ®µçš„å€¼é€ä¸ªæ·»åŠ åˆ° data å‚æ•°ä¸­ã€‚ä»£ç å¦‚ä¸‹ï¼š\n$(\u0026#34;#send\u0026#34;).click(function(){ $.get(\u0026#34;get1.php\u0026#34;, { username: $(\u0026#34;#username\u0026#34;).val(), content: $(\u0026#34;#content\u0026#34;).val() },function(data, textStatus){ // callback $(\u0026#34;resText\u0026#34;).html(data); // å°†è¿”å›çš„æ•°æ®æ·»åŠ åˆ°é¡µé¢ä¸Š }); }); éšç€è¡¨å•è¶Šæ¥è¶Šå¤æ‚ï¼Œè¿™ä½¿å¾—è¡¨å•ç¼ºä¹å¼¹æ€§ã€‚jQuery æä¾›äº†ä¸€ä¸ªç®€ä¾¿çš„åŠæ³•ï¼šserialize() ï¼Œè¿™ä¸ªæ–¹æ³•å°† DOM å…ƒç´ å†…å®¹è½¬æ¢ä¸º å­—ç¬¦ä¸²å¯¹è±¡*^string-object^* ï¼Œå¹¶ç”¨äº AJAX è¯·æ±‚ï¼š\n$(\u0026#34;#send\u0026#34;).click(function(){ $.get(\u0026#34;get1.php\u0026#34;, $(\u0026#34;#form1\u0026#34;).searlize(), function(data, textStatus){ $(\u0026#34;resText\u0026#34;).html(data); // å°†è¿”å›çš„æ•°æ®æ·»åŠ åˆ°é¡µé¢ä¸Š }); }); serialzeArray() serializeArray() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åœ¨ serialze() å°† DOM åºåˆ—åŒ–çš„åŸºç¡€ä¸Šï¼Œè¿”å› JSON æ ¼å¼çš„æ•°æ®ã€‚\nparam() $.param() æ–¹æ³•ï¼Œæ˜¯ serialize() çš„æ ¸å¿ƒï¼Œç”¨æ¥å°†ä¸€ä¸ªæ•°ç»„æˆ–å¯¹è±¡æŒ‰ç…§ key/value åºåˆ—åŒ–ä¸º GET çš„ å‚æ•°*^param^* ã€‚\nlet obj = {a:1,b:2,c:3}; let k = $.param(obj); alert(k); // è¾“å‡º a=1\u0026amp;b=2\u0026amp;c=3 ä¼˜åŒ– ä½¿ç”¨åˆé€‚çš„é€‰æ‹©å™¨ $(\u0026quot;#id\u0026quot;)\nid é€‰æ‹©å™¨æ— ç–‘æ˜¯æœ€ä½³æé«˜æ€§èƒ½çš„æ–¹å¼ã€‚å› ä¸º jQuery åº•å±‚ç›´æ¥è°ƒç”¨æœ¬åœ°æ–¹æ³• document.getElementById()ï¼Œç›´æ¥é€šè¿‡ id è¿”å›å¯¹åº”çš„å…ƒç´ å¯ä»¥æœ‰æ•ˆçš„ç¼©å°ä½ å®šä½çš„ DOM å…ƒç´ ï¼Œå»ºè®®ä»æœ€è¿‘çš„ ID å…ƒç´ å¼€å§‹å¾€ä¸‹æœç´¢ã€‚\n$(\u0026quot;p\u0026quot;), $(\u0026quot;div\u0026quot;), $(\u0026quot;input\u0026quot;)\næ ‡ç­¾é€‰æ‹©å™¨æ˜¯æ€§èƒ½ä¼˜åŒ–ç¬¬äºŒé€‰æ‹©ï¼Œå› ä¸º jQuery ä¹Ÿæ˜¯ç›´æ¥è°ƒç”¨ JS åŸç”Ÿæ–¹æ³•\n$(\u0026quot;.class\u0026quot;) è¿™æ˜¯ jQuery å°è£…çš„å‡½æ•°ï¼Œie9^+^ ä»¥ä¸Šæ˜¯ä½¿ç”¨ JS çš„åŸç”Ÿæ–¹æ³•ï¼Œie9^-^ ä¸‹æ˜¯ä½¿ç”¨ DOM æœç´¢æ–¹å¼æ¥å®ç°\n$(\u0026quot;[attribute=value]\u0026quot;)ï¼šåˆ©ç”¨å±æ€§æ¥å®šä½ DOM å…ƒç´ ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯ä½¿ç”¨ DOM æœç´¢æ–¹å¼æ¥è¾¾åˆ°æ•ˆæœã€‚æ‰€ä»¥æ€§èƒ½å¹¶ä¸æ˜¯å¾ˆç†æƒ³\n$(\u0026quot;:hidden\u0026quot;)ï¼šè¿™å’Œä¸Šé¢åˆ©ç”¨å±æ€§ç±»ä¼¼ï¼Œå¹¶ä¸” jQuery éœ€è¦æœç´¢æ¯ä¸€ä¸ªå…ƒç´ æ¥å®šä½è¿™ä¸ªé€‰æ‹©å™¨ï¼Œæ‰€ä»¥å°½é‡ä¸è¦ä½¿ç”¨ã€‚\nç¼“å­˜å¯¹è±¡ æˆ‘ä»¬å¯ä»¥å°†ç»å¸¸ç”¨çš„å¯¹è±¡ä½¿ç”¨å˜é‡ç¼“å­˜èµ·æ¥ï¼Œå› ä¸º jQuery ä¼šåœ¨åˆ›å»ºæ¯ä¸€ä¸ªé€‰æ‹©å™¨çš„è¿‡ç¨‹ä¸­ï¼ŒæŸ¥æ‰¾ DOM ã€‚ ä¸è¦è®©ç›¸åŒçš„é€‰æ‹©å™¨åœ¨ä½ çš„ä»£ç ä¸­å‡ºç°å¤šæ¬¡ã€‚\nå¾ªç¯æ—¶çš„ DOM æ“ä½œ åœ¨ä¸€äº›å¾ªç¯æ—¶ï¼Œä¾‹å¦‚ for()ã€while()ã€$.each() ä½¿ç”¨è¿™äº›æ–¹æ³•å¤„ç† DOM å…ƒç´ æ—¶ï¼Œè¦å°½å¯èƒ½çš„å‡å°‘æ“ä½œ DOM ï¼Œå¯ä»¥ä½¿ç”¨å˜é‡å°†æ¥å‚¨å­˜å…ƒç´ ï¼Œæœ€åä¸€æ¬¡æ€§å°†ç”Ÿäº§çš„ DOM æ’å…¥æˆ–è€…åˆ é™¤ã€‚\næ•°ç»„æ–¹å¼ä½¿ç”¨ jQuery å¯¹è±¡ ä½¿ç”¨ jQuery é€‰æ‹©å™¨è·å¾—çš„ç»“æœæ˜¯ä¸€ä¸ª jQuery å¯¹è±¡ï¼Œç„¶è€Œï¼ŒjQuery ç±»åº“ä¼šè®©ä½ æ„Ÿè§‰ä½ æ­£åœ¨ä½¿ç”¨ä¸€ä¸ªå®šä¹‰äº†ç´¢å¼•å’Œé•¿åº¦çš„æ•°ç»„ã€‚åœ¨æ€§èƒ½æ–¹é¢ï¼Œå»ºè®®ä½¿ç”¨ for æˆ–è€… while å¾ªç¯æ¥å¤„ç†ï¼Œè€Œä¸æ˜¯ $.each() ã€‚\näº‹ä»¶ä»£ç† æ¯ä¸€ä¸ª JavaScript äº‹ä»¶ï¼ˆä¾‹å¦‚ï¼šclickã€mouseover ç­‰ï¼‰éƒ½ä¼šå†’æ³¡åˆ°çˆ¶èŠ‚ç‚¹ï¼Œå½“æˆ‘ä»¬éœ€è¦ç»™å¤šä¸ªå…ƒç´ è°ƒç”¨åŒä¸ªå‡½æ•°æ—¶ä¼šå¾ˆæœ‰ç”¨ã€‚\næ¯”å¦‚ï¼Œæˆ‘ä»¬è¦å•å‡»è¡¨æ ¼çš„è¡Œä½¿å¾—æ”¹è¡ŒèƒŒæ™¯é¢œè‰²æ”¹å˜ï¼š\n$(\u0026#34;myTable td\u0026#34;).click(function(){ $(this).css(\u0026#34;background\u0026#34;,\u0026#39;red\u0026#39;); }); å¦‚æœä½ æ˜¯è¿™æ ·å†™çš„è¯ï¼Œé‚£ä¹ˆæ­å–œä½ ï¼Œæä¾›äº†ä¸€ä¸ªé”™è¯¯çš„ç¤ºä¾‹ï¼ŒğŸ‰ğŸ‰ã€‚è¿™æ ·çš„å¼Šç«¯æ˜¯ï¼Œå‡ä½¿æ€»å…±æœ‰ 100 ä¸ª tdï¼Œé‚£ä¹ˆåœ¨ä½¿ç”¨ä»¥ä¸Šæ–¹å¼çš„æ—¶å€™ï¼Œä½ ç»‘å®šäº† 100 ä¸ªäº‹ä»¶ï¼Œå¤©è¾£ï¼Œæ˜¯ä¸æ˜¯å¾ˆææ€–ã€‚\næ­£ç¡®çš„å§¿åŠ¿æ˜¯ï¼Œåªéœ€è¦å‘ä»–ä»¬çš„ çˆ¶èŠ‚ç‚¹ ç»‘å®šä¸€æ¬¡äº‹ä»¶ï¼Œç„¶åé€šè¿‡ event.target è·å–åˆ°å½“å‰ç‚¹å‡»çš„å…ƒç´ ã€‚\n$(\u0026#34;myTable\u0026#34;).click(function(){ var $clicked = $(e.target); // æ•æ‰åˆ°è§¦å‘çš„ç›®æ ‡å…ƒç´  $clicked.css(\u0026#34;background\u0026#34;,\u0026#39;red\u0026#39;); }); ä¹Ÿå¯ä»¥è¿™æ ·å†™\n$(\u0026#34;myTable td\u0026#34;).on(\u0026#39;click\u0026#39;,\u0026#39;td\u0026#39;, function(){ $(this).css(\u0026#34;background\u0026#34;,\u0026#39;red\u0026#39;) }); ","date":"2023-03-20","section":"techs","summary":"JQuery JavaScript åº“ï¼šå³ library ï¼Œæ˜¯ä¸€ä¸ª å°è£… å¥½çš„ç‰¹å®šçš„ é›†åˆ ï¼ˆæ–¹æ³•å’Œå‡½æ•°ï¼‰ã€‚ä»å°è£…çš„è§’åº¦ç†è§£ï¼Œå°±æ˜¯å¯¹åŸç”Ÿ js ä»£ç å°è£…ï¼Œä½¿ç”¨æ—¶ç›´æ¥è°ƒç”¨å³å¯ã€‚\njQuery æ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´çš„ JavaScript åº“ï¼Œå…¶è®¾è®¡çš„å®—æ—¨æ˜¯ â€œWrite less, do moreâ€ ã€‚å®ƒå°è£…äº†å¸¸ç”¨çš„åŠŸèƒ½ä»£ç ï¼Œä¼˜åŒ–äº† DOM æ“ä½œã€äº‹ä»¶å¤„ç†ã€åŠ¨ç”»è®¾è®¡å’Œ AJAX äº¤äº’ã€‚\nå­¦ä¹  JQuery æœ¬è´¨å°±æ˜¯å­¦ä¹ è°ƒç”¨è¿™äº›å‡½æ•°çš„æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥éå¸¸æ–¹ä¾¿åœ°è°ƒç”¨å’Œä½¿ç”¨å®ƒï¼Œä»è€Œæé«˜å¼€å‘æ•ˆç‡ã€‚\nå¼ºå¤§çš„é€‰æ‹©å™¨\nå‡ºè‰²çš„ DOM æ“ä½œçš„å°è£…\nå¯é çš„äº‹ä»¶å¤„ç†æœºåˆ¶\nå®Œå–„çš„ Ajax\nä¸æ±¡æŸ“é¡¶çº§å˜é‡\nå‡ºè‰²çš„æµè§ˆå™¨å…¼å®¹æ€§\né“¾å¼æ“ä½œæ–¹å¼\néšå¼è¿­ä»£\nè¡Œä¸ºå±‚ä¸ç»“æ„å±‚åˆ†ç¦»\nä¸°å¯Œçš„æ’ä»¶æ”¯æŒ\nå®Œå–„çš„æ–‡æ¡£\nå¼€æº\nä¸æ±¡æŸ“é¡¶çº§å˜é‡\njQuery åªå»ºç«‹ä¸€ä¸ªåä¸º jQuery çš„å¯¹è±¡ï¼Œå…¶æ‰€æœ‰çš„å‡½æ•°æ–¹æ³•éƒ½åœ¨è¿™ä¸ªå¯¹è±¡ä¹‹ä¸‹ã€‚å…¶åˆ«å $ ä¹Ÿå¯ä»¥éšæ—¶äº¤å‡ºæ§åˆ¶æƒï¼Œç»å¯¹ä¸ä¼šæ±¡æŸ“å…¶ä»–å˜é‡ã€‚è¯¥ç‰¹æ€§ä½¿ jQuery å¯ä»¥ä¸å…¶ä»– JavaScript åº“å…±å­˜ã€‚\né“¾å¼æ“ä½œæ–¹å¼\njQuery çš„é“¾å¼æ“ä½œæ–¹å¼ï¼šå¯¹æ”¾ç”Ÿåœ¨åŒä¸€ä¸ª jQuery å¯¹è±¡ä¸Šçš„ä¸€ç»„åŠ¨ä½œï¼Œå¯ä»¥ç›´æ¥ è¿å†™ è€Œæ— éœ€é‡å¤è·å–å¯¹è±¡ã€‚ï¼ˆç”±è¿”å› this æŒ‡é’ˆå®ç°ï¼‰\néšå¼è¿­ä»£\nå½“ç”¨ jQuery æ‰¾åˆ°å¸¦æœ‰ â€œ.myClassâ€ ç±»çš„å…¨éƒ¨å…ƒç´ ï¼Œç„¶åéšè—å®ƒä»¬æ—¶ï¼Œæ— éœ€å¾ªç¯éå†æ¯ä¸€ä¸ªè¿”å›çš„å…ƒç´ ã€‚jQuery é‡Œçš„æ–¹æ³•éƒ½è¢«è®¾è®¡æˆè‡ªåŠ¨æ“ä½œå¯¹è±¡ é›†åˆ*^set^* ï¼Œè€Œä¸æ˜¯å•ç‹¬çš„å¯¹è±¡ã€‚\n","title":"14 jQuery","url":"/techs/14-jquery/"},{"content":"Vue Vue (å‘éŸ³ä¸º /vjuË/ï¼Œç±»ä¼¼ view) æ˜¯ä¸€æ¬¾ç”¨äºæ„å»º ç”¨æˆ·ç•Œé¢^ui^ çš„æ¸è¿›å¼ JavaScript æ¡†æ¶ã€‚å®ƒä¸æ˜¯ä¸€ä¸ªå…¨èƒ½æ¡†æ¶çš„æ ¸å¿ƒï¼Œåªå…³æ³¨ è§†å›¾å±‚^view^ ï¼Œå› æ­¤éå¸¸å®¹æ˜“å­¦ä¹ ä»¥åŠä¸å…¶å®ƒåº“æˆ–å·²æœ‰é¡¹ç›®æ•´åˆã€‚\næ„å»ºç”¨æˆ·ç•Œé¢ï¼šæŠŠæ•°æ®é€šè¿‡æŸç§åŠæ³•å˜æˆç”¨æˆ·ç•Œé¢ æ¸è¿›å¼ï¼šVue å¯ä»¥è‡ªåº•å‘ä¸Šé€å±‚çš„åº”ç”¨ï¼Œç®€å•åº”ç”¨åªéœ€è¦ä¸€ä¸ªè½»é‡å°å·§çš„æ ¸å¿ƒåº“ï¼Œå¤æ‚åº”ç”¨å¯ä»¥å¼•å…¥å„å¼å„æ ·çš„ Vue æ’ä»¶ åº“ï¼šå°è£…çš„å±æ€§æˆ–æ–¹æ³•ï¼ˆjQueryï¼‰\næ¡†æ¶ï¼šæ‹¥æœ‰è‡ªå·±çš„è§„åˆ™å’Œå…ƒç´ ï¼Œæ¯”åº“å¼ºå¤§çš„å¤šï¼ˆVueï¼‰\nç‰¹ç‚¹*^Feature^* Vue å€Ÿé‰´äº† angular çš„ æ¨¡æ¿^template^ å’Œ æ•°æ®ç»‘å®š^data-bind^ æŠ€æœ¯ã€å€Ÿé‰´ react çš„ ç»„ä»¶åŒ–^component^ å’Œ è™šæ‹Ÿ DOM æŠ€æœ¯ã€‚\nåŒå‘ç»‘å®š Vue.js çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªå“åº”çš„æ•°æ®ç»‘å®šç³»ç»Ÿï¼Œéµå¾ª MVVM*^Model-View-ViewModel^* æ¨¡å‹ ï¼Œå®ƒè®©æ•°æ®ä¸ DOM ä¿æŒåŒæ­¥éå¸¸ç®€å•ã€‚\nM: æ¨¡å‹ ^Model^ - data() ä¸­è¿”å›çš„æ•°æ® B è§†å›¾ ^view^ - æ¨¡ç‰ˆä»£ç  VM è§†å›¾æ¨¡å‹*^view-model^*: è§†å›¾å’Œæ¨¡å‹çš„è¡”æ¥æ¡¥æ¢ åœ¨ä½¿ç”¨ jQuery æ‰‹å·¥æ“ä½œ DOM æ—¶ï¼Œæˆ‘ä»¬çš„ä»£ç å¸¸å¸¸æ˜¯å‘½ä»¤å¼çš„ã€é‡å¤çš„ä¸æ˜“é”™çš„ã€‚ Vue.js æ‹¥æŠ± æ•°æ®é©±åŠ¨data driven çš„è§†å›¾æ¦‚å¿µã€‚é€šä¿—åœ°è®²ï¼Œå®ƒæ„å‘³ç€æˆ‘ä»¬åœ¨æ™®é€š HTML æ¨¡æ¿ä¸­ä½¿ç”¨ç‰¹æ®Šçš„è¯­æ³•å°† DOM â€œç»‘å®šâ€åˆ°åº•å±‚æ•°æ®ã€‚ä¸€æ—¦åˆ›å»ºäº†ç»‘å®šï¼ŒDOM å°†ä¸æ•°æ®ä¿æŒåŒæ­¥ã€‚ æ¯å½“ä¿®æ”¹äº†æ•°æ®ï¼ŒDOM ä¾¿ç›¸åº”åœ°æ›´æ–°ã€‚\næ­¤æ—¶æ•°æ®ä¸é€»è¾‘åˆ†ç¦»ï¼Œåº”ç”¨ä¸­çš„é€»è¾‘å°±å‡ ä¹éƒ½æ˜¯ç›´æ¥ä¿®æ”¹æ•°æ®äº†ï¼Œä»è€Œä¸å¿…è€ƒè™‘ DOM æ›´æ–°ã€‚è¿™è®©æˆ‘ä»¬çš„ä»£ç æ›´å®¹æ˜“æ’°å†™ã€ç†è§£ä¸ç»´æŠ¤ã€‚\nç»„ä»¶åŒ– ç¼–ç ç®€æ´ï¼Œä½“ç§¯å°ï¼Œè¿è¡Œæ•ˆç‡é«˜ï¼Œé€‚åˆ ç§»åŠ¨ / PC ç«¯å¼€å‘ã€‚\nç»„ä»¶*^component^* æ˜¯ Vue.js æœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€ã€‚ç»„ä»¶å¯ä»¥æ‰©å±• HTML å…ƒç´ ï¼Œå¹¶å°è£…å¯é‡ç”¨çš„ä»£ç ã€‚ åœ¨è¾ƒé«˜å±‚é¢ä¸Šï¼Œç»„ä»¶æ˜¯è‡ªå®šä¹‰å…ƒç´ ï¼Œ Vue.js çš„ç¼–è¯‘å™¨ä¸ºå®ƒæ·»åŠ ç‰¹æ®ŠåŠŸèƒ½ã€‚åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œç»„ä»¶ä¹Ÿå¯ä»¥æ˜¯åŸç”Ÿ HTML å…ƒç´ çš„å½¢å¼ï¼Œä»¥ is ç‰¹æ€§æ‰©å±•ã€‚\nVue æ¨èé‡‡ç”¨ .vue æ–‡ä»¶æ¥å¼€å‘é¡¹ç›® js ç‹¬ç«‹ä½œç”¨åŸŸäº’ä¸å½±å“ style é…åˆ scope å±æ€§ï¼Œä¿è¯æ ·å¼åªå¯¹å½“å‰ template è™šæ‹Ÿ DOM ä»€ä¹ˆï¼šJS å¯¹è±¡ï¼Œä¿å­˜ DOM å…³é”®ä¿¡æ¯\nä¸ºä»€ä¹ˆï¼šæä¾›æ€§èƒ½ï¼ŒçœŸå®çš„ DOM å±æ€§å¤ªå¤šï¼Œæ²¡åŠæ³•å¿«é€Ÿæ‰¾åˆ°è°å˜åŒ–äº†\nè¿‡ç¨‹ï¼štemplate â‡’ è™šæ‹Ÿ DOM â‡’ çœŸå® DOM\nå¦‚ä½•æŒ‚è½½ï¼Ÿ\ndiff ç®—æ³•\næ–°æ—§ DOM åŒçº§äº’æ¯” æ ¹æ ‡ç­¾æ”¹å˜ â‡’ åˆ é™¤æ•´ä¸ª DOM é‡æ–°åˆ›å»º å£°æ˜å¼ç¼–ç  ç¼–ç äººå‘˜æ— éœ€ç›´æ¥æ“ä½œ DOM ï¼Œæé«˜å¼€å‘æ•ˆç‡ï¼›åŒæ—¶é€šè¿‡ä½¿ç”¨ Diff ç®—æ³•ï¼Œç”¨è™šæ‹Ÿ DOM å°½é‡å¤ç”¨èŠ‚ç‚¹ï¼Œä»¥å‡å°‘åŸç”Ÿä¿®æ”¹çš„æ¶ˆè€—ã€‚\nv-xxxx è¡¨ç¤º Vue æŒ‡ä»¤ã€‚\nv-cloak è§£å†³é¡µé¢é—ªçƒé—®é¢˜ *e.g.: [v-cloak]{ display: none; }* {{}} æ’å€¼è¡¨è¾¾å¼\nv-text ç±»æ¯” jQuery é‡Œçš„ text()\nv-html ç±»æ¯” htm çš„ html()\nå‘¨è¾¹åº“ vue-cliï¼šVue è„šæ‰‹æ¶ vue-resource ^(axios)^ï¼šajax è¯·æ±‚ vue-routerï¼šè·¯ç”± vuexï¼šçŠ¶æ€ç®¡ç†ï¼ˆå®ƒæ˜¯ Vue çš„æ’ä»¶ä½†æ˜¯æ²¡æœ‰ç”¨ vue-xxx çš„å‘½åè§„åˆ™ï¼‰ vue-lazyloadï¼šå›¾ç‰‡æ‡’åŠ è½½ vue-scrollerï¼šé¡µé¢æ»‘åŠ¨ç›¸å…³ mint-uiï¼šåŸºäº Vue çš„ UI ç»„ä»¶åº“ï¼ˆç§»åŠ¨ç«¯ï¼‰ element-uiï¼šåŸºäº Vue çš„ UI ç»„ä»¶åº“ï¼ˆ PC ç«¯ï¼‰ ä½¿ç”¨*^Usage^* vue å®˜æ–¹æä¾›äº† vue-devtools è°ƒè¯•å·¥å…·ï¼Œèƒ½å¤Ÿæ–¹ä¾¿å¼€å‘è€…å¯¹ vue è¿›è¡Œè°ƒè¯•å¼€å‘ã€‚\nâš ï¸ Caution vue2 å’Œ vue3 çš„æµè§ˆå™¨è°ƒè¯•å·¥å…·ä¸èƒ½äº¤å‰ä½¿ç”¨\nå‡†å¤‡*^Prepare^* vue-devtools: ç”¨äºè°ƒè¯• Vue åº”ç”¨ç¨‹åºçš„æµè§ˆå™¨æ‰©å±• é€šè¿‡æ ‡ç­¾å¼•å…¥ Vue åŒ… ï¼ˆå¯é€‰ï¼‰é˜»æ­¢ Vue åœ¨å¯åŠ¨æ—¶ç”Ÿæˆç”Ÿäº§æç¤º Vue.config.productionTip = false favicon éœ€è¦å°†é¡µç­¾å›¾æ ‡æ”¾åœ¨é¡¹ç›®æ ¹è·¯å¾„ åˆ›å»º*^Setup^* æƒ³è®© Vue å·¥ä½œï¼Œå°±å¿…é¡»åˆ›å»ºä¸€ä¸ª Vue å®ä¾‹vue#createApp ï¼Œä¸”è¦ä¼ å…¥ä¸€ä¸ªé…ç½®å¯¹è±¡data:{} ï¼Œå¹¶é€šè¿‡ .mount() æ–¹æ³•æŒ‚è½½ ã€‚åœ¨ Vue 3.0 ä¸­ï¼Œæ ¹ç»„ä»¶ä¹Ÿæ˜¯ç‰¹æ®Šçš„ç»„ä»¶ï¼Œå…¶ä»–ç»„ä»¶å°†ä½œä¸ºå…¶å­ç»„ä»¶ã€‚\nå¦‚æœä½ ä½¿ç”¨çš„æ˜¯å•æ–‡ä»¶ç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä»å¦ä¸€ä¸ªæ–‡ä»¶ä¸­å¯¼å…¥æ ¹ç»„ä»¶ã€‚\nimport { createApp } from \u0026#39;vue\u0026#39; const app = createApp({ /* æ ¹ç»„ä»¶é€‰é¡¹ */ }) ä¸€æ—¦ data ä¸­çš„æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆæ¨¡æ¿ä¸­ç”¨åˆ°è¯¥æ•°æ®çš„åœ°æ–¹ä¹Ÿä¼š è‡ªåŠ¨æ›´æ–° ã€‚\nå¤§å¤šæ•°çœŸå®çš„åº”ç”¨éƒ½æ˜¯ç”±ä¸€æ£µåµŒå¥—çš„ã€å¯é‡ç”¨çš„ç»„ä»¶æ ‘ç»„æˆçš„ã€‚ä¾‹å¦‚ï¼Œå¾…åŠäº‹é¡¹åº”ç”¨ç¨‹åºçš„ç»„ä»¶æ ‘å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š\nApp (root component) â”œâ”€ TodoList â”‚ â””â”€ TodoItem â”‚ â”œâ”€ TodoDeleteButton â”‚ â””â”€ TodoEditButton â””â”€ TodoFooter â”œâ”€ TodoClearButton â””â”€ TodoStatistics :memo: Note ä¸ä½¿ç”¨æ„å»ºå·¥å…·\nå½“åœ¨æœªé‡‡ç”¨æ„å»ºæµç¨‹çš„æƒ…å†µä¸‹ä½¿ç”¨ Vue æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æŒ‚è½½å®¹å™¨ä¸­ç›´æ¥ä¹¦å†™æ ¹ç»„ä»¶æ¨¡æ¿ï¼š\n\u0026lt;script src=\u0026#34;https://unpkg.com/vue@3\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;div id=\u0026#34;demo\u0026#34;\u0026gt; \u0026lt;!-- å½“åœ¨æœªé‡‡ç”¨æ„å»ºæµç¨‹çš„æƒ…å†µä¸‹ä½¿ç”¨Vueæ—¶ --\u0026gt; \u0026lt;!-- å¯ä»¥åœ¨æŒ‚è½½å®¹å™¨ä¸­ç›´æ¥ä¹¦å†™æ ¹ç»„ä»¶æ¨¡æ¿ --\u0026gt; Hello, {{name.toUpperCase()}}, {{address}}! \u0026lt;button @click=\u0026#34;count++\u0026#34;\u0026gt;{{count}}\u0026lt;/button\u0026gt; \u0026lt;!-- Hello, FOO, bar! 0 --\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; Vue.createApp({ // å‡ ä¹æ‰€æœ‰çš„ä»£ç éƒ½æ˜¯å®ä¾‹ï¼Œå¹¶å†™å…¥Vueå®ä¾‹çš„é€‰é¡¹å†… data() { // data()æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºè¿”å›éœ€è¦è°ƒç”¨çš„æ•°æ® return { // dataé€‰é¡¹ç”¨äºå£°æ˜åº”ç”¨å†…éœ€è¦åŒå‘ç»‘å®šçš„æ•°æ® // å»ºè®®æ‰€æœ‰ç”¨åˆ°çš„æ•°æ®éƒ½åœ¨dataå†…å£°æ˜ name: \u0026#39;foo\u0026#39;, address: \u0026#39;bar\u0026#39;, count: 0 } } }).mount(\u0026#39;#demo\u0026#39;); // mountç”¨äºæŒ‡å®šä¸€ä¸ªé¡µé¢å·²å­˜åœ¨çš„DOMå…ƒç´ æŒ‚è½½Vueå®ä¾‹ // è¯¥æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå®¹å™¨å‚æ•°ï¼Œå®ƒå¯ä»¥æ˜¯HTMLElementï¼Œä¹Ÿå¯ä»¥æ˜¯CSSé€‰æ‹©å™¨ \u0026lt;/script\u0026gt; import { createApp } from \u0026#39;vue\u0026#39; const app = createApp({ data() { return { count: 0 } } }) app.mount(\u0026#39;#demo\u0026#39;) å½“æ ¹ç»„ä»¶æ²¡æœ‰è®¾ç½® template é€‰é¡¹æ—¶ï¼ŒVue å°†è‡ªåŠ¨ä½¿ç”¨å®¹å™¨çš„ innerHTML ä½œä¸ºæ¨¡æ¿ã€‚è€Œä¸Šé¢çš„ä¾‹å­ä½¿ç”¨äº†å…¨å±€æ„å»ºç‰ˆçš„ Vue ï¼Œè¯¥ç‰ˆæœ¬çš„æ‰€æœ‰ API éƒ½æš´éœ²åœ¨äº†å…¨å±€å˜é‡ Vue ä¸Šã€‚\n:warning: Caution ä»…ä¾›å¼€å‘ä½¿ç”¨ï¼Œä¸è¦ç”¨åœ¨ç”Ÿäº§ç¯å¢ƒä¸Š\nè„šæ‰‹æ¶*^Scaffold^* @vue/cli æ˜¯ Vue å®˜æ–¹æä¾›çš„ä¸€ä¸ªå…¨å±€æ¨¡å—åŒ…ï¼Œæ­¤åŒ…ç”¨äºåˆ›å»ºè„šæ‰‹æ¶é¡¹ç›®ã€‚\npnpm i -g @vue/cli æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸï¼š\nvue -v åˆ›å»ºé¡¹ç›®ï¼š\nvue create vuecli-demo â—ï¸ Warning name can no longer contain capital letters\né…ç½®*^Configuation^* åº”ç”¨çº§é€‰é¡¹ åº”ç”¨å®ä¾‹ä¼šæš´éœ²ä¸€ä¸ª .config å¯¹è±¡å…è®¸æˆ‘ä»¬é…ç½®ä¸€äº›åº”ç”¨çº§çš„é€‰é¡¹ï¼Œä¾‹å¦‚å®šä¹‰ä¸€ä¸ªåº”ç”¨çº§çš„é”™è¯¯å¤„ç†å™¨ï¼Œå®ƒå°†æ•è·æ‰€æœ‰ç”±å­ç»„ä»¶ä¸ŠæŠ›è€Œæœªè¢«å¤„ç†çš„é”™è¯¯ï¼š\napp.config.errorHandler = (err) =\u0026gt; { /* å¤„ç†é”™è¯¯ */ } åº”ç”¨å®ä¾‹è¿˜æä¾›äº†ä¸€äº› æ–¹æ³•^methods^ æ¥æ³¨å†Œåº”ç”¨èŒƒå›´å†…å¯ç”¨çš„èµ„æºï¼Œä¾‹å¦‚æ³¨å†Œä¸€ä¸ªå…¨å±€ ç»„ä»¶^component^ ï¼š\napp.component(\u0026#39;TodoDeleteButton\u0026#39;, TodoDeleteButton) è¿™ä½¿å¾— \u0026lt;TodoDeleteButton/\u0026gt; åœ¨åº”ç”¨çš„ä»»ä½•åœ°æ–¹éƒ½æ˜¯å¯ç”¨çš„ã€‚\ncreateApp API å…è®¸å¤šä¸ª Vue åº”ç”¨å…±å­˜äºåŒä¸€ä¸ªé¡µé¢ä¸Šï¼Œè€Œä¸”æ¯ä¸ªåº”ç”¨éƒ½æ‹¥æœ‰è‡ªå·±çš„ç”¨äºé…ç½®å’Œå…¨å±€èµ„æºçš„ä½œç”¨åŸŸã€‚\nconst app1 = createApp({ /* ... */ }) app1.mount(\u0026#39;#container-1\u0026#39;) const app2 = createApp({ /* ... */ }) app2.mount(\u0026#39;#container-2\u0026#39;) åœ¨ Vue2 ä¸­ï¼Œå¯ä»¥å¦‚æ­¤é…ç½®ä¸€ä¸ª V-bus æ¥ä¼ é€’ä¸åŒç»„ä»¶ä¹‹é—´çš„æ•°æ®ï¼Œç°å·²è¢«ä¸“ç”¨çš„çŠ¶æ€ç®¡ç†å™¨ Vuex/pinia ä»£æ›¿ã€‚\nå¦‚æœä½ æ­£åœ¨ä½¿ç”¨ Vue æ¥å¢å¼ºæœåŠ¡ç«¯æ¸²æŸ“ HTMLï¼Œå¹¶ä¸”åªæƒ³è¦ Vue å»æ§åˆ¶ä¸€ä¸ªå¤§å‹é¡µé¢ä¸­ç‰¹æ®Šçš„ä¸€å°éƒ¨åˆ†ï¼Œåº”é¿å…å°†ä¸€ä¸ªå•ç‹¬çš„ Vue åº”ç”¨å®ä¾‹æŒ‚è½½åˆ°æ•´ä¸ªé¡µé¢ä¸Šï¼Œè€Œæ˜¯åº”è¯¥åˆ›å»ºå¤šä¸ªå°çš„åº”ç”¨å®ä¾‹ï¼Œå°†å®ƒä»¬åˆ†åˆ«æŒ‚è½½åˆ°æ‰€éœ€çš„å…ƒç´ ä¸Šå»ã€‚\nå†…ç½®æœåŠ¡å™¨ ä½¿ç”¨å†…ç½®çš„æœåŠ¡å™¨è¿›è¡Œæ¸²æŸ“çš„æ—¶å€™ï¼Œå¯ä»¥åœ¨ vue.config.js ä¸­æŒ‡å®šç«¯å£ã€‚\n// vue è„šæ‰‹æ¶é¡¹ç›® - é»˜è®¤çš„é…ç½®æ–‡ä»¶å // webpack+node ç¯å¢ƒ - å¯¼å‡ºé…ç½®å¯¹è±¡ module.exports = { devServer: { port: 3000, open: true // è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ } } ä»£ç æ£€æŸ¥ vue.config.js ä¸­å¯ä»¥æ‰‹åŠ¨é…ç½® eslintï¼š\nmodule.exports = { // ...å…¶å®ƒé…ç½® lintOnSave: false // å…³é—­ eslint æ£€æŸ¥ } æŒ‡ä»¤*^Directives^* æŒ‡ä»¤æ˜¯ç”¨äº è¾…åŠ©å¼€å‘è€…æ¸²æŸ“åŸºæœ¬çš„é¡µé¢ç»“æ„ ã€‚Vue æä¾›äº†è®¸å¤šå†…ç½®æŒ‡ä»¤ï¼Œå…¶é™¤äº† v-forã€v-on å’Œ v-slot ï¼Œå¤§å¤šæ•°æŒ‡ä»¤ attribute çš„æœŸæœ›å€¼ä¸ºä¸€ä¸ª JavaScript è¡¨è¾¾å¼ã€‚ä½¿ç”¨æŒ‡ä»¤æ˜¯ä¸ºäº†åœ¨å…¶è¡¨è¾¾å¼å€¼å˜åŒ–æ—¶ å“åº”å¼*^Responsive^* åœ°å¯¹ DOM åº”ç”¨æ›´æ–°ã€‚\nvue ä¸­æŒ‡ä»¤å¤§è‡´å¯ä»¥åˆ†ä¸ºå¦‚ä¸‹ 3 ç±»ï¼š\næ¸²æŸ“ã€ç»‘å®šã€è¿‡æ»¤\nVue ä¸­æœ‰ 2 ç§æ•°æ®ç»‘å®šçš„æ–¹å¼ï¼š\nå•å‘ç»‘å®š âŸ¹\nv-bind æ•°æ®åªèƒ½ä» data æµå‘é¡µé¢\nåŒå‘ç»‘å®š âŸº\nv-model æ•°æ®ä¸ä»…èƒ½ä» data æµå‘é¡µé¢ï¼Œè¿˜å¯ä»¥ä»é¡µé¢æµå‘ data\n:memo: Note\nåŒå‘ç»‘å®šä¸€èˆ¬éƒ½åº”ç”¨åœ¨è¡¨å•ç±»å…ƒç´ ä¸Šï¼Œå¦‚ \u0026lt;input\u0026gt; \u0026lt;select\u0026gt; \u0026lt;textarea\u0026gt; ç­‰ v-model: value å¯ä»¥ç®€å†™ä¸º v-model ï¼Œå› ä¸º v-model é»˜è®¤æ”¶é›†çš„å°±æ˜¯ value å€¼ï¼Œåªèƒ½åº”ç”¨åœ¨è¡¨å•ç±»å…ƒç´ ï¼ˆè¾“å…¥ç±»å…ƒç´ ï¼‰ä¸Š æ¸²æŸ“*^Render^* å†…å®¹*^Contents^* Vue æ¨¡æ¿è¯­æ³•åˆ†ä¸º æ’å€¼è¯­æ³•*^mustache^* å’Œ æ¨¡ç‰ˆè¯­æ³•*^template^* ã€‚\n{{}} ç”¨äºè§£ææ ‡ç­¾ä½“çš„å†…å®¹ã€‚\n{{...}} ä¸º Mustache è¯­æ³•æ’å€¼è¡¨è¾¾å¼interpolation expression æ”¯æŒ JavaScript è¡¨è¾¾å¼ ^expression^ï¼Œä¸”å¯åœ¨çœç•¥ this æŒ‡é’ˆçš„åŒæ—¶è¯»å–åˆ° data() æ–¹æ³•è¿”å›çš„æ‰€æœ‰å±æ€§ã€‚\n:memo: Note JS è¡¨è¾¾å¼*^expression^* å’Œ JS è¯­å¥*^statement^*\nè¡¨è¾¾å¼ï¼šä¸€ä¸ªè¡¨è¾¾å¼ä¼šäº§ç”Ÿä¸€ä¸ª å€¼*^value^* ï¼Œå¯ä»¥æ”¾åœ¨ä»»ä½•ä¸€ä¸ªéœ€è¦å€¼çš„åœ°æ–¹\n1. a\t2. a+b 3. demo(1) 4. love ? \u0026#39;^_^\u0026#39; : \u0026#39;~_~\u0026#39; è¯­å¥\n1. if(){}\t2. for(){} v-text æ›´æ–°å…ƒç´ çš„æ–‡æœ¬å†…å®¹ï¼Œå¹¶è¦†ç›– DOM å…ƒç´ åŸæœ‰çš„æ–‡æœ¬ã€‚\nv-text é€šè¿‡è®¾ç½®å…ƒç´ çš„ textContent å±æ€§æ¥å·¥ä½œï¼Œå› æ­¤å®ƒå°†è¦†ç›–å…ƒç´ ä¸­æ‰€æœ‰ç°æœ‰çš„å†…å®¹ã€‚å¦‚æœä½ éœ€è¦æ›´æ–° textContent çš„éƒ¨åˆ†ï¼Œåº”è¯¥ä½¿ç”¨ mustache interpolations ä»£æ›¿ã€‚\nğŸ“ƒ Example\n\u0026lt;!-- æŠŠ username å¯¹åº”çš„å€¼ï¼Œæ¸²æŸ“åˆ°ç¬¬ä¸€ä¸ª p æ ‡ç­¾ä¸­ --\u0026gt; \u0026lt;p v-text=\u0026#34;username\u0026#34;\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;!-- æŠŠ gender å¯¹åº”çš„å€¼ï¼Œæ¸²æŸ“åˆ°ç¬¬äºŒä¸ª p æ ‡ç­¾ä¸­ --\u0026gt; \u0026lt;!-- NOTE: ç¬¬äºŒä¸ª p æ ‡ç­¾ä¸­ï¼Œé»˜è®¤çš„æ–‡æœ¬ä¼šè¢« gender çš„å€¼æ‰€è¦†ç›– --\u0026gt; \u0026lt;p v-text=\u0026#34;gender\u0026#34;\u0026gt;æ€§åˆ«\u0026lt;/p\u0026gt; v-html åŒå¤§æ‹¬å·è¯­æ³•{{...}} å°†ä¼šå°†æ•°æ®è¿‡æ»¤æ’å€¼ä¸ºçº¯æ–‡æœ¬ï¼Œè€Œä¸æ˜¯ HTMLã€‚è‹¥æƒ³æ’å…¥ rawHTMLï¼Œéœ€è¦ä½¿ç”¨ v-html æŒ‡ä»¤ã€‚\n\u0026lt;p\u0026gt;Using text interpolation: {{ rawHtml }}\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;Using v-html directive: \u0026lt;span v-html=\u0026#34;rawHtml\u0026#34;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;/p\u0026gt; Using text interpolation: \u0026lt;span style=\"color: red\"\u0026gt;This should be red.\u0026lt;/span\u0026gt; Using v-html directive: This should be red. â—ï¸ Warning åœ¨ç½‘ç«™ä¸ŠåŠ¨æ€æ¸²æŸ“ä»»æ„ HTML æ˜¯éå¸¸å±é™©çš„ï¼Œå› ä¸ºè¿™éå¸¸å®¹æ˜“é€ æˆ XSS æ¼æ´ã€‚è¯·ä»…åœ¨å†…å®¹å®‰å…¨å¯ä¿¡æ—¶å†ä½¿ç”¨ v-htmlï¼Œå¹¶ä¸” æ°¸è¿œä¸è¦ ä½¿ç”¨ç”¨æˆ·æä¾›çš„ HTML å†…å®¹ã€‚\næ¡ä»¶*^Condition^* ç”¨äº DOM çš„æ˜¾ç¤ºå’Œéšè—ã€‚\nv-show æ¡ä»¶æ¸²æŸ“ã€æ¡ä»¶æ˜¾ç¤º\nv-show(falseï¼‰= display:none ï¼Œå¯ä»¥å½±å“æ–‡æ¡£æµæ’ç‰ˆã€‚\n\u0026lt;h1 v-for=\u0026#34;count in 5\u0026#34; v-text=\u0026#34;count\u0026#34; v-show=\u0026#34;false\u0026#34;\u0026gt;\u0026lt;/h1\u0026gt; v-if, v-else-if, v-else æ¡ä»¶åˆ†æ”¯æ˜¾ç¤ºï¼Œæ•ˆæœç­‰åŒäº v-show ã€‚\n\u0026lt;h1 v-if=\u0026#34;a \u0026lt; 1\u0026#34;\u0026gt; æˆ‘æ˜¯å°äº1\u0026lt;/h1\u0026gt; \u0026lt;h1 v-else-if=\u0026#34;a == 1\u0026#34;\u0026gt; æˆ‘æ˜¯ç­‰äº1\u0026lt;/h1\u0026gt; \u0026lt;h1 v-else\u0026gt; æˆ‘æ˜¯å¤§äº1\u0026lt;/h1\u0026gt; :memo: Note\nv-if åœ¨ false çš„æ—¶å€™å°†ä¸ä¼šæŒ‚è½½åˆ° DOM\nv-show åœ¨ false çš„æ—¶å€™ï¼Œå…ƒç´ è¿˜åœ¨ï¼Œåªæ˜¯æ ·å¼å˜æˆäº† display:none\nv-if: æ€§èƒ½æ›´å·®ï¼Œå®‰å…¨æ€§æ›´é«˜\nv-show: æ€§èƒ½æ›´ä¼˜ï¼ŒåŒæ ·å®‰å…¨æ€§æ›´ä½ï¼Œå› æ­¤é€‚åˆç”¨äºéœ€è¦é¢‘ç¹åœ¨ æ˜¾ç¤º^display^ ä¸ éšè—^hidden^ ä¹‹é—´åˆ‡æ¢çš„åœºæ™¯ï¼ˆæ¯”å¦‚ï¼šèœå•æ ï¼‰\nä½†æ˜¯é€šå¸¸ï¼Œv-if å’Œ v-show æ˜¯å¯æ··ç”¨çš„\nåˆ—è¡¨*^List^* v-for æ•°ç»„å¾ªç¯ item in items ï¼Œå¯ä»¥å¯¹æ•°å­—ã€æ•°ç»„ã€å¯¹è±¡ç­‰è¿›è¡Œå¾ªç¯éå†ã€‚åŒæ—¶æ”¯æŒä¸€ä¸ªå¯é€‰çš„ç´¢å¼•å‚æ•°ï¼Œè¯­æ³•ä¸º (item, index) in items ã€‚\n\u0026lt;tag v-for=\u0026#34;(å€¼å˜é‡å, ç´¢å¼•å˜é‡å)\u0026#34; in ç›®æ ‡ç»“æ„\u0026gt;\u0026lt;/tag\u0026gt; \u0026lt;tag v-for=\u0026#34;å€¼å˜é‡å in ç›®æ ‡ç»“æ„\u0026#34;\u0026gt;\u0026lt;/tag\u0026gt; \u0026lt;h1 v-for=\u0026#34;(item, index) in arr\u0026#34; v-text=\u0026#34;item\u0026#34;\u0026gt;\u0026lt;/h1\u0026gt; \u0026lt;script\u0026gt; data: { list: [ // åˆ—è¡¨æ•°æ® { id:1, name: \u0026#39;a\u0026#39; }, { id:2, name: \u0026#39;b\u0026#39; } ] } \u0026lt;/script\u0026gt; v-for å†…éƒ¨ä½¿ç”¨çš„æ˜¯ for-in å¾ªç¯ï¼Œå‚æ•°å¦‚ä¸‹ï¼š\nitem: è¡¨ç¤ºéå†è¿‡ç¨‹çš„æ¯ä¸€é¡¹å…ƒç´  å…ƒç´ å¯èƒ½æ˜¯ç®€å•åœ°æ•°æ®ç±»å‹ä¹Ÿå¯èƒ½æ˜¯å¤æ‚çš„æ•°æ®ç±»å‹ index: è¡¨ç¤ºéå†è¿‡ç¨‹çš„æ¯ä¸€é¡¹å…ƒç´ çš„ä¸‹æ ‡ :memo: Note\nv-for: çš„ä½œç”¨åŸŸå‘å†…ï¼Œå³æ‰€æœ‰çš„å­å…ƒç´ éƒ½å¯ä»¥å…±äº« item, index, arr ä¸‰ä¸ªå˜é‡\nå¯ä»¥ä¸ä¼ å…¥ index å˜é‡ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š\n\u0026lt;h1 v-for=\u0026#34;item in arr\u0026#34; v-text=\u0026#34;item\u0026#34;\u0026gt;\u0026lt;/h1\u0026gt; \u0026lt;!-- è®¡æ•° --\u0026gt; \u0026lt;h1 v-for=\u0026#34;count in 100\u0026#34; v-text=\u0026#34;item\u0026#34;\u0026gt;\u0026lt;/h1\u0026gt; âš ï¸ Caution v-for ä¸­çš„ä¸´æ—¶å˜é‡åä¸èƒ½ç”¨åˆ° v-for èŒƒå›´å¤–\nğŸ’¡ Trick å¯¹äºç›´æ¥å˜æ›´åŸæ•°ç»„çš„æ–¹æ³•ï¼Œæ¯”å¦‚ push(), pop(), shift(), unshift(), splice(), sort(), reverse() ç­‰ï¼ŒVue å¯ä»¥ç›‘æµ‹åˆ°ï¼›è€Œå¯¹äºè¿”å›æ–°æ•°ç»„çš„æ–¹æ³•ï¼Œæ¯”å¦‚ map(), forEach(), filter(), concat(), slice()ï¼Œ Vue æ— æ³•ç›‘æµ‹ï¼Œéœ€è¦æ‰‹åŠ¨è¦†ç›–åŸæ•°ç»„ï¼Œæˆ–æ˜¯ä½¿ç”¨ this.set$() æ–¹æ³•è°ƒç”¨ Vue è¢«åŠ¨æ›´æ–°ã€‚\n// æ•ˆæœç›¸å½“äº this.arr[0] = 1000 this.$set(this.arr, 0, 1000) key é»˜è®¤æƒ…å†µä¸‹ï¼ŒVue ä¼šå¤ç”¨å·²å­˜åœ¨çš„ DOM å…ƒç´ ï¼Œä»è€Œæå‡æ¸²æŸ“æ€§èƒ½ã€‚ä½†è¿™ç§é»˜è®¤çš„æ€§èƒ½ä¼˜åŒ–ç­–ç•¥æœ‰æ—¶å€™ä¼šå¯¼è‡´æœ‰çŠ¶æ€çš„åˆ—è¡¨æ— æ³•è¢«æ­£ç¡®æ›´æ–°ã€‚\nåŠ å…¥å”¯ä¸€çš„ :key å±æ€§ä¹‹åï¼ŒVue åŸºäº key æ¥æ¯”è¾ƒæ–°æ—§è™šæ‹Ÿ DOMï¼Œå¯ä»¥åœ¨ä¿è¯æœ‰çŠ¶æ€çš„åˆ—è¡¨è¢«æ­£ç¡®æ›´æ–°çš„å‰æä¸‹ï¼Œæå‡æ¸²æŸ“çš„æ€§èƒ½ã€‚\n\u0026lt;!-- ç”¨æˆ·åˆ—è¡¨åŒºåŸŸ --\u0026gt; \u0026lt;ul\u0026gt; \u0026lt;!-- åŠ keyå±æ€§çš„å¥½å¤„ --\u0026gt; \u0026lt;!-- 1. æ­£ç¡®ç»´æŠ¤åˆ—è¡¨çš„çŠ¶æ€ --\u0026gt; \u0026lt;!-- 2. å¤ç”¨ç°æœ‰çš„DOMå…ƒç´ ï¼Œæå‡æ¸²æŸ“æ€§èƒ½ --\u0026gt; \u0026lt;li v-for=\u0026#34;user in userlist\u0026#34; :key=\u0026#34;user.id\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;checkbox\u0026#34;\u0026gt; å§“åï¼š{{user.name}} \u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; ğŸ“ Note æ¸²æŸ“åˆ—è¡¨éœ€è¦çŠ¶æ€ç›¸å…³é¡¹æ—¶ï¼Œéœ€è¦ key å±æ€§è¿›è¡Œå®šä½ï¼Œä¸”å€¼ id éœ€è¦ä¸ å®é™…æ•°æ® ç»‘å®š\nâš ï¸ Caution ç”±äº index çš„å€¼ä¸å…·æœ‰å”¯ä¸€æ€§ï¼Œå› æ­¤ä¸èƒ½ä½¿ç”¨ index çš„å€¼æ¥ä»£æ›¿ key\næœ‰ key å±æ€§å­˜åœ¨çš„æ—¶å€™ï¼ŒåŸºäº key æ¥æ¯”è¾ƒæ–°æ—§è™šæ‹Ÿ DOMï¼Œå¹¶ç§»é™¤ä¸å­˜åœ¨å…ƒç´ ï¼›æ—  key å­˜åœ¨ï¼Œæˆ–æ˜¯ key ä¸ v-for ä¸­çš„ index å±æ€§ç»‘å®šæ—¶ï¼Œå°±åœ°æ›´æ–°ã€‚\nå³ï¼šæœ‰ id ç”¨ idï¼Œæ—  id ç”¨ç´¢å¼•ã€‚\n// æ—§ v-for=\u0026#34;(obj, index) in arr\u0026#34; :key=\u0026#34;index\u0026#34; // ç”±äºæ²¡æœ‰ç»‘å®šå…·ä½“çš„å†…å®¹ï¼ŒåŠ ä¸åŠ  key æ•ˆæœå®Œå…¨ä¸€æ · // å³ï¼šåœ¨æœ€åæ’å…¥ä¸€ä¸ªæ–°çš„ liï¼Œå¹¶æ›´æ–° li[1], li[2] let arr = [\u0026#34;Î±\u0026#34;, \u0026#34;Î²\u0026#34;, \u0026#34;Î³\u0026#34;] // æ–° v-for=\u0026#34;(obj, index) in arr\u0026#34; :key=\u0026#34;obj.id\u0026#34; // åœ¨ä¸­é—´æ’å…¥æ–°çš„ liï¼Œå…¶å®ƒå…ƒç´ éƒ½ä¸éœ€è¦æ›´æ–°ï¼Œå‡å°‘æ€§èƒ½æŸå¤± let arr = [{ name: \u0026#34;Î±\u0026#34;, id: 0 }, { name: \u0026#34;Î²\u0026#34;, id: 1 }, { name: \u0026#34;Î³\u0026#34;, id: 2 }] v-cloak å½“ç»„ä»¶æœªæ¸²æŸ“å®Œæˆå‰å°†å…¶éšè—ï¼Œè§£å†³é¡µé¢é—ªçƒé—®é¢˜ã€‚\nç»‘å®š*^Bind^* å±æ€§*^Props^* v-bind ^:^ åŒå¤§æ‹¬å·ä¸èƒ½åœ¨ HTML attributes ä¸­ä½¿ç”¨ã€‚ç›¸åº”çš„ï¼Œåº”è¯¥ä½¿ç”¨ v-bind: æŒ‡ä»¤ï¼Œç”¨äºè§£ææ ‡ç­¾^åŒ…æ‹¬ï¼šæ ‡ç­¾å±æ€§ã€æ ‡ç­¾ä½“å†…å®¹ã€ç»‘å®šäº‹ä»¶^ å¹¶ä¸ ç›¸åº”å˜é‡ ç»‘å®šã€‚\n:page_with_curl: Example\n\u0026lt;a v-bind:href=\u0026#34;address\u0026#34;\u0026gt;Â¶\u0026lt;/a\u0026gt; \u0026lt;!-- æˆ–ç®€å†™ä¸º --\u0026gt; \u0026lt;a :href=\u0026#34;address\u0026#34;\u0026gt;Â¶\u0026lt;/a\u0026gt; \u0026lt;script\u0026gt; address: ...; \u0026lt;/script\u0026gt; ğŸ’¡ Trick å¸ƒå°”å‹Attribute\nä¼ å…¥ å¸ƒå°”å€¼*^boolean^* ä¾æ® true / false å€¼æ¥å†³å®š attribute æ˜¯å¦åº”è¯¥å­˜åœ¨äºè¯¥å…ƒç´ ä¸Šã€‚disabled å°±æ˜¯æœ€å¸¸è§çš„ä¾‹å­ä¹‹ä¸€ã€‚\nv-bind åœ¨è¿™ç§åœºæ™¯ä¸‹çš„è¡Œä¸ºç•¥æœ‰ä¸åŒï¼š\n\u0026lt;button :disabled=\u0026#34;isButtonDisabled\u0026#34;\u0026gt;Button\u0026lt;/button\u0026gt; å½“ isButtonDisabled ä¸º çœŸå€¼*^true^* æˆ–ä¸€ä¸ª ç©ºå­—ç¬¦ä¸² \u0026lt;button disabled=\u0026quot;\u0026quot;\u0026gt; æ—¶ï¼Œå…ƒç´ ä¼šåŒ…å«è¿™ä¸ª disabled attributeã€‚è€Œå½“å…¶ä¸º å‡å€¼ falsy,exclude empty string æ—¶ attribute å°†è¢«å¿½ç•¥ã€‚\nâš ï¸ Caution ä¼ å…¥å­—ç¬¦ä¸²æ—¶ Attr ä»ç„¶å­˜åœ¨\nåŠ¨æ€ç»‘å®šå¤šä¸ªå€¼\nå¦‚æœä½ æœ‰åƒè¿™æ ·çš„ä¸€ä¸ªåŒ…å«å¤šä¸ª attribute çš„ JavaScript å¯¹è±¡ï¼š\ndata() { return { objectOfAttrs: { id: \u0026#39;container\u0026#39;, class: \u0026#39;wrapper\u0026#39; } } } é€šè¿‡ä¸å¸¦å‚æ•°çš„ v-bind ï¼Œä½ å¯ä»¥å°†å®ƒä»¬ç»‘å®šåˆ°å•ä¸ªå…ƒç´ ä¸Šï¼š\n\u0026lt;div v-bind=\u0026#34;objectOfAttrs\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; :memo: Note\nå¯ä»¥åœ¨ç»‘å®šçš„è¡¨è¾¾å¼ä¸­ä½¿ç”¨ä¸€ä¸ªç»„ä»¶æš´éœ²çš„æ–¹æ³•ï¼š\n\u0026lt;span :title=\u0026#34;toTitleDate(date)\u0026#34;\u0026gt; {{ formatDate(date) }} \u0026lt;/span\u0026gt; ç»‘å®šåœ¨è¡¨è¾¾å¼ä¸­çš„æ–¹æ³•åœ¨ç»„ä»¶æ¯æ¬¡æ›´æ–°æ—¶éƒ½ä¼šè¢«é‡æ–°è°ƒç”¨ï¼Œå› æ­¤ ä¸åº”è¯¥ äº§ç”Ÿä»»ä½•å‰¯ä½œç”¨ï¼Œæ¯”å¦‚ æ”¹å˜æ•°æ® æˆ– è§¦å‘å¼‚æ­¥æ“ä½œ ã€‚\nåŠ¨æ€å‚æ•°\nåŒæ ·åœ¨æŒ‡ä»¤å‚æ•°ä¸Šä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ª JavaScript è¡¨è¾¾å¼ï¼Œéœ€è¦åŒ…å«åœ¨ä¸€å¯¹æ–¹æ‹¬å·å†…ï¼š\n\u0026lt;!-- æ³¨æ„ï¼Œå‚æ•°è¡¨è¾¾å¼æœ‰ä¸€äº›çº¦æŸï¼Œ å‚è§ä¸‹é¢â€œåŠ¨æ€å‚æ•°å€¼çš„é™åˆ¶â€ä¸â€œåŠ¨æ€å‚æ•°è¯­æ³•çš„é™åˆ¶â€ç« èŠ‚çš„è§£é‡Š --\u0026gt; \u0026lt;a v-bind:[attributeName]=\u0026#34;url\u0026#34;\u0026gt; ... \u0026lt;/a\u0026gt; \u0026lt;!-- ç®€å†™ --\u0026gt; \u0026lt;a :[attributeName]=\u0026#34;url\u0026#34;\u0026gt; ... \u0026lt;/a\u0026gt; è¿™é‡Œçš„ attributeName ä¼šä½œä¸ºä¸€ä¸ª JavaScript è¡¨è¾¾å¼è¢«åŠ¨æ€æ‰§è¡Œï¼Œè®¡ç®—å¾—åˆ°çš„å€¼ä¼šè¢«ç”¨ä½œæœ€ç»ˆçš„å‚æ•°ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä½ çš„ç»„ä»¶å®ä¾‹æœ‰ä¸€ä¸ªæ•°æ® property attributeNameï¼Œå…¶å€¼ä¸º \u0026quot;href\u0026quot;ï¼Œé‚£ä¹ˆè¿™ä¸ªç»‘å®šå°±ç­‰ä»·äº v-bind:hrefã€‚\nç›¸ä¼¼åœ°ï¼Œä½ è¿˜å¯ä»¥å°†ä¸€ä¸ªå‡½æ•°ç»‘å®šåˆ°åŠ¨æ€çš„äº‹ä»¶åç§°ä¸Šï¼š\n\u0026lt;a v-on:[eventName]=\u0026#34;doSomething\u0026#34;\u0026gt; ... \u0026lt;/a\u0026gt; \u0026lt;!-- ç®€å†™ --\u0026gt; \u0026lt;a @[eventName]=\u0026#34;doSomething\u0026#34;\u0026gt; åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå½“ eventName çš„å€¼æ˜¯ \u0026quot;focus\u0026quot; æ—¶ï¼Œv-on:[eventName] å°±ç­‰ä»·äº v-on:focusã€‚\nåŠ¨æ€å‚æ•°å€¼çš„é™åˆ¶\nåŠ¨æ€å‚æ•°æœŸæœ›ç»“æœä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæˆ–è€…æ˜¯ nullã€‚ç‰¹æ®Šå€¼ null æ„ä¸ºæ˜¾å¼ç§»é™¤è¯¥ç»‘å®šã€‚ä»»ä½•å…¶ä»–éå­—ç¬¦ä¸²çš„å€¼éƒ½å°†è§¦å‘ä¸€ä¸ªè­¦å‘Šã€‚\nåŠ¨æ€å‚æ•°è¯­æ³•çš„é™åˆ¶\nåŠ¨æ€å‚æ•°è¡¨è¾¾å¼å› ä¸ºæŸäº›å­—ç¬¦çš„ç¼˜æ•…æœ‰ä¸€äº›è¯­æ³•é™åˆ¶ï¼Œæ¯”å¦‚ç©ºæ ¼å’Œå¼•å·ï¼Œåœ¨ HTML attribute åç§°ä¸­éƒ½æ˜¯ä¸åˆæ³•çš„ã€‚ä¾‹å¦‚ä¸‹é¢çš„ç¤ºä¾‹ï¼š\n\u0026lt;!-- è¿™ä¼šè§¦å‘ä¸€ä¸ªç¼–è¯‘å™¨è­¦å‘Š --\u0026gt; \u0026lt;a :[\u0026#39;foo\u0026#39; + bar]=\u0026#34;value\u0026#34;\u0026gt; ... \u0026lt;/a\u0026gt; å¦‚æœä½ éœ€è¦ä¼ å…¥ä¸€ä¸ªå¤æ‚çš„åŠ¨æ€å‚æ•°ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨ è®¡ç®—å±æ€§ æ›¿æ¢å¤æ‚çš„è¡¨è¾¾å¼ã€‚\nå½“ä½¿ç”¨ DOM å†…åµŒæ¨¡æ¿ (ç›´æ¥å†™åœ¨ HTML æ–‡ä»¶é‡Œçš„æ¨¡æ¿) æ—¶ï¼Œæˆ‘ä»¬éœ€è¦é¿å…åœ¨åç§°ä¸­ä½¿ç”¨å¤§å†™å­—æ¯ï¼Œå› ä¸ºæµè§ˆå™¨ä¼šå¼ºåˆ¶å°†å…¶è½¬æ¢ä¸ºå°å†™ï¼š\n\u0026lt;a :[someAttr]=\u0026#34;value\u0026#34;\u0026gt; ... \u0026lt;/a\u0026gt; ä¸Šé¢çš„ä¾‹å­å°†ä¼šåœ¨ DOM å†…åµŒæ¨¡æ¿ä¸­è¢«è½¬æ¢ä¸º :[someattr]ã€‚å¦‚æœä½ çš„ç»„ä»¶æ‹¥æœ‰ â€œsomeAttrâ€ property è€Œé â€œsomeattrâ€ï¼Œè¿™æ®µä»£ç å°†ä¸ä¼šå·¥ä½œã€‚\n:style â‡† :class\nåœ¨å®é™…å¼€å‘ä¸­ç»å¸¸ä¼šé‡åˆ°åŠ¨æ€æ“ä½œå…ƒç´ æ ·å¼çš„éœ€æ±‚ã€‚å› æ­¤ï¼Œvue å…è®¸å¼€å‘è€…é€šè¿‡ v-bind å±æ€§ç»‘å®šæŒ‡ä»¤ï¼Œä¸ºå…ƒç´ åŠ¨æ€ç»‘å®š class å±æ€§çš„å€¼å’Œè¡Œå†…çš„ style æ ·å¼ã€‚\n\u0026lt;h1 :style=\u0026#34;{color:\u0026#39;red\u0026#39;}\u0026#34;\u0026gt;style\u0026lt;/h1\u0026gt; \u0026lt;!-- ç»‘å®šä¸€ä¸ª js å¯¹è±¡ï¼Œå¹¶åŒæ—¶æ”¯æŒé©¼å³°å¼å’ŒçŸ­æ¨ªåˆ†å‰²ä¸¤ç§æ ·å¼ --\u0026gt; \u0026lt;!-- å¯ä»¥å•ç‹¬æŠŠ{color:\u0026#39;red\u0026#39;}æŠ½å–åˆ°dataé‡Œå¤´ --\u0026gt; \u0026lt;h1 :class=\u0026#34;[\u0026#39;c1\u0026#39;,\u0026#39;c2\u0026#39;]\u0026#34;\u0026gt;class\u0026lt;/h1\u0026gt; \u0026lt;!-- ç»‘å®šä¸€ä¸ª js æ•°ç»„/å¯¹è±¡ï¼Œä¸ºå¯¹è±¡æ—¶é”®å€¼ \u0026lt;!-- å¯ä»¥å•ç‹¬æŠŠ[\u0026#39;ç±»å1\u0026#39;,\u0026#39;ç±»å2\u0026#39;]æŠ½å–å‡ºæ¥ï¼Œä½¿ç”¨ç±»ä¼¼æ•°ç»„çš„è¯­æ³•æ ¼å¼ --\u0026gt; ğŸ“ Note ä½¿ç”¨æ•°ç»„è¯­æ³•åŠ¨æ€ç»‘å®š class ä¼šå¯¼è‡´æ¨¡ç‰ˆç»“æ„è‡ƒè‚¿ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨ å¯¹è±¡è¯­æ³• è¿›è¡Œç®€åŒ–ï¼š\n\u0026lt;h3 class=\u0026#34;thin\u0026#34; :class=\u0026#34;classObj\u0026#34;\u0026gt;MyDeep ç»„ä»¶\u0026lt;/h3\u0026gt; \u0026lt;button @click=\u0026#34;classsObj.italic\u0026#34;\u0026gt;\u0026lt;/button\u0026gt; v-model æ•°æ®åŒå‘ç»‘å®š data âŸº é¡µé¢ ï¼Œè¾…åŠ©å¼€å‘è€…åœ¨ä¸æ“ä½œ DOM çš„å‰æä¸‹ï¼Œå¿«é€Ÿè·å–è¡¨å•çš„æ•°æ®ã€‚\nâš ï¸ Caution åªèƒ½åº”ç”¨åœ¨è¡¨å•ç±»å…ƒç´ ï¼ˆè¾“å…¥ç±»å…ƒç´ ï¼‰/è‡ªå®šä¹‰ç»„ä»¶ä¸Š\n\u0026lt;div id=\u0026#34;demo\u0026#34;\u0026gt; \u0026lt;!-- æ™®é€šå†™æ³• --\u0026gt; å•å‘æ•°æ®ç»‘å®šï¼š\u0026lt;input type=\u0026#34;text\u0026#34; v-bind:value=\u0026#34;name\u0026#34;\u0026gt;\u0026lt;br/\u0026gt; åŒå‘æ•°æ®ç»‘å®šï¼š\u0026lt;input type=\u0026#34;text\u0026#34; v-model:value=\u0026#34;name\u0026#34;\u0026gt;\u0026lt;br/\u0026gt; \u0026lt;!-- ç®€å†™ --\u0026gt; å•å‘æ•°æ®ç»‘å®šï¼š\u0026lt;input type=\u0026#34;text\u0026#34; :value=\u0026#34;value\u0026#34;\u0026gt;\u0026lt;br/\u0026gt; åŒå‘æ•°æ®ç»‘å®šï¼š\u0026lt;input type=\u0026#34;text\u0026#34; v-model=\u0026#34;value\u0026#34;\u0026gt;\u0026lt;br/\u0026gt; ä¿®æ”¹åŒå‘æ•°æ®ç»‘å®šå¯ä»¥åŒæ—¶ä¿®æ”¹å•å‘æ•°æ®ç»‘å®šï¼Œåä¹‹åˆ™ä¸è¡Œ \u0026lt;!-- å¦‚ä¸‹ä»£ç æ˜¯é”™è¯¯çš„ï¼Œå› ä¸º v-model åªèƒ½åº”ç”¨åœ¨è¡¨å•ç±»å…ƒç´ ï¼ˆè¾“å…¥ç±»å…ƒç´ ï¼‰/è‡ªå®šä¹‰ç»„ä»¶ä¸Š --\u0026gt; \u0026lt;h2\u0026gt;\u0026lt;a v-model:title=\u0026#34;name\u0026#34;\u0026gt;Hello World\u0026lt;/a\u0026gt;\u0026lt;/h2\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div\u0026gt; \u0026lt;select v-model=\u0026#34;number\u0026#34;\u0026gt; \u0026lt;!-- ä¸‹æ‹‰èœå•è¦ç»‘å®šåœ¨ select ä¸Š --\u0026gt; \u0026lt;span\u0026gt;letter:\u0026lt;/span\u0026gt; \u0026lt;option value=\u0026#34;A\u0026#34;\u0026gt;A\u0026lt;/option\u0026gt; \u0026lt;option value=\u0026#34;B\u0026#34;\u0026gt;B\u0026lt;/option\u0026gt; \u0026lt;option value=\u0026#34;C\u0026#34;\u0026gt;C\u0026lt;/option\u0026gt; \u0026lt;/select\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div\u0026gt; \u0026lt;span\u0026gt;label:\u0026lt;/span\u0026gt; \u0026lt;!-- å¯¹äºå¤é€‰æ¡†ï¼Œv-model çš„å˜é‡å€¼éæ•°å€¼ï¼Œè€Œæ˜¯å…³è” checked çš„å±æ€§æ•°ç»„ï¼Œå€¼ä¸º value å±æ€§ --\u0026gt; \u0026lt;!-- ç»“æ„ç±»ä¼¼ï¼šnumber: [\u0026#34;1\u0026#34;, \u0026#34;2\u0026#34;] --\u0026gt; \u0026lt;input type=\u0026#34;checkbox\u0026#34; value=\u0026#34;1\u0026#34; v-model=\u0026#34;number\u0026#34;\u0026gt;1 \u0026lt;input type=\u0026#34;checkbox\u0026#34; value=\u0026#34;2\u0026#34; v-model=\u0026#34;number\u0026#34;\u0026gt;2 \u0026lt;input type=\u0026#34;checkbox\u0026#34; value=\u0026#34;3\u0026#34; v-model=\u0026#34;number\u0026#34;\u0026gt;3 \u0026lt;/div\u0026gt; \u0026lt;div\u0026gt; \u0026lt;span\u0026gt;latin:\u0026lt;/span\u0026gt; \u0026lt;!-- name å±æ€§å®ç°å•é€‰ --\u0026gt; \u0026lt;input type=\u0026#34;radio\u0026#34; value=\u0026#34;Î±\u0026#34; name=\u0026#34;latin\u0026#34;\u0026gt;É‘ \u0026lt;input type=\u0026#34;radio\u0026#34; value=\u0026#34;Î²\u0026#34; name=\u0026#34;latin\u0026#34;\u0026gt;Î² \u0026lt;input type=\u0026#34;radio\u0026#34; value=\u0026#34;Î³\u0026#34; name=\u0026#34;latin\u0026#34;\u0026gt;Î³ \u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; // ... value:\u0026#34;This is input value\u0026#34; \u0026lt;/script\u0026gt; âš ï¸ Caution ç”±äº v-model æ˜¯åŒå‘ç»‘å®šï¼Œå› æ­¤ vue å˜é‡åˆå§‹å€¼ä¼šå½±å“è¡¨å•é»˜è®¤çŠ¶æ€ï¼ˆå³ data() å‡½æ•°è¿”å›çš„å€¼ï¼‰\nletter: ABC number: ","date":"2023-03-20","section":"techs","summary":"Vue Vue (å‘éŸ³ä¸º /vjuË/ï¼Œç±»ä¼¼ view) æ˜¯ä¸€æ¬¾ç”¨äºæ„å»º ç”¨æˆ·ç•Œé¢^ui^ çš„æ¸è¿›å¼ JavaScript æ¡†æ¶ã€‚å®ƒä¸æ˜¯ä¸€ä¸ªå…¨èƒ½æ¡†æ¶çš„æ ¸å¿ƒï¼Œåªå…³æ³¨ è§†å›¾å±‚^view^ ï¼Œå› æ­¤éå¸¸å®¹æ˜“å­¦ä¹ ä»¥åŠä¸å…¶å®ƒåº“æˆ–å·²æœ‰é¡¹ç›®æ•´åˆã€‚\næ„å»ºç”¨æˆ·ç•Œé¢ï¼šæŠŠæ•°æ®é€šè¿‡æŸç§åŠæ³•å˜æˆç”¨æˆ·ç•Œé¢ æ¸è¿›å¼ï¼šVue å¯ä»¥è‡ªåº•å‘ä¸Šé€å±‚çš„åº”ç”¨ï¼Œç®€å•åº”ç”¨åªéœ€è¦ä¸€ä¸ªè½»é‡å°å·§çš„æ ¸å¿ƒåº“ï¼Œå¤æ‚åº”ç”¨å¯ä»¥å¼•å…¥å„å¼å„æ ·çš„ Vue æ’ä»¶ åº“ï¼šå°è£…çš„å±æ€§æˆ–æ–¹æ³•ï¼ˆjQueryï¼‰\næ¡†æ¶ï¼šæ‹¥æœ‰è‡ªå·±çš„è§„åˆ™å’Œå…ƒç´ ï¼Œæ¯”åº“å¼ºå¤§çš„å¤šï¼ˆVueï¼‰\nç‰¹ç‚¹*^Feature^* Vue å€Ÿé‰´äº† angular çš„ æ¨¡æ¿^template^ å’Œ æ•°æ®ç»‘å®š^data-bind^ æŠ€æœ¯ã€å€Ÿé‰´ react çš„ ç»„ä»¶åŒ–^component^ å’Œ è™šæ‹Ÿ DOM æŠ€æœ¯ã€‚\nåŒå‘ç»‘å®š Vue.js çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªå“åº”çš„æ•°æ®ç»‘å®šç³»ç»Ÿï¼Œéµå¾ª MVVM*^Model-View-ViewModel^* æ¨¡å‹ ï¼Œå®ƒè®©æ•°æ®ä¸ DOM ä¿æŒåŒæ­¥éå¸¸ç®€å•ã€‚\nM: æ¨¡å‹ ^Model^ - data() ä¸­è¿”å›çš„æ•°æ® B è§†å›¾ ^view^ - æ¨¡ç‰ˆä»£ç  VM è§†å›¾æ¨¡å‹*^view-model^*: è§†å›¾å’Œæ¨¡å‹çš„è¡”æ¥æ¡¥æ¢ åœ¨ä½¿ç”¨ jQuery æ‰‹å·¥æ“ä½œ DOM æ—¶ï¼Œæˆ‘ä»¬çš„ä»£ç å¸¸å¸¸æ˜¯å‘½ä»¤å¼çš„ã€é‡å¤çš„ä¸æ˜“é”™çš„ã€‚ Vue.js æ‹¥æŠ± æ•°æ®é©±åŠ¨data driven çš„è§†å›¾æ¦‚å¿µã€‚é€šä¿—åœ°è®²ï¼Œå®ƒæ„å‘³ç€æˆ‘ä»¬åœ¨æ™®é€š HTML æ¨¡æ¿ä¸­ä½¿ç”¨ç‰¹æ®Šçš„è¯­æ³•å°† DOM â€œç»‘å®šâ€åˆ°åº•å±‚æ•°æ®ã€‚ä¸€æ—¦åˆ›å»ºäº†ç»‘å®šï¼ŒDOM å°†ä¸æ•°æ®ä¿æŒåŒæ­¥ã€‚ æ¯å½“ä¿®æ”¹äº†æ•°æ®ï¼ŒDOM ä¾¿ç›¸åº”åœ°æ›´æ–°ã€‚\n","title":"15 Vue","url":"/techs/15-vue/"},{"content":"React å¼€å§‹ Create React App æ˜¯ä¸€ä¸ªå®˜æ–¹æ”¯æŒçš„åˆ›å»º React å•é¡µåº”ç”¨ç¨‹åºçš„æ–¹æ³•ã€‚å®ƒæä¾›äº†ä¸€ä¸ªé›¶é…ç½®çš„ç°ä»£æ„å»ºè®¾ç½®ã€‚\nå®‰è£… npx npx create-react-app my-app #ä½¿ç”¨ TypeScript npx create-react-app my-app --typescript cd my-app npm start (npx æ¥è‡ª npm 5.2+ æˆ–æ›´é«˜ç‰ˆæœ¬, æŸ¥çœ‹ npm æ—§ç‰ˆæœ¬çš„è¯´æ˜)\nnpm npm init react-app my-app npm init \u0026lt;initializer\u0026gt; åœ¨ npm 6+ ä¸­å¯ç”¨\nyarn yarn create react-app my-app ğŸ“ Note yarn create åœ¨ Yarn 0.25+ ä¸­å¯ç”¨\nç„¶åæ‰“å¼€ http://localhost:3000/ æŸ¥çœ‹ä½ çš„åº”ç”¨ã€‚\nå½“ä½ å‡†å¤‡éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ—¶ï¼Œä½¿ç”¨ npm run build åˆ›å»ºä¸€ä¸ªç»è¿‡ [WebPack](10 WebPack) å‹ç¼©åçš„ åŒ…*^bundle^* ã€‚\né…ç½® Webpack ä¸ Babel å®ƒä»¬æ˜¯é¢„å…ˆé…ç½®å¥½å¹¶ä¸”éšè—çš„ï¼Œå› æ­¤ä½ å¯ä»¥ä¸“æ³¨äºä»£ç ã€‚\nåªéœ€åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼Œå°±å¯ä»¥äº†ã€‚\nå®‰è£…ç¬¬ä¸‰æ–¹æ’ä»¶ åœ¨ VS Code å•†åº—é‡Œä¸‹è½½\nsimple react å¿«é€Ÿç”Ÿæˆreactæ¨¡ç‰ˆï¼Œå¯ä»¥çœ‹æ’ä»¶å…·ä½“æ–‡æ¡£\nç¼–è¾‘å™¨ä¸­è¾“å…¥ccç”Ÿæˆç±»ç»„ä»¶ï¼Œsfcç”Ÿæˆå‡½æ•°ç¤ºç»„ä»¶\nprettier æ ¼å¼åŒ–ä»£ç \nmodule.exports = { // ä¸€è¡Œæœ€å¤š 100 å­—ç¬¦ printWidth: 100, // ä½¿ç”¨ 2 ä¸ªç©ºæ ¼ç¼©è¿› tabWidth: 2, // ä¸ä½¿ç”¨ç¼©è¿›ç¬¦ï¼Œè€Œä½¿ç”¨ç©ºæ ¼ useTabs: false, // è¡Œå°¾éœ€ä¸è¦æœ‰åˆ†å· semi: false, // ä½¿ç”¨å•å¼•å· singleQuote: true, // å¯¹è±¡çš„ key ä»…åœ¨å¿…è¦æ—¶ç”¨å¼•å· quoteProps: \u0026#39;as-needed\u0026#39;, // jsx ä¸ä½¿ç”¨å•å¼•å·ï¼Œè€Œä½¿ç”¨åŒå¼•å· jsxSingleQuote: true, // æœ«å°¾ä¸éœ€è¦é€—å· trailingComma: \u0026#39;none\u0026#39;, // å¤§æ‹¬å·å†…çš„é¦–å°¾éœ€è¦ç©ºæ ¼ bracketSpacing: true, // jsx æ ‡ç­¾çš„åå°–æ‹¬å·éœ€è¦æ¢è¡Œ jsxBracketSameLine: false, // ç®­å¤´å‡½æ•°ï¼Œåªæœ‰ä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦æ‹¬å· arrowParens: \u0026#39;always\u0026#39;, // æ¯ä¸ªæ–‡ä»¶æ ¼å¼åŒ–çš„èŒƒå›´æ˜¯æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹ rangeStart: 0, rangeEnd: Infinity, // ä¸éœ€è¦å†™æ–‡ä»¶å¼€å¤´çš„ @prettier requirePragma: false, // ä¸éœ€è¦è‡ªåŠ¨åœ¨æ–‡ä»¶å¼€å¤´æ’å…¥ @prettier insertPragma: false, // ä½¿ç”¨é»˜è®¤çš„æŠ˜è¡Œæ ‡å‡† proseWrap: \u0026#39;preserve\u0026#39;, // æ ¹æ®æ˜¾ç¤ºæ ·å¼å†³å®š html è¦ä¸è¦æŠ˜è¡Œ htmlWhitespaceSensitivity: \u0026#39;css\u0026#39;, // æ¢è¡Œç¬¦ä½¿ç”¨ lf // endOfLine: \u0026#39;lf\u0026#39;, // åœ¨å¯¹è±¡ï¼Œæ•°ç»„æ‹¬å·ä¸æ–‡å­—ä¹‹é—´åŠ ç©ºæ ¼ \u0026#34;{ foo: bar }\u0026#34; bracketSpacing: true } é…ç½® vscode ç¼–è¾‘é…ç½®æ–‡ä»¶\nå¯ä»¥é…ç½®é’ˆå¯¹è¯¥é¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œåœ¨æ ¹ç›®å½•åˆ›å»º .vscode/settings.json\nsettings.json é…ç½®ä¿¡æ¯\n{ \u0026#34;eslint.autoFixOnSave\u0026#34;: true, //eslintä¿å­˜æ ¼å¼åŒ– \u0026#34;prettier.eslintIntegration\u0026#34;: true, // è®©prettieréµå¾ªeslintæ ¼å¼ç¾åŒ– \u0026#34;eslint.enable\u0026#34;: true, //æ˜¯å¦å¼€å¯vscodeçš„eslint \u0026#34;files.eol\u0026#34;: \u0026#34;\\n\u0026#34;, \u0026#34;editor.tabSize\u0026#34;: 2, \u0026#34;editor.formatOnSave\u0026#34;: true, \u0026#34;editor.defaultFormatter\u0026#34;: \u0026#34;esbenp.prettier-vscode\u0026#34;, \u0026#34;eslint.validate\u0026#34;: [\u0026#34;javascript\u0026#34;, \u0026#34;javascriptreact\u0026#34;, \u0026#34;html\u0026#34;, \u0026#34;typescript\u0026#34;, \u0026#34;typescriptreact\u0026#34;], //ç¡®å®šæ ¡éªŒå‡†åˆ™ \u0026#34;files.associations\u0026#34;: { \u0026#34;*.jsx\u0026#34;: \u0026#34;javascriptreact\u0026#34; }, \u0026#34;typescript.tsdk\u0026#34;: \u0026#34;node_modules/typescript/lib\u0026#34;, \u0026#34;editor.codeActionsOnSave\u0026#34;: { \u0026#34;source.fixAll.eslint\u0026#34;: true } } ç»“æ„ è¿è¡Œä»»ä½•è¿™äº›å‘½ä»¤éƒ½ä¼šåœ¨å½“å‰ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º my-app çš„ç›®å½•ã€‚åœ¨è¯¥ç›®å½•ä¸­ï¼Œå®ƒå°†ç”Ÿæˆåˆå§‹é¡¹ç›®ç»“æ„å¹¶å®‰è£…ä¾èµ–é¡¹ï¼š\nmy-app â”œâ”€â”€ README.md â”œâ”€â”€ node_modules â”œâ”€â”€ package.json â”œâ”€â”€ .gitignore â”œâ”€â”€ public â”‚ â”œâ”€â”€ favicon.ico â”‚ â”œâ”€â”€ index.html #å…¥å£æ–‡ä»¶ â”‚ â”œâ”€â”€ [robots.txt] #æœç´¢å¼•æ“çˆ¬å–é…ç½®ä¿¡æ¯ â”‚ â””â”€â”€ manifest.json #é…ç½®é¡µé¢éœ€è¦çš„metaä¿¡æ¯ â””â”€â”€ src #é¡¹ç›®ä¸»ç›®å½• â”œâ”€â”€ App.css â”œâ”€â”€ App.js â”œâ”€â”€ App.test.js â”œâ”€â”€ index.css â”œâ”€â”€ index.js â”œâ”€â”€ logo.svg â””â”€â”€ serviceWorker.js index.html å®‰è£…å®Œæˆåï¼Œé€šè¿‡ change directory ^cd^ å‘½ä»¤æ‰“å¼€é¡¹ç›®ç›®å½•ï¼š\ncd my-app å‘½ä»¤ åœ¨æ–°åˆ›å»ºçš„é¡¹ç›®ä¸­ï¼Œä½ å¯ä»¥è¿è¡Œä¸€äº›å†…ç½®å‘½ä»¤ï¼š\nnpm start æˆ– yarn start åœ¨å¼€å‘æ¨¡å¼ä¸‹è¿è¡Œåº”ç”¨ç¨‹åºã€‚ æ‰“å¼€ http://localhost:3000 åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹å®ƒã€‚\nå¦‚æœä½ æ›´æ”¹ä»£ç ï¼Œé¡µé¢å°†è‡ªåŠ¨é‡æ–°åŠ è½½ã€‚ ä½ å°†åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°æ„å»ºé”™è¯¯å’Œ lint è­¦å‘Šã€‚\nnpm test æˆ– yarn test ä»¥äº¤äº’æ¨¡å¼è¿è¡Œæµ‹è¯•è§‚å¯Ÿç¨‹åºã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿è¡Œä¸ä¸Šæ¬¡æäº¤åæ›´æ”¹çš„æ–‡ä»¶ç›¸å…³çš„ æµ‹è¯• ã€‚\nnpm run build æˆ– yarn build å°†ç”Ÿäº§ç¯å¢ƒçš„åº”ç”¨ç¨‹åºæ„å»ºåˆ° build ç›®å½•ã€‚ å®ƒèƒ½å°† React æ­£ç¡®åœ°æ‰“åŒ…ä¸ºç”Ÿäº§æ¨¡å¼ä¸­å¹¶ä¼˜åŒ–æ„å»ºä»¥è·å¾—æœ€ä½³æ€§èƒ½ã€‚\næ„å»ºå°†è¢«å‹ç¼©ï¼Œæ–‡ä»¶åä¸­å°†åŒ…å« å“ˆå¸Œ*^hash^* ã€‚\nè¿™æ ·ä½ çš„åº”ç”¨å·²å‡†å¤‡å¥½éƒ¨ç½²äº†ã€‚\nè¯­æ³• React ä½¿ç”¨ JSX - JavaScript Syntax Extension è¯­æ³•å£°æ˜ç•Œé¢ã€‚\nâ˜•ï¸ Q\u0026amp;A jsx æ˜¯ä»€ä¹ˆ - Wikipedia\nä¸æ˜¯æ¨¡ç‰ˆå¼•æ“è¯­è¨€ ä½¿ç”¨ æ¨¡ç‰ˆå¼•æ“ è¯­è¨€ Angular å’Œ Vue ä¸­ template çš„è¯­æ³•ï¼Œjs æ¨¡ç‰ˆçš„ä½œç”¨å°±æ˜¯è¾“å…¥æ¨¡ç‰ˆçš„å­—ç¬¦ä¸²+æ•°æ®ï¼Œç»è¿‡æ¸²æŸ“å¾—åˆ°æ¸²æŸ“è¿‡çš„ å­—ç¬¦ä¸²\nJSX ä¸æ˜¯è¿™æ ·çš„æ¨¡ç‰ˆå¼•æ“ï¼Œå®ƒæ˜¯å¸¦è¯­æ³•ç³–çš„ ATX ï¼Œå…¶å®æ˜¯æŠ½è±¡çš„ è¯­æ³•æ ‘ ï¼Œå°† Babel å¯¹è¯­æ³•ç³–çš„è§£ææ”¾åˆ°äº† æ„å»ºé˜¶æ®µnpm run build ï¼Œæ‰€ä»¥è¿è¡Œçš„æ—¶å€™ä¸éœ€è¦è§£æã€‚\nå£°æ˜å¼åˆ›å»ºUIï¼Œå¤„ç†UIé€»è¾‘ éµå¾ªjavascriptè¯­æ³•ï¼Œæ— å­¦ä¹ é—¨æ§› React é€šè¿‡ babel å°† jsx æ ¼å¼è½¬æ¢ä¸ºæµè§ˆå™¨è¯†åˆ«çš„è¯­è¨€\n// JSX è¯­æ³• const ele = ( \u0026lt;div className=\u0026#34;root\u0026#34;\u0026gt; \u0026lt;p\u0026gt;hello\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; ); // è½¬æ¢å var ele = /*#__PURE__*/React.createElement(\u0026#34;div\u0026#34;, { className: \u0026#34;root\u0026#34; }, /*#__PURE__*/React.createElement(\u0026#34;p\u0026#34;, null, \u0026#34;hello\u0026#34;)); //é€šè¿‡ React#createElement åˆ›å»ºå…ƒç´  è€Œ React#createElement é€šè¿‡å±‚å±‚åµŒå¥—çš„è™šæ‹Ÿ DOM çš„æ–¹æ³•ï¼ŒæŠŠè¾“å…¥çš„è¯­å¥è½¬åŒ–ä¸ºæµè§ˆå™¨èƒ½å¤Ÿè¯†åˆ«çš„ä»£ç ï¼Œè¿™å°±æ˜¯ React èƒŒåçš„åŸç†ã€‚\nè§„åˆ™ åœ¨ JSX ä¸­åµŒå…¥çš„è¡¨è¾¾å¼ï¼Œç”¨ {} ç¬¦å·åŒ…è£¹ å¤§å†™å¼€å¤´ä½œä¸º è‡ªå®šä¹‰ç»„ä»¶ ï¼Œå°å†™ tag ä½œä¸ºåŸç”Ÿçš„ dom èŠ‚ç‚¹ JSX æ ‡ç­¾å¯ä»¥æœ‰ç‰¹å®šå±æ€§å’Œå­å…ƒç´  åªèƒ½æœ‰ ä¸€ä¸ª æ ¹å…ƒç´  // Main.js import React, { Component } from \u0026#39;react\u0026#39;; class Main extends Component { constructor(props) { super(props) this.state = { name: \u0026#34;zs\u0026#34;, age: 12 } } addAge() { return this.state.age + 12 } render() { const flag = true const list = [1, 2, 3] return ( // jsxéœ€è¦ä¸€ä¸ªæ ¹å…ƒç´  \u0026lt;div className=\u0026#34;main\u0026#34;\u0026gt; \u0026lt;p\u0026gt;{this.state.name}\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;{this.state.age \u0026gt; 18 ? \u0026#39;æˆå¹´\u0026#39; : \u0026#39;æœªæˆå¹´\u0026#39;}\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;{this.addAge.call(this)}\u0026lt;/p\u0026gt; {/* ä¸‰å…ƒè¡¨è¾¾å¼åˆ¤æ–­æ˜¾ç¤ºå…ƒç´  */} { flag ? \u0026lt;p\u0026gt;å…ƒç´ 1\u0026lt;/p\u0026gt; : \u0026lt;p\u0026gt;å…ƒç´ 1\u0026lt;/p\u0026gt; } {/* åªèƒ½ç”¨mapå¾ªç¯ */} {list.map((item) =\u0026gt; { return \u0026lt;div key=\u0026#39;item\u0026#39;\u0026gt;{item}\u0026lt;/div\u0026gt; })} \u0026lt;/div\u0026gt; ) } } // ä½¿ç”¨é»˜è®¤è¾“å‡º export default Main; æ¸²æŸ“ Fragment React16+\nReact ä¸­ä¸€ä¸ªç»„ä»¶å¾€å¾€è¦è¿”å›å¤šä¸ªå…ƒç´ ï¼ŒåŒæ—¶ï¼ŒReact åˆè¦æ±‚è¿™äº›å…ƒç´ å¿…é¡»è¢«åŒ…è£¹åœ¨ä¸€ä¸ªå…ƒç´ ä¸‹ï¼Œæœ€æ™®éçš„åšæ³•æ˜¯ç”¨ \u0026lt;div\u0026gt; åŒ…è£¹ã€‚è¿™æ ·åšçš„é—®é¢˜æ˜¯å¢åŠ äº†è®¸å¤šä¸å¿…è¦çš„åµŒå¥—ï¼Œæ— å½¢ä¸­å¢åŠ äº†æµè§ˆå™¨çš„æ¸²æŸ“å‹åŠ›ã€‚\nè¿™æ˜¯å› ä¸º jsx æ˜¯é€šè¿‡ babel è¿›è¡Œè½¬è¯‘ï¼Œå…¶å®å°±æ˜¯é€šè¿‡ React.createElement() ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ª å‚æ•°*^name^* åªèƒ½ç©¿å…¥ä¸€ä¸ª å­—ç¬¦ä¸²*^string^* ç±»å‹çš„å…ƒç´ ï¼Œå› æ­¤å¦‚æœå‡ºç° 2ä¸ª å°±æ— æ³•è¯†åˆ«äº†ã€‚\nğŸ“ Note\nReact 16.0 èµ·ï¼Œrender() é™¤äº†å…è®¸è¿”å›åŸæ¥çš„ React å…ƒç´ å’Œ null ä¹‹å¤–ï¼Œæ–°å¢äº†å‡ ç§ç±»å‹ï¼š\nReact 16.0 èµ·æ”¯æŒè¿”å› æ•°ç»„ã€Protalsã€å­—ç¬¦ä¸²ã€æ•°å€¼ã€å¸ƒå°”å€¼ React 16.2 èµ·æ”¯æŒè¿”å› Fragmentï¼Œå¯ä»¥ç†è§£ä¸ºè¿”å›æ•°ç»„çš„è¯­æ³•ç³– å…¶ä¸­å¸ƒå°”å€¼å’Œ null ä»€ä¹ˆéƒ½ä¸æ¸²æŸ“ï¼Œè€Œ å­—ç¬¦ä¸²æˆ–æ•°å€¼ ç±»å‹ä¼šæ¸²æŸ“ä¸º æ–‡æœ¬èŠ‚ç‚¹ ã€‚\nä» react 16 å¼€å§‹ï¼Œ render æ”¯æŒè¿”å› æ•°ç»„*^Array^* ï¼š\n// Main.js import React, {Component} from \u0026#39;react\u0026#39;; class Main extends Component { render() { // ä»¥æ•°ç»„çš„å½¢å¼è¿”å›å¤šä¸ªæ ¹å…ƒç´  return [ \u0026lt;p\u0026gt;{this.state.name}\u0026lt;/p\u0026gt;, \u0026lt;p\u0026gt;{this.state.age \u0026gt; 18 ? \u0026#39;æˆå¹´\u0026#39; : \u0026#39;æœªæˆå¹´\u0026#39;}\u0026lt;/p\u0026gt; ] } } export default Main; ä¸ºäº†è§£å†³æ ¹å…ƒç´  å”¯ä¸€ çš„é—®é¢˜ï¼Œå¯ä»¥å¼•å…¥ Fragments\u0026lt;React.Fragment\u0026gt;/\u0026lt;\u0026gt; æ›¿æ¢æ ¹å…ƒç´ ï¼Œæ­¤æ ‡ç­¾ä¸æ¸²æŸ“åˆ°é¡µé¢ä¸­ï¼Œå¯åšä¸å¯è§çš„åŒ…è£¹å…ƒç´ ã€‚\nä½¿ç”¨ \u0026lt;React.fragment\u0026gt; æ—¶ï¼Œå¯ä»¥ä¼ å…¥ key å±æ€§ï¼Œæœ‰åŠ©äºå®šä½ä¹‹å‰çš„ DOM ï¼Œå‡å°‘åˆ‡æ¢æŸè€—ã€‚\nfunction Glossary(props) { return ( \u0026lt;dl\u0026gt; {props.items.map(item =\u0026gt; ( // æ²¡æœ‰ keyï¼ŒReact ä¼šå‘å‡ºä¸€ä¸ªå…³é”®è­¦å‘Š \u0026lt;React.Fragment key={item.id}\u0026gt; \u0026lt;dt\u0026gt;{item.name}\u0026lt;/dt\u0026gt; \u0026lt;dd\u0026gt;{item.description}\u0026lt;/dd\u0026gt; \u0026lt;/React.Fragment\u0026gt; ))} \u0026lt;/dl\u0026gt; ) } ğŸ“ Note ç®€æ´å†™æ³• \u0026lt;\u0026gt;\u0026lt;/\u0026gt;ä¸æ”¯æŒä¼ å…¥å‚æ•°\n// Main.js import React, {Component} from \u0026#39;react\u0026#39;; class Main extends Component { render() { return ( \u0026lt;React.Fragment\u0026gt; \u0026lt;p\u0026gt;{this.state.name}\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;{this.state.age \u0026gt; 18 ? \u0026#39;æˆå¹´\u0026#39; : \u0026#39;æœªæˆå¹´\u0026#39;}\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;{this.addAge()}\u0026lt;/p\u0026gt; \u0026lt;/React.Fragment\u0026gt; ) } } // æˆ–è€…ç”¨reactæä¾›çš„ç®€æ´æ–¹æ³• class Main extends Component { render() { return ( \u0026lt;\u0026gt; \u0026lt;p\u0026gt;{this.state.name}\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;{this.state.age \u0026gt; 18 ? \u0026#39;æˆå¹´\u0026#39; : \u0026#39;æœªæˆå¹´\u0026#39;}\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;{this.addAge()}\u0026lt;/p\u0026gt; \u0026lt;/\u0026gt; ) } } // ä½¿ç”¨é»˜è®¤è¾“å‡º export default Main; Props å½“ React å…ƒç´ ä½œä¸ºè‡ªå®šä¹‰ç»„ä»¶ï¼Œå°† jsx æ‰€æ¥å—çš„å±æ€§è½¬æ¢æˆå•ä¸ªå¯¹è±¡ä¼ é€’ç»™ç»„ä»¶ï¼Œè¿™ä¸ªå¯¹è±¡è¢«ç§°ä¸ºâ€œpropsâ€ï¼ˆå°±æ˜¯çˆ¶ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶çš„å¯¹è±¡ï¼Œpropertiesï¼‰\nprops æ˜¯ç»„ä»¶çš„ å›ºæœ‰å±æ€§ ä¸å¯åœ¨ç»„ä»¶ å†…éƒ¨ å¯¹ props è¿›è¡Œä¿®æ”¹ æ›´æ–° propsï¼šéœ€è¦é€šè¿‡çˆ¶ç»„ä»¶é‡æ–°ä¼ å…¥æ–°çš„ props ä»¥æ›´æ–°å­ç»„ä»¶ï¼Œå› æ­¤è¿™æ˜¯ä¸€æ¡ä»çˆ¶ç»„ä»¶ä¼ é€’åˆ°å­ç»„ä»¶çš„ å•å‘æ•°æ®æµ const listData = {name: \u0026#39;react\u0026#39;} // çˆ¶ç»„ä»¶ function App() { return ( \u0026lt;\u0026gt; {/* ä¼ é€’æ•°æ®listData*/} \u0026lt;ListItem data={listData}\u0026gt;\u0026lt;/ListItem\u0026gt; \u0026lt;/\u0026gt; ) } // å­ç»„ä»¶ class ListItem extends Component { constructor(props) { super(props) //å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•° // å®šä¹‰ PropTypes ListItem.propTypes = {data: PropTypes.shape({name: PropTypes.string})}; } render() { return ( \u0026lt;\u0026gt; \u0026lt;code\u0026gt; {/*é€šè¿‡propsæ‹¿åˆ°å€¼*/} {this.props.data.name} \u0026lt;/code\u0026gt; \u0026lt;/\u0026gt; ); } } ğŸ“ Note å‡½æ•°å¼ç»„ä»¶\nå‡½æ•°å¼ç»„ä»¶ä¹Ÿå« æ— çŠ¶æ€ç»„ä»¶ ï¼Œå†…éƒ¨æ²¡æœ‰ this ï¼Œä¹Ÿæ²¡æœ‰å£°æ˜å‘¨æœŸï¼Œç®€åŒ–æ–¹æ³•æ“ä½œï¼Œç”¨ä½œçº¯å±•ç¤ºæ—¶å¯ä»¥å‡å°‘èµ„æºæ¶ˆè€—ã€‚\nè°ƒç”¨æ–¹æ³•ä»ç„¶ä¸º \u0026lt;ListItem\u0026gt;\u0026lt;/ListItem\u0026gt; ã€‚\nç”±äºæ²¡æœ‰ this ï¼Œå¯é€šè¿‡ä¼ å…¥ props å˜é‡å–å¾—çˆ¶ç»„ä»¶ä¼ å…¥çš„å‡½æ•°ã€‚\n// å‡½æ•°å¼ç»„ä»¶å†™æ³• function ListItem(props) { return ( \u0026lt;\u0026gt; \u0026lt;code\u0026gt; {/*é€šè¿‡propsæ‹¿åˆ°å€¼*/} {props.data.name} \u0026lt;/code\u0026gt; \u0026lt;/\u0026gt; ); } åˆ—è¡¨æ¸²æŸ“ åˆ—è¡¨æ¸²æŸ“ä½¿ç”¨ map() æ–¹æ³•ï¼Œè¿”å› ReactComponent æ•°ç»„\n// çˆ¶ç»„ä»¶ function App() { return ( \u0026lt;\u0026gt; {/* ä¼ é€’æ•°æ®listData*/} { listData.map(item =\u0026gt; { return \u0026lt;ListItem data={item} key={item.id}/\u0026gt; }) } \u0026lt;/\u0026gt; ) } æ¡ä»¶æ¸²æŸ“ æ¡ä»¶æ¸²æŸ“çš„ä¸»è¦æ–¹æ³•\nä½¿ç”¨ ä¸‰ç›®è¿ç®—ç¬¦condition ? exprIfTrue : exprIfFalse ä½¿ç”¨ ä¸è¿ç®—ç¬¦\u0026amp;\u0026amp; åˆ¤æ–­expression \u0026amp;\u0026amp; method ä½¿ç”¨å‡½æ•°åšæ¡ä»¶åˆ¤æ–­function() ä½¿ç”¨è‡ªå®šä¹‰ React ç»„ä»¶ï¼Œå¹¶é€šè¿‡ props.children è¿›è¡Œè®¿é—® â³ Future å¾…å®Œæˆ // ä¸»å®¹å™¨ function App() { const data = {name: \u0026#39;react\u0026#39;}; return ( {/* è°ƒç”¨ç»„ä»¶ */} \u0026lt;\u0026gt; \u0026lt;ListItem data={data}/\u0026gt; \u0026lt;/\u0026gt; ); } class ListItem extends Component { renderList() { if (this.props.data.name === \u0026#39;react\u0026#39;) { return \u0026lt;div\u0026gt;jsx\u0026lt;/div\u0026gt; } else { return \u0026lt;div\u0026gt;template\u0026lt;/div\u0026gt; } } render() { return ( \u0026lt;ul className=\u0026#39;listItem\u0026#39;\u0026gt; {/* 1. ä½¿ç”¨ä¸‰ç›®è¿ç®—ç¬¦ */} \u0026lt;div className={ \u0026#39;theme\u0026#39; + this.props.data.name === \u0026#39;react\u0026#39; ? \u0026#39;-blue\u0026#39; : \u0026#39;-green\u0026#39; }\u0026gt; {this.props.data.name === \u0026#39;react\u0026#39; ? \u0026#39;jsx\u0026#39; : \u0026#39;template\u0026#39;} \u0026lt;/div\u0026gt; {/* 2. ä½¿ç”¨å‡½æ•°åšæ¡ä»¶åˆ¤æ–­ */} {this.renderList.call(this)} {/* 3. ä½¿ç”¨ä¸è¿ç®—ç¬¦ \u0026amp;\u0026amp; åˆ¤æ–­ */} {this.props.data.name === \u0026#39;react\u0026#39; \u0026amp;\u0026amp; \u0026lt;div\u0026gt;jsx\u0026lt;/div\u0026gt;} {/* 4. ä½¿ç”¨è‡ªå®šä¹‰ç»„ä»¶ */} \u0026lt;Condition if={this.props.data.name === \u0026#39;react\u0026#39;} \u0026gt; jsx \u0026lt;/Condition\u0026gt; \u0026lt;/ul\u0026gt; ) } } // è‡ªå®šä¹‰ç»„ä»¶æ¡ä»¶æ¸²æŸ“ // æ¡ä»¶ä¸ºçœŸï¼Œæ¸²æŸ“å­ç»„ä»¶ï¼Œå¦åˆ™ä¸è¿›è¡Œæ¸²æŸ“ function Condition(props) { // children åŒ…æ‹¬ç»„ä»¶çš„å¼€å§‹æ ‡ç­¾å’Œç»“æŸæ ‡ç­¾ä¹‹é—´çš„å†…å®¹ return props.if ? props.children : null; } æ ·å¼ è¡Œå†…æ ·å¼ \u0026lt;div style={{fontSize:18;color:red}}\u0026gt;\u0026lt;/div\u0026gt; æ ·å¼è¡¨ src/ components/ ListItem/ index.jsx index.css //ä¹Ÿå¯ä»¥ç”¨scssï¼Œæ–‡ä»¶å‘½åindex.css // æˆ‘ä»¬åœ¨index.css å®šä¹‰æ ·å¼ .title{ color:red; } //åœ¨ListItemå¯¼å…¥ import \u0026#39;./index.css\u0026#39; class ListItem extends Component { constructor(props){ super(props) //å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•° } render(){ return ( \u0026lt;div className=\u0026#39;listItem\u0026#39;\u0026gt; \u0026lt;span className=\u0026#39;title\u0026#39;\u0026gt;header\u0026lt;span\u0026gt; \u0026lt;div\u0026gt; ) } } ä¸Šé¢çš„åœ¨ index.css å†™æ³•ï¼Œé‡Œé¢çš„æ ·å¼æ˜¯å…¨å±€æ ·å¼ï¼Œä¼šé€ æˆå…¨å±€æ±¡æŸ“ï¼Œå¯ä»¥ç”¨css moduleè§£å†³\nCss module ä¸ä½¿ç”¨é€‰æ‹©å™¨ï¼Œä½¿ç”¨classåå®šä¹‰æ ·å¼ ä¸å±‚å classï¼Œä½¿ç”¨ä¸€ä¸ªclasså®šä¹‰æ ·å¼ ç”¨è¿‡composeæ¥ç»„åˆ src/ components/ ListItem/ index.jsx index.module.css //å‘½åæ–¹å¼åŠ å…¥module // æˆ‘ä»¬åœ¨index.css å®šä¹‰æ ·å¼ .title{ color:red; } //åœ¨ListItemå¯¼å…¥å¯¹è±¡ import style from \u0026#39;index.module.css\u0026#39; class ListItem extends Component { constructor(props){ super(props) //å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•° } render(){ return ( \u0026lt;div className=\u0026#39;listItem\u0026#39;\u0026gt; \u0026lt;span className={style.title}\u0026gt;header\u0026lt;span\u0026gt; \u0026lt;div\u0026gt; ) } } ç®¡ç†å·¥å…· Styled-component Classnames src/ components/ ListItem/ index.jsx index.module.css //å‘½åæ–¹å¼åŠ å…¥module // æˆ‘ä»¬åœ¨index.css å®šä¹‰æ ·å¼ .title{ color:red; } .themd { background:\u0026#39;red\u0026#39; } //åœ¨ListItemå¯¼å…¥å¯¹è±¡ import style from \u0026#39;index.module.css\u0026#39; import classnames from \u0026#39;classnames/bind\u0026#39; const cls=classnames.bind(style) import cn from \u0026#39;classnames\u0026#39; class ListItem extends Component { constructor(props){ super(props) //å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•° } render(){ const flag=true const _cn=cn({ \u0026#39;themd\u0026#39;:flag }) return ( \u0026lt;div className=\u0026#39;listItem\u0026#39;\u0026gt; {/* css Module+classnames/bind */} {/* css module ç»“åˆ classnames å¯ä»¥æ·»åŠ 2ä¸ªç±»å */} \u0026lt;span className={cls(\u0026#39;title\u0026#39;,\u0026#39;themd\u0026#39;)}\u0026gt;header\u0026lt;span\u0026gt; {{/* classnames */} \u0026lt;span className={_cn}\u0026gt;\u0026lt;/span\u0026gt; \u0026lt;div\u0026gt; ) } } æ‰©å±•â³ Future äº‹ä»¶ React äº‹ä»¶å’Œ DOM äº‹ä»¶\nreactäº‹ä»¶ åŸç”Ÿäº‹ä»¶ onClick onclick onClick={eventListener} onclick=\u0026ldquo;eventListener()\u0026rdquo; e.preventDefalut onclick=\u0026ldquo;javascript\u0026rdquo; class ListItem extends Component { constructor(props) { super(props) //å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•° } doSomething() { } handleClick(e) { console.log(e) this.doSomething() //æŠ¥é”™ï¼Œä¼šè¯´æ‰¾ä¸åˆ°è¿™ä¸ªæ–¹æ³• } render() { return ( \u0026lt;div className=\u0026#39;listItem\u0026#39;\u0026gt; \u0026lt;span onClick={this.handleClick}\u0026gt;header\u0026lt;/span\u0026gt; \u0026lt;/div\u0026gt; ); } } This åœ¨ é¢å‘å¯¹è±¡ çš„ç¼–ç¨‹ä¸­ï¼Œthis çš„ä½¿ç”¨æ–¹æ³•ä¼šéšç€å¼•ç”¨å¯¹è±¡çš„å·®åˆ«è€Œä¸åŒï¼Œå½“è¢«å¯¹è±¡å¼•ç”¨æ—¶æŒ‡å‘çš„æ˜¯å¯¹è±¡ï¼Œå•ç‹¬å‡½æ•°å¼•ç”¨æŒ‡å‘çš„æ˜¯ windowï¼Œä¸¥æ ¼æ¨¡å¼æ˜¯ undefined ã€‚â“ Question\nä¸ºäº†ä½¿å¯¹è±¡èƒ½æŒ‡å‘è°ƒç”¨çš„ç»„ä»¶æ–¹ä¾¿é‡ç”¨ï¼Œæœ‰å‡ ç§æ–¹æ³•ï¼š\nåœ¨ æ„é€ å‡½æ•°*^constructor^* ä¸­ä½¿ç”¨ bind æ–¹æ³• åœ¨ jsx ä¸­ä½¿ç”¨ bind æ–¹æ³•ï¼Œå®è´¨ç±»ä¼¼ æ–¹æ³•1 ä½¿ç”¨ ç®­å¤´å‡½æ•°()=\u0026gt;{} ï¼Œæ­¤æ—¶ this è‡ªåŠ¨æŒ‡å‘å¼•ç”¨çš„ä¸Šä¸‹æ–‡ class ListItem extends Component { constructor(props) { super(props); // å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•° // æ–¹æ³•2 ç»‘å®šè°ƒç”¨æ—¶çš„ä¸Šä¸‹æ–‡ this.handleClick = this.handleClick.bind(this); } doSomething() { //... } // æ–¹æ³•3 ç®­å¤´å‡½æ•°çš„thisæ€»æ˜¯æŒ‡å‘å®šä¹‰æ—¶çš„å¯¹è±¡ handleClick = (e) =\u0026gt; { console.log(e); } function handleClick(e) { // è‹¥ä¸å¯¹ this è¿›è¡Œç»‘å®šï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹å°†æŒ‡å‘ undefined console.log(this); // undefined this.doSomething(); // æŠ¥é”™ï¼Œä¼šè¯´æ‰¾ä¸åˆ°è¿™ä¸ªæ–¹æ³• } render() { return ( \u0026lt;div className=\u0026#39;listItem\u0026#39;\u0026gt; {/* æ–¹æ³•2 å®è´¨åŒæ–¹æ³•1 */} \u0026lt;span onClick={this.handleClick.bind(this)}\u0026gt;header\u0026lt;/span\u0026gt; \u0026lt;/div\u0026gt; ); } } ä¼ å‚ å‘ä¸‹ class ListItem extends Component { constructor(props){ super(props) //å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°) this.state={ conunt:1 } } handleClick(id){ console.log(id) } render(){ return ( \u0026lt;div className=\u0026#39;listItem\u0026#39;\u0026gt; {/* æ–¹æ³•1*/} \u0026lt;span onclick={this.handleClick.bind(this,1)}\u0026gt;header\u0026lt;span\u0026gt; {/* æ–¹æ³•2*/} \u0026lt;span onclick={()=\u0026gt;this.handleClick(1)}\u0026gt;header\u0026lt;span\u0026gt; {/* ä¼ é€’äº‹ä»¶å¯¹è±¡event*/} \u0026lt;span onclick={(e)=\u0026gt;this.handleClick(1,e)}\u0026gt;header\u0026lt;span\u0026gt; \u0026lt;div\u0026gt; ) } } å‘ä¸Š // çˆ¶ç»„ä»¶ class App extends Component { handDelete(id){ console.log(id) } render(){ \u0026lt;ListItem onDelete={this.handDelete}/\u0026gt; } } // å­ç»„ä»¶ class ListItem extends Component { constructor(props){ super(props) this.state={ conunt:1 } } render(){ return ( \u0026lt;div className=\u0026#39;listItem\u0026#39;\u0026gt; \u0026lt;span onclick={()=\u0026gt;this.props.onDelete(this.state.conunt)}\u0026gt;header\u0026lt;span\u0026gt; \u0026lt;div\u0026gt; ) } } ![][React äº‹ä»¶æœºåˆ¶]\nJS çš„äº‹ä»¶è§¦å‘ç»è¿‡ 3 ä¸ªé˜¶æ®µï¼š\näº‹ä»¶çš„æ•è· âŸ¹ ç›®æ ‡å¯¹è±¡äº‹ä»¶çš„å¤„ç† âŸ¹ äº‹ä»¶å†’æ³¡\nå‡è®¾åœ¨ text ä¸­è§¦å‘äº†äº‹ä»¶ï¼Œä¼šç»è¿‡ä¸€ä¸ªæ•è·çš„é˜¶æ®µï¼Œçˆ¶çº§å…ƒç´ å°†äº‹ä»¶ä¸€ç›´ä¼ é€’åˆ°æœ¬èº«å‘ç”Ÿçš„å…ƒç´ ä¸Šï¼Œåœ¨ç»è¿‡æœ¬èº«çš„äº‹ä»¶å¤„ç†ä¹‹åï¼Œä¼šç»å†å†’æ³¡é˜¶æ®µï¼Œäº‹ä»¶ä»å­å…ƒç´ å‘çˆ¶å…ƒç´ å†’æ³¡ï¼›å°±å› ä¸ºè¿™æ ·ï¼Œäº‹ä»¶å§”æ‰˜æˆä¸ºäº†å¯èƒ½ï¼Œå°±æ˜¯å°†å­å…ƒç´ çš„äº‹ä»¶å¤„ç†å§”æ‰˜ç»™çˆ¶å…ƒç´ ã€‚\n![][React äº‹ä»¶æ¨¡å‹]\nReact ä¼šå°†æ‰€æœ‰çš„äº‹ä»¶éƒ½ç»‘å®šåˆ° document è€Œä¸æ˜¯æŸä¸ªå…ƒç´ ä¸Šé¢ï¼Œç»Ÿä¸€ä½¿ç”¨ äº‹ä»¶ç›‘å¬ ï¼Œå¹¶åœ¨ å†’æ³¡é˜¶æ®µBubbling Phase å¤„ç†äº‹ä»¶ï¼Œå½“æŒ‚è½½å’Œå¸è½½ç»„ä»¶çš„æ—¶å€™åªéœ€åœ¨ç»Ÿä¸€çš„äº‹ä»¶ç›‘å¬ä½ç½®ï¼Œå¢åŠ æˆ–åˆ é™¤å¯¹è±¡ï¼Œå› æ­¤æå¤§çš„æé«˜æ•ˆç‡ï¼›\nå½“ äº‹ä»¶è§¦å‘ çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„ç»„ä»¶ä¼šç”Ÿæˆä¸€ä¸ªåˆæˆäº‹ä»¶ï¼Œç„¶åä¼ é€’åˆ° document ä¸­ï¼Œdocument ä¼šé€šè¿‡ DispatchEvent å›è°ƒå‡½æ•°ä¾æ¬¡æ‰§è¡Œ DispatchEvent ä¸­åŒç±»å‹çš„äº‹ä»¶ç›‘å¬å‡½æ•°ã€‚\nè€Œ äº‹ä»¶æ³¨å†Œ æ˜¯åœ¨ç»„ä»¶ç”Ÿæˆçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°† vDom ä¸­æ‰€æœ‰çš„äº‹ä»¶çš„åŸç”Ÿäº‹ä»¶ document ä¸­çš„ä¸€ä¸ªç›‘å¬å™¨å½“ä¸­ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰çš„äº‹ä»¶å¤„ç†å‡½æ•°éƒ½å­˜åœ¨ ListenerBank ä¸­ å¹¶ä»¥ key ä½œä¸ºç´¢å¼•ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯å°†å¯èƒ½è¦è§¦å‘çš„äº‹ä»¶åˆ†é—¨åˆ«ç±»ã€‚\nğŸ“ Note React äº‹ä»¶è¦ç´ \nReact äº‹ä»¶æ˜¯ åˆæˆäº‹ä»¶ ï¼Œä¸æ˜¯ DOM åŸç”Ÿäº‹ä»¶ åœ¨ document ç›‘å¬æ‰€æœ‰æ”¯æŒçš„äº‹ä»¶ ä½¿ç”¨ç»Ÿä¸€çš„åˆ†å‘å‡½æ•° dispatchEvent ğŸ’¡ Trick å¯åœ¨ Chromeç½‘ä¸Šåº”ç”¨å•†åº— æˆ–æ˜¯ npmJS å®‰è£… react-devtools è°ƒè¯•å·¥å…·ï¼Œä»¥æŸ¥çœ‹ vDom ä¸Šçš„ã€‚\nState å®šä¹‰ ç¨‹åºä¸»å…¥å£ function App() { return ( \u0026lt;\u0026gt; \u0026lt;ListClass/\u0026gt; \u0026lt;ListFunction/\u0026gt; \u0026lt;/\u0026gt; ); } class ç±»å½¢å¼ // éœ€è¦å¼•å…¥ React.Component class ListClass extends Component { // å®šä¹‰ä¸€ä¸ªstate -\u0026gt; state state = { count: 1, listItem: [] } clickHandler = e =\u0026gt; { const listItem = [...this.state.listItem]; listItem.push(this.state.count); this.setState({count: this.state.count + 1, listItem}); } render() { return ( \u0026lt;\u0026gt; \u0026lt;p\u0026gt;You clicked {this.state.count} times\u0026lt;/p\u0026gt; \u0026lt;ul\u0026gt; {this.state.listItem.map((v, i) =\u0026gt; \u0026lt;li key={i}\u0026gt;{v}\u0026lt;/li\u0026gt;)} \u0026lt;/ul\u0026gt; \u0026lt;button onClick={this.clickHandler}\u0026gt; \u0026lt;code\u0026gt;add listItem\u0026lt;/code\u0026gt; \u0026lt;/button\u0026gt; \u0026lt;/\u0026gt; ) } } å‡½æ•°ç»„ä»¶å½¢å¼ ä½¿ç”¨ useState() çš„ hooks åˆ›å»ºç›¸åº”çš„ state ã€‚\nfunction ListFunction() { // å£°æ˜ä¸€ä¸ªå« \u0026#34;count\u0026#34; çš„ state å˜é‡ -\u0026gt; hooks const [count, setCount] = useState(0); const [listItem, setListItem] = useState([]); // console.log(listItem,typeof listItem,Array.isArray(listItem)) return ( \u0026lt;div\u0026gt; \u0026lt;p\u0026gt;You clicked {count} times\u0026lt;/p\u0026gt; \u0026lt;ul\u0026gt; {listItem.map((v, i) =\u0026gt; \u0026lt;li key={i}\u0026gt;{v}\u0026lt;/li\u0026gt;)} \u0026lt;/ul\u0026gt; {/* ç­‰åŒäºsetState()ä¸­ä¿®æ”¹å•ç‹¬å˜é‡ */} \u0026lt;button onClick={() =\u0026gt; (setCount(count + 1) // âœ• setListItem([[...listItem].push(count)]) // Warning ä¸èƒ½ä½¿ç”¨pushï¼Œè¿™ä¸ªå‡½æ•°è¿”å›æ–°æ•°ç»„çš„é•¿åº¦ï¼Œä½¿ç”¨concatæ›¿ä»£ | setListItem(listItem.concat([count])))}\u0026gt; \u0026lt;code\u0026gt;add listItem\u0026lt;/code\u0026gt; \u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; ); } æ›´æ–° ä½¿ç”¨ setState() setState æ˜¯ å¼‚æ­¥*^asynchronous^* çš„ï¼Œæ¥å—ç¬¬äºŒä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•° State çš„æ›´æ–°æ˜¯ä¸€ä¸ª æµ…åˆå¹¶shalllow merge çš„è¿‡ç¨‹ this.setState({ //ä¿®æ”¹ä¸€ä¸ªstate count:this.state.count+1 },callbackFn) Prop ","date":"2023-03-20","section":"techs","summary":"React å¼€å§‹ Create React App æ˜¯ä¸€ä¸ªå®˜æ–¹æ”¯æŒçš„åˆ›å»º React å•é¡µåº”ç”¨ç¨‹åºçš„æ–¹æ³•ã€‚å®ƒæä¾›äº†ä¸€ä¸ªé›¶é…ç½®çš„ç°ä»£æ„å»ºè®¾ç½®ã€‚\nå®‰è£… npx npx create-react-app my-app #ä½¿ç”¨ TypeScript npx create-react-app my-app --typescript cd my-app npm start (npx æ¥è‡ª npm 5.2+ æˆ–æ›´é«˜ç‰ˆæœ¬, æŸ¥çœ‹ npm æ—§ç‰ˆæœ¬çš„è¯´æ˜)\nnpm npm init react-app my-app npm init \u0026lt;initializer\u0026gt; åœ¨ npm 6+ ä¸­å¯ç”¨\nyarn yarn create react-app my-app ğŸ“ Note yarn create åœ¨ Yarn 0.25+ ä¸­å¯ç”¨\nç„¶åæ‰“å¼€ http://localhost:3000/ æŸ¥çœ‹ä½ çš„åº”ç”¨ã€‚\nå½“ä½ å‡†å¤‡éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ—¶ï¼Œä½¿ç”¨ npm run build åˆ›å»ºä¸€ä¸ªç»è¿‡ [WebPack](10 WebPack) å‹ç¼©åçš„ åŒ…*^bundle^* ã€‚\né…ç½® Webpack ä¸ Babel å®ƒä»¬æ˜¯é¢„å…ˆé…ç½®å¥½å¹¶ä¸”éšè—çš„ï¼Œå› æ­¤ä½ å¯ä»¥ä¸“æ³¨äºä»£ç ã€‚\n","title":"16 React","url":"/techs/16-react/"},{"content":"","date":"2023-03-20","section":"techs","summary":"","title":"17 Angular","url":"/techs/17-angular/"},{"content":"WebPack æ—©æœŸå‰ç«¯å·¥ç¨‹åŒ–è§£å†³æ–¹æ¡ˆï¼š\ngrunt - https://www.gruntjs.net/ gulp - https://gulpjs.com/ ç›®å‰ä¸»æµçš„å‰ç«¯å·¥ç¨‹åŒ–è§£å†³æ–¹æ¡ˆï¼š\nWebpack - https://webpack.js.org/ Parcell - https://parceljs.org/ Webpack æä¾›äº†å‹å¥½çš„ æ¨¡å—åŒ–å¼€å‘ æ”¯æŒï¼Œä»¥åŠä»£ç å‹ç¼©æ··æ·†ã€å¤„ç†æµè§ˆå™¨ç«¯ Js å…¼å®¹æ€§ã€ä»¥åŠæ€§èƒ½ä¼˜åŒ–ç­‰å¼ºå¤§åŠŸèƒ½ã€‚ç›®å‰ä¼ä¸šçº§çš„å‰ç«¯é¡¹ç›®å¼€å‘ä¸­ï¼Œç»å¤§å¤šæ•°é¡¹ç›®éƒ½æ˜¯åŸºäº Webpack è¿›è¡Œæ‰“åŒ…å¼€å‘çš„ã€‚\nğŸ”— Href Webpack ä¸­æ–‡æ–‡æ¡£\né…ç½® pnpm install webpack webpack-cli -D # install in dev åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œåˆ›å»ºåä¸º webpack.config.js çš„ Webpack é…ç½®æ–‡ä»¶ï¼Œå¹¶åˆå§‹åŒ–å¦‚ä¸‹çš„åŸºæœ¬é…ç½®ï¼š module.exports = { mode: \u0026#39;development\u0026#39;, // mode ç”¨æ¥æŒ‡å®šæ„å»ºæ¨¡å¼ï¼Œå¯é€‰å€¼æœ‰ development å’Œ production } åœ¨ package.json çš„ script èŠ‚ç‚¹ä¸‹ï¼Œæ–°å¢ dev è„šæœ¬ å¦‚ä¸‹ï¼š \u0026#34;scripts\u0026#34;: { \u0026#34;dev\u0026#34;: \u0026#34;webpack\u0026#34;, // script èŠ‚ç‚¹ä¸‹çš„è„šæœ¬ï¼Œå¯ä»¥é€šè¿‡ npm run æ‰§è¡Œ } åœ¨ç»ˆç«¯ä¸­è¿è¡Œ npm run dev å‘½ä»¤ï¼Œå¯åŠ¨ webpack è¿›è¡Œé¡¹ç›®çš„æ‰“åŒ…ç®¡ç† mode èŠ‚ç‚¹çš„å¯é€‰å€¼æœ‰ä¸¤ä¸ªï¼Œåˆ†åˆ«æ˜¯ï¼š8\ndevelopment\nå¼€å‘ç¯å¢ƒ ä¸ä¼šå¯¹æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶è¿›è¡Œä»£ç å‹ç¼©å’Œæ€§èƒ½ä¼˜åŒ– æ‰“åŒ…é€Ÿåº¦å¿«ï¼Œé€‚åˆå¼€å‘é˜¶æ®µä½¿ç”¨ production\nç”Ÿäº§ç¯å¢ƒ ä¼šå¯¹æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶è¿›è¡Œä»£ç å‹ç¼©å’Œæ€§èƒ½ä¼˜åŒ– æ‰“åŒ…é€Ÿåº¦å¾ˆæ…¢ï¼Œä»…é€‚åˆåœ¨é¡¹ç›®å‘å¸ƒé˜¶æ®µä½¿ç”¨ æ¥å£\nentry: path.join(__dirname, \u0026#39;./src/index.js\u0026#39;), // æŒ‡å®šæ‰“åŒ…çš„å‡ºå£ output: { path: path.join(__dirname, \u0026#39;./dist\u0026#39;), // è¡¨ç¤ºè¾“å‡ºæ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ filename: \u0026#39;js/bundle.js\u0026#39; // è¡¨ç¤ºè¾“å‡ºæ–‡ä»¶çš„åç§° } ğŸ“ Note ä¸çŸ¥é“ä½¿ç”¨ ES Module çš„æ—¶å€™æ˜¯å¦éœ€è¦äººå·¥åˆæˆ\nğŸ’¡ Trick webpack ä¸­æœ‰å¦‚ä¸‹é»˜è®¤çº¦å®šï¼š\né»˜è®¤ æ‰“åŒ…å…¥å£ æ–‡ä»¶ src/index.js éœ€è¦å¼•å…¥åˆ°å…¥å£çš„æ–‡ä»¶æ‰ä¼šå‚ä¸æ‰“åŒ… æ‰§è¡Œ package.json ä¸­çš„ build å‘½ä»¤ï¼Œæ‰§è¡Œ webpack æ‰“åŒ…å‘½ä»¤ é»˜è®¤è¾“å‡º dist/main.js çš„æ‰“åŒ…ç»“æœ å¯ä»¥åœ¨ webpack.config.js ä¸‹å•ç‹¬è¿›è¡Œé…ç½®\nconst path = require(\u0026#39;path\u0026#39;); module.exports = { entry: \u0026#39;./src/index.js\u0026#39;, output: { filename: \u0026#39;main.js\u0026#39;, path: path.resolve(__dirname, \u0026#39;dist\u0026#39;), // å‡ºå£è·¯å¾„æ–‡ä»¶å¤¹ }, }; yarn_build æ‰§è¡Œæµç¨‹å¦‚å›¾ã€‚\næ’ä»¶ é€šè¿‡å®‰è£…å’Œé…ç½®ç¬¬ä¸‰æ–¹çš„æ’ä»¶ï¼Œå¯ä»¥æ‹“å±• webpack çš„èƒ½åŠ›ï¼Œä»è€Œä½¿å…¶ç”¨èµ·æ¥æ›´æ–¹ä¾¿ã€‚å¸¸è§çš„æ’ä»¶æœ‰å¦‚ä¸‹ä¸¤ä¸ªï¼š\nwebpack-dev-server\nç±»ä¼¼äº node.js ç”¨çš„ nodemon å·¥å…·\næ¯å½“ä¿®æ”¹äº†æºä»£ç ï¼Œwebpack éƒ½ä¼šè‡ªåŠ¨è¿›è¡Œé¡¹ç›®çš„æ‰“åŒ…å’Œæ„å»º\nhtml-webpack-plugin\nHTML æ¨¡ç‰ˆå¼•æ“æ’ä»¶ï¼Œå¯ä»¥ç”¨æ­¤æ’ä»¶è‡ªå®šä¹‰ index.html é¡µé¢å†…å®¹\nwebpack-dev-server pnpm i -D webpack-dev-server ä¿®æ”¹ package.json â†’ \u0026quot;scripts\u0026quot; ä¸­çš„ dev å‘½ä»¤ä¸‹ï¼š\n\u0026#34;scripts\u0026#34;: { \u0026#34;dev\u0026#34;: \u0026#34;webpack serve\u0026#34; // script èŠ‚ç‚¹ä¸‹çš„ç‰ˆæœ¬ï¼Œå¯ä»¥é€šè¿‡ npm run æ‰§è¡Œ }, å†æ¬¡è¿è¡Œ npm run dev å‘½ä»¤ï¼Œé‡æ–°è¿›è¡Œé¡¹ç›®çš„æ‰“åŒ…\nåœ¨æµè§ˆå™¨ä¸­è®¿é—® localhost\nğŸ“ Note æ–‡ä»¶å­˜æ”¾\nä¸é…ç½® webpack-dev-server çš„æƒ…å†µä¸‹ï¼Œ webpack æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶ï¼Œä¼šå­˜æ”¾åˆ°å®é™…çš„ç£ç›˜ä¸Šï¼Œå¹¶æ ¹æ® webpack.config.js ä¸­ output èŠ‚ç‚¹æŒ‡å®šçš„è·¯å¾„è¿›è¡Œå­˜æ”¾ï¼›é…ç½®ä¹‹åï¼Œæ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶ç›´æ¥ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œé»˜è®¤æŒ‚è½½äºé¡¹ç›®æ ¹ç›®å½•ã€‚\n// webpack.config.js module.exports = { devServer: { port: 8080 } } # æˆ–æ˜¯å‘½ä»¤è¡Œå‚æ•° npx webpack serve --port 8080 html-webpack-plugin webpack ä¸­çš„ HTML æ’ä»¶ï¼Œå¯ä»¥é€šè¿‡æ­¤æ’ä»¶è‡ªå®šä¹‰ index.html ä¸­å†…å®¹ã€‚\n// 1. å¯¼å…¥æ’ä»¶ï¼Œå¾—åˆ°æ„é€ å‡½æ•° const HtmlPlugin = require(\u0026#39;html-webpack-plugin\u0026#39;) // 2. åˆ›å»ºæ’ä»¶çš„å®ä¾‹å¯¹è±¡ const htmlPlugin = new HtmlPlugin({ template: \u0026#39;./src/index.html\u0026#39;, // æŒ‡å®šæºæ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ filename: \u0026#39;./index.html\u0026#39; // æŒ‡å®šç”Ÿæˆæ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ }) module.exports = { mode: \u0026#39;development\u0026#39;, plugins: [htmlPlugin] // æŒ‚è½½æ’ä»¶çš„å®ä¾‹å¯¹è±¡ } ğŸ“ Note\né€šè¿‡ HTML æ’ä»¶å¤åˆ¶åˆ°æ ¹ç›®å½•ä¸­çš„ index.html é¡µé¢ä¹Ÿè¢«æ”¾åˆ°äº†å†…å­˜ä¸­ HTML æ’ä»¶åœ¨ç”Ÿæˆçš„ index.html é¡µé¢çš„åº•éƒ¨ï¼Œè‡ªåŠ¨æ³¨å…¥äº†æ‰“åŒ…çš„ bundle.js æ–‡ä»¶ åœ¨ webpack.config.js é…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥é€šè¿‡ devServer èŠ‚ç‚¹å¯¹ webpack-dev-server æ’ä»¶è¿›è¡Œæ›´å¤šçš„é…ç½®ã€‚\ndevServer: { open: true, // è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ host: \u0026#39;127.0.0.1\u0026#39;, // å®æ—¶æ‰“åŒ…æ‰€ä½¿ç”¨çš„ä¸»æœºåœ°å€ port: 8080 // å®æ—¶æ‰“åŒ…æ‰€ä½¿ç”¨çš„ç«¯å£å· } loader åœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œwebpack é»˜è®¤åªèƒ½æ‰“åŒ…ä»¥ .js ç»“å°¾çš„æ¨¡å—ã€‚å…¶å®ƒæ–‡ä»¶éœ€è¦è°ƒç”¨ loader åŠ è½½å™¨æ‰å¯ä»¥æ­£å¸¸æ‰“åŒ…ï¼Œå¦åˆ™æŠ¥é”™ã€‚\nloader åŠ è½½å™¨å¯ä»¥è‡ªåŠ¨æ‰“åŒ…å¤„ç†ç‰¹å®šçš„æ–‡ä»¶æ¨¡å—ï¼Œä¾‹å¦‚ï¼š\nstyle-loader - æŠŠ css æ’å…¥åˆ° DOM ä¸­ css-loader -æ‰“åŒ… .css less-loader - æ‰“åŒ… .less babel-loader - js é¢„å¤„ç†å™¨ pnpm i -D style-loader css-loader pnpm i -D less less-loader æ¥ä¸‹æ¥å°±å¯ä»¥ç›´æ¥åœ¨ main.js ä¸­å¼•ç”¨ css æ–‡ä»¶äº†ã€‚\nimport \u0026#39;./css/index.css\u0026#39; ğŸ’¡ Trick Webpack ä¸­å¼•å…¥æ–‡ä»¶å¤¹æ—¶ï¼Œé»˜è®¤å¼•å…¥çš„æ˜¯ç›®å½•ä¸‹çš„ index.jsÂ ï¼Œå¯¹äºå…¶å®ƒæ–‡ä»¶ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‡å®šæ–‡ä»¶åç§°\nCSS/LESS Webpack é»˜è®¤åªèƒ½è¯†åˆ« js ç±»å‹ã€‚å¯¹äºå…¶å®ƒæ ¼å¼ï¼Œéœ€è¦é…ç½®é¢å¤–çš„åŠ è½½å™¨ã€‚\nåœ¨ webpack.config.js ä¸­çš„ module â†’ rules æ•°ç»„ä¸­ï¼Œæ·»åŠ è§„åˆ™å¦‚ä¸‹ï¼š module.exports = { /* ...å…¶å®ƒå‚æ•° */ module: { rules: [ { test: /\\.css$/i, /* è¯´æ˜ * 1. \\. è½¬ä¹‰ . å­—ç¬¦ * 2. $ ç»“å°¾ * 3. i å¿½ç•¥å¤§å°å†™ */ use: [\u0026#39;style-loader\u0026#39;, \u0026#39;css-loader\u0026#39; ] // æ’ä»¶åŠ è½½é¡ºåºä»å³åˆ°å·¦ï¼Œé¡ºåºä¸èƒ½é¢ å€’ }, { test: /\\.less$/i, use: [ \u0026#39;style-loader\u0026#39;, \u0026#39;css-loader\u0026#39;, \u0026#39;less-loader\u0026#39; ] }, { test: /\\.jpg|png|gif$/, use: { loader: \u0026#39;url-loader\u0026#39;, options: { limit: 22228, // å°äºæ­¤å¤§å°åˆ™è½¬ä¸ºbase64æ ¼å¼å›¾ç‰‡å†…åµŒï¼Œå•ä½æ˜¯å­—èŠ‚ outputPath: \u0026#39;image\u0026#39; // å…¶å®ƒåŠ å…¥è¯¥ä½ç½® } } } ] } } å…¶ä¸­ test è¡¨ç¤ºåŒ¹é…çš„æ–‡ä»¶ç±»å‹ï¼Œuse è¡¨ç¤ºå¯¹åº”è¦ä½¿ç”¨çš„ loader ã€‚\nğŸ“ Note\nuse æ•°ç»„ä¸­æŒ‡å®šçš„ loader é¡ºåºæ˜¯å›ºå®šçš„ å¤šä¸ª loader çš„è°ƒç”¨é¡ºåºæ˜¯ä»åå¾€å‰è°ƒç”¨ï¼Œå³ less-loader â†’css-loader â†’ style-loader å›¾ç‰‡ åœ¨ webpack 5 ä¹‹å‰ï¼Œé€šå¸¸ä½¿ç”¨ï¼š\nraw-loader - å°†æ–‡æ¡£å¯¼å…¥ä¸ºå­—ç¬¦ä¸² url-loader - å°†æ–‡æ¡£ä½œä¸º data URI å†…è”åˆ° bundle ä¸­ file-loader - å°†æ–‡æ¡£å‘é€åˆ°è¾“å‡ºç›®å½• Webpack5 æ–°å¢èµ„æºæ¨¡å—ç±»å‹Asset Module Typeï¼Œé€šè¿‡æ·»åŠ  4 ç§æ–°çš„æ¨¡å—ç±»å‹ï¼Œæ¥æ›¿æ¢æ‰€æœ‰è¿™äº› loaderï¼š\nasset/resource - å‘é€ä¸€ä¸ªå•ç‹¬çš„æ–‡æ¡£å¹¶å¯¼å‡º URL\nä¹‹å‰é€šè¿‡ä½¿ç”¨ file-loader å®ç°\nasset/inline - å¯¼å‡ºä¸€ä¸ªèµ„æºçš„ data URI\nä¹‹å‰é€šè¿‡ä½¿ç”¨ url-loader å®ç°\nasset/source - å¯¼å‡ºèµ„æºçš„æºä»£ç \nä¹‹å‰é€šè¿‡ä½¿ç”¨ raw-loader å®ç°\nasset åœ¨å¯¼å‡ºä¸€ä¸ª data URI å’Œå‘é€ä¸€ä¸ªå•ç‹¬çš„æ–‡æ¡£ä¹‹é—´ è‡ªåŠ¨ é€‰æ‹©ã€‚ä¹‹å‰é€šè¿‡ä½¿ç”¨ url-loaderï¼Œå¹¶ä¸”é…ç½®èµ„æºä½“ç§¯é™åˆ¶å®ç°ã€‚\nğŸ’¡ Trick asset æ¨¡å¼ä»¥ 8KB å¤§å°è¿›è¡ŒåŒºåˆ†ï¼šå°äº 8KB åˆ™ä»¥ base64 æ ¼å¼ç¼–ç æ‰“åŒ…è¿› js ä¸­ï¼›å¤§äºåˆ™ç›´æ¥ä»¥é™æ€èµ„æºæ¨¡å¼ä¿å­˜\nğŸ¤” Cons è½¬ä¸º base64 ç¼–ç æ–‡ä»¶ä½“ç§¯å¤§å°å¢åŠ  30%\n// æ‰‹åŠ¨å¼•å…¥ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶ // Webpack é‡Œä¸‡ç‰©çš†æ¨¡å— import imgObj from \u0026#39;./assets/1.gif\u0026#39; let theImg = document.createElement(\u0026#39;img\u0026#39;) theImg.src = imgObj document.body.appendChild(theImg) body { /* åœ¨ css ä¸­å¼•å…¥å›¾ç‰‡ */ background: url(\u0026#39;./assets/logo_small.png\u0026#39;) no-repeat center } module.exports = { /* ...å…¶å®ƒå‚æ•° */ module: { // åŠ è½½å™¨é…ç½® rules: [ // è§„åˆ™ { // å›¾ç‰‡æ–‡ä»¶çš„é…ç½® test: /\\.(jpg|jpeg|png|gif)$/i, type: \u0026#39;asset\u0026#39; // ä½œä¸ºé™æ€èµ„æºæ‰“åŒ… // ä»¥ 8KB å¤§å°åŒºåˆ† // å°äº 8KBï¼Œè½¬ base64 æ‰“åŒ…è¿› js // å¤§äº 8KBï¼Œç›´æ¥æŠŠå›¾ç‰‡æ–‡ä»¶è¾“å‡ºåˆ° dist ä¸‹ } å­—ä½“ é’ˆå¯¹å­—ä½“æ–‡ä»¶ï¼Œå»ºè®®ä½¿ç”¨ asset/resource ç›´æ¥è¾“å‡ºåˆ°æ–‡ä»¶å¹¶é…ç½®è·¯å¾„ã€‚\n// å¼•å…¥å­—ä½“å›¾æ ‡æ ·å¼æ–‡ä»¶ import \u0026#39;./assets/fonts/iconfont.css\u0026#39; let iconfont = document.createElement(\u0026#39;i\u0026#39;) iconfont.className = \u0026#39;iconfont icon-web\u0026#39; document.body.appendChild(iconfont) module.exports = { module: { rules: [ { test: /\\.(eot|svg|ttf|woff|woff2)$/i, type: \u0026#39;asset/resource\u0026#39;, // ç›´æ¥è¾“å‡º generator: { // è‡ªå®šä¹‰è¾“å‡ºçš„æ–‡ä»¶å filename: \u0026#39;font/[name].[hash:6][ext]\u0026#39; } } ] } } ğŸ’¡ Trick é»˜è®¤æƒ…å†µä¸‹ï¼Œasset/resource æ¨¡å—ä»¥ [hash][ext][query] æ–‡æ¡£åå‘é€åˆ°è¾“å‡ºç›®å½•\nBabel Webpack æœ¬èº«åªæ”¯æŒå¤„ç†ä¸€éƒ¨åˆ†é«˜çº§çš„ Javascript è¯­æ³•ã€‚å¯¹äºé‚£äº› webpack æ— æ³•å¤„ç†çš„é«˜çº§è¯­æ³•ï¼Œéœ€è¦å€ŸåŠ©äº babel-loader è¿›è¡Œæ‰“åŒ…å¤„ç†ã€‚ä¾‹å¦‚ webpack æ— æ³•å¤„ç†ä¸‹é¢çš„ javascript è¯­æ³•ï¼š\nclass Person { // é€šè¿‡staticå…³é”®å­—ï¼Œä¸ºPersonç±»å®šä¹‰ç±»ä¸€ä¸ªé™æ€æ•°å­¦info // webpackæ— æ³•æ‰“åŒ…\u0026#34;static\u0026#34;è¿™ä¸ªé«˜çº§è¯­æ³• static info = \u0026#39;person info\u0026#39; } console.log(Person.info) éœ€è¦å®‰è£…å¦‚ä¸‹åŒ…ï¼šbabel-loader, @babel-core, @babel/plugin-proposal-class-properties\npnpm install -D babel-loader @babel/core @babel/preset-env module: { rules: [ { test: /\\.m?js$/, exclude: /(node_modules|bower_components)/, use: { loader: \u0026#39;babel-loader\u0026#39;, options: { presets: [\u0026#39;@babel/preset-env\u0026#39;] // babel é™çº§è§„åˆ™ } } } ] } æ‰“åŒ… ä¿®æ”¹ package.json ï¼š\n\u0026#34;scripts\u0026#34;: { \u0026#34;cls\u0026#34;:\u0026#34;printf \\\u0026#34;\\\\33c\\\\e[3J\\\u0026#34;\u0026#34;, \u0026#34;dev\u0026#34;: \u0026#34;npm run cls \u0026amp;\u0026amp; webpack serve\u0026#34;, \u0026#34;build\u0026#34;: \u0026#34;npm run cls \u0026amp;\u0026amp; webpack --mode production\u0026#34; // é¡¹ç›®å‘å¸ƒæ—¶æ‰§è¡Œ build å‘½ä»¤ }, ğŸ’¡ Trick MacOS ä¸‹çš„ clear å‘½ä»¤å¹¶ä¸èƒ½æ¸…å±ï¼Œå› æ­¤éœ€è¦ printf â€˜\\33c\\e[3Jâ€™ æˆ– âŒ˜+K è¿›è¡Œæ¸…é™¤ã€‚åœ¨ json æ ¼å¼ä¸‹è¿›è¡Œè½¬æ„ï¼Œåˆ™ä¸ºï¼š\u0026quot;cls\u0026quot;:\u0026quot;printf \\\u0026quot;\\\\33c\\\\e[3J\\\u0026quot;\u0026quot; ã€‚\nğŸ“ Note --model æ˜¯ä¸€ä¸ªå‚æ•°é¡¹ï¼Œç”¨æ¥æŒ‡å®š webpack çš„è¿è¡Œæ¨¡å¼ã€‚production ä»£è¡¨ç”Ÿäº§ç¯å¢ƒï¼Œä¼šå¯¹æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶è¿›è¡Œ ä»£ç å‹ç¼© å’Œ æ€§èƒ½ä¼˜åŒ– ã€‚\nâš ï¸ Caution é€šè¿‡ --model æŒ‡å®šçš„å‚æ•°é¡¹ï¼Œä¼šè¦†ç›– webpack.config.js ä¸­çš„ model é€‰é¡¹ã€‚\nä»£ç  ç»Ÿä¸€ç”Ÿæˆåˆ° js ç›®å½•ä¸­ï¼š\nentry: path.join(__dirname, \u0026#39;./src/index.js\u0026#39;), // æŒ‡å®šæ‰“åŒ…çš„å‡ºå£ output: { // è¡¨ç¤ºè¾“å‡ºæ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ path: path.join(__dirname, \u0026#39;./dist\u0026#39;), // è¡¨ç¤ºè¾“å‡ºæ–‡ä»¶çš„åç§° filename: \u0026#39;js/bundle.js\u0026#39; }, æ­¤æ—¶ï¼Œwebpack è‡ªåŠ¨æŠŠç”Ÿæˆçš„ bundle.js æ–‡ä»¶å­˜æ”¾åˆ° dist ç›®å½•ä¸‹çš„ js å­ç›®å½•ä¸­ã€‚\nå›¾ç‰‡ ä¿®æ”¹ webpack.config.js ä¸­çš„ url-loader é…ç½®é¡¹ï¼Œæ–°å¢ outputPath é€‰é¡¹å³å¯æŒ‡å®šå›¾ç‰‡æ–‡ä»¶çš„è¾“å‡ºè·¯å¾„ã€‚\næ¸…ç† ä¸ºäº†æ¯æ¬¡æ‰“åŒ…å‘å¸ƒæ—¶è‡ªåŠ¨æ¸…ç† dist ç›®å½•ä¸‹çš„æ—§æ–‡ä»¶ï¼Œå¯ä»¥å®‰è£…å¹¶é…ç½® clean-webpack-plugin æ’ä»¶ã€‚ä½¿ç”¨æ–¹æ³•åŒ html-webpack-plugin ï¼Œå…ˆå¼•å…¥åˆ›å»ºç±»ï¼Œå†æ–°å»ºå®ä¾‹å¯¹è±¡å¹¶å¯¼å…¥ plugin ä¸­ã€‚\nconst { CleanWebpackPlugin } = require(\u0026#39;clean-webpack-plugin\u0026#39;) const cleanPlugin = new CleanWebpackPlugin() { plugins: [cleanPlugin] // å°†å®ä¾‹æŒ‚è½½åœ¨æ•°ç»„ä¸Š æ‰§è¡Œé¡ºåºç”±ç»„ä»¶è‡ªèº«hookå†³å®š å› æ­¤é¡ºåºä¸é‡è¦ } Source Map å‰ç«¯é¡¹ç›®åœ¨æŠ•å…¥ç”Ÿäº§ç¯å¢ƒä¹‹å‰ï¼Œéƒ½éœ€è¦å¯¹æºä»£ç è¿›è¡Œå‹ç¼©æ··æ·†ï¼Œä»è€Œå‡å°æ–‡ä»¶ä½“ç§¯ã€‚ä¸ºäº†æ–¹ä¾¿è°ƒè¯•ï¼Œå¯ä»¥ä½¿ç”¨ SourceMap æ˜ å°„çš„ä½ç½®ä¿¡æ¯ï¼Œç›´æ¥è°ƒè¯•åŸå§‹ä»£ç ã€‚\nè€Œ webpack é»˜è®¤ç”Ÿäº§çš„ SourceMap ï¼Œè®°å½•çš„æ˜¯ç”Ÿæˆåä»£ç ä½ç½®ï¼Œä¼šå¯¼è‡´ è¿è¡Œæ—¶æŠ¥é”™è¡Œæ•° åŒ æºä»£ç è¡Œæ•° ä¸ä¸€è‡´çš„é—®é¢˜ã€‚æ·»åŠ  eval-source-nap ä»¥è¿›è¡Œå¯¹åº”ã€‚\nmodule.exports = { mode: \u0026#39;development\u0026#39;, // development production // eval-source-map ä»…é™åœ¨å¼€å‘æ¨¡å¼ä¸‹ä½¿ç”¨ devtool: \u0026#39;eval-source-map\u0026#39;, // ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œå»ºè®®å…³é—­ SourceMap æˆ–å°† devtool çš„å€¼è®¾ç½®ä¸º nosources-source-map // devtool: \u0026#39;nosources-source-map\u0026#39;, // devtool: \u0026#39;source-map\u0026#39;, // æŒ‡å®šæ‰“åŒ…çš„å…¥å£ } è€Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œå¦‚æœçœç•¥ devtool é€‰é¡¹ï¼Œåˆ™æœ€ç»ˆæ–‡ä»¶ä¸åŒ…å« SourceMap ã€‚è¿™èƒ½é˜²æ­¢åŸå§‹ä»£ç æ³„æ¼ã€‚å¦‚æœåªæƒ³ å®šä½æŠ¥é”™çš„å…·ä½“è¡Œæ•° ï¼Œä¸”ä¸æƒ³æš´éœ²æºä»£ç ï¼Œæ­¤æ—¶å¯ä»¥å°† devtool çš„å€¼è®¾ç½®ä¸º nosources-source-map ã€‚\nèµ„æºæ¨¡å— åœ¨ webpack5 ä¹‹å‰ï¼Œé€šå¸¸ä½¿ç”¨ï¼š\nraw-loader å°†æ–‡ä»¶å¯¼å…¥ä¸ºå­—ç¬¦ä¸² url-loader å°†æ–‡ä»¶ä½œä¸º data URL å†…è”åˆ° bundle ä¸­ file-loader å°†æ–‡ä»¶å‘é€åˆ°æ’ä»¶ç›®å½• è€Œ èµ„æºæ¨¡å—ç±»å‹Asset Module Type ï¼Œé€šè¿‡æ·»åŠ  4 ç§æ–°çš„æ¨¡å—ç±»å‹ï¼Œæ¥æ›¿æ¢æ‰€æœ‰è¿™äº› loader ï¼š\nasset/resource å‘é€ä¸€ä¸ªå•ç‹¬çš„æ–‡æ¡£å¹¶å¯¼å‡º URLã€‚ä¹‹å‰é€šè¿‡ä½¿ç”¨ file-loader å®ç°ã€‚ asset/inline å¯¼å‡ºä¸€ä¸ªèµ„æºçš„ data URIã€‚ä¹‹å‰é€šè¿‡ä½¿ç”¨ url-loader å®ç°ã€‚ asset/source å¯¼å‡ºèµ„æºçš„æºä»£ç ã€‚ä¹‹å‰é€šè¿‡ä½¿ç”¨ raw-loader å®ç°ã€‚ asset åœ¨å¯¼å‡ºä¸€ä¸ª data URI å’Œå‘é€ä¸€ä¸ªå•ç‹¬çš„æ–‡æ¡£ä¹‹é—´è‡ªåŠ¨é€‰æ‹©ã€‚ä¹‹å‰é€šè¿‡ä½¿ç”¨ url-loaderï¼Œå¹¶ä¸”é…ç½®èµ„æºä½“ç§¯é™åˆ¶å®ç°ã€‚ ","date":"2023-03-20","section":"techs","summary":"WebPack æ—©æœŸå‰ç«¯å·¥ç¨‹åŒ–è§£å†³æ–¹æ¡ˆï¼š\ngrunt - https://www.gruntjs.net/ gulp - https://gulpjs.com/ ç›®å‰ä¸»æµçš„å‰ç«¯å·¥ç¨‹åŒ–è§£å†³æ–¹æ¡ˆï¼š\nWebpack - https://webpack.js.org/ Parcell - https://parceljs.org/ Webpack æä¾›äº†å‹å¥½çš„ æ¨¡å—åŒ–å¼€å‘ æ”¯æŒï¼Œä»¥åŠä»£ç å‹ç¼©æ··æ·†ã€å¤„ç†æµè§ˆå™¨ç«¯ Js å…¼å®¹æ€§ã€ä»¥åŠæ€§èƒ½ä¼˜åŒ–ç­‰å¼ºå¤§åŠŸèƒ½ã€‚ç›®å‰ä¼ä¸šçº§çš„å‰ç«¯é¡¹ç›®å¼€å‘ä¸­ï¼Œç»å¤§å¤šæ•°é¡¹ç›®éƒ½æ˜¯åŸºäº Webpack è¿›è¡Œæ‰“åŒ…å¼€å‘çš„ã€‚\nğŸ”— Href Webpack ä¸­æ–‡æ–‡æ¡£\né…ç½® pnpm install webpack webpack-cli -D # install in dev åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œåˆ›å»ºåä¸º webpack.config.js çš„ Webpack é…ç½®æ–‡ä»¶ï¼Œå¹¶åˆå§‹åŒ–å¦‚ä¸‹çš„åŸºæœ¬é…ç½®ï¼š module.exports = { mode: \u0026#39;development\u0026#39;, // mode ç”¨æ¥æŒ‡å®šæ„å»ºæ¨¡å¼ï¼Œå¯é€‰å€¼æœ‰ development å’Œ production } åœ¨ package.json çš„ script èŠ‚ç‚¹ä¸‹ï¼Œæ–°å¢ dev è„šæœ¬ å¦‚ä¸‹ï¼š \u0026#34;scripts\u0026#34;: { \u0026#34;dev\u0026#34;: \u0026#34;webpack\u0026#34;, // script èŠ‚ç‚¹ä¸‹çš„è„šæœ¬ï¼Œå¯ä»¥é€šè¿‡ npm run æ‰§è¡Œ } åœ¨ç»ˆç«¯ä¸­è¿è¡Œ npm run dev å‘½ä»¤ï¼Œå¯åŠ¨ webpack è¿›è¡Œé¡¹ç›®çš„æ‰“åŒ…ç®¡ç† mode èŠ‚ç‚¹çš„å¯é€‰å€¼æœ‰ä¸¤ä¸ªï¼Œåˆ†åˆ«æ˜¯ï¼š8\ndevelopment\n","title":"18 WebPack","url":"/techs/18-webpack/"},{"content":"WeApp å¯¼è®º å¾®ä¿¡å°ç¨‹åºï¼Œç®€ç§°å°ç¨‹åºï¼Œè‹±æ–‡å Mini-program ï¼Œæ˜¯ä¸€ç§ä¸éœ€è¦ä¸‹è½½å®‰è£…å³å¯ä½¿ç”¨çš„åº”ç”¨ã€‚\næ­£å¼ä¸Šçº¿æ—¶é—´ï¼š2017å¹´1æœˆ9æ—¥\nå°ç¨‹åºçš„å‰ä¸–ä»Šç”Ÿ å°ç¨‹åºå¼€å‘è€…å·¥å…· å°ç¨‹åºåŸç”Ÿæ¡†æ¶ å°ç¨‹åºæ¨¡æ¿è¯­æ³• å°ç¨‹åºå†…ç½®ç»„ä»¶ å°ç¨‹åºç”Ÿå‘½å‘¨æœŸ å°ç¨‹åºè‡ªå®šä¹‰ç»„ä»¶ å¾®ä¿¡å°ç¨‹åºè‡ªå¸¦å¼€å‘è€…å·¥å…·ï¼Œæ‹¥æœ‰é›†å¼€å‘é¢„è§ˆè°ƒè¯•å‘å¸ƒäºä¸€èº«çš„å®Œæ•´ç¯å¢ƒã€‚\nä½†æ˜¯ç”±äºç¼–ç çš„ä½“éªŒä¸ç®—å¥½ï¼Œå› æ­¤å»ºè®®ä½¿ç”¨ VS Code + å¾®ä¿¡å°ç¨‹åºç¼–è¾‘å·¥å…· æ¥å®ç°ç¼–ç ã€‚\nVS Code è´Ÿè´£æ•²ä»£ç  å¾®ä¿¡å°ç¨‹åºç¼–è¾‘å·¥å…· è´Ÿè´£é¢„è§ˆ æ³¨å†Œè´¦å· -\u0026gt; è·å–AppID\nè·å–é€”å¾„ï¼šå¼€å‘ -\u0026gt; å¼€å‘è€…è®¾ç½® -\u0026gt; å¼€å‘å·¥å…· ç»“æ„ å°ç¨‹åºæ¡†æ¶ çš„ç›®æ ‡æ˜¯å°½å¯èƒ½ä»¥ç®€å•ã€é«˜æ•ˆçš„æ–¹å¼è®©å¼€å‘è€…åœ¨å¾®ä¿¡ä¸­æœ‰åŸç”ŸAppä½“éªŒçš„æœåŠ¡ã€‚\næ¡†æ¶ æ•´ä¸ªå°ç¨‹åºæ¡†æ¶ç³»ç»Ÿåˆ†ä¸ºï¼š\né€»è¾‘å±‚(App Service) è§†å›¾å±‚(View) å°ç¨‹åºåœ¨è§†å›¾å±‚ä¸é€»è¾‘å±‚é—´æä¾›äº†æ•°æ®ä¼ è¾“å’Œäº‹ä»¶ç³»ç»Ÿï¼Œæ ¸å¿ƒæ˜¯ä¸€ä¸ªå“åº”çš„æ•°æ®ç»‘å®šç³»ç»Ÿã€‚\nå½“åšæ•°æ®ä¿®æ”¹çš„æ—¶å€™ï¼Œåªéœ€è¦åœ¨é€»è¾‘å±‚ä¿®æ”¹æ•°æ®ï¼Œè§†å›¾å±‚å°±ä¼šåšç›¸åº”çš„æ›´æ–°ã€‚ï¼ˆç±»ä¼¼ Vue.js | React.jsï¼‰\nå¯¹æ¯” ä¼ ç»ŸWeb å¾®ä¿¡å°ç¨‹åº ç»“æ„ HTML WXML æ ·å¼ CSS WXSS é€»è¾‘ JavaScript JavaScript é…ç½® æ—  JSON é€šè¿‡ä»¥ä¸Šå¯¹æ¯”å¾—å‡ºï¼Œä¼ ç»ŸWeb æ˜¯3å±‚ç»“æ„ï¼Œè€Œ å¾®ä¿¡å°ç¨‹åº æ˜¯4å±‚ç»“æ„ï¼Œå¤šäº†ä¸€å±‚ é…ç½®.json\nç›®å½• pages: é¡µé¢æ–‡ä»¶å¤¹\nindex: é¦–é¡µ index.js: é€»è¾‘ index.json: é…ç½® index.wxml: ç»“æ„ index.wxss: æ ·å¼ logs: æ—¥å¿— logs.js logs.json logs.wxml logs.wxss utils: ç¬¬ä¸‰æ–¹åº“ utils.js app.js: ç¨‹åºå…¥å£ app.json: å…¨å±€é…ç½® app.wxss: å…¨å±€æ ·å¼ project.config.json: é¡¹ç›®é…ç½®æ–‡ä»¶ï¼Œå¦‚AppId stiemap.json: å¾®ä¿¡ç´¢å¼•é…ç½®æ–‡ä»¶ JSON JavaScript Object Notation - JS å¯¹è±¡ç®€è°±\nJSONæœ‰ä¸¤ç§æ•°æ®ç»“æ„ã€‚\nåç§°/å€¼å¯¹çš„é›†åˆï¼šKey: Value -\u0026gt; {} å€¼çš„æœ‰åºåˆ—è¡¨ï¼šArray -\u0026gt; [] .jsonæœ€åä¸€ä¸ªè¯­å¥çš„æœ«å°¾ä¸å¯ä»¥åŠ ,ä¸ç„¶ä¼šæŠ¥é”™ã€‚.jsonæ–‡ä»¶ä¸­æ‰€æœ‰çš„å­—ç¬¦ä¸²ä½¿ç”¨åŒå¼•å·ã€‚\napp.json { \u0026#34;pages\u0026#34;:[ \u0026#34;pages/index/index\u0026#34;, \u0026#34;pages/logs/logs\u0026#34; ], \u0026#34;window\u0026#34;:{ \u0026#34;backgroundTextStyle\u0026#34;:\u0026#34;light\u0026#34;, \u0026#34;navigationBarBackgroundColor\u0026#34;: \u0026#34;#fff\u0026#34;, \u0026#34;navigationBarTitleText\u0026#34;: \u0026#34;Weixin\u0026#34;, \u0026#34;navigationBarTextStyle\u0026#34;:\u0026#34;black\u0026#34; }, \u0026#34;style\u0026#34;: \u0026#34;v2\u0026#34;, \u0026#34;sitemapLocation\u0026#34;: \u0026#34;sitemap.json\u0026#34; } pages ï¼šç”¨äºæè¿°å½“å‰å°ç¨‹åºæ‰€æœ‰é¡µé¢è·¯å¾„\n\u0010windowï¼šå®šä¹‰å°ç¨‹åºæ‰€æœ‰é¡µé¢å±æ€§\nnavigationBarBackgroundColor navigationBarTextStyleï¼šdark / light backgroundTextStyleï¼šdark / light ä¸‹æ‹‰ loading çš„æ ·å¼ ä»…åœ¨enablePullDownRefresh == true æ—¶å¯ç”¨ backgroundColorTop / backgroundColorBottom é¡¶éƒ¨/åº•éƒ¨çª—å£çš„èƒŒæ™¯è‰²ï¼Œä»… iOS æ”¯æŒ æ ·å¼ æš—é»‘æ¨¡å¼ å¼€å¯æš—é»‘æ¨¡å¼\nåœ¨ app.json ä¸­é…ç½® \u0026quot;darkmode\u0026quot;: true\n// app.json { ... \u0026#34;darkmode\u0026#34;: true } é…ç½®ä¸»é¢˜æ–‡ä»¶\næ–°å»ºä¸»é¢˜é…ç½®æ–‡ä»¶ theme.jsonï¼Œå¹¶åœ¨ app.json ä¸­é…ç½®è·¯å¾„å¼•å…¥\n// app.json { ... \u0026#34;themeLocation\u0026#34;: \u0026#34;theme.json\u0026#34; } light æ­£å¸¸æ¨¡å¼ dark æš—é»‘æ¨¡å¼ // theme.json \u0026#34;light\u0026#34;: { \u0026#34;navBackgroundColor\u0026#34;: \u0026#34;#ffffff\u0026#34;, \u0026#34;navTextStyle\u0026#34;: \u0026#34;black\u0026#34; }, \u0026#34;dark\u0026#34;: {\t\u0026#34;navBackgroundColor\u0026#34;: \u0026#34;#000000\u0026#34;, \u0026#34;navTextStyle\u0026#34;: \u0026#34;white\u0026#34; } /* å¿…é¡»å­˜åœ¨ light å’Œ dark ä¸¤ä¸ªå±æ€§ï¼Œé‡Œå±‚å‘½åè‡ªå®šä¹‰ï¼Œæ²¡æœ‰ä¸¥æ ¼è¦æ±‚ */ åœ¨ app.json ä¸­åº”ç”¨é…ç½®å±æ€§\nåœ¨é…ç½®å±æ€§ä»¥ @ å¼€å¤´æ‹¼æ¥ theme.json ä¸­è‡ªå®šä¹‰çš„åå­—å†™å…¥é…ç½®ï¼š //app.json { ... \u0026#34;window\u0026#34;:{ \u0026#34;navigationBarTitleText\u0026#34;: \u0026#34;Weixin\u0026#34;, \u0026#34;navigationBarTextStyle\u0026#34;:\u0026#34;@navTextStyle\u0026#34;, \u0026#34;navigationBarBackgroundColor\u0026#34;: \u0026#34;@navBackgroundColor\u0026#34; }, ... \u0026#34;darkmode\u0026#34;: true, \u0026#34;themeLocation\u0026#34;: \u0026#34;theme/theme.json\u0026#34; } wxssæ ·å¼é€‚é…æš—é»‘æ¨¡å¼\nwxss ä¸­ï¼Œæ”¯æŒé€šè¿‡åª’ä½“æŸ¥è¯¢ prefers-color-scheme é€‚é…ä¸åŒä¸»é¢˜ã€‚\nä½¿ç”¨CSSé€‰æ‹©å™¨@media (prefers-color-scheme: dark) å¦‚ä¸‹æ ·å¼ä¼šåœ¨æ­£å¸¸æ¨¡å¼ä¸‹é¡µé¢èƒŒæ™¯ä¸ºç°ç™½è‰²ï¼Œæš—é»‘æ¨¡å¼ä¸‹ä¸ºé»‘è‰²ã€‚\n/* æ­£å¸¸æ¨¡å¼ä¸‹åº”ç”¨çš„æ ·å¼ */ page{ background: #f1f1f1; } /* æš—é»‘æ¨¡å¼ä¸‹åº”ç”¨çš„æ ·å¼ */ @media (prefers-color-scheme: dark) { page{ background: #000000; } } TabBar é€šè¿‡ tabBar é…ç½®é¡¹æŒ‡å®š tab æ çš„è¡¨ç°ã€‚\næ–‡æ¡£åœ°å€ï¼šhttps://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html#tabBar\nå•ç‹¬è®¾ç½® tabBar å…ƒç´ ï¼š\nwx.setTabBarItem({ index: 0, text: \u0026#39;text\u0026#39;, iconPath: \u0026#39;/path/to/iconPath\u0026#39;, selectedIconPath: \u0026#39;/path/to/selectedIconPath\u0026#39; }) //tabbaræ ·å¼æ”¯æŒåœ¨.jsonä¸­å•ç‹¬æŒ‡å®š è¯­æ³• WXML WXMLï¼ˆWeiXin Markup Languageï¼‰æ˜¯æ¡†æ¶è®¾è®¡çš„ä¸€å¥—æ ‡ç­¾è¯­è¨€ï¼Œç»“åˆåŸºç¡€ç»„ä»¶ã€äº‹ä»¶ç³»ç»Ÿï¼Œå¯ä»¥æ„å»ºå‡ºé¡µé¢çš„ç»“æ„ã€‚\næ ‡ç­¾ \u0026lt;!-- 1. \u0026lt;text\u0026gt;ç›¸å½“äº\u0026lt;span\u0026gt;æ ‡ç­¾ --\u0026gt; \u0026lt;text\u0026gt;è¿™æ˜¯ä¸€ä¸ªè¡Œå†…å…ƒç´ \u0026lt;/text\u0026gt; \u0026lt;!-- 2. \u0026lt;view\u0026gt;ç›¸å½“äº\u0026lt;div\u0026gt;æ ‡ç­¾ --\u0026gt; \u0026lt;view\u0026gt;è¿™æ˜¯ä¸€ä¸ªå—çº§å…ƒç´ \u0026lt;/view\u0026gt; æ•°æ®ç»‘å®š æ•°æ®ç»‘å®šä½¿ç”¨ Mustache è¯­æ³•ï¼ˆåŒå¤§æ‹¬å·ï¼‰å°†å˜é‡åŒ…èµ·æ¥ï¼›\nåœ¨æ ‡ç­¾ä¸­ä½¿ç”¨æ—¶ï¼Œéœ€è¦åŠ ä¸ŠåŒå¼•å· \u0026quot; \u0026ldquo;ï¼š\nåŒå¼•å· \u0026rdquo; \u0026ldquo; å’ŒåŒå¤§æ‹¬å· {{ }} ä¹‹é—´ä¸èƒ½å‡ºç°ç©ºæ ¼ï¼Œå¦åˆ™ä¼šè¯†åˆ«å¤±è´¥ å¯ä»¥åœ¨åŒå¤§æ‹¬å· {{ }} ä¸­åŠ å…¥è¡¨è¾¾å¼ -\u0026gt;â€œè¯­å¥â€ ç®€å•è¿ç®—ï¼šæ•°å­—çš„åŠ å‡ å­—ç¬¦ä¸²æ‹¼æ¥ ä¸‰å…ƒè¡¨è¾¾å¼ \u0026lt;!--wxml--\u0026gt; \u0026lt;view\u0026gt; {{message}} \u0026lt;/view\u0026gt; \u0026lt;view id=\u0026#34;{{message}}\u0026#34;\u0026gt;\u0026lt;/view\u0026gt; // page.js Page({ data: { message: \u0026#39;Hello MINA!\u0026#39; } }) å¯ä»¥åœ¨ {{}} å†…è¿›è¡Œç®€å•çš„è¿ç®—ï¼Œæ”¯æŒ ä¸‰å…ƒè¿ç®—\nåˆ—è¡¨æ¸²æŸ“ wx:for \u0026rdquo;{{æ•°ç»„æˆ–è€…å¯¹è±¡}}\u0026quot;ï¼šwx:for \u0026ldquo;å¾ªç¯é¡¹çš„åç§°â€ï¼šwx:for-item \u0026ldquo;å¾ªç¯é¡¹çš„ç´¢å¼•\u0026rdquo;ï¼šwx:for-index å¯ä»¥å°† wx:for ç”¨åœ¨\u0026lt;block/\u0026gt;æ ‡ç­¾ä¸Šï¼Œä»¥æ¸²æŸ“ä¸€ä¸ªåŒ…å«å¤šèŠ‚ç‚¹çš„ç»“æ„å—ã€‚\nNote: wx:for-item \u0026amp; wx:for-indexçš„é»˜è®¤å€¼ä¸ºitem(å½“å‰å…ƒç´ )å’Œindex(è¯¥å—åœ¨æ¸²æŸ“åˆ—è¡¨ä¸­çš„é¡ºåº)\nâš ï¸ Caution å½“å‡ºç°åµŒå¥—å¾ªç¯ç»‘å®šçš„æ—¶ï¼Œå°¤å…¶è¦æ³¨æ„ç»‘å®šçš„åç§°ï¼ˆwx:for-item \u0026amp; wx:for-indexï¼‰ä¸è¦é‡å¤ã€‚\n\u0026lt;!--wxml--\u0026gt; \u0026lt;view wx:for=\u0026#34;{{array}}\u0026#34;\u0026gt; {{item}} \u0026lt;/view\u0026gt; \u0026lt;view wx:for=\u0026#34;{{objectArray}}\u0026#34; wx:for-item=\u0026#34;item\u0026#34; wx:for-index=\u0026#34;index\u0026#34;\u0026gt; ç´¢å¼•{{index}} --- å€¼{{item.name}} \u0026lt;/view\u0026gt; // page.js Page({ data: { numberArray: [1, 2, 3, 4, 5], objectArray: [ {id: 0, name: \u0026#34;name_0\u0026#34;}, {id: 1, name: \u0026#34;name_1\u0026#34;}, {id: 2, name: \u0026#34;name_2\u0026#34;} ] }) wx:key æŒ‡å®šå¾ªç¯ä¸­å…·ä½“é¡¹ç›®ã€‚\n\u0026rdquo;{{å”¯ä¸€çš„å€¼}}\u0026quot;ï¼šwx:key\nwx:key çš„å€¼ä»¥ä¸¤ç§å½¢å¼æä¾›ï¼š\nå­—ç¬¦ä¸²ï¼Œä»£è¡¨åœ¨ for å¾ªç¯çš„ array ä¸­ item çš„æŸä¸ª propertyï¼Œè¯¥ property çš„å€¼å”¯ä¸€ä¸”ä¸èƒ½åŠ¨æ€æ”¹å˜ã€‚ {{objectArray}} âŸ¹ wx:key=\u0026quot;unique\u0026quot; *this ä»£è¡¨åœ¨ for å¾ªç¯ä¸­çš„itemæœ¬èº«ï¼Œitemå”¯ä¸€ã€‚ {{numberArray}} âŸ¹ wx:key=\u0026quot;*this\u0026quot; è¡¨ç¤ºæ•°ç»„æ˜¯ä¸€ä¸ªæ™®é€šæ•°ç»„ï¼š*thisæ˜¯ä¸€ä¸ªå¾ªç¯é¡¹ å½“æ•°æ®æ”¹å˜è§¦å‘æ¸²æŸ“å±‚é‡æ–°æ¸²æŸ“çš„æ—¶å€™ï¼Œä¼šæ ¡æ­£å¸¦æœ‰keyçš„ç»„ä»¶ï¼Œæ¡†æ¶ä¼šç¡®ä¿ä»–ä»¬è¢«é‡æ–°æ’åºï¼Œè€Œä¸æ˜¯é‡æ–°åˆ›å»ºï¼Œä»¥ç¡®ä¿ä½¿ç»„ä»¶ä¿æŒè‡ªèº«çš„çŠ¶æ€ï¼Œå¹¶ä¸”æé«˜åˆ—è¡¨æ¸²æŸ“æ—¶çš„æ•ˆç‡ã€‚\nNote: å¯ä»¥ä½¿ç”¨wx:key=\u0026quot;*this\u0026quot;æ¥å»é™¤wx:forä¸­çš„ Warning ã€‚\nâš ï¸ Caution wx:keyæŒ‡å®šçš„æ ‡ç­¾ä¸å­˜åœ¨æ—¶ï¼Œç³»ç»Ÿä¹Ÿä¸ä¼šæŠ¥é”™ã€‚\n\u0026lt;view wx:for=\u0026#34;{{objectArray}}\u0026#34; wx:key=\u0026#34;unique\u0026#34;\u0026gt; {{item.id}}\u0026lt;/view\u0026gt; \u0026lt;view wx:for=\u0026#34;{{numberArray}}\u0026#34; wx:key=\u0026#34;*this\u0026#34;\u0026gt; {{item}} \u0026lt;/view\u0026gt; // page.js Page({ data: { objectArray: [ {id: 2, unique: \u0026#39;unique_2\u0026#39;}, {id: 1, unique: \u0026#39;unique_1\u0026#39;}, {id: 0, unique: \u0026#39;unique_0\u0026#39;}, ], numberArray: [1, 2, 3, 4] }, }); æ¡ä»¶æ¸²æŸ“ wx:if åˆ¤æ–­æ˜¯å¦éœ€è¦æ¸²æŸ“è¯¥ä»£ç å—ï¼š\n\u0026lt;!--wxml--\u0026gt; \u0026lt;view wx:if=\u0026#34;{{view == \u0026#39;WEBVIEW\u0026#39;}}\u0026#34;\u0026gt; WEBVIEW \u0026lt;/view\u0026gt; \u0026lt;view wx:elif=\u0026#34;{{view == \u0026#39;APP\u0026#39;}}\u0026#34;\u0026gt; APP \u0026lt;/view\u0026gt; \u0026lt;view wx:else=\u0026#34;{{view == \u0026#39;MINA\u0026#39;}}\u0026#34;\u0026gt; MINA \u0026lt;/view\u0026gt; // page.js Page({ data: { view: \u0026#39;MINA\u0026#39; } }) ğŸ“ Note wx:if vs hidden\nå› ä¸º wx:if ä¹‹ä¸­çš„æ¨¡æ¿ä¹Ÿå¯èƒ½åŒ…å«æ•°æ®ç»‘å®šï¼Œæ‰€ä»¥å½“ wx:if çš„æ¡ä»¶å€¼åˆ‡æ¢æ—¶ï¼Œæ¡†æ¶æœ‰ä¸€ä¸ªå±€éƒ¨æ¸²æŸ“çš„è¿‡ç¨‹ï¼Œå› ä¸ºå®ƒä¼šç¡®ä¿æ¡ä»¶å—åœ¨åˆ‡æ¢æ—¶é”€æ¯æˆ–é‡æ–°æ¸²æŸ“\nåŒæ—¶ wx:if ä¹Ÿæ˜¯æƒ°æ€§çš„ï¼Œå¦‚æœåœ¨åˆå§‹æ¸²æŸ“æ¡ä»¶ä¸º falseï¼Œæ¡†æ¶ä»€ä¹ˆä¹Ÿä¸åšï¼Œåœ¨æ¡ä»¶ç¬¬ä¸€æ¬¡å˜æˆçœŸçš„æ—¶å€™æ‰å¼€å§‹å±€éƒ¨æ¸²æŸ“\nhidden å°±ç®€å•çš„å¤šï¼Œç»„ä»¶å§‹ç»ˆä¼šè¢«æ¸²æŸ“ï¼Œåªæ˜¯ç®€å•çš„æ§åˆ¶æ˜¾ç¤ºä¸éšè—\nhidden hidden = \u0026quot;{{condition}}\u0026quot; \u0026lt;block\u0026gt; å°†å¤šä¸ªç»„ä»¶åŒ…è£…èµ·æ¥ï¼Œå¹¶åœ¨ä¸Šè¾¹ä½¿ç”¨ wx:ifÂ æ§åˆ¶å±æ€§ã€‚\nNote: \u0026lt;block/\u0026gt; å¹¶ä¸æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œå®ƒä»…ä»…æ˜¯ä¸€ä¸ªåŒ…è£…å…ƒç´ ï¼Œä¸ä¼šåœ¨é¡µé¢ä¸­åšä»»ä½•æ¸²æŸ“ï¼Œåªæ¥å—æ§åˆ¶å±æ€§ã€‚\n\u0026lt;block wx:if=\u0026#34;{{view == \u0026#39;MINA\u0026#39;}}\u0026#34;\u0026gt; \u0026lt;view\u0026gt;view1\u0026lt;/view\u0026gt; \u0026lt;view\u0026gt;view2\u0026lt;/view\u0026gt; \u0026lt;/block\u0026gt; æ¨¡æ¿ \u0026lt;!--wxml--\u0026gt; \u0026lt;template name=\u0026#34;staffName\u0026#34;\u0026gt; \u0026lt;view\u0026gt; FirstName: {{firstName}}, LastName: {{lastName}} \u0026lt;/view\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;template is=\u0026#34;staffName\u0026#34; data=\u0026#34;{{...staffA}}\u0026#34;\u0026gt;\u0026lt;/template\u0026gt; \u0026lt;template is=\u0026#34;staffName\u0026#34; data=\u0026#34;{{...staffB}}\u0026#34;\u0026gt;\u0026lt;/template\u0026gt; \u0026lt;template is=\u0026#34;staffName\u0026#34; data=\u0026#34;{{...staffC}}\u0026#34;\u0026gt;\u0026lt;/template\u0026gt; // page.js Page({ data: { staffA: {firstName: \u0026#39;Hulk\u0026#39;, lastName: \u0026#39;Hu\u0026#39;}, staffB: {firstName: \u0026#39;Shang\u0026#39;, lastName: \u0026#39;You\u0026#39;}, staffC: {firstName: \u0026#39;Gideon\u0026#39;, lastName: \u0026#39;Lin\u0026#39;} } }) WXSS WXSSï¼ˆWeiXin Style Sheetsï¼‰æ˜¯ä¸€å¥—æ ·å¼è¯­è¨€ï¼Œç”¨äºæè¿° WXML çš„ç»„ä»¶æ ·å¼ï¼Œå†³å®š WXML çš„ç»„ä»¶åº”è¯¥æ€ä¹ˆæ˜¾ç¤ºã€‚\nå°ç¨‹åºä¸­ä¸éœ€è¦ä¸»åŠ¨å¼•å…¥æ ·å¼æ–‡ä»¶ éœ€è¦æŠŠé¡µé¢ä¸­æŸäº›å…ƒç´ çš„å•ä½ç”± px æ”¹ä¸º rpx / % æ¢ç®—å…³ç³»ï¼š750rpx = 100% å°ºå¯¸å•ä½ rpxï¼ˆresponsive pixelï¼‰å¯ä»¥æ ¹æ®å±å¹•å®½åº¦è¿›è¡Œè‡ªé€‚åº”ã€‚è§„å®šå±å¹•å®½ä¸º750rpxã€‚\n\u0010å¦‚åœ¨ iPhone6 ä¸Šï¼Œå±å¹•å®½åº¦ä¸º375pxï¼Œå…±æœ‰750ä¸ªç‰©ç†åƒç´ ï¼Œåˆ™750rpx = 375px = 750ç‰©ç†åƒç´ ï¼Œ1rpx = 0.5px = 1ç‰©ç†åƒç´ ã€‚ CSS åŸç”Ÿæ”¯æŒcalcå±æ€§\nview{ width: calc(750rpx * 100 / 375); } Note: å»ºè®®å¼€å‘æ—¶ä»¥iPhone6å®½åº¦ä¸ºæ ‡å‡†ã€‚\næ ·å¼å¯¼å…¥ ä½¿ç”¨@importè¯­å¥å¯ä»¥å¯¼å…¥å¤–è”æ ·å¼è¡¨ï¼Œ@importåè·Ÿéœ€è¦å¯¼å…¥çš„å¤–è”æ ·å¼è¡¨çš„ç›¸å¯¹è·¯å¾„ï¼Œç”¨;è¡¨ç¤ºè¯­å¥ç»“æŸã€‚\n@import \u0026#34;../../styles/common.wxss\u0026#34; é€‰æ‹©å™¨ Note: å°ç¨‹åºä¸æ”¯æŒé€šé…ç¬¦*\nLESS åŸç”Ÿå°ç¨‹åºä¸æ”¯æŒlessï¼Œå…¶ä»–åŸºäºå°ç¨‹åºçš„æ¡†æ¶å¤§ä½“éƒ½æ”¯æŒï¼Œå¦‚wepy mpvue taroç­‰ã€‚å¯ä»¥ç”¨ä»¥ä¸‹æ–¹å¼æ¥å®ç°ï¼š\n: LESSï¼ˆLinear Style Sheetï¼‰æ˜¯ä¸€ä¸ªCSS*é¢„å¤„ç†è¯­è¨€\nç¼–è¾‘å™¨æ˜¯ VS Code\nå®‰è£…æ’ä»¶ easy less\nAuto-compile LESS to CSS on save åœ¨ VS Code çš„è®¾ç½®ä¸­é…ç½®ï¼š\n\u0026#34;less.compile\u0026#34;: { \u0026#34;outExt\u0026#34;: \u0026#34;.wxss\u0026#34; } åœ¨è¦ç¼–å†™æ ·å¼çš„åœ°æ–¹ï¼Œæ–°å»ºlessæ–‡ä»¶ï¼Œå¦‚index.lessï¼Œç„¶åæ­£å¸¸ç¼–è¾‘å³å¯\n/* 1 å®šä¹‰lesså˜é‡ */ @color:yellow; text{ /* 2 ä½¿ç”¨å˜é‡ */ color: @color; } .view{ .vie1{ text{ color: red; } } } Note: ä»å¼€å‘è€…å·¥å…· 1.05.2109101 ä»¥ä¸Šå¼€å§‹ï¼Œæ”¯æŒä»¥ç¼–è¯‘æ’ä»¶çš„å½¢å¼ï¼Œæ‰©å±•ç¼–è¯‘åŠŸèƒ½ã€‚\nä½¿ç”¨ï¼š\næ—§é¡¹ç›®ï¼š\nåœ¨ project.config.json æ–‡ä»¶ä¸­ï¼Œä¿®æ”¹ setting ä¸‹çš„useCompilerPluginså­—æ®µä¸º[\u0026quot;typescript\u0026quot;]ï¼Œå³å¯å¼€å¯å·¥å…·å†…ç½®çš„ typescript ç¼–è¯‘æ’ä»¶ å¦‚éœ€åŒæ—¶å¼€å¯less ç¼–è¯‘æ’ä»¶ï¼Œå¯å°†è¯¥å­—æ®µä¿®æ”¹ä¸º [\u0026quot;typescript\u0026quot;, \u0026quot;less\u0026quot;] æ–°å»ºé¡¹ç›®ï¼š\nå¯åœ¨åˆ›å»ºå°ç¨‹åºé¡¹ç›®æ—¶ï¼Œé€‰æ‹©å¯¹åº”çš„è¯­è¨€æ¨¡æ¿ã€‚ ç›®å‰æ”¯æŒçš„è¯­è¨€æ¨¡æ¿æœ‰ï¼š TypeScript TypeScript + Less TypeScript + Sass ç»„ä»¶ Note: æ— æ³•åœ¨å°ç¨‹åºäº‹ä»¶ä¸­ç›´æ¥ä¼ å‚ï¼Œå¯ä½¿ç”¨ bindinput / bind:inputä¼ é€’æ•°å­—ï¼ˆe.currentTarget.dataset.operation;ï¼‰ã€‚\nåŸºç¡€ç»„ä»¶ Icon å›¾æ ‡ç»„ä»¶ã€‚\nå±æ€§ typeï¼šiconçš„ç±»å‹ success success_no_circle etc\u0026hellip; size color å¸ƒå±€ \u0026lt;block wx:for=\u0026#34;{{iconType}}\u0026#34; wx:key=\u0026#34;*this\u0026#34;\u0026gt; \u0026lt;view class=\u0026#34;icon-box\u0026#34; style=\u0026#34;border:1px solid red\u0026#34;\u0026gt; \u0026lt;icon class=\u0026#34;icon-box-img\u0026#34; type=\u0026#34;{{item}}\u0026#34; size=\u0026#34;{{iconSize[index]}}\u0026#34; color=\u0026#34;{{iconColor[index]}}\u0026#34;\u0026gt;\u0026lt;/icon\u0026gt; \u0026lt;view class=\u0026#34;icon-box-ctn\u0026#34;\u0026gt; \u0026lt;view class=\u0026#34;icon-box-desc\u0026#34;\u0026gt;{{index}}\u0026lt;/view\u0026gt; \u0026lt;view class=\u0026#34;icon-box-title\u0026#34;\u0026gt;{{item}}\u0026lt;/view\u0026gt; \u0026lt;/view\u0026gt; \u0026lt;/view\u0026gt; \u0026lt;/block\u0026gt; Page({ data: { iconSize: [20, 30, 40, 50, 60, 70, 80, 90, 100], iconColor: [ \u0026#39;red\u0026#39;, \u0026#39;orange\u0026#39;, \u0026#39;yellow\u0026#39;, \u0026#39;green\u0026#39;, \u0026#39;blue\u0026#39;, \u0026#39;purple\u0026#39;, \u0026#39;rgb(0,255,255)\u0026#39;, \u0026#39;rgb(255,0,255)\u0026#39;, \u0026#39;rgb(255,255,0)\u0026#39; //ç”¨rgbè¡¨ç¤ºè‡ªå®šä¹‰é¢œè‰² ], iconType: [ \u0026#39;success\u0026#39;, \u0026#39;success_no_circle\u0026#39;, \u0026#39;info\u0026#39;, \u0026#39;warn\u0026#39;, \u0026#39;waiting\u0026#39;, \u0026#39;cancel\u0026#39;, \u0026#39;download\u0026#39;, \u0026#39;search\u0026#39;, \u0026#39;clear\u0026#39; ] } }); è§†å›¾ç»„ä»¶ Text æ–‡æœ¬æ ‡ç­¾ï¼Œåªèƒ½åµŒå¥—text\nå±æ€§ user-selectï¼šæ–‡æœ¬æ˜¯å¦å¯é€‰ï¼Œè¯¥å±æ€§ä¼šä½¿æ–‡æœ¬èŠ‚ç‚¹æ˜¾ç¤ºä¸ºinline-blockï¼Œé»˜è®¤ä¸ºfalse spaceï¼šæ˜¾ç¤ºè¿ç»­ç©ºæ ¼ ensp\tä¸­æ–‡å­—ç¬¦ç©ºæ ¼ä¸€åŠå¤§å° emsp\tä¸­æ–‡å­—ç¬¦ç©ºæ ¼å¤§å° nbsp\tæ ¹æ®å­—ä½“è®¾ç½®çš„ç©ºæ ¼å¤§å° decodeï¼šæ˜¯å¦è§£ç ï¼ˆ\u0026amp;nbsp; \u0026amp;gt;è¿™äº›ï¼‰ Rich-Text å¯Œæ–‡æœ¬æ ‡ç­¾ï¼Œç±»ä¼¼ Vue ä¸­çš„v-htmlåŠŸèƒ½\nå±æ€§ nodes = {{data}}ï¼šèŠ‚ç‚¹åˆ—è¡¨/HTML String {} - æ¥å—å¯¹è±¡æ•°ç»„ï¼ˆdefaultï¼‰\nchildrençš„typeæœ‰type: textå’Œtype: nodeä¸¤ç§\ntype: textï¼š\nchildren:[{ type:\u0026#34;text\u0026#34; text:\u0026#34;\u0026#34; }] Page({ Data: { html: { name: \u0026#34;div\u0026#34;, /*æ ‡ç­¾å name ä¸èƒ½ä¸ºview/text*/ attrs: { /*æ ‡ç­¾ä¸Šçš„å±æ€§ class style*/ class: \u0026#34;my_div\u0026#34;, style: \u0026#34;color: red;\u0026#34; }, children: [{ /*å­èŠ‚ç‚¹ children*/ /*å¯æ¥å—çš„æ•°æ®ç±»å‹åŒnodeç¬¬äºŒç§æ¸²æŸ“æ–¹å¼çš„æ•°æ®ç±»å‹ä¸€è‡´*/ /*type=text*/ type: \u0026#34;text\u0026#34;, text: \u0026#34;hello\u0026#34; }, { type: \u0026#34;node\u0026#34;, /*type=node*/ name: \u0026#34;div\u0026#34;, attrs: { class: \u0026#34;my_div\u0026#34;, style: \u0026#39;color: red;\u0026#39; }, children: [{ type: \u0026#34;text\u0026#34;, text: \u0026#34;hello\u0026#34; }] }] } } }); \u0026quot;\u0026quot; - æ¥å—æ ‡ç­¾å­—ç¬¦ä¸²\nspaceï¼šæ˜¾ç¤ºè¿ç»­ç©ºæ ¼ å¸ƒå±€ View ä»£æ›¿åŸæ¥çš„divæ ‡ç­¾\nå±æ€§ hover-classï¼šæŒ‡å®šæŒ‰ä¸‹å»çš„æ ·å¼ç±» hover-stop-propagationï¼šæ˜¯å¦é˜»æ­¢æœ¬èŠ‚ç‚¹çš„ç¥–å…ˆèŠ‚ç‚¹å‡ºç°ç‚¹å‡»æ€ hover-start-time hover-stay-time å¸ƒå±€ \u0026lt;view class=\u0026#34;page-section-spacing\u0026#34;\u0026gt; \u0026lt;view class=\u0026#34;flex-wrp\u0026#34; style=\u0026#34;flex-direction:row;\u0026#34;\u0026gt; \u0026lt;view class=\u0026#34;flex-item demo-text-1\u0026#34;\u0026gt;\u0026lt;/view\u0026gt; \u0026lt;view class=\u0026#34;flex-item demo-text-2\u0026#34;\u0026gt;\u0026lt;/view\u0026gt; \u0026lt;view class=\u0026#34;flex-item demo-text-3\u0026#34;\u0026gt;\u0026lt;/view\u0026gt; \u0026lt;/view\u0026gt; \u0026lt;/view\u0026gt; \u0026lt;view class=\u0026#34;flex-wrp\u0026#34; style=\u0026#34;flex-direction:column;\u0026#34;\u0026gt; \u0026lt;view class=\u0026#34;flex-item flex-item-V demo-text-1\u0026#34;\u0026gt;\u0026lt;/view\u0026gt; \u0026lt;view class=\u0026#34;flex-item flex-item-V demo-text-2\u0026#34;\u0026gt;\u0026lt;/view\u0026gt; \u0026lt;view class=\u0026#34;flex-item flex-item-V demo-text-3\u0026#34;\u0026gt;\u0026lt;/view\u0026gt; \u0026lt;/view\u0026gt; flex-direction: row æ¨ªå‘å¸ƒå±€ A B C flex-direction: column çºµå‘å¸ƒå±€ A B C ### è¡¨å•ç»„ä»¶ radio å•é€‰é¡¹ç›®ã€‚éœ€è¦æ­é… radio-group ä½¿ç”¨ã€‚\nå±æ€§ valueï¼šradioæ ‡è¯†ã€‚å½“è¯¥radioé€‰ä¸­æ—¶ï¼Œ radio-group çš„changeäº‹ä»¶ä¼šæºå¸¦radioçš„value checked disabled color å¸ƒå±€ \u0026lt;!--page.wxml--\u0026gt; \u0026lt;radio-group bind:change=\u0026#34;radioChange\u0026#34;\u0026gt; \u0026lt;radio value=\u0026#34;1\u0026#34; color=\u0026#34;#33DCEE\u0026#34;\u0026gt;ç”·\u0026lt;/radio\u0026gt; \u0026lt;radio value=\u0026#34;0\u0026#34; color=\u0026#34;#D11FF8\u0026#34;\u0026gt;å¥³\u0026lt;/radio\u0026gt; \u0026lt;/radio-group\u0026gt; // page.js radioChange(e){ console.log(e); console.log(e.detail.value); let gender = e.detail.value; this.setData({ //gender:gender gender }) }, checkbox å¤é€‰æ¡†æ ‡ç­¾ã€‚éœ€è¦æ­é… checkbox-group ä½¿ç”¨ã€‚\n\u0026lt;!--page.wxml--\u0026gt; \u0026lt;view\u0026gt;é»˜è®¤æ ·å¼\u0026lt;/view\u0026gt; \u0026lt;label class=\u0026#34;checkbox\u0026#34;\u0026gt; \u0026lt;checkbox value=\u0026#34;cb\u0026#34; checked=\u0026#34;true\u0026#34;/\u0026gt;é€‰ä¸­ \u0026lt;/label\u0026gt; \u0026lt;label class=\u0026#34;checkbox\u0026#34;\u0026gt; \u0026lt;checkbox value=\u0026#34;cb\u0026#34; /\u0026gt;æœªé€‰ä¸­ \u0026lt;/label\u0026gt; \u0026lt;view\u0026gt;æ¨èå±•ç¤ºæ ·å¼\u0026lt;/view\u0026gt; \u0026lt;checkbox-group bindchange=\u0026#34;checkboxChange\u0026#34;\u0026gt; \u0026lt;label wx:for=\u0026#34;{{checkItems}}\u0026#34; wx:key=\u0026#34;{{item.value}}\u0026#34;\u0026gt; \u0026lt;view\u0026gt; \u0026lt;checkbox value=\u0026#34;{{item.value}}\u0026#34; checked=\u0026#34;{{item.checked}}\u0026#34;/\u0026gt; \u0026lt;/view\u0026gt; \u0026lt;view\u0026gt;{{item.name}}\u0026lt;/view\u0026gt; \u0026lt;/label\u0026gt; \u0026lt;/checkbox-group\u0026gt; \u0026lt;view\u0026gt;{{checkedList}}\u0026lt;/view\u0026gt; // page.js Page({ data: { checkItems: [ {value: \u0026#39;USA\u0026#39;, name: \u0026#39;ç¾å›½\u0026#39;}, {value: \u0026#39;CHN\u0026#39;, name: \u0026#39;ä¸­å›½\u0026#39;, checked: \u0026#39;true\u0026#39;}, {value: \u0026#39;BRA\u0026#39;, name: \u0026#39;å·´è¥¿\u0026#39;}, {value: \u0026#39;JPN\u0026#39;, name: \u0026#39;æ—¥æœ¬\u0026#39;}, {value: \u0026#39;ENG\u0026#39;, name: \u0026#39;è‹±å›½\u0026#39;}, {value: \u0026#39;FRA\u0026#39;, name: \u0026#39;æ³•å›½\u0026#39;} ] }, checkboxChange(e) { const checkedList = e.detail.value; this.setData({ //checkedList:checkedList; checkedList; }); console.log(\u0026#39;checkboxå‘ç”Ÿchangeäº‹ä»¶ï¼Œæºå¸¦valueå€¼ä¸ºï¼š\u0026#39;, checkedList); } }); å±æ€§ valueï¼šcheckboxæ ‡è¯†ï¼Œé€‰ä¸­æ—¶è§¦å‘ checkbox-group çš„changeäº‹ä»¶ï¼Œå¹¶æºå¸¦checkboxçš„value checked disabled color button é€šè¿‡è‡ªå®šä¹‰å±æ€§ data-operationè¿›è¡Œä¼ å‚ï¼ˆåªæ”¯æŒæ•°å­—å‚æ•°ï¼‰ ï¼Œè¿™æ ·å³å¯åœ¨äº‹ä»¶é’©å­å‡½æ•°è°ƒç”¨ã€‚\ne =\u0026gt; {this.data.inputStr} å±æ€§ sizeï¼šæŒ‰é’®å¤§å°\ndefault mini typeï¼šæŒ‰é’®ç±»å‹\nprimary - ç»¿\ndefault - ç™½\nwarn - çº¢\nè‡ªå®šä¹‰CSSï¼š\nbutton[type=primary] { background-image: linear-gradient(55deg,#07c160, #e6369d); } button[type=primary].button-hover { background-image: linear-gradient(-55deg,#07c160, #e6369d); } plainï¼šæŒ‰é’®æ˜¯å¦é•‚ç©ºï¼ŒèƒŒæ™¯è‰²é€æ˜\nloadingï¼šæŒ‰é’®å‰åŠ ä¸Šç­‰å¾…å›¾æ ‡\näº¤äº’ open-type\ncontactï¼šæ‰“å¼€å®¢æœä¼šè¯\nå°†å°ç¨‹åºçš„appidç”±æµ‹è¯•å·æ”¹æˆè‡ªå·±çš„appid ç™»å½•å¾®ä¿¡å°ç¨‹åºå®˜ç½‘ï¼Œæ·»åŠ å®¢æœ - å¾®ä¿¡ å®¢æœåœ¨æœåŠ¡é€šçŸ¥ä¸­å³å¯çœ‹åˆ°æ¶ˆæ¯ shareï¼šè§¦å‘ç”¨æˆ·è½¬å‘\nä¸èƒ½åˆ†äº«åˆ°æœ‹å‹åœˆä¸­ getPhoneNumberï¼šè·å–ç”¨æˆ·æ‰‹æœºå·\nå¦‚æœä¸æ˜¯ä¼ä¸šçš„å°ç¨‹åºè´¦å·ï¼Œæ²¡æœ‰æƒé™æ¥è·å–ç”¨æˆ·æ‰‹æœºå·\nç»‘å®šä¸€ä¸ªäº‹ä»¶bindgetphonenumber\nåœ¨äº‹ä»¶çš„å›è°ƒå‡½æ•°ä¸­ï¼Œé€šè¿‡å‚æ•°æ¥è·å–ä¿¡æ¯\nbind:getphonenumber = \u0026#34;getPhoneNumber\u0026#34; Page({ getPhoneNumber(e){ console.log(e); } }) \u0026lt;button bind:getphonenumber=\u0026#34;getPhoneNumber\u0026#34; open-type=\u0026#34;getPhoneNumber\u0026#34;\u0026gt;getPhoneNumber\u0026lt;/button\u0026gt; getUserInfoï¼šè·å–ç”¨æˆ·ä¿¡æ¯\nåœ¨äº‹ä»¶çš„å›è°ƒå‡½æ•°ä¸­ï¼Œé€šè¿‡å‚æ•°æ¥è·å–ä¿¡æ¯\nbind:getuserinfo=\u0026#34;getUserInfo\u0026#34; å¯ä»¥ç›´æ¥è·å–æœªåŠ å¯†çš„ä¿¡æ¯\nNote: getUserInfoæ–°ç‰ˆæœ¬ä¸ä¼šå¼¹æ¡†ï¼Œéœ€è¦ä½¿ç”¨getUserProfileå‡½æ•°\nlaunchAppï¼šæ‰“å¼€APP\néœ€åœ¨Appä¸­é€šè¿‡Appçš„æŸä¸ªé“¾æ¥æ‰“å¼€å°ç¨‹åº openSettingï¼šæ‰“å¼€æˆæƒè®¾ç½®é¡µ\nfeedbackï¼šæ‰“å¼€â€œæ„è§åé¦ˆâ€é¡µé¢ï¼Œç”¨æˆ·å¯æäº¤åé¦ˆå†…å®¹å¹¶ä¸Šä¼ æ—¥å¿—\nchooseAvatarï¼šè·å–ç”¨æˆ·å¤´åƒ\nbind:tap\nbind:tap = \u0026#34;handleTap\u0026#34; ç”¨äºå¤„ç†ç‚¹å‡»äº‹ä»¶ã€‚\nå¸ƒå±€ \u0026lt;!--wxml--\u0026gt; \u0026lt;button bind:tap=\u0026#34;handleTap\u0026#34; data-operation=\u0026#34;{{1}}\u0026#34; \u0026gt;+\u0026lt;/button\u0026gt; \u0026lt;button bind:tap=\u0026#34;handleTap\u0026#34; data-operation=\u0026#34;{{-1}}\u0026#34; \u0026gt;-\u0026lt;/button\u0026gt; // page.js Page({ handleTap(e) { //è·å–è‡ªå®šä¹‰å±æ€§operation const operation = e.currentTarget.dataset.operation; this.setData({ inputStr:Number(this.data.inputStr)+operation }); }, }) input éœ€è¦ç»™ input æ ‡ç­¾ç»‘å®šinputäº‹ä»¶ï¼Œç»‘å®šå…³é”®å­—bindinput é€šè¿‡äº‹ä»¶æºå¯¹è±¡e.detail.valueè·å–è¾“å…¥å­—ç¬¦ä¸² æŠŠè¾“å…¥æ¡†çš„å€¼èµ‹å€¼åˆ°dataä¸­ *****: ä¸èƒ½ç›´æ¥ä½¿ç”¨this.data.num = ~ å¸ƒå±€ \u0026lt;!--wxml--\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; bind:input=\u0026#34;handleInput\u0026#34;/\u0026gt; \u0026lt;view\u0026gt; {{inputStr}} \u0026lt;/view\u0026gt; // page.js Page({ data:{ inputStr:\u0026#34;\u0026#34; } handleInput(e) { this.setData({ inputStr:e.detail.value; }) } }) åª’ä½“ç»„ä»¶ image å›¾ç‰‡ã€‚æ”¯æŒ JPGã€PNGã€SVGã€WEBPã€GIF ç­‰æ ¼å¼ã€‚æ”¯æŒæ‡’åŠ è½½ã€‚\né»˜è®¤å°ºå¯¸ 320px Ã— 240px ã€‚\nâš ï¸ Caution å¾®ä¿¡å°ç¨‹åºä½¿ç”¨çš„æ˜¯ image æ ‡ç­¾ï¼Œè¿™å’ŒHTMLä½¿ç”¨çš„ img ä¸åŒ\nlazy-loadï¼šå›¾ç‰‡æ‡’åŠ è½½ï¼Œåœ¨å³å°†è¿›å…¥ä¸€å®šèŒƒå›´ï¼ˆä¸Šä¸‹ä¸‰å±ï¼‰æ—¶æ‰å¼€å§‹åŠ è½½ show-menu-by-longpressï¼šé•¿æŒ‰å›¾ç‰‡æ˜¾ç¤ºèœå• webpï¼šwebPæ”¯æŒ bindloadï¼šå›¾ç‰‡è½½å…¥å®Œæ¯•æ—¶è§¦å‘ event.detail = {height, width} modeï¼šå›¾ç‰‡è£å‰ªã€ç¼©æ”¾çš„æ¨¡å¼ scaleToFill - default aspectFit - ä¿æŒå®½é«˜æ¯”ï¼Œä¿è¯é•¿è¾¹æ˜¾ç¤º é¡µé¢è½®æ’­å›¾å¸¸ç”¨ aspectFill - ä¿æŒå®½é«˜æ¯”ï¼Œæ˜¾ç¤ºçŸ­è¾¹ï¼Œæˆªå–é•¿è¾¹ å°‘ç”¨ widthFix - ä¿æŒå®½é«˜æ¯”ï¼Œæ ¹æ®å®½åº¦ç¼©æ”¾ å¸¸ç”¨ heightFix etc\u0026hellip; è§†å›¾å®¹å™¨ swiper æ»‘å—è§†å›¾å®¹å™¨ã€‚å…¶ä¸­åªå¯æ”¾ç½® swiper-item ç»„ä»¶ã€‚\né»˜è®¤å°ºå¯¸ 100% Ã— 150px ï¼Œswiper-item ç»„ä»¶ä¸­ image é»˜è®¤å°ºå¯¸ 320px Ã— 240px ï¼Œä¸”å°ºå¯¸æ— æ³•å®ç°ç”±å†…å®¹æ’‘å¼€ã€‚\nè§£å†³æ–¹æ³•ï¼šå¯»æ‰¾åŸå›¾çš„é«˜åº¦å’Œå®½åº¦ï¼Œç­‰æ¯”ä¾‹ä¸º swiper ç¡®å®šé«˜åº¦ä¸å®½åº¦ å±æ€§ auto-playï¼šè‡ªåŠ¨è¿æ’­ intervalï¼šä¿®æ”¹è½®æ’­æ—¶é—´ å•ä½ms durationï¼šåŠ¨ç”»æŒç»­æ—¶é—´ indicator-dotsï¼šæ˜¾ç¤ºè½®æ’­æŒ‡ç¤ºç‚¹ circularï¼š å¾ªç¯æ»šåŠ¨ å¸ƒå±€ \u0026lt;!--wxss--\u0026gt; \u0026lt;swiper\u0026gt; \u0026lt;swiper-item\u0026gt; \u0026lt;image lazy-load class=\u0026#34;auto\u0026#34; src=\u0026#34;1.svg\u0026#34;/\u0026gt; \u0026lt;/swiper-item\u0026gt; \u0026lt;swiper-item\u0026gt; \u0026lt;image lazy-load class=\u0026#34;auto\u0026#34; src=\u0026#34;2.svg\u0026#34;/\u0026gt; \u0026lt;/swiper-item\u0026gt; \u0026lt;/swiper\u0026gt; Navigator é¡µé¢é“¾æ¥ã€‚ç±»ä¼¼ \u0026lt;a href=\u0026quot;\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;ã€‚\nå±æ€§ urlï¼šå½“å‰å°ç¨‹åºå†…çš„è·³è½¬é“¾æ¥ï¼ˆpageæ ¼å¼ï¼‰ open-typeï¼šè·³è½¬æ–¹å¼ navigate - ä¿ç•™å½“å‰é¡µé¢ï¼Œè·³è½¬åˆ°åº”ç”¨å†…çš„æŸä¸ªé¡µé¢ã€‚ä½†æ˜¯ä¸å…è®¸è·³è½¬åˆ°tabbaré¡µé¢ navigateBack - è¿”å›ä¸Šä¸€é¡µé¢ï¼ˆç±»ä¼¼è¿”å›å€¼ï¼‰ redirect - å…³é—­å½“å‰é¡µé¢ï¼Œè·³è½¬åˆ°åº”ç”¨å†…çš„æŸä¸ªé¡µé¢ã€‚ä½†æ˜¯ä¸å…è®¸è·³è½¬åˆ°tabbaré¡µé¢ switchTab - è·³è½¬åˆ°tabBaré¡µé¢ï¼Œå¹¶å…³é—­æ‰€æœ‰étabBaré¡µé¢ relaunch - å…³é—­æ‰€æœ‰é¡µé¢ï¼Œæ‰“å¼€åˆ°åº”ç”¨å†…çš„æŸä¸ªé¡µé¢ âš ï¸ Caution ä¸æ”¯æŒç›¸å¯¹è·¯å¾„ï¼Œè¯·ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼ˆå«/ï¼‰\n\u0026lt;navigator url=\u0026#34;/url/to/page\u0026#34;\u0026gt;nav\u0026lt;/navigator\u0026gt; âš ï¸ Caution è·³è½¬è‡³ç»‘å®šäº† tabBar çš„é¡µé¢æ—¶éœ€è®¾ç½®open-type=\u0026quot;switchTab\u0026quot;\nè·³è½¬åˆ°tabBaré¡µé¢ï¼Œå¹¶å…³é—­å…¶ä»–æ‰€æœ‰étabBaré¡µé¢ å¸ƒå±€ å±äº å—çº§å…ƒç´  ï¼Œé»˜è®¤ä¼šæ¢è¡Œï¼Œå¯ä»¥ç›´æ¥åŠ å®½åº¦å’Œé«˜åº¦\n\u0026lt;!--wxss--\u0026gt; \u0026lt;swiper\u0026gt; \u0026lt;swiper-item\u0026gt; \u0026lt;image lazy-load class=\u0026#34;auto\u0026#34; src=\u0026#34;1.svg\u0026#34;/\u0026gt; \u0026lt;/swiper-item\u0026gt; \u0026lt;swiper-item\u0026gt; \u0026lt;image lazy-load class=\u0026#34;auto\u0026#34; src=\u0026#34;2.svg\u0026#34;/\u0026gt; \u0026lt;/swiper-item\u0026gt; \u0026lt;/swiper\u0026gt; æ¨¡å— ç±»ä¼¼ vue æˆ–è€… react ä¸­çš„è‡ªå®šä¹‰ç»„ä»¶ï¼Œå…è®¸æˆ‘ä»¬ä½¿ç”¨è‡ªå®šä¹‰ç»„ä»¶çš„æ–¹å¼æ¥æ„å»ºé¡µé¢ã€‚\nç±»ä¼¼äºé¡µé¢ï¼Œä¸€ä¸ªè‡ªå®šä¹‰ç»„ä»¶ç”± json wxml wxss js 4ä¸ªæ–‡ä»¶ç»„æˆï¼Œå¯åœ¨å¼€å‘è€…å·¥å…·ä¸­å¿«é€Ÿåˆ›å»ºç»„ä»¶çš„æ–‡ä»¶ç»“æ„ã€‚\næ·˜å®é¦–é¡µï¼š å¯¼èˆªæ¨¡å— å±•ç¤ºæ¨¡å— \u0026hellip;\nå¯¹æŸäº›ä»£ç è¿›è¡Œå¤ç”¨ åˆ›å»º å¯åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­å¿«é€Ÿåˆ›å»ºç»„ä»¶çš„æ–‡ä»¶ç»“æ„ï¼Œæ”¾äºä¸“ç”¨çš„componentsç›®å½•ã€‚\nå£°æ˜ é¦–å…ˆè¦åœ¨ç»„ä»¶çš„jsonæ–‡ä»¶ä¸­è¿›è¡Œè‡ªå®šä¹‰ç»„ä»¶å£°æ˜ï¼š\n// component.json { \u0026#34;component\u0026#34;: true } åœ¨åŸé¡µé¢ä¸­ï¼š\n\u0026lt;!-- page.wxml --\u0026gt; \u0026lt;tabs\u0026gt;\u0026lt;/tabs\u0026gt; // page.json { \u0026#34;usingComponents\u0026#34;: { \u0026#34;tabs\u0026#34;: \u0026#34;/components/tabs/tabs\u0026#34; //ç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„ } } å³å¯ä½¿ç”¨ã€‚\nç¼–è¾‘ è¿™é‡Œä»¥ è‡ªå®šä¹‰æ ‡ç­¾æ  ï¼ˆtabsï¼‰ä¸ºä¾‹ã€‚\nç»‘å®šç‚¹å‡»äº‹ä»¶ éœ€è¦åœ¨ methods ä¸­ç»‘å®š è·å–è¢«ç‚¹å‡»çš„ç´¢å¼• è·å–åŸæ•°ç»„ å¯¹æ•°ç»„å¾ªç¯ ä¸ºæ¯ä¸€ä¸ªå¾ªç¯é¡¹é€‰ä¸­å±æ€§æ”¹ä¸ºfalse ä¸ºå½“å‰ç´¢å¼•æ·»åŠ æ¿€æ´»æ•ˆæœ ç´¢å¼•ä½äºï¼še.currentTarget.dataset ï¼Œæ³¨æ„é€šè¿‡ data-index è¿›è¡Œä¼ é€’\nWarning:\né¡µé¢.js æ–‡ä»¶ä¸­ï¼Œå­˜æ”¾äº‹ä»¶å›è°ƒå‡½æ•°é¡»æ”¾åœ¨ data åŒå±‚çº§ ç»„ä»¶.js æ–‡ä»¶ä¸­ï¼Œå­˜æ”¾äº‹ä»¶å›è°ƒå‡½æ•°é¡»æ”¾åœ¨ methods ä¸­ Note: Js å¯¹å¤æ‚ç±»å‹è¿›è¡Œè§£æ„æ—¶åªæ˜¯å¤åˆ¶äº†ä¸€ä»½å˜é‡çš„å¼•ç”¨\nå¯¹äºæœ€ä¸¥è°¨çš„åšæ³•ï¼Œæ˜¯é‡æ–°æ‹·è´ä¸€ä»½æ•°ç»„ï¼Œå†å¯¹æ•°ç»„çš„å¤‡ä»½è¿›è¡Œå¤„ç†ï¼Œä¸è¦ç›´æ¥ä¿®æ”¹ this.data.æ•°æ® ã€‚\nlet {tabs} = this.data; let tabs = this.data.tabs è¿™ä¸¤è€…è¾¾æˆçš„æ•ˆæœæ˜¯ä¸€è‡´çš„ã€‚\n\u0026lt;text\u0026gt;components/tabs/tabs.wxml\u0026lt;/text\u0026gt; \u0026lt;view class=\u0026#34;tabs\u0026#34;\u0026gt; \u0026lt;view class=\u0026#34;tabs_title\u0026#34;\u0026gt; \u0026lt;block wx:for=\u0026#34;{{tabs}}\u0026#34; wx:key=\u0026#34;id\u0026#34;\u0026gt; \u0026lt;view class=\u0026#34;title_item {{item.isActive?\u0026#39;active\u0026#39;:\u0026#39;\u0026#39;}}\u0026#34; bind:tap=\u0026#34;handleItemTap\u0026#34; data-index=\u0026#34;{{index}}\u0026#34; \u0026gt; \u0026lt;!--è¿™é‡Œæ³¨æ„æ·»åŠ data-indexå±æ€§ä»¥ä¼ é€’å‚æ•°--\u0026gt; {{item.name}} \u0026lt;/view\u0026gt; \u0026lt;/block\u0026gt; \u0026lt;/view\u0026gt; \u0026lt;view class=\u0026#34;tabs_content\u0026#34;\u0026gt; \u0026lt;text\u0026gt;å†…å®¹\u0026lt;/text\u0026gt; \u0026lt;/view\u0026gt; \u0026lt;/view\u0026gt; // components.wxss .tabs_title { display: flex; } .title_item { flex: 1; display: flex; justify-content: center; align-items: center; } view.active{ color: rgb(0, 32, 29); border-bottom: 5rpx solid currentColor; } // component.js Component({ properties: { //æ¥å—çˆ¶å‘å­ä¼ é€’çš„æ•°æ® }, data: { tabs: [ {id: 0, name: \u0026#34;é¦–é¡µ\u0026#34;, isActive: true}, {id: 1, name: \u0026#34;åŸåˆ›\u0026#34;, isActive: false}, {id: 2, name: \u0026#34;åˆ†ç±»\u0026#34;, isActive: false}, {id: 3, name: \u0026#34;å…³äº\u0026#34;, isActive: false} ] }, methods: { //å­˜æ”¾äº‹ä»¶å›è°ƒå‡½æ•° handleItemTap(e) { // è·å–ç´¢å¼• let {index} = e.currentTarget.dataset; // è·å–dataä¸­çš„æ•°ç»„ let {tabs} = this.data; //ç­‰æ•ˆä¸ let tabs = this.data.tabs; /*Note:ä¸ºäº†ä¸ä¿®æ”¹åŸæ¥çš„æ•°æ®ï¼Œæœ€å¥½çš„åŠæ³•æ˜¯è¿›è¡Œæ·±æ‹·è´ï¼š let tabs = JSON.parse(JSON.stringfy(this.data.tabs)); */ console.log(tabs); // å¯¹è±¡æ•°ç»„çš„å¾ªç¯æ•°ç»„ /* [].forEach éå†æ•°ç»„ï¼Œéå†çš„æ—¶å€™è‹¥ä¿®æ”¹äº†v,iä¹Ÿä¼šå¯¼è‡´åŸæ•°ç»„è¢«ä¿®æ”¹*/ tabs.forEach((v, i) =\u0026gt; { v.isActive = i === index; }) this.setData({ tabs }) } }, }); ä¼ å‚ çˆ¶ç»„ä»¶(é¡µé¢) é€šè¿‡ æ ‡ç­¾å±æ€§ çš„æ–¹å¼ä¼ é€’å‘ å­ç»„ä»¶ ä¼ é€’æ•°æ®ã€‚\nå­ç»„ä»¶ åœ¨ properties å±æ€§ä¸­é…ç½®æ¥æ”¶\nçˆ¶ç»„ä»¶(é¡µé¢)\n\u0026lt;!--ä¼ é€’å¸¸æ•°--\u0026gt; \u0026lt;tabs aaa=\u0026#34;123\u0026#34;\u0026gt;\u0026lt;/tabs\u0026gt; \u0026lt;!--ä¼ é€’å˜é‡--\u0026gt; \u0026lt;tabs tabs=\u0026#34;{{tabs}}\u0026#34;\u0026gt;\u0026lt;/tabs\u0026gt; å­ç»„ä»¶\n\u0026lt;!--component.wxml--\u0026gt; \u0026lt;view\u0026gt;{{aaa}}\u0026lt;/view\u0026gt; // component.js Component({ properties: { //æ¥å—çˆ¶å‘å­ä¼ é€’çš„æ•°æ®çš„åç§° aaa:{ //type è¦æ¥å—çš„æ•°æ®ç±»å‹ type:String, //value é»˜è®¤å€¼ value:\u0026#34;\u0026#34; }, tab{ type:Array, value:[] } } }); ä¼˜åŒ– åœ¨ å­ç»„ä»¶ ä¸­è¿›è¡Œçš„è¿™ä¸ªå‡½æ•°ï¼Œä¿®æ”¹çš„æ˜¯ å­ç»„ä»¶ è‡ªå·±çš„å˜é‡\nthis.setData({ tabs }) ä¼˜åŒ–ç›®æ ‡ï¼šè§¦å‘ çˆ¶ç»„ä»¶ ä¸­çš„è‡ªå®šä¹‰äº‹ä»¶ï¼ŒåŒæ—¶ä¼ é€’æ•°æ®ã€‚\nå­ç»„ä»¶ é€šè¿‡äº‹ä»¶å‘ çˆ¶ç»„ä»¶ ä¼ é€’æ•°æ® ä¼ é€’çš„å‚æ•° indexÂ ä¼šè¢«åŒ…è£¹æˆä¸º e.detail.index åœ¨ å­ç»„ä»¶ çš„äº‹ä»¶ä¸ŠåŠ å…¥ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ Note: è¿™äº›æ–¹æ³•å®é™…å¼€å‘æ—¶ä½œä¸ºä¸€æ•´ä¸ªæ¨¡å—ï¼Œåœ¨ç»„ä»¶å†…éƒ¨ä¿®æ”¹ï¼Œä½¿ç”¨æ—¶ç›´æ¥è°ƒç”¨å³å¯ã€‚\nå­ç»„ä»¶ï¼š\n\u0026lt;!--component.wxml--\u0026gt; \u0026lt;view bind:tap=\u0026#34;handler_child\u0026#34;\u0026gt;\u0026lt;/view\u0026gt; \u0026lt;!--å­ç»„ä»¶ä¸­ç»‘å®šå…·ä½“å‚æ•°--\u0026gt; // component.js handler_child() /* Component -\u0026gt; methods -\u0026gt; handler_child(e)*/ this.triggerEvent(\u0026#34;çˆ¶ç»„ä»¶è‡ªå®šä¹‰äº‹ä»¶çš„åç§°\u0026#34;, è¦ä¼ é€’çš„å‚æ•°); çˆ¶ç»„ä»¶ï¼š\n\u0026lt;!--page.wxml--\u0026gt; \u0026lt;component tabs=\u0026#34;{{tabs}}\u0026#34; bind:itemChange=\u0026#34;handler_parent\u0026#34;\u0026gt;\u0026lt;/component\u0026gt; \u0026lt;!--ç¬¬ä¸€ä¸ªæ˜¯å‘å­ç»„ä»¶ä¼ é€’çš„å‚æ•° ç¬¬äºŒä¸ªæ˜¯çˆ¶ç»„ä»¶ä¸­ç›¸åº”çš„å¤„ç†ç¨‹åº--\u0026gt; // page.js handler_parent() /* Page -\u0026gt; handler_parent(e)*/ handler_parent(e){ //è·å–ä¼ é€’çš„å‚æ•° let {index} = e.detail; /* the same as * let index = e.detail.index; */ ... } \u0026lt;slot\u0026gt; åœ¨ç»„ä»¶çš„WXMLä¸­å¯ä»¥åŒ…å«\u0026lt;slot\u0026gt;èŠ‚ç‚¹ï¼Œç”¨äºæ‰¿è½½ç»„ä»¶ä½¿ç”¨è€…æä¾›çš„WXMLç»“æ„ã€‚\nNote: slot æ ‡ç­¾æ˜¯ä¸€ä¸ªå ä½ç¬¦æ’æ§½ï¼Œç­‰åˆ°çˆ¶ç»„ä»¶è°ƒç”¨å­ç»„ä»¶çš„æ—¶å€™å†ä¼ é€’æ ‡ç­¾è¿‡æ¥ï¼Œæœ€ç»ˆè¿™äº›è¢«ä¼ é€’çš„æ ‡ç­¾å°±ä¼šæ›¿æ¢slotæ’æ§½çš„ä½ç½®ã€‚\n\u0026lt;!-- page.wxml --\u0026gt; \u0026lt;view\u0026gt; \u0026lt;component-tag-name prop-a=\u0026#34;{{dataFieldA}}\u0026#34; prop-b=\u0026#34;{{dataFieldB}}\u0026#34;\u0026gt; \u0026lt;view\u0026gt;è¿™é‡Œæ˜¯æ’å…¥åˆ°ç»„ä»¶slotä¸­çš„å†…å®¹\u0026lt;/view\u0026gt; \u0026lt;/component-tag-name\u0026gt; \u0026lt;/view\u0026gt; é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç»„ä»¶çš„ wxml ä¸­åªèƒ½æœ‰ä¸€ä¸ª slot ã€‚éœ€è¦ä½¿ç”¨å¤š slot æ—¶ï¼Œå¯ä»¥åœ¨ç»„ä»¶ js ä¸­å£°æ˜å¯ç”¨ã€‚\n//component.js Component({ options: { multipleSlots: true // åœ¨ç»„ä»¶å®šä¹‰æ—¶çš„é€‰é¡¹ä¸­å¯ç”¨å¤šslotæ”¯æŒ }, properties: { /* ... */ }, methods: { /* ... */ } }) æ­¤æ—¶ï¼Œå¯ä»¥åœ¨è¿™ä¸ªç»„ä»¶çš„wxmlä¸­ä½¿ç”¨å¤šä¸ª slot ï¼Œä»¥ä¸åŒçš„nameæ¥åŒºåˆ†ã€‚\n\u0026lt;!-- component.wxml --\u0026gt; \u0026lt;view class=\u0026#34;wrapper\u0026#34;\u0026gt; \u0026lt;slot name=\u0026#34;before\u0026#34;\u0026gt;\u0026lt;/slot\u0026gt; \u0026lt;view\u0026gt;è¿™é‡Œæ˜¯ç»„ä»¶çš„å†…éƒ¨ç»†èŠ‚\u0026lt;/view\u0026gt; \u0026lt;slot name=\u0026#34;after\u0026#34;\u0026gt;\u0026lt;/slot\u0026gt; \u0026lt;/view\u0026gt; ä½¿ç”¨æ—¶ï¼Œç”¨ slot å±æ€§æ¥å°†èŠ‚ç‚¹æ’å…¥åˆ°ä¸åŒçš„ slot ä¸Šã€‚\n\u0026lt;!-- page.wxml --\u0026gt; \u0026lt;!-- å¼•ç”¨ç»„ä»¶çš„é¡µé¢æ¨¡æ¿ --\u0026gt; \u0026lt;view\u0026gt; \u0026lt;component-tag-name\u0026gt; \u0026lt;view slot=\u0026#34;before\u0026#34;\u0026gt;è¿™é‡Œæ˜¯æ’å…¥åˆ°ç»„ä»¶slot name=\u0026#34;before\u0026#34;ä¸­çš„å†…å®¹\u0026lt;/view\u0026gt; \u0026lt;view slot=\u0026#34;after\u0026#34;\u0026gt;è¿™é‡Œæ˜¯æ’å…¥åˆ°ç»„ä»¶slot name=\u0026#34;after\u0026#34;ä¸­çš„å†…å®¹\u0026lt;/view\u0026gt; \u0026lt;/component-tag-name\u0026gt; \u0026lt;/view\u0026gt; åº”ç”¨ï¼š Tabé¡µé¢\n\u0026lt;!-- component.wxml --\u0026gt; \u0026lt;view class=\u0026#34;tabs_content\u0026#34;\u0026gt; \u0026lt;slot\u0026gt;\u0026lt;/slot\u0026gt; \u0026lt;/view\u0026gt; \u0026lt;!-- page.wxml --\u0026gt; \u0026lt;tabs tabs=\u0026#34;{{tabs}}\u0026#34; bind:itemChange=\u0026#34;handleItemChange\u0026#34;\u0026gt; \u0026lt;!--å•ä¸ªslotçš„æ—¶å€™ï¼Œä¸éœ€è¦view name=\u0026#34;ç‰¹åˆ«æŒ‡å®š\u0026#34;--\u0026gt; \u0026lt;block wx:for=\u0026#34;{{tabs}}\u0026#34; wx:key=\u0026#34;name\u0026#34;\u0026gt; \u0026lt;block wx:if=\u0026#34;{{tabs[index].isActive}}\u0026#34;\u0026gt; \u0026lt;view\u0026gt;{{ tabs[index].name }}\u0026lt;/view\u0026gt; \u0026lt;/block\u0026gt; \u0026lt;/block\u0026gt; \u0026lt;/tabs\u0026gt; å®šä¹‰æ®µ å®šä¹‰æ®µ ç±»å‹ å¿… æè¿° properties Object Map å¦ ç»„ä»¶çš„å¯¹å¤–å±æ€§ï¼Œæ˜¯å±æ€§ååˆ°å±æ€§è®¾ç½®çš„æ˜ å°„è¡¨ï¼Œå‚è§ä¸‹æ–‡ data Object å¦ ç»„ä»¶çš„å†…éƒ¨æ•°æ®ï¼Œå’Œpropertiesä¸€åŒç”¨äºç»„ä»¶çš„æ¨¡æ¿æ¼”æŸ“ observers Object å¦ ç»„ä»¶æ•°æ®å­—æ®µç›‘å¬å™¨ï¼Œç”¨äºç›‘å¬propertieså’Œdataçš„å˜åŒ–ï¼Œå‚è§æ•°æ®ç›‘å¬å™¨\n**æ³¨æ„ï¼š**åªå­˜åœ¨äºç»„ä»¶å½“ä¸­ methods Object å¦ ç»„ä»¶çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬äº‹ä»¶å“åº”å‡½æ•°å’Œä»»æ„çš„è‡ªå®šä¹‰æ–¹æ³•ï¼Œå…³äºäº‹ä»¶å“åº”å‡½æ•°çš„ä½¿ç”¨ï¼Œå‚è§ç»„ä»¶äº‹ä»¶ created Fuction å¦ ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œåœ¨ç»„ä»¶å®ä¾‹åˆšåˆšè¢«åˆ›å»ºæ—¶æ‰§è¡Œï¼Œæ³¨æ„æ­¤æ—¶ä¸èƒ½è°ƒç”¨setDataï¼Œå‚è§ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ attached Fuction å¦ ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œåœ¨ç»„ä»¶å®ä¾‹è¿›å…¥é¡µé¢èŠ‚ç‚¹æ ‘æ—¶æ‰§è¡Œï¼Œå‚è§ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ ready Fuction å¦ ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œåœ¨ç»„ä»¶å¸ƒå±€å®Œæˆåæ‰§è¡Œï¼Œå‚è§ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ moved Fuction å¦ ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œåœ¨ç»„ä»¶å®ä¾‹è¢«ç§»åŠ¨åˆ°èŠ‚ç‚¹æ ‘å¦ä¸€ä¸ªä½ç½®æ—¶æ‰§è¡Œï¼Œå‚è§ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ detached Fuction å¦ ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œåœ¨ç»„ä»¶å®ä¾‹è¢«ä»é¡µé¢èŠ‚ç‚¹æ ‘ç§»é™¤æ—¶æ‰§è¡Œï¼Œå‚è§ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ å‘¨æœŸ åˆ†ä¸ºåº”ç”¨ç”Ÿå‘½å‘¨æœŸå’Œé¡µé¢ç”Ÿå‘½å‘¨æœŸ\nåº”ç”¨ // app.js App({ onlaunch() { // 1. åœ¨åº”ç”¨ç¬¬ä¸€æ¬¡å¯åŠ¨ /* æ­¤æ—¶å¯ç”³è¯·è·å–ç”¨æˆ·ä¸ªäººä¿¡æ¯ */ }, onShow() { // 2. åº”ç”¨è¢«ç”¨æˆ·çœ‹åˆ° /* å¯¹åº”ç”¨çš„æ•°æ®æˆ–è€…é¡µé¢æ•ˆæœé‡ç½® */ }, onHide() { // 3. åº”ç”¨è¢«éšè— /* æš‚åœæˆ–æ¸…é™¤å®šæ—¶å™¨ */ }, onError(err) { // 4. åº”ç”¨ä»£ç å‘ç”Ÿé”™è¯¯ /* æ”¶é›†ç”¨æˆ·é”™è¯¯ä¿¡æ¯ï¼Œé€šè¿‡å¼‚æ­¥è¯·æ±‚å‘é€ç”¨æˆ·é”™è¯¯ä¿¡æ¯ */ }, onPageNotFound() { // 5. é¡µé¢æ‰¾ä¸åˆ°å°±ä¼šè§¦å‘ /* åº”ç”¨ç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶ï¼Œæ‰¾ä¸åˆ°å…¥å£é¡µé¢ï¼Œ ** æ— æ³•è¢« wx.navigateTo è§¦å‘ */ wx.navigateTo({ url: \u0026#34;pages/404/404\u0026#34; }); } }); å±æ€§ ç±»å‹ å¿…å¡« è¯´æ˜ onLaunch Function å¦ ç›‘å¬å°ç¨‹åºåˆå§‹åŒ– onShow Function å¦ ç›‘å¬å°ç¨‹åºå¯åŠ¨æˆ–åˆ‡å‰å° onHide Function å¦ ç›‘å¬å°ç¨‹åºåˆ‡åå° onError Function å¦ é”™è¯¯ç›‘å¬å‡½æ•° onPageNotFound Function å¦ å…¥å£é¡µé¢ä¸å­˜åœ¨ é¡µé¢ // page.js Page({ onLoad() { // 1. ç›‘å¬é¡µé¢åŠ è½½ /* å‘é€å¼‚æ­¥è¯·æ±‚åˆå§‹åŒ–é¡µé¢*/ }, onShow() { // 2. ç›‘å¬é¡µé¢æ˜¾ç¤º }, onReady() { // 3. ç›‘å¬åˆæ¬¡æ¸²æŸ“å®Œæˆ }, onHide() { // 4. ç›‘å¬é¡µé¢éšè— /* opentype = navigate ** ä¿ç•™å½“å‰é¡µé¢ï¼ŒåŠ è½½æ–°é¡µé¢ï¼ˆè·³è½¬é¡µé¢ï¼‰æ—¶è§¦å‘ */ }, onUnload() { // 5. ç›‘å¬é¡µé¢å¸è½½ /* opentype = redirect/reLaunch/navigateBack ** å…³é—­å½“å‰é¡µé¢æ—¶è§¦å‘ */ }, onPullDownRefresh() { // 6. ä¸‹æ‹‰åˆ·æ–°æ—¶åŠ è½½ /* åœ¨page.jsonçš„windowå‚æ•°ä¸­é…ç½®\u0026#34;enablePullDownRefresh\u0026#34;:true ** è¿›è¡Œç•Œé¢åˆ·æ–°æ“ä½œ */ }, onReachBottom() { // 7. ç›‘å¬ä¸‹æ‹‰è§¦åº• /* éœ€è¦é¡µé¢å¯ä»¥ä¸Šä¸‹æ»šåŠ¨æ‰èƒ½è§¦å‘ï¼Œç”¨äºåŠ è½½ä¸‹ä¸€é¡µæ“ä½œ */ }, onShareAppMessage() { // 8. é¡µé¢æ»šåŠ¨æ—¶è§¦å‘ }, onResize() { // 9.é¡µé¢å°ºå¯¸å‘ä¸Šæ”¹å˜è§¦å‘ /* æ¨ªå±/ç«–å±åˆ‡æ¢æ—¶è§¦å‘ ** éœ€åœ¨jsonä¸­çš„windowå­—æ®µé…ç½®\u0026#34;pageOrientation:\u0026#34;auto\u0026#34;å¼€å¯ */ }, onTabItemTap() { // 10. ç‚¹å‡»è‡ªå·±çš„tabBaræ—¶è§¦å‘ } }); å±æ€§ ç±»å‹ è¯´æ˜ data Object é¡µé¢çš„åˆå§‹æ•°æ® onLoad Function ç›‘å¬é¡µé¢åŠ è½½ onShow Function ç›‘å¬é¡µé¢æ˜¾ç¤º onReady Function ç›‘å¬é¡µé¢åˆæ¬¡æ¸²æŸ“å®Œæˆ onHide Function ç›‘å¬é¡µé¢éšè— onUnload Function ç›‘å¬é¡µé¢å¸è½½ ","date":"2023-03-20","section":"techs","summary":"WeApp å¯¼è®º å¾®ä¿¡å°ç¨‹åºï¼Œç®€ç§°å°ç¨‹åºï¼Œè‹±æ–‡å Mini-program ï¼Œæ˜¯ä¸€ç§ä¸éœ€è¦ä¸‹è½½å®‰è£…å³å¯ä½¿ç”¨çš„åº”ç”¨ã€‚\næ­£å¼ä¸Šçº¿æ—¶é—´ï¼š2017å¹´1æœˆ9æ—¥\nå°ç¨‹åºçš„å‰ä¸–ä»Šç”Ÿ å°ç¨‹åºå¼€å‘è€…å·¥å…· å°ç¨‹åºåŸç”Ÿæ¡†æ¶ å°ç¨‹åºæ¨¡æ¿è¯­æ³• å°ç¨‹åºå†…ç½®ç»„ä»¶ å°ç¨‹åºç”Ÿå‘½å‘¨æœŸ å°ç¨‹åºè‡ªå®šä¹‰ç»„ä»¶ å¾®ä¿¡å°ç¨‹åºè‡ªå¸¦å¼€å‘è€…å·¥å…·ï¼Œæ‹¥æœ‰é›†å¼€å‘é¢„è§ˆè°ƒè¯•å‘å¸ƒäºä¸€èº«çš„å®Œæ•´ç¯å¢ƒã€‚\nä½†æ˜¯ç”±äºç¼–ç çš„ä½“éªŒä¸ç®—å¥½ï¼Œå› æ­¤å»ºè®®ä½¿ç”¨ VS Code + å¾®ä¿¡å°ç¨‹åºç¼–è¾‘å·¥å…· æ¥å®ç°ç¼–ç ã€‚\nVS Code è´Ÿè´£æ•²ä»£ç  å¾®ä¿¡å°ç¨‹åºç¼–è¾‘å·¥å…· è´Ÿè´£é¢„è§ˆ æ³¨å†Œè´¦å· -\u0026gt; è·å–AppID\nè·å–é€”å¾„ï¼šå¼€å‘ -\u0026gt; å¼€å‘è€…è®¾ç½® -\u0026gt; å¼€å‘å·¥å…· ç»“æ„ å°ç¨‹åºæ¡†æ¶ çš„ç›®æ ‡æ˜¯å°½å¯èƒ½ä»¥ç®€å•ã€é«˜æ•ˆçš„æ–¹å¼è®©å¼€å‘è€…åœ¨å¾®ä¿¡ä¸­æœ‰åŸç”ŸAppä½“éªŒçš„æœåŠ¡ã€‚\næ¡†æ¶ æ•´ä¸ªå°ç¨‹åºæ¡†æ¶ç³»ç»Ÿåˆ†ä¸ºï¼š\né€»è¾‘å±‚(App Service) è§†å›¾å±‚(View) å°ç¨‹åºåœ¨è§†å›¾å±‚ä¸é€»è¾‘å±‚é—´æä¾›äº†æ•°æ®ä¼ è¾“å’Œäº‹ä»¶ç³»ç»Ÿï¼Œæ ¸å¿ƒæ˜¯ä¸€ä¸ªå“åº”çš„æ•°æ®ç»‘å®šç³»ç»Ÿã€‚\nå½“åšæ•°æ®ä¿®æ”¹çš„æ—¶å€™ï¼Œåªéœ€è¦åœ¨é€»è¾‘å±‚ä¿®æ”¹æ•°æ®ï¼Œè§†å›¾å±‚å°±ä¼šåšç›¸åº”çš„æ›´æ–°ã€‚ï¼ˆç±»ä¼¼ Vue.js | React.jsï¼‰\nå¯¹æ¯” ä¼ ç»ŸWeb å¾®ä¿¡å°ç¨‹åº ç»“æ„ HTML WXML æ ·å¼ CSS WXSS é€»è¾‘ JavaScript JavaScript é…ç½® æ—  JSON é€šè¿‡ä»¥ä¸Šå¯¹æ¯”å¾—å‡ºï¼Œä¼ ç»ŸWeb æ˜¯3å±‚ç»“æ„ï¼Œè€Œ å¾®ä¿¡å°ç¨‹åº æ˜¯4å±‚ç»“æ„ï¼Œå¤šäº†ä¸€å±‚ é…ç½®.json\nç›®å½• pages: é¡µé¢æ–‡ä»¶å¤¹\n","title":"19 WeApp","url":"/techs/19-weapp/"},{"content":"\u0010Vite Viteï¼ˆæ³•è¯­æ„ä¸º \u0026ldquo;å¿«é€Ÿçš„\u0026rdquo;ï¼Œå‘éŸ³ /vit/ï¼Œå‘éŸ³åŒ \u0026ldquo;veet\u0026rdquo;ï¼‰æ˜¯ä¸€ç§æ–°å‹å‰ç«¯æ„å»ºå·¥å…·ï¼Œèƒ½å¤Ÿæ˜¾è‘—æå‡å‰ç«¯å¼€å‘ä½“éªŒã€‚å®ƒä¸»è¦ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š\nä¸€ä¸ªå¼€å‘æœåŠ¡å™¨ï¼Œå®ƒåŸºäº åŸç”Ÿ ES æ¨¡å— æä¾›äº† ä¸°å¯Œçš„å†…å»ºåŠŸèƒ½ï¼Œå¦‚é€Ÿåº¦å¿«åˆ°æƒŠäººçš„ æ¨¡å—çƒ­æ›´æ–°ï¼ˆHMRï¼‰ã€‚\nä¸€å¥—æ„å»ºæŒ‡ä»¤ï¼Œå®ƒä½¿ç”¨ Rollup æ‰“åŒ…ä½ çš„ä»£ç ï¼Œå¹¶ä¸”å®ƒæ˜¯é¢„é…ç½®çš„ï¼Œå¯è¾“å‡ºç”¨äºç”Ÿäº§ç¯å¢ƒçš„é«˜åº¦ä¼˜åŒ–è¿‡çš„é™æ€èµ„æºã€‚\nVite æ„åœ¨æä¾›å¼€ç®±å³ç”¨çš„é…ç½®ï¼ŒåŒæ—¶å®ƒçš„ æ’ä»¶ API å’Œ JavaScript API å¸¦æ¥äº†é«˜åº¦çš„å¯æ‰©å±•æ€§ï¼Œå¹¶æœ‰å®Œæ•´çš„ç±»å‹æ”¯æŒã€‚\næŒ‰ç…§é¡ºåºæ‰§è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼Œå³å¯åŸºäº vite åˆ›å»º vue 3.x çš„å·¥ç¨‹åŒ–é¡¹ç›®ï¼š\nnpm init vite-app é¡¹ç›®åç§° cd ç›®å½•åç§° npm install num run dev ä½¿ç”¨ vite åˆ›å»ºçš„é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š\n- node_modules/ - public/ # å…¬å…±é™æ€èµ„æºç›®å½• - src/ # æºä»£ç ç›®å½• - assets/ # é¡¹ç›®ä¸­é™æ€æºæ–‡ä»¶ - components/ # è‡ªå®šä¹‰ç»„ä»¶ - App.vue # é¡¹ç›®çš„æ ¹ç»„ä»¶ - index.css # å…¨å±€æ ·å¼è¡¨ - main.js # æ‰“åŒ…å…¥å£æ–‡ä»¶ - .gitignore - index.html # SPAå•é¡µåº”ç”¨ - package.json ","date":"2023-03-20","section":"techs","summary":"\u0010Vite Viteï¼ˆæ³•è¯­æ„ä¸º \u0026ldquo;å¿«é€Ÿçš„\u0026rdquo;ï¼Œå‘éŸ³ /vit/ï¼Œå‘éŸ³åŒ \u0026ldquo;veet\u0026rdquo;ï¼‰æ˜¯ä¸€ç§æ–°å‹å‰ç«¯æ„å»ºå·¥å…·ï¼Œèƒ½å¤Ÿæ˜¾è‘—æå‡å‰ç«¯å¼€å‘ä½“éªŒã€‚å®ƒä¸»è¦ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š\nä¸€ä¸ªå¼€å‘æœåŠ¡å™¨ï¼Œå®ƒåŸºäº åŸç”Ÿ ES æ¨¡å— æä¾›äº† ä¸°å¯Œçš„å†…å»ºåŠŸèƒ½ï¼Œå¦‚é€Ÿåº¦å¿«åˆ°æƒŠäººçš„ æ¨¡å—çƒ­æ›´æ–°ï¼ˆHMRï¼‰ã€‚\nä¸€å¥—æ„å»ºæŒ‡ä»¤ï¼Œå®ƒä½¿ç”¨ Rollup æ‰“åŒ…ä½ çš„ä»£ç ï¼Œå¹¶ä¸”å®ƒæ˜¯é¢„é…ç½®çš„ï¼Œå¯è¾“å‡ºç”¨äºç”Ÿäº§ç¯å¢ƒçš„é«˜åº¦ä¼˜åŒ–è¿‡çš„é™æ€èµ„æºã€‚\nVite æ„åœ¨æä¾›å¼€ç®±å³ç”¨çš„é…ç½®ï¼ŒåŒæ—¶å®ƒçš„ æ’ä»¶ API å’Œ JavaScript API å¸¦æ¥äº†é«˜åº¦çš„å¯æ‰©å±•æ€§ï¼Œå¹¶æœ‰å®Œæ•´çš„ç±»å‹æ”¯æŒã€‚\næŒ‰ç…§é¡ºåºæ‰§è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼Œå³å¯åŸºäº vite åˆ›å»º vue 3.x çš„å·¥ç¨‹åŒ–é¡¹ç›®ï¼š\nnpm init vite-app é¡¹ç›®åç§° cd ç›®å½•åç§° npm install num run dev ä½¿ç”¨ vite åˆ›å»ºçš„é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š\n- node_modules/ - public/ # å…¬å…±é™æ€èµ„æºç›®å½• - src/ # æºä»£ç ç›®å½• - assets/ # é¡¹ç›®ä¸­é™æ€æºæ–‡ä»¶ - components/ # è‡ªå®šä¹‰ç»„ä»¶ - App.vue # é¡¹ç›®çš„æ ¹ç»„ä»¶ - index.css # å…¨å±€æ ·å¼è¡¨ - main.js # æ‰“åŒ…å…¥å£æ–‡ä»¶ - .gitignore - index.html # SPAå•é¡µåº”ç”¨ - package.json ","title":"20 Vite","url":"/techs/20-vite/"},{"content":"","date":"2023-03-20","section":"techs","summary":"","title":"21 Babel","url":"/techs/21-babel/"},{"content":"","date":"2023-03-20","section":"techs","summary":"","title":"22 Element","url":"/techs/22-element/"},{"content":"","date":"2023-03-20","section":"techs","summary":"","title":"23 Vant","url":"/techs/23-vant/"},{"content":"","date":"2023-03-20","section":"techs","summary":"","title":"24 Taro","url":"/techs/24-taro/"}]